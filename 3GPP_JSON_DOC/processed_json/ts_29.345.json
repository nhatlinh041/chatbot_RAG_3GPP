{
  "metadata": {
    "specification_id": "ts_29.345",
    "version": "18.0.0",
    "title": "3GPP TS 29.345",
    "file_path": "/content/drive/MyDrive/RAG_thesis/data/29_series/29345-i00/29345-i00.docx"
  },
  "export_info": {
    "export_date": "2025-07-26T09:03:02.658271",
    "total_chunks": 167
  },
  "chunks": [
    {
      "chunk_id": "ts_29.345_1",
      "section_id": "1",
      "section_title": "Scope",
      "content": "The present document describes the Diameter-based interfaces between the Proximity Services (ProSe) Function in the HPLMN and the ProSe Function in a local PLMN (PC6 interface) or between the Proximity Services (ProSe) Function in the HPLMN and the ProSe Function in a visited PLMN (PC7 interface).\nThis specification defines the Diameter application for PC6/PC7 reference points between the ProSe Functions. The interactions between the ProSe Functions are specified.\nThe stage 2 description for Proximity Services (ProSe) features in EPS is specified in 3GPP TS 23.303 [2].",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.303"
      ]
    },
    {
      "chunk_id": "ts_29.345_2",
      "section_id": "2",
      "section_title": "References",
      "content": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non‑specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23 303: \"Proximity-based services (ProSe); Stage 2\".\n[3]\t3GPP TS 29 228: \"IP Multimedia (IM) Subsystem Cx and Dx Interfaces; Signalling flows and message contents\".\n[4]\t3GPP TS 23.003: \"Numbering, addressing and identification\".\n[5]\t3GPP TS 29.329: \"Sh interface based on the Diameter protocol; Protocol details\".\n[6]\t3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".\n[7]\tVoid.\n[8]\t3GPP TS 33.210: \"3G security; Network Domain Security (NDS); IP network layer security\".\n[9]\tIETF RFC 4960: \"Stream Control Transport Protocol\".\n[10]\t3GPP TS 29.229: \"Cx and Dx interfaces based on the Diameter protocol; protocol details\".\n[11]\tIETF RFC 5234: \"Augmented BNF for Syntax Specifications: ABNF\".\n[12]\tIETF RFC 4072: \"Diameter Extensible Authentication Protocol (EAP) Application\".\n[13]\t3GPP TS 32.299: \"Charging management; Diameter charging applications\".\n[14]\t3GPP TS 29.344: \"Proximity-services (Prose) Function to Home Subscriber Server (HSS) aspects (PC4); Stage 3\".\n[15]\t3GPP TS 29.273: \"Evolved Packet System (EPS); 3GPP EPS AAA interfaces\".\n[16]\t3GPP TS 29.272: \"Evolved Packet System (EPS); Mobility Management Entity (MME) and Serving GPRS Support Node (SGSN) related interfaces based on Diameter protocol\".\n[17]\tWi-Fi Alliance Technical Committee P2P Task Group, \"Wi-Fi Peer-to-Peer (P2P) Technical Specification\", Version 1.1.\n[18]\t3GPP TS 29.336: \"Home Subscriber Server (HSS) diameter interfaces for interworking with packet data networks and applications\".\n[19]\tITU-T Recommendation E.164: \"The international public telecommunication numbering plan\".\n[20]\tIEEE Std 802.11-2012: \"IEEE Standard for Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks - Specific requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications\".\n[21]\tIETF RFC 7683: \"Diameter Overload Indication Conveyance\".\n[22]\t3GPP TS 24.334: \"Proximity-services (ProSe) User Equipment (UE) to ProSe function protocol aspects; Stage 3\".\n[23]\t3GPP TS 33.303: \"Proximity-based Services (ProSe); Security aspects\".\n[24]\t3GPP TS 23.271: \"Functional stage 2 description of Location Services (LCS)\".\n[25]\tOpen Mobile Alliance, OMA AD SUPL: \"Secure User Plane Location Architecture\", (http://www.openmobilealliance.org).\n[26]\t3GPP TS 24.333: \"Proximity-services (ProSe) Management Objects (MO)\".\n[27]\tIETF RFC 7944: \"Diameter Routing Message Priority\".\n[28]\tIETF RFC 8583: \"Diameter Load Information Conveyance\".\n[29]\tIETF RFC 6733: \"Diameter Base Protocol\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905",
        "ts_23.003",
        "ts_29.329",
        "ts_23.032",
        "ts_33.210",
        "ts_29.229",
        "ts_32.299",
        "ts_29.344",
        "ts_29.273",
        "ts_29.272",
        "ts_29.336",
        "ts_24.334",
        "ts_33.303",
        "ts_23.271",
        "ts_24.333"
      ]
    },
    {
      "chunk_id": "ts_29.345_3.1",
      "section_id": "3.1",
      "section_title": "Definitions",
      "content": "For the purposes of the present document, the terms and definitions given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.303 [2] apply:\nLocal PLMN",
      "chunk_type": "definition",
      "cross_references": [
        "ts_21.905",
        "ts_23.303"
      ]
    },
    {
      "chunk_id": "ts_29.345_3.2",
      "section_id": "3.2",
      "section_title": "Abbreviations",
      "content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\nALUID\tApplication Layer User ID\nDRMP\tDiameter Routing Message Priority\nDSCP\tDifferentiated Services Code Point\nDUCK\tDiscovery User Confidentiality Key\nDUIK\tDiscovery User Integrity Key\nDUSK\tDiscovery User Scrambling Key\nEPUID\tEPC ProSe User ID\nMIC\tMessage Integrity Check\nPDUID\tProSe Discovery UE ID\nProSe\tProximity-based Services\nRPAUID\tRestricted ProSe Application User ID\nUTC\tUniversal Time Coordinated\nWLLID\tWLAN Link Layer ID",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905"
      ]
    },
    {
      "chunk_id": "ts_29.345_4.1",
      "section_id": "4.1",
      "section_title": "Introduction",
      "content": "The PC6 reference point is defined between a ProSe Function in the HPLMN and a ProSe Function in a local PLMN.\nThe PC7 reference point is defined between ProSe Function in the HPLMN and a ProSe Function in a visited PLMN.\nThe definition of the PC6/PC7 reference points and related functionalities are given in 3GPP TS 23.303 [2].\nAs defined in 3GPP TS 23.303 [2], the PC6/PC7 reference points are used for:\n-\tHPLMN control of service authorization for ProSe;\n-\tAuthorization of ProSe Direct Discovery requests;\n-\tRetrieval of Discovery Filter(s) corresponding ProSe Application ID name(s);\n-\tTranslation of ProSe Application Code(s) to the associated ProSe Application Name.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.303"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.1",
      "section_id": "5.1",
      "section_title": "introduction",
      "content": "This clause describes the Diameter-based PC6 and PC7 interfaces related procedures and Information elements exchanged between functional entities.\nIn the tables that describe the Information Elements transported by each Diameter command, each Information Element is marked as (M) Mandatory, (C) Conditional or (O) Optional in the \"Cat.\" column. For the correct handling of the Information Element according to the category type, see the description detailed in clause 6 of the 3GPP TS 29.228 [3].",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.228_clause_6",
        "ts_29.228"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.2.1",
      "section_id": "5.2.1",
      "section_title": "General",
      "content": "The ProSe Service Authorization Procedure shall be used between the ProSe Function in the HPLMN and the ProSe Function in Local PLMN or VPLMN to obtain service authorization information for ProSe Direct Discovery, ProSe Direct Communication or both. The procedure shall be invoked by the ProSe Function in the HPLMN by the UE and is used:\n-\tto request service authorization information for ProSe related to the UE from the ProSe Function in the local PLMN or VPLMN;\n-\tto provide the ProSe Function in the local PLMN or VPLMN with the UE identity (IMSI or MSISDN) in order to allow to perform charging:\nThis procedure is mapped to the commands ProSe-Authorization-Request/Answer (PAR/PAA) in the Diameter application specified in clause 6.\nTable 5.2.1-1 specifies the involved information elements for the request.\nTable 5.2.1-2 specifies the involved information elements for the answer.\nTable 5.2.1-1: ProSe Service Authorization Request\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nUE Identity\n(See 6.3.28)\nUser-Identifier\nM\nThis information element shall contain either the user IMSI, formatted according to 3GPP TS 23.003 [4], clause 2.2, or the user MSISDN, formatted according to 3GPP TS 29.329 [5].\nPLMN Id\n(See 6.3.29)\nVisited-PLMN-Id\nM\nThis IE shall contain the PLMN-Id (3GPP TS 23.003 [4]) of the network in which the ProSe Function is located.\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nTable 5.2.1-2: ProSe Service Authorization Answer\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nResult\n(See 6.4)\nResult-Code / Experimental-Result\nM\nThis IE shall contain the result of the operation.\nThe Result-Code AVP shall be used to indicate success / errors as defined in the Diameter Base Protocol.\nThe Experimental-Result AVP shall be used for PC6/PC7 errors. This is a grouped AVP which shall contain the 3GPP Vendor ID in the Vendor-Id AVP, and the error code in the Experimental-Result-Code AVP.\nThe following errors are applicable:\n- User Unknown\n- Unauthorized Service\n- Unauthorized Service in this PLMN\nProSe Direct Allowed\n(See 6.3.42)\nProSe-Direct-Allowed\nC\nThis Information Element shall contain the ProSe authorization information of the user. It shall be present if success is reported.\nValidity Time of Announcing (see.6.3.36)\nValidity-Time-Announce\nC\nThis Information Element shall contain the validity time for a UE authorization to perform ProSe direct discovery announcing in this PLMN. It shall be present if success is reported.\nValidity Time of Monitoring (see.6.3.37)\nValidity-Time-Monitor\nC\nThis Information Element shall contain the validity time for a UE authorization to perform ProSe direct discovery monitoring in this PLMN. It shall be present if success is reported.\nValidity Time of Communication (see.6.3.38)\nValidity-Time-Communication\nC\nThis Information Element shall contain the validity time for a UE authorization to perform ProSe direct communication in this PLMN. It shall be present if success is reported.\nAuthorized Discovery Range\n(See 3GPP TS 29.344 [14])\nAuthorized-Discovery-Range\nC\nThis information element shall contain the authorised range (short/medium/long) at which the UE is allowed to announce in the given PLMN according to the defined announcing authorisation policy for this UE. It shall be present if the discovery authorization type is for announcing. Otherwise it shall be absent.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6",
        "ts_23.003_clause_2.2",
        "table_5.2.1-1",
        "table_5.2.1-2",
        "ts_23.003",
        "ts_29.329",
        "ts_29.344"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.2.2",
      "section_id": "5.2.2",
      "section_title": "Detailed behaviour of the ProSe Function in the HPLMN",
      "content": "The ProSe Function in the HPLMN shall make use of this procedure to request service authorization information for ProSe related to the UE from the ProSe Function in local PLMN or VPLMN. The ProSe Function shall include in the request the UE identity (IMSI or MSISDN) and the PLMN-Id identifying the PLMN of the requesting ProSe Function.\nWhen receiving a ProSe Service Authorization response from the ProSe Function in the local PLMN or VPLMN, the ProSe Function in the HPLMN shall check the result code. If it indicates SUCCESS, the ProSe Function shall merge with its own policy.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.2.3",
      "section_id": "5.2.3",
      "section_title": "Detailed behaviour of the ProSe Function in the Local PLMN or VPLMN",
      "content": "When receiving a ProSe Service Authorization request, the ProSe Function in the local PLMN or VPLMN shall, in the following order:\n1.\tCheck whether the UE Identity (IMSI or MSISDN) exists. If not, a Result Code of DIAMETER_ERROR_USER_UNKNOWN shall be returned.\n2.\tCheck whether ProSe is authorized for this UE Identity. If not, a Result Code of DIAMETER_ERROR_UNAUTHORIZED_SERVICE shall be returned.\nIf there is an error in any of the above steps then the ProSe Function shall stop processing the request and shall return the error code specified in the respective step.\nIf the ProSe Function cannot fulfil the received request for reasons not stated in the above steps, e.g. due to a database error or any of the required actions cannot be performed, it shall stop processing the request and set the Result Code to \"DIAMETER_UNABLE_TO_COMPLY\".\nOtherwise, when the UE is authorized to use ProSe Direct Discovery or ProSe Direct Communication in this PLMN, the ProSe Function shall return the authorization data in the response, according to the supported/unsupported features of the ProSe Function in the Local PLMN or VPLMN, and the authorised announcing range (short/medium/long) at which and if the UE is allowed to announce in the VPLMN according to the defined announcing authorisation policy for this UE (see 3GPP TS 24.333 [26] for the possible values of the range) and shall set the Result Code to \"DIAMETER_SUCCESS\".",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.333"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.3.1",
      "section_id": "5.3.1",
      "section_title": "General",
      "content": "The ProSe Direct Discovery Authorization Procedure shall be used between the ProSe Function in the HPLMN and the ProSe Function in a Local PLMN or VPLMN to obtain authorization for access to the discovery resources and perform ProSe Direct Discovery. The procedure shall be invoked by the ProSe Function in the HPLMN and is used:\n-\tto request the ProSe Function in the VPLMN or Local PLMN for the authorization for ProSe Direct Discovery announcing when the announcing UE is roaming in the VPLMN or announcing in a Local PLMN;\n-\tto perform the resolution ProSe Application ID Name to ProSe Application Code and/or ProSe Application Mask when the ProSe Application ID has PLMN-specific scope for open ProSe Direct discovery;\n-\tto notify the ProSe Function in Local PLMN that the previously allocated ProSe Discovery Filter for a ProSe Application ID which has PLMN-specific scope is no longer monitored by a monitoring UE of the HPLMN;\n-\tto perform the resolution of a target RPAUID to a ProSe Restricted Code or ProSe Restricted Code Prefix for restricted ProSe Direct Discovery;\n-\tto provide the ProSe Function in the Local PLMN or VPLMN with the application identity in order to allow it to perform charging;\n-\tto provide the ProSe Function in the Local PLMN or VPLMN with the UE identity (i.e. IMSI or MSISDN) in order to allow to perform charging;\n-\tto provide the ProSe Function in VPLMN with the allocated ProSe Application Code, ProSe Restricted Code or ProSe Restricted Code Prefix/Suffix Pool, and the corresponding validity timer, or a notification of the termination or change of the allocated ProSe-related codes, in order to allow to perform charging.\n-\tto provide the ProSe Function in VPLMN with the allocated ProSe Query Code or ProSe Response Code and the corresponding validity timer when such a code is announced in restricted ProSe Direct Discovery model B procedure, in order to allow to perform charging.\n-\tto provide the ProSe Function in VPLMN/Local PLMN with the allocated ProSe Query Code, ProSe Response Code and associated validity timer for a given RPAUID using restricted ProSe Direct Discovery model B.\n-\tto provide the ProSe Function in the Local PLMN or VPLMN with the PC5 radio technology that the UE is using.\nThis procedure is mapped to the commands ProSe-Discovery-Request/Answer (PDR/PDA) in the Diameter application specified in clause 6.\nTable 5.3.1-1 specifies the involved information elements for the request.\nTable 5.3.1-2 specifies the involved information elements for the answer.\nTable 5.3.1-1: ProSe Direct Discovery Authorization Request\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nDiscovery Authorization Request\n(See 6.3.53)\nDiscovery-Auth-Request\nM\nThis information element shall contain the information elements used in discovery authorization request.\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nDiscovery Entry ID\n(See 6.3.59)\nDiscovery-Entry-ID\nC\nThis Information Element contains the discovery entry ID used by the sending ProSe Function to identify the discovery entry related to this request.\nTable 5.3.1-2: ProSe Direct Discovery Authorization Answer\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nResult\n(See 6.4)\nResult-Code / Experimental-Result\nM\nThis IE shall contain the result of the operation.\nThe Result-Code AVP shall be used to indicate success / errors as defined in the Diameter Base Protocol.\nThe Experimental-Result AVP shall be used for PC6/PC7 errors. This is a grouped AVP which shall contain the 3GPP Vendor ID in the Vendor-Id AVP, and the error code in the Experimental-Result-Code AVP.\nThe following errors are applicable:\n- Announcing Not Authorized\n- No Associated Discovery Filter\nDiscovery Authorization Response\n(See 6.3.54)\nDiscovery-Auth-Response\nC\nThis information element shall contain the information elements used in discovery authorization response. This information element shall be present if the Result Code AVP is DIAMETER_SUCCESS.\nDiscovery Entry ID\n(See 6.3.59)\nDiscovery-Entry-ID\nC\nThis Information Element contains the discovery entry ID used by the sending ProSe Function to identify the discovery entry related to this request.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6",
        "table_5.3.1-1",
        "table_5.3.1-2"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.3.2",
      "section_id": "5.3.2",
      "section_title": "Detailed behaviour of the HPLMN ProSe Function",
      "content": "The ProSe Function in the HPLMN shall make use of this procedure to request the ProSe Function in VPLMN or a PLMN other than the HPLMN/VPLMN for ProSe Direct Discovery announcing authorisation for an announcing UE roaming in the VPLMN or announcing in a Local PLMN.\n-\tFor open ProSe Direct Discovery, the HPLMN ProSe Function shall include in the request the Discovery Entry ID and shall include in the Discovery Authorization Request the Discovery Type set to \"ANNOUNCING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the ProSe Application ID corresponding to the request from the announcing UE and the ProSe Application Code or ProSe Application Code Prefix/Suffix(es) assigned for this request. The Discovery Authorization Request shall include the UE identity (i.e., IMSI or MSISDN) and the ProSe Validity Timer corresponding to ProSe Application Code in order to allow the ProSe Function in VPLMN or the Local PLMN to perform charging. If the announcing UE's original announce request is for updating the metadata, the updated metadata shall also be included. If the announcing UE's original announce request is for stopping the announcing operation, the ProSe Function shall not include any ProSe Application Code(s) or ProSe Validity Timer. The HPLMN ProSe Function may also include the PC5-tech set to the PC5 radio technology that the UE is using.\n-\tFor restricted ProSe Direct Discovery, the HPLMN ProSe Function shall include in the Discovery Authorization Request the Discovery Entry ID and the Discovery Type set to \"ANNOUNCING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the application identity, RPAUID corresponding to the announcing UE, the ProSe Restricted Code assigned for this request. The Discovery Authorization Request shall also include the UE identity (i.e., IMSI or MSISDN) and the ProSe Validity Timer corresponding to ProSe Restricted Code in order to allow the ProSe Function in VPLMN or the Local PLMN to perform charging. For restricted ProSe Direct Discovery using application-controlled extension, the ProSe Function shall include a ProSe Restricted Code Prefix and one or more ProSe Restricted Code Suffix Range in the Discovery Authorization Request. If the announcing UE's original announce request is for stopping the announcing operation, the ProSe Function shall not include any ProSe Restricted Code or ProSe Restricted Code Prefix or ProSe Restricted Code Suffix Range(s), or ProSe Validity Timer. The HPLMN ProSe Function may also include the PC5-tech set to the PC5 radio technology that the UE is using.\n-\tFor restricted ProSe Direct Discovery model B discoverer operation, the HPLMN ProSe Function shall include in the Discovery Authorization Request the Discovery Entry ID and the Discovery Type set to \"DISCOVERER_ANNOUNCING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the application identity, RPAUID corresponding to the discoverer UE as well as the ProSe Query Code assigned for this request. The Discovery Authorization Request shall also include the UE identity (i.e., IMSI or MSISDN) and the ProSe Validity Timer corresponding to ProSe Query Code in order to allow the ProSe Function in VPLMN or the Local PLMN to perform charging. The HPLMN ProSe Function may also include the PC5-tech set to the PC5 radio technology that the UE is using.\n-\tFor restricted ProSe Direct Discovery model B discoveree operation, the HPLMN ProSe Function shall include in the Discovery Authorization Request the Discovery Entry ID and the Discovery Type set to \"DISCOVEREE_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the application identity, RPAUID corresponding to the discoverer UE as well as the ProSe Response Code assigned for this request. The Discovery Authorization Request shall also include the UE identity (i.e., IMSI or MSISDN) and the ProSe Validity Timer corresponding to ProSe Query Code in order to allow the ProSe Function in VPLMN or the Local PLMN to perform charging. The HPLMN ProSe Function may also include the PC5-tech set to the PC5 radio technology that the UE is using.\nThe ProSe Function in the HPLMN shall make use of this procedure to retrieve from the ProSe Function in the Local PLMN the Discovery Filter for monitoring in open ProSe Direct Discovery or to retrieve parameters needed to create a Restricted Discovery Filter, or ProSe Response Filter associated with the monitored/queried application-layer identity for restricted ProSe Direct Discovery.\n-\tFor open ProSe Direct Discovery, the HPLMN ProSe Function shall include in the request the Discovery Entry ID and shall include in the Discovery Authorization Request the Discovery Type set to \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the ProSe Application ID name corresponding to the request from the monitoring UE. The Discovery Authorization Request shall also include the UE identity (i.e., IMSI or MSISDN) in order to allow the ProSe Function in Local PLMN to perform charging. If the monitoring UE's original announce request is for stopping the monitoring operation or the allocated Discovery Filter has been revoked by the ProSe Function, the ProSe Function shall not include the ProSe Application ID name. The HPLMN ProSe Function may also include the PC5-tech set to the PC5 radio technology that the UE is using.\n-\tFor restricted ProSe Direct Discovery, the HPLMN ProSe Function shall include in the Discovery Authorization Request the Discovery Entry ID and the Discovery Type set to \"MONITORING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY, the application identity, the requesting RPAUID, target RPAUID and target PDUID of a monitoring target. The Discovery Authorization Request shall also include the UE identity (i.e., IMSI or MSISDN) in order to allow the ProSe Function in Local PLMN to perform charging. The HPLMN ProSe Function may also include the PC5-tech set to the PC5 radio technology that the UE is using.\n-\tFor restricted ProSe Direct Discovery model B discoveree operation, the HPLMN ProSe Function shall include in the Discovery Authorization Request the Discovery Entry ID and the Discovery Type set to the indicate \"DISCOVERER_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the application identity, the requesting RPAUID, target RPAUID and target PDUID of a monitoring target. The request shall include the UE identity (IMSI or MSISDN) and the Discovery Entry ID in order to allow the ProSe Function in Local PLMN to perform charging. The HPLMN ProSe Function may also include the PC5-tech set to the PC5 radio technology that the UE is using.\nWhen receiving the ProSe Direct Discovery Authorization response with the Result Code set to \"DIAMETER_SUCCESS\" for a request with the Discovery Type set to \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the HPLMN ProSe Function shall check whether a ProSe Discovery Filter is received for each ProSe Application ID Name sent in the request. If a ProSe Discovery Filter is missing for one ProSe Application ID Name, the ProSe Function shall consider that there is no valid ProSe Discovery Filter the ProSe associated with this ProSe Application ID Name in the ProSe Function in the Local PLMN or VPLMN.\nWhen receiving the ProSe Direct Discovery Authorization response with the Result Code set to \"DIAMETER_SUCCESS\" for a request with the Discovery Type set to \"MONITORING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\" or \"DISCOVERER_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the HPLMN ProSe Function shall enclose the information in Code Receiving Security Material parameter in the discovery filter created for the target RPAUID. If a DUIK parameter is included in the response message, the ProSe Function shall store the DUIK in order to verify the MIC field, as specified in 3GPP TS 24.334 [22].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.334"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.3.3",
      "section_id": "5.3.3",
      "section_title": "Detailed behaviour of the ProSe Function in the Local PLMN or VPLMN",
      "content": "When receiving a ProSe Direct Discovery Authorization request, the ProSe Function in the Local PLMN or VPLMN shall check the value of the Discovery Type.\n-\tIf the value is \"ANNOUNCING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the ProSe Function shall check if the UE is authorized to announce in the PLMN for the specified PC5 radio technology.\n-\tIf the UE is not authorized, the experimental result code shall be set to \"DIAMETER_ERROR_ANNOUNCING_UNAUTHORIZED_IN_PLMN\" in the response sent by the ProSe Function.\n-\tIf the UE is authorized, the result code shall be set to \"DIAMETER_SUCCESS\" in the response sent by the ProSe Function. The ProSe Function shall store the UE identity (i.e., IMSI or MSISDN) in order to perform charging. In addition, the ProSe Function in the VPLMN or the Local PLMN shall store the ProSe Validity Timer corresponding to ProSe Application Code or ProSe Application Code Prefix/Suffix(es) in order to perform charging. If no ProSe Application Code is included in the request, the ProSe Function shall remove the discovery entry associated with the Discovery Entry ID for the requesting UE.\n-\tIf the value is \"ANNOUNCING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the ProSe Function shall check whether the UE is authorized to announce in the PLMN for restricted discovery model A for the specified PC5 radio technology.\n-\tIf the UE is not authorized, the experimental result code shall be set to \"DIAMETER_ERROR_ANNOUNCING_NOT_AUTHORIZED\" in the response sent by the ProSe Function.\n-\tIf the UE is authorized, the result code shall be set to \"DIAMETER_SUCCESS\" in the response sent by the ProSe Function. The ProSe Function in the VPLMN or the Local PLMN shall store the UE identity (IMSI or MSISDN) in order to perform charging;\n-\tProSe Function in the VPLMN or the Local PLMN shall store the Application Identity, and the ProSe Validity Timer corresponding to ProSe Restricted Code or ProSe Restricted Code Prefix and ProSe Restricted Code Suffix(es) in order to perform charging. If no ProSe Restricted Code or ProSe Restricted Code Prefix is included in the request, the ProSe Function shall remove the discovery entry associated with the Discovery Entry ID for the requesting UE.\n-\tIf the value is \"DISCOVEREE_ANNOUNCING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the ProSe Function shall check whether the UE is authorized to announce in the PLMN for restricted discovery model B discoveree operation for the specified PC5 radio technology.\n-\tIf the UE is not authorized, the experimental result code shall be set to \"DIAMETER_ERROR_ANNOUNCING_UNAUTHORIZED_IN_PLMN\" in the response sent by the ProSe Function.\n-\tIf the UE is authorized, the result code shall be set to \"DIAMETER_SUCCESS\" in the response sent by the ProSe Function. The ProSe Function in the VPLMN or the Local PLMN shall store the UE identity (IMSI or MSISDN) in order to perform charging;\n-\tProSe Function in the VPLMN or the Local PLMN shall store the Application Identity, and the ProSe Validity Timer corresponding to ProSe Response Code in order to perform charging.\n-\tIf the value is \"DISCOVERER_ANNOUNCING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the ProSe Function shall check whether the UE is authorized to announce in the PLMN for restricted discovery model B discoverer operation for the specified PC5 radio technology.\n-\tIf the UE is not authorized, the experimental result code shall be set to \"DIAMETER_ERROR_ANNOUNCING_UNAUTHORIZED_IN_PLMN\" in the response sent by the ProSe Function.\n-\tIf the UE is authorized, the result code shall be set to \"DIAMETER_SUCCESS\" in the response sent by the ProSe Function. The ProSe Function in the VPLMN or the Local PLMN shall store the UE identity (IMSI or MSISDN), the Application Identity and the ProSe Validity Timer corresponding to ProSe Query Code in order to perform charging;\n-\tIf the value is \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the ProSe Function shall check whether one or more Discovery Filter(s) exist for each ProSe Application ID name received in the request.\n-\tIf there is no valid Discovery Filter associated to the ProSe Application ID name in the request, the experimental result code shall be set to \"DIAMETER_ERROR_NO_ASSOCIATED_DISCOVERY_FILTER\" in the response sent by the ProSe Function.\n-\tIf no ProSe Application ID is included in the request, the ProSe Function shall remove the discovery entry associated with the Discovery Entry ID for the requesting UE. If there exists one or more valid Discovery Filters related to the ProSe Application ID name, the ProSe Function shall return the Discovery Authorization Response including the Discovery Filter(s) along with the Discovery Entry ID and set the result code to \"DIAMETER_SUCCESS\" in the response. If the announcing UE is roaming, the PLMN-Id of the VPLMN shall be included in the Discovery Authorization Response.\n-\tIf the value is \"MONITORING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the ProSe Function shall process the request in the following order to check if the monitoring is authorized.\n-\tThe ProSe function shall check whether the target PDUID is known and belongs to its own PLMN. If not, the experimental result code shall be set to \"DIAMETER_ERROR_INVALID_TARGET_PDUID\" in the response sent by the ProSe Function.\n-\tThe ProSe function may check whether the requesting RPAUID is allowed to discover the target RPAUID. If not, the experimental result code shall be set to \"DIAMETER_ERROR_INVALID_TARGET_RPAUID\" in the response sent by the ProSe Function.\n-\tThe ProSe function shall check whether a valid ProSe Restricted Code or ProSe Restricted Code Prefix exists for the target RPAUID included in the request.\n-\tIf not, the experimental result code shall be set to \"DIAMETER_ERROR_NO_ASSOCIATED_RESTRICTED_CODE\" in the response sent by the ProSe Function.\n-\tOtherwise, the ProSe Function shall set the result code to \"DIAMETER_SUCCESS\" in the response. The ProSe Function shall return the Discovery Authorization Response including the ProSe Restricted Code or ProSe Restricted Code Prefix associated with the target RPAUID, and the corresponding Code Receiving Security Material and optionally a DUIK, and its corresponding Validity Timer. If the announcing UE is roaming, the PLMN-Id of the VPLMN shall be also included in the response.\n-\tIf the value is \"DISCOVERER_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the ProSe Function shall process the request in the following order to check whether the monitoring is authorized.\n-\tThe ProSe function shall check if the target PDUID is known and belongs to its own PLMN. If not, the experimental result code shall be set to \"DIAMETER_ERROR_INVALID_TARGET_PDUID\" in the response sent by the ProSe Function.\n-\tThe ProSe function may check if the requesting RPAUID is allowed to discovery the target RPAUID. If not, the experimental result code shall be set to \"DIAMETER_ERROR_INVALID_TARGET_RPAUID\" in the response sent by the ProSe Function.\n-\tThe ProSe function shall check if both ProSe Query Code and ProSe Response Code exist for the target RPAUID included in the request.\n-\tIf not, the experimental result code shall be set to \"DIAMETER_ERROR_NO_ASSOCIATED_RESTRICTED_CODE\" in the response sent by the ProSe Function.\n-\tOtherwise, the ProSe Function shall set the result code to \"DIAMETER_SUCCESS\" in the response. The ProSe Function shall return the Discovery Authorization Response including the ProSe Query Code and the corresponding Code Sending Security Material and ProSe Response Code Code associated with the target RPAUID, and the corresponding Code Receiving Security Material and optionally a DUIK, and its corresponding Validity Timer. If the discoverer UE is roaming or announcing in a Local PLMN, the PLMN-Id of the VPLMN or the Local PLMN shall be also included in the response.\nIf the ProSe Function cannot fulfil the received request for reasons not stated in the above steps, e.g. due to a database error or any of the required actions cannot be performed, it shall set the Result Code to \"DIAMETER_UNABLE_TO_COMPLY\".",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.4.1",
      "section_id": "5.4.1",
      "section_title": "General",
      "content": "The ProSe Match Report Procedure shall be used between the ProSe Function in the HPLMN and the ProSe Function in the local PLMN identified by the PLMN-Id contained in the ProSe Application Code(s) discovered by the monitoring UE. The procedure shall be invoked by the ProSe Function in the HPLMN and is used:\n-\tto confirm that the ProSe Application Code(s) is authorized to be transmitted on the monitored PLMN;\n-\tto retrieve the ProSe Application ID(s), associated validity timer(s) and associated match report refresh timer(s) corresponding to the ProSe Application Code(s) as well metadata associated with the ProSe Application ID if available and requested by the UE; and\n-\tto provide the ProSe Function in the local PLMN with the identity (IMSI or MSISDN) of the monitoring UE in order to allow to perform charging.\n-\tto provide the ProSe Function in the Local PLMN with the PC5 radio technology that the UE is using.\nThis procedure is mapped to the commands ProSe-Match-Request/Answer (PMR/PMA) in the Diameter application specified in clause 6.\nTable 5.4.1-1 specifies the involved information elements for the request.\nTable 5.4.1-2 specifies the involved information elements for the answer.\nTable 5.4.1-1: ProSe Match Report Request\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nMatch Request\n(See 6.3.55)\nMatch-Request\nM\nThis information element shall contain the information elements used in discovery match request.\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nPMR Flags\n(See 6.3.57)\nPMR-Flags\nC\nThis Information Element contains a bit mask. See 6.3.57 for the meaning of the bits.\nTable 5.4.1-2: ProSe Match Report Answer\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nSupported Features\n(See .6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nResult\n(See 6.4)\nResult-Code / Experimental-Result\nM\nThis IE shall contain the result of the operation.\nThe Result-Code AVP shall be used to indicate success / errors as defined in the Diameter Base Protocol.\nThe Experimental-Result AVP shall be used for PC6/PC7 errors. This is a grouped AVP which shall contain the 3GPP Vendor ID in the Vendor-Id AVP, and the error code in the Experimental-Result-Code AVP.\nThe following errors are applicable:\n- Announcing Not Authorized in PLMN\n- Invalid Application Code\nMatch Report (See 6.3.12)\nMatch-Report\nC\nThis Information Element shall contain the information elements in response to the discovery match request. This Information Element shall be present only when the Result-Code AVP is DIAMETER_SUCCESS. Multiple instances of this Information Element may be present in the message.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6",
        "table_5.4.1-1",
        "table_5.4.1-2"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.4.2",
      "section_id": "5.4.2",
      "section_title": "Detailed behaviour of the HPLMN ProSe Function",
      "content": "The ProSe Function in the HPLMN shall make use of this procedure to retrieve from the ProSe Function in the local PLMN (identified by the PLMN-Id contained in the Prose Application Code) the ProSe Application ID(s) that correspond to ProSe Application Code(s) discovered by the monitoring UE. The HPLMN ProSe Function shall include in the Match Request the Discovery Type set to \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the discovered ProSe Application Code(s) corresponding to the request from the monitoring UE as well as the MIC and UTC-based counter associated with the discovered ProSe Application Code. The request shall include the UE identity (i.e. IMSI or MSISDN) in order to allow the ProSe Function in the local PLMN to perform charging of the monitoring UE. If the metadata information associated with the ProSe Application ID is requested by the UE, the flag \"Metadata Requested\" shall be set in the PMR Flags. The HPLMN ProSe Function may also include the PC5-tech set to the PC5 radio technology that the UE is using.\nWhen receiving the ProSe Match Report response from the ProSe Function in the local PLMN with the Result Code set to \"DIAMETER_SUCCESS\", the HPLMN ProSe Function shall check whether a Match Report is received for each ProSe Application Code sent in the request. If a Match Report is missing for one ProSe Application Code, this ProSe Application Code shall be considered as invalid by the ProSe Function.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.4.3",
      "section_id": "5.4.3",
      "section_title": "Detailed behaviour of the ProSe Function in the local PLMN",
      "content": "When receiving a ProSe Match Report request, the ProSe Function in the local PLMN shall check the value of the Discovery Type contained in the Match Request.\n-\tIf the value indicated in the Discovery Type is not supported, the experimental result code shall be set to \"DIAMETER_ERROR_INVALID_DISCOVERY_TYPE\" in the response.\n-\tIf the value is \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the ProSe Function shallcheck whether that the ProSe Application Code received is authorized to be announced in the monitored PLMN for the specified PC5 radio technology.\n-\tIf not, the experimental result code shall be set to \"DIAMETER_ERROR_ANNOUNCING_UNAUTHORIZED_IN_PLMN\" in the response.\n-\tIf the ProSe Code is authorized to be announced, the ProSe Function shall check the validity of the ProSe Application Code(s) discovered by the monitoring UE, i.e. a ProSe Application ID name is associated and the validity timer has not expired, and the MIC value associated with the ProSe Application Code is valid when verified based on the associated UTC-based counter as defined in 3GPP TS 33.303 [23].\n-\tIf none of the ProSe Application Code(s) is valid in the ProSe Function, i.e. either no ProSe Application Code exists, the validity timer(s) has expired, or MIC check(s) for the ProSe Application Code(s) has failed, the experimental result code shall be set to \"DIAMETER_ERROR_INVALID_APPLICATION_CODE\" in the response sent by the ProSe Function.\n-\tOtherwise, when at least one ProSe Application Code is valid, the ProSe Function shall return the Match Report and set the result code to \"DIAMETER_SUCCESS\" in the response. For each valid ProSe Application code, the Match Report shall contain the matched ProSe Application Code, the ProSe Application ID Name, the validity timer and the match report refresh timer. The Match Report may include metadata associated with the ProSe Application ID if requested and available. The ProSe Function may store the monitoring UE identity (i.e. IMSI or MSISDN) in order to perform charging.\nIf there is an error in any of the above steps then the ProSe Function shall stop processing the request and shall return the error code specified in the respective step.\nIf the ProSe Function cannot fulfil the received request for reasons not stated in the above steps, e.g. due to a database error or any of the required actions cannot be performed, it shall stop processing the request and set the Result Code to \"DIAMETER_UNABLE_TO_COMPLY\".\nIf the ProSe Application Code contains a metadata index, a ProSe-Metadata-Index-Mask AVP shall be provided for this ProSe Application Code.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_33.303"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.5.1",
      "section_id": "5.5.1",
      "section_title": "General",
      "content": "For open discovery, the ProSe Match Report Info Procedure shall be used by the ProSe Function in the HPLMN of the monitoring UE to provide a match report information to the ProSe Function of the visited PLMN in which the announcing UE is roaming. For restricted discovery, the ProSe Match Report Info Procedure shall also be used by the ProSe Function in the HPLMN of the monitoring UE or discoverer UE to provide a match report information to the ProSe Function of the HPLMN of the announcing UE or discoveree UE.\nThis procedure is mapped to the commands ProSe-Match-Report-Info-Request/Answer (PIR/PIA) in the Diameter application specified in clause 6.\nTable 5.5.1-1 specifies the involved information elements for the request.\nTable 5.5.1-2 specifies the involved information elements for the answer.\nTable 5.5.1-1: ProSe Match Report Info Request\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nMatch Report Information\n(See 6.3.56)\nMatch-Report-Info\nC\nThis information element shall contain the information elements used in discovery match report info request. This information element shall be present if the Discovery Type is MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY.\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nTable 5.5.1-2: ProSe Match Report Info Answer\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nResult\n(See 6.4)\nResult-Code / Experimental-Result\nM\nThis IE shall contain the result of the operation.\nThe Result-Code AVP shall be used to indicate success / errors as defined in the Diameter Base Protocol.\nThe Experimental-Result AVP shall be used for PC6/PC7 errors. This is a grouped AVP which shall contain the 3GPP Vendor ID in the Vendor-Id AVP, and the error code in the Experimental-Result-Code AVP.\nThe following errors are applicable:\n- Unknown User",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6",
        "table_5.5.1-1",
        "table_5.5.1-2"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.5.2",
      "section_id": "5.5.2",
      "section_title": "Detailed behaviour of the requesting ProSe Function",
      "content": "When the monitored PLMN-Id provided by the monitoring UE during the Match Report procedure (see clause 5.4) is different from the PLMN-Id contained in the ProSe Application Code discovered by the monitoring UE, i.e. the announcing UE is roaming in a visited PLMN, the monitoring UE's ProSe Function in the HPLMN may make use of this procedure to send a match report information to the ProSe Function in the visited PLMN in which the announcing UE is roaming.. In such case, the HPLMN ProSe Function shall include in the Match Report Information the Discovery Type set to \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\" as well as the ProSe Application ID and the identity of the monitoring UE (i.e. IMSI or MSISDN).\nWhen the HPLMN ProSe Function of the monitoring UE processes a match report for a discovered ProSe Restricted Code from the UE, and finds that the target PDUID for the corresponding discovery entry contains a PLMN-Id different from the PLMN of the ProSe Function, the monitoring UE's ProSe Function in the HPLMN may make use of this procedure to send a match report information to the ProSe Function to which the announcing UE belongs. In such case, the HPLMN ProSe Function shall include in the Match Report Information the Discovery Type set to \"MONITORING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the ProSe Restricted Code, the RPAUID, the target RPAUID and the identity of the monitoring UE (i.e. IMSI or MSISDN). The ProSe Function may also include the timestamp of the match event in the Match Report Information.\nWhen the HPLMN ProSe Function of the discoverer UE processes a match report for a discovered ProSe Response Code from the discoverer UE, and finds that the target PDUID for the corresponding discovery entry contains a PLMN-Id different from the PLMN of the ProSe Function, the discoverer UE's ProSe Function in the HPLMN may make use of this procedure to send a match report information to the ProSe Function to which the discoveree UE belongs. In such case, the HPLMN ProSe Function shall include in the Match Report Information the Discovery Type set to \"DISCOVERER_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the ProSe Response Code, the RPAUID, the target RPAUID and the identity of the discoverer UE (i.e. IMSI or MSISDN). The ProSe Function may also include the timestamp of the match event in the Match Report Information.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.4"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.5.3",
      "section_id": "5.5.3",
      "section_title": "Detailed behaviour of the receiving ProSe Function",
      "content": "When receiving a ProSe Match Report Info request, the ProSe Function shall check the value of the Discovery Type contained in the Match Report Information.\n-\tIf the value indicated in the Discovery Type is not supported, the experimental result code shall be set to \"DIAMETER_ERROR_INVALID_DISCOVERY_TYPE\" in the response.\n-\tIf the value is \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", \"MONITORING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\" or \"DISCOVERER_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the ProSe Function shall check whether the UE Identity (i.e. IMSI or MSISDN) exists.\n-\tIf not, a Result Code of DIAMETER_ERROR_USER_UNKNOWN shall be returned.\n-\tOtherwise, it shall acknowledge the reception of the Match Report info and set the Result Code to \"DIAMETER_SUCCESS\" in the response.\nIf the ProSe Function in the VPLMN cannot fulfil the received request for reasons not stated in the above steps, e.g. due to a database error or any of the required actions cannot be performed, it shall stop processing the request and set the Result Code to \"DIAMETER_UNABLE_TO_COMPLY\" in the response.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.6.1",
      "section_id": "5.6.1",
      "section_title": "General",
      "content": "The ProSe Proximity Request Procedure shall be used by a ProSe Function in charge of the requesting UE to request the ProSe Function in charge of another UE to indicate when two UEs will enter into proximity within a requested time window.\nThis procedure is mapped to the commands ProSe-Proximity-Request/Answer (PRR/PRA) in the Diameter application specified in clause 6.\nTable 5.6.1-1 specifies the involved information elements for the request.\nTable 5.6.1-2 specifies the involved information elements for the answer.\nTable 5.6.1-1: ProSe Proximity Request\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nRequesting EPUID\n(See 6.3.23)\nRequesting-EPUID\nM\nThis Information Element shall contain the EPC ProSe User ID (EPUID) of the UE triggering the Proximity Request.\nTargeted EPUID\n(See 6.3.26)\nTargeted-EPUID\nM\nThis Information Element shall contain the EPC ProSe User ID (EPUID) of the UE targeted by the Proximity Request.\nTime Window\n(See 6.3.27)\nTime-Window\nM\nThis Information Element shall contain the time period during which the Proximity request is valid\nRequesting UE Location\n(See 6.3.10)\nLocation-Estimate\nM\nThis Information Element shall contain the current location of the requesting UE expressed in GAD shapes defined in TS 23.032 [6]\nLocation Update Trigger\n(See 6.3.a)\nLocation-Update-Trigger\nO\nIf present, this Information Element shall contain the trigger that will cause the location updates performed by the ProSe Function.\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nPRR Flags\n(See 6.3.21)\nPRR-Flags\nM\nThis Information Element contains a bit mask. See 6.3.21 for the meaning of the bits.\nTable 5.6.1/2: ProSe Proximity Answer\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nResult\n(See 6.4)\nResult-Code / Experimental-Result\nM\nThis IE shall contain the result of the operation.\nThe Result-Code AVP shall be used to indicate success / errors as defined in the Diameter Base Protocol.\nThe Experimental-Result AVP shall be used for PC6/PC7 errors. This is a grouped AVP which shall contain the 3GPP Vendor ID in the Vendor-Id AVP, and the error code in the Experimental-Result-Code AVP.\nThe following errors are applicable:\n- EPUID unknown\n- Proximity request rejected\n- Proximity unauthorized\nTargeted UE Location\n(See 6.3.10)\nLocation-estimate\nC\nThis Information Element shall contain the current location of the targeted UE expressed in GAD shapes defined in TS 23.032 [6]. This information shall be present when the Result Code is \"DIAMETER_SUCCESS\" and the location of the targeted UE is known.\nWLAN Link Layer ID\n(See 6.3.32)\nWLAN-Link-Layer-Id\nC\nThis Information shall contain the permanent link layer identity used by the targeted UE for WLAN direct discovery and/or WLAN direct communication. It shall be present if the requesting UE has requested EPC support for WLAN direct discovery and if the targeted UE has a permanent WLAN Link Layer ID for communication (e.g. permanent MAC address).",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6",
        "table_5.6.1-1",
        "table_5.6.1-2",
        "table_5.6.1",
        "ts_23.032"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.6.2",
      "section_id": "5.6.2",
      "section_title": "Detailed behaviour of the ProSe Function of the requesting UE",
      "content": "The ProSe Function of the UE triggering the Proximity request shall make use of this procedure to propagate the Proximity request to the ProSe Function of the targeted UE. The ProSe Function shall include in the request the EPC ProSe User Identities of the requesting and targeted UEs, the location of the requesting UE, the validity period of the Proximity request and, the location update trigger. If the requesting UE has requested EPC support for WLAN direct discovery and communication with the targeted UE, the PRR-Flag \"WLAN Indication\" shall be set.\nNOTE:\tThe location update trigger enable the ProSe Function of the targeted UE to configure SUPL reporting in targeted UE using the \"\"Inside\" trigger with Repeated Reporting\" mechanism as defined in OMA AD SUPL [25].\nWhen receiving a ProSe Proximity response from the ProSe Function of the targeted UE, the ProSe Function of the requesting UE shall check the result code. If it indicates SUCCESS, the ProSe Function shall create and manage a context associated with the Proximity request, including the EPUIDs of the UEs, the validity period of this Proximity request and the WLAN indication received in the Proximity request until the execution of the Proximity Alert procedure, the Proximity Request Cancellation procedure or until the expiry of the time window during which the request is valid.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.6.3",
      "section_id": "5.6.3",
      "section_title": "Detailed behaviour of the ProSe Function of the targeted UE",
      "content": "When receiving a ProSe Proximity request, the ProSe Function of the targeted UE, shall, in the following order:\n1.\tCheck whether the EPC ProSe User Identity of the targeted UE exists. If not, a Result Code of DIAMETER_ERROR_USER_UNKNOWN shall be returned.\n2.\tCheck whether the proximity request is authorized by the user. If not, the Proximity request is not authorized by the user, a Result Code of DIAMETER_ERROR_PROXIMITY_UNAUTHORIZED shall be returned.\n3.\tCheck the location of the requesting UE and the time window received in the request and determine whether UEs are likely to enter into proximity based the last known location of the targeted UE. If it is unlikely that UEs enter into proximity for the received time window, a Result Code of DIAMETER_ERROR_PROXIMITY_REJECTED shall be returned in the response.\nIf there is an error in any of the above steps then the ProSe Function shall stop processing the request and shall return the error code specified in the respective step.\nIf the ProSe Function cannot fulfil the received request for reasons not stated in the above steps, e.g. due to a database error or any of the required actions cannot be performed, it shall stop processing the request and set the Result Code to \"DIAMETER_UNABLE_TO_COMPLY\".\nOtherwise, the ProSe Function shall acknowledge the reception of the Proximity and set the Result Code to \"DIAMETER_SUCCESS\" in the response. The message may include the last known location of the targeted UE, if available. The message may also include the permanent WLAN Link Layer ID (e.g. MAC address) of the targeted UE if available and if the PRR-Flag \"WLAN Indication\" was set in the request. The ProSe Function shall create and manage a context associated with the Proximity request, including the identity of ProSe Function triggering the Proximity request, the EPUIDs of the UEs, the validity period of this Proximity request, the WLAN indication, the location update periodicity and/or location update trigger received in the Proximity request until the execution of the Proximity Alert procedure, the Proximity Request Cancellation procedure or until the expiry of the time window during which the request is valid.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.7.1",
      "section_id": "5.7.1",
      "section_title": "General",
      "content": "The ProSe Location Update Procedure shall be used by a ProSe Function to forward the location of UE to the ProSe Function triggering the Proximity Request and in charge of determining the proximity of two UEs.\nThis procedure is mapped to the commands ProSe-Location-Update-Request/Answer (PLR/PLA) in the Diameter application specified in clause 6.\nTable 5.7.1-1 specifies the involved information elements for the request.\nTable 5.7.1-2 specifies the involved information elements for the answer.\nTable 5.7.1-1: ProSe Location Update Request\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nTargeted EPUID\n(See 6.3.26)\nTargeted-EPUID\nM\nThis Information Element shall contain the EPC ProSe User ID (EPUID) of the UE targeted by the Proximity Request.\nTargeted UE Location\n(See 6.3.10)\nLocation-Estimate\nM\nThis Information Element shall contain the current location of the targeted UE expressed in GAD shapes defined in TS 23.032 [6].\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nTable 5.7.1-2: ProSe Location Update Answer\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nResult\n(See 6.4)\nResult-Code / Experimental-Result\nM\nThis IE shall contain the result of the operation.\nThe Result-Code AVP shall be used to indicate success / errors as defined in the Diameter Base Protocol.\nThe Experimental-Result AVP shall be used for PC6/PC7 errors. This is a grouped AVP which shall contain the 3GPP Vendor ID in the Vendor-Id AVP, and the error code in the Experimental-Result-Code AVP.\nThe following errors are applicable:\n- User Unknown\n- Proximity Cancelled",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6",
        "table_5.7.1-1",
        "table_5.7.1-2",
        "ts_23.032"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.7.2",
      "section_id": "5.7.2",
      "section_title": "Detailed behaviour of the ProSe Function of the requesting UE",
      "content": "The ProSe Function of the UE targeted by the Proximity request shall make use of this procedure to periodically update the targeted UE's location in the ProSe Function in charge of Proximity request. The ProSe Function shall include in the request the EPC ProSe User Identity and the location of the targeted UE.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.7.3",
      "section_id": "5.7.3",
      "section_title": "Detailed behaviour of the ProSe Function of the targeted UE",
      "content": "When receiving a ProSe Location Update request, the ProSe Function in charge of the Proximity request shall, in the following order:\n1.\tCheck whether a proximity request exists for the EPC ProSe User Identity received in the request. If there is no pending Proximity request for this EPUID, a Result Code of DIAMETER_ERROR_USER_UNKNOWN shall be returned.\n2.\tCheck the location of the requesting UE and the time window indicated by the requesting UE and determine whether UEs are likely to enter into proximity based the last known location of the targeted UE. If it is unlikely that UEs enter into proximity for the received time window, a Result Code of DIAMETER_ERROR_PROXIMITY_CANCELLED shall be returned in the response.\nIf there is an error in any of the above steps then the ProSe Function shall stop processing the request and shall return the error code specified in the respective step.\nIf the ProSe Function cannot fulfil the received request for reasons not stated in the above steps, e.g. due to a database error or any of the required actions cannot be performed, it shall stop processing the request and set the Result Code to \"DIAMETER_UNABLE_TO_COMPLY\".\nOtherwise, the ProSe Function shall acknowledge the reception of the ProSe Location Update and set the Result Code to \"DIAMETER_SUCCESS\" in the response.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.8.1",
      "section_id": "5.8.1",
      "section_title": "General",
      "content": "The ProSe Cancellation Procedure shall be used between the ProSe Function in the HPLMN and the ProSe Function in the local/visited PLMN. The procedure shall be invoked by the ProSe Function in HPLMN and is used:\n-\tto indicate that the service authorization for ProSe Direct Discovery and ProSe Direct Communication is revoked for this UE.\n-\tto indicate that the Proximity Request sent earlier is cancelled.\nThis procedure is mapped to the commands ProSe-Cancellation-Request/Answer (PCR/PCA) in the Diameter application specified in clause 6.\nTable 5.8.1-1 specifies the involved information elements for the request.\nTable 5.8.1-2 specifies the involved information elements for the answer.\nTable 5.8.1-1: ProSe Cancellation Request\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nRequesting EPUID\n(See 6.3.23)\nRequesting-EPUID\nM\nThis Information Element shall contain the EPC ProSe User ID (EPUID) of the UE triggering the Proximity Request.\nTargeted EPUID\n(See 6.3.26)\nTargeted-EPUID\nM\nThis Information Element shall contain the EPC ProSe User ID (EPUID) of the UE targeted by the Proximity Request.\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nTable 5.8.1-2: ProSe Cancellation Answer\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nResult\n(See 6.4)\nResult-Code / Experimental-Result\nM\nThis IE shall contain the result of the operation.\nThe Result-Code AVP shall be used to indicate success / errors as defined in the Diameter Base Protocol.\nThe Experimental-Result AVP shall be used for PC6/PC7 errors. This is a grouped AVP which shall contain the 3GPP Vendor ID in the Vendor-Id AVP, and the error code in the Experimental-Result-Code AVP.\nThe following errors are applicable:\n- No proximity request",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6",
        "table_5.8.1-1",
        "table_5.8.1-2"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.8.2",
      "section_id": "5.8.2",
      "section_title": "Detailed behaviour of the ProSe Function of the requesting UE",
      "content": "The ProSe Function of the requesting UE shall make use of this procedure to cancel a Proximity Request sent earlier to the ProSe Function in charge of the targeted UE (e.g. due to change in the location of one of the UEs, termination of corresponding application or due to completion of certain event). The ProSe Function shall include in the request the EPC ProSe User Identities of the requesting and targeted UEs.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.8.3",
      "section_id": "5.8.3",
      "section_title": "Detailed behaviour of the ProSe Function of the targeted UE",
      "content": "When receiving a ProSe Cancellation request, the ProSe Function of the targeted UE shall check whether there is a context associated with EPC ProSe User Identities included in the request. If not, the Result Code of DIAMETER_ERROR_NO_PROXIMITY_REQUEST shall be returned. Otherwise, the ProSe Function shall cancel the Proximity request and set the Result Code to \"DIAMETER_SUCCESS\" in the response\nIf the ProSe Function cannot fulfil the received request for reasons not stated in the above steps, e.g. due to a database error or any of the required actions cannot be performed, it shall set the Result Code to \"DIAMETER_UNABLE_TO_COMPLY\".",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.9.1",
      "section_id": "5.9.1",
      "section_title": "General",
      "content": "The ProSe Proximity Alert Procedure shall be used by a ProSe Function in charge of Proximity request to indicate to the ProSe Function of the UE targeted by the Proximity request that UEs enter into proximity and that a Proximity Alert should be sent to the targeted UE.\nThis procedure is mapped to the commands ProSe-Alert-Request/Answer (ALR/ALA) in the Diameter application specified in clause 6.\nTable 5.9.1-1 specifies the involved information elements for the request.\nTable 5.9.1-2 specifies the involved information elements for the answer.\nTable 5.9.1-1: ProSe Proximity Alert Request\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nApplication Layer User ID\n(See 6.3.2)\nApplication-Layer-User-Id\nM\nThis Information Element shall contain the Application Layer User ID of the requesting UE entering into proximity.\nTargeted EPUID\n(See 6.3.26)\nTargeted-EPUID\nM\nThis Information Element shall contain the EPC ProSe User ID (EPUID) of the targeted UE to which the Proximity Alert shall be sent.\nAssistance Information\n(See 6.3.3)\nAssistance-Info\nO\nIf present, this Information Element shall contain the assistance information for WLAN direct discovery and communications if required.\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nTable 5.9.1-2: ProSe Proximity Alert Answer\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nResult\n(See 6.4)\nResult-Code / Experimental-Result\nM\nThis IE shall contain the result of the operation.\nThe Result-Code AVP shall be used to indicate success / errors as defined in the Diameter Base Protocol.\nThe Experimental-Result AVP shall be used for PC6/PC7 errors. This is a grouped AVP which shall contain the 3GPP Vendor ID in the Vendor-Id AVP, and the error code in the Experimental-Result-Code AVP.\nThe following errors are applicable:\n- Announcing Not Authorized\n- No Discovery Filter",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6",
        "table_5.9.1-1",
        "table_5.9.1-2"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.9.2",
      "section_id": "5.9.2",
      "section_title": "Detailed behaviour of the ProSe Function of the targeted UE",
      "content": "The ProSe Function in charge of the Proximity request shall make use of this procedure to indicate to the ProSe Function in charge of the targeted UE that the UEs enter into proximity and a Proximity Aleter should be sent to the targeted UE. The ProSe Function shall include in the request the Application Layer User ID and the EPUID of the requesting UE entering into proximity. It may include assistance information for WLAN direct discovery and communications if required the WLAN indication was included in the Proximity request.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.9.3",
      "section_id": "5.9.3",
      "section_title": "Detailed behaviour of the ProSe Function of the requesting UE",
      "content": "When receiving a ProSe Proximity Alert request, the ProSe Function of the targeted UE, shall, in the following order:\n1.\tCheck whether the EPC ProSe User Identity of the targeted UE exists. If not, a Result Code of DIAMETER_ERROR_USER_UNKNOWN shall be returned.\n2.\tCheck whether the proximity request is authorized by the user. If not, the Proximity request is not authorized by the user, a Result Code of DIAMETER_ERROR_PROXIMITY_UNAUTORIZED shall be returned.\nIf there is an error in any of the above steps then the ProSe Function shall stop processing the request and shall return the error code specified in the respective step.\nIf the ProSe Function cannot fulfil the received request for reasons not stated in the above steps, e.g. due to a database error or any of the required actions cannot be performed, it shall stop processing the request and set the Result Code to \"DIAMETER_UNABLE_TO_COMPLY\".\nOtherwise, the ProSe Function shall acknowledge the reception of the ProSe Proximity Alert request and shall set the Result Code to \"DIAMETER_SUCCESS\" in the response. The ProSe Function shall forward the Proximity Alert to the requesting UE.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.10.1",
      "section_id": "5.10.1",
      "section_title": "General",
      "content": "The ProSe Direct Discovery Authorization Update Procedure shall be used between the ProSe Function in the HPLMN and the ProSe Function in a local PLMN or VPLMN to update authorization for access to the discovery resources and perform ProSe Direct Discovery. The procedure shall be invoked by the ProSe Function in the HPLMN and is used:\n-\tto provide the ProSe Function in Local PLMN with an update for banned users.\nThis procedure is mapped to the commands ProSe-Discovery-Request/Answer (PDR/PDA) in the Diameter application specified in clause 6.\nTable 5.10.1-1 specifies the involved information elements for the request.\nTable 5.10.1-2 specifies the involved information elements for the answer.\nTable 5.10.1-1: ProSe Direct Discovery Authorization Update Request\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nDiscovery Authorization Request\n(See 6.3.53)\nDiscovery-Auth-Request\nM\nThis information element shall contain the information elements used in discovery authorization request.\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nDiscovery Entry ID\n(See 6.3.59)\nDiscovery-Entry-ID\nC\nThis Information Element contains the discovery entry ID used by the sending ProSe Function to identify the discovery entry related to this request.\nTable 5.10.1-2: ProSe Direct Discovery Authorization Update Answer\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nResult\n(See 6.4)\nResult-Code / Experimental-Result\nM\nThis IE shall contain the result of the operation.\nThe Result-Code AVP shall be used to indicate success / errors as defined in the Diameter Base Protocol.\nThe Experimental-Result AVP shall be used for PC6/PC7 errors. This is a grouped AVP which shall contain the 3GPP Vendor ID in the Vendor-Id AVP, and the error code in the Experimental-Result-Code AVP.\nThe following errors are applicable:\n- Announcing Not Authorized\n- No Associated Discovery Filter\nDiscovery Authorization Response\n(See 6.3.53)\nDiscovery-Auth-Response\nC\nThis information element shall contain the information elements used in discovery authorization response. This information element shall be present if the Result Code AVP is DIAMETER_SUCCESS.\nDiscovery Entry ID\n(See 6.3.59)\nDiscovery-Entry-ID\nC\nThis Information Element contains the discovery entry ID used by the sending ProSe Function to identify the discovery entry related to this request.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6",
        "table_5.10.1-1",
        "table_5.10.1-2"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.10.2",
      "section_id": "5.10.2",
      "section_title": "Detailed behaviour of the HPLMN ProSe Function",
      "content": "The ProSe Function in the HPLMN shall make use of this procedure to revoke permissions to discover a ProSe Restricted Code given to users served by the ProSe Function located in a Local PLMN. The HPLMN ProSe Function shall include in the request the Discovery Entry ID and shall include in the Discovery Authorization Request the Discovery Type set to \"MONITORING_UPDATE_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the application identity, the ProSe-restricted-Code, Banned RPAUID and Banned PDUID of a monitoring target.When receiving the ProSe Direct Discovery Authorization Update response with the Result Code set to \"DIAMETER_SUCCESS\" for a request with the Discovery Type set to \"MONITORING_UPDATE_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the HPLMN ProSe Function shall start a timer to wait for the ProSe Funciton in Local PLMN/VPLMN to report the result of the Direct Discovery Authorization Update procedure for the monitoring operation, i.e., whether the ProSe Discovery Filter(s) for monitoring this ProSe Restricted Code has been successfully revoked in the banned UE.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.10.3",
      "section_id": "5.10.3",
      "section_title": "Detailed behaviour of the ProSe Function in the local PLMN or VPLMN",
      "content": "When receiving a ProSe Direct Discovery Authorization Update request, the ProSe Function in the local PLMN or VPLMN shall process the request in the following order to check whether the monitoring is authorized.\n-\tThe ProSe function shall check if the Banned PDUID belongs to its own PLMN.\n-\tIf not, the experimental result code shall be set to \"DIAMETER_ERROR_INVALID_TARGET_PDUID\" in the response sent by the ProSe Function.\n-\tIf the Banned PDUID belongs to its own PLMN, the ProSe function may check if the requesting RPAUID is allowed to discovery the Banned RPAUID.\n-\tIf not, the experimental result code shall be set to \"DIAMETER_ERROR_INVALID_TARGET_RPAUID\" in the response sent by the ProSe Function;\n-\tOtherwise, the ProSe Function shall set the result code to \"DIAMETER_SUCCESS\" in the response.\nIf the ProSe Function cannot fulfil the received request for reasons not stated in the above steps, e.g. due to a database error or any of the required actions cannot be performed, it shall set the Result Code to \"DIAMETER_UNABLE_TO_COMPLY\".",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.11.1",
      "section_id": "5.11.1",
      "section_title": "General",
      "content": "The ProSe Direct Discovery Authorization Update Result Procedure shall be used between the ProSe Function in the local PLMN and the ProSe Function in the HPLMN to report the result of ProSe Direct Discovery Authorization Update in Local PLMN to the the ProSe Function in the HPLMN. In this case the procedure shall be invoked by the ProSe Function in the local PLMN and is used:\n-\tto report the result of Direct Discovery Authorization Update procedure initiated by the ProSe Function in the HPLMN.\nThis procedure is mapped to the commands ProSe-Discovery-Request/Answer (PDR/PDA) in the Diameter application specified in clause 6.\nTable 5.11.1-1 specifies the involved information elements for the request.\nTable 5.11.1-2 specifies the involved information elements for the answer.\nTable 5.11.1-1: ProSe Direct Discovery Authorization Update Result Request\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nDiscovery Authorization Request\n(See 6.3.53)\nDiscovery-Auth-Request\nM\nThis information element shall contain the information elements used in discovery authorization request.\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nDiscovery Entry ID\n(See 6.3.59)\nDiscovery-Entry-ID\nC\nThis Information Element contains the discovery entry ID used by the sending ProSe Function to identify the discovery entry related to this request.\nTable 5.11.1-2: ProSe Direct Discovery Authorization Update Result Answer\nInformation element name\nMapping to Diameter AVP\nCat.\nDescription\nSupported Features\n(See 6.3.24)\nSupported-Features\nO\nIf present, this information element shall contain the list of features supported by the origin host.\nResult\n(See 6.4)\nResult-Code / Experimental-Result\nM\nThis IE shall contain the result of the operation.\nThe Result-Code AVP shall be used to indicate success / errors as defined in the Diameter Base Protocol.\nThe Experimental-Result AVP shall be used for PC6/PC7 errors. This is a grouped AVP which shall contain the 3GPP Vendor ID in the Vendor-Id AVP, and the error code in the Experimental-Result-Code AVP.\nThe following errors are applicable:\n- Announcing Not Authorized\n- No Associated Discovery Filter\nDiscovery Authorization Response\n(See 6.3.53)\nDiscovery-Auth-Response\nC\nThis information element shall contain the information elements used in discovery authorization response. This information element shall be present if the Result Code AVP is DIAMETER_SUCCESS.\nDiscovery Entry ID\n(See 6.3.59)\nDiscovery-Entry-ID\nC\nThis Information Element contains the discovery entry ID used by the sending ProSe Function to identify the discovery entry related to this request.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6",
        "table_5.11.1-1",
        "table_5.11.1-2"
      ]
    },
    {
      "chunk_id": "ts_29.345_5.11.2",
      "section_id": "5.11.2",
      "section_title": "Detailed behaviour of the ProSe Function in the local PLMN",
      "content": "The ProSe Function in the local PLMN shall make use of this procedure to report to the ProSe Function in HPLMN the result of the ProSe Direct Discovery Authorization Update for restricted ProSe Direct Discovery. The local PLMN ProSe Function shall include in the Discovery Authorization Update Result Request the Discovery Entry ID and the Discovery Type set to \"MONITORING_RESPONSE_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the application identity, the ProSe-Restricted-Code, Banned RPAUID and Banned PDUID of a monitoring target, result of the monitoring update operation.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_5.11.3",
      "section_id": "5.11.3",
      "section_title": "Detailed behaviour of the HPLMN ProSe Function",
      "content": "When receiving a ProSe Direct Discovery Authorization Update Result request (Discovery Type set to \"MONITORING_RESPONSE_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\" in the PDR command), the ProSe Function in the HPLMN shall check whether there exists a discovery entry matching the Discovery Entry ID included in the request. If yes, then the ProSe Function shall update the result for the given ProSe Restricted Code or ProSe Restricted Code Prefix in this entry regarding the revocation operation for banned RPAUID and banned PDUID indicated in the request message.\n-\tIf not, the experimental result code shall be set to \"DIAMETER_ERROR_NO_ASSOCIATED_RESTRICTED_CODE\" in the response sent by the ProSe Function.\n-\tIf it exists, the ProSe Function shall set the result code to \"DIAMETER_SUCCESS\" in the Discovery AuthorizationUpdate Result response and shall store the outcome of the operation provided to be able to forward this to the UE.\nIf the ProSe Function cannot fulfil the received request for reasons not stated in the above steps, e.g. due to a database error or any of the required actions cannot be performed, it shall set the Result Code to \"DIAMETER_UNABLE_TO_COMPLY\".",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.1.1",
      "section_id": "6.1.1",
      "section_title": "Use of Diameter base protocol",
      "content": "The Diameter Base Protocol as specified in IETF RFC 6733 [29] shall apply except as modified by the defined support of the methods and the defined support of the commands and AVPs, result and error codes as specified in this specification. Unless otherwise specified, the procedures (including error handling and unrecognised information handling) shall be used unmodified.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.1.2",
      "section_id": "6.1.2",
      "section_title": "Securing Diameter Messages",
      "content": "For secure transport of Diameter messages, see 3GPP TS 33.210 [8].",
      "chunk_type": "general",
      "cross_references": [
        "ts_33.210"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.1.3",
      "section_id": "6.1.3",
      "section_title": "Accounting functionality",
      "content": "Accounting functionality (Accounting Session State Machine, related command codes and AVPs) shall not be used on the PC6/PC7 interfaces.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.1.4",
      "section_id": "6.1.4",
      "section_title": "Use of sessions",
      "content": "Between the ProSe Functions, Diameter sessions shall be implicitly terminated. An implicitly terminated session is one for which the server does not maintain state information. The client shall not send any re-authorization or session termination requests to the server.\nThe Diameter base protocol includes the Auth-Session-State AVP as the mechanism for the implementation of implicitly terminated sessions.\nThe client (server) shall include in its requests (responses) the Auth-Session-State AVP set to the value NO_STATE_MAINTAINED (1), as described in IETF RFC 6733 [29]. As a consequence, the server shall not maintain any state information about this session and the client shall not send any session termination request. Neither the Authorization-Lifetime AVP nor the Session-Timeout AVP shall be present in requests or responses.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.1.5",
      "section_id": "6.1.5",
      "section_title": "Transport protocol",
      "content": "Diameter messages over the PC6/PC7 interfaces shall make use of SCTP IETF RFC 4960 [9].",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.1.6",
      "section_id": "6.1.6",
      "section_title": "Routing considerations",
      "content": "This clause specifies the use of the Diameter routing AVPs Destination-Realm and Destination-Host.\nThe Destination-Realm AVP shall contain the network domain name of the targeted ProSe Function. The network domain name is either known by the sending ProSe Function or derived from the PLMN-Id of the targeted ProSe Function to construct the EPC Home Network Realm/Domain, as indicated in 3GPP TS 23.003 [4], clause 19.2.\nIf a ProSe Function knows the address/name of the ProSe Function in charge of a given UE, and the associated network domain name, both the Destination-Realm and Destination-Host AVPs shall be present in the request.\nIf a ProSe Function knows only the network domain name, the Destination-Realm AVP shall be present and the command shall be routed to the next Diameter node.\nConsequently, the Destination-Realm AVP is declared as mandatory and the Destination-Host AVP is declared as optional in the ABNF for all requests initiated by a ProSe Function.\nIf the Vendor-Specific-Application-ID AVP is received in any of the commands defined in this specification, it shall be ignored by the receiving node, and it shall not be used for routing purposes.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_23.003_clause_19.2",
        "ts_23.003"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.1.7",
      "section_id": "6.1.7",
      "section_title": "Advertising Application Support",
      "content": "The ProSe Functions shall advertise support of the Diameter Inter ProSe Functions Application by including the value of the application identifier in the Auth-Application-Id AVP within the Vendor-Specific-Application-Id grouped AVP of the Capabilities-Exchange-Request and Capabilities-Exchange-Answer commands.\nThe vendor identifier value of 3GPP (10415) shall be included in the Supported-Vendor-Id AVP of the Capabilities-Exchange-Request and Capabilities-Exchange-Answer commands, and in the Vendor-Id AVP within the Vendor-Specific-Application-Id grouped AVP of the Capabilities-Exchange-Request and Capabilities-Exchange-Answer commands.\nThe Vendor-Id AVP included in Capabilities-Exchange-Request and Capabilities-Exchange-Answer commands that is not included in the Vendor-Specific-Application-Id AVPs as described above shall indicate the manufacturer of the Diameter node as per IETF RFC 6733 [29].",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.1.8",
      "section_id": "6.1.8",
      "section_title": "Diameter Application Identifier",
      "content": "The Diameter Inter ProSe Functions Application protocol shall be defined as an IETF vendor specific Diameter application, where the vendor is 3GPP. The vendor identifier assigned by IANA to 3GPP (http://www.iana.org/assignments/enterprise-numbers) is 10415.\nThe Diameter application identifier assigned to the Diameter Inter ProSe Functions application is 16777340 (allocated by IANA). The same Diameter application identifier is used over the PC6 interface and the PC7 interface.",
      "chunk_type": "parameter",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.1.9",
      "section_id": "6.1.9",
      "section_title": "Use of the Supported-Features AVP",
      "content": "When new functionality is introduced on the PC6/PC7 interfaces, it should be defined as optional. If backwards incompatible changes cannot be avoided, the new functionality shall be introduced as a new feature and support advertised with the Supported-Features AVP. The usage of the Supported-Features AVP on the PC6/PC7 interfaces is consistent with the procedures for the dynamic discovery of supported features as defined in clause 7.2 of 3GPP TS 29.229 [10].\nWhen extending the application by adding new AVPs for a feature, the new AVPs shall have the M bit cleared and the AVP shall not be defined mandatory in the command ABNF.\nAs defined in 3GPP TS 29.229 [10], the Supported-Features AVP is of type grouped and contains the Vendor-Id, Feature-List-ID and Feature-List AVPs. On the all reference points as specified in this specification, the Supported-Features AVP is used to identify features that have been defined by 3GPP and hence, for features defined in this document, the Vendor-Id AVP shall contain the vendor ID of 3GPP (10415). If there are multiple feature lists defined for the reference point, the Feature-List-ID AVP shall differentiate those lists from one another.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.229_clause_7.2",
        "ts_29.229"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.2.1",
      "section_id": "6.2.1",
      "section_title": "Introduction",
      "content": "This clause defines the Command code values and related ABNF for each command described in this specification.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.2",
      "section_id": "6.2.2",
      "section_title": "Command-Code values",
      "content": "This csublause defines Command-Code values for the Diameter Inter ProSe Functions application used over the PC6/PC7 interfaces as allocated by IANA.\nEvery command is defined by means of the ABNF syntax IETF RFC 5234 [11], according to the Command Code Format (CCF) specification defined in IETF RFC 6733 [29]. In the case, the definition and use of an AVP is not specified in this document, the guidelines in IETF RFC 6733 [29] shall apply.\nThe Vendor-Specific-Application-Id AVP shall not be included in any command sent by Diameter nodes supporting applications defined in this specification. If the Vendor-Specific-Application-Id AVP is received in any of the commands defined in this specification, it shall be ignored by the receiving node.\nNOTE:\tThe Vendor-Specific-Application-Id is included as an optional AVP in all Command Code Format specifications defined in this specification in order to overcome potential interoperability issues with intermediate Diameter agents non-compliant with IETF RFC 6733 [29].\nThe following Command Codes are defined in this specification:\nTable 6.2.2-1: Command-Code values for Diameter ProSe Inter Functions Application\nCommand-Name\nAbbreviation\nCode\nClause\nProSe-Authorization-Request\nPAR\n8388668\n6.2.3\nProSe-Authorization-Answer\nPAA\n8388668\n6.2.4\nProSe-Discovery-Request\nPDR\n8388669\n6.2.5\nProSe-Discovery-Answer\nPDA\n8388669\n6.2.6\nProSe-Match-Request\nPMR\n8388670\n6.2.7\nProSe-Match-Answer\nPMA\n8388670\n6.2.8\nProSe-Match-Report-Info-Request\nPIR\n8388671\n6.2.9\nProSe-Match-Report-Info-Answer\nPIA\n8388671\n6.2.10\nProSe-Proximity-Request\nPRR\n8388672\n6.2.11\nProSe-Proximity-Answer\nPRA\n8388672\n6.2.12\nProSe-Location-Update-Request\nPLR\n8388673\n6.2.13\nProSe-Location-Update-Answer\nPLA\n8388673\n6.2.14\nProSe-Alert-Request\nALR\n8388674\n6.2.15\nProSe-Alert-Answer\nALA\n8388674\n6.2.16\nProSe-Cancellation-Request\nPCR\n8388675\n6.2.17\nProSe-Cancellation-Answer\nPCA\n8388675\n6.2.18\nFor these commands, the Application-ID field shall be set to 16777340 (application identifier of the Diameter Inter ProSe Functions interface application, allocated by IANA).",
      "chunk_type": "general",
      "cross_references": [
        "table_6.2.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.2.3",
      "section_id": "6.2.3",
      "section_title": "ProSe-Authorization-Request (PAR) Command",
      "content": "The ProSe-Authorization-Request (PAR) Command, indicated by the Command-Code field set to 8388668 and the \"R\" bit set in the Command Flags field, is sent from the ProSe Function in the HPLMN to the ProSe Function in Local PLMN/VPLMN.\nMessage Format\n< ProSe-Authorization-Request > ::=\t< Diameter Header: 8388668, REQ, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n[ Destination-Host ]\n{ Destination-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n{ User-Identity }\n{ Visited-PLMN-Id }\n*[ AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.4",
      "section_id": "6.2.4",
      "section_title": "ProSe-Authorization-Answer (PAA) Command",
      "content": "The ProSe-Authorization-Answer (PAA) Command, indicated by the Command-Code field set to 8388668 and the \"R\" bit cleared in the Command Flags field, is sent from the ProSe Function in Local PLMN/VPLMN to the ProSe Function in the HPLMN.\nMessage Format\n< ProSe-Authorization-Answer> ::=\t< Diameter Header: 8388668, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n[ Result-Code ]\n[ Experimental-Result ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n*[ Load ]\n[ ProSe-Direct-Allowed]\n[ Validity-Time-Announce ]\n[ Validity-Time-Monitor ]\n[ Validity-Time-Communication ]\n[ Authorized-Discovery-Range ]\n*[ AVP ]\n[ Failed-AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.5",
      "section_id": "6.2.5",
      "section_title": "ProSe-Discovery-Request (PDR) Command",
      "content": "The ProSe-Discovery-Request (PDR) Command, indicated by the Command-Code field set to 8388669 and the \"R\" bit set in the Command Flags field, is sent from the ProSe Function in the HPLMN to the ProSe Function in Local PLMN.\nMessage Format\n< ProSe-Discovery-Request > ::=\t< Diameter Header: 8388669, REQ, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n[ Destination-Host ]\n{ Destination-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n{ Discovery-Auth-Request }\n[ Discovery-Entry-ID ]\n*[ AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.6",
      "section_id": "6.2.6",
      "section_title": "ProSe-Discovery-Answer (PDA) Command",
      "content": "The ProSe-Discovery-Answer (PDA) Command, indicated by the Command-Code field set to 8388669 and the \"R\" bit cleared in the Command Flags field, is sent from the ProSe Function in Local PLMN to the ProSe Function in the HPLMN.\nMessage Format\n< ProSe-Discovery-Answer > ::=\t< Diameter Header: 8388669, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n[ Result-Code ]\n[ Experimental-Result ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n*[ Load ]\n[ Discovery-Auth-Response ]\n[ Discovery-Entry-ID ]\n*[ AVP ]\n[ Failed-AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.7",
      "section_id": "6.2.7",
      "section_title": "ProSe-Match-Request (PMR) Command",
      "content": "The ProSe-Match-Request (PMR) Command, indicated by the Command-Code field set to 8388670 and the \"R\" bit set in the Command Flags field, is sent from the ProSe Function in the HPLMN to the ProSe Function in Local PLMN.\nMessage Format\n< ProSe-Match-Request > ::=\t< Diameter Header: 8388670, REQ, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n[ Destination-Host ]\n{ Destination-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n{ Match-Request }\n[ PMR-Flags ]\n*[ AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.8",
      "section_id": "6.2.8",
      "section_title": "ProSe-Match-Answer (PMA) Command",
      "content": "The ProSe-Match-Answer (PMA) Command, indicated by the Command-Code field set to 8388670 and the \"R\" bit cleared in the Command Flags field, is sent from the ProSe Function in Local PLMN to the ProSe Function in the HPLMN.\nMessage Format\n< ProSe-Match-Answer > ::=\t< Diameter Header: 8388670, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n[ Result-Code ]\n[ Experimental-Result ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n*[ Load ]\n*[ Match-Report ]\n*[ AVP ]\n[ Failed-AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.9",
      "section_id": "6.2.9",
      "section_title": "ProSe-Match-Report-Info-Request (PIR) Command",
      "content": "The ProSe-Match-Report-Info-Request (PIR) Command, indicated by the Command-Code field set to 8388671 and the \"R\" bit set in the Command Flags field, is sent from the ProSe Function in the HPLMN of the monitoring UE to the ProSe Function of the PLMN in which the announcing UE is roaming.\nMessage Format\n< ProSe-Match-Report-Info-Request > ::=\t< Diameter Header: 8388671, REQ, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n[ Destination-Host ]\n{ Destination-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n{ Match-Report-Info }\n*[ AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.10",
      "section_id": "6.2.10",
      "section_title": "ProSe-Match-Report-Info-Answer (PIA) Command",
      "content": "The ProSe-Match-Report-Info-Answer (PIA) Command, indicated by the Command-Code field set to 8388671 and the \"R\" bit cleared in the Command Flags field, is sent from the ProSe Function of the PLMN in which the announcing UE is roaming to the ProSe Function in the HPLMN of the monitoring UE.\nMessage Format\n< ProSe-Match-Report-Info-Answer > ::=\t< Diameter Header: 8388671, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n[ Result-Code ]\n[ Experimental-Result ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n*[ Load ]\n*[ AVP ]\n[ Failed-AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.11",
      "section_id": "6.2.11",
      "section_title": "ProSe-Proximity-Request (PRR) Command",
      "content": "The ProSe-Proximity-Request (PRR) Command, indicated by the Command-Code field set to 8388672 and the \"R\" bit set in the Command Flags field, is sent from the ProSe Function in the HPLMN to the ProSe Function of another PLMN.\nMessage Format\n< ProSe-Proximity-Request > ::=\t< Diameter Header: 8388672, REQ, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n[ Destination-Host ]\n{ Destination-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n{ PRR-Flags }\n{ Requesting-EPUID }\n{ Targeted-EPUID }\n{ Time-Window }\n{ Location-Estimate }\n[ Location-Update-Trigger ]\n*[ AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.12",
      "section_id": "6.2.12",
      "section_title": "ProSe-Proximity-Answer (PRA) Command",
      "content": "The ProSe-Proximity-Answer (PRA) Command, indicated by the Command-Code field set to 8388672 and the \"R\" bit cleared in the Command Flags field, is sent from the ProSe Function in the HPLMN to the ProSe Function of another PLMN.\nMessage Format\n< ProSe-Proximity-Answer > ::=\t< Diameter Header: 8388672, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n[ Result-Code ]\n[ Experimental-Result ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n*[ Load ]\n[ Location-Estimate ]\n[WLAN-Link-Layer-Id ]\n*[ AVP ]\n[ Failed-AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.13",
      "section_id": "6.2.13",
      "section_title": "ProSe-Location-Update-Request (PLR) Command",
      "content": "The ProSe-Location-Update-Request (PLR) Command, indicated by the Command-Code field set to 8388673 and the \"R\" bit set in the Command Flags field, is sent from the ProSe Function in the HPLMN to the ProSe Function of another PLMN.\nMessage Format\n< ProSe-Location-Update-Request > ::=\t< Diameter Header: 8388673, REQ, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n[ Destination-Host ]\n{ Destination-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n{ Targeted-EPUID }\n{ Location-Estimate }\n*[ AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.14",
      "section_id": "6.2.14",
      "section_title": "ProSe-Location-Update-Answer (PLA) Command",
      "content": "The ProSe-Location-Update-Answer (PLA) Command, indicated by the Command-Code field set to 8388673 and the \"R\" bit cleared in the Command Flags field, is sent from the ProSe Function in the HPLMN to the ProSe Function of another PLMN.\nMessage Format\n< ProSe-Location-Update-Answer > ::=\t< Diameter Header: 8388673, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n[ Result-Code ]\n[ Experimental-Result ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n*[ Load ]\n*[ AVP ]\n[ Failed-AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.15",
      "section_id": "6.2.15",
      "section_title": "ProSe-Alert-Request (ALR) Command",
      "content": "The ProSe-Alert-Request (ALR) Command, indicated by the Command-Code field set to 8388674 and the \"R\" bit set in the Command Flags field, is sent from the ProSe Function in the HPLMN to the ProSe Function of another PLMN.\nMessage Format\n< ProSe-Alert-Request > ::=\t< Diameter Header: 8388674, REQ, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n[ Destination-Host ]\n{ Destination-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n{ App-Layer-User-Id }\n{ Targeted-EPUID }\n[ Assistance-Info ]\n*[ AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.16",
      "section_id": "6.2.16",
      "section_title": "ProSe-Alert-Answer (ALA) Command",
      "content": "The ProSe-Alert-Answer (ALA) Command, indicated by the Command-Code field set to 8388674 and the \"R\" bit cleared in the Command Flags field, is sent from the ProSe Function in the HPLMN to the ProSe Function of another PLMN.\nMessage Format\n< ProSe-Alert-Answer > ::=\t< Diameter Header: 8388674, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n[ Result-Code ]\n[ Experimental-Result ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n*[ Load ]\n*[ AVP ]\n[ Failed-AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.17",
      "section_id": "6.2.17",
      "section_title": "ProSe-Cancellation-Request (PCR) Command",
      "content": "The ProSe-Cancellation-Request (PCR) Command, indicated by the Command-Code field set to 8388675 and the \"R\" bit set in the Command Flags field, is sent from the ProSe Function in the HPLMN to the ProSe Function in a local/visited PLMN.\nMessage Format\n< ProSe-Cancellation-Request > ::=\t< Diameter Header: 8388675, REQ, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n[ Destination-Host ]\n{ Destination-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n{ Requesting-EPUID }\n{ Targeted-EPUID }\n*[ AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.2.18",
      "section_id": "6.2.18",
      "section_title": "ProSe-Cancellation-Answer (PCA) Command",
      "content": "The ProSe-Cancellation-Answer (PCA) Command, indicated by the Command-Code field set to 8388675 and the \"R\" bit cleared in the Command Flags field, is sent from the ProSe Function in a local/visited PLMN to the ProSe Function in the HPLMN.\nMessage Format\n< ProSe-Cancellation-Answer > ::=\t< Diameter Header: 8388675, PXY, 16777340 >\n< Session-Id >\n[ DRMP ]\n[ Vendor-Specific-Application-Id ]\n[ Result-Code ]\n[ Experimental-Result ]\n{ Auth-Session-State }\n{ Origin-Host }\n{ Origin-Realm }\n*[ Supported-Features ]\n[ OC-Supported-Features ]\n[ OC-OLR ]\n*[ Load ]\n*[ AVP ]\n[ Failed-AVP ]\n*[ Proxy-Info ]\n*[ Route-Record ]",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.1",
      "section_id": "6.3.1",
      "section_title": "General",
      "content": "The following table (table 6.3.1-1) specifies the Diameter AVPs defined for the PC6/PC7 interfaces, their AVP Code values, types, possible flag values and whether or not the AVP may be encrypted. The Vendor-ID header of all AVPs defined in this specification shall be set to 3GPP (10415).\nFor all AVPs which contain bit masks and are of the type Unsigned32 e.g., PRR-Flags, bit 0 shall be the least significant bit. For example, to get the value of bit 0, a bit mask of 0x0001 shall be used.\nTable 6.3.1-1: PC6/PC7 specific Diameter AVPs\nAVP Flag rules\nAttribute Name\nAVP Code\nClause\ndefined\nValue Type\nMust\nMay\nShould not\nMust not\nMay Encr.\nApp-Layer-User-Id\n3801\n6.3.2\nUTF8String\nM, V\nNo\nAssistance-info\n3802\n6.3.3\nGrouped\nM, V\nNo\nAssistance-Info-Validity-Timer\n3803\n6.3.4\nUnsigned32\nM, V\nNo\nDiscovery-Type\n3804\n6.3.5\nUnsigned32\nM, V\nNo\nFilter-Id\n3805\n6.3.9\nOctetString\nM, V\nNo\nMAC-Address\n3806\n6.3.11\nUTF8String\nM, V\nNo\nMatch-Report\n3807\n6.3.12\nGrouped\nM, V\nNo\nOperating-Channel\n3808\n6.3.14\nUnsigned32\nM, V\nNo\nP2P-Features\n3809\n6.3.15\nUnsigned32\nM, V\nNo\nProSe-App-Code\n3810\n6.3.16\nOctetString\nM, V\nNo\nProSe-App-Id\n3811\n6.3.17\nUTF8String\nM, V\nNo\nProSe-App-Mask\n3812\n6.3.18\nOctetString\nM, V\nNo\nProSe-Discovery-Filter\n3813\n6.3.20\nGrouped\nM, V\nNo\nPRR-Flags\n3814\n6.3.21\nUnsigned32\nM, V\nNo\nProSe-Validity-Timer\n3815\n6.3.22\nUnsigned32\nM, V\nNo\nRequesting-EPUID\n3816\n6.3.23\nUTF8String\nM, V\nNo\nTargeted-EPUID\n3817\n6.3.26\nUTF8String\nM, V\nNo\nTime-Window\n3818\n6.3.27\nUnsigned32\nM, V\nNo\nWiFi-P2P-Assistance-Info\n3819\n6.3.30\nGrouped\nM, V\nNo\nWLAN-Assistance-Info\n3820\n6.3.31\nGrouped\nM, V\nNo\nWLAN-Link-Layer-Id\n3821\n6.3.32\nOctetString\nM, V\nNo\nWLAN-Link-Layer-Id-List\n3822\n6.3.33\nGrouped\nM, V\nNo\nLocation-Update-Trigger\n3823\n6.3.42\nGrouped\nM,V\nNo\nLocation-Update-Event-Type\n3824\n6.3.43\nUnsigned32\nM,V\nNo\nChange-Of-Area-Type\n3825\n6.3.44\nGrouped\nM,V\nNo\nLocation-Update-Event-Trigger\n3826\n6.3.45\nUnsigned32\nM,V\nNo\nReport-Cardinality\n3827\n6.3.46\nEnumerated\nM,V\nNo\nMinimum-Interval-Time\n3828\n6.3.47\nUnsigned32\nM,V\nNo\nPeriodic-Location-Type\n3829\n6.3.48\nGrouped\nM,V\nNo\nLocation-Report-Interval-Time\n3830\n6.3.49\nUnsigned32\nM,V\nNo\nTotal-Number-Of-Reports\n3831\n6.3.50\nUnsigned32\nM,V\nNo\nValidity-Time-Announce\n3832\n6.3.36\nUnsigned32\nM, V\nNo\nValidity-Time-Monitor\n3833\n6.3.37\nUnsigned32\nM, V\nNo\nValidity-Time-Communication\n3834\n6.3.38\nUnsigned32\nM, V\nNo\nProSe-App-Code-Info\n3835\n6.3.39\nGrouped\nM. V\nNo\nMIC\n3836\n6.3.40\nOctetString\nM, V\nNo\nUTC-based-Counter\n3837\n6.3.41\nUnsigned32\nM. V\nNo\nProSe-Match-Refresh-Timer\n3838\n6.3.52\nUnsigned32\nM, V\nNo\nProSe-Metadata-Index-Mask\n3839\n6.3.60\nOctetString\nV\nM\nNo\nApp-Identifier\n3840\n6.3.61\nGroup\nV\nM\nNo\nOS-ID\n3841\n6.3.62\nOctetString\nV\nM\nNo\nOS-App-ID\n3842\n6.3.63\nUTF8String\nV\nM\nNo\nRequesting-RPAUID\n3843\n6.3.64\nUTF8String\nV\nM\nNo\nTarget-RPAUID\n3844\n6.3.65\nUTF8String\nV\nM\nNo\nTarget-PDUID\n3845\n6.3.66\nOctetString\nV\nM\nNo\nProSe-Restricted-Code\n3846\n6.3.67\nOctetString\nV\nM\nNo\nProSe-Restricted-Code-Suffix-Range\n3847\n6.3.68\nOctetString\nV\nM\nNo\nBeginning-Suffix\n3848\n6.3.69\nOctetString\nV\nM\nNo\nEnding-Suffix\n3849\n6.3.70\nOctetString\nV\nM\nNo\nDiscovery-Entry-ID\n3850\n6.3.59\nUnsigned32\nV\nM\nNo\nMatch-Timestamp\n3851\n6.3.71\nTime\nV\nM\nNo\nPMR-Flags\n3852\n6.3.57\nUnsigned32\nM,V\nNo\nProSe-Application-Metadata\n3853\n6.3.58\nUTF8String\nM,V\nNo\nDiscovery-Auth-Request\n3854\n6.3.53\nGrouped\nM, V\nNo\nDiscovery-Auth-Response\n3855\n6.3.54\nGrouped\nM, V\nNo\nMatch-Request\n3856\n6.3.55\nGrouped\nM, V\nNo\nMatch-Report-Info\n3857\n6.3.56\nGrouped\nM, V\nNo\nBanned-RPAUID\n3858\n6.3.73\nUTF8String\nV\nM\nNo\nBanned-PDUID\n3859\n6.3.74\nOctetString\nV\nM\nNo\nCode-Receiving-Security-Material\n3860\n6.3.75\nGrouped\nV\nM\nNo\nCode-Sending-Security-Material\n3861\n6.3.76\nGrouped\nV\nM\nNo\nDUSK\n3862\n6.3.77\nOctetString\nV\nM\nNo\nDUIK\n3863\n6.3.78\nOctetString\nV\nM\nNo\nDUCK\n3864\n6.3.79\nOctetString\nV\nM\nNo\nMIC-Check-indicator\n3865\n6.3.80\nUnsigned32\nV\nM\nNo\nEncrypted-Bitmask\n3866\n6.3.81\nOctetString\nV\nM\nNo\nProSe-App-Code-Suffix-Range\n3867\n6.3.82\nOctetString\nV\nM\nNo\nPC5-tech\n3868\n6.3.84\nOctetString\nV\nM\nNo\nNOTE 1:\tThe AVP header bit denoted as \"M\", indicates whether support of the AVP is required. The AVP header bit denoted as \"V\" indicates whether the optional Vendor-ID field is present in the AVP header. For further details, see IETF RFC 6733 [29].\nNOTE 2:\tIf the M-bit is set for an AVP and the receiver does not understand the AVP, it shall return a rejection. If the M-bit is not set for an AVP, the receiver shall not return a rejection, whether or not it understands the AVP. If the receiver understands the AVP but the M-bit value does not match with the definition in this table, the receiver shall ignore the M-bit.\nThe following table (table 6.3.1-2) specifies the Diameter AVPs re-used by the PC6/PC7 interfaces from existing Diameter Applications, including a reference to their respective specifications and when needed, a short description of their use within PC6/PC7 interfaces.\nAny other AVPs from existing Diameter Applications, except for the AVPs from Diameter Base Protocol, do not need to be supported. The AVPs from Diameter Base Protocol are not included in table 6.3.1-2.\nTable 6.3.1-2: PC6/PC7 re-used Diameter AVPs\nAttribute Name\nReference\nComments\nM-bit\nSupported-Features\n3GPP TS 29.229 [10]\nEAP-Master-Session-Key\nIETF RFC 4072 [12]\nFeature-List-ID\n3GPP TS 29.229 [10]\nFeature-List\n3GPP TS 29.229 [10]\nSee clause 7.3.10\nMSISDN\n3GPP TS 29.329 [5]\nUser-Name\nIETF RFC 6733 [29]\nLocation-Estimate\n3GPP TS 32.299 [13]\nProSe-Direct-Allowed\n3GPP TS 29.344 [14]\nAuthorized-Discovery-Range\n3GPP TS 29.344 [14]\nSSID\n3GPP TS 29.273 [15]\nVisited-PLMN-Id\n3GPP TS 29.272 [16]\nUser-Identifier\n3GPP TS 29.336 [18]\nOC-Supported-Features\nIETF RFC 7683 [21]\nSee clause 6.3.34\nMust set\nOC-OLR\nIETF RFC 7683 [21]\nSee clause 6.3.35\nMust set\nDRMP\nIETF RFC 7944 [27]\nsee clause 6.3.72\nMust not set\nService-Result\n3GPP TS 29.336 [18]\nLoad\nIETF RFC 8583 [28]\nSee clause 6.3.83\nMust not set\nNOTE 1:\tThe M-bit settings for re-used AVPs override those of the defining specifications that are referenced. Values include: \"Must set\", \"Must not set\". If the M-bit setting is blank, then the defining specification applies.\nNOTE 2:\tIf the M-bit is set for an AVP and the receiver does not understand the AVP, it shall return a rejection. If the M-bit is not set for an AVP, the receiver shall not return a rejection, whether or not it understands the AVP. If the receiver understands the AVP but the M-bit value does not match with the definition in this table, the receiver shall ignore the M-bit.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.229_clause_7.3.10",
        "clause_6.3.34",
        "clause_6.3.35",
        "clause_6.3.72",
        "clause_6.3.83",
        "table_6.3.1-1",
        "table_6.3.1-2",
        "ts_29.229",
        "ts_29.329",
        "ts_32.299",
        "ts_29.344",
        "ts_29.273",
        "ts_29.272",
        "ts_29.336"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.2",
      "section_id": "6.3.2",
      "section_title": "App-Layer-User-Id",
      "content": "The App-Layer-User-Id AVP is of type UTF8String. This AVP contains an identity identifying a user within the context of a specific application (e.g. alice@social.net).",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.3",
      "section_id": "6.3.3",
      "section_title": "Assistance-info",
      "content": "The Assistance-Info AVP is of type Grouped. It shall contain the information for direct discovery and communications between UEs.\nThe AVP format shall conform to:\nAssistance-Info ::=\t<AVP header: 3802 10415>\n[ WLAN-Assistance-Info ]\n*[AVP]",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.4",
      "section_id": "6.3.4",
      "section_title": "Assistance-Info-Validity-Timer",
      "content": "The Assistance-Info-Validity-Timer AVP is of type Unsigned32 and it shall contain the maximum number of seconds of validity of the provided assistance information.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.5",
      "section_id": "6.3.5",
      "section_title": "Discovery-Type",
      "content": "The Discovery-Type AVP is of type Unsigned32 and contains a 32-bit address space representing types of Direct Discovery Authorization Request. The following values are defined:\nANNOUNCING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY (0)\nThis value is used when the Direct Discovery Authorization Request message is sent for a UE requesting authorization for announcing in open Prose Direct Discovery (Model A).\nMONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY (1)\nThis value is used when the Direct Discovery Authorization Request message is sent for a UE requesting authorization for monitoring in open Prose Direct Discovery (Model A).\nANNOUNCING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY (2)\nThis value is used when the Direct Discovery Authorization Request message is sent for a UE requesting authorization for announcing in restricted ProSe Direct Discovery (Model A).\nMONITORING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY (3)\nThis value is used when the Direct Discovery Authorization Request message is sent for a UE requesting authorization for monitoring in restricted ProSe Direct Discovery (Model A).\nDISCOVEREE_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY (4)\nThis value is used when the Direct Discovery Authorization Request message is sent for a discoveree UE requesting authorization for monitoring in restricted ProSe Direct Discovery (Model B).\nDISCOVERER_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY (5)\nThis value is used when the Direct Discovery Authorization Request message is sent to the ProSe Function in local PLMN for a discoverer UE requesting authorization for announcing in restricted ProSe Direct Discovery (Model B).\nDISCOVERER_ANNOUNCING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY (6)\nThis value is used when the Direct Discovery Authorization Request message is sent to the ProSe Function in the visited PLMN for a discoverer UE requesting authorization for announcing in restricted ProSe Direct Discovery (Model B).\nMONITORING_UPDATE_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY (7)\nThis value is used when the Direct Discovery Authorization Request message is sent for the ProSe Function requesting to ban a user of an authorization for monitoring in restricted ProSe Direct Discovery (Model A).\nMONITORING_RESPONSE_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY (8)\nThis value is used when the Direct Discovery Authorization Request message is sent for the ProSe Function reporting the result of an authorization for monitoring in restricted ProSe Direct Discovery (Model A).",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.6",
      "section_id": "6.3.6",
      "section_title": "EAP-Master-Session-Key",
      "content": "The EAP-Master-Session-Key AVP is of type OctetString and it shall contains keying material for protecting the communications between UEs. This AVP is defined in the IETF RFC 4072 [12]",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.7",
      "section_id": "6.3.7",
      "section_title": "Feature-List-ID AVP",
      "content": "The syntax of this AVP is defined in 3GPP TS 29.229 [10]. For this release, the Feature-List-ID AVP value shall be set to 1.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.229"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.8",
      "section_id": "6.3.8",
      "section_title": "Feature-List AVP",
      "content": "The syntax of this AVP is defined in 3GPP TS 29.229 [10]. A null value indicates that there is no feature used by the application.\nNOTE:\tThere is no feature defined for this release.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.229"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.9",
      "section_id": "6.3.9",
      "section_title": "Filter-Id",
      "content": "The Filter-Id AVP is of type OctectString. This AVP shall contain the identifier of a Discovery Filter.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.10",
      "section_id": "6.3.10",
      "section_title": "Location-Estimate",
      "content": "The Location-Estimate AVP is of type OctetString and it shall contain an estimate of the location of an MS in universal coordinates and the accuracy of the estimate. This AVP is defined in the 3GPP TS 32.299 [13].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_32.299"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.11",
      "section_id": "6.3.11",
      "section_title": "MAC-Address",
      "content": "The MAC-Address AVP is of type UTF8String and it shall contain a 6-octet MAC address used as link layer identifier for discovery and communication. It shall be encoded in upper-case ASCII characters with the octet values separated by dash characters. It shall contain a string of 17 octets. Example: \"00-10-A4-23-19-C0\".",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.12",
      "section_id": "6.3.12",
      "section_title": "Match-Report",
      "content": "The Match-Report AVP is of type Grouped. It shall contain the information elements used in ProSe Match Report answer.\nThe AVP format shall conform to:\nMatch-Report ::=\t\t<AVP header: 3807 10415>\n{ Discovery-Type }\n[ ProSe-App-Code ]\n[ ProSe-Metadata-Index-Mask ]\n[ ProSe-App-Id ]\n[ ProSe-Validity-Timer ]\n[ ProSe-Match-Refresh-Timer ]\n[ ProSe-Application-Metadata ]\n[ PC5-tech ]\n*[AVP]\nThe valid value for Discovery-Type for Match-Report AVP is: \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\",\nWhen the Discovery-Type is set to \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the Match-Report shall contain a ProSe Application Code, the associated ProSe Application ID Name, the validity time for which the ProSe Application Code is valid, the associated match report refresh timer and optionally the PC5 radio technology that the UE is using.\nIf the ProSe Application Code contains a metadata index, a ProSe-Metadata-Index-Mask AVP shall be provided for this ProSe Application Code.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.13",
      "section_id": "6.3.13",
      "section_title": "MSISDN",
      "content": "The MSISDN AVP is of type OctetString. This AVP contains an MSISDN, in international number format as described in ITU-T Rec E.164 [19]. This AVP is defined in the 3GPP TS 29.329 [5].",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.329"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.14",
      "section_id": "6.3.14",
      "section_title": "Operating-Channel",
      "content": "The Operating-Channel AVP is of type Unsigned32 and it shall contain the operating channel in MHz on which Wi-Fi P2P discovery and communication should take place.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.15",
      "section_id": "6.3.15",
      "section_title": "P2P-Features",
      "content": "The P2P-Features AVP is of type Unsigned32 and it shall contain a bit mask. The meaning of the bits shall be as defined in table 6.3.15-1:\nTable 6.3.15-1: P2P-Features\nBit\nName\nDescription\n0\nGroup Owner Indication\nThis bit, when set, shall indicate that the UE should implement the Group Owner (GO) functionality specified in the Wi-Fi P2P specification [17]. When not set, this bit shall indicate the UE should behave as a Wi-Fi P2P client that attempts to discover and associate with a GO.\nNOTE:\tBits not defined in this table shall be cleared by the sending ProSe Function and discarded by the receiving ProSe Function.",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.3.15-1"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.16",
      "section_id": "6.3.16",
      "section_title": "ProSe-App-Code",
      "content": "The ProSe-App-Code AVP is of type OctetString. This AVP contains a ProSe Application Code or ProSe Application Code Prefix (see 3GPP TS 23.003 [4]) is associated with a ProSe Application ID.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.003"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.17",
      "section_id": "6.3.17",
      "section_title": "ProSe-App-Id",
      "content": "The ProSe-App-Id AVP is of type UTF8String. This AVP contains a ProSe Application ID (see 3GPP TS 23.003 [4]).",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.003"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.18",
      "section_id": "6.3.18",
      "section_title": "ProSe-App-Mask",
      "content": "The ProSe-App-Mask AVP is of type OctetString. This AVP contains a ProSe Application Mask (see 3GPP TS 24.334 [22]).",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.334"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.19",
      "section_id": "6.3.19",
      "section_title": "ProSe-Direct-Allowed",
      "content": "The ProSe-Direct-Allowed AVP is of type Unsigned32 and it shall contain a bit mask that indicates the permissions for ProSe direct services for the UE in the PLMN of the responding ProSe Function. This AVP is defined in the 3GPP TS 29.344 [14].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.344"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.20",
      "section_id": "6.3.20",
      "section_title": "ProSe-Discovery-Filter",
      "content": "The ProSe-Discovery-Filter AVP is of type Grouped. It shall contain a Filter ID, a ProSe Application ID name, a validity timer, a ProSe Application Code and zero or more ProSe Application Masks.\nThe AVP format shall conform to:\nProSe-Discovery-Filter ::=\t<AVP header: 3813 10415>\n{ Filter-Id }\n{ ProSe-App-Id }\n{ ProSe-Validity-Timer }\n{ ProSe-App-Code }\n*[ ProSe-App-Mask ]\n*[AVP]",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.21",
      "section_id": "6.3.21",
      "section_title": "PRR-Flags",
      "content": "The PRR-Flags AVP is of type Unsigned32 and it shall contain a bit mask. The meaning of the bits shall be as defined in table 6.3.21-1:\nTable 6.3.21-1: PRA-Flags\nBit\nName\nDescription\n0\nWLAN Indication\nThis bit, when set, shall indicate the UE is requested EPC support for WLAN direct discovery and communication\nNOTE:\tBits not defined in this table shall be cleared by the sending ProSe Function and discarded by the receiving ProSe Function.",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.3.21-1"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.22",
      "section_id": "6.3.22",
      "section_title": "ProSe-Validity-Timer",
      "content": "The ProSe-Validity-Timer AVP is of type Unsigned32 and it shall contain the maximum number of seconds of validity of a ProSe Application Code or a ProSe Discovery Filter.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.23",
      "section_id": "6.3.23",
      "section_title": "Requesting-EPUID",
      "content": "The Requesting-EPUID AVP is of type UTF8String. This AVP contains an identifier for EPC-level ProSe Discovery and EPC support for WLAN direct communication that uniquely identifies a UE registered for ProSe triggering a Proximity request.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.24",
      "section_id": "6.3.24",
      "section_title": "Supported-Features",
      "content": "The Supported-Features AVP is of type Grouped and it informs the destination host about the features that the origin host supports for the application. This AVP is defined in the 3GPP TS 29.229 [10].",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.229"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.25",
      "section_id": "6.3.25",
      "section_title": "SSID",
      "content": "The SSID AVP is of type UTF8String and it shall contain the Service Set Identifier which identifies a specific 802.11 extended service set (see IEEE Std 802.11-2012 [20]). This AVP is defined in the 3GPP TS 29.273 [15].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.273"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.26",
      "section_id": "6.3.26",
      "section_title": "Targeted-EPUID",
      "content": "The Targeted-EPUID AVP is of type UTF8String. This AVP contains an identifier for EPC-level ProSe Discovery and EPC support for WLAN direct communication that uniquely identifies a UE registered for ProSe targeted by a Proximity request.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.27",
      "section_id": "6.3.27",
      "section_title": "Time-Window",
      "content": "The Time-Window AVP is of type Unsigned32 and it shall contain the maximum number of seconds of validity of the Proximity request.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.28",
      "section_id": "6.3.28",
      "section_title": "User-Identifier",
      "content": "The User-Identifier AVP is of type Grouped. It shall contain the UE identity used as identifier of a Proximity-based service subscribed by the user (i.e. IMSI or MSISDN). This AVP is defined in the 3GPP TS 29.336 [18].",
      "chunk_type": "parameter",
      "cross_references": [
        "ts_29.336"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.29",
      "section_id": "6.3.29",
      "section_title": "Visited-PLMN-Id",
      "content": "The Visited-PLMN-Id AVP is of type OctetString. This AVP shall contain the concatenation of MCC and MNC. This AVP is defined in the 3GPP TS 29.272 [16].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.272"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.30",
      "section_id": "6.3.30",
      "section_title": "WiFi-P2P-Assistance-Info",
      "content": "The WiFi-P2P-Assistance-Info AVP is of type Grouped. It shall contain information to assist WLAN direct discovery and communication as required by the Wi-Fi P2P technology.\nThe AVP format shall conform to:\nWiFi-P2P-Assistance-Info ::=\t<AVP header: 3819 10415>\n[ SSID ]\n[ EAP-Master-Session-Key ]\n[ P2P-Features ]\n[ WLAN-Link-Layer-Id-List ]\n[ WLAN-Link-Layer-Id-List ]\n[ Operating-Channel ]\n[ Assistance-Info-Validity-Timer ]\n*[AVP]",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.31",
      "section_id": "6.3.31",
      "section_title": "WLAN-Assistance-Info",
      "content": "The WLAN-Assistance-Info AVP is of type Grouped. It shall contain information to assist WLAN direct discovery and communication required for WLAN direct discovery and communication between UEs.\nThe AVP format shall conform to:\nWLAN-Assistance-Info ::=\t<AVP header: 3820 10415>\n[ WiFi-P2P-Assistance-Iinfo ]\n*[AVP]",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.32",
      "section_id": "6.3.32",
      "section_title": "WLAN-Link-Layer-Id",
      "content": "The WLAN-Link-Layer-Id AVP is of type Grouped. It shall contain a link layer identity used for WLAN direct discovery and/or WLAN direct communication.\nThe AVP format shall conform to:\nWLAN-Link-Layer-Id ::=\t<AVP header: 3821 10415>\n[ MAC-Address ]\n*AVP",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.33",
      "section_id": "6.3.33",
      "section_title": "WLAN-Link-Layer-Id-List",
      "content": "The WLAN-Link-Layer-Id-List AVP is of type Grouped. It shall contain a list of WLAN Link Layer IDs provided to a UE implementing the Group Owner functionality in a Wi-Fi P2P group.\nThe AVP format shall conform to:\nWLAN-Link-Layer-Id-List ::=\t<AVP header: 3822 10415>\n*[ WLAN-Link-Layer-Id ]\n*AVP",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.34",
      "section_id": "6.3.34",
      "section_title": "OC-Supported-Features",
      "content": "The OC-Supported-Features AVP is of type Grouped and it is defined in IETF RFC 7683 [21]. This AVP is used to support Diameter overload control mechanism, see Annex A for more information.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.35",
      "section_id": "6.3.35",
      "section_title": "OC-OLR",
      "content": "The OC-OLR AVP is of type Grouped and it is defined in IETF RFC 7683 [21]. This AVP is used to support Diameter overload control mechanism, see Annex A for more information.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.36",
      "section_id": "6.3.36",
      "section_title": "Validity-Time-Announce",
      "content": "The Validity-Time-Announce AVP is of type Unsigned32 and it shall contain the maximum number of seconds of validity of a ProSe announcing authorization policy.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.37",
      "section_id": "6.3.37",
      "section_title": "Validity-Time-Monitor",
      "content": "The Validity-Time-Monitor AVP is of type Unsigned32 and it shall contain the maximum number of seconds of validity of a ProSe monitoring authorization policy.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.38",
      "section_id": "6.3.38",
      "section_title": "Validity-Time-Communication",
      "content": "The Validity-Time-Communication AVP is of type Unsigned32 and it shall contain the maximum number of seconds of validity of a ProSe communication authorization policy.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.39",
      "section_id": "6.3.39",
      "section_title": "ProSe-App-Code-Info",
      "content": "The ProSe-App-Code-Info AVP is of type Grouped. It shall contain a ProSe Application Code, the associated MIC and the associated UTC-based counter.\nThe AVP format shall conform to:\nProSe-App-Code-Info ::=\t\t<AVP header: 3835 10415>\n{ ProSe-App-Code }\n{ MIC }\n{ UTC-based-Counter }\n*[AVP]",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.40",
      "section_id": "6.3.40",
      "section_title": "MIC",
      "content": "The MIC AVP is of type OctetString and shall contain a MIC (Message Integrity Check) associated with a discovered ProSe Application Code, as defined in 3GPP TS 33.303 [23].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_33.303"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.41",
      "section_id": "6.3.41",
      "section_title": "UTC-based-Counter",
      "content": "The UTC-based-Counter AVP is of type Unsigned32 and it shall contain the UTC-based counter (in seconds) associated with a discovered ProSe Application Code as defined in 3GPP TS 24.334 [22].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.334"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.42",
      "section_id": "6.3.42",
      "section_title": "Location-Update-Trigger",
      "content": "The Location-Update-Trigger AVP is of type Grouped. It shall contain the type of event that will trigger a locate update procedure to forward the location of UE to the ProSe Function initiating the Proximity Request.\nThe AVP format shall conform to:\nLocation-Update-Trigger::=\t<AVP header: 3823 10415>\n{ Location-Update-Event-Type }\n[ Change-Of-Area-Type ]\n[ Periodic-Location-Type ]\n*[AVP]\nThe Change-Of-Area-Type AVP shall be present if the Location-Update-Event-Type AVP value is set to CHANGE_OR_AREA (1). Otherwise, it shall be absent.\nThe Periodic-Location-Type AVP shall be present if the Location-Update-Event-Type AVP value is set to PERIODIC_LOCATION (2). Otherwise, it shall be absent.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.43",
      "section_id": "6.3.43",
      "section_title": "Location-Update-Event-Type",
      "content": "The Location-Update-Event-Type AVP is of type Unsigned32 and contains an 32-bit address space representing types of events that will trigger a location update. The following values are defined:\nUE_AVAILABLE (0)\nThis value shall be used to indicate that the location update trigger is any event in which the MSC/SGSN/MME has established a contact with the UE.\nCHANGE_OF_AREA (1)\nThis value shall be used to indicate that the location update trigger is an event where the UE enters or leaves a pre-defined geographical area or if the UE is currently within the pre-defined geographical area.\nPERIODIC_LOCATION (2)\nThis value shall be used to indicate that the location update trigger is an event where a defined periodic timer expires in the UE and activates a location report or a location request\nThe types of event listed above are defined in the clause 4.4.2.1 of the 3GPP TS 23.271 [24]",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.271_clause_4.4.2.1",
        "ts_23.271"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.44",
      "section_id": "6.3.44",
      "section_title": "Change-Of-Area-Type",
      "content": "The Change-Of-Area-Type AVP is of type Grouped. It shall contain the information related to the type of event that will trigger a locate update procedure to forward the location of UE to the ProSe Function initiating the Proximity Request.\nThe AVP format shall conform to:\nChange-Of-Area-Type::=\t<AVP header: 3825 10415>\n{ Location-Update-Event-Trigger }\n{ Report-Cardinality }\n[ Minimum-Interval-Time ]\n*[AVP]\nThe Minimum-Interval-Time AVP may be present only if the Report-Cardinality AVP value is set to MULTIPLE (1).",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.45",
      "section_id": "6.3.45",
      "section_title": "Location-Update-Event-Trigger",
      "content": "The Location-Update-Event-Type AVP is of type Unsigned32 and contains a 32-bit address space representing the possible change of area events i.e. UE enters, leaves or is within requested target area. The following values are defined:\nUE_ENTRY (0)\nThis value shall be used to indicate the event trigger is the UE entering a pre-defined geographical area.\nUE_EXIT (1)\nThis value shall be used to indicate the event trigger is the UE leaving a pre-defined geographical area\nUE_PRESENCE (2)\nThis value shall be used to indicate the event trigger is the current presence of the UE within a pre-defined geographical area.\nThe types of change of area event listed above are defined in the clause 4.4.2.1 of the 3GPP TS 23.271 [24].",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.271_clause_4.4.2.1",
        "ts_23.271"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.46",
      "section_id": "6.3.46",
      "section_title": "Report-Cardinality",
      "content": "The Report-Cardinality AVP is of type Enumerated. The following values are defined:\nSINGLE (0)\nThis value shall be used to indicate the change of area event shall be reported one time only.\nMULTIPLE (1)\nThis value shall be used to indicate the change of area event may be reported several times.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.47",
      "section_id": "6.3.47",
      "section_title": "Minimum-Interval-Time",
      "content": "The Minimum-Interval-Time AVP is of type Unsigned32 and shall contain the minimum number of seconds between area event reports.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.48",
      "section_id": "6.3.48",
      "section_title": "Periodic-Location-Type",
      "content": "The Periodic-Location-Type AVP is of type Grouped. It shall contain the time interval between successive location reports and the total number of reports.\nThe AVP format shall conform to:\nPeriodic-Location-Type::=\t<AVP header: 3829 10415>\n{ Location-Report-Interval-Time }\n{ Total-Number-Of-Reports }\n*[AVP]",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.49",
      "section_id": "6.3.49",
      "section_title": "Location-Report-Interval-Time",
      "content": "The Location-Report-Interval-Time AVP is of type Unsigned32 and shall contain the number of seconds between successive location reports.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.50",
      "section_id": "6.3.50",
      "section_title": "Total-Number-Of-Reports",
      "content": "The Total-Number-Of-Reports AVP is of type Unsigned32 and shall indicate the maximum number of requested location reports.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.51",
      "section_id": "6.3.51",
      "section_title": "Authorized-Discovery-Range",
      "content": "The Authorized-Discovery-Range AVP is of type Unsigned32 and it shall contain a value that indicates the authorised announcing range (short/medium/long) at which the UE is allowed to announce in the given PLMN according to the defined announcing authorisation policy for this UE. This AVP is defined in the 3GPP TS 29.344 [14].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.344"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.52",
      "section_id": "6.3.52",
      "section_title": "ProSe-Match-Refresh-Timer",
      "content": "The ProSe-Match-Refresh-Timer AVP is of type Unsigned32 and it shall contain the number of seconds indicating how long the UE shall wait before sending a new Match Report for the associated ProSe Application Code.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.53",
      "section_id": "6.3.53",
      "section_title": "Discovery-Auth-Request",
      "content": "The Discovery-Auth-Request is of type Grouped. It shall contain the information elements used in ProSe direct discovery authorization request.\nThe AVP format shall conform to:\nDiscovery-Auth-Request ::=\t\t<AVP header: 3854 10415>\n{ Discovery-Type }\n[ User-Identity ]\n[ ProSe-App-ID ]\n[ ProSe-App-Code ]\n[ ProSe-App-Code-Suffix-Range ]\n[ ProSe-Validity-Timer ]\n[ App-Identifier ]\n[ Requesting-RPAUID ]\n[ Target-RPAUID ]\n[ Target-PDUID ]\n[ ProSe-Restricted-Code ]\n[ ProSe-Query-Code ]\n[ ProSe-Response-Code ]\n*[ ProSe-Restricted-Code-Suffix-Range ]\n[ Banned-RPAUID ]\n[ Banned-PDUID ]\n[ Service-Result ]\n[ PC5-tech ]\n*[AVP]\nWhen the Discovery-Type is set to \"ANNOUNCING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Request shall contain a UE identity, a ProSe Application ID, a ProSe Application Code and optionally one or more ProSe Restricted Code Suffix-Range, ProSe Validity Timer and the PC5 radio technology that the UE is using.\nWhen the Discovery-Type is set to \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Request shall contain a UE identity, a ProSe Application ID and optionally the PC5 radio technology that the UE is using.\nWhen the Discovery-Type is set to \"ANNOUNCING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Request shall contain a UE identity, an Application Identifier, the Requesting RPAUID, ProSe Restricted Code and optionally one or more ProSe Restricted Code SuffixRange, a ProSe Validity Timer and the PC5 radio technology that the UE is using.\nWhen the Discovery-Type is set to \"MONITORING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Request shall contain a UE identity, an Application Identifier, Requesting RPAUID, Target RPAUID, Target PDUID and optionally the PC5 radio technology that the UE is using.\nWhen the Discovery-Type is set to \"DISCOVEREE_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Request shall contain a UE identity, an Application Identifier, Requesting RPAUID, a ProSe Response Code and optionally the PC5 radio technology that the UE is using.\nWhen the Discovery-Type is set to \"DISCOVERER_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Request shall contain a UE identity, an Application Identifier, Requesting RPAUID, Target RPAUID, Target PDUID and optionally the PC5 radio technology that the UE is using.\nWhen the Discovery-Type is set to \"DISCOVERER_ANNOUNCING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Request shall contain a UE identity, an Application Identifier, Requesting RPAUID, a ProSe Query Code and optionally the PC5 radio technology that the UE is using.\nWhen the Discovery-Type is set to \"MONITORING_UPDATE_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Request shall contain an Application Identifier, a ProSe Restricted Code, a Banned RPAUID, a Banned PDUID and optionally the PC5 radio technology that the UE is using.\nWhen the Discovery-Type is set to \"MONITORING_RESPONSE_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Request shall contain an Application Identifier, ProSe-Restricted-Code, Banned RPAUID, Banned PDUID, Result and optionally the PC5 radio technology that the UE is using.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.54",
      "section_id": "6.3.54",
      "section_title": "Discovery-Auth-Response",
      "content": "The Discovery-Auth-Response is of type Grouped. It shall contain the information elements used in ProSe direct discovery authorization answer.\nThe AVP format shall conform to:\nDiscovery-Auth-Response ::=\t\t<AVP header: 3855 10415>\n{ Discovery-Type }\n*[ ProSe-Discovery-Filter ]\n[ Visited-PLMN-Id ]\n[ ProSe-Restricted-Code ]\n[ ProSe-Query-Code ]\n[ ProSe-Response-Code ]\n[ ProSe-Validity Timer ]\n[ Code-Sending-Security-Material ]\n[ Code-Receiving-Security-Material ]\n[ DUIK ]\n[ PC5-tech ]\n*[AVP]\nWhen the Discovery-Type is set to \"ANNOUNCING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Response shall contain no other parameters.\nWhen the Discovery-Type is set to \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Response shall contain one or more ProSe Discovery Filters, optionally a PLMN ID and the PC5 radio technology that the UE is using.\nWhen the Discovery-Type is set to \"MONITORING_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Response shall contain a ProSe Restricted Code, a Code Receiving Security Material, optionally a DUIK, a ProSe Validity Timer and the PC5 radio technology that the UE is using. The DUIK parameter shall be included in Discovery-Auth-Response only if the Code-Receiving-Security-Material contains a MIC Check Indicator set to MIC_CHECK_BY_PROSE_FUNCTION.\nWhen the Discovery-Type is set to \"DISCOVERER_REQUEST_FOR_RESTRICTED_PROSE_DIRECT_DISCOVERY\", the Discovery-Auth-Response shall contain a ProSe Query Code, a Code Sending Security Material, a ProSe Response Code, a Code Receiving Security Material, optionally a DUIK, a ProSe Validity Timer and the PC5 radio technology that the UE is using. The DUIK parameter shall be included in Discovery-Auth-Response only if the Code-Receiving-Security-Material contains a MIC Check Indicator set to MIC_CHECK_BY_PROSE_FUNCTION.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.55",
      "section_id": "6.3.55",
      "section_title": "Match-Request",
      "content": "The Match-Request is of type Grouped. It shall contain the information elements used in ProSe Match Report request.\nThe AVP format shall conform to:\nMatch-Request ::=\t\t<AVP header: 3856 10415>\n{ Discovery-Type }\n[ User Identity ]\n[ Visited-PLMN-ID ]\n*[ ProSe-App-Code-Info ]\n[ PC5-tech ]\n*[AVP]\nThe valid value for Discovery-Type for Match-Report AVP is: \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\",\nWhen the Discovery-Type is set to \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the Match-Request shall contain one UE Identity, one Visited PLMN ID, one or more ProSe App Code Info and optionally the PC5 radio technology that the UE is using.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.56",
      "section_id": "6.3.56",
      "section_title": "Match-Report-Info",
      "content": "The Match-Report-Info is of type Grouped. It shall contain the information elements used in ProSe Match Report Info request.\nThe AVP format shall conform to:\nMatch-Report-Info ::=\t\t<AVP header: 3857 10415>\n{ Discovery-Type }\n[ User-Identity ]\n*[ ProSe-App-ID ]\n*[AVP]\nThe valid value for Discovery-Type for Match-Report-Info AVP is: \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\",\nWhen the Discovery-Type is set to \"MONITORING_REQUEST_FOR_OPEN_PROSE_DIRECT_DISCOVERY\", the Match-Report-Info shall contain one User Identity and one or more ProSe Application IDs.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.57",
      "section_id": "6.3.57",
      "section_title": "PMR-Flags",
      "content": "The PMR-Flags AVP is of type Unsigned32 and it shall contain a bit mask. The meaning of the bits shall be as defined in table 6.3.57/1:\nTable 6.3.57/1: PMR-Flags\nBit\nName\nDescription\n0\nMetadata Requested\nThis bit, when set, indicates that metadata information associated with the ProSe Application ID are requested.\nNOTE:\tBits not defined in this table shall be cleared by the sending Prose Function and discarded by the receiving receiving ProSe function.",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.3.57"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.58",
      "section_id": "6.3.58",
      "section_title": "ProSe-Application-Metadata",
      "content": "The ProSe-Application-Metadata AVP is of type UTF8String. This AVP shall contain the metadata associated with the ProSe Application ID contained in the Match Report. As defined in 3GPP TS 24.334 [22], the length and contents of the metadata formatted as UTF8-encoded string are out of scope of 3GPP.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.334"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.59",
      "section_id": "6.3.59",
      "section_title": "Discovery-Entry-ID",
      "content": "The Discovery-Entry-ID is of type Unsigned32. It shall contain the discovery Entry ID used to identify the discovery entry in the UE context related to the discovery authorization request in the requesting ProSe Function.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.60",
      "section_id": "6.3.60",
      "section_title": "ProSe-Metadata-Index-Mask",
      "content": "The ProSe-Metadata-Index-Mask AVP is of type OctetString. This AVP contains a ProSe metadata index mask (see 3GPP TS 24.334 [22]).",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.334"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.61",
      "section_id": "6.3.61",
      "section_title": "App-Identifier",
      "content": "The App-Identifier AVP is of type Grouped. It shall contain an OS ID and OS Application ID name.\nThe AVP format shall conform to:\nApp-Identifier ::=\t\t<AVP header: 3840 10415>\n{ OS-ID }\n{ OS-App-ID }\n*[AVP]",
      "chunk_type": "parameter",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.62",
      "section_id": "6.3.62",
      "section_title": "OS-ID",
      "content": "The OS-ID AVP is of type OctetString. It shall contain an identifier of the operating system as defined in clause 12.2.2.5 in 3GPP TS 24.334 [22].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.334_clause_12.2.2.5",
        "ts_24.334"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.63",
      "section_id": "6.3.63",
      "section_title": "OS-App-ID",
      "content": "The OS-App-ID AVP is of type UTF8String. It shall contain an OS specific application as defined in clause 12.2.2.5 in 3GPP TS 24.334 [22].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.334_clause_12.2.2.5",
        "ts_24.334"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.64",
      "section_id": "6.3.64",
      "section_title": "Requesting-RPAUID",
      "content": "The Requesting-RPAUID AVP is of type UTF8String. This AVP contains an identifier for restricted ProSe direct discovery that uniquely identifies an application user originating a restricted ProSe direct discovery request.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.65",
      "section_id": "6.3.65",
      "section_title": "Target-RPAUID",
      "content": "The Target-RPAUID AVP is of type UTF8String. This AVP contains an identifier for restricted ProSe direct discovery that uniquely identifies an application user targeted by a restricted ProSe direct discovery request.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.66",
      "section_id": "6.3.66",
      "section_title": "Target-PDUID",
      "content": "The Target-PDUID AVP is of type OctetString. It shall contain the ProSe Discovery UE ID which uniquely identifies the UE targeted by a restricted ProSe direct discovery request.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.67",
      "section_id": "6.3.67",
      "section_title": "ProSe-Restricted-Code",
      "content": "The ProSe-Restricted-Code AVP is of type OctetString. This AVP contains a ProSe Restricted Code (see 3GPP TS 23.003 [4]) which is associated with a RPAUID.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.003"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.68",
      "section_id": "6.3.68",
      "section_title": "ProSe-Restricted-Code-Suffix-Range",
      "content": "The ProSe-Restricted-Code-Suffix-Range AVP is of type Grouped. It contains a range of consecutive ProSe Restricted Code Suffixes that can be appended to a ProSe Restricted Code Prefix. It shall contain a Beginning Suffix and may contain an Ending Suffix. If the Ending Suffix is not present, the only ProSe Restricted Code Suffix included in the ProSe Restricted Code Suffix Range is equal to the Beginning Suffix.\nThe AVP format shall conform to:\nProSe-Restricted-Code-Suffix-Range ::=\t\t<AVP header: 3847 10415>\n{ Beginning-Suffix}\n[ Ending–Suffix ]\n*[AVP]\nBeginning Sufifx and Ending Suffix shall have the same length.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.69",
      "section_id": "6.3.69",
      "section_title": "Beginning-Suffix",
      "content": "The Beginning-Suffix AVP is of type OctetString. This AVP shall contain the lowest ProSe Restricted Code Suffix in a consecutive sequence of ProSe Restricted Code suffixes, or the lowest ProSe Application Code Suffix in a consecutive sequence of ProSe Application Code Suffixes. The format of ProSe Restricted Code Suffix or ProSe Application Code Suffix is defined in 3GPP TS 23.003 [4]. The size of this suffix shall align with octet boundary.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_23.003"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.70",
      "section_id": "6.3.70",
      "section_title": "Ending-Suffix",
      "content": "The Ending-Suffix AVP is of type OctetString. This AVP shall contain the highest ProSe Restricted Code Suffix in a consecutive sequence of ProSe Restricted Code suffixes or the highest ProSe Application Code Suffix in a consecutive sequence of ProSe Application Code Suffixes. The format of ProSe Restricted Code Suffix or ProSe Application Code Suffix is defined in 3GPP TS 23.003 [4]. The size of this suffix shall align with octet boundary.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_23.003"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.71",
      "section_id": "6.3.71",
      "section_title": "Match-Timestamp",
      "content": "The Match-Timestamp AVP is of type Time and it shall contain the UTC time identifying when the discovery match event occurred.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.72",
      "section_id": "6.3.72",
      "section_title": "DRMP",
      "content": "The DRMP AVP is of type Enumerated and it is defined in IETF RFC 7944 [27]. This AVP allows the Prose Function to indicate the relative priority of Diameter messages. The DRMP AVP may be used to set the DSCP marking for transport of the associated Diameter message.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.73",
      "section_id": "6.3.73",
      "section_title": "Banned-RPAUID",
      "content": "The Banned-RPAUID AVP is of type UTF8String. This AVP contains an identifier for restricted ProSe direct discovery that uniquely identifies an application user banned by a restricted ProSe direct discovery request.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.74",
      "section_id": "6.3.74",
      "section_title": "Banned-PDUID",
      "content": "The Banned-PDUID AVP is of type OctetString. It shall contain the ProSe Discovery UE ID which uniquely identifies the UE Banned by a restricted ProSe direct discovery request.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.75",
      "section_id": "6.3.75",
      "section_title": "Code-Receiving-Security-Material",
      "content": "The Code-Receiving-Security-Material AVP is of type Grouped. It shall contain security parameters used to indicate to a UE how a received restricted ProSe direct discovery message is protected. The Code Receiving Security Material may contain a DUSK and may contain either a DUIK or an indication whether to use Match Reports for MIC checking. It may also contain both a DUCK and a corresponding Encrypted Bitmask.\nThe AVP format shall conform to:\nCode-Receiving-Security-Material ::=\t\t<AVP header: 3847 10415>\n[ DUSK ]\n[ DUIK ]\n[ MIC-Check-Indicator ]\n[ DUCK ]\n[ Encrypted-Bitmask ]\n*[AVP]",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.76",
      "section_id": "6.3.76",
      "section_title": "Code-Sending-Security-Material",
      "content": "The Code-Sending-Security-Material AVP is of type Grouped. It shall contain security parameters used to indicate to a UE how to protect the transmission of restricted ProSe direct discovery message. The Code Sending Security Material may contain a DUSK and may contain a DUIK. It may also contain both a DUCK and a corresponding Encrypted Bitmask.\nThe AVP format shall conform to:\nCode-Sending-Security-Material ::=\t\t<AVP header: 3847 10415>\n[ DUSK ]\n[ DUIK ]\n[ DUCK ]\n[ Encrypted-Bitmask ]\n*[AVP]",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.77",
      "section_id": "6.3.77",
      "section_title": "DUSK",
      "content": "The DUSK AVP is of type OctetString. It shall contain the Discovery User Scrambling Key used to scramble or unscramble the restricted ProSe direct discovery message containing the ProSe Restricted Code, ProSe Query Code or ProSe Response Code. The format of the DUSK is defined in 3GPP TS 33.303 [23].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_33.303"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.78",
      "section_id": "6.3.78",
      "section_title": "DUIK",
      "content": "The DUIK AVP is of type OctetString. It shall contain the Discovery User Integrity Key used to compute the MIC of the restricted ProSe direct discovery message containing the ProSe Restricted Code, ProSe Query Code or ProSe Response Code. The format of the DUIK is defined in 3GPP TS 33.303 [23].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_33.303"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.79",
      "section_id": "6.3.79",
      "section_title": "DUCK",
      "content": "The DUCK AVP is of type OctetString. It shall contain the Discovery User Confidentiality Key used to encrypt and decrypt a portion in restricted ProSe direct discovery message.The format of the DUCK is defined in 3GPP TS 33.303 [23].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_33.303"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.3.80",
      "section_id": "6.3.80",
      "section_title": "MIC-Check-Indicator",
      "content": "The MIC-Check-Indicator AVP is of type Unsigned32. It shall contain the indication of whether the UE shall use the ProSe Function to verify the MIC field of the received discovery message. The following values are defined:\nMIC_CHECK_BY_PROSE_FUNCTION (1)\nThis value is used when the MIC check is required to be done by the ProSe Function.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.81",
      "section_id": "6.3.81",
      "section_title": "Encrypted-Bitmask",
      "content": "The Encrypted-Bitmask AVP is of type OctetString. It shall contain a 184-bit bitmask which uses bit \"1\" to mark the positions of the bits of a ProSe Restricted Code, ProSe Query Code or ProSe Response Code, for which the DUCK encryption is applied.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.82",
      "section_id": "6.3.82",
      "section_title": "ProSe-App-Code-Suffix-Range",
      "content": "The ProSe-App-Code-Suffix-Range AVP is of type Grouped. It contains a range of consecutive ProSe Application Code Suffixes that can be appended to a ProSe Application Code Prefix. It shall contain a Beginning Suffix and may contain an Ending Suffix. If the Ending Suffix is not present, the only ProSe Application Code Suffix included in the ProSe Application Code Suffix Range is equal to the Beginning Suffix.\nThe AVP format shall conform to:\nProSe-App-Code-Suffix-Range ::=\t\t<AVP header: 3847 10415>\n{ Beginning-Suffix }\n[ Ending–Suffix ]\n*[AVP]\nBeginning Suffix and Ending Suffix shall have the same length.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.83",
      "section_id": "6.3.83",
      "section_title": "Load",
      "content": "The Load AVP is of type Grouped and it is defined in IETF RFC 8583 [28]. This AVP is used to support Diameter load control mechanism, see Annex D for more information.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.3.84",
      "section_id": "6.3.84",
      "section_title": "PC5-tech",
      "content": "The PC5-tech AVP is of type OctetString. It shall contain an identifier of the PC5 radio technology as defined in clause 12.2.2.71 in 3GPP TS 24.334 [22].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.334_clause_12.2.2.71",
        "ts_24.334"
      ]
    },
    {
      "chunk_id": "ts_29.345_6.4.1",
      "section_id": "6.4.1",
      "section_title": "General",
      "content": "This clause defines result code values that shall be supported by all Diameter implementations that conform to this specification.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.2",
      "section_id": "6.4.2",
      "section_title": "Success",
      "content": "Result codes that fall within the Success category shall be used to inform a peer that a request has been successfully completed. The Result-Code AVP values defined in the Diameter base protocol (IETF RFC 6733 [29]) shall be applied.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3",
      "section_id": "6.4.3",
      "section_title": "Permanent Failures",
      "content": "Errors that fall within the Permanent Failures category shall be used to inform the peer that the request has failed, and should not be attempted again. The Result-Code AVP values defined in the Diameter base protocol (IETF RFC 6733 [29]) shall be applied. When one of the result codes defined here is included in a response, it shall be inside an Experimental-Result AVP and the Result-Code AVP shall be absent.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.1",
      "section_id": "6.4.3.1",
      "section_title": "DIAMETER_ERROR_USER_UNKNOWN (5001)",
      "content": "This result code shall be sent by the ProSe Function in the HPLMN to indicate that the user identified by the UE identity is unknown",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.2",
      "section_id": "6.4.3.2",
      "section_title": "DIAMETER_ERROR_UNAUTHORIZED_SERVICE (5511)",
      "content": "This result code shall be sent by the ProSe Function in the HPLMN to indicate that no ProSe subscription is associated with the UE.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.3",
      "section_id": "6.4.3.3",
      "section_title": "DIAMETER_ERROR_NO_ASSOCIATED_DISCOVERY_FILTER (5630)",
      "content": "This result code shall be sent by the ProSe Function in the local/visited PLMN to indicate that there is no valid Discovery Filter associated to the ProSe Application ID name received in the request.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.4",
      "section_id": "6.4.3.4",
      "section_title": "DIAMETER_ERROR_ANNOUNCING_UNAUTHORIZED_IN_PLMN (5631)",
      "content": "This result code shall be sent by the ProSe Function in the local/visited PLMN to indicate that the UE is not authorized to announce in this PLMN.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.5",
      "section_id": "6.4.3.5",
      "section_title": "DIAMETER_ERROR_INVALID_APPLICATION_CODE (5632)",
      "content": "This result code shall be sent by the ProSe Function in the local PLMN to indicate that none of the ProSe Application Code(s) received in the request is valid.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.6",
      "section_id": "6.4.3.6",
      "section_title": "DIAMETER_ERROR_PROXIMITY_UNAUTHORIZED (5633)",
      "content": "This result code shall be sent by the ProSe Function in the serving PLMN to indicate that the Proximity request is not authorized by the user.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.7",
      "section_id": "6.4.3.7",
      "section_title": "DIAMETER_ERROR_PROXIMITY_REJECTED (5634)",
      "content": "This result code shall be sent by the ProSe Function in the serving PLMN to indicate that it is unlikely that UEs enter into proximity for the received time window.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.8",
      "section_id": "6.4.3.8",
      "section_title": "DIAMETER_ERROR_NO_PROXIMITY_REQUEST (5635)",
      "content": "This result code shall be sent by the ProSe Function in the serving PLMN to indicate that there is no context associated with EPC ProSe User Identities included in the request.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.9",
      "section_id": "6.4.3.9",
      "section_title": "DIAMETER_ERROR_UNAUTHORIZED_SERVICE_IN_THIS_PLMN (5636)",
      "content": "This result code shall be sent by the ProSe Function HPLMN to indicate that ProSe is not authorized to announce in this PLMN.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.10",
      "section_id": "6.4.3.10",
      "section_title": "DIAMETER_ERROR_PROXIMITY_CANCELLED (5637)",
      "content": "This result code shall be sent by the ProSe Function triggering the Proximity Request to indicate that the cancellation of the Proximity Request procedure as it determines that the UEs are unlikely to enter proximity within the requested time window.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.11",
      "section_id": "6.4.3.11",
      "section_title": "DIAMETER_ERROR_INVALID_DISCOVERY_TYPE (5641)",
      "content": "This result code shall be sent by the ProSe Function to indicate that the Discovery Tpe in the request message is not supported.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.12",
      "section_id": "6.4.3.12",
      "section_title": "DIAMETER_ERROR_INVALID_TARGET_PDUID (5638)",
      "content": "This result code shall be sent by the ProSe Function to indicate that the PDUID is not belonging to this ProSe Function.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.13",
      "section_id": "6.4.3.13",
      "section_title": "DIAMETER_ERROR_INVALID_TARGET_RPAUID (5639)",
      "content": "This result code shall be sent by the ProSe Function to indicate that the target RPAUID is not allowed to be discovered.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.14",
      "section_id": "6.4.3.14",
      "section_title": "DIAMETER_ERROR_NO_ASSOCIATED_RESTRICTED_CODE (5640)",
      "content": "This result code shall be sent by the ProSe Function to indicate that the there is no allocated ProSe Restricted Code for the requested target.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.15",
      "section_id": "6.4.3.15",
      "section_title": "DIAMETER_ERROR_REVOCATION_FAILURE (56x1)",
      "content": "This value is used to indicate that the ProSe Function was unable to successfully complete the revocation procedure (in an operator-configured time period).",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.3.16",
      "section_id": "6.4.3.16",
      "section_title": "DIAMETER_ERROR_ALREADY_BANNED (56x2)",
      "content": "This value is used to indicate that the ProSe Function has determined that the revocation is not necessary because the target RPAUID has already been banned for discovery.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.345_6.4.4",
      "section_id": "6.4.4",
      "section_title": "Transient Failures",
      "content": "Result codes that fall within the transient failures category shall be used to inform a peer that the request could not be satisfied at the time it was received, but may be able to satisfy the request in the future. The Result-Code AVP values defined in the Diameter base protocol specified in IETF RFC 6733 [29] shall be applied. When one of the result codes defined here is included in a response, it shall be inside an Experimental-Result AVP and the Result-Code AVP shall be absent.\nAnnex A (normative):Diameter overload control mechanism\nA.1\tGeneral\nDiameter overload control mechanism is an optional feature.\nIETF RFC 7683 [21] specifies a Diameter overload control mechanism which includes the definition and the transfer of related AVPs between Diameter nodes.\nIt is recommended to make use of IETF RFC 7683 [21] on the PC6/PC7 interface where, when applied, the requesting ProSe Function shall behave as a reacting node and the responding ProSe Function as a reporting node.\nA.2\tResponding ProSe Function behaviour\nThe responding ProSe Function requests traffic reduction from requesting ProSe Function when it is in an overload situation, including OC-OLR AVP in answer commands as described in IETF RFC 7683 [21].\nThe ProSe Function identifies that it is in an overload situation by implementation specific means. For example, the ProSe Function may take into account the traffic over the PC6/PC7 interfaces or other interfaces, the level of usage of internal resources (CPU, memory), the access to external resources, etc.\nThe ProSe Function determines the specific contents of OC-OLR AVP in overload reports and the ProSe Function decides when to send OC-OLR AVPs by implementation specific means.\nA.3\tRequesting ProSe Function behaviour\nThe requesting ProSe Function applies required traffic reduction received in answer commands to subsequent applicable requests, as per IETF RFC 7683 [21].\nRequested traffic reduction is achieved by the requesting ProSe Function by implementation specific means. For example, it may implement message throttling with prioritization or a message retaining mechanism for operations that can be postponed.\nAs a result of the need to throttle traffic, the requesting ProSe Function may reject Registration Request, Discovery Request, Match Report Requests initiated by UEs. The possible related error messages used over PC3 are described in the 3GPP TS 24.334 [22].\nAnnex B (Informative):Diameter overload node behaviour\nB.1\tMessage prioritization\nThis clause describes possible behaviours of the requesting ProSe Function receiving an overload indication from the responding ProSe Function, regarding message prioritisation in an informative purpose.\nThe requesting ProSe Function may take the following into account when making throttling decisions:\n-\tIdentification of the procedures that can be deferred (e.g. Proximity Requests), so to avoid to drop non deferrable procedures;\n-\tPrioritisation of certain types of request (e.g. between ProSe-Proximity-Request (PRR) and ProSe-Location-Update-Request (PLR)) according to the context of their use, in particular:\n-\tHigher prioritisation for commands that are related to a registered user for a service, so to avoid the interruption of the registered service for the user.\nAnnex C (normative):Diameter message priority mechanism\nC.1\tGeneral\nIETF RFC 7944 [27] specifies a Diameter routing message priority mechanism that allows Diameter nodes to indicate the relative priority of Diameter messages. With this information, other Diameter nodes may leverage the relative priority of Diameter messages into routing, resource allocation, set the DSCP marking for transport of the associated Diameter message, and also abatement decisions when overload control is applied.\nC.2\tPC6/PC7 interfaces\nC.2.1\tGeneral\nThe Diameter message priority mechanism is an optional feature.\nIt is recommended to make use of IETF RFC 7944 [27] over the PC6/PC7 interfaces of an operator network when the overload control defined in Annex A is applied on these PC6/7 interfaces.\nC.2.2\tProSe Function behaviour\nWhen the ProSe Function supports the Diameter message priority mechanism over the PC6 or the PC7 interface, the ProSe Function shall comply with IETF RFC 7944 [27].\nThe ProSe Function sending a request shall determine the required priority according to its policies. When priority is required, the ProSe Function shall include the DRMP AVP indicating the required priority level in the requests it sends, and shall prioritise the request according to the required priority level.\nWhen the ProSe Function receives the corresponding response, it shall prioritise the received response according to the priority level received within the DRMP AVP if present in the response, otherwise according to the priority level of the corresponding request.\nWhen the ProSe Function receives a request, it shall handle the request according to the received DRMP AVP priority level. For the response, the ProSe Function may modify the priority level received in the DRMP AVP according to its policies and shall handle the response according to the required priority level. If the required priority level is different from the priority level received in the request, it shall include the DRMP AVP in the response.\nIf:\n-\tthe ProSe Function supports using the Diameter message priority mechanism for DSCP marking purposes,\n-\tthe transport network utilizes DSCP marking, and\n-\tmessage-dependant DSCP marking is possible for the protocol stack transporting Diameter,\nthen the ProSe Function shall set the DSCP marking for transport of the request or response according to the required priority level.\nThe ProSe Function decisions for a required priority and for the priority level value are implementation specific.\nDiameter requests related to high priority traffic shall contain a DRMP AVP with a high priority of which the level value is operator dependent.\nAnnex D (normative):Diameter load control mechanism\nD.1\tGeneral\nDiameter load control mechanism is an optional feature.\nIETF RFC 8583 [28] specifies a Diameter load control mechanism which includes the definition and the transfer of related AVPs between Diameter nodes.\nIt is recommended to make use of IETF RFC 8583 [28] on the PC6/PC7 interface where, when applied, the requesting ProSe Function shall behave as a reacting node and the responding ProSe Function as a reporting node.\nD.2\tResponding ProSe Function behaviour\nThe responding ProSe Function may report its current load by including a Load AVP of type HOST in answer commands as described in IETF RFC 8583 [28].\nThe responding ProSe Function calculates its current load by implementation specific means. For example, the responding ProSe Function may take into account the traffic over the PC6/PC7 interface or other interfaces, the level of usage of internal resources (e.g. CPU, memory), the access to external resources, etc.\nThe responding ProSe Function determines when to send Load AVPs of type HOST by implementation specific means.\nD.3\tRequesting ProSe Function behaviour\nWhen performing next hop Diameter Agent selection for requests that are routed based on realm, the requesting ProSe Function may take into account load values from Load AVPs of type PEER received from candidate next hop Diameter nodes, as per IETF RFC 8583 [28].\nAnnex E (informative):Change history\nChange history\nDate\nMeeting\nTDoc\nCR\nRev\nCat\nSubject/Comment\nNew version\n2014-04\nCT4#64bis\nC4-140705\nTR Skeleton\n0.1.0\n2014-05\nCT4#65\nC4-141079\nProposed text for clause \"Scope\"\n0.2.0\n2014-05\nCT4#65\nC4-141080\nGeneral Description of TS 29.345\n0.2.0\n2014-05\nCT4#65\nC4-141081\nDescription of the ProSe Service Authorization Procedure\n0.2.0\n2014-05\nCT4#65\nC4-141082\nDescription of the Direct Discovery Authorization procedure\n0.2.0\n2014-05\nCT4#65\nC4-141084\nDescription of the Match Report Procedure\n0.2.0\n2014-05\nCT4#65\nC4-141086\nDescription of the Proximity request Procedure\n0.2.0\n2014-05\nCT4#65\nC4-141087\nDescription of the Location Update procedure\n0.2.0\n2014-05\nCT4#65\nC4-141088\nDescription of the Cancellation procedure\n0.2.0\n2014-05\nCT4#65\nC4-141089\nDescription of Protocol Specification and Implementation\n0.2.0\n2014-05\nCT4#65\nC4-141090\nDescription of the Proximity Alert Procedure\n0.2.0\n2014-05\nCT4#65\nC4-141091\nDescription of Information Elements\n0.2.0\n2014-05\nCT4#65\nC4-141092\nDescription of Commands\n0.2.0\n2014-05\nCT4#65\nC4-141175\nDescription of Result Codes\n0.2.0\n2014-07\nCT4#66\nC4-141266\nEditorial corrections\n0.3.0\n2014-07\nCT4#66\nC4-141422\nRemoval of the Cancellation-Type AVP\n0.3.0\n2014-07\nCT4#66\nC4-141423\nDomain Name used for ProSe related Diameter Applications\n0.3.0\n2014-07\nCT4#66\nC4-141511\nDescription of the Match Report Info procedure\n0.3.0\n2014-07\nCT4#66\nC4-141512\nCorrection of the User-Identifier AVP\n0.3.0\n2014-07\nCT4#66\nC4-141641\nCorrection of the Discovery-Filter AVP\n0.3.0\n2014-09\nCT#65\nCP-140498\nPresented for information and approval\n1.0.0\n2014-09\nCT#65\nApproved at CT#65\n12.0.0\n2014-12\nCT#66\nCP-140778\n0006\n1\nProSe Validity Timer to VPLMN\n12.1.0\n2014-12\nCT#66\nCP-140778\n0003\n1\nOverload Control management\n12.1.0\n2014-12\nCT#66\nCP-140778\n0007\n1\nWrong P-CR implementations\n12.1.0\n2014-12\nCT#66\nCP-140778\n0005\nClarification in the ProSe Direct Discovery Authorization Procedure\n12.1.0\n2014-12\nCT#66\nCP-140778\n0001\n4\nClarification on ProSe Application Code and Discovery Filter IE Formats\n12.1.0\n2014-12\nCT#66\nCP-140778\n0009\n1\nDeletion of the unused AVP\n12.1.0\n2014-12\nCT#66\nCP-140778\n0010\n1\nUpdates of the values for Application ID, Command codes, AVP codes and Experimental-Result codes\n12.1.0\n2015-03\nCT#67\nCP-150028\n0012\n2\nCorrection on ProSe Service Authorization Procedures in PC6/PC7 interface\n12.2.0\n2015-03\nCT#67\nCP-150028\n0014\n2\nAddition of Integrity Check aspects to ProSe Match Report procedure\n12.2.0\n2015-03\nCT#67\nCP-150028\n0016\n1\nCorrection in the Discovery Type description\n12.2.0\n2015-03\nCT#67\nCP-150028\n0020\n2\nLocation Update Trigger\n12.2.0\n2015-03\nCT#67\nCP-150149\n0015\n4\nIntroduction of Authorized Discovery Range Indication for announcing UE\n12.2.0\n2015-03\nCT#67\nCP-150031\n0021\n1\nUpdate of the reference for IETF draft-ietf-dime-ovli\n12.2.0\n2015-06\nCT#68\nCP-150257\n0022\n1\nAddition of Match Report Refresh Timer in PMA command\n12.3.0\n2015-06\nCT#68\nCP-150257\n0024\n1\nCorrections of errors and inconsistencies in TS 29.345\n12.3.0\n2015-06\nCT#68\nCP-150257\n0025\n2\nAmbiguity in the definition of Prose-Discovery-Filter AVP\n12.3.0\n2015-06\nCT#68\nCP-150257\n0027\n2\nClarification on ProSe Validity Timer\n12.3.0\n2015-06\nCT#68\nCP-150257\n0028\n2\nAlignment on using ProSe service and ProSe\n12.3.0\n2015-12\nCT#70\nCP-150755\n0032\n4\nCorrection of AVP and message definitions to allow Diameter command reuse\n12.4.0\n2015-12\nCT#70\nCP-150755\n0033\n1\nMetadata in Match-Report\n12.4.0\n2015-12\nCT#70\nCP-150759\n0035\n1\nReference to DOIC updated with IETF RFC 7683\n12.4.0\n2015-12\nCT#70\nCP-150772\n0029\n5\nAddition of ProSe discovery service authorization for restricted discovery\n13.0.0\n2015-12\nCT#70\nCP-150772\n0030\n2\nProSe Open Discovery for Dynamic Metadata\n13.0.0\n2015-12\nCT#70\nCP-150772\n0031\n2\nAVP and Message format changes for new ProSe procedures\n13.0.0\n2015-12\nCT#70\nCP-150772\n0034\n2\nAddition of ProSe match report info for restricted discovery\n13.0.0\n2016-03\nCT#71\nCP-160023\n0041\nDiameter message priority over PC6/PC7\n13.1.0\n2016-03\nCT#71\nCP-160036\n0036\n3\nMonitoring update and Reporting of update result\n13.1.0\n2016-03\nCT#71\nCP-160036\n0037\n1\nInter-PLMN discovery transmission support\n13.1.0\n2016-03\nCT#71\nCP-160036\n0038\n1\nAdding security related parameters for restricted ProSe direct discovery authorization\n13.1.0\n2016-03\nCT#71\nCP-160036\n0039\n1\nSupport open discovery with application-controlled extension\n13.1.0\n2016-03\nCT#71\nCP-160036\n0040\n-\nDiscovery update for open and restricted ProSe direct discovery\n13.1.0\n2016-06\nCT#72\nCP-160232\n0042\n2\nUpdate of AVP codes for ProSe direct discovery security and open ProSe direct discovery with application-controlled extension\n13.2.0\n2016-06\nCT#72\nCP-160232\n0043\n1\nClarification of local PLMN usage in direct discovery authorization\n13.2.0\n2016-12\nCT#74\nCP-160664\n0045\n-\nCorrection to change IETF drmp draft version to official RFC 7944\n13.3.0\n2016-12\nCT#74\nCP-160681\n0044\n1\nLoad Control\n14.0.0\n2017-03\nCT#75\nCP-170048\n0046\n1\nUpdate of reference for the Diameter base protocol\n14.1.0\n2017-03\nCT#75\nCP-170048\n0047\n1\nHandling of the Vendor-Specific-Application-Id AVP\n14.1.0\n2017-03\nCT#75\nCP-170048\n0048\n1\nCardinality of the Failed-AVP AVP in answer\n14.1.0\n2017-06\nCT#76\nCP-171018\n0050\n1\nSupport for signaling transport level packet marking\n14.2.0\n2017-09\nCT#77\nCP-172013\n0052\n-\nCorrection of DRMP Procedures\n14.3.0\n2017-12\nCT#78\nCP-173032\n0053\n1\nUpdates for WLAN based ProSe Direct Discovery\n15.0.0\n2019-09\nCT#85\nCP-192094\n0055\n1\ndraft-ietf-dime-load published as RFC 8583\n15.1.0\n2020-07\nCT#88e\n-\n-\n-\nUpdate to Rel-16 version (MCC)\n16.0.0\n2022-04\n-\n-\n-\n-\n-\nUpdate to Rel-17 version (MCC)\n17.0.0\n2024-03\n-\n-\n-\n-\n-\nUpdate to Rel-18 version (MCC)\n18.0.0",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.334",
        "ts_29.345",
        "ts_0.2",
        "ts_12.1"
      ]
    }
  ]
}
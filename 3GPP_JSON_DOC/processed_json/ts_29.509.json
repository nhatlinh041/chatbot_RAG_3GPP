{
  "metadata": {
    "specification_id": "ts_29.509",
    "version": "18.5.0",
    "title": "3GPP TS 29.509",
    "file_path": "/content/drive/MyDrive/RAG_thesis/data/29_series/29509-i50/29509-i50.docx"
  },
  "export_info": {
    "export_date": "2025-07-26T09:00:21.072289",
    "total_chunks": 131
  },
  "chunks": [
    {
      "chunk_id": "ts_29.509_1",
      "section_id": "1",
      "section_title": "Scope",
      "content": "The present document specifies the stage 3 protocol and data model for the Nausf Service Based Interface. It provides stage 3 protocol definitions and message flows, and specifies the API for each service offered by the AUSF.\nThe 5G System stage 2 architecture and procedures are specified in 3GPP TS 23.501 [2], 3GPP TS 23.502 [3] and 3GPP TS 33.501 [8].\nThe Technical Realization of the Service Based Architecture and the Principles and Guidelines for Services Definition are specified in 3GPP TS 29.500 [4] and 3GPP TS 29.501 [5].",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.501",
        "ts_23.502",
        "ts_33.501",
        "ts_29.500",
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_2",
      "section_id": "2",
      "section_title": "References",
      "content": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non‑specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[3]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".\n[4]\t3GPP TS 29.500: \"5G System; Technical Realization of Service Based Architecture; Stage 3\".\n[5]\t3GPP TS 29.501: \"5G System; Principles and Guidelines for Services Definition; Stage 3\".\n[6]\tIETF RFC 9113: \"HTTP/2\".\n[7]\tIETF RFC 8259: \"The JavaScript Object Notation (JSON) Data Interchange Format\".\n[8]\t3GPP TS 33.501: \"Security Architecture and Procedures for 5G System\".\n[9]\tVoid\n[10]\t3GPP TS 29.571: \"5G System; Common Data Types for Service Based Interfaces; Stage 3\".\n[11]\tIETF RFC 9457: \"Problem Details for HTTP APIs\".\n[12]\t3GPP TS 29.503: \"5G System; Unified Data Management Services; Stage 3\".\n[13]\tIETF RFC 6749: \"The OAuth 2.0 Authorization Framework\".\n[14]\t3GPP TS 29.510: \"Network Function Repository Services; Stage 3\".\n[15]\t3GPP TS 31.102: \"Characteristics of the Universal Subscriber Identity Module (USIM) application\".\n[16]\tIETF RFC 5216: \"The EAP-TLS Authentication Protocol\".\n[17]\tIETF RFC 9048: \"Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')\".\n[18]\tIETF RFC 3748: \"Extensible Authentication Protocol (EAP)\".\n[19]\tIETF RFC 4648: \"The Base16, Base32 and Base64 Data Encodings\".\n[20]\t3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS); Stage 3\".\n[21]\t3GPP TR 21.900: \"Technical Specification Group working methods\".\n[22]\t3GPP TS 29.544: \"5G System; SP-AF Services; Stage 3\".\n[23]\t3GPP TS 23.316: \" Wireless and wireline convergence access support for the 5G System (5GS); Release 16\".\n[24]\t3GPP TS 29.524: \"5G System; Cause codes mapping between 5GC interfaces; Stage 3\".\n[25]\tOpenAPI Initiative, \"OpenAPI Specification Version 3.0.0\", https://spec.openapis.org/oas/v3.0.0\n[26]\t3GPP TS 33.503: \" Security Aspects of Proximity based Services (ProSe) in the 5G System (5GS)\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905",
        "ts_23.501",
        "ts_23.502",
        "ts_29.500",
        "ts_29.501",
        "ts_33.501",
        "ts_29.571",
        "ts_29.503",
        "ts_29.510",
        "ts_31.102",
        "ts_24.501",
        "ts_21.900",
        "ts_29.544",
        "ts_23.316",
        "ts_29.524",
        "ts_33.503"
      ]
    },
    {
      "chunk_id": "ts_29.509_3.1",
      "section_id": "3.1",
      "section_title": "Definitions",
      "content": "For the purposes of the present document, the terms and definitions given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_21.905"
      ]
    },
    {
      "chunk_id": "ts_29.509_3.2",
      "section_id": "3.2",
      "section_title": "Abbreviations",
      "content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\n5G Prose\t5G Proximity-based Services\nAMF\tAccess and Mobility Management Function\nAPI\tApplication Programming Interface\nAUSF\tAuthentication Server Function\nCH\tCredentials Holder\nDCS\tDefault Credentials Server\nFN-RG\tFixed Network RG\nMAC\tMessage Authentication Code\nN5GC\tNon-5G-Capable\nNF\tNetwork Function\nRG\tResidential Gateway\nSEAF\tSEcurity Anchor Function\nSNPN\tStand-alone Non-Public Network\nSoR\tSteering of Roaming\nURI\tUniform Resource Identifier\nUPU\tUE Parameters Update\nW-AGF\tWireline Access Gateway Function",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905"
      ]
    },
    {
      "chunk_id": "ts_29.509_4.1",
      "section_id": "4.1",
      "section_title": "Introduction",
      "content": "The Network Function (NF) Authentication Server Function (AUSF) is the network entity in the 5G Core Network (5GC) supporting the following functionalities:\n-\tAuthenticate the UE for the requester NF,\n-\tProvide keying material to the requester NF,\n-\tProtect the Steering Information List for the requester NF.\n-\tProtect the UE Parameter Update Data for the requester NF.\nFigure 4-1 shows the reference architecture for the AUSF:\nFigure 4-1: AUSF in 5G System architecture\nThis figure represents the AUSF architecture in the Service-based Architecture model. In the reference point model, the interface between the AMF and the AUSF is named N12, the interface between the NSWOF and the AUSF is named N60. In this release, the SEAF function is collocated with the AMF. The AUSF may provide the service to the UDM.\nFigure 4-1 illustates PLMN level scenarios, but this architecture is also applicable to the SNPN scenarios, as explained below.\nIn the case of SNPN, the AUSF provides services e.g. in the following scenarios:\n-\tFor an SNPN for which roaming is not supported (see 3GPP TS 23.501 [2], clause 5.30.2.0)\n-\tFor the case of UE access to SNPN using credentials from Credentials Holder (see 3GPP TS 23.501 [2], clause 5.30.2.9)\n-\tFor the case of Onboarding of UEs for SNPNs (see 3GPP TS 23.501 [2], clause 5.30.2.10)\n-\tFor the case of supports the authentication of a 5G ProSe Remote UE or a 5G ProSe End UE  (see 3GPP TS 33.503 [26], clause 7.3)",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.501_clause_5.30.2.0",
        "ts_23.501_clause_5.30.2.9",
        "ts_23.501_clause_5.30.2.10",
        "ts_33.503_clause_7.3",
        "figure_4-1",
        "ts_23.501",
        "ts_33.503"
      ]
    },
    {
      "chunk_id": "ts_29.509_5.1",
      "section_id": "5.1",
      "section_title": "Introduction",
      "content": "The AUSF offers to NF Service Consumers (e.g. AMF) the following services:\n-\tNausf_UEAuthentication\n-\tNausf_SoRProtection\n-\tNausf_UPUProtection\nTable 5.1-1 summarizes the corresponding APIs defined for this specification.\nTable 5.1-1: API Descriptions\nService Name\nClause\nDescription\nOpenAPI Specification File\napiName\nAnnex\nNausf_UEAuthentication\n6.1\nAUSF UE Authentication Service\nTS29509_Nausf_UEAuthentication.yaml\nnausf-auth\nA.2\nNausf_SoRProtection\n6.2\nAUSF SoR Protection Service\nTS29509_Nausf_SoRProtection.yaml\nnausf-sorprotection\nA.3\nNausf_UPUProtection\n6.3\nAUSF UPU Protection Service\nTS29509_Nausf_UPUProtection.yaml\nnausf-upuprotection\nA.4\nAUSF provides services to the following SNPN scenarios (see clauses 5.30.2 in 3GPP TS 23.501 [2]):\n-\tIn a SNPN where roaming is not supported;\n-\tIn the case of UE access to SNPN using credentials from Credentials Holder with AAA-S;\n-\tIn the case of UE access to SNPN using credentials from Credentials Holder with AUSF and UDM;\n-\tIn the case of Onboarding of UEs for SNPNs without using Default Credentials Server;\n-\tIn the case of Onboarding of UEs for SNPNs using Default Credentials Server with AAA-S;\n-\tIn the case of Onboarding of UEs for SNPNs using Default Credentials Server with AUSF and UDM.",
      "chunk_type": "general",
      "cross_references": [
        "table_5.1-1",
        "ts_23.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_5.2.1",
      "section_id": "5.2.1",
      "section_title": "Service Description",
      "content": "The AUSF is acting as NF Service Producer. It provides UE authentication service to the requester NF. The NF Service Consumer is the AMF.\nFor this service, the following service operations are defined:\n-\tAuthenticate\nThis service permits to authenticate the UE and to provide one or more master keys which are used by the AMF to derived subsequent keys.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_5.2.2.1",
      "section_id": "5.2.2.1",
      "section_title": "Introduction",
      "content": "The service operation defined for the Nausf_UEAuthentication is as follows:\n-\tAuthenticate: It allows the AMF to authenticate the UE and allows the AMF to inform AUSF to remove the UE authentication result in the UDM.\n-\tDeregister: It allows UDM to request the AUSF to clear the Security Context.\n-\tProseAuthenticate: It allows the AUSF of the 5G ProSe Remote UE to support the authentication of a 5G ProSe Remote UE via the AMF of the 5G ProSe UE-to-Network Relay or allows the AUSF of the 5G ProSe End UE to support the authentication of a 5G ProSe End UE via the AMF of the 5G ProSe UE-to-UE Relay.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_5.2.2.2.1",
      "section_id": "5.2.2.2.1",
      "section_title": "General",
      "content": "The service operation \"Authenticate\" permits the requester NF to initiate the Authentication of the UE by providing the following information to the AUSF:\n-\tUE id (i.e. SUPI or SUCI)\n-\tServing Network Name\nThe AUSF retrieves the UE's subscribed authentication method from the UDM and depending on the information provided by the UDM, the AUSF enters in one of the following procedures:\n-\t5G-AKA\n-\tEAP-based authentication'\nFor those two different procedures a new resource is generated by the AUSF. The content of the resource will depend on the procedure and will be returned to the AMF.\nThis service operation \"Authenticate\" also permits the requester NF to initiate the Authentication of the FN-RG registration via W-AGF by providing the following information to the AUSF:\n-\tUE id (i.e. SUCI)\n-\tIndication that the W-AGF has authenticated the FN-RG\nThe AUSF retrieves the UE's SUPI, indication that authentication is not required for the FN-RG from the UDM, and AUSF shall not perform the authentication.\nThe service operation \"Authenticate\" also permits the requester NF to inform the AUSF to remove the UE authentication result in the UDM.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_5.2.2.2.2",
      "section_id": "5.2.2.2.2",
      "section_title": "5G AKA",
      "content": "In this procedure, the NF Service Consumer (AMF) requests the authentication of the UE by providing UE related information and the Serving Network Name to the NF Service Producer (AUSF), which retrieves UE related data and authentication method from the UDM. In this case the retrieved authentication method is 5G AKA. The NF Service Consumer (AMF) shall then return to the AUSF the result received from the UE:\nFigure 5.2.2.2.2-1: 5G AKA\n1.\tThe NF Service Consumer (AMF) shall send a POST request to the AUSF. The content shall contain at least the UE Id and the Serving Network Name.\n2a.\tOn success, \"201 Created\" shall be returned. The content shall contain the representation of the resource created and the \"Location\" header shall contain the URI of the created resource (e.g. .../ue_authentications/{authCtxId}). The AUSF generates a sub-resource \"5g-aka-confirmation\". There shall be only one sub-resource \"5g-aka-confirmation\" per UE per Serving Network identified by the supiOrSuci and servingNetworkName in AuthenticationInfo. The AUSF shall provide an hypermedia link towards this sub-resource in the content to indicate to the AMF where it shall send a PUT for the confirmation.\n2b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.2.3.1-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.2.3.1-3. If the serving network is not authorized, the AUSF shall use the SERVING_NETWORK_NOT_AUTHORIZED \"cause\".\n3.\tBased on the relation type, the NF Service Consumer (AMF) deduces that it shall send a PUT containing the \"RES*\" provided by the UE to the URI provided by the AUSF or derived by itself. The NF Service Consumer (AMF) shall also send a PUT containing null value in the RES* to indicate the failure to the AUSF for the following cases:\n-\tif the UE is not reached, and the RES* is never received by the NF Service Consumer (AMF);\n-\tthe comparation of the HRES* and HXRES* is unsuccessful in the NF Service Consumer (AMF);\n-\tthe authentication failure is received from the UE, e.g. synchronization failure or MAC failure;\n4a.\tOn success, \"200 OK\" shall be returned. If the UE is not authenticated, e.g. the verification of the RES* was not successful in the AUSF, the AUSF shall set the value of AuthResult to AUTHENTICATION_FAILURE.\nIn SNPN onboarding scenarios, if the UE is authenticated successfully, the AUSF may include in the response the FQDN(s) and/or IP address(es) of an onboarding Provisioning Server (PVS) to the NF Service Consumer (AMF); see 3GPP TS 23.501 [2], clause 5.30.2.10.\n4b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.3.3.1-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.3.3.1-3.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.501_clause_5.30.2.10",
        "table_6.1.3.2.3.1-3",
        "table_6.1.3.3.3.1-3",
        "figure_5.2.2.2.2-1",
        "ts_23.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_5.2.2.2.3",
      "section_id": "5.2.2.2.3",
      "section_title": "EAP-based authentication method",
      "content": "5.2.2.2.3.1\tGeneral\nIn this procedure, the NF Service Consumer requests the authentication of the UE by providing UE related information and the serving network and the EAP-based authentication is selected (see IETF RFC 3748 [18]). EAP messages are exchanged between a UE acting as EAP peer, an NF Service Consumer (AMF/SEAF, NSWOF) acting as a pass-through authenticator and the AUSF acting as the EAP server.\n5.2.2.2.3.2\tEAP method: EAP-AKA'\nEAP-AKA' is the EAP method used in this procedure\nFigure 5.2.2.2.3-1: EAP-based authentication with EAP-AKA' method\n1.\tThe NF Service Consumer (AMF, NSWOF) shall send a POST request to the AUSF. The content shall contain at least the UE Id, Serving Network Name. If the consumer is an NSWOF the NSWO Indicator shall be present in the content.\n2a.\tOn success, \"201 Created\" shall be returned. The content shall contain the representation of the resource generated and the \"Location\" header shall contain the URI of the generated resource (e.g. .../ue_authentications/{authCtxId}). The AUSF generates a sub-resource \"eap-session\". There shall be only one sub-resource \"eap-session\" per UE per Serving Network identified by the supiOrSuci and servingNetworkName in AuthenticationInfo. The AUSF shall provide a hypermedia link towards this sub-resource in the payload to indicate to the AMF or NSWOF where it shall send a POST containing the EAP packet response. The content shall also contain the EAP packet EAP-Request/AKA'-Challenge.\n2b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.2.3.1-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.2.3.1-3. In particular, if the serving network is not authorized, the AUSF shall use the \"Cause\" SERVING_NETWORK_NOT_AUTHORIZED.\n3.\tBased on the relation type, the NF Service Consumer (AMF, NSOWF) shall send a POST request including the EAP-Response/AKA' Challenge received from the UE. The POST request is sent to the URI provided by the AUSF or derived by the NF Service Consumer (AMF, NSWOF).\n4a.\tOn success, and if the AUSF and the UE have indicated the use of protected successful result indications as in IETF RFC 9048 [17], the AUSF shall reply with a \"200 OK\" HTTP message containing the EAP Request/AKA' Notification and an hypermedia link towards the sub-resource \"eap-session\".\n4b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.4.3.1-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.4.3.1-3.\nNOTE: Steps 4 to 5 are optional.\n5.\tThe NF Service Consumer (AMF, NSWOF) shall send a POST request including the EAP Response/AKA' Notification received from the UE. The POST request is sent to the URI provided by the AUSF or derived by the NF Service Consumer (AMF, NSWOF).\n6a.\tIf the EAP authentication exchange is successfully completed (with or without the optional Notification Request/Response messages exchange), \"200 OK\" shall be returned to the NF Service Consumer (AMF, NSWOF). The content shall contain the result of the authentication, an EAP success/failure and if the authentication is successful the Kseaf if the consumer is an AMF or the MSK if the consumer is a NSWOF (as indicated by the NSWO indicator received in step 1). If the UE is not authenticated, the AUSF shall set the authResult to AUTHENTICATION_FAILURE.\nIn SNPN onboarding scenarios, if the UE is authenticated successfully, the AUSF may include in the response the FQDN(s) and/or IP address(es) of an onboarding Provisioning Server (PVS) to the NF Service Consumer (AMF) ; see 3GPP TS 23.501 [2], clause 5.30.2.10.\n6b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.4.3.1-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.4.3.1-3.\n5.2.2.2.3.3\tEAP method: EAP-TLS\nThe EAP-TLS method can be used in private networks as an EAP method (see 3GPP TS 33.501 [8] Annex B.1). The corresponding stage 3 implementation is described in Annex B.\nThe EAP-TLS method is applicable for N5GC devices behind Cable RGs in private networks or in deployment scenarios with wireline access; see 3GPP TS 33.501 [8] Annex O.\n5.2.2.2.3.4\tEAP method: EAP-TTLS\nThe EAP-TTLS method can be used as an EAP method (see 3GPP TS 33.501 [8] Annex U) in case of UE access to SNPN using credentials from Credential Holder with AAA Server.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.501_clause_5.30.2.10",
        "table_6.1.3.2.3.1-3",
        "table_6.1.3.4.3.1-3",
        "figure_5.2.2.2.3-1",
        "ts_23.501",
        "ts_33.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_5.2.2.2.4",
      "section_id": "5.2.2.2.4",
      "section_title": "Authentication for FN-RG",
      "content": "In this procedure, the NF Service Consumer (AMF) requests the authentication of the FN-RG registration via W-AGF by providing the SUCI of the FN-RG and the authenticated indication.\nFigure 5.2.2.2.4-1: Authentication for FN-RG\n1.\tThe NF Service Consumer (AMF) shall send a POST request to the AUSF. The content shall contain at least the UE Id and the authenticated indication.\n2a.\tOn success, \"201 Created\" shall be returned. The content shall contain the representation of the resource created and the \"Location\" header shall contain the URI of the created resource (e.g. .../rg-authentications/{authCtxId}).\n2b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.4.3.1-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.4.3.1-3.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.3.4.3.1-3",
        "figure_5.2.2.2.4-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_5.2.2.2.5",
      "section_id": "5.2.2.2.5",
      "section_title": "Authentication Result Removal with 5G AKA method",
      "content": "In the case that the Purge of subscriber data in AMF after the UE deregisters from the network or the NAS SMC fails following the successful authentication in the registration procedure, the NF Service Consumer (AMF) requests the AUSF to inform the UDM to remove the authentication result:\nFigure 5.2.2.2.5-1: Authentication Result Removal with 5G AKA method\n1.\tThe NF Service Consumer (AMF) shall send a DELETE request to the resource URI representing the sub-resource \"5g-aka-confirmation\". The request body shall be empty.\n2a.\tOn success, \"204 No Content\" shall be returned. The AUSF shall send a DELETE request to the UDM for removing the authentication result of the UE after receiving the above DELETE request message.\n2b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.3.3.2-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.3.3.2-3..",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.3.3.3.2-3",
        "figure_5.2.2.2.5-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_5.2.2.2.6",
      "section_id": "5.2.2.2.6",
      "section_title": "Authentication Result Removal with EAP-AKA' method",
      "content": "In the case that the Purge of subscriber data in AMF after the UE deregisters from the network or the NAS SMC fails following the successful authentication the registration procedure, the NF Service Consumer (AMF) requests the AUSF to inform the UDM to remove the authentication result:\nFigure 5.2.2.2.6-1: Authentication Result Removal with EAP-AKA' method\n1.\tThe NF Service Consumer (AMF) shall send a DELETE request to the resource URI representing the sub-resource \"eap-session\". The request body shall be empty.\n2a.\tOn success, \"204 No Content\" shall be returned. The AUSF shall send a DELETE request to the UDM for removing the authentication result of the UE after receiving the above DELETE request message.\n2b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.4.3.2-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.4.3.2-3.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.3.4.3.2-3",
        "figure_5.2.2.2.6-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_5.2.2.3.1",
      "section_id": "5.2.2.3.1",
      "section_title": "General",
      "content": "The Deregister service operation is used in the following scenario:\n-\tDeletion of security context in AUSF\nThe NF Service Consumer (e.g. UDM) uses this service operation to request the AUSF to clear the stale security context, after the UE has been successfully (re)authenticated in same or different Serving Network via another AUSF Instance, e.g. due to registration via another access-type; so as to ensure only latest Kausf is maintained in the network. The service may also be used by UDM when the UE is no longer registered via any access-type or serving-network. It is responsibility of NF Service Consumers to ensure that security context being deleted does not hold the latest Kausf if UE is also connected via another Serving-Network.\nFigure 5.2.2.3.1-1: UE Context Clean-up in AUSF\n1.\tThe NF Service Consumer (e.g. UDM) shall send a POST request to the AUSF that was used to authenticate the UE. The content shall contain the UE id (e.g. SUPI).\n2a.\tOn success, \"204 No Content\" shall be returned.\n2b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.2.4.2.2-2 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.2.4.2.2-2.",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.1.3.2.4.2.2-2",
        "figure_5.2.2.3.1-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_5.2.2.4.1",
      "section_id": "5.2.2.4.1",
      "section_title": "General",
      "content": "The ProseAuthenticate service operation is used in the following scenario:\n-\tAuthenticate the 5G ProSe Remote UE in AUSF or 5G ProSe End UE\nThe NF Service Consumer (AMF) requests the authentication of the 5G ProSe Remote UE or the 5G ProSe End UE  by providing 5G ProSe Remote UE or the 5G ProSe End UE  related information (SUCI or CP-PRUK ID), the Relay Service Code and Nonce_1 to the NF Service Producer (AUSF) in the initial authentication request. When CP-PRUK ID is provided, the AUSF shall retrieve the CP-PRUK from PAnF; when SUCI is provided, the AUSF retrieves 5G ProSe Remote UE or the 5G ProSe End UE  related data and authentication method from the UDM. In this case the retrieved authentication method is EAP-AKA. The NF Service Consumer (AMF) shall then return to the AUSF the result received from the 5G ProSe Remote UE or the 5G ProSe End UE  to continue the authentication:\nFigure 5.2.2.4.1-1: ProSe Authentication\n1.\tThe NF Service Consumer (AMF) shall send a POST request to the AUSF. The content shall contain the UE Id (SUCI) or CP-PRUK ID, Relay Service Code and Nonce_1.\n2a.\tOn success, \"201 Created\" shall be returned if UE Id (SUCI) is received. The content shall contain the representation of the resource generated and the \"Location\" header shall contain the URI of the generated resource (e.g. .../prose_authentications/{authCtxId}). The AUSF generates a sub-resource \"prose-auth\". There shall be only one sub-resource \"prose-auth\" per UE identified by the supiOrSuci in ProSeAuthenticationInfo. The AUSF shall provide a hypermedia link towards this sub-resource in the content to indicate to the AMF where it shall send a POST containing the EAP packet response. The content shall also contain the EAP packet EAP-Request/AKA'-Challenge.\n2b. On success, \"200 OK\" shall be returned if CP-PRUK ID is received. The payload body shall contain the KNR_ProSe and Nonce_2. Step 3 to 6 are skipped.\n2c.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.2.3.1-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.2.3.1-3.\n3.\tBased on the relation type, the NF Service Consumer (AMF) shall send a POST request including the EAP-Response/AKA' Challenge received from the 5G ProSe Remote UE or the 5G ProSe End UE. The POST request is sent to the URI provided by the AUSF or derived by the NF Service Consumer (AMF).\n4a.\tOn success, and if the AUSF and the UE have indicated the use of protected successful result indications as in IETF RFC 5448 [9] (to be superseded by draft-ietf-emu-rfc5448bis [17]), the AUSF shall reply with a \"200 OK\" HTTP message containing the EAP Request/AKA' Notification and an hypermedia link towards the sub-resource \"prose-auth\".\n4b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.4.3.1-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.4.3.1-3.\nNOTE: Steps 4 to 5 are optional.\n5.\tThe NF Service Consumer (AMF) shall send a POST request including the EAP Response/AKA' Notification received from the UE. The POST request is sent to the URI provided by the AUSF or derived by the NF Service Consumer (AMF).\n6a.\tIf the ProSe authentication exchange is successfully completed (with or without the optional Notification Request/Response messages exchange), \"200 OK\" shall be returned to the NF Service Consumer (AMF). The content shall contain the result of the authentication, an EAP success/failure. The content shall also contain the KNR_ProSe, Nonce_2 and CP-PRUK ID if the authentication is successful. If the 5G ProSe Remote UE or the 5G ProSe End UE  is not authenticated, the AUSF shall set the authResult to AUTHENTICATION_FAILURE.\n6b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.4.3.1-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.4.3.1-3.",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.1.3.2.3.1-3",
        "table_6.1.3.4.3.1-3",
        "figure_5.2.2.4.1-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_5.2.2.4.2",
      "section_id": "5.2.2.4.2",
      "section_title": "ProSe Authentication Result Removal with EAP-AKA' method",
      "content": "In the case that the authentication of a 5G ProSe Remote UE or the 5G ProSe End UEfails, the NF Service Consumer (AMF) requests the AUSF to inform the UDM to remove the authentication result:\nFigure 5.2.2.4.2-1: ProSe Authentication Result Removal with EAP-AKA' method\n1.\tThe NF Service Consumer (AMF) shall send a DELETE request to the resource URI representing the sub-resource \"prose-auth\". The request body shall be empty.\n2a.\tOn success, \"204 No Content\" shall be returned. The AUSF shall send a DELETE request to the UDM for removing the authentication result of the UE after receiving the above DELETE request message.\n2b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.3.4.3.2-3 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.3.4.3.2-3.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.3.4.3.2-3",
        "figure_5.2.2.4.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_5.3.1",
      "section_id": "5.3.1",
      "section_title": "Service Description",
      "content": "The AUSF is acting as NF Service Producer. It provides SoRProtection service to the NF Service Consumer.\nThis service permits to provide the NF Service Consumer (e.g. UDM) with the SoR-MAC-IAUSF and CounterSoR to protect the Steering Information from being tampered with or removed by the VPLMN.\nNOTE:\tIf the Steering Information is not available or HPLMN determines that no steering of the UE is required, a SOR transparent container information element with an HPLMN indication that 'no change of the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the UE protected by SoR-MAC-IAUSF and CounterSoR is still sent to the UE during registration. The Steering Information in such a case, the NF Service Consumer shall send an empty list to the AUSF when consuming the Nausf_SoRProtection Service.\nIn option this service also allows to provide the NF Service Consumer (e.g. UDM) with the SoR-XMAC-IUE that allows the NF Service Consumer (e.g. UDM) to verify that the UE received the Steering Information List.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_5.3.2.1",
      "section_id": "5.3.2.1",
      "section_title": "Introduction",
      "content": "The service operation defined for the Nausf_SoRProtection is as follows:\n-\tProtect",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_5.3.2.2.1",
      "section_id": "5.3.2.2.1",
      "section_title": "General",
      "content": "The Protect service operation is used in the following procedures:\n-\tProcedure for steering of UE in VPLMN during registration (see clause 6.14.2.1 of 3GPP TS 33.501 [8]);\n-\tProcedure for steering of UE in VPLMN after registration (see clause 6.14.2.2 of 3GPP TS 33.501 [8]).\nThe NF Service Consumer (e.g. UDM) uses this service operation to request the AUSF to compute the SoR-MAC-IAUSF and the CounterSoR by providing Steering Information. The NF Service Consumer (e.g. UDM) may also request the AUSF to compute the SoR-XMAC-IUE by providing the indication that an acknowledgement is requested from the UE.\nFigure 5.3.2.2.1-1: Steering of UE in VPLMN\n1.\tThe NF Service Consumer (e.g. UDM) shall send a POST request to the AUSF that was used to authenticate the UE. The content shall contain the Steering Information and the acknowledge indication.\n2a.\tOn success, \"200 OK\" shall be returned. The content shall contain the requested security material (e.g. SoR-MAC-IAUSF, CounterSoR, SoR-XMAC-IUE) necessary to protect the Steering of Roaming procedure.\nSoR Header shall be used to form the input as one of multiple parameters to calculate the SoR-MAC-IAUSF. If SoRHeader attribute is not provided by NF Service Consumer (e.g. UDM) as part of SorInfo, SoR Header shall be constructed by AUSF based on the information received in the request and encoded as specified in clause 9.11.3.51 of 3GPP TS 24.501[20].\n2b.\tOn failure or redirection, one of the HTTP status code listed in table 6.2.3.2.4.2.2-2 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.2.3.2.4.2.2-21. If the CounterSoR associated with the KAUSF of the UE, is about to wrap around, the AUSF shall use the \"COUNTER-WRAP\" cause.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_33.501_clause_6.14.2.1",
        "ts_33.501_clause_6.14.2.2",
        "ts_24.501_clause_9.11.3.51",
        "table_6.2.3.2.4.2.2-2",
        "table_6.2.3.2.4.2.2-21",
        "figure_5.3.2.2.1-1",
        "ts_33.501",
        "ts_24.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_5.4.1",
      "section_id": "5.4.1",
      "section_title": "Service Description",
      "content": "The AUSF is acting as NF Service Producer. It provides UPUProtection service to the NF Service Consumer.\nThis service permits to provide the NF Service Consumer (e.g. UDM) with the UPU-MAC-IAUSF and CounterUPU to protect the UE Parameters Update Data from being tampered with or removed.\nIn option this service also allows to provide the NF Service Consumer (e.g. UDM) with the UPU-XMAC-IUE that allows the NF Service Consumer (e.g. UDM) to verify that the UE received UE Parameters Update Data correctly.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_5.4.2.1",
      "section_id": "5.4.2.1",
      "section_title": "Introduction",
      "content": "The service operation defined for the Nausf_UPUProtection is as follows:\n-\tProtect",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_5.4.2.2.1",
      "section_id": "5.4.2.2.1",
      "section_title": "General",
      "content": "The Protect service operation is used in the following procedures:\n-\tProcedure for UE Parameters Update (see clause 6.15.2.1 of 3GPP TS 33.501 [8]).\nThe NF Service Consumer (e.g. UDM) uses this service operation to request the AUSF to compute the UPU-MAC-IAUSF and CounterUPU by providing the UE Parameters Update Data (UPU Data). The NF Service Consumer (e.g. UDM) may also request the AUSF to compute the UPU-XMAC-IUE by providing the indication that an acknowledgement is requested from the UE.\nFigure 5.4.2.2-1: UE Parameters Update in VPLMN\n1.\tThe NF Service Consumer (e.g. UDM) shall send a POST request to the AUSF that was used to authenticate the UE and stores the latest KAUSF for the UE. The content shall contain the UE Parameters Update Data (UPU Data), the UPU Header and the acknowledge indication.\n2a.\tOn success, \"200 OK\" shall be returned. The content shall contain the requested security material necessary to protect the UE Parameters Update procedure.\n2b.\tOn failure or redirection, one of the HTTP status code listed in table 6.3.3.2.4.2.2-2 shall be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.3.3.2.4.2.2-2. If the CounterUPU associated with the KAUSF of the UE, is about to wrap around, the AUSF shall use the \"COUNTER-WRAP\" cause.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_33.501_clause_6.15.2.1",
        "table_6.3.3.2.4.2.2-2",
        "figure_5.4.2.2-1",
        "ts_33.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.1",
      "section_id": "6.1.1",
      "section_title": "API URI",
      "content": "URIs of this API shall have the following root:\n{apiRoot}/<apiName>/<apiVersion>\nThe request URIs used in HTTP requests from the NF service consumer towards the NF service producer shall have the Resource URI structure defined in clause 4.4.1 of 3GPP TS 29.501 [5], i.e.:\n{apiRoot}/<apiName>/<apiVersion>/<apiSpecificResourceUriPart>\nwith the following components:\n-\tThe {apiRoot} shall be set as described in 3GPP TS 29.501 [6].\n-\tThe <apiName> shall be \"nausf-auth\".\n-\tThe <apiVersion> shall be \"v1\".\n-\tThe <apiSpecificResourceUriPart> shall be set as described in clause 6.1.3.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.501_clause_4.4.1",
        "clause_6.1.3",
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.2.1",
      "section_id": "6.1.2.1",
      "section_title": "General",
      "content": "HTTP/2, as defined in IETF RFC 9113 [6], shall be used as specified in clause 5 of 3GPP TS 29.500 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.2.2.1",
      "section_id": "6.1.2.2.1",
      "section_title": "General",
      "content": "The usage of HTTP standard headers is specified in clause 5.2.2 of 3GPP TS 29.500 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.2",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.2.2.2",
      "section_id": "6.1.2.2.2",
      "section_title": "Content type",
      "content": "The following content types shall be supported:\n-\tJSON, as defined in IETF RFC 8259 [7], shall be used as content type of the HTTP bodies specified in the present specification as indicated in clause 5.4 of 3GPP TS 29.500 [4].\n-\tThe Problem Details JSON Object (IETF RFC 9457 [11]). The use of the Problem Details JSON object in a HTTP response body shall be signalled by the content type \"application/problem+json\"\n-\tThe 3GPP hypermedia format as defined in 3GPP TS 29.501 [5]. The use of the 3GPP hypermedia format in a HTTP response body shall be signalled by the content type \"application/3gppHal+json\"",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.4",
        "ts_29.500",
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.2.3.1",
      "section_id": "6.1.2.3.1",
      "section_title": "General",
      "content": "The usage of HTTP custom headers shall be supported as specified in clause 5.2.3 of 3GPP TS 29.500 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.3",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.1",
      "section_id": "6.1.3.1",
      "section_title": "Overview",
      "content": "The structure of the Resource URIs of the Nausf_UEAuthentication service is shown in Figure 6.1.3.1-1\nFigure 6.1.3.1-1: Resource URI structure of the AUSF API\nTable 6.1.3.1-1 provides an overview of the resources and applicable HTTP methods.\nTable 6.1.3.1-1: Resources and methods overview\nResource name\nResource URI\nHTTP method or custom operation\nDescription\nue-authentications\n(Collection)\n/ue-authentications\nPOST\nInitiate the authentication process by providing inputs related to the UE\n/ue-authentications/deregister\nderegister\n(POST)\nClear the security context of the UE\nIndividual UE authentication (Document)\n/ue-authentications/{authCtxId}\nSee NOTE 1\n5g-aka-confirmation\n(Document)\n/ue-authentications/{authCtxId}/5g-aka-confirmation\nPUT\nPut the UE response from the 5G-AKA process.\nDELETE\nDELETE the authentication result.\neap-session\n(Document)\n/ue-authentications/{authCtxId}/eap-session\nPOST\nPost the EAP response from the UE.\nSee NOTE.\nDELETE\nDELETE the authentication result.\nrg-authentications\n(Collection)\n/rg-authentications\nPOST\nInitiate the authentication process by providing inputs related to the FN-RG\nIndividual RG authentication (Document)\n/rg-authentications/{authCtxId}\nSee NOTE 3\nprose-authentications\n(Collection)\n/prose-authentications\nPOST\nInitiate the authentication process by providing inputs related to the 5G ProSe Remote UE or the 5G ProSe End UE.\nprose-auth\n(Document)\n/prose-authentications/{authCtxId}/prose-auth\nPOST\nPost the EAP response from the 5G ProSe Remote UE or the 5G ProSe End UE.\nSee NOTE.\nDELETE\nDELETE the authentication result.\nNOTE 1:\tThis resource represents the created individual UE authentication, the URI of the created resource is contained in the \"Location\" header of the \"201 Created\" response (See step 2a of Figure 5.2.2.2.2-1 and Figure 5.2.2.2.3.2-1). There are no service operations defined on this resource.\nNOTE 2:\tThis POST is used to provide EAP response to the AUSF in a sub-resource (Document) generated by the first POST operation. As this operation is not idempotent (it triggers subsequent EAP operations), a PUT was not adequate.\nNOTE 3:\tThis resource represents the created individual RG authentication, the URI of the created resource is contained in the \"Location\" header of the \"201 Created\" response (See step 2a of Figure 5.2.2.2.4-1). There are no service operations defined on this resource.",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.1.3.1-1",
        "figure_6.1.3.1-1",
        "figure_5.2.2.2.2-1",
        "figure_5.2.2.2.3.2-1",
        "figure_5.2.2.2.4-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.2.1",
      "section_id": "6.1.3.2.1",
      "section_title": "Description",
      "content": "This resource represents a collection of the ue-authentication resources generated by the AUSF.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.1.3.2.2",
      "section_id": "6.1.3.2.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/nausf-auth/<apiVersion>/ue-authentications\nThis resource shall support the resource URI variables defined in table 6.1.3.3.2-1.\nTable 6.1.3.2.2-1: Resource URI variables for this resource\nName\nData type\nDefinition\napiRoot\nstring\nSee clause 6.1.1",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.1.1",
        "table_6.1.3.3.2-1",
        "table_6.1.3.2.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.2.3",
      "section_id": "6.1.3.2.3",
      "section_title": "Resource Standard Methods",
      "content": "6.1.3.2.3.1\tPOST\nThis method shall support the URI query parameters specified in table 6.1.3.2.3.1-1.\nTable 6.1.3.2.3.1-1: URI query parameters supported by the POST method on this resource\nName\nData type\nP\nCardinality\nDescription\nn/a\nThis method shall support the request data structures specified in table 6.1.3.2.3.1-2 and the response data structures and response codes specified in table 6.1.3.2.3.1-3.\nTable 6.1.3.2.3.1-2: Data structures supported by the POST Request Body on this resource\nData type\nP\nCardinality\nDescription\nAuthenticationInfo\nM\n1\nContains the UE id (i.e. SUCI or SUPI as specified in 3GPP TS 33.501 [8]) and the serving network name.\nIt may also contain Trace Data as specified in 3GPP TS 23.501 [2].\nTable 6.1.3.2.3.1-3: Data structures supported by the POST Response Body on this resource\nData type\nP\nCardinality\nResponse\nCodes\nDescription\nUEAuthenticationCtx\nM\n1\n201 Created\nUpon success, if 5G AKA is selected, the response body will contain one AV and \"link\" for the AMF to PUT the confirmation.\nIf an EAP-based method is selected, the response body will contain the EAP method selected, the corresponding EAP packet request and a \"link\" for the AMF to POST the EAP response.\nThe HTTP response shall include a \"Location\" header that contains the resource URI of the created resource.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n400 Bad Request\nThis case represents the failure to start authentication service because of input parameter error.\nProblemDetails\nO\n0..1\n403 Forbidden\nThis case represents when the UE is not allowed to be authenticated.\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- AUTHENTICATION_REJECTED\n- SERVING_NETWORK_NOT_AUTHORIZED\n- INVALID_HN_PUBLIC_KEY_IDENTIFIER\n- INVALID_SCHEME_OUTPUT\nProblemDetails\nO\n0..1\n404 Not Found\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- USER_NOT_FOUND\nProblemDetails\nO\n0..1\n500 Internal Server Error\nThis case represents the failure in starting the authentication service because of a server internal error.\nIf the error is due to a problem with UDM not able to generate the requested AV, the AUSF shall indicate the following application error: \"AV_GENERATION_PROBLEM\"\nProblemDetails\nO\n0..1\n501 Not Implemented\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- UNSUPPORTED_PROTECTION_SCHEME\nThis response shall not be cached.\nNOTE 1:\tThe mandatory HTTP error status codes for the POST method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4].\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4].\nTable 6.1.3.2.3.1-4: Headers supported by the 201 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nContains the URI of the newly created resource according to the structure: {apiRoot}/nausf-auth/<apiVersion>/ue-authentications/{authCtxId}\nTable 6.1.3.2.3.1-5: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.1.3.2.3.1-6: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500_clause_6.10.9.1",
        "table_6.1.3.2.3.1-1",
        "table_6.1.3.2.3.1-2",
        "table_6.1.3.2.3.1-3",
        "ts_23.501_table_6.1.3.2.3.1-3",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.1.3.2.3.1-4",
        "table_6.1.3.2.3.1-5",
        "table_6.1.3.2.3.1-6",
        "ts_33.501",
        "ts_23.501",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.2.4",
      "section_id": "6.1.3.2.4",
      "section_title": "Resource Custom Operations",
      "content": "6.1.3.2.4.1\tOverview\nTable 6.1.3.2.4.1-1: Custom operations\nCustom operation URI\nMapped HTTP method\nDescription\n{apiRoot}/nausf-auth/<apiVersion>/ue-authentications/deregister\nPOST\nClear the Security Context of the UE\n6.1.3.2.4.2\tOperation: deregister (POST)\n6.1.3.2.4.2.1\tDescription\nThis custom operation is used by the NF service consumer (e.g. UDM) to request the AUSF to clear the Security Context, after the UE has been successfully re-authenticated in same Serving Network, or has been successfully authenticated in another Serving Network, e.g. due to registration via another access-type.\n6.1.3.2.4.2.2\tOperation Definition\nThis operation shall support the request data structures specified in table 6.1.3.2.4.2.2-1 and the response data structure and response codes specified in table 6.1.3.2.4.2.2-2.\nTable 6.1.3.2.4.2.2-1: Data structures supported by the POST Request Body on this resource\nData type\nP\nCardinality\nDescription\nDeregistrationInfo\nM\n1\nSee 6.1.6.2.11.\nTable 6.1.3.2.4.2.2-2: Data structures supported by the POST Response Body on this resource\nData type\nP\nCardinality\nResponse\ncodes\nDescription\nn/a\n204 No Content\nThis case represents the handover is cancelled successfully.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n1\n404 Not Found\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- CONTEXT_NOT_FOUND\nSee table 6.1.7.3-1 for the description of this error.\nNOTE 1:\tThe mandatory HTTP error status codes for the POST method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4]).\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4].\nTable 6.1.3.2.4.4.2-3: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.1.3.2.4.4.2-4: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500_clause_6.10.9.1",
        "table_6.1.3.2.4.1-1",
        "table_6.1.3.2.4.2.2-1",
        "table_6.1.3.2.4.2.2-2",
        "table_6.1.7.3-1",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.1.3.2.4.4.2-3",
        "table_6.1.3.2.4.4.2-4",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.3.1",
      "section_id": "6.1.3.3.1",
      "section_title": "Description",
      "content": "The subresource \"5g-aka-confirmation\" is generated by the AUSF. This subresource should not persist after the AUSF has read its content.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.1.3.3.2",
      "section_id": "6.1.3.3.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/nausf-auth/<apiVersion>/ue-authentications/{authCtxId}/5g-aka-confirmation\nThis resource shall support the resource URI variables defined in table 6.1.3.3.2-1.\nTable 6.1.3.3.2-1: Resource URI variables for this resource\nName\nData Type\nDefinition\napiRoot\nstring\nSee clause 6.1.1\nauthCtxId\nstring\nRepresents a specific ue-authentication per UE per serving network",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.1.1",
        "table_6.1.3.3.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.3.3",
      "section_id": "6.1.3.3.3",
      "section_title": "Resource Standard Methods",
      "content": "6.1.3.3.3.1\tPUT\nThis method shall support the URI query parameters specified in table 6.1.3.3.3.1-1.\nTable 6.1.3.3.3.1-1: URI query parameters supported by the PUT method on this resource\nName\nData type\nP\nCardinality\nDescription\nn/a\nThis method shall support the request data structures specified in table 6.1.3.3.3.1-2 and the response data structures and response codes specified in table 6.1.3.3.3.1-3.\nTable 6.1.3.3.3.1-2: Data structures supported by the PUT Request Body on this resource\nData type\nP\nCardinality\nDescription\nConfirmationData\nM\n1\nContains the \"RES*\" generated by the UE and provided to the AMF.\nTable 6.1.3.3.3.1-3: Data structures supported by the PUT Response Body on this resource\nData type\nP\nCardinality\nResponse\nCodes\nDescription\nConfirmationDataResponse\nM\n1\n200 OK\nThis case indicates that the AUSF has performed the verification of the 5G AKA confirmation. The response body shall contain the result of the authentication and the Kseaf if the authentication is successful.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n400 Bad Request\nThis case represents a 5G AKA confirmation failure because of input parameter error. This indicates that the AUSF was not able to confirm the authentication.\nProblemDetails\nO\n0..1\n500 Internal Server Error\nThis case represents a 5G AKA confirmation failure because of a server internal error.\nNOTE 1:\tThe mandatory HTTP error status codes for the PUT method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4].\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4].\nTable 6.1.3.3.3.1-4: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.1.3.3.3.1-5: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\n6.1.3.3.3.2\tDELETE\nThis method shall support the URI query parameters specified in table 6.1.3.3.3.2-1.\nTable 6.1.3.3.3.2-1: URI query parameters supported by the DELETE method on this resource\nName\nData type\nP\nCardinality\nDescription\nn/a\nThis method shall support the request data structures specified in table 6.1.3.3.3.2-2 and the response data structures and response codes specified in table 6.1.3.3.3.2-3.\nTable 6.1.3.3.3.2-2: Data structures supported by the DELETE Request Body on this resource\nData type\nP\nCardinality\nDescription\nn/a\nTable 6.1.3.3.3.2-3: Data structures supported by the DELETE Response Body on this resource\nData type\nP\nCardinality\nResponse\nCodes\nDescription\nn/a\n204 No Content\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nNOTE 1:\tThe mandatory HTTP error status codes for the DELETE method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4].\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4].\nTable 6.1.3.3.3.2-4: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.1.3.3.3.2-5: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500_clause_6.10.9.1",
        "table_6.1.3.3.3.1-1",
        "table_6.1.3.3.3.1-2",
        "table_6.1.3.3.3.1-3",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.1.3.3.3.1-4",
        "table_6.1.3.3.3.1-5",
        "table_6.1.3.3.3.2-1",
        "table_6.1.3.3.3.2-2",
        "table_6.1.3.3.3.2-3",
        "ts_29.500_table_6.1.3.3.3.2-4",
        "table_6.1.3.3.3.2-5",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.4.1",
      "section_id": "6.1.3.4.1",
      "section_title": "Description",
      "content": "The \"eap-session\" is generated by the AUSF if an EAP-based authentication method is selected. This resource is used to handle the EAP session. This subresource should not persist after the EAP exchanges.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.1.3.4.2",
      "section_id": "6.1.3.4.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/nausf-auth/<apiVersion>/ue-authentications/{authCtxId}/eap-session\nThis resource shall support the resource URI variables defined in table 6.1.3.4.2-1.\nTable 6.1.3.4.2-1: Resource URI variables for this resource\nName\nData type\nDefinition\napiRoot\nstring\nSee clause 6.1.1\nauthCtxId\nstring\nRepresents a specifc ue-authentication per UE per serving network",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.1.1",
        "table_6.1.3.4.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.4.3",
      "section_id": "6.1.3.4.3",
      "section_title": "Resource Standard Methods",
      "content": "6.1.3.4.3.1\tPOST\nThis method shall support the URI query parameters specified in table 6.1.3.4.3.1-1.\nTable 6.1.3.4.3.1-1: URI query parameters supported by the POST method on this resource\nName\nData type\nP\nCardinality\nDescription\nn/a\nThis method shall support the request data structures specified in table 6.1.3.4.3.1-2 and the response data structures and response codes specified in table 6.1.3.4.3.1-3.\nTable 6.1.3.4.3.1-2: Data structures supported by the POST Request Body on this resource\nData type\nP\nCardinality\nDescription\nEapSession\nM\n1\nContains the EAP packet response (see IETF RFC 3748 [18]) from the UE and transferred by the AMF\nTable 6.1.3.4.3.1-3: Data structures supported by the POST Response Body on this resource\nData type\nP\nCardinality\nResponse\nCodes\nDescription\nEapSession\nM\n1\n200 OK\nDuring an EAP session, the body response shall contain the EAP packet Response and a hypermedia link.\nAt the end of the EAP session, the body response shall contain the EAP packet Success or Failure (see IETF RFC 3748 [18]) and the Kseaf if the authentication is successful\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n400 Bad Request\nThis case represents an EAP session failure because of input parameter error.  This indicates that the AUSF was not able to continue the EAP session.\nProblemDetails\nO\n0..1\n500 Internal Server Error\nThis case represents an EAP session failure because of a server internal error.\nNOTE:\tThe mandatory HTTP error status codes for the POST method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4].\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4]\nTable 6.1.3.4.3.1-4: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.1.3.4.3.1-5: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\n6.1.3.4.3.2\tDELETE\nThis method shall support the URI query parameters specified in table 6.1.3.4.3.2-1.\nTable 6.1.3.4.3.2-1: URI query parameters supported by the DELETE method on this resource\nName\nData type\nP\nCardinality\nDescription\nn/a\nThis method shall support the request data structures specified in table 6.1.3.4.3.2-2 and the response data structures and response codes specified in table 6.1.3.4.3.2-3.\nTable 6.1.3.4.3.2-2: Data structures supported by the DELETE Request Body on this resource\nData type\nP\nCardinality\nDescription\nn/a\nTable 6.1.3.4.3.2-3: Data structures supported by the DELETE Response Body on this resource\nData type\nP\nCardinality\nResponse\nCodes\nDescription\nn/a\n204 No Content\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nNOTE 1:\tThe mandatory HTTP error status codes for the DELETE method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4].\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4].\nTable 6.1.3.4.3.2-4: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.1.3.4.3.2-5: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500_clause_6.10.9.1",
        "table_6.1.3.4.3.1-1",
        "table_6.1.3.4.3.1-2",
        "table_6.1.3.4.3.1-3",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.1.3.4.3.1-4",
        "table_6.1.3.4.3.1-5",
        "table_6.1.3.4.3.2-1",
        "table_6.1.3.4.3.2-2",
        "table_6.1.3.4.3.2-3",
        "ts_29.500_table_6.1.3.4.3.2-4",
        "table_6.1.3.4.3.2-5",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.5.1",
      "section_id": "6.1.3.5.1",
      "section_title": "Description",
      "content": "This resource represents a collection of the rg-authentication resources generated by the AUSF.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.1.3.5.2",
      "section_id": "6.1.3.5.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/nausf-auth/<apiVersion>/rg-authentications\nThis resource shall support the resource URI variables defined in table 6.1.3.5.2-1.\nTable 6.1.3.5.2-1: Resource URI variables for this resource\nName\nData type\nDefinition\napiRoot\nstring\nSee clause 6.1.1",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.1.1",
        "table_6.1.3.5.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.5.3",
      "section_id": "6.1.3.5.3",
      "section_title": "Resource Standard Methods",
      "content": "6.1.3.5.3.1\tPOST\nThis method shall support the URI query parameters specified in table 6.1.3.5.3.1-1.\nTable 6.1.3.5.3.1-1: URI query parameters supported by the POST method on this resource\nName\nData type\nP\nCardinality\nDescription\nn/a\nThis method shall support the request data structures specified in table 6.1.3.5.3.1-2 and the response data structures and response codes specified in table 6.1.3.5.3.1-3.\nTable 6.1.3.5.3.1-2: Data structures supported by the POST Request Body on this resource\nData type\nP\nCardinality\nDescription\nRgAuthenticationInfo\nM\n1\nContains the UE id (i.e. SUCI as specified in 3GPP TS 23.316 [23] or 3GPP TS 33.501 [8]) and the authenticated indication.\nTable 6.1.3.5.3.1-3: Data structures supported by the POST Response Body on this resource\nData type\nP\nCardinality\nResponse\ncodes\nDescription\nRgAuthCtx\nM\n1\n201 Created\nUpon success, the response body will contain the SUPI of the UE and the authentication indication.\nThe HTTP response shall include a \"Location\" header that contains the resource URI of the created resource.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n400 Bad Request\nThis case represents the failure to start authentication service because of input parameter error.\nProblemDetails\nO\n0..1\n403 Forbidden\nThis case represents when the UE is not allowed to be authenticated.\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- AUTHENTICATION_REJECTED\n- INVALID_SCHEME_OUTPUT\nProblemDetails\nO\n0..1\n404 Not Found\nThe \"cause\" attribute may be used to indicate the following application error:\n- USER_NOT_FOUND\nNOTE 1:\tThe mandatory HTTP error status codes for the POST method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4].\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4].\nTable 6.1.3.5.3.1-4: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.1.3.5.3.1-5: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500_clause_6.10.9.1",
        "table_6.1.3.5.3.1-1",
        "table_6.1.3.5.3.1-2",
        "table_6.1.3.5.3.1-3",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.1.3.5.3.1-4",
        "table_6.1.3.5.3.1-5",
        "ts_23.316",
        "ts_33.501",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.6.1",
      "section_id": "6.1.3.6.1",
      "section_title": "Description",
      "content": "This resource represents a collection of the prose-authentication resources generated by the AUSF.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.1.3.6.2",
      "section_id": "6.1.3.6.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/nausf-auth/<apiVersion>/prose-authentications\nThis resource shall support the resource URI variables defined in table 6.1.3.6x.2-1.\nTable 6.1.3.6x.2-1: Resource URI variables for this resource\nName\nData type\nDefinition\napiRoot\nstring\nSee clause 6.1.1",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.1.1",
        "table_6.1.3.6"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.6.3",
      "section_id": "6.1.3.6.3",
      "section_title": "Resource Standard Methods",
      "content": "6.1.3.6.3.1\tPOST\nThis method shall support the URI query parameters specified in table 6.1.3.6.3.1-1.\nTable 6.1.3.6.3.1-1: URI query parameters supported by the POST method on this resource\nName\nData type\nP\nCardinality\nDescription\nn/a\nThis method shall support the request data structures specified in table 6.1.3.6.3.1-2 and the response data structures and response codes specified in table 6.1.3.6x.3.1-3.\nTable 6.1.3.6.3.1-2: Data structures supported by the POST Request Body on this resource\nData type\nP\nCardinality\nDescription\nProSeAuthenticationInfo\nM\n1\nContains the UE Id (i.e. SUCI as specified in 3GPP TS 33.503 [26]) or the CP-PRUK ID, the Relay Service Code and Nonce_1.\nTable 6.1.3.6.3.1-3: Data structures supported by the POST Response Body on this resource\nData type\nP\nCardinality\nResponse\nCodes\nDescription\nProSeAuthenticationCtx\nM\n1\n201 Created\nUpon success, when UE Id (i.e. SUCI) was received in the request,the response body will contain the EAP method selected, the corresponding EAP packet request and a \"link\" for the AMF to POST the EAP response.\nThe HTTP response shall include a \"Location\" header that contains the resource URI of the created resource.\nProSeAuthenticationResult\nM\n1\n200 OK\nUpon success, when CP-PRUK ID was received in the request, the response body will contain the KNR_ProSe and Nonce_2.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n400 Bad Request\nThis case represents the failure to start authentication service because of input parameter error.\nProblemDetails\nO\n0..1\n403 Forbidden\nThis case represents when the 5G ProSe Remote UE or the 5G ProSe End UE is not allowed to be authenticated.\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- AUTHENTICATION_REJECTED\n- INVALID_HN_PUBLIC_KEY_IDENTIFIER\n- INVALID_SCHEME_OUTPUT\nProblemDetails\nO\n0..1\n404 Not Found\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- USER_NOT_FOUND\nProblemDetails\nO\n0..1\n500 Internal Server Error\nThis case represents the failure in starting the authentication service because of a server internal error.\nIf the error is due to a problem with UDM not able to generate the requested AV, the AUSF shall indicate the following application error: \"AV_GENERATION_PROBLEM\"\nNOTE 1:\tThe mandatory HTTP error status codes for the POST method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4].\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4].\nTable 6.1.3.6.3.1-4: Headers supported by the 201 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nContains the URI of the newly created resource according to the structure: {apiRoot}/nausf-auth/<apiVersion>/prose-authentications/{authCtxId}\nTable 6.1.3.6.3.1-5: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.1.3.6.3.1-6: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500_clause_6.10.9.1",
        "table_6.1.3.6.3.1-1",
        "table_6.1.3.6.3.1-2",
        "table_6.1.3.6",
        "table_6.1.3.6.3.1-3",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.1.3.6.3.1-4",
        "table_6.1.3.6.3.1-5",
        "table_6.1.3.6.3.1-6",
        "ts_33.503",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.7.1",
      "section_id": "6.1.3.7.1",
      "section_title": "Description",
      "content": "The \"prose-auth\" is generated by the AUSF if an EAP-based authentication method is selected. This resource is used to handle the EAP session. This subresource should not persist after the EAP exchanges.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.1.3.7.2",
      "section_id": "6.1.3.7.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/nausf-auth/<apiVersion>/prose-authentications/{authCtxId}/prose-auth\nThis resource shall support the resource URI variables defined in table 6.1.3.7.2-1.\nTable 6.1.3.7.2-1: Resource URI variables for this resource\nName\nData type\nDefinition\napiRoot\nstring\nSee clause 6.1.1\nauthCtxId\nstring\nRepresents a specific prose-authentication per UE",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.1.1",
        "table_6.1.3.7.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.3.7.3",
      "section_id": "6.1.3.7.3",
      "section_title": "Resource Standard Methods",
      "content": "6.1.3.7.3.1\tPOST\nThis method shall support the URI query parameters specified in table 6.1.3.7.3.1-1.\nTable 6.1.3.7.3.1-1: URI query parameters supported by the POST method on this resource\nName\nData type\nP\nCardinality\nDescription\nn/a\nThis method shall support the request data structures specified in table 6.1.3.7.3.1-2 and the response data structures and response codes specified in table 6.1.3.7.3.1-3.\nTable 6.1.3.7.3.1-2: Data structures supported by the POST Request Body on this resource\nData type\nP\nCardinality\nDescription\nProSeEapSession\nM\n1\nContains the EAP packet response (see IETF RFC 3748 [18]) from the 5G ProSe Remote UE or the 5G ProSe End UE and transferred by the AMF\nTable 6.1.3.7.3.1-3: Data structures supported by the POST Response Body on this resource\nData type\nP\nCardinality\nResponse\nCodes\nDescription\nProSeEapSession\nM\n1\n200 OK\nDuring an EAP session, the body response shall contain the EAP packet Response and an hypermedia link.\nAt the end of the EAP session, the body response shall contain the EAP packet Success or Failure (see IETF RFC 3748 [18]) and the KNR_ProSe if the authentication is successful\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n400 Bad Request\nThis case represents an EAP session failure because of input parameter error.  This indicates that the AUSF was not able to continue the EAP session.\nProblemDetails\nO\n0..1\n500 Internal Server Error\nThis case represents an EAP session failure because of a server internal error.\nNOTE:\tThe mandatory HTTP error status codes for the POST method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4].\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4]\nTable 6.1.3.7.3.1-4: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nString\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nString\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.1.3.7.3.1-5: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\n6.1.3.7.3.2\tDELETE\nThis method shall support the URI query parameters specified in table 6.1.3.7y.3.2-1.\nTable 6.1.3.7.3.2-1: URI query parameters supported by the DELETE method on this resource\nName\nData type\nP\nCardinality\nDescription\nn/a\nThis method shall support the request data structures specified in table 6.1.3.7.3.2-2 and the response data structures and response codes specified in table 6.1.3.7.3.2-3.\nTable 6.1.3.7.3.2-2: Data structures supported by the DELETE Request Body on this resource\nData type\nP\nCardinality\nDescription\nn/a\nTable 6.1.3.7.3.2-3: Data structures supported by the DELETE Response Body on this resource\nData type\nP\nCardinality\nResponse\nCodes\nDescription\nn/a\n204 No Content\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nNOTE 1:\tThe mandatory HTTP error status codes for the DELETE method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4].\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4].\nTable 6.1.3.7.3.2-4: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.1.3.7.3.2-5: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500_clause_6.10.9.1",
        "table_6.1.3.7.3.1-1",
        "table_6.1.3.7.3.1-2",
        "table_6.1.3.7.3.1-3",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.1.3.7.3.1-4",
        "table_6.1.3.7.3.1-5",
        "table_6.1.3.7",
        "table_6.1.3.7.3.2-1",
        "table_6.1.3.7.3.2-2",
        "table_6.1.3.7.3.2-3",
        "ts_29.500_table_6.1.3.7.3.2-4",
        "table_6.1.3.7.3.2-5",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.4.1",
      "section_id": "6.1.4.1",
      "section_title": "Overview",
      "content": "There is no Custom Operation in the current version of this API.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.1.5.1",
      "section_id": "6.1.5.1",
      "section_title": "General",
      "content": "There is no use of notification in the current version of this API.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.1.6.1",
      "section_id": "6.1.6.1",
      "section_title": "General",
      "content": "This clause specifies the application data model supported by the API.\nTable 6.1.6.1-1 specifies the data types defined for the Nausf_UEAuthentication service based interface protocol.\nTable 6.1.6.1-1: Nausf_UEAuthentication specific Data Types\nData type\nClause defined\nDescription\nAuthenticationInfo\n6.1.6.2.2\nContains the UE id (i.e. SUCI or SUPI) and the Serving Network Name.\nUEAuthenticationCtx\n6.1.6.2.3\nContains the information related to the resource generated to handle the UE authentication. It contains at least the UE id, Serving Network, the Authentication Method and related EAP information or related 5G-AKA information.\n5gAuthData\n6.1.6.2.4\nContains 5G authentication related information.\nAv5gAka\n6.1.6.2.5\nContains Authentication Vector for method 5G AKA.\nConfirmationData\n6.1.6.2.6\nContains the \"RES*\" generated by the UE.\nEapSession\n6.1.6.2.7\nContains information related to the EAP session.\nConfirmationDataResponse\n6.1.6.2.8\nContains the result of the authentication.\nRgAuthenticationInfo\n6.1.6.2.9\nContains the UE id (i.e. SUCI) and the authenticated indication.\nRgAuthCtx\n6.1.6.2.10\nContains the UE id (i.e. SUPI) and the authentication indication.\nDeregistrationInfo\n6.1.6.2.11\nContains the UE id (i.e. SUPI).\nProSeAuthenticationInfo\n6.1.6.2.12\nContains the information related to the Prose authentication received from the 5G ProSe Remote UE or the 5G ProSe End UE.\nProSeAuthenticationCtx\n6.1.6.2.13\nContains the information related to the resource generated to handle the ProSe authentication.\nProSeEapSession\n6.1.6.2.14\nContains information related to the EAP session for the 5G ProSe Remote UE or the 5G ProSe End UE.\nProSeAuthData\n6.1.6.2.15\nContains ProSe authentication related information.\nProSeAuthenticationResult\n6.1.6.2.16\nProSe Authentication Result\nEapPayload\n6.1.6.3.2\nContains the EAP packets.\nResStar\n6.1.6.3.2\nContains the RES*.\nKseaf\n6.1.6.3.2\nContains the Kseaf.\nHxresStar\n6.1.6.3.2\nContains the HXRES*.\nSuci\n6.1.6.3.2\nContains the SUCI.\nKnrProSe\n6.1.6.3.2\nContains the KNR_ProSe.\nNonce1\n6.1.6.3.2\nContains the Nonce1.\nNonce2\n6.1.6.3.2\nContains the Nonce2.\nMsk\n6.1.6.3.2\nContains the Master Session Key.\nAuthType\n6.1.6.3.3\nIndicates the authentication method used.\nAuthResult\n6.1.6.3.4\nIndicates the result of the authentication.\nTable 6.1.6.1-2 specifies data types re-used by the Nausf_UEAuthentication service based interface protocol from other specifications, including a reference to their respective specifications and when needed, a short description of their use within the Nausf_UEAuthentication service based interface.\nTable 6.1.6.1-2: Nausf_UEAuthentication re-used Data Types\nData type\nReference\nComments\nResynchronizationInfo\n3GPP TS 29.503 [12]\nServingNetworkName\n3GPP TS 29.503 [12]\nAutn\n3GPP TS 29.503 [12]\nRand\n3GPP TS 29.503 [12]\nLinksValueSchema\n3GPP TS 29.571 [10]\n3GPP Hypermedia link\nProblemDetails\n3GPP TS 29.571 [10]\nCommon Data Type used in response bodies\nSupi\n3GPP TS 29.571 [10]\nUri\n3GPP TS 29.571 [10]\nSupiOrSuci\n3GPP TS 29.571 [10]\nPei\n3GPP TS 29.571 [10]\nTraceData\n3GPP TS 29.571 [10]\nNfGroupId\n3GPP TS 29.571 [10]\nCagId\n3GPP TS 29.571 [10]\nSupportedFeatures\n3GPP TS 29.571 [10]\nSupported Features\nServerAddressingInfo\n3GPP TS 29.571 [10]\nRelayServiceCode\n3GPP TS 29.571 [10]\n5GPrukId\n3GPP TS 29.571 [10]",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.1.6.1-1",
        "table_6.1.6.1-2",
        "ts_29.503",
        "ts_29.571"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.1",
      "section_id": "6.1.6.2.1",
      "section_title": "Introduction",
      "content": "The following clause defines the structures to be used in resource representations.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.2",
      "section_id": "6.1.6.2.2",
      "section_title": "Type: AuthenticationInfo",
      "content": "Table 6.1.6.2.2-1: Definition of type AuthenticationInfo\nAttribute name\nData type\nP\nCardinality\nDescription\nsupiOrSuci\nSupiOrSuci\nM\n1\nContains the SUPI or SUCI of the UE.\nservingNetworkName\nServingNetworkName\nM\n1\nContains the Serving Network Name.\nresynchronizationInfo\nResynchronizationInfo\nO\n0..1\nContains RAND and AUTS; see 3GPP 33.501 [8] clause 9.4.\npei\nPei\nO\n0..1\nPermanent Equipment Identifier\ntraceData\nTraceData\nO\n0..1\nContains TraceData provided by the UDM to the AMF\nudmGroupId\nNfGroupId\nO\n0..1\nIdentity of the UDM group serving the SUPI\nroutingIndicator\nString\nO\n0..1\nWhen present, it shall indicate the Routing Indicator of the UE.\nPattern: '^[0-9]{1,4}$'\ncellCagInfo\narray(CagId)\nO\n1..N\nCAGList of the CAG cell.\nn5gcInd\nboolean\nO\n0..1\nN5GC device indicator (see 3GPP TS 33.501 [8]) When present, this IE shall be set as follows:\n-\ttrue: authentication is for a N5GC device;\n-\tfalse (default): authentication is not for a N5GC device.\nSee NOTE\nsupportedFeatures\nSupportedFeatures\nC\n0..1\nThis IE shall be present if at least one  feature defined in clause 6.1.9 is supported.\npvsInfo\narray(ServerAddressingInfo)\nO\n1..N\nFQDN(s) and/or IP address(es) of the SNPN UE onboarding Provisioning Servers (PVS).\nnswoInd\nboolean\nO\n0..1\nNSWO Indicator (see 3GPP TS 33.501 [8])\nWhen present, this IE shall be set as follows:\n-\ttrue: Non-Seamless WLAN Offload is applied;\n-\tfalse (default): Non-Seamless WLAN Offload is not applied.\ndisasterRoamingInd\nboolean\nO\n0..1\nDisaster Roaming Indicator (see 3GPP TS 23.502 [3]).\nWhen present, this IE shall be set as follows:\n-\ttrue: Disaster Roaming service is applied;\n-\tfalse (default): Disaster Roaming service is not applied.\nonboardingInd\nboolean\nO\n0..1\nUE Onboarding Indicator for the authentication\nWhen present, this IE shall be set as follows:\n-\ttrue: authentication is for UE onboarding;\n-\tfalse (default): authentication is not for UE onboarding.\naun3Ind\nboolean\nO\n0..1\nAUN3 Indicator (see 3GPP TS 33.501 [8])\nWhen present, this IE shall be set as follows:\n-\ttrue: authentication is for an AUN3 device behind RG;-\tfalse (default): authentication is not for an AUN3 device behind RG.\nNOTE:\tThe attribute n5gcInd is used for EAP-TLS, which is described in the informative annex O of 3GPP TS 33.501 [8] and is not mandatory to support.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.4",
        "clause_6.1.9",
        "table_6.1.6.2.2-1",
        "ts_33.501",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.3",
      "section_id": "6.1.6.2.3",
      "section_title": "Type: UEAuthenticationCtx",
      "content": "Table 6.1.6.2.3-1: Definition of type UEAuthenticationCtx\nAttribute name\nData type\nP\nCardinality\nDescription\nauthType\nAuthType\nM\n1\nIndicates the authentication method used for this UE i.e. \"5G-AKA-Confirmation\", \"EAP-AKA'\"; \"EAP-TLS\" or \"EAP-TTLS\". See clause 6.1.6.3.3\n_links\nmap(LinksValueSchema)\nM\n1..N\nIf 5G-AKA has been selected, this IE shall contain a member whose name is set to \"5g-aka\" and the URI to perform the confirmation.\nIf an EAP-based method has been selected, this IE shall contain a member whose name is set to \"eap-session\" and the URI to perform the EAP session.\nSee NOTE\n5gAuthData\n5gAuthData\nM\n1\nContains either 5G-AKA or EAP related information.\nservingNetworkName\nServingNetworkName\nO\n0..1\nContains the Serving Network Name.\nNOTE: In the current version of this API, only one hypermedia link is provided",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.1.6.3.3",
        "table_6.1.6.2.3-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.4",
      "section_id": "6.1.6.2.4",
      "section_title": "Type: 5gAuthData",
      "content": "Table 6.1.6.2.4-1: Definition of type 5gAuthData as a list of mutually exclusive alternatives\nData type\nCardinality\nDescription\nAv5gAka\n1\nContains the 5G AV if 5G-AKA has been selected.\nEapPayload\n1\nContains the EAP packet request.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.6.2.4-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.5",
      "section_id": "6.1.6.2.5",
      "section_title": "Type: Av5gAka",
      "content": "Table 6.1.6.2.5-1: Definition of type Av5gAka\nAttribute name\nData type\nP\nCardinality\nDescription\nrand\nRand\nM\n1\nautn\nAutn\nM\n1\nhxresStar\nHxresStar\nM\n1",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.6.2.5-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.6",
      "section_id": "6.1.6.2.6",
      "section_title": "Type: ConfirmationData",
      "content": "Table 6.1.6.2.6-1: Definition of type ConfirmationData\nAttribute name\nData type\nP\nCardinality\nDescription\nresStar\nResStar\nM\n1\nContains the \"RES*\" provided by the UE to the AMF.\nIf no RES* has been provided by the UE the null value is conveyed to the AUSF.\nsupportedFeatures\nSupportedFeatures\nC\n0..1\nThis IE shall be present if at least one  feature defined in clause 6.1.9 is supported.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.1.9",
        "table_6.1.6.2.6-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.7",
      "section_id": "6.1.6.2.7",
      "section_title": "Type: EapSession",
      "content": "Table 6.1.6.2.7-1: Definition of type EapSession\nAttribute name\nData type\nP\nCardinality\nDescription\neapPayload\nEapPayload\nM\n1\nContains the EAP packet (see IETF RFC 3748 [18]).\nIf no EAP packet has been provided by the UE the null value is conveyed to the AUSF.\nkSeaf\nKseaf\nC\n0..1\nShall be absent for N5GC device authentication; otherwise:\nIf the authentication is successful and the consumer is an AMF, the Kseaf shall be included\n_links\nmap(LinksValueSchema)\nC\n1..N\nIf the EAP session requires another exchange e.g. for EAP-AKA' notification, this IE shall contain a member whose name is \"eap-session\" and the URI to continue the EAP session.\nSee NOTE.\nauthResult\nAuthResult\nC\n0..1\nIndicates the result of the authentication.\nsupi\nSupi\nC\n0..1\nIf the authentication is successful and if the AMF had provided a SUCI, this IE shall contain the SUPI of the UE.\nsupportedFeatures\nSupportedFeatures\nC\n0..1\nThis IE shall be present if at least one  feature defined in clause 6.1.9 is supported.\npvsInfo\narray(ServerAddressingInfo)\nO\n1..N\nFQDN(s) and/or IP address(es) of the SNPN UE onboarding Provisioning Servers (PVS).\nmsk\nMsk\nC\n0..1\nIf the authentication is successful and the consumer is an NSWOF as indicated by the NSWO indicator received within the AuthenticationInfo, the MSK shall be included (see 3GPP TS 33.501 [8] annex S)\nIf the authentication is successful and the MSK indicator is received from UDM, the MSK shall be included. (see clause 7B.7 of 3GPP TS 33.501 [8])\nNOTE: In the current version of this API, only 0 or 1 hypermedia link is provided.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.1.9",
        "ts_33.501_clause_7",
        "table_6.1.6.2.7-1",
        "ts_33.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.8",
      "section_id": "6.1.6.2.8",
      "section_title": "Type: ConfirmationDataResponse",
      "content": "Table 6.1.6.2.8-1: Definition of type ConfirmationDataResponse\nAttribute name\nData type\nP\nCardinality\nDescription\nauthResult\nAuthResult\nM\n1\nIndicates the result of the authentication\nsupi\nSupi\nC\n0..1\nIf the authentication is successful and if the AMF had provided a SUCI, this IE shall contain the SUPI of the UE\nkseaf\nKseaf\nC\n0..1\nContains the Kseaf if authentication is successful.\npvsInfo\narray(ServerAddressingInfo)\nO\n1..N\nFQDN(s) and/or IP address(es) of the SNPN UE onboarding Provisioning Servers (PVS).",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.6.2.8-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.9",
      "section_id": "6.1.6.2.9",
      "section_title": "Type: RgAuthenticationInfo",
      "content": "Table 6.1.6.2.9-1: Definition of type RgAuthenticationInfo\nAttribute name\nData type\nP\nCardinality\nDescription\nsuci\nSuci\nM\n1\nContains the SUCI of the FN-RG.\nauthenticatedInd\nboolean\nM\n1\nThis IE shall be set as follows:\n-\ttrue: authenticated by the W-AGF;\n-\tfalse (default): unauthenticated by the W-AGF.\nsupportedFeatures\nSupportedFeatures\nC\n0..1\nThis IE shall be present if at least one  feature defined in clause 6.1.9 is supported.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.1.9",
        "table_6.1.6.2.9-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.10",
      "section_id": "6.1.6.2.10",
      "section_title": "Type: RgAuthCtx",
      "content": "Table 6.1.6.2.10-1: Definition of type RgAuthCtx\nAttribute name\nData type\nP\nCardinality\nDescription\nauthResult\nAuthResult\nM\n1\nIndicates the result of the authentication\nsupi\nSupi\nC\n0..1\nIf the authentication is successful and if the AMF had provided a SUCI, this IE shall contain the SUPI of the UE.\nauthInd\nboolean\nC\n0..1\nWhen present, this IE shall be set as follows:\n-\ttrue: authentication is not required;\n-\tfalse (default): authentication is required.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.6.2.10-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.11",
      "section_id": "6.1.6.2.11",
      "section_title": "Type: DeregistrationInfo",
      "content": "Table 6.1.6.2.11-1: Definition of type DeregistrationInfo\nAttribute name\nData type\nP\nCardinality\nDescription\nsupi\nSupi\nM\n1\nContains the SUPI of the UE.\nsupportedFeatures\nSupportedFeatures\nC\n0..1\nThis IE shall be present if at least one  feature defined in clause 6.1.9 is supported.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.1.9",
        "table_6.1.6.2.11-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.12",
      "section_id": "6.1.6.2.12",
      "section_title": "Type: ProSeAuthenticationInfo",
      "content": "Table 6.1.6.2.12-1: Definition of type ProSeAuthenticationInfo\nAttribute name\nData type\nP\nCardinality\nDescription\nsupiOrSuci\nSupiOrSuci\nC\n0..1\nThis IE shall be present if received from 5G ProSe Remote UE or the 5G ProSe End UE.\nWhen received, this IE shall contain the  SUCI of the 5G ProSe Remote UE or the 5G ProSe End UE.\n5gPrukId\n5GPrukId\nC\n0..1\nThis IE shall be present if the CP-PRUK is received from 5G ProSe Remote UE or the 5G ProSe End UE.\nWhen present, this IE shall Indicate the CP-PRUK ID received from the 5G ProSe Remote UE or the 5G ProSe End UE.\nrelayServiceCode\nRelayServiceCode\nM\n1\nIndicates Relay Service Code. See 3GPP TS 29.571 [7] clause 5.4.2\nnonce1\nNonce1\nM\n1\nIndicates Nonce_1.\nservingNetworkName\nServingNetworkName\nM\n1\nServing network name of the UE-to-Network relay or the UE-to-UE relay\nsupportedFeatures\nSupportedFeatures\nC\n0..1\nThis IE shall be present if at least one  feature defined in clause 6.1.9 is supported.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.571_clause_5.4.2",
        "clause_6.1.9",
        "table_6.1.6.2.12-1",
        "ts_29.571"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.13",
      "section_id": "6.1.6.2.13",
      "section_title": "Type: ProSeAuthenticationCtx",
      "content": "Table 6.1.6.2.13-1: Definition of type ProSeAuthenticationCtx\nAttribute name\nData type\nP\nCardinality\nDescription\nauthType\nAuthType\nM\n1\nIndicates the authentication method used for this UE i.e. \"EAP-AKA\".\n_links\nmap(LinksValueSchema)\nM\n1..N\nThis IE shall contain a member whose name is set to \"prose-auth\" and the URI to perform the EAP session.\nSee NOTE\nproSeAuthData\nProSeAuthData\nM\n1\nContains ProSe Authentication related information\nsupportedFeatures\nSupportedFeatures\nC\n0..1\nThis IE shall be present if at least one  feature defined in clause 6.1.9 is supported.\nNOTE: In the current version of this API, only one hypermedia link is provided",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.1.9",
        "table_6.1.6.2.13-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.14",
      "section_id": "6.1.6.2.14",
      "section_title": "Type: ProSeEapSession",
      "content": "Table 6.1.6.2.14-1: Definition of type ProSeEapSession\nAttribute name\nData type\nP\nCardinality\nDescription\neapPayload\nEapPayload\nM\n1\nContains the EAP packet (see IETF RFC 3748 [18]).\nIf no EAP packet has been provided by the 5G ProSe Remote UE or the 5G ProSe End UE the null value is conveyed to the AUSF.\nknrProSe\nKnrProSe\nC\n0..1\nIf the authentication is successful and no EAP packet has been provided by the 5G ProSe Remote UE or the 5G ProSe End UE, the KNR_ProSe shall be included\n_links\nmap(LinksValueSchema)\nC\n1..N\nIf the EAP session requires another exchange e.g. for EAP-AKA' notification, this IE shall contain a member whose name is \"prose-auth\" and the URI to continue the EAP session.\nSee NOTE.\nauthResult\nAuthResult\nC\n0..1\nThis IE shall be present if no EAP packet has been provided by the 5G ProSe Remote UE or the 5G ProSe End UE.\nWhen present, this IE shall indicate the result of the authentication.\nnonce2\nNonce2\nC\n0..1\nIf the authentication is successful and no EAP packet has been provided by the 5G ProSe Remote UE or the 5G ProSe End UE, the Nonce_2 shall be included.\n5gPrukId\n5GPrukId\nC\n0..1\nThis IE shall be present if authentication is successful and no EAP packet has been provided by the 5G ProSe Remote UE or the 5G ProSe End UE.\nWhen present, this IE shall contain the CP-PRUK ID to the 5G ProSe Remote UE or the 5G ProSe End UE.\nsupportedFeatures\nSupportedFeatures\nC\n0..1\nThis IE shall be present if at least one  feature defined in clause 6.1.9 is supported.\nNOTE: In the current version of this API, only 0 or 1 hypermedia link is provided.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.1.9",
        "table_6.1.6.2.14-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.15",
      "section_id": "6.1.6.2.15",
      "section_title": "Type: ProSeAuthData",
      "content": "Table 6.1.6.2.15-1: Definition of type ProSeAuthData\nData type\nCardinality\nDescription\nEapPayload\n1\nContains the EAP packet request.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.6.2.15-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.2.16",
      "section_id": "6.1.6.2.16",
      "section_title": "Type: ProSeAuthenticationResult",
      "content": "Table 6.1.6.2.16-1: Definition of type ProSeAuthenticationResult\nAttribute name\nData type\nP\nCardinality\nDescription\nknrProSe\nKnrProSe\nC\n0..1\nIf the authentication is successful, the KNR_ProSe shall be included\nnonce2\nNonce2\nC\n0..1\nIf the authentication is successful, the Nonce_2 shall be included.\nsupportedFeatures\nSupportedFeatures\nC\n0..1\nThis IE shall be present if at least one  feature defined in clause 6.1.9 is supported.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.1.9",
        "table_6.1.6.2.16-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.3.1",
      "section_id": "6.1.6.3.1",
      "section_title": "Introduction",
      "content": "This clause defines simple data types and enumerations that can be referenced from data structures defined in the previous clauses.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.1.6.3.2",
      "section_id": "6.1.6.3.2",
      "section_title": "Simple data types",
      "content": "Table 6.1.6.3.2-1: Simple data types\nType Name\nType Definition\nDescription\nEapPayload\nstring\nThe EAP packet is encoded using base64 (see IETF RFC 4648 [19]) and represented as a String.\nFormat: byte\nResStar\nstring\npattern: \"^[A-Fa-f0-9]{32}$\"; nullable\nKseaf\nstring\npattern: \"^[A-Fa-f0-9]{64}$\"\nHxresStar\nstring\npattern: \"^[A-Fa-f0-9]{32}$\"\nSuci\nstring\nString containing a SUCI.\nPattern: \"^(suci-(0-[0-9]{3}-[0-9]{2,3}|[1-7]-.+)-[0-9]{1,4}-(0-0-.+|[a-fA-F1-9]-([1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])-[a-fA-F0-9]+)|.+)$\"\nKnrProSe\nstring\nString contain the KNR_ProSe\npattern: \"^[A-Fa-f0-9]{64}$\"\nNonce1\nstring\nThe Nonce1 is encoded using base64 (see IETF RFC 4648 [19]) and represented as a String.\nFormat: byte\nNonce2\nstring\nThe Nonce2 is encoded using base64 (see IETF RFC 4648 [19]) and represented as a String.\nFormat: byte\nMsk\nstring\npattern: \"^[A-Fa-f0-9]{128}$\"",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.6.3.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.3.3",
      "section_id": "6.1.6.3.3",
      "section_title": "Enumeration: AuthType",
      "content": "Table 6.1.6.3.3-1: Enumeration AuthType\nEnumeration value\nDescription\n5G_AKA\n5G AKA\nEAP_AKA_PRIME\nEAP-AKA'\nEAP_TLS\nEAP-TLS is only used in the case where the Annex B is supported.\nEAP_TTLS\nEAP-TTLS is used in the case where the Annex U of 3GPP TS 33.501 [8] is supported.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.6.3.3-1",
        "ts_33.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.3.4",
      "section_id": "6.1.6.3.4",
      "section_title": "Enumeration:\tAuthResult",
      "content": "Table 6.1.6.3.4-1: Enumeration AuthResult\nEnumeration value\nDescription\nAUTHENTICATION_SUCCESS\nThis value is used to indicate that the AUSF successfully authenticate the UE\nAUTHENTICATION_FAILURE\nThis value is used to indicate that the AUSF fails to authenticate the UE.\nAUTHENTICATION_ONGOING\nThis value is used during an EAP Session to indicate that the EAP session is still ongoing.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.6.3.4-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.3.5",
      "section_id": "6.1.6.3.5",
      "section_title": "Relation Types",
      "content": "6.1.6.3.5.1\tGeneral\nThis clause describes the possible relation types defined within AUSF API.\nTable 6.1.6.3.5-1: supported registered relation types\nRelation Name\n5g-aka\neap-session\n6.1.6.3.5.2\tThe \"5g-aka\" Link relation\nThe value \"5g-aka\" specifies that the value of the href attribute is the URI where NF Service Consumer shall send a PUT containing the result \"RES*\" received from the UE.\n6.1.6.3.5.3\tThe \"eap-session\" Link relation\nThe value \"eap-session\" specifies that the value of the href attribute is the URI that will be used  by the NF  Service Consumer to provide EAP packet response during an EAP exchange. The NF Service Consumer shall use a POST to provide the EAP Packet Response to the AUSF to the corresponding URI.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.6.3.5-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.6.4.1",
      "section_id": "6.1.6.4.1",
      "section_title": "Introduction",
      "content": "There is no binary data in the current version of this API.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.1.7.1",
      "section_id": "6.1.7.1",
      "section_title": "General",
      "content": "HTTP error handling shall be supported as specified in clause 5.2.4 of 3GPP TS 29.500 [4].\nThe Cause codes mapping performed by AMF between the following HTTP responses returned by the AUSF services to the AMF and the 5GMM related values is specified in clause 4.2.2 of 3GPP TS 29.524 [24].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.4",
        "ts_29.524_clause_4.2.2",
        "ts_29.500",
        "ts_29.524"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.7.2",
      "section_id": "6.1.7.2",
      "section_title": "Protocol Errors",
      "content": "Protocol errors shall be supported as specified in clause 5.2.7 of 3GPP TS 29.500 [4].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.7.3",
      "section_id": "6.1.7.3",
      "section_title": "Application Errors",
      "content": "The common application errors defined in the Table 5.2.7.2-1 in 3GPP TS 29.500 [4] may also be used for the Nausf_UEAuthentication service. The following application errors listed in Table 6.1.7.3-1 are specific for the Nausf_UEAuthentication service.\nTable 6.1.7.3-1: Application errors\nApplication Error\nHTTP status code\nDescription\nSERVING_NETWORK_NOT_AUTHORIZED\n403 Forbidden\nThe serving network is not authorized, e.g. serving PLMN.\nAUTHENTICATION_REJECTED\n403 Forbidden\nThe user cannot be authenticated with this authentication method e.g. only SIM data available\nINVALID_HN_PUBLIC_KEY_IDENTIFIER\n403 Forbidden\nInvalid HN public key identifier received\nINVALID_SCHEME_OUTPUT\n403 Forbidden\nSUCI cannot be decrypted with received data\nCONTEXT_NOT_FOUND\n404 Not Found\nThe AUSF cannot found the resource corresponding to the URI provided by the NF Service Consumer.\nUSER_NOT_FOUND\n404 Not Found\nThe user does not exist in the HPLMN\nUPSTREAM_SERVER_ERROR\n504 Gateway Timeout\nNo response is received from a remote peer, e.g. from the UDM\nNETWORK_FAILURE\n504 Gateway Timeout\nThe request is rejected due to a network problem.\nAV_GENERATION_PROBLEM\n500 Internal Server Error\nThe UDM has indicated that it was not able to generate AV.\nUNSUPPORTED_PROTECTION_SCHEME\n501 Not implemented\nThe received protection scheme is not supported by HPLMN",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.500_table_5.2.7.2-1",
        "table_6.1.7.3-1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.8",
      "section_id": "6.1.8",
      "section_title": "Security",
      "content": "As indicated in 3GPP TS 33.501 [8], the access to the Nausf_UEAuthentication Service API may be authorized by means of the Oauth2 protocol (see IETF RFC 6749 [13]), using the \"Client Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [14]) plays the role of the authorization server.\nIf OAuth2 is used, an NF Service Consumer, prior to consuming service offered by the Nausf_UEAuthentication Service API, shall obtain a \"token\" from the authorization server, by invoking the Access Token Request service, as described in 3GPP TS 29.510 [14], clause 5.4.2.2.\nNOTE:\tWhen multiple NRFs are deployed in a network, the NRF used as authorization server is the same NRF that the NF Service Consumer used for discovering the Nausf_UEAuthentication service.\nThe Nausf_UEAuthentication Service API defines the following scopes.\nTable 6.1.8-1: OAuth2 scopes defined in Nausf_UEAuthentication API\nScope\nDescription\n\"nausf-auth\"\nAccess to the Nausf_UEAuthentication API.\n\"nausf-auth:ue-authentications\"\nAccess to service operations applying to the collection of the ue-authentication resources and the subresources, i.e. 5g-aka-confirmation and eap-session.\n\"nausf-auth:rg-authentications\"\nAccess to service operations applying to the collection of the rg-authentication resources.\n\"nausf-auth:prose-authentications\"\nAccess to service operations applying to the collection of the prose-authentication resources and the subresources, i.e. prose-auth.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.510_clause_5.4.2.2",
        "table_6.1.8-1",
        "ts_33.501",
        "ts_29.510"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.9",
      "section_id": "6.1.9",
      "section_title": "Feature Negotiation",
      "content": "The features in table 6.1.9-1 are defined for the Nausf_UEAuthentication API. They shall be negotiated using the extensibility mechanism defined in clause 6.6 of 3GPP TS 29.500 [4].\nTable 6.1.9-1: Supported Features\nFeature number\nFeature Name\nM/O\nDescription\n1\nES3XX\nM\nExtended Support of HTTP 307/308 redirection\nAn NF Service Consumer (e.g. AMF) that supports this feature shall support handling of HTTP 307/308 redirection for any service operation of the UEAuthentication service. An NF Service Consumer that does not support this feature does only support HTTP redirection as specified for 3GPP Release 15.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_6.6",
        "table_6.1.9-1",
        "ts_29.500_table_6.1.9-1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.1.10",
      "section_id": "6.1.10",
      "section_title": "HTTP redirection",
      "content": "An HTTP request may be redirected to a different AUSF service instance, within the same AUSF or a different AUSF of an AUSF set, e.g. when an AUSF service instance is part of an AUSF (service) set or when using indirect communications (see 3GPP TS 29.500 [4]). See also the ES3XX feature in clause 6.1.10.\nAn SCP that reselects a different AUSF producer instance will return the NF Instance ID of the new AUSF producer instance in the 3gpp-Sbi-Producer-Id header, as specified in clause 6.10.3.4 of 3GPP TS 29.500 [4].\nIf an AUSF within an AUSF set redirects a service request to a different AUSF of the set using an 307 Temporary Redirect or 308 Permanent Redirect status code, the identity of the new AUSF towards which the service request is redirected shall be indicated in the 3gpp-Sbi-Target-Nf-Id header of the 307 Temporary Redirect or 308 Permanent Redirect response as specified in clause 6.10.9.1 of 3GPP TS 29.500 [4].",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.1.10",
        "ts_29.500_clause_6.10.3.4",
        "ts_29.500_clause_6.10.9.1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.1",
      "section_id": "6.2.1",
      "section_title": "API URI",
      "content": "URIs of this API shall have the following root:\n{apiRoot}/<apiName>/<apiVersion>\nThe request URIs used in HTTP requests from the NF service consumer towards the NF service producer shall have the Resource URI structure defined in clause 4.4.1 of 3GPP TS 29.501 [5], i.e.:\n{apiRoot}/<apiName>/<apiVersion>/<apiSpecificResourceUriPart>\nwith the following components:\n-\tThe {apiRoot} shall be set as described in 3GPP TS 29.501 [6].\n-\tThe <apiName> shall be \"nausf-sorprotection\".\n-\tThe <apiVersion> shall be \"v1\".\n-\tThe <apiSpecificResourceUriPart> shall be set as described in clause 6.2.3.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.501_clause_4.4.1",
        "clause_6.2.3",
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.2.1",
      "section_id": "6.2.2.1",
      "section_title": "General",
      "content": "HTTP/2, as defined in IETF RFC 9113 [6], shall be used as specified in clause 5 of 3GPP TS 29.500 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.2.2.1",
      "section_id": "6.2.2.2.1",
      "section_title": "General",
      "content": "The usage of HTTP standard headers is specified in clause 5.2.2 of 3GPP TS 29.500 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.2",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.2.2.2",
      "section_id": "6.2.2.2.2",
      "section_title": "Content type",
      "content": "The following content types shall be supported:\n-\tJSON, as defined in IETF RFC 8259 [7], shall be used as content type of the HTTP bodies specified in the present specification as indicated in clause 5.4 of 3GPP TS 29.500 [4].\n-\tThe Problem Details JSON Object (IETF RFC 9475 [11]. The use of the Problem Details JSON object in a HTTP response body shall be signalled by the content type \"application/problem+json\"",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.4",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.2.3.1",
      "section_id": "6.2.2.3.1",
      "section_title": "General",
      "content": "In this version of the API, no specific custom headers are defined for the \"Nausf_SoRProtection\" service.\nFor 3GPP specific HTTP custom headers used across all service based interfaces, see clause 5.2.3 of 3GPP TS 29.500 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.3",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.3.1",
      "section_id": "6.2.3.1",
      "section_title": "Overview",
      "content": "The structure of the Resource URIs of the Nausf_SoRProtection service is shown in Figure 6.2.3.1-1\nFigure 6.2.3.1-1: Resource URI structure of the SoRProtection API\nTable 6.2.3.1-1 provides an overview of the resources and applicable HTTP methods.\nTable 6.2.3.1-1: Resources and methods overview\nResource name\nResource URI\nHTTP method or custom operation\nDescription\nsupi\n(Custom operation)\n/{supi}/ue-sor/\nue-sor(POST)\nResource for SoR security material computation",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.2.3.1-1",
        "figure_6.2.3.1-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.3.2.1",
      "section_id": "6.2.3.2.1",
      "section_title": "Description",
      "content": "It is the resource to which the custom operation used to generate the SoR security material is associated with.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.2.3.2.2",
      "section_id": "6.2.3.2.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/nausf-sorprotection/<apiVersion>/{supi}/\nThis resource shall support the resource URI variables defined in table 6.2.3.2.2-1.\nTable 6.2.3.2.2-1: Resource URI variables for this resource\nName\nData type\nDefinition\napiRoot\nstring\nSee clause 6.2.1\nsupi\nSupi\nRepresents the Subscription Permanent Identifier (see 3GPP TS 23.501 [2] clause 5.9.2)\tpattern: See pattern of type Supi in 3GPP TS 29.571 [10]",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.2.1",
        "ts_23.501_clause_5.9.2",
        "table_6.2.3.2.2-1",
        "ts_23.501",
        "ts_29.571"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.3.2.3",
      "section_id": "6.2.3.2.3",
      "section_title": "Resource Standard Methods",
      "content": "No Standard Methods are supported for this resource.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.2.3.2.4",
      "section_id": "6.2.3.2.4",
      "section_title": "Resource Custom Operations",
      "content": "6.2.3.2.4.1\tOverview\nTable 6.2.3.2.4.1-1: Custom operations\nOperation Name\nCustom operation URI\nMapped HTTP method\nDescription\nue-sor\n/ue-sor\nPOST\nThe AUSF calculates the SoR-MAC-IAUSF and the CounterSoR to protect the Steering Information List provided. It may also calculate the SoR-XMAC-IUE to verify that the UE received the Steering Information List if the indication that an acknowledgement is requested from the UE.\n6.2.3.2.4.2\tOperation: ue-sor\n6.2.3.2.4.2.1\tDescription\nThis custom operation is used by the NF service consumer (e.g. UDM) to request the AUSF to compute the security material (SoR-MAC-IAUSF, CounterSoR and SoR-XMAC-IUE) needed to ensure the protection of the SoR procedure (see 3GPP TS 33.501 [8]).\n6.2.3.2.4.2.2\tOperation Definition\nThis method shall support the request data structures specified in table 6.2.3.2.4.2.2-1 and the response data structures and response codes specified in table 6.2.3.2.4.2.2-2.\nTable 6.2.3.2.4.2.2-1: Data structures supported by the POST Request Body on this resource\nData type\nP\nCardinality\nDescription\nSorInfo\nM\n1\nContains the Steering Information List and shall contain the indication of whether an acknowledgement is requested from the UE or not (as specified in 3GPP TS 33.501 [8]).\nTable 6.2.3.2.4.2.2-2: Data structures supported by the POST Response Body on this resource\nData type\nP\nCardinality\nResponse\ncodes\nDescription\nSorSecurityInfo\nM\n1\n200 OK\nUpon success, the response body will contain SoR-MAC-IAUSF and CounterSoR and may contain the SoR-XMAC-IUE.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n503 Service Unavailable\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- COUNTER_WRAP\nSee table 6.2.7.3-1 for the description of these errors.\nNOTE 1:\tThe mandatory HTTP error status codes for the POST method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4].\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4].\nTable 6.2.3.2.4.2.2-3: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.2.3.2.4.2.2-4: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500_clause_6.10.9.1",
        "table_6.2.3.2.4.1-1",
        "table_6.2.3.2.4.2.2-1",
        "table_6.2.3.2.4.2.2-2",
        "ts_33.501_table_6.2.3.2.4.2.2-2",
        "table_6.2.7.3-1",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.2.3.2.4.2.2-3",
        "table_6.2.3.2.4.2.2-4",
        "ts_33.501",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.4.1",
      "section_id": "6.2.4.1",
      "section_title": "Overview",
      "content": "There is no Custom Operation in the current version of this API.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.2.5.1",
      "section_id": "6.2.5.1",
      "section_title": "General",
      "content": "There is no use of notification in the current version of this API.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.2.6.1",
      "section_id": "6.2.6.1",
      "section_title": "General",
      "content": "This clause specifies the application data model supported by the API.\nTable 6.2.6.1-1 specifies the data types defined for the Nausf_SORProtection service based interface protocol.\nTable 6.2.6.1-1: Nausf_SORProtection specific Data Types\nData type\nClause defined\nDescription\nSorInfo\n6.2.6.2.2\nContains the Steering Information\nSorSecurityInfo\n6.2.6.2.3\nContains the material generated for securing of SoR. It contains at least the SoR-MAC-IAUSF and CounterSoR.\nSteeringInfo\n6.2.6.2.4\nContains a combination of one PLMN identity and zero or more access technologies.\nSteeringContainer\n6.2.6.2.5\nContains the information sent to UE.\nSorMac\n6.2.6.3.2\nMAC value for protecting SOR procedure (SoR-MAC-IAUSF and SoR-XMAC-IUE)\nCounterSor\n6.2.6.3.2\nCounterSoR\nAckInd\n6.2.6.3.2\nContains indication whether the acknowledgement from UE is needed\nSecuredPacket\n6.2.6.3.2\nContains a secure packet.\nAccessTech\n6.2.6.3.3\nAccess Technology\nSorHeader\n6.2.6.3.2\nContains the SoR Header.\nSorTransparentInfo\n6.2.6.3.2\nContains steering information encoded as transparent containers.\nTable 6.2.6.1-2 specifies data types re-used by the Nausf_SORProtection service based interface protocol from other specifications, including a reference to their respective specifications and when needed, a short description of their use within the Nausf_SORProtection service based interface.\nTable 6.2.6.1-2: Nausf_SORProtection re-used Data Types\nData type\nReference\nComments\nPlmnId\n3GPP TS 29.571 [10]\nPLMN ID\nSupportedFeatures\n3GPP TS 29.571 [10]\nSupported Features",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.2.6.1-1",
        "table_6.2.6.1-2",
        "ts_29.571"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.6.2.1",
      "section_id": "6.2.6.2.1",
      "section_title": "Introduction",
      "content": "The following clauses define the structures to be used in resource representations.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.2.6.2.2",
      "section_id": "6.2.6.2.2",
      "section_title": "Type: SorInfo",
      "content": "Table 6.2.6.2.2-1: Definition of type SorInfo\nAttribute name\nData type\nP\nCardinality\nDescription\nackInd\nAckInd\nM\n1\nContains the indication whether the acknowledgement from UE is needed.\nsteeringContainer\nSteeringContainer\nC\n0..1\nWhen present, this information contains the information needed to update the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the USIM.\nIt may contain an array of preferred PLMN/AccessTechnologies combinations in priority order. The first entry in the array indicates the highest priority and the last entry indicates the lowest.\nOr it may contain a secured packet.\nIf no change of the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the USIM is needed then this attribute shall be absent.\nsorHeader\nSorHeader\nO\n0..1\nThis attribute contains SoR Header encoded as defined in clause 6.2.6.3.2 and shall be present if AUSF supports receiving SoR Information encoded as transparent containers.\nsorTransparentInfo\nSorTransparentInfo\nO\n0..1\nThis attribute contains steering information encoded as defined in clause 6.2.6.3.2, and may be present if AUSF supports receiving SoR Information encoded as transparent containers.\nIt may be absent if no change of the \"Operator Controlled PLMN Selector with Access Technology\" list stored in the USIM is needed.\nsupportedFeatures\nSupportedFeatures\nC\n0..1\nThis IE shall be present if at least one  feature defined in clause 6.2.9 is supported.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.6.3.2",
        "clause_6.2.9",
        "table_6.2.6.2.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.6.2.3",
      "section_id": "6.2.6.2.3",
      "section_title": "Type: SorSecurityInfo",
      "content": "Table 6.2.6.2.3-1: Definition of type SorSecurityInfo\nAttribute name\nData type\nP\nCardinality\nDescription\nsorMacIausf\nSorMac\nM\n1\nContains the SoR-MAC-IAUSF.\ncounterSor\nCounterSor\nM\n1\nContains the CounterSoR.\nsorXmacIue\nSorMac\nO\n0..1\nWhen present, contains the SoR-XMAC-IUE. It shall be included, if the UDM requests the acknowledgement from the UE.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.2.6.2.3-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.6.2.4",
      "section_id": "6.2.6.2.4",
      "section_title": "Type: SteeringInfo",
      "content": "Table 6.2.6.2.4-1: Definition of type SteeringInfo\nAttribute name\nData type\nP\nCardinality\nDescription\nplmnId\nPlmnId\nM\n1\nContains a preferred PLMN identity.\naccessTechList\narray(AccessTech)\nC\n1..N\nWhen present it contains the referred access technologies as listed in clause 4.2.5 of 3GPP TS 31.102 [15]. If absent it means that all access technologies are equivalently preferred in this PLMN.",
      "chunk_type": "general",
      "cross_references": [
        "ts_31.102_clause_4.2.5",
        "table_6.2.6.2.4-1",
        "ts_31.102"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.6.2.5",
      "section_id": "6.2.6.2.5",
      "section_title": "Type: SteeringContainer",
      "content": "Table 6.2.6.2.5.-1: Definition of type SteeringContainer as a list of mutually exclusive alternatives\nData type\nCardinality\nDescription\narray(SteeringInfo)\n1..N\nList of PLMN/AccessTechnologies combinations.\nSecuredPacket\n1\nA secured packet containing one or more APDUs commands dedicated to Remote File Management.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.2.6.2.5"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.6.3.1",
      "section_id": "6.2.6.3.1",
      "section_title": "Introduction",
      "content": "This clause defines simple data types and enumerations that can be referenced from data structures defined in the previous clauses.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.2.6.3.2",
      "section_id": "6.2.6.3.2",
      "section_title": "Simple data types",
      "content": "Table 6.2.6.3.2-1: Simple data types\nType Name\nType Definition\nDescription\nSorMac\nstring\npattern: \"^[A-Fa-f0-9]{32}$\"\nCounterSor\nstring\npattern: \"^[A-Fa-f0-9]{4}$\"\nAckInd\nboolean\ntrue indicates that the SoR-XMAC-IUE shall be computed and returned in the response\nSecuredPacket\nstring\nContains a secure packet as specified in 3GPP TS 24.501 [20]. It is encoded using base64 and represented as a String.\nFormat: byte\nSorHeader\nBytes\nString with format \"byte\" as defined in OpenAPI Specification [25], i.e. base64-encoded characters, encoding the \"SOR Header\" IE as specified in clause 9.11.3.51 of 3GPP TS 24.501 [20] (octet 4).\nSorTransparentInfo\nBytes\nString with format \"byte\" as defined in OpenAPI Specification [25], i.e. base64-encoded characters, encoding the \"SOR transparent container\" IE as specified in clause 9.11.3.51 of 3GPP TS 24.501 [20] (starting from octet 23).",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.501_clause_9.11.3.51",
        "table_6.2.6.3.2-1",
        "ts_24.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.6.3.3",
      "section_id": "6.2.6.3.3",
      "section_title": "Enumeration: AccessTech",
      "content": "Table 6.2.6.3.3-1: Enumeration AccessTech\nEnumeration value\nDescription\n\"NR\"\n\"EUTRAN_IN_WBS1_MODE_AND_NBS1_MODE\"\n\"EUTRAN_IN_NBS1_MODE_ONLY\"\n\"EUTRAN_IN_WBS1_MODE_ONLY\"\n\"UTRAN\"\n\"GSM_AND_ECGSM_IoT\"\n\"GSM_WITHOUT_ECGSM_IoT\"\n\"ECGSM_IoT_ONLY\"\n\"CDMA_1xRTT\"\n\"CDMA_HRPD\"\n\"GSM_COMPACT\"\nNOTE:\tSome of the values in the enumeration deviate from the naming conventions indicated in 3GPP TS 29.501 [5] Clause 5.1.4 (i.e., to use UPPER_WITH_UNDERSCORE); however, it is kept as currently defined in this specification to maintain backwards compatibility.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.501_clause_5.1.4",
        "table_6.2.6.3.3-1",
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.7.1",
      "section_id": "6.2.7.1",
      "section_title": "General",
      "content": "HTTP error handling shall be supported as specified in clause 5.2.4 of 3GPP TS 29.500 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.4",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.7.2",
      "section_id": "6.2.7.2",
      "section_title": "Protocol Errors",
      "content": "Protocol Error Handling shall be supported as specified in clause 5.2.7.2 of 3GPP TS 29.500 [4].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.7.2",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.7.3",
      "section_id": "6.2.7.3",
      "section_title": "Application Errors",
      "content": "The common application errors defined in the Table 5.2.7.2-1 in 3GPP TS 29.500 [4] may also be used for the Nausf_SoRProtection service. The following application errors listed in Table 6.2.7.3-1 are specific for the Nausf_SoRProtection service.\nTable 6.2.7.3-1: Application errors\nApplication Error\nHTTP status code\nDescription\nCOUNTER_WRAP\n503 Service Unavailable\nThe CounterSoR associated with the KAUSF of the UE is about to wrap around. The AUSF suspends the SoR protection service for the UE until a new KAUSF is generated.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.500_table_5.2.7.2-1",
        "table_6.2.7.3-1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.8",
      "section_id": "6.2.8",
      "section_title": "Security",
      "content": "As indicated in 3GPP TS 33.501 [8], the access to the Nausf_SoRProtection API may be authorized by means of the OAuth2 protocol (see IETF RFC 6749 [13]), using the \"Client Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [14]) plays the role of the authorization server.\nIf OAuth2 is used, an NF Service Consumer, prior to consuming services offered by the Nausf_SoRProtection API, shall obtain a \"token\" from the authorization server, by invoking the Access Token Request service, as described in 3GPP TS 29.510 [14], clause 5.4.2.2.\nNOTE:\tWhen multiple NRFs are deployed in a network, the NRF used as authorization server is the same NRF that the NF Service Consumer used for discovering the Nausf_SoRProtection service.\nThe Nausf_SoRProtection Service API defines a single scope nausf-sorprotection (as specified in 3GPP TS 33.501 [8]), and it does not define any additional scopes at resource or operation level.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.510_clause_5.4.2.2",
        "ts_33.501",
        "ts_29.510"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.9",
      "section_id": "6.2.9",
      "section_title": "Feature Negotiation",
      "content": "The features in table 6.2.9-1 are defined for the Nausf_SoRProtection API. They shall be negotiated using the extensibility mechanism defined in clause 6.6 of 3GPP TS 29.500 [4].\nTable 6.2.9-1: Supported Features\nFeature number\nFeature Name\nM/O\nDescription\n1\nES3XX\nM\nExtended Support of HTTP 307/308 redirection\nAn NF Service Consumer (e.g. UDM) that supports this feature shall support handling of HTTP 307/308 redirection for any service operation of the SoRProtection service. An NF Service Consumer that does not support this feature does only support HTTP redirection as specified for 3GPP Release 15.\n2\nsorTransparentSupport\nO\nThis flag is used by AUSF to register (in NRF) its support of receiving SoR Transparent Information instead of individual IEs from UDM.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_6.6",
        "table_6.2.9-1",
        "ts_29.500_table_6.2.9-1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.2.10",
      "section_id": "6.2.10",
      "section_title": "HTTP redirection",
      "content": "An HTTP request may be redirected to a different AUSF service instance, within the same AUSF or a different AUSF of an AUSF set, e.g. when an AUSF service instance is part of an AUSF (service) set or when using indirect communications (see 3GPP TS 29.500 [4]). See also the ES3XX feature in clause 6.2.9.\nAn SCP that reselects a different AUSF producer instance will return the NF Instance ID of the new AUSF producer instance in the 3gpp-Sbi-Producer-Id header, as specified in clause 6.10.3.4 of 3GPP TS 29.500 [4].\nIf an AUSF within an AUSF set redirects a service request to a different AUSF of the set using an 307 Temporary Redirect or 308 Permanent Redirect status code, the identity of the new AUSF towards which the service request is redirected shall be indicated in the 3gpp-Sbi-Target-Nf-Id header of the 307 Temporary Redirect or 308 Permanent Redirect response as specified in clause 6.10.9.1 of 3GPP TS 29.500 [4].",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.9",
        "ts_29.500_clause_6.10.3.4",
        "ts_29.500_clause_6.10.9.1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.1",
      "section_id": "6.3.1",
      "section_title": "API URI",
      "content": "URIs of this API shall have the following root:\n{apiRoot}/{apiName}/<apiVersion>\nThe request URIs used in HTTP requests from the NF service consumer towards the NF service producer shall have the Resource URI structure defined in clause 4.4.1 of 3GPP TS 29.501 [5], i.e.:\n{apiRoot}/<apiName>/<apiVersion>/<apiSpecificResourceUriPart>\nwith the following components:\n-\tThe {apiRoot} shall be set as described in 3GPP TS 29.501 [6].\n-\tThe <apiName> shall be \"nausf-upuprotection\".\n-\tThe <apiVersion> shall be \"v1\".\n-\tThe <apiSpecificResourceUriPart> shall be set as described in clause 6.3.3.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.501_clause_4.4.1",
        "clause_6.3.3",
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.2.1",
      "section_id": "6.3.2.1",
      "section_title": "General",
      "content": "HTTP/2, as defined in IETF RFC 7540 [6], shall be used as specified in clause 5 of 3GPP TS 29.500 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.2.2.1",
      "section_id": "6.3.2.2.1",
      "section_title": "General",
      "content": "The usage of HTTP standard headers is specified in clause 5.2.2 of 3GPP TS 29.500 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.2",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.2.2.2",
      "section_id": "6.3.2.2.2",
      "section_title": "Content type",
      "content": "The following content types shall be supported:\n-\tJSON, as defined in IETF RFC 8259 [7], shall be used as content type of the HTTP bodies specified in the present specification as indicated in clause 5.4 of 3GPP TS 29.500 [4].\n-\tThe Problem Details JSON Object (IETF RFC 9457 [11]. The use of the Problem Details JSON object in a HTTP response body shall be signalled by the content type \"application/problem+json\"",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.4",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.2.3.1",
      "section_id": "6.3.2.3.1",
      "section_title": "General",
      "content": "In this version of the API, no specific custom headers are defined for the \"Nausf_UPUProtection\" service.\nFor 3GPP specific HTTP custom headers used across all service based interfaces, see clause 5.2.3 of 3GPP TS 29.500 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.3",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.3.1",
      "section_id": "6.3.3.1",
      "section_title": "Overview",
      "content": "The structure of the Resource URIs of the Nausf_UPUProtection service is shown in Figure 6.3.3.1-1\nFigure 6.3.3.1-1: Resource URI structure of the UPUProtection API\nTable 6.3.3.1-1 provides an overview of the resources and applicable HTTP methods.\nTable 6.3.3.1-1: Resources and methods overview\nResource name\nResource URI\nHTTP method or custom operation\nDescription\nsupi\n(Custom operation)\n/{supi}/ue-upu/\nue-upu (POST)\nResource for UPU security material computation",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.3.3.1-1",
        "figure_6.3.3.1-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.3.2.1",
      "section_id": "6.3.3.2.1",
      "section_title": "Description",
      "content": "It is the resource to which the custom operation used to generate the UPU security material is associated with.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.3.3.2.2",
      "section_id": "6.3.3.2.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/nausf-upuprotection/<apiVersion>/{supi}/\nThis resource shall support the resource URI variables defined in table 6.3.3.2.2-1.\nTable 6.3.3.2.2-1: Resource URI variables for this resource\nName\nData type\nDefinition\napiRoot\nstring\nSee clause 6.3.1\nsupi\nSupi\nRepresents the Subscription Permanent Identifier (see 3GPP TS 23.501 [2] clause 5.9.2)\tpattern: See pattern of type Supi in 3GPP TS 29.571 [10]",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.3.1",
        "ts_23.501_clause_5.9.2",
        "table_6.3.3.2.2-1",
        "ts_23.501",
        "ts_29.571"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.3.2.3",
      "section_id": "6.3.3.2.3",
      "section_title": "Resource Standard Methods",
      "content": "No Standard Methods are supported for this resource.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.3.3.2.4",
      "section_id": "6.3.3.2.4",
      "section_title": "Resource Custom Operations",
      "content": "6.3.3.2.4.1\tOverview\nTable 6.3.3.2.4.1-1: Custom operations\nOperation Name\nCustom operation URI\nMapped HTTP method\nDescription\nue-upu\n/ue-upu\nPOST\nThe AUSF calculates the UPU-MAC-IAUSF and the CounterUPU to protect the UE Parameters Update Data provided. It may also calculate the UPU-XMAC-IUE to verify that the UE received the UE Parameters Update Data if the indication that an acknowledgement is requested from the UE is provided.\n6.3.3.2.4.2\tOperation: ue-upu\n6.3.3.2.4.2.1\tDescription\nThis custom operation is used by the NF service consumer (e.g. UDM) to request the AUSF to compute the security material (UPU-MAC-IAUSF, CounterUPU and UPU-XMAC-IUE) needed to ensure the protection of the UPU procedure (see 3GPP TS 33.501 [8]).\n6.3.3.2.4.2.2\tOperation Definition\nThis method shall support the request data structures specified in table 6.3.3.2.4.2.2-1 and the response data structures and response codes specified in table 6.3.3.2.4.2.2-2.\nTable 6.3.3.2.4.2.2-1: Data structures supported by the POST Request Body on this resource\nData type\nP\nCardinality\nDescription\nUpuInfo\nM\n1\nContains the UE Parameters Update Data and shall contain the indication of whether an acknowledgement is requested from the UE or not (as specified in 3GPP TS 33.501 [8]).\nTable 6.3.3.2.4.2.2-2: Data structures supported by the POST Response Body on this resource\nData type\nP\nCardinality\nResponse\ncodes\nDescription\nUpuSecurityInfo\nM\n1\n200 OK\nUpon success, the response body will contain UPU-MAC-IAUSF and CounterUPU and may contain the UPU-XMAC-IUE.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n503 Service Unavailable\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- COUNTER_WRAP\nSee table 6.3.7.3-1 for the description of these errors.\nNOTE 1:\tThe mandatory HTTP error status codes for the POST method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [4] other than those specified in the table above also apply, with a ProblemDetails data type (see clause 5.2.7 of 3GPP TS 29.500 [4]).\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4].\nTable 6.3.3.2.4.2.2-3: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected\nTable 6.3.3.2.4.2.2-4: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same AUSF or AUSF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target NF (service) instance ID towards which the request is redirected",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500_clause_6.10.9.1",
        "table_6.3.3.2.4.1-1",
        "table_6.3.3.2.4.2.2-1",
        "table_6.3.3.2.4.2.2-2",
        "ts_33.501_table_6.3.3.2.4.2.2-2",
        "table_6.3.7.3-1",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.3.3.2.4.2.2-3",
        "table_6.3.3.2.4.2.2-4",
        "ts_33.501",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.4.1",
      "section_id": "6.3.4.1",
      "section_title": "Overview",
      "content": "There is no Custom Operation in the current version of this API.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.3.5.1",
      "section_id": "6.3.5.1",
      "section_title": "General",
      "content": "There is no use of notification in the current version of this API.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.3.6.1",
      "section_id": "6.3.6.1",
      "section_title": "General",
      "content": "This clause specifies the application data model supported by the API.\nTable 6.3.6.1-1 specifies the data types defined for the Nausf_UPUProtection service based interface protocol.\nTable 6.3.6.1-1: Nausf_UPUProtection specific Data Types\nData type\nClause defined\nDescription\nUpuInfo\n6.3.6.2.2\nContains the UE parameters update Information\nUpuSecurityInfo\n6.3.6.2.3\nContains the material generated for securing of UPU. It contains at least the UPU-MAC-IAUSF and CounterUPU.\nUpuData\n6.3.6.2.4\nContains UE parameters update data set (e.g., the updated Routing ID Data or the Default configured NSSAI).\nUpuMac\n6.3.6.3.2\nMAC value for protecting UPU procedure (UPU-MAC-IAUSF and UPU-MAC-IUE)\nCounterUpu\n6.3.6.3.2\nCounterUPU\nUpuAckInd\n6.3.6.3.2\nContains the indication of whether the acknowledgement from UE is needed\nUpuHeader\n6.3.6.3.2\nContains the \"UPU Header\" IE as specified in clause 9.11.3.53A of 3GPP TS 24.501 [20] (octet 4),\nUpuTransparentInfo\n6.3.6.3.2\nContains UPU information encoded as transparent container.\nTable 6.3.6.1-2 specifies data types re-used by the Nausf_UPUProtection service based interface protocol from other specifications and from other service APIs in current specification, including a reference to the respective specifications and when needed, a short description of their use within the Nausf_UPUProtection service based interface.\nTable 6.3.6.1-2: Nausf_UPUProtection re-used Data Types\nData type\nReference\nComments\nSnssai\n3GPP TS 29.571 [10]\nDefault configured NSSAI\nSecuredPacket\n6.2.6.3.2\nDefined in Nausf_SORProtection API.\nSecured Packet\nRoutingId\n3GPP TS 29.544 [22]\nRouting ID\nSupportedFeatures\n3GPP TS 29.571 [10]\nSupported Features",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.501_clause_9.11.3.53",
        "table_6.3.6.1-1",
        "table_6.3.6.1-2",
        "ts_24.501",
        "ts_29.571",
        "ts_29.544"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.6.2.1",
      "section_id": "6.3.6.2.1",
      "section_title": "Introduction",
      "content": "The following clauses define the structures to be used in resource representations.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.3.6.2.2",
      "section_id": "6.3.6.2.2",
      "section_title": "Type: UpuInfo",
      "content": "Table 6.3.6.2.2-1: Definition of type UpuInfo\nAttribute name\nData type\nP\nCardinality\nDescription\nApplicability\nupuDataList\narray(UpuData)\nM\n1..N\nThis information defines the UE Parameters Update (UPU). A secured packed with the Routing indicator update data and/or the Default configured NSSAI update data are included. See clause 6.3.6.2.4.\nThis attribute shall be ignored by AUSF when upuTransparentInfo is present.\nupuHeader\nUpuHeader\nO\n0..1\nThis attribute contains UPU Header encoded as defined in clause 6.3.6.3.2.\nupuAckInd\nUpuAckInd\nM\n1\nContains the indication of whether the acknowledgement from UE is needed.\nsupportedFeatures\nSupportedFeatures\nC\n0..1\nThis IE shall be present if at least one  feature defined in clause 6.3.9 is supported.\nupuTransparentInfo\nUpuTransparentInfo\nO\n0..1\nThis attribute contains UPU information encoded as defined in clause 6.3.6.3.2, and may be present if AUSF supports receiving UPU Information encoded as transparent container.\nupuTransparentSupport",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.3.6.2.4",
        "clause_6.3.6.3.2",
        "clause_6.3.9",
        "table_6.3.6.2.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.6.2.3",
      "section_id": "6.3.6.2.3",
      "section_title": "Type: UpuSecurityInfo",
      "content": "Table 6.3.6.2.3-1: Definition of type UpuSecurityInfo\nAttribute name\nData type\nP\nCardinality\nDescription\nupuMacIausf\nUpuMac\nM\n1\nContains the UPU-MAC-IAUSF.\ncounterUpu\nCounterUpu\nM\n1\nContains the CounterUPU.\nupuXmacIue\nUpuMac\nO\n0..1\nWhen present, contains the UPU-XMAC-IUE. It shall be included, if the UDM requests the acknowledgement from the UE.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.3.6.2.3-1"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.6.2.4",
      "section_id": "6.3.6.2.4",
      "section_title": "Type: UpuData",
      "content": "Table 6.3.6.2.4-1: Definition of type UpuData\nAttribute name\nData type\nP\nCardinality\nDescription\nsecPacket\nSecuredPacket\nC\n0..1\nPresents if the Routing indicator update data is required to be updated, and contains a secured packet with the Routing indicator to be updated.\ndefaultConfNssai\narray(Snssai)\nC\n1..N\nPresents if the Default configured NSSAI is required to be updated, and contains the Default configured NSSAI to be updated.\nRoutingId\nRoutingId\nC\n0..1\nMay be present when sent from UDR to UDM. The UDM shall make use of Nspaf services (see 3GPP TS 29.544 [22] to encapsulate the routing id in a secured packet which is then conveyed to the AUSF and AMF.\ndrei\nboolean\nC\n0..1\nDisaster Roaming Enabled Indication (DREI).\nMay be present when sent from UDR to UDM.\n- false: Disaster roaming is disabled in the UE\n- true: Disaster roaming is enabled in the UE\naol\nboolean\nC\n0..1\nIndication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN'.\nMay be present when sent from UDR to UDM.\n- false: the list of PLMNs provided by the VPLMN is not applicable\n- true: the list of PLMNs provided by the VPLMN is applicable\ndisasterCondPlmnIds\narray(PlmnId)\nC\n1..N\nList of PLMN Ids identifying PLMNs allowed to be used in Disaster Conditions.\nMay be present when sent from UDR to UDM.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.3.6.2.4-1",
        "ts_29.544"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.6.3.1",
      "section_id": "6.3.6.3.1",
      "section_title": "Introduction",
      "content": "This clause defines simple data types and enumerations that can be referenced from data structures defined in the previous clauses.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.509_6.3.6.3.2",
      "section_id": "6.3.6.3.2",
      "section_title": "Simple data types",
      "content": "Table 6.3.6.3.2-1: Simple data types\nType Name\nType Definition\nDescription\nUpuMac\nstring\npattern: \"^[A-Fa-f0-9]{32}$\"\nCounterUpu\nstring\npattern: \"^[A-Fa-f0-9]{4}$\"\nUpuAckInd\nboolean\ntrue indicates that the UPU-XMAC-IUE shall be computed and returned in the response\nUpuHeader\nstring\nIt contains the \"UPU Header\" IE as specified in clause 9.11.3.53A of 3GPP TS 24.501 [20] (octet 4), encoded as 2 hexadecimal characters.\nPattern: \"^[A-Fa-f0-9]{2}$\"\nUpuTransparentInfo\nBytes\nString with format \"byte\" as defined in OpenAPI Specification [25], i.e. base64-encoded characters, encoding the \"UPU transparent container\" IE as specified in clause 9.11.3.53A of 3GPP TS 24.501 [20] (starting from octet 23).",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.501_clause_9.11.3.53",
        "table_6.3.6.3.2-1",
        "ts_24.501"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.7.1",
      "section_id": "6.3.7.1",
      "section_title": "General",
      "content": "HTTP error handling shall be supported as specified in clause 5.2.4 of 3GPP TS 29.500 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.4",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.7.2",
      "section_id": "6.3.7.2",
      "section_title": "Protocol Errors",
      "content": "Protocol Error Handling shall be supported as specified in clause 5.2.7.2 of 3GPP TS 29.500 [4].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.7.2",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.7.3",
      "section_id": "6.3.7.3",
      "section_title": "Application Errors",
      "content": "The common application errors defined in the Table 5.2.7.2-1 in 3GPP TS 29.500 [4] may also be used for the Nausf_UPUProtection service. The following application errors listed in Table 6.3.7.3-1 are specific for the Nausf_UPUProtection service.\nTable 6.3.7.3-1: Application errors\nApplication Error\nHTTP status code\nDescription\nCOUNTER_WRAP\n503 Service Unavailable\nThe CounterUPU associated with the KAUSF of the UE is about to wrap around. The AUSF suspends the UPU protection service for the UE until a new KAUSF is generated.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.500_table_5.2.7.2-1",
        "table_6.3.7.3-1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.8",
      "section_id": "6.3.8",
      "section_title": "Security",
      "content": "As indicated in 3GPP TS 33.501 [8], the access to the Nausf_UPUProtection API may be authorized by means of the Oauth2 protocol (see IETF RFC 6749 [13]), using the \"Client Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [14]) plays the role of the authorization server.\nIf Oauth2 is used, an NF Service Consumer, prior to consuming services offered by the Nausf_UPUProtection API, shall obtain a \"token\" from the authorization server, by invoking the Access Token Request service, as described in 3GPP TS 29.510 [14], clause 5.4.2.2.\nNOTE:\tWhen multiple NRFs are deployed in a network, the NRF used as authorization server is the same NRF that the NF Service Consumer used for discovering the Nausf_UPUProtection service.\nThe Nausf_UPUProtection Service API does not define any scopes for Oauth2 authorization as specified in 3GPP TS 33.501 [8]; it defines a single scope consisting on the name of the service (i.e., \"nausf-upuprotection\"), and it does not define any additional scopes at resource or operation level.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.510_clause_5.4.2.2",
        "ts_33.501",
        "ts_29.510"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.9",
      "section_id": "6.3.9",
      "section_title": "Feature Negotiation",
      "content": "The features in table 6.3.9-1 are defined for the Nausf_UPUProtection API. They shall be negotiated using the extensibility mechanism defined in clause 6.6 of 3GPP TS 29.500 [4].\nTable 6.3.9-1: Supported Features\nFeature number\nFeature Name\nM/O\nDescription\n1\nES3XX\nM\nExtended Support of HTTP 307/308 redirection\nAn NF Service Consumer (e.g. UDM) that supports this feature shall support handling of HTTP 307/308 redirection for any service operation of the UPUProtection service. An NF Service Consumer that does not support this feature does only support HTTP redirection as specified for 3GPP Release 15.\n2\nupuTransparentSupport\nO\nThis flag is used by AUSF to register (in NRF) its support of receiving UPU Transparent Information instead of individual Ies from UDM",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_6.6",
        "table_6.3.9-1",
        "ts_29.500_table_6.3.9-1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.509_6.3.10",
      "section_id": "6.3.10",
      "section_title": "HTTP redirection",
      "content": "An HTTP request may be redirected to a different AUSF service instance, within the same AUSF or a different AUSF of an AUSF set, e.g. when an AUSF service instance is part of an AUSF (service) set or when using indirect communications (see 3GPP TS 29.500 [4]). See also the ES3XX feature in clause 6.3.9.\nAn SCP that reselects a different AUSF producer instance will return the NF Instance ID of the new AUSF producer instance in the 3gpp-Sbi-Producer-Id header, as specified in clause 6.10.3.4 of 3GPP TS 29.500 [4].\nIf an AUSF within an AUSF set redirects a service request to a different AUSF of the set using an 307 Temporary Redirect or 308 Permanent Redirect status code, the identity of the new AUSF towards which the service request is redirected shall be indicated in the 3gpp-Sbi-Target-Nf-Id header of the 307 Temporary Redirect or 308 Permanent Redirect response as specified in clause 6.10.9.1 of 3GPP TS 29.500 [4].\nAnnex A (normative):OpenAPI specification\nA.1\tGeneral\nThis Annex specifies the formal definition of the Nausf Service API(s). It consists of OpenAPI 3.0.0 specifications in YAML format.\nNOTE 1:\tOpenAPI 3.0 does not support description of API using HATEOAS. Indeed, only relative paths can be used and as a consequence the URI provided in the \"href\" cannot be reused as it is.\nThis Annex takes precedence when being discrepant to other parts of the specification with respect to the encoding of information elements and methods within the API(s).\nNOTE 2:\tThe semantics and procedures, as well as conditions, e.g. for the applicability and allowed combinations of attributes or values, not expressed in the OpenAPI definitions but defined in other parts of the specification also apply.\nInformative copies of the OpenAPI specification files contained in this 3GPP Technical Specification are available on a Git-based repository that uses the GitLab software version control system (see 3GPP TS 29.501 [5] clause 5.3.1 and 3GPP TR 21.900 [21] clause 5B).\nA.2\tNausf_UEAuthentication API\nopenapi: 3.0.0\ninfo:\nversion: 1.3.0\ntitle: AUSF API\ndescription: |\nAUSF UE Authentication Service.\n© 2024, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC).\nAll rights reserved.\nexternalDocs:\ndescription: 3GPP TS 29.509 V18.5.0; 5G System; 3GPP TS Authentication Server services.\nurl: 'https://www.3gpp.org/ftp/Specs/archive/29_series/29.509'\nservers:\n- url: '{apiRoot}/nausf-auth/v1'\nvariables:\napiRoot:\ndefault: https://example.com\ndescription: apiRoot as defined in clause 4.4 of 3GPP TS 29.501.\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-auth\npaths:\n/ue-authentications:\npost:\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-auth\n- oAuth2ClientCredentials:\n- nausf-auth\n- nausf-auth:ue-authentications\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/AuthenticationInfo'\nrequired: true\nresponses:\n'201':\ndescription: UEAuthenticationCtx\ncontent:\napplication/3gppHal+json:\nschema:\n$ref: '#/components/schemas/UEAuthenticationCtx'\nheaders:\nLocation:\ndescription: >\n'Contains the URI of the newly created resource according to the structure:\n{apiRoot}/nausf-auth/<apiVersion>/ue-authentications/{authCtxId}'\nrequired: true\nschema:\ntype: string\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\ndescription: Bad Request from the AMF\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\ndescription: Forbidden due to serving network not authorized\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'404':\ndescription: User does not exist in the HPLMN\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\ndescription: Internal Server Error\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'501':\ndescription: Received protection scheme is not supported by HPLMN\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\n/ue-authentications/deregister:\npost:\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-auth\n- oAuth2ClientCredentials:\n- nausf-auth\n- nausf-auth:ue-authentications\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/DeregistrationInfo'\nrequired: true\nresponses:\n'204':\ndescription: Expected response to a successful removal of security context\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\n/ue-authentications/{authCtxId}/5g-aka-confirmation:\nput:\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-auth\n- oAuth2ClientCredentials:\n- nausf-auth\n- nausf-auth:ue-authentications\nparameters:\n- name: authCtxId\nin: path\nrequired: true\nschema:\ntype: string\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/ConfirmationData'\nresponses:\n'200':\ndescription: Request processed (EAP success or Failure)\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/ConfirmationDataResponse'\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\ndescription: Bad Request\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\ndescription: Internal Server Error\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndelete:\nsummary: Deletes the authentication result in the UDM\noperationId: Delete5gAkaAuthenticationResult\ntags:\n- Authentication Result Deletion\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-auth\n- oAuth2ClientCredentials:\n- nausf-auth\n- nausf-auth:ue-authentications\nparameters:\n- name: authCtxId\nin: path\nrequired: true\nschema:\ntype: string\nresponses:\n'204':\ndescription: Expected response to a successful authentication result removal\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\n$ref: 'TS29571_CommonData.yaml#/components/responses/default'\n/ue-authentications/{authCtxId}/eap-session:\npost:\noperationId: EapAuthMethod\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-auth\n- oAuth2ClientCredentials:\n- nausf-auth\n- nausf-auth:ue-authentications\nparameters:\n- name: authCtxId\nin: path\nrequired: true\nschema:\ntype: string\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/EapSession'\nresponses:\n'200':\ndescription: Use to handle or close the EAP session\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/EapSession'\napplication/3gppHal+json:\nschema:\ntype: object\nproperties:\neapPayload:\n$ref: '#/components/schemas/EapPayload'\n_links:\ntype: object\ndescription: >\nA map (list of key-value pairs) where the key is set to \"eap-session\"\nadditionalProperties:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/LinksValueSchema'\nminProperties: 1\nrequired:\n- eapPayload\n- _links\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\ndescription: Bad Request\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\ndescription: Internal Server Error\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndelete:\nsummary: Deletes the authentication result in the UDM\noperationId: DeleteEapAuthenticationResult\ntags:\n- Authentication Result Deletion\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-auth\n- oAuth2ClientCredentials:\n- nausf-auth\n- nausf-auth:ue-authentications\nparameters:\n- name: authCtxId\nin: path\nrequired: true\nschema:\ntype: string\nresponses:\n'204':\ndescription: Expected response to a successful authentication result removal\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\n$ref: 'TS29571_CommonData.yaml#/components/responses/default'\n/rg-authentications:\npost:\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-auth\n- oAuth2ClientCredentials:\n- nausf-auth\n- nausf-auth:rg-authentications\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/RgAuthenticationInfo'\nrequired: true\nresponses:\n'201':\ndescription: RgAuthCtx\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/RgAuthCtx'\nheaders:\nLocation:\ndescription: >\n'Contains the URI of the newly created resource according to the structure:\n{apiRoot}/nausf-auth/<apiVersion>/rg-authentications/{authCtxId}'\nrequired: true\nschema:\ntype: string\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\ndescription: Bad Request from the AMF\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\ndescription: The UE is not allowed to be authenticated\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'404':\ndescription: User does not exist in the HPLMN\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\n/prose-authentications:\npost:\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-auth\n- oAuth2ClientCredentials:\n- nausf-auth\n- nausf-auth:prose-authentications\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/ProSeAuthenticationInfo'\nrequired: true\nresponses:\n'200':\ndescription: Successful authentication with CP-PRUK ID\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/ProSeAuthenticationResult'\n'201':\ndescription: ProSeAuthenticationCtx\ncontent:\napplication/3gppHal+json:\nschema:\n$ref: '#/components/schemas/ProSeAuthenticationCtx'\nheaders:\nLocation:\ndescription: >\n'Contains the URI of the newly created resource according to the structure:\n{apiRoot}/nausf-auth/<apiVersion>/prose-authentications/{authCtxId}'\nrequired: true\nschema:\ntype: string\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\n/prose-authentications/{authCtxId}/prose-auth:\npost:\noperationId: proseAuth\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-auth\n- oAuth2ClientCredentials:\n- nausf-auth\n- nausf-auth:prose-authentications\nparameters:\n- name: authCtxId\nin: path\nrequired: true\nschema:\ntype: string\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/ProSeEapSession'\nresponses:\n'200':\ndescription: >\nUse to handle or close the EAP session for 5G ProSe Remote UE or a 5G ProSe End UE\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/ProSeEapSession'\napplication/3gppHal+json:\nschema:\ntype: object\nproperties:\neapPayload:\n$ref: '#/components/schemas/EapPayload'\n_links:\ntype: object\ndescription: >\nA map (list of key-value pairs) where the key is set to\n\"prose-auth\"\nadditionalProperties:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/LinksValueSchema'\nminProperties: 1\nrequired:\n- eapPayload\n- _links\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndelete:\nsummary: Deletes the authentication result in the UDM\noperationId: DeleteProSeAuthenticationResult\ntags:\n- Authentication Result Deletion\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-auth\n- oAuth2ClientCredentials:\n- nausf-auth\n- nausf-auth:prose-authentications\nparameters:\n- name: authCtxId\nin: path\nrequired: true\nschema:\ntype: string\nresponses:\n'204':\ndescription: Expected response to a successful authentication result removal\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\n$ref: 'TS29571_CommonData.yaml#/components/responses/default'\ncomponents:\nsecuritySchemes:\noAuth2ClientCredentials:\ntype: oauth2\nflows:\nclientCredentials:\ntokenUrl: '{nrfApiRoot}/oauth2/token'\nscopes:\nnausf-auth: Access to Nausf_UEAuthentication API\nnausf-auth:ue-authentications: >\nAccess to service operations applying to the collection of the ue-authentication\nresources and the subresources, i.e. 5g-aka-confirmation and eap-session\nnausf-auth:rg-authentications: >\nAccess to service operations applying to the collection of the rg-authentication\nresources\nnausf-auth:prose-authentications: >\nAccess to service operations applying to the collection of the prose-authentication\nresources and the subresources, i.e. prose-auth.\nschemas:\nAuthenticationInfo:\ndescription: Contains the UE id (i.e. SUCI or SUPI) and the Serving Network Name.\ntype: object\nproperties:\nsupiOrSuci:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupiOrSuci'\nservingNetworkName:\n$ref: 'TS29503_Nudm_UEAU.yaml#/components/schemas/ServingNetworkName'\nresynchronizationInfo:\n$ref: 'TS29503_Nudm_UEAU.yaml#/components/schemas/ResynchronizationInfo'\npei:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Pei'\ntraceData:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/TraceData'\nudmGroupId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/NfGroupId'\nroutingIndicator:\ntype: string\npattern: '^[0-9]{1,4}$'\ncellCagInfo:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/CagId'\nminItems: 1\nn5gcInd:\ntype: boolean\ndefault: false\nsupportedFeatures:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nnswoInd:\ntype: boolean\ndefault: false\ndisasterRoamingInd:\ntype: boolean\ndefault: false\nonboardingInd:\ntype: boolean\ndefault: false\naun3Ind:\ntype: boolean\ndefault: false\nrequired:\n- supiOrSuci\n- servingNetworkName\nUEAuthenticationCtx:\ndescription: >\nContains the information related to the resource generated to handle\nthe UE authentication. It contains at least the UE id, Serving Network,\nthe Authentication Method and related EAP information or related 5G-AKA information.\ntype: object\nproperties:\nauthType:\n$ref: '#/components/schemas/AuthType'\n5gAuthData:\noneOf:\n- $ref: '#/components/schemas/Av5gAka'\n- $ref: '#/components/schemas/EapPayload'\n_links:\ntype: object\ndescription: >\nA map(list of key-value pairs) where the key is set to \"eap-session\" or \"5g-aka\"\nadditionalProperties:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/LinksValueSchema'\nservingNetworkName:\n$ref: 'TS29503_Nudm_UEAU.yaml#/components/schemas/ServingNetworkName'\nrequired:\n- authType\n- 5gAuthData\n- _links\nAv5gAka:\ndescription: Contains Authentication Vector for method 5G AKA.\ntype: object\nrequired:\n- rand\n- hxresStar\n- autn\nproperties:\nrand:\n$ref: 'TS29503_Nudm_UEAU.yaml#/components/schemas/Rand'\nhxresStar:\n$ref: '#/components/schemas/HxresStar'\nautn:\n$ref: 'TS29503_Nudm_UEAU.yaml#/components/schemas/Autn'\nConfirmationData:\ndescription: Contains the result of the authentication.\ntype: object\nrequired:\n- resStar\nproperties:\nresStar:\n$ref: '#/components/schemas/ResStar'\nsupportedFeatures:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nConfirmationDataResponse:\ndescription: Contains the result of the authentication\ntype: object\nproperties:\nauthResult:\n$ref: '#/components/schemas/AuthResult'\nsupi:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'\nkseaf:\n$ref: '#/components/schemas/Kseaf'\npvsInfo:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ServerAddressingInfo'\nminItems: 1\nrequired:\n- authResult\nEapSession:\ndescription: Contains information related to the EAP session.\ntype: object\nproperties:\neapPayload:\n$ref: '#/components/schemas/EapPayload'\nkSeaf:\n$ref: '#/components/schemas/Kseaf'\n_links:\ntype: object\ndescription: A map(list of key-value pairs) where the key is set to \"eap-session\"\nadditionalProperties:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/LinksValueSchema'\nauthResult:\n$ref: '#/components/schemas/AuthResult'\nsupi:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'\nsupportedFeatures:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\npvsInfo:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ServerAddressingInfo'\nminItems: 1\nmsk:\n$ref: '#/components/schemas/Msk'\nrequired:\n- eapPayload\nDeregistrationInfo:\ndescription: Contains the UE id (i.e. SUPI).\ntype: object\nproperties:\nsupi:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'\nsupportedFeatures:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nrequired:\n- supi\nRgAuthenticationInfo:\ndescription: Contains the UE id (i.e. SUCI) and the authenticated indication.\ntype: object\nproperties:\nsuci:\n$ref: '#/components/schemas/Suci'\nauthenticatedInd:\ntype: boolean\ndefault: false\nsupportedFeatures:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nrequired:\n- suci\n- authenticatedInd\nRgAuthCtx:\ndescription: Contains the UE id (i.e. SUPI) and the authentication indication.\ntype: object\nproperties:\nauthResult:\n$ref: '#/components/schemas/AuthResult'\nsupi:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'\nauthInd:\ntype: boolean\ndefault: false\nrequired:\n- authResult\nAuthResult:\ndescription: Indicates the result of the authentication.\ntype: string\nenum:\n- AUTHENTICATION_SUCCESS\n- AUTHENTICATION_FAILURE\n- AUTHENTICATION_ONGOING\nEapPayload:\ntype: string\nformat: byte\ndescription: contains an EAP packet\nnullable: true\nKseaf:\ndescription: Contains the Kseaf.\ntype: string\npattern: '[A-Fa-f0-9]{64}'\nMsk:\ndescription: Contains the Master Session Key.\ntype: string\npattern: '[A-Fa-f0-9]{128}'\nResStar:\ndescription: Contains the RES*.\ntype: string\npattern: '[A-Fa-f0-9]{32}'\nnullable: true\nHxresStar:\ndescription: Contains the HXRES*.\ntype: string\npattern: \"[A-Fa-f0-9]{32}\"\nSuci:\ndescription: Contains the SUCI.\ntype: string\npattern: '^(suci-(0-[0-9]{3}-[0-9]{2,3}|[1-7]-.+)-[0-9]{1,4}-(0-0-.+|[a-fA-F1-9]-([1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])-[a-fA-F0-9]+)|.+)$'\nAuthType:\ndescription: Indicates the authentication method used.\nanyOf:\n- type: string\nenum:\n- 5G_AKA\n- EAP_AKA_PRIME\n- EAP_TLS\n- EAP_TTLS\n- type: string\nProSeAuthenticationInfo:\ndescription: >\nContains the UE id (i.e. SUCI) or CP-PRUK ID, Relay Service Code and Nonce_1.\ntype: object\nproperties:\nsupiOrSuci:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupiOrSuci'\n5gPrukId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/5GPrukId'\nrelayServiceCode:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RelayServiceCode'\nnonce1:\n$ref: '#/components/schemas/Nonce1'\nservingNetworkName:\n$ref: 'TS29503_Nudm_UEAU.yaml#/components/schemas/ServingNetworkName'\nsupportedFeatures:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nrequired:\n- relayServiceCode\n- nonce1\n- servingNetworkName\nProSeAuthenticationCtx:\ndescription: >\nContains the information related to the resource generated to handle\nthe ProSe authentication.\ntype: object\nproperties:\nauthType:\n$ref: '#/components/schemas/AuthType'\n_links:\ntype: object\ndescription: A map(list of key-value pairs) where the key is set to \"prose-auth\"\nadditionalProperties:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/LinksValueSchema'\nproSeAuthData:\n$ref: '#/components/schemas/ProSeAuthData'\nsupportedFeatures:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nrequired:\n- authType\n- _links\n- proSeAuthData\nProSeEapSession:\ndescription: >\nContains information related to the EAP session. If present the 5gPrukId IE shall\ncarry the CP-PRUK ID.\ntype: object\nproperties:\neapPayload:\n$ref: '#/components/schemas/EapPayload'\nknrProSe:\n$ref: '#/components/schemas/KnrProSe'\n_links:\ntype: object\ndescription: A map(list of key-value pairs) where the key is set to \"prose-auth\"\nadditionalProperties:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/LinksValueSchema'\nauthResult:\n$ref: '#/components/schemas/AuthResult'\nsupportedFeatures:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nnonce2:\n$ref: '#/components/schemas/Nonce2'\n5gPrukId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/5GPrukId'\nrequired:\n- eapPayload\nProSeAuthData:\n$ref: '#/components/schemas/EapPayload'\nProSeAuthenticationResult:\ndescription: Successful authentication for CP-PRUK ID.\ntype: object\nproperties:\nknrProSe:\n$ref: '#/components/schemas/KnrProSe'\nnonce2:\n$ref: '#/components/schemas/Nonce2'\nsupportedFeatures:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nKnrProSe:\ndescription: Contains the KNR_ProSe.\ntype: string\npattern: '[A-Fa-f0-9]{64}'\nNonce1:\ntype: string\nformat: byte\ndescription: contains an Nonce1\nnullable: true\nNonce2:\ntype: string\nformat: byte\ndescription: contains an Nonce2\nnullable: true\nA.3\tNausf_SoRProtection API\nopenapi: 3.0.0\ninfo:\nversion: 1.3.0\ntitle: Nausf_SoRProtection Service\ndescription: |\nAUSF SoR Protection Service.\n© 2024, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC).\nAll rights reserved.\nexternalDocs:\ndescription: 3GPP TS 29.509 V18.5.0; 5G System; Authentication Server Services\nurl: 'https://www.3gpp.org/ftp/Specs/archive/29_series/29.509'\nservers:\n- url: '{apiRoot}/nausf-sorprotection/v1'\nvariables:\napiRoot:\ndefault: https://example.com\ndescription: apiRoot as defined in clause 4.4 of 3GPP TS 29.501.\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-sorprotection\npaths:\n/{supi}/ue-sor:\npost:\nparameters:\n- name: supi\nin: path\ndescription: Identifier of the UE\nrequired: true\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/SorInfo'\nrequired: true\nresponses:\n'200':\ndescription: SorSecurityInfo\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/SorSecurityInfo'\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\ndescription: Service Unavailable\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\ncomponents:\nsecuritySchemes:\noAuth2ClientCredentials:\ntype: oauth2\nflows:\nclientCredentials:\ntokenUrl: '{nrfApiRoot}/oauth2/token'\nscopes:\nnausf-sorprotection: Access to the Nausf_SoRProtection API\nschemas:\n#\n# COMPLEX TYPES:\n#\nSorInfo:\ndescription: Contains the Steering Information.\ntype: object\nproperties:\nsteeringContainer:\n$ref: '#/components/schemas/SteeringContainer'\nackInd:\n$ref: '#/components/schemas/AckInd'\nsorHeader:\n$ref: '#/components/schemas/SorHeader'\nsorTransparentInfo:\n$ref: '#/components/schemas/SorTransparentInfo'\nsupportedFeatures:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nrequired:\n- ackInd\nSorSecurityInfo:\ndescription: >\nContains the material generated for securing of SoR. It contains at least the\nSoR-MAC-IAUSF and CounterSoR.\ntype: object\nproperties:\nsorMacIausf:\n$ref: '#/components/schemas/SorMac'\ncounterSor:\n$ref: '#/components/schemas/CounterSor'\nsorXmacIue:\n$ref: '#/components/schemas/SorMac'\nrequired:\n- sorMacIausf\n- counterSor\nSteeringContainer:\ndescription: Contains the information sent to UE.\noneOf:\n- type: array\nitems:\n$ref: '#/components/schemas/SteeringInfo'\nminItems: 1\n- $ref: '#/components/schemas/SecuredPacket'\nSteeringInfo:\ndescription: Contains a combination of one PLMN identity and zero or more access technologies.\ntype: object\nproperties:\nplmnId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PlmnId'\naccessTechList:\ntype: array\nitems:\n$ref: '#/components/schemas/AccessTech'\nminItems: 1\nrequired:\n- plmnId\n#\n# SIMPLE TYPES:\n#\nSorMac:\ndescription: MAC value for protecting SOR procedure (SoR-MAC-IAUSF and SoR-XMAC-IUE).\ntype: string\npattern: '^[A-Fa-f0-9]{32}$'\nCounterSor:\ndescription: CounterSoR.\ntype: string\npattern: '^[A-Fa-f0-9]{4}$'\nAckInd:\ndescription: Contains indication whether the acknowledgement from UE is needed.\ntype: boolean\nSecuredPacket:\ndescription: Contains a secure packet.\ntype: string\nformat: byte\nSorHeader:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\nSorTransparentInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\n#\n# ENUMS:\nAccessTech:\ndescription: Represents the access technology\nanyOf:\n- type: string\nenum:\n- NR\n- EUTRAN_IN_WBS1_MODE_AND_NBS1_MODE\n- EUTRAN_IN_NBS1_MODE_ONLY\n- EUTRAN_IN_WBS1_MODE_ONLY\n- UTRAN\n- GSM_AND_ECGSM_IoT\n- GSM_WITHOUT_ECGSM_IoT\n- ECGSM_IoT_ONLY\n- CDMA_1xRTT\n- CDMA_HRPD\n- GSM_COMPACT\n- type: string\nA.4\tNausf_UPUProtection API\nopenapi: 3.0.0\ninfo:\nversion: 1.3.0\ntitle: Nausf_UPUProtection Service\ndescription: |\nAUSF UPU Protection Service.\n© 2024, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC).\nAll rights reserved.\nexternalDocs:\ndescription: 3GPP TS 29.509 V18.5.0; 5G System; Authentication Server Services\nurl: 'https://www.3gpp.org/ftp/Specs/archive/29_series/29.509'\nservers:\n- url: '{apiRoot}/nausf-upuprotection/v1'\nvariables:\napiRoot:\ndefault: https://example.com\ndescription: apiRoot as defined in clause 4.4 of 3GPP TS 29.501.\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- nausf-upuprotection\npaths:\n/{supi}/ue-upu:\npost:\nparameters:\n- name: supi\nin: path\ndescription: Identifier of the UE\nrequired: true\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/UpuInfo'\nrequired: true\nresponses:\n'200':\ndescription: UpuSecurityInfo\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/UpuSecurityInfo'\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\ndescription: Service Unavailable\ncontent:\napplication/problem+json:\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/ProblemDetails'\ncomponents:\nsecuritySchemes:\noAuth2ClientCredentials:\ntype: oauth2\nflows:\nclientCredentials:\ntokenUrl: '{nrfApiRoot}/oauth2/token'\nscopes:\nnausf-upuprotection: Access to the Nausf_UPUProtection API\nschemas:\n#\n# COMPLEX TYPES:\n#\nUpuInfo:\ndescription: Contains the UE parameters update Information.\ntype: object\nproperties:\nupuDataList:\ntype: array\nitems:\n$ref: '#/components/schemas/UpuData'\nminItems: 1\nupuHeader:\n$ref: '#/components/schemas/UpuHeader'\nupuAckInd:\n$ref: '#/components/schemas/UpuAckInd'\nsupportedFeatures:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures'\nupuTransparentInfo:\n$ref: '#/components/schemas/UpuTransparentInfo'\nrequired:\n- upuDataList\n- upuAckInd\nUpuSecurityInfo:\ndescription: >\nContains the material generated for securing of UPU. It contains at least\nthe UPU-MAC-IAUSF and CounterUPU.\ntype: object\nproperties:\nupuMacIausf:\n$ref: '#/components/schemas/UpuMac'\ncounterUpu:\n$ref: '#/components/schemas/CounterUpu'\nupuXmacIue:\n$ref: '#/components/schemas/UpuMac'\nrequired:\n- upuMacIausf\n- counterUpu\nUpuData:\ndescription: >\nContains UE parameters update data set (e.g., the updated Routing ID Data\nor the Default configured NSSAI or the disaster roaming parameters).\ntype: object\nproperties:\nsecPacket:\n$ref: 'TS29509_Nausf_SoRProtection.yaml#/components/schemas/SecuredPacket'\ndefaultConfNssai:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Snssai'\nminItems: 1\nroutingId:\n$ref: 'TS29544_Nspaf_SecuredPacket.yaml#/components/schemas/RoutingId'\ndrei:\ntype: boolean\naol:\ntype: boolean\ndisasterCondPlmnIds:\ntype: array\nitems:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PlmnId'\nminItems: 1\n#\n# SIMPLE TYPES:\n#\nUpuMac:\ndescription: MAC value for protecting UPU procedure (UPU-MAC-IAUSF and UPU-MAC-IUE).\ntype: string\npattern: '^[A-Fa-f0-9]{32}$'\nCounterUpu:\ndescription: CounterUPU.\ntype: string\npattern: '^[A-Fa-f0-9]{4}$'\nUpuAckInd:\ndescription: Contains the indication of whether the acknowledgement from UE is needed.\ntype: boolean\nUpuHeader:\ndescription: >\nContains the \"UPU Header\" IE as specified in clause 9.11.3.53A of\n3GPP TS 24.501 (octet 4), encoded as 2 hexadecimal characters.\ntype: string\npattern: '^[A-Fa-f0-9]{2}$'\nUpuTransparentInfo:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\nAnnex B (Informative):Use of EAP-TLS\nB.1\tGeneral\nThe Annex B of 3GPP TS 33.501 [8] describes the use of EAP-TLS as an alternative authentication method in the case of private network. This annex describes corresponding stage 3.\nB.2\tEAP method: EAP-TLS\nEAP-TLS as defined in IETF RFC 5216 [16] is the EAP method used in this procedure. This procedure is described in Annex B.2.1 of 3GPP TS 33.501 [8].\nFigure B.2-1: EAP method\n1.\tThe NF Service Consumer (AMF) shall send a POST request to the AUSF. The content shall contain at least the UE Id and Serving Network Name.\n2a.\tOn success, \"201 Created\" shall be returned. The content shall contain the representation of the resource generated and the \"Location\" header shall contain the URI of the generated resource (e.g. …/ue_authentications/{authCtxId}/eap-session). The AUSF generates a sub-resource \"eap-session\". The AUSF shall provide a hypermedia link towards this sub-resource in the content to indicate to the AMF where it shall send a POST containing the EAP packet response. The content shall also contain the EAP packet EAP-Request/EAP-Type=EAP-TLS (TLS Start)\n2b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.7.3-1 shall be returned with the message body containing a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.7.3-1. In particular, if the serving network is not authorized, the AUSF shall use the \"Cause\" SERVING_NETWORK_NOT_AUTHORIZED.\n3.\tBased on the relation type, the NF Service Consumer (AMF) shall send a POST request including the EAP-Response/EAP-Type=EAP-TLS (TLS client_hello) received from the UE. The POST request is sent to the URI provided by the AUSF or derived by the NF Service Consumer (AMF).\n4a.\tOn success, the AUSF shall reply with a \"200 OK\" HTTP message containing the EAP Request as described in Annex B.2.1 of 3GPP TS 33.501 [8] and a hypermedia link towards the sub-resource \"eap-session\".\n4b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.7.3-1 shall be returned with the message body containing a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.7.3-1.\n5.\tThe NF Service Consumer (AMF) shall send a POST request including the EAP Response received from the UE. The POST request is sent to the URI provided by the AUSF or derived by the NF Service Consumer (AMF).\n6a.\tOn success, the AUSF shall reply with a \"200 OK\" HTTP message containing the EAP Request as described in Annex B.2.1 of 3GPP TS 33.501 [8] and a hypermedia link towards the sub-resource \"eap-session\".\n6b. On failure or redirection, one of the HTTP status code listed in table 6.1.7.3-1 shall be returned with the message body containing a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.7.3-1.\n7.\tThe NF Service Consumer (AMF) shall send a POST request including the EAP Response received from the UE. The POST request is sent to the URI provided by the AUSF or derived by the NF Service Consumer (AMF).\n8a.\tIf the EAP authentication exchange is successfully completed (with or without the optional Notification Request/Response messages exchange), \"200 OK\" shall be returned to the NF Service Consumer (AMF). The content shall contain the result of the authentication, an EAP success/failure and the Kseaf if the authentication is successful.\n8b.\tOn failure or redirection, one of the HTTP status code listed in table 6.1.7.3-1 shall be returned with the message body containing a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.1.7.3-1.\nAnnex C (informative):Withdrawn API versions\nC.1\tGeneral\nThis Annex lists withdrawn API versions of the APIs defined in the present specification. 3GPP TS 29.501 [5] clause 4.3.1.6 describes the withdrawal of API versions.\nC.2\tNausf_SoRProtection API\nThe API versions listed in table C.2-1 are withdrawn for the Nausf_SoRProtection API.\nTable C.2-1: Withdrawn API versions of the Nausf_SoRProtection service\nAPI version number\nReason for withdrawal\n1.0.0\nThe version 1.0.0 indicates that a 201 \"Created\" must be sent in response to the POST Custom Operations while it should be a \"200 OK\" as indicated in clause 6.2.3.2.4.2.2. The version 1.0.1 corrects this mistake. As a consequence, the version 1.0.0 is withdrawn in order to avoid interoperability problems with further version of the Nausf_SoRProtection service.\nAnnex D (informative):Change history\nChange history\nDate\nMeeting\nTdoc\nCR\nRev\nCat\nSubject/Comment\nNew version\n2017-10\nCT4#80\nC4-175268\nInitial Draft.(Agreed Skeleton)\n0.1.0\n2017-10\nCT4#80\nC4-175394\nInclusion of pCR agreeds during CT4#80: C4-175269 and C4-175270\n0.2.0\n2017-12\nCT4#81\nC4-176437\nInclusion of pCR agreeds during CT4#81: C4-176267, C4-176269, C4-176426, C4-17427\n0.3.0\n2018-01\nCT4#82\nC4-181391\nInclusion of pCR agreeds during CT4#82: C4-181341, C4-181342, C4-181343, C4-181344, C4-181345,C4-181346, C4-181347,C4-181155\n0.4.0\n2018-03\nCT4#83\nC4-182434\nInclusion of pCRs agreeds during CT4#83: C4-182283 and C4-182279\n0.5.0\n2018-03\nCT#79\nCP-180031\nPresented for information\n1.0.0\n2018-04\nCT4#84\nC4-183516\nInclusion of pCRs agreed during CT4#84: C4-183309, C4-183313, C4-183346, C4-183347 and C4-183448\n1.1.0\n2018-05\nCT4#85\nC4-184623\nInclusion of PCRs agreeds during CT4#83: C4-184219, C4-184220, C4-184224, C4-184227, C4-184227, C4-184362, C4-184363, C4-184367, C4-184368, C4-184370, C4-184376, C4-184380, C4-184584, C4-184624\n1.2.0\n2018-06\nCT#80\nCP-181104\nPresented for approval\n2.0.0\n2018-06\nCT#80\nApproved in CT#80.\n15.0.0\n2018-09\nCT#81\nCP-182059\n0002\n2\nF\nRequester ID in Authentication Info\n15.1.0\n2018-09\nCT#81\nCP-182059\n0003\n1\nF\nHTTP method in figure 5.2.2.2.2-1 (Note: clause 6.1.3.1 is not included, already covered)\n15.1.0\n2018-09\nCT#81\nCP-182059\n0004\n4\nF\nSoRProtection service operation\n15.1.0\n2018-09\nCT#81\nCP-182059\n0010\n1\nF\nAdding TS 33.501 reference\n15.1.0\n2018-09\nCT#81\nCP-182059\n0011\n-\nF\nHTTP Custom Header\n15.1.0\n2018-09\nCT#81\nCP-182059\n0013\n1\nF\nSUPI sends to AMF\n15.1.0\n2018-09\nCT#81\nCP-182068\n0014\n2\nB\n5G Trace for AUSF\n15.1.0\n2018-09\nCT#81\nCP-182013\n0015\n2\nF\nMaking Oauth 2.0 optional in OAS description\n15.1.0\n2018-09\nCT#81\nCP-182059\n0016\n1\nF\nEditorial Corrections\n15.1.0\n2018-09\nCT#81\nCP-182059\n0017\n1\nF\nError code correction\n15.1.0\n2018-09\nCT#81\nCP-182059\n0018\n1\nF\nAdd support to EAP-TLS (Optional)\n15.1.0\n2018-09\nCT#81\nCP-182059\n0019\n-\nF\nCorrecting Presentation of resources for AUSF API\n15.1.0\n2018-09\nCT#81\nCP-182059\n0020\n1\nF\nCorrecting confirmation message\n15.1.0\n2018-09\nCT#81\nCP-182059\n0021\n-\nF\nAPI version number update\n15.1.0\n2018-12\nCT#82\nCP-183017\n0026\n-\nF\nRemove the \"supiOrSuci\" in Confirmation Data\n15.2.0\n2018-12\nCT#82\nCP-183017\n0027\n-\nF\nCorrecting Resource URI structure of the SoRProtection Service\n15.2.0\n2018-12\nCT#82\nCP-183017\n0030\n-\nF\nCardinality\n15.2.0\n2018-12\nCT#82\nCP-183017\n0031\n-\nF\nAdd supi and authResult to EapSession in OpenAPI definitions\n15.2.0\n2018-12\nCT#82\nCP-183017\n0022\n-\nF\nRequester ID not needed in initial request from AMF\n15.2.0\n2018-12\nCT#82\nCP-183017\n0023\n-\nF\nDelaying transmission of Kseaf\n15.2.0\n2018-12\nCT#82\nCP-183017\n0024\n1\nF\nCorrecting the reference to EAP-AKA'\n15.2.0\n2018-12\nCT#82\nCP-183017\n0025\n1\nF\nAdding a reference to the Annex in the Specification\n15.2.0\n2018-12\nCT#82\nCP-183017\n0028\n1\nF\nError handling in AUSF\n15.2.0\n2018-12\nCT#82\nCP-183017\n0029\n1\nF\nAdd a reference to the IETF RFC 3748 on EAP Framework\n15.2.0\n2018-12\nCT#82\nCP-183017\n0032\n-\nF\nBase64 reference\n15.2.0\n2018-12\nCT#82\nCP-183017\n0033\n-\nF\nAPIRoot Clarification\n15.2.0\n2018-12\nCT#82\nCP-183017\n0034\n-\nF\nReference correction\n15.2.0\n2018-12\nCT#82\nCP-183017\n0036\n-\nF\nOpenAPI version number for Nausf_UEAuthentication service\n15.2.0\n2018-12\nCT#82\nCP-183017\n0037\n1\nF\nOpenAPI version number for Nausf_SoRProtection\n15.2.0\n2018-12\nCT#82\nCP-183017\n0038\n1\nF\nCorrect \"externalDocs\" for Nausf_UEAuthentication OAS\n15.2.0\n2018-12\nCT#82\nCP-183017\n0039\n1\nF\nClarification on the 200 OK returned by AUSF in case of authentication failure\n15.2.0\n2018-12\nCT#82\nCP-183017\n0040\n-\nF\nSecured packet in SorInfo\n15.2.0\n2018-12\nCT#82\nCP-183170\n0035\n2\nLocation Header in OpenAPI\n15.2.0\n2018-12\nCT#82\nCP-183172\n0041\n-\nF\nAlignement for Oauth scopes - Nausf_UEAuthentication\n15.2.0\n2018-12\nCT#82\nCP-183173\n0042\n-\nF\nAlignement for Oauth scopes - Nausf_SoRProtection\n15.2.0\n2018-12\nCT#82\nCP-183203\n0043\n-\nF\nexternalDocs for Nausf_SoRProtection OpenAPI Annex\n15.2.0\n2019-03\nCT#83\nCP-190022\n0047\n1\nF\nMandatory HTTP status codes\n15.3.0\n2019-03\nCT#83\nCP-190022\n0049\n1\nF\nSoR Protection response code alignment\n15.3.0\n2019-03\nCT#83\nCP-190022\n0044\n3\nF\nAuthentication Failure scenarios\n15.3.0\n2019-03\nCT#83\nCP-190153\n0046\n7\nF\nUE parameters update support (indicated as C4-190618 + C4-190618_rev7I)\n15.3.0\n2019-03\nCT#83\nCP-19205\n0050\n1\nF\n3GPP TS 29.509 API version update\n15.3.0\n2019-06\nCT#84\nCP-191033\n0051\n-\nF\nCorrect the expression of URI variables in 5g-aka-confirmation resource\n15.4.0\n2019-06\nCT#84\nCP-191033\n0053\n2\nF\nStorage of OpenAPI specification files\n15.4.0\n2019-06\nCT#84\nCP-191033\n0056\n-\nF\nAUSF Tracing Targeting a PEI\n15.4.0\n2019-06\nCT#84\nCP-191033\n0055\n1\nF\nDetermination of the Authentication Method\n15.4.0\n2019-06\nCT#84\nCP-191218\n0059\n4\nF\nAdd withdrawn API version Annex\n15.4.0\n2019-06\nCT#84\nCP-191033\n0058\n1\nF\nEssential correction to add Copyright on OpenAPI specifications\n15.4.0\n2019-06\nCT#84\nCP-191057\n0054\n1\nF\nNon cacheable 501 response\n16.0.0\n2019-06\nCT#84\nCP-191057\n0057\n1\nB\nUDM service discovery based on GroupID and/or RoutingID\n16.0.0\n2019-06\nCT#84\nCP-191223\n0060\n2\nF\n3GPP TS 29.509 API version update\n16.0.0\n2019-09\nCT#85\nCP-192106\n0063\n1\nF\nMissing status codes\n16.1.0\n2019-09\nCT#85\nCP-192120\n0066\n-\nF\nAPI version and ExternalDocs update\n16.1.0\n2019-10\nCorrupted references fixed\n16.1.1\n2019-12\nCT#86\nCP-193063\n0072\n-\nF\nAdd UPU protection in AUSF functionality\n16.2.0\n2019-12\nCT#86\nCP-193058\n0067\n1\nB\nRoutingId\n16.2.0\n2019-12\nCT#86\nCP-193134\n0069\n2\nB\nAuthentication Indication from W-AGF (tmp)\n16.2.0\n2019-12\nCT#86\nCP-193241\n0071\n2\nF\nMove ExternalDocs in OpenAPI specifications\n16.2.0\n2019-12\nCT#86\nCP-193036\n0068\n1\nF\nEAP Payload\n16.2.0\n2019-12\nCT#86\nCP-193036\n0070\n1\nF\nAdd reference to TS 29.524\n16.2.0\n2019-12\nCT#86\nCP-193044\n0074\n-\nF\n3GPP TS 29.509 API version update\n16.2.0\n2020-03\nCT#87-e\nCP-200020\n0076\n1\nF\nReference to Data Type SteeringInfo\n16.3.0\n2020-03\nCT#87-e\nCP-200242\n0082\n-\nF\nInitial Registration procedure on a CAG Cell\n16.3.0\n2020-03\nCT#87-e\nCP-200039\n0075\n1\nF\nAdd Corresponding API descriptions in clause 5.1\n16.3.0\n2020-03\nCT#87-e\nCP-200039\n0077\n2\nF\nCorrection - formatting consistency\n16.3.0\n2020-03\nCT#87-e\nCP-200035\n0078\n2\nF\nEditorial corrections\n16.3.0\n2020-03\nCT#87-e\nCP-200035\n0081\n1\nF\nSUPI pattern\n16.3.0\n2020-03\nCT#87-e\nCP-200242\n0083\n1\nF\nAUSF service update for the authentication result removal\n16.3.0\n2020-03\nCT#87-e\nCP-200020\n079\n2\nF\nOptionality of ProblemDetails\n16.3.0\n2020-03\nCT#87-e\nCP-200052\n0084\n-\nF\n3GPP TS 29.509 Rel16 API version and External doc update\n16.3.0\n2020-03\nCT#87-e\nCP-200252\n0085\n-\nF\nOTAF NF name change to SP-AF\n16.3.0\n2020-06\nCT#88-e\nCP-201034\n0093\n-\nD\nEditorial Clarifications\n16.4.0\n2020-06\nCT#88-e\nCP-201034\n0095\n-\nB\nMaintain only latest Kausf in network\n16.4.0\n2020-06\nCT#88-e\nCP-201034\n0096\n-\nF\nAUSF service update for the authentication result removal\n16.4.0\n2020-06\nCT#88-e\nCP-201034\n0097\n-\nF\nMiscellaneous Corrections\n16.4.0\n2020-06\nCT#88-e\nCP-201048\n0094\n1\nB\nN5GC device Authentication\n16.4.0\n2020-06\nCT#88-e\nCP-201063\n0086\n1\nF\nSupported Headers Tables for Response code 201\n16.4.0\n2020-06\nCT#88-e\nCP-201063\n0091\n1\nF\nDatatype column in Resource URI variables Table\n16.4.0\n2020-06\nCT#88-e\nCP-201063\n0092\n1\nF\nAdd custom operation Name\n16.4.0\n2020-06\nCT#88-e\nCP-201063\n0088\n2\nF\nEditorial Error Corrections\n16.4.0\n2020-06\nCT#88-e\nCP-201073\n0098\n-\nF\n29.509 Rel16 API version and External doc update\n16.4.0\n2020-09\nCT#89-e\nCP-202088\n0100\n-\nF\nCustom Operation Correction\n16.5.0\n2020-09\nCT#89-e\nCP-202043\n0103\n-\nF\nSoR Header\n16.5.0\n2020-09\nCT#89-e\nCP-202115\n0104\n-\nF\nCorrections on SoRProtection service\n16.5.0\n2020-09\nCT#89-e\nCP-202110\n0105\n-\nF\nCorrections on UPUProtection service\n16.5.0\n2020-09\nCT#89-e\nCP-202089\n0101\n1\nF\nStorage of YAML files in 3GPP Forge\n16.5.0\n2020-12\nCT#90-e\nCP-203042\n0110\n2\nF\nInitial Registration procedure on a CAG Cell\n16.6.0\n2020-12\nCT#90-e\nCP-203036\n0111\n-\nF\nAPI Version and External Doc Update (R16)\n16.6.0\n2020-12\nCT#90-e\nCP-203063\n0108\n1\nC\nEvolution of SoR delivery mechanism – AUSF API Changes\n17.0.0\n2020-12\nCT#90-e\nCP-203055\n0112\n-\nF\nAPI Version and External Doc Update (R17)\n17.0.0\n2021-02\nClauses 5.2.2.X/5.2.2.X.1 numbered correctly\n17.0.1\n2021-03\nCT#91-e\nCP-210021\n0114\n-\nD\nMiscellaneous Corrections\n17.1.0\n2021-03\nCT#91-e\nCP-210029\n0121\n-\nF\n29.509 Rel-17 API version and External Doc update\n17.1.0\n2021-03\nCT#91-e\nCP-210034\n0120\n1\nF\nOpenAPI Reference and description field for map data types\n17.1.0\n2021-03\nCT#91-e\nCP210037\n0119\n1\nF\nHTTP 3xx redirection\n17.1.0\n2021-06\nCT#92-e\nCP-211028\n0123\n-\nF\nData Types Descriptions\n17.2.0\n2021-06\nCT#92-e\nCP-211028\n0125\n1\nF\nResource for Individual Authentication\n17.2.0\n2021-06\nCT#92-e\nCP-211046\n0124\n-\nF\nData Type Correction\n17.2.0\n2021-06\nCT#92-e\nCP-211050\n0126\n-\nF\n29.509 Rel-17 API version and External doc update\n17.2.0\n2021-09\nCT#93-e\nCP-212082\n0130\n1\nA\nUPU Header within UPU Data Protection\n17.3.0\n2021-09\nCT#93-e\nCP-212026\n0131\n-\nF\nBase64 Encoding of binary attributes in JSON objects\n17.3.0\n2021-09\nCT#93-e\nCP-212059\n0132\n-\nF\n29.509 Rel-17 API version and External doc update\n17.3.0\n2021-12\nCT#94-e\nCP-213085\n0135\n-\nF\nFeature numbering\n17.4.0\n2021-12\nCT#94-e\nCP-213085\n0136\n-\nF\nCorrections to the API URI\n17.4.0\n2021-12\nCT#94-e\nCP-213087\n0138\n-\nF\nCorrections related to the description fields in the OpenAPI descriptions\n17.4.0\n2022-03\nCT#95-e\nCP-220026\n0149\n-\nF\nRouting Indicator\n17.5.0\n2022-03\nCT#95-e\nCP-220047\n0141\n-\nF\nSNPN onboarding impacts on AUSF services – R17\n17.5.0\n2022-03\nCT#95-e\nCP-220047\n0152\n-\nB\nEAP-TTLS support in SNPN  (TS 29.509)\n17.5.0\n2022-03\nCT#95-e\nCP-220047\n0144\n3\nB\nPVS Info\n17.5.0\n2022-03\nCT#95-e\nCP-220053\n0143\n1\nB\nNSWO authentication\n17.5.0\n2022-03\nCT#95-e\nCP-220069\n0151\n-\nA\n307/308 redirection\n17.5.0\n2022-03\nCT#95-e\nCP-220066\n0155\n-\nF\n29.509 Rel-17 API version and External doc update\n17.5.0\n2022-06\nCT#96\nCP-221039\n0162\n1\nB\nUPU Transparent Container\n17.6.0\n2022-06\nCT#96\nCP-221027\n0157\n-\nF\nCorrection of typos in description fields\n17.6.0\n2022-06\nCT#96\nCP-221039\n0158\n-\nB\nDisaster Roaming Indicator\n17.6.0\n2022-06\nCT#96\nCP-221043\n0161\n-\nB\nOverview of New ProseAuthenticate service operation\n17.6.0\n2022-06\nCT#96\nCP-221043\n0160\n1\nB\nNew ProseAuthenticate service operation\n17.6.0\n2022-06\nCT#96\nCP-221053\n0159\n-\nF\nReused data types\n17.6.0\n2022-06\nCT#96\nCP-221053\n0164\n-\nF\nEditorial corrections\n17.6.0\n2022-06\nCT#96\nCP-221056\n0163\n1\nA\nIETF has published RFC 9048\n17.6.0\n2022-06\nCT#96\nCP-221338\n0168\n1\nF\n29.509 Rel-17 API version and External doc update\n17.6.0\n2022-09\nCT#97\nCP-222026\n0170\n-\nF\nDescription alignment with yaml\n17.7.0\n2022-09\nCT#97\nCP-222034\n0171\n1\nF\nMSK in EapSession\n17.7.0\n2022-09\nCT#97\nCP-222035\n0172\n-\nF\n5G ProSe Authentication Service Description Alignment\n17.7.0\n2022-09\nCT#97\nCP-222035\n0173\n1\nF\n5G ProSe Authentication API Update\n17.7.0\n2022-09\nCT#97\nCP-222035\n0174\n1\nF\nResolve EN For 5G_AKA support\n17.7.0\n2022-09\nCT#97\nCP-222037\n0169\n-\nF\nPVS related alignement\n17.7.0\n2022-09\nCT#97\nCP-222058\n0176\n-\nF\n29.509 Rel-17 API version and External doc update\n17.7.0\n2022-12\nCT#98\nCP-223049\n0180\n-\nF\nUE onboarding in authentication request\n17.8.0\n2022-12\nCT#98\nCP-223054\n0185\n1\nF\nUpdate on Nausf_UEAuthentication_Authenticate service operation\n17.8.0\n2022-12\nCT#98\nCP-223054\n0179\n1\nF\n5GPRUK Name Alignment\n17.8.0\n2022-12\nCT#98\nCP-223027\n0178\n1\nF\nMissing Mandatory Status Codes in OpenAPI\n18.0.0\n2022-12\nCT#98\nCP-223033\n0186\n-\nF\n29.509 Rel-18 API version and External doc update\n18.0.0\n2022-12\nCT#98\nCP-223063\n0181\n1\nF\nboolean type IEs definition correction\n18.0.0\n2022-12\nCT#98\nCP-223063\n0182\n1\nD\nEditorial corrections\n18.0.0\n2023-06\nCT#100\nCP-231346\n0191\n1\nB\nOAuth2 scopes in the Nausf_UEAuthentication API\n18.1.0\n2023-06\nCT#100\nCP-231026\n0189\n3\nF\nLocation header description\n18.1.0\n2023-06\nCT#100\nCP-231041\n0195\n1\nB\nUpdate the reference model\n18.1.0\n2023-06\nCT#100\nCP-231078\n0194\n-\nA\nAdd serving network name in ProSeAuthenticationInfo\n18.1.0\n2023-06\nCT#100\nCP-231345\n0198\n-\nF\n29.509 Rel-18 API version and External doc update\n18.1.0\n2023-09\nCT#101\nCP-232033\n0202\n-\nF\nAdding the missing description fields\n18.2.0\n2023-09\nCT#101\nCP-232056\n0199\n-\nB\nAuthentication of AUN3 devices behind RG\n18.2.0\n2023-09\nCT#101\nCP-232056\n0200\n1\nB\nUpdate the description of MSK to support authentication for AUN3 devices behind 5G-RG\n18.2.0\n2023-09\nCT#101\nCP-232060\n0203\n-\nF\n29.509 Rel-18 API version and External doc update\n18.2.0\n2023-12\nCT#102\nCP-233027\n0204\nF\nHTTP RFC obsoleted by IETF RFC 9113\n18.3.0\n2023-12\nCT#102\nCP-233030\n0207\nF\nProblemDetails RFC 7807 obsoleted by 9457\n18.3.0\n2023-12\nCT#102\nCP-233055\n0206\n1\nB\nEnhancement to support UE-to-UE relay\n18.3.0\n2023-12\nCT#102\nCP-233060\n0208\nF\n29.509 Rel-18 API version and External doc update\n18.3.0\n2024-03\nCT#103\nCP-240067\n0210\nF\nDisaster Roaming Indication\n18.4.0\n2024-03\nCT#103\nCP-240056\n0211\n-\nF\n29.509 Rel-18 API version and External doc update\n18.4.0\n2024-06\nCT#104\nCP-241413\n0217\n1\nF\nClarification on deviation of naming-convention for enum values in Nausf specific Data Type\n18.5.0\n2024-06\nCT#104\nCP-241455\n0216\n1\nF\nDefinition of ProseAuthData\n18.5.0\n2024-06\nCT#104\nCP-241475\n0214\n2\nA\nDisaster Condition PLMN List\n18.5.0\n2024-06\nCT#104\nCP-241544\n0215\n3\nF\nStyle Corrections of Nausf APIs\n18.5.0\n2024-06\nCT#104\nCP-242158\n0220\n-\nF\nFeature negotiation correction\n18.5.0\n2024-06\nCT#104\nCP-242214\n0221\n-\nF\nUpdate on incorrect attribute name\n18.5.0\n2024-06\nCT#104\nCP-242355\n0219\n1\nF\nClarifying the self-references and editorial corrections\n18.5.0\n2024-06\nCT#104\nCP-242505\n0222\n-\nF\n29.509 Rel-18 API version and External doc update\n18.5.0",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.3.9",
        "ts_29.500_clause_6.10.3.4",
        "ts_29.500_clause_6.10.9.1",
        "ts_29.501_clause_5.3.1",
        "ts_21.900_clause_5",
        "ts_29.501_clause_4.4",
        "ts_24.501_clause_9.11.3.53",
        "ts_29.501_clause_4.3.1.6",
        "clause_6.2.3.2.4.2.2",
        "clause_6.1.3.1",
        "clause_5.1",
        "table_6.1.7.3-1",
        "table_16.4.0",
        "figure_5.2.2.2.2-1",
        "ts_29.500",
        "ts_29.501",
        "ts_21.900",
        "ts_29.509",
        "ts_24.501",
        "ts_33.501",
        "ts_29.524",
        "ts_17.3"
      ]
    }
  ]
}
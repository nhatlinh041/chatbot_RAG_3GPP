{
  "metadata": {
    "specification_id": "ts_29.379",
    "version": "18.0.0",
    "title": "3GPP TS 29.379",
    "file_path": "/content/drive/MyDrive/RAG_thesis/data/29_series/29379-i00/29379-i00.docx"
  },
  "export_info": {
    "export_date": "2025-07-26T09:00:04.927118",
    "total_chunks": 200
  },
  "chunks": [
    {
      "chunk_id": "ts_29.379_1",
      "section_id": "1",
      "section_title": "Scope",
      "content": "The present document specifies the call control protocols needed to support a Mission Critical Push To Talk (MCPTT) system interworking with a Land Mobile Radio (LMR) system.\nThe IWF supports the basic group and other features as specified in 3GPP TS 23.283 [28]. The present document describes functionality modelled on 3GPP TS 24.379 [29].",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.283",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_2",
      "section_id": "2",
      "section_title": "References",
      "content": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non‑specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.379: \"Functional architecture and information flows to support mission critical communication services; Stage 2\".\n[3]\t3GPP TS 24.229: \"IP multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".\n[4]\t3GPP TS 24.380: \"Mission Critical Push To Talk (MCPTT) floor control Protocol specification\".\n[5]\tIETF RFC 3841 (August 2004): \"Caller Preferences for the Session Initiation Protocol (SIP)\".\n[6]\tIETF RFC 4028 (April 2005): \"Session Timers in the Session Initiation Protocol (SIP)\".\n[7]\tIETF RFC 6050 (November 2010): \"A Session Initiation Protocol (SIP) Extension for the Identification of Services\".\n[8]\tIETF RFC 4566 (July 2006): \"Session Description Protocol\".\n[9]\tIETF RFC 3840 (August 2004): \"Indicating User Agent Capabilities in the Session Initiation Protocol (SIP)\".\n[10]\tIETF RFC 5373 (November 2008): \"Requesting Answering Modes for the Session Initiation Protocol (SIP)\".\n[11]\tIETF RFC 5366 (October 2008): \"Conference Establishment Using Request-Contained Lists in the Session Initiation Protocol (SIP)\".\n[12]\tIETF RFC 4488 (May 2006): \"Suppression of Session Initiation Protocol (SIP) REFER Method Implicit Subscription\".\n[13]\tIETF RFC 4538 (June 2006): \"Request Authorization through Dialog Identification in the Session Initiation Protocol (SIP)\".\n[14]\tIETF RFC 3261 (June 2002): \"SIP: Session Initiation Protocol\".\n[15]\tIETF RFC 4575 (August 2006): \"A Session Initiation Protocol (SIP) Event Package for Conference State\".\n[16]\t3GPP TS 24.481: \"Mission Critical Services (MCS) group management Protocol specification\".\n[17]\tIETF RFC 4483 (May 2006): \"A Mechanism for Content Indirection in Session Initiation Protocol (SIP) Messages\".\n[18]\tIETF RFC 3428 (December 2002): \"Session Initiation Protocol (SIP) Extension for Instant Messaging\".\n[19]\tIETF RFC 4964 (October 2007): \"The P-Answer-State Header Extension to the Session Initiation Protocol for the Open Mobile Alliance Push-to-talk over Cellular\".\n[20]\tIETF RFC 5318 (December 2008): \"The Session Initiation Protocol (SIP) P-Refused-URI-List Private-Header (P-Header)\".\n[21]\tIETF RFC 3903 (October 2004): \"Session Initiation Protocol (SIP) Extension for Event State Publication\".\n[22]\tIETF RFC 4567 (July 2006): \"Key Management Extensions for Session Description Protocol (SDP) and Real Time Streaming Protocol (RTSP)\".\n[23]\tIETF RFC 8101 \"IANA Registration of New Session Initiation Protocol (SIP) Resource-Priority Namespace for Mission Critical Push To Talk service\".\n[24]\tIETF RFC 3856 (August 2004): \"A Presence Event Package for the Session Initiation Protocol (SIP)\".\n[25]\tIETF RFC 6665 (July 2012): \"SIP-Specific Event Notification\".\n[26]\tIETF RFC 6086 (January 2011): \"Session Initiation Protocol (SIP) INFO Method and Package Framework\".\n[27]\t3GPP TS 33.180: \"Security of the mission critical service\".\n[28]\t3GPP TS 23.283: \"Mission Critical Communication Interworking with Land Mobile Radio Systems; Stage 2\".\n[29]\t3GPP TS 24.379: \"Mission Critical Push To Talk (MCPTT) call control; Protocol specification\".\n[30]\t3GPP TS 24.282: \"Mission Critical Data (MCData) signalling control; Protocol specification\".\n[31]\t3GPP TS 29.380: \"Mission Critical Push To Talk (MCPTT) media plane control interworking with LMR systems\".\n[32]\tIETF RFC 3986: \"Uniform Resource Identifier (URI): Generic Syntax\".\n[33]\t3GPP TS 29.582: \"Mission Critical Data (MCData) interworking with LMR systems\".\n[34]\t3GPP TS 24.484: \"Mission Critical Services (MCS) configuration management Protocol specification\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905",
        "ts_23.379",
        "ts_24.229",
        "ts_24.380",
        "ts_24.481",
        "ts_33.180",
        "ts_23.283",
        "ts_24.379",
        "ts_24.282",
        "ts_29.380",
        "ts_29.582",
        "ts_24.484"
      ]
    },
    {
      "chunk_id": "ts_29.379_3.1",
      "section_id": "3.1",
      "section_title": "Terms",
      "content": "For the purposes of the present document, the terms given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].\nIWF performing the controlling role: an IWF role in which the IWF interacts with MCPTT participating functions and MCPTT non-controlling functions across the IWF-1 interface.\nIWF performing the non-controlling role: an IWF role in which the IWF interacts with MCPTT participating functions and MCPTT controlling functions across the IWF-1 interface\nIWF performing the participating role: an IWF role in which the IWF interacts with MCPTT controlling functions and MCPTT non-controlling functions across the IWF-1 interface.\nParticipant homed in the IWF: same as \"User homed in the IWF\".\nUser homed in the IWF: A user represented by an MCPTT ID in the IWF with the same domain as the IWF.\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.283 [28] apply:\nInterworking Function (IWF)",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905",
        "ts_23.283"
      ]
    },
    {
      "chunk_id": "ts_29.379_3.2",
      "section_id": "3.2",
      "section_title": "Abbreviations",
      "content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\nIWF\tInterWorking Function\nKMS\tKey Management Service\nLMR\tLand Mobile Radio\nMC\tMission Critical\nMCPTT\tMission Critical Push To Talk\nURI\tUniform Resource Identifier",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905"
      ]
    },
    {
      "chunk_id": "ts_29.379_4.1",
      "section_id": "4.1",
      "section_title": "IWF overview",
      "content": "The IWF interacts with the controlling, participating and non-controlling MCPTT functions of an MCPTT system as a peer system via the IWF-1 interface and with MCData systems via the IWF-2 interface. The IWF supports a subset of the client-server group management interfaces defined in 3GPP TS 24.481 [16] required to support IWF-3, with the exceptions and additions defined in the present document.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.481"
      ]
    },
    {
      "chunk_id": "ts_29.379_4.2.1",
      "section_id": "4.2.1",
      "section_title": "General",
      "content": "An IWF can include a free text string in a SIP response to a SIP request. When the IWF includes a text string in a response to a SIP INVITE request the text string is included in a Warning header field as specified in IETF RFC 3261 [14]. The IWF includes the Warning code set to 399 (miscellaneous warning) and includes the host name set to the host name of the IWF.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_4.2.2",
      "section_id": "4.2.2",
      "section_title": "Warning texts",
      "content": "Warning texts specified in table 4.2.2-1 for interworking are used, in conjunction with existing warning texts as specified in 3GPP TS 24.379 [29].\nTable 4.2.2-1: Warning texts for interworking defined for the Warning header field\nCode\nExplanatory text\nDescription\n300\nLMR end-to-end encryption not permitted\nThe call is not allowed to use LMR end-to-end encryption.\n301\nLMR end-to-end encryption required\nThe call is required to use LMR end-to-end encryption.\n302\nLMR codec required\nThe call requires an LMR defined codec to be used.",
      "chunk_type": "general",
      "cross_references": [
        "table_4.2.2-1",
        "ts_24.379_table_4.2.2-1",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_4.3",
      "section_id": "4.3",
      "section_title": "MCPTT priority calls and alerts",
      "content": "Clauses 4.6.1, 4.6.2, 4.6.3 and 4.6.4 in 3GPP TS 24.379 [29] describe the aspects and states that are key in managing priority calls and alerts.\nThe IWF manages the states on behalf of its homed users. For states that are managed by clients, the IWF manages an instance of the state for each client homed in the IWF.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_4.4",
      "section_id": "4.4",
      "section_title": "Media security at the IWF",
      "content": "With respect to LMR interworking, the IWF provides the interfaces as specified in 3GPP TS 23.283 [28] and 3GPP TS 33.180 [27] to key management and group management capabilities of the LMR system.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.283",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.379_4.5",
      "section_id": "4.5",
      "section_title": "Broadcast group calls",
      "content": "See 3GPP TS 24.379 [29] for a description of broadcast group calls.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_5.1",
      "section_id": "5.1",
      "section_title": "General",
      "content": "An IWF can perform the controlling role for group calls and private calls. The controlling role serves as the group home, managing the floor and tracking group affiliations.\nAn IWF can perform the participating role for group calls and private calls. The participating role serves as the user home, checking user authorizations and forwarding signalling and media between the controlling role and clients.\nAn IWF can perform a non-controlling role for temporary group calls involving groups from multiple MCPTT systems. The non-controlling role serves as the controlling role for a constituent group of a regroup and coordinates with the controlling server of the temporary group.\nAn IWF performing the participating role can serve an originating LMR user. How the IWF serves LMR users is out of scope of 3GPP.\nAn IWF performing the participating role can serve a terminating LMR user. How the IWF serves LMR users is out of scope of 3GPP.\nThe same IWF can perform the participating role and controlling role for the same group session.\nThe same IWF can perform the participating role and non-controlling role for the same group session.\nWhen referring to the procedures in the present document for the IWF acting in a participating role, the term, \"IWF performing the participating role\" is used.\nWhen referring to the procedures in the present document for the IWF acting in a controlling role, the term \"IWF performing the controlling role\" is used.\nWhen referring to the procedures in the present document for the IWF acting in a non-controlling role for a group call, the term \" IWF performing the non-controlling role \" is used.\nTo be compliant with the procedures in the present document, an IWF shall:\n-\tsupport the IWF procedures defined in 3GPP TS 23.283 [28];\n-\tgenerate SDP offer and SDP answer in accordance with 3GPP TS 24.229 [3] and clause 6.3 of 3GPP TS 24.379 [29];\n-\timplement the role of a centralised floor control server and implement the on-network procedures for floor control as specified in 3GPP TS 29.380 [31];\n-\tfor registration and service authorisation, IWF procedures are out of scope of the present document;\n-\tfor affiliation of users hosted in the MCPTT system, implement the procedures specified in the present document; for LMR users, the affiliation process is out of scope of the present document;\n-\tfor group call functionality (including broadcast, emergency and imminent peril), implement the procedures specified in the present document; and\n-\tfor private call functionality (including emergency), implement the procedures specified in the present document.\nTo be compliant with the procedures in the present document requiring the distribution of private call keying material between MCPTT clients as specified in 3GPP TS 33.180 [27], an IWF shall behave as an encryption endpoint on behalf of its LMR users.\nNOTE:\tA scenario with the IWF acting as an encryption endpoint is not end to end encryption. End to end encryption with LMR users is out of scope of the present document, but some tools are provided to allow end to end encryption to be defined outside of 3GPP.\nTo be compliant with the procedures for confidentiality protection of XML elements in the present document, the IWF shall implement the procedures specified in clause 6.6.2 of 3GPP TS 24.379 [29].\nTo be compliant with the procedures for integrity protection of XML MIME bodies in the present document, the IWF shall implement the procedures specified in clause 6.6.3 of 3GPP TS 24.379 [29].\nTo be compliant with the procedures for obtaining information on a group homed in the MCPTT system, the IWF shall implement the procedures of the group management client specified in 3GPP TS 24.481 [16].\nTo be compliant with the procedures for obtaining information on an MCPTT user homed in the MCPTT system, the IWF shall obtain the MCPTT user profile described in 3GPP TS 24.484 [34].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.229_clause_6.3",
        "ts_24.379_clause_6.6.2",
        "ts_24.379_clause_6.6.3",
        "ts_24.379_clause_6.3",
        "ts_23.283",
        "ts_24.229",
        "ts_24.379",
        "ts_29.380",
        "ts_33.180",
        "ts_24.481",
        "ts_24.484"
      ]
    },
    {
      "chunk_id": "ts_29.379_5.2",
      "section_id": "5.2",
      "section_title": "Functional connectivity models",
      "content": "The following figures give an overview of the connectivity between the IWF and the MCPTT system with the IWF in different roles as described in clause 5.1.\nNOTE:\tThe MCPTT functional roles are not defined here. They are defined in 3GPP TS 24.379 [29] but are shown here to illustrate the relationship with the IWF.\nFigure 5.2-1 shows the role of the IWF relative to an MCPTT system. Here, the controlling MCPTT function is in the MCPTT system and the called user is homed in the IWF. The IWF plays the role of the terminating participating function.\nFigure 5.2-1: Relationship between the IWF and an MCPTT system with the controlling MCPTT function in the MCPTT system\nFigure 5.2-2 shows the role of the IWF relative to an MCPTT system. Here, the controlling MCPTT function is in the MCPTT system and the calling user is homed in the IWF. The IWF plays the role of the originating participating function.\nFigure 5.2-2: Relationship between the IWF and an MCPTT system with the controlling MCPTT function in the MCPTT system\nFigure 5.2-3 shows the role of the IWF relative to an MCPTT system. Here, the controlling MCPTT function is in the IWF and the called user is homed in the IWF. The IWF plays the role of the controlling function.\nFigure 5.2-3: Relationship between the IWF and an MCPTT system with the controlling MCPTT function in the IWF\nFigure 5.2-4 shows the role of the IWF relative to an MCPTT system. Here, the controlling MCPTT function is in the IWF and the calling user is homed in the IWF. The IWF plays the role of the controlling function.\nFigure 5.2-4: Relationship between the IWF and an MCPTT system with the controlling MCPTT function in the IWF\nFigure 5.2-5 shows the role of the IWF relative to an MCPTT system. Here, the controlling MCPTT function is in the MCPTT system, the non-controlling function is in the IWF and the called user is homed in the IWF. The IWF plays the role of the non-controlling function.\nFigure 5.2-5: Relationship between the IWF and an MCPTT system with the controlling MCPTT function in the MCPTT system and a non-controlling function in the IWF\nFigure 5.2-6 shows the role of the IWF relative to an MCPTT system. Here, the controlling MCPTT function is in the MCPTT system, the non-controlling function is in the IWF and the calling user is homed in the IWF. The IWF plays the role of the non-controlling function.\nFigure 5.2-6: Relationship between the IWF and an MCPTT system with the controlling MCPTT function in the MCPTT system and a non-controlling function in the IWF\nOther functional connectivity models can exist.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.1",
        "figure_5.2-1",
        "figure_5.2-2",
        "figure_5.2-3",
        "figure_5.2-4",
        "figure_5.2-5",
        "figure_5.2-6",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.1.1",
      "section_id": "6.1.1",
      "section_title": "SDP offer generation",
      "content": "The SDP offer shall contain only one SDP media-level section for offered speech according to 3GPP TS 24.229 [3] and, if floor control shall be used during the session, shall contain one SDP media-level section for a media-floor control entity according to 3GPP TS 29.380 [31].\nWhen composing an SDP offer according to 3GPP TS 24.229 [3] the IWF:\n1)\tshall set the IP address of the IWF for the offered speech media stream and, if floor control shall be used, for the offered media-floor control entity;\n2)\tshall include an \"m=audio\" media-level section for the MCPTT media stream consisting of:\na)\tthe port number for the media stream selected;\nb)\tthe codec(s) and media parameters and attributes with the following clarification:\ni)\tif the IWF is initiating a call to a group identity;\nii)\tif the <preferred-voice-encodings> element is present in the group document as specified in 3GPP TS 24.481 [16] containing an <encoding> element with a \"name\" attribute; and\niii)\tif the IWF supports the encoding name indicated in the value of the \"name\" attribute;\nthen the IWF shall insert the value of the \"name\" attribute in the <encoding name> field of the \"a=rtpmap\" attribute as defined in IETF RFC 4566 [8]; and\nc)\t\"i=\" field set to \"speech\" according to 3GPP TS 24.229 [3];\n3)\tif floor control shall be used during the session, shall include an \"m=application\" media-level section as specified in 3GPP TS 29.380 [31] clause 12 for a media-floor control entity, consisting of:\na)\tthe port number for the media-floor control entity selected as specified in 3GPP TS 29.380 [31]; and\nb)\tthe 'fmtp' attributes as specified in 3GPP TS 29.380 [31] clause 14; and\n4)\tif media security is required between the MCPTT client and the IWF for a private call, shall include the MIKEY-SAKKE I_MESSAGE in an \"a=key-mgmt\" attribute as a \"mikey\" attribute value in the SDP offer as specified in IETF RFC 4567 [22].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.380_clause_12",
        "ts_29.380_clause_14",
        "ts_24.229",
        "ts_29.380",
        "ts_24.481"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.1.2",
      "section_id": "6.1.2",
      "section_title": "SDP answer generation",
      "content": "When the IWF receives an initial SDP offer for an MCPTT session, the IWF shall process the SDP offer and shall compose an SDP answer according to 3GPP TS 24.229 [3].\nWhen composing an SDP answer, the IWF:\n1)\tshall accept the speech media stream in the SDP offer;\n2)\tshall set the IP address of the IWF for the accepted speech media stream and, if included in the SDP offer, for the accepted media-floor control entity;\nNOTE:\tIf the IWF is behind a NAT the IP address and port included in the SDP answer can be a different IP address and port than the actual IP address and port of the IWF depending on the NAT traversal method used by the SIP/IP Core.\n3)\tshall include an \"m=audio\" media-level section for the accepted MCPTT speech media stream consisting of:\na)\tthe port number for the media stream;\nb)\tmedia-level attributes as specified in 3GPP TS 24.229 [3];\nc)\tif the \"a=recvonly\" attribute is present in the SDP offer, include an \"a=sendonly\" attribute;\nd)\tif the \"a=sendonly\" attribute is present in the SDP offer, include an \"a=recvonly\" attribute; and\ne)\t\"i=\" field set to \"speech\" according to 3GPP TS 24.229 [3]; and\n4)\tif included in the SDP offer, shall include the media-level section of the offered media-floor control entity consisting of:\na)\tan \"m=application\" media-level section as specified in 3GPP TS 29.380 [31] clause 12; and\nb)\t'fmtp' attributes as specified in 3GPP TS 29.380 [31] clause 14.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.380_clause_12",
        "ts_29.380_clause_14",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.2.1",
      "section_id": "6.2.1",
      "section_title": "Automatic commencement mode for private calls",
      "content": "When performing the automatic commencement mode procedures, the IWF performing the participating role:\n1)\tshall accept the SIP INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [3];\n2)\tshall include the option tag \"timer\" in a Require header field of the SIP 200 (OK) response;\n3)\tshall include the g.3gpp.mcptt media feature tag in the Contact header field of the SIP 200 (OK) response;\n4)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" in the Contact header field of the SIP 200 (OK) response;\n5)\tshall include the Session-Expires header field in the SIP 200 (OK) response and start the SIP session timer according to IETF RFC 4028 [6]. The \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\n6)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [3] with the clarifications given in clause 6.1.2;\n7)\tshall send the SIP 200 (OK) response towards the MCPTT server according to rules and procedures of 3GPP TS 24.229 [3];\n8)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31] clause 6.2.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.1.2",
        "ts_29.380_clause_6.2",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.2.2",
      "section_id": "6.2.2",
      "section_title": "Manual commencement mode for private calls",
      "content": "When performing the manual commencement mode procedures:\n1)\tif the user homed in the IWF declines the MCPTT session invitation the IWF performing the participating role shall send a SIP 480 (Temporarily Unavailable) response towards the MCPTT controlling function with the warning text set to: \"110 user declined the call invitation\" in a Warning header field as specified in clause 4.4, and not continue with the rest of the steps in this clause.\nThe IWF performing the participating role:\n1)\tshall accept the SIP INVITE request and generate a SIP 180 (Ringing) response according to rules and procedures of 3GPP TS 24.229 [3];\n2)\tshall include the option tag \"timer\" in a Require header field of the SIP 180 (Ringing) response;\n3)\tshall include the g.3gpp.mcptt media feature tag in the Contact header field of the SIP 180 (Ringing) response;\n4)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" in the Contact header field of the SIP 180 (Ringing) response; and\n5)\tshall send the SIP 180 (Ringing) response to the controlling MCPTT function.\nWhen sending the SIP 200 (OK) response to the incoming SIP INVITE request, the IWF performing the participating role shall follow the procedures in clause 6.2.1.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_4.4",
        "clause_6.2.1",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.3",
      "section_id": "6.3",
      "section_title": "Receiving an MCPTT session release request",
      "content": "Upon receiving a SIP BYE request, the IWF:\n1)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\n2)\tshall send a SIP 200 (OK) response towards the MCPTT server according to 3GPP TS 24.229 [3].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.380",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.1.1",
      "section_id": "6.4.1.1",
      "section_title": "SIP INVITE request for originating MCPTT emergency group calls",
      "content": "This clause is referenced from other procedures.\nWhen the MCPTT emergency state is set, the IWF performing the participating role:\n1)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body in the SIP INVITE request, an <emergency-ind> element set to \"true\" and if the MCPTT emergency group call state is set to \"MEGC 1: emergency-gc-capable\", shall set the MCPTT emergency group call state to \"MEGC 2: emergency-call-requested\";\n2)\tif the IWF has determined that an MCPTT emergency alert is to be sent, and the MCPTT emergency alert state is set to \"MEA 1: no-alert\", shall:\na)\tset the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to \"true\" and set the MCPTT emergency alert state to \"MEA 2: emergency-alert-confirm-pending\"; and\nb)\tinclude in the SIP INVITE request the specific location information for MCPTT emergency alert as specified in clause 6.5.1;\n3)\tif the IWF has determined that an MCPTT emergency alert is not to be sent and the MCPTT emergency alert state is set to \"MEA 1: no-alert\", shall set the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to \"false\"; and\n4)\tif the MCPTT client emergency group state of the user homed in the IWF of the group is set to a value other than \"MEG 2: in-progress\" set the MCPTT client emergency group state of the user homed in the IWF of the MCPTT group to \"MEG 4: confirm-pending\".\nNOTE 1:\tThis is the case of a user homed in the IWF already being in the MCPTT emergency state it initiated previously while originating an MCPTT emergency group call or MCPTT emergency alert. All group calls the user homed in the IWF originates while in MCPTT emergency state will be MCPTT emergency group calls.\nWhen the MCPTT emergency state is clear and the MCPTT emergency group call state is set to \"MEGC 1: emergency-gc-capable\" and the IWF determines that the request for MCPTT emergency group call is authorized by local policy, the IWF performing the participating role shall set the MCPTT emergency state and perform the following actions:\n1)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body in the SIP INVITE request an <emergency-ind> element set to \"true\" and set the MCPTT emergency group call state to \"MEGC 2: emergency-call-requested\" state;\n2)\tif the user homed in the IWF has also requested an MCPTT emergency alert to be sent, shall:\na)\tinclude in the application/vnd.3gpp.mcptt-info+xml MIME body the <alert-ind> element set to \"true\" and set the MCPTT emergency alert state to \"MEA 2: emergency-alert-confirm-pending\"; and\nb)\tinclude in the SIP INVITE request the specific location information, if available, for MCPTT emergency alert as specified in clause 6.5.1;\n3)\tif the IWF has determined that an MCPTT emergency alert is not to be sent, shall set the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to \"false\"; and\n4)\tif the MCPTT client emergency group state of the user homed in the IWF of the group is set to a value other than \"MEG 2: in-progress\" shall set the MCPTT client emergency group state of the user homed in the IWF of the MCPTT group to \"MEG 4: confirm-pending\".\nNOTE 2:\tThis is the case of an initial MCPTT emergency group call and optionally an MCPTT emergency alert being sent. As the MCPTT emergency state is not sent, there is no MCPTT emergency alert outstanding.\nNOTE 3:\tAn MCPTT group call originated by an affiliated member of an MCPTT group which is in an in-progress emergency state (as tracked on the MCPTT client by the MCPTT client emergency group state) but is not in an MCPTT emergency state of their own will also be an MCPTT emergency group call. The <emergency-ind> and <alert-ind> elements of the application/vnd.3gpp.mcptt-info+xml MIME body do not need to be included in this case and hence no action needs to be taken in this clause.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.5.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.1.2",
      "section_id": "6.4.1.2",
      "section_title": "Resource-Priority header field for MCPTT emergency group calls",
      "content": "This clause is referenced from other procedures.\nIf the MCPTT emergency group call state is set to either \"MEGC 2: emergency-call-requested\" or \"MEGC 3: emergency-call-granted\", or the MCPTT client emergency group state of the group is set to \"MEG 2: in-progress\", the IWF performing the participating role shall include in the SIP INVITE request a Resource-Priority header field populated with the values for an MCPTT emergency group call as specified in clause 6.4.1.11.\nNOTE:\tThe IWF performing the participating role ideally would not need to maintain knowledge of the in-progress emergency state of the group (as tracked for the client by the MCPTT client emergency group state by the IWF performing the participating role) but can use this knowledge to provide a Resource-Priority header field set to emergency level priority, which starts the infrastructure priority adjustment process sooner than otherwise would be the case.\nIf the MCPTT client emergency group state of the group is \"no-emergency\" or \"cancel-pending\", the IWF performing the participating role shall include in the SIP INVITE request a Resource-Priority header field populated with the values for a normal MCPTT group call as specified in clause 6.4.1.11.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.4.1.11"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.1.3",
      "section_id": "6.4.1.3",
      "section_title": "SIP re-INVITE request for cancelling MCPTT in-progress emergency group state",
      "content": "This clause is referenced from other procedures.\nIf the MCPTT emergency group call state is set to \"MEGC 3: emergency-call-granted\" and the MCPTT emergency alert state is set to \"MEA 1: no-alert\", the IWF performing the participating role shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [3] with the clarifications given below.\nThe IWF performing the participating role:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcptt-info+xml MIME body as defined in 3GPP TS 24.379 [29], clause F.1 with the <emergency-ind> element set to \"false\";\n2)\tshall clear the MCPTT emergency state; and\n3)\tshall set MCPTT emergency group state of the MCPTT group to \"MEG 3: cancel-pending\".\nNOTE 1:\tThis is the case of a user homed in the IWF who has initiated an MCPTT emergency group call and wants to cancel it.\nIf the MCPTT emergency group call state is set to \"MEGC 3: emergency-call-granted\" and the MCPTT emergency alert state is set to a value other than \"MEA 1: no-alert\" and only the MCPTT emergency group call is to be cancelled, the IWF performing the participating role:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcptt-info+xml MIME body as defined in 3GPP TS 24.379 [29], clause F.1 with the <emergency-ind> element set to \"false\"; and\n2)\tshall set the MCPTT emergency group state of the MCPTT group to \"MEG 3: cancel-pending\".\nNOTE 2:\tThis is the case of a user homed in the IWF that has initiated both an MCPTT emergency group call and an MCPTT emergency alert and wishes to only cancel the MCPTT emergency group call. This leaves the MCPTT emergency state set.\nIf the MCPTT emergency group call state is set to \"MEGC 3: emergency-call-granted\" and the MCPTT emergency alert state is set to a value other than \"MEA 1: no-alert\" and the user homed in the IWF has indicated that the MCPTT emergency alert on the MCPTT group should be cancelled in addition to the MCPTT emergency group call, the IWF performing the participating role:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcptt-info+xml MIME body as defined in 3GPP TS 24.379 [29], clause F.1 with the <emergency-ind> element set to \"false\";\n2)\tshall:\na)\tinclude in the application/vnd.3gpp.mcptt-info+xml MIME body an <alert-ind> element set to \"false\";\nb)\tset the MCPTT emergency alert state to \"MEA 4: Emergency-alert-cancel-pending\"; and\nc)\tclear the MCPTT emergency state; and\n3)\tshall set the MCPTT emergency group state of the MCPTT group to \"MEG 3: cancel-pending\".\nNOTE 3:\tThis is the case of a user homed in the IWF that has initiated both an MCPTT emergency group call and an MCPTT emergency alert and wishes to cancel both.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.1.4",
      "section_id": "6.4.1.4",
      "section_title": "Receiving a SIP 2xx response to a SIP request for a priority call",
      "content": "In the procedures in this clause, a priority group call refers to an MCPTT emergency group call or an MCPTT imminent peril group call.\nOn receiving a SIP 2xx response to a SIP request for a priority group call, the IWF:\n1)\tif the MCPTT emergency group call state is set to \"MEGC 2: emergency-call-requested\" or \"MEGC 3: emergency-call-granted\":\na)\tshall set the emergency group state of the user homed in the IWF of the group to \"MEG 2: in-progress\" if it was not already set;\nb)\tif the MCPTT emergency alert state of the user homed in the IWF is set to \"MEA 2: emergency-alert-confirm-pending\" and the SIP 2xx response to the SIP request for a priority group call does not contain a Warning header field as specified in TS 24.379 [29] clause 4.4 with the warning text containing the mcptt-warn-code set to \"149\", shall set the MCPTT emergency alert state of the user homed in the IWF to \"MEA 3: emergency-alert-initiated;\nc)\tshall set the MCPTT emergency group call state to \"MEGC 3: emergency-call-granted\"; and\nd)\tshall set the MCPTT imminent peril group call state to \"MIGC 1: imminent-peril-capable\" and the MCPTT imminent peril group state to \"MIG 1: no-imminent-peril\"; or\n2)\tif the MCPTT imminent peril group call state is set to \"MIGC 2: imminent-peril-call-requested\" or \"MIGC 3: imminent-peril-call-granted\" and the SIP 2xx response to the SIP request for an imminent peril group call does not contain a Warning header field as specified in TS 24.379 [29] clause 4.4 with the warning text containing the mcptt-warn-code set to \"149\":\na)\tset the MCPTT imminent peril group call state to \"MIGC 3: imminent-peril-call-granted\"; and\nb)\tset the MCPTT imminent peril group state to \"MIG 2: in-progress\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_4.4",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.1.5",
      "section_id": "6.4.1.5",
      "section_title": "Receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to a SIP request for a priority group call",
      "content": "In the procedures in this clause, a priority group call refers to an MCPTT emergency group call or an MCPTT imminent peril group call.\nUpon receiving a SIP 4xx response, SIP 5xx response or a SIP 6xx response to a SIP request for a priority group call the IWF:\n1)\tif the MCPTT emergency group call state is set to \"MEGC 2: emergency-call-requested\" or \"MEGC 3: emergency-call-granted\":\na)\tshall set the MCPTT emergency group call state to \"MEGC 1: emergency-gc-capable\";\nb)\tif the emergency group state of the user homed in the IWF of the group is \"MEG 4: confirm-pending\" shall set the emergency group state of the user homed in the IWF of the group to \"MEG 1: no-emergency\"; and\nc)\tif the sent SIP request for a priority group call contained an application/vnd.3gpp.mcptt-info+xml MIME body with an <alert-ind> element set to a value of \"true\", shall set the MCPTT emergency alert state of the user homed in the IWF to \"MEA 1: \"no-alert\"; and\n2)\tif the MCPTT imminent peril group call state is set to \"MIGC 2: imminent-peril-call-requested\" or \"MIGC 3: imminent-peril-call-granted\":\na)\tshall set the MCPTT imminent peril group state to \"MIG 1: no-imminent-peril\"; and\nb)\tshall set the MCPTT imminent peril group call state to \"MIGC 1: imminent-peril-gc-capable\".",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_6.4.1.6",
      "section_id": "6.4.1.6",
      "section_title": "SIP request for originating MCPTT imminent peril group calls",
      "content": "This clause is referenced from other procedures.\nWhen the IWF performing the participating role determines to originate an MCPTT imminent peril group call, the IWF performing the participating role:\n1)\tif the client homed in the IWF's imminent peril group state is set to \"MIGC 1: imminent-peril-gc-capable\" and the in-progress emergency state of the group is set to a value of \"false\":\na)\tshall include in the SIP request an application/vnd.3gpp.mcptt-info+xml MIME body as defined in 3GPP TS 24.379 [29], clause F.1 with the <imminentperil-ind> element set to \"true\" and set the MCPTT emergency group call state to \"MIGC 2: imminent-peril-call-requested\" state; and\nb)\tif the client homed in the IWF's imminent peril group state of the group is set to a value other than \"MIG 2: in-progress\" shall set the client homed in the IWF's emergency group state of the MCPTT group to \"MIG 4: confirm-pending\".\nNOTE:\tAn MCPTT group call originated by an affiliated member of an MCPTT group which is in an in-progress imminent peril state (as tracked on the client by the client imminent peril group state) will also have the priority associated with MCPTT imminent peril group calls. The <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info MIME body does not need to be included in this case, nor do any state changes result and hence no action needs to be taken in this clause.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.1.7",
      "section_id": "6.4.1.7",
      "section_title": "SIP re-INVITE request for cancelling MCPTT in-progress imminent peril group state",
      "content": "This clause is referenced from other procedures.\nIf the MCPTT imminent peril group call state is set to \"MIGC 3: imminent-peril-call-granted\" or the MCPTT imminent peril group state of the MCPTT group is set to \"MIG 2: in-progress\", the IWF shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [3] with the clarifications given below.\nThe IWF:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcptt-info+xml MIME body as defined in clause F.1 with the <imminentperil-ind> element set to \"false\"; and\n2)\tshall set MCPTT imminent peril group state of the MCPTT group to \"MIG 3: cancel-pending\".\nNOTE:\tThis is the case of a user who has initiated an MCPTT imminent peril group call and wants to cancel it, or another authorised member of the group who wishes to cancel the in-progress imminent peril state of the group.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.1.8",
      "section_id": "6.4.1.8",
      "section_title": "Resource-Priority header field for MCPTT imminent peril group calls",
      "content": "This clause is referenced from other procedures.\nWhen the MCPTT imminent peril group call state is set \"MIGC 2: imminent-peril-call-requested\" or \"MIGC 3: imminent-peril-call-granted\", or the client homed in the IWF's imminent peril state of the group is set to \"MIG 2: in-progress\", the IWF performing the participating role:\n1)\tshall include in the SIP INVITE request a Resource-Priority header field populated with the values for an MCPTT imminent peril group call as specified in clause 6.4.1.11.\nNOTE:\tThe IWF performing the participating role ideally would not need to maintain knowledge of the in-progress imminent peril state of the group (as tracked for the client by the client imminent peril group state) but can use this knowledge to provide a Resource-Priority header field set to imminent peril level priority, which starts the infrastructure priority adjustment process sooner than otherwise would be the case.\nWhen the MCPTT imminent peril group call state is set to \"MIGC 1: imminent-peril-gc-capable\" and the IWF performing the participating role determines that cancellation of the MCPTT imminent peril group call is authorized, or the MCPTT client imminent peril group state of the group is \"MIG 1: no-imminent-peril\" or \"MIG 3: cancel-pending\", the IWF performing the participating role:\n1)\tshall include in the SIP INVITE request a Resource-Priority header field populated with the values for a normal MCPTT group call as specified in clause 6.4.1.11.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.4.1.11"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.1.9",
      "section_id": "6.4.1.9",
      "section_title": "Receiving a SIP INFO request in the dialog of a SIP request for a priority group call",
      "content": "This clause is referenced from other procedures.\nUpon receiving a SIP INFO request within the dialog of the SIP request for a priority group call:\n-\twith the Info-Package header field containing the g.3gpp.mcptt-info package name;\n-\twith the application/vnd.3gpp.mcptt-info+xml MIME body associated with the info package according to IETF RFC 6086 [26]; and\n-\twith one or more of the <alert-ind>, <imminentperil-ind> and <emergency-ind> elements set in the application/vnd.3gpp.mcptt-info+xml MIME body;\nthe IWF:\n1)\tshall send a SIP 200 (OK) response to the SIP INFO request as specified in 3GPP TS 24.229 [3];\n2)\tif the MCPTT emergency group call state is set to \"MEGC 3: emergency-call-granted\":\na)\tif the MCPTT emergency alert state of the user homed in the IWF is set to \"MEA 2: emergency-alert-confirm-pending\":\ni)\tif the <alert-ind> element is set to a value of \"false\", shall set the MCPTT emergency alert state to \"MEA 1: no-alert\"; and\nii)\tif the <alert-ind> element is set to a value of \"true\", shall set the MCPTT emergency alert state of the user homed in the IWF to \"MEA 3: emergency-alert-initiated\";\n3)\tif the MCPTT imminent peril group call state is set to \"MIGC 2: imminent-peril-call-requested\" or \"MIGC 3: imminent-peril-call-granted\":\na)\tif the <imminentperil-ind> element is set to a value of \"false\" and an <emergency-ind> element is set to a value of \"true\", shall:\ni)\tset the MCPTT imminent peril group state to \"MIG 1: no-imminent-peril\";\nii)\tset the MCPTT imminent peril group call state to \"MIGC 1: imminent-peril-capable\"; and\niii)\tset the emergency group state of the user homed in the IWF of the group to \"MEG 2: in-progress\"; and\nNOTE 1:\tThis is the case of an IWF attempting to make an imminent peril group call when the group is in an in-progress emergency group state. The IWF will then receive a notification that the imminent peril call request was denied, however the IWF will be participating at the emergency level priority of the group.\nNOTE 2:\tthe emergency group state of the user homed in the IWF above is the view of the in-progress emergency state of the group for each user homed in the IWF.\n4)\tif the SIP request for a priority group call sent by the IWF did not contain an <originated-by> element and if the MCPTT emergency alert state of the user homed in the IWF is set to \"MEA 4: Emergency-alert-cancel-pending\":\na)\tif the <alert-ind> element contained in the SIP INFO request is set to a value of \"true\", shall set the MCPTT emergency alert state of the user homed in the IWF to \"MEA 3: emergency-alert-initiated\"; and\nb)\tif the <alert-ind> element contained in the SIP INFO request is set to a value of \"false\", shall set the MCPTT emergency alert state of the user homed in the IWF to \"MEA 1: no-alert\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.1.10",
      "section_id": "6.4.1.10",
      "section_title": "SIP re-INVITE request for cancelling the in-progress emergency group state of a group by a third-party",
      "content": "This clause is referenced from other procedures.\nUpon the need to cancel an in-progress emergency group state of a group, the IWF performing the participating role shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [3] with the clarifications given below.\nThe IWF performing the participating role:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcptt-info+xml MIME body as defined in 3GPP TS 24.379 [29], clause F.1 with the <emergency-ind> element set to \"false\";\n2)\tshall set MCPTT emergency group state of the MCPTT group to \"MEG 3: cancel-pending\"; and\n3)\tif the MCPTT emergency alert on the MCPTT group originated by a MCPTT user is to be cancelled:\na)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body an <alert-ind> element set a value of \"false\"; and\nb)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body an <originated-by> element set to the MCPTT ID of the MCPTT user who originated the MCPTT emergency alert.\nNOTE:\tWhen an MCPTT emergency alert is cancelled by a user other than its originator, the <originated-by> element is needed to identify which MCPTT emergency alert is being cancelled, as more than one MCPTT user could have originated emergency alerts to the same group.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.1.11",
      "section_id": "6.4.1.11",
      "section_title": "Resource-Priority header field values",
      "content": "This clause is referenced from other procedures.\nThe IWF performing the participating role may populate the Resource-Priority header as described for the IWF performing the controlling role in clause 6.6.3.1.12.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.6.3.1.12"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.2.1",
      "section_id": "6.4.2.1",
      "section_title": "SIP request for originating MCPTT emergency private calls",
      "content": "This clause is referenced from other procedures.\nWhen the MCPTT emergency private call state is set to \"MEPC 1: emergency-pc-capable\", the IWF:\n1)\tshall set the MCPTT emergency state if not already set;\n2)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body in the SIP request an <emergency-ind> element set to \"true\" and set the MCPTT emergency private call state to \"MEPC 2: emergency-pc-requested\";\n3)\tif an MCPTT emergency alert is to be sent, shall:\na)\tinclude in the application/vnd.3gpp.mcptt-info+xml MIME body the <alert-ind> element set to \"true\" and set the MCPTT private emergency alert state to \"MPEA 2: emergency-alert-confirm-pending\"; and\nb)\tinclude in the SIP request the specific location information for MCPTT emergency alert as specified in clause 6.5.1;\n4)\tif the IWF has determined not to request an MCPTT emergency alert to be sent, shall set the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to \"false\"; and\n5)\tif the MCPTT emergency private priority state of this private call is set to a value other than \"MEPP 2: in-progress\" shall set the MCPTT emergency private priority state to \"MEPP 3: confirm-pending\".",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.5.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.2.2",
      "section_id": "6.4.2.2",
      "section_title": "Resource-Priority header field for MCPTT emergency private calls",
      "content": "This clause is referenced from other procedures.\nIf the MCPTT emergency private call state is set to either \"MEPC 2: emergency-pc-requested\" or \"MEPC 3: emergency-pc-granted\", or the MCPTT emergency private priority state of the call is set to \"MEPP 2: in-progress\", the IWF shall include in the SIP request a Resource-Priority header field populated with the values for an MCPTT emergency private call as specified in clause 6.4.1.11.\nNOTE:\tThe IWF ideally would not need to maintain knowledge of the in-progress emergency state of the call (as tracked on the MCPTT client by the MCPTT client emergency private state) but can use this knowledge to provide a Resource-Priority header field set to emergency level priority, which starts the infrastructure priority adjustment process sooner than otherwise would be the case.\nIf this is a request to cancel the MCPTT emergency private call and the MCPTT emergency private priority state of the private call is \"MEPP 1: no-emergency\" or \"MEPP 3: cancel-pending\", the IWF shall include in the SIP request a Resource-Priority header field populated with the values for a normal MCPTT private call as specified in clause 6.4.1.11.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.4.1.11"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.4.2.3",
      "section_id": "6.4.2.3",
      "section_title": "SIP re-INVITE request for cancelling MCPTT emergency private call state",
      "content": "This clause is referenced from other procedures.\nWhen the MCPTT emergency private call state is set to \"MEPC 3: emergency-pc-granted\" and the MCPTT emergency alert state is set to \"MPEA 1: no-alert\", the IWF performing the participating role shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [3] with the clarifications given below.\nThe IWF performing the participating role:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcptt-info+xml MIME body as defined in 3GPP TS 24.379 [29], 3GPP TS 24.379 [29], clause F.1 with the <emergency-ind> element set to \"false\";\n2)\tshall clear the MCPTT emergency state; and\n3)\tshall set MCPTT emergency private priority state of the MCPTT emergency private call to \"MEPP 3: cancel-pending\".\nNOTE 1:\tThis is the case where a private call is in emergency and the emergency is to be cancelled.\nWhen the MCPTT emergency private call state is set to \"MEPPC 3: emergency-pc-granted\" and the MCPTT emergency alert state is set to a value other than \"MPEA 1: no-alert\" and the IWF decides that only the MCPTT emergency private call should be cancelled, the IWF performing the participating role:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcptt-info+xml MIME body as defined in 3GPP TS 24.379 [29], 3GPP TS 24.379 [29], clause F.1 with the <emergency-ind> element set to \"false\"; and\n2)\tshall set the MCPTT emergency private priority state of the MCPTT emergency private call to \"MEPP 3: cancel-pending\";\nNOTE 2:\tThis is the case where both an MCPTT emergency private call and an MCPTT emergency alert have been initiated and only the MCPTT emergency on the private call is to be cancelled. This leaves the MCPTT emergency state set.\nWhen the MCPTT emergency private call state is set to \"MEPC 3: emergency-pc-granted\" and the MCPTT emergency alert state is set to a value other than \"MPEA 1: no-alert\" and the IWF performing the participating role has indicated that the MCPTT emergency alert on the MCPTT private call should be cancelled in addition to the MCPTT emergency private call, the IWF performing the participating role:\n1)\tshall include in the SIP re-INVITE request an application/vnd.3gpp.mcptt-info+xml MIME body as defined in 3GPP TS 24.379 [29], clause F.1 with the <emergency-ind> element set to \"false\";\n2)\tshall:\na)\tinclude in the application/vnd.3gpp.mcptt-info+xml MIME body an <alert-ind> element set to \"false\"; and\nb)\tset the MCPTT private emergency alert state to \"MPEA 4: emergency-alert-cancel-pending\";\n3)\tshall set the MCPTT emergency private priority state of the MCPTT to \"MEPP 3: cancel-pending\"; and\n4)\tshall clear the MCPTT emergency state.\nNOTE 3:\tThis is the case where both an MCPTT emergency private call and an MCPTT emergency alert have been initiated and both are to be cancelled.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.5.1",
      "section_id": "6.5.1",
      "section_title": "Location information for location reporting",
      "content": "This procedure is initiated by the IWF performing the participating role when it is including location report information as part of a SIP request containing an MCPTT emergency alert.\nNOTE 1:\tLocation triggers are out of scope of the present document.\nThe IWF performing the participating role:\n1)\tshall include an application/vnd.3gpp.mcptt-location-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.3 with a <Report> element included in the <location-info> root element;\n2)\tshall set the <ReportType> element of the <Report> element to a value of \"Emergency\"; and\n3)\tshall include in the <CurrentLocation> element of the <Report> element of the application/vnd.3gpp.mcptt-location-info+xml MIME body a <CurrentCoordinate> element populated as specified in 3GPP TS 24.379 [29], clause F.3.3.\nNOTE 2:\tAccording to local policy, additional location information elements specified in 3GPP TS 24.379 [29], clause F.3.3 can be included in the <CurrentLocation> element.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.1.1",
      "section_id": "6.6.1.1",
      "section_title": "SIP INVITE request",
      "content": "The IWF needs to distinguish between the following initial SIP INVITE requests for originations and terminations:\n-\tSIP INVITE requests routed to the IWF performing the participating role as a result of processing initial filter criteria at the S-CSCF in accordance with the termination procedures as specified in 3GPP TS 24.229 [3] and the Request-URI contains a PSI of the IWF performing the terminating participating role. Such requests are known as \"SIP INVITE request for terminating participating MCPTT function\" in the procedures in the present document;\n-\tSIP INVITE requests routed to the IWF performing the controlling role as a result of PSI routing on the originating side in accordance with the originating procedures as specified in 3GPP TS 24.229 [3], or as a result of direct PSI routing, in accordance with the termination procedures as specified in 3GPP TS 24.229 [3], the Request-URI is set to a public service identity for MCPTT private call and the Contact header field does not contain the isfocus media feature tag specified in IETF RFC 3840 [9]. Such requests are known as \"SIP INVITE request for controlling MCPTT function of a private call\" in the procedures in the present document;\n-\tSIP INVITE requests routed to the IWF performing the controlling role as a result of PSI routing on the originating side in accordance with the originating procedures as specified in 3GPP TS 24.229 [3], or as a result of direct PSI routing, in accordance with the termination procedures as specified in 3GPP TS 24.229 [3], the Request-URI is set to a public service identity serving an MCPTT group and the Contact header field does not contain the isfocus media feature tag specified in IETF RFC 3840 [9]. Such requests are known as \"SIP INVITE request for controlling MCPTT function of an MCPTT group\" in the procedures in the present document; and\n-\tSIP INVITE requests routed to the IWF performing the non-controlling role of an MCPTT group as a result of direct PSI routing, in accordance with the termination procedures as specified in 3GPP TS 24.229 [3], the Request-URI is set to a public service identity serving an MCPTT group and the Contact header field contains the isfocus media feature tag specified in IETF RFC 3840 [9]; Such requests are known as \"SIP INVITE request for non-controlling MCPTT function of an MCPTT group\" in the procedures in the present document.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.1.2",
      "section_id": "6.6.1.2",
      "section_title": "SIP MESSAGE request",
      "content": "The IWF needs to distinguish between the following SIP MESSAGE request for originations and terminations:\n-\tSIP MESSAGE requests routed to the IWF performing the controlling role and containing a Content-Type header field set to \"application/vnd.3gpp.mcptt-info+xml\" and includes an XML body containing a <mcpttinfo> root element with a <mcptt-Params> element containing an <anyExt> element with the <request-type> element set to a value of \"remotely-initiated-group-call-request\". Such requests are known as \"SIP MESSAGE request for remotely initiated group call request for controlling MCPTT function\";\n-\tSIP MESSAGE requests routed to the IWF performing the controlling role and containing a Content-Type header field set to \"application/vnd.3gpp.mcptt-info+xml\" and includes an XML body containing a <mcpttinfo> root element with a <mcptt-Params> element containing an <anyExt> element with the <response-type> element set to a value of \"remotely-initiated-group-call-response\". Such requests are known as \"SIP MESSAGE request for remotely initiated group call response for controlling MCPTT function\";\n-\tSIP MESSAGE requests routed to the IWF performing the terminating participating role as a result of initial filter criteria with the Request-URI set to the public service identity of the IWF performing the terminating participating role and containing a Content-Type header field set to \"application/vnd.3gpp.mcptt-info+xml\" and includes an XML body containing a <mcpttinfo> root element with a <mcptt-Params> element containing an <anyExt> element with the <request-type> element set to a value of \"remotely-initiated-group-call-request\" or with the <response-type> element set to a value of \"remotely-initiated-group-call-response\". Such requests are known as \"SIP MESSAGE request for remotely initiated group call for terminating participating MCPTT function\";\n-\tSIP MESSAGE requests routed to the IWF performing the terminating participating role with the Request-URI set to the public service identity of the IWF and containing a Content-Type header field set to \"application/vnd.3gpp.mcptt-info+xml\" and includes an XML body containing a <mcpttinfo> root element containing a <mcptt-Params> element containing an <emergency-ind> element or an <alert-ind> element. Such requests are known as \"SIP MESSAGE request for emergency notification for terminating participating MCPTT function\" in the procedures in the present document; and\n-\tSIP MESSAGE requests routed to the IWF performing the controlling role with the Request-URI set to the public service identity of the IWF and containing a Content-Type header field set to \"application/vnd.3gpp.mcptt-info+xml\" and includes an XML body containing a <mcpttinfo> root element containing a <mcptt-Params> element containing an <emergency-ind> element or an <alert-ind> element. Such requests are known as \"SIP MESSAGE request for emergency notification for controlling MCPTT function\" in the procedures in the present document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_6.6.1.3",
      "section_id": "6.6.1.3",
      "section_title": "SIP SUBSCRIBE request",
      "content": "The IWF needs to distinguish between the following SIP SUBSCRIBE requests for originations and terminations:\n-\tSIP SUBSCRIBE requests routed to the IWF performing the controlling role with the Request-URI set to the MCPTT session identity identifying the IWF performing the controlling role and containing an Event header field set to \"conference\". Such requests are known as \"SIP SUBSCRIBE request for event status subscription in the controlling MCPTT function\" in the procedures in the present document; and\n-\tSIP SUBSCRIBE requests routed to the IWF performing non-controlling role with the Request-URI set to the MCPTT session identity identifying the IWF performing non-controlling role and containing an Event header field set to \"conference\". Such requests are known as \"SIP SUBSCRIBE request for event status subscription in the non-controlling MCPTT function\" in the procedures in the present document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_6.6.2.1.1",
      "section_id": "6.6.2.1.1",
      "section_title": "SDP offer generation",
      "content": "6.6.2.1.1.1\tOn-demand session\nThis clause is referenced from other clauses.\nThe SDP offer generated by the IWF performing the participating role:\n1)\tshall contain only one SDP media-level section for speech; and\n2)\tshall contain an SDP media-level section for one media-floor control entity.\nWhen composing the SDP offer according to 3GPP TS 24.229 [3], the IWF performing the participating role:\n1)\tshall insert the IP address and port number selected by the IWF performing the participating role for the media stream in the SDP offer;\nNOTE 1:\tRequirements can exist for the IWF performing the participating role to be always included in the path of the offered media stream, for example: for the support of features such as lawful interception and recording. Other examples can exist.\n2)\tshall insert the IP address and port number selected by the IWF performing the participating role for the offered media floor control entity, if any, in the received SDP offer; and\n3)\tshall include an \"m=audio\" media-level section for the media stream consisting of:\na)\tthe port number for the media stream selected; and\nb)\tthe codec(s) and media parameters and attributes with the following clarification:\ni)\tif a call is being initiated to a group identity; and\nii)\tif the IWF performing the participating role determines one or more preferred codecs;\nthen the IWF:\ni)\tshall include the name of the chosen codec in the <encoding name> field of the \"a=rtpmap\" attribute as defined in IETF RFC 4566 [8];\nc)\t\"i=\" field set to \"speech\" according to 3GPP TS 24.229 [3];\n4)\tif floor control shall be used during the session, shall include an \"m=application\" media-level section as specified in 3GPP TS 29.380 [31] clause 12 for a media-floor control entity, consisting of:\na)\tthe port number for the media-floor control entity selected as specified in 3GPP TS 29.380 [31]; and\nb)\tthe 'fmtp' attributes as specified in 3GPP TS 29.380 [31] clause 14;\n5)\tif security between the IWF and the MCPTT system is required for a private call, shall include the MIKEY-SAKKE I_MESSAGE in an \"a=key-mgmt\" attribute as a \"mikey\" attribute value in the SDP offer as specified in IETF RFC 4567 [22]; and\n6)\tshall contain an \"a=key-mgmt\" attribute field with a \"mikey\" attribute value.\nNOTE:\tEnd-to-end security of voice traffic is supported through the use of Interworking Security Data messages specified in 3GPP TS 29.582 [33]. Through the use of these messages, an LMR system can communicate security information to the LMR functionality of a device on the MCPTT system. This will allow the use of LMR algorithms and keys for encrypting and decrypting voice packets within the device that can be transmitted to and received from the LMR system.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.380_clause_12",
        "ts_29.380_clause_14",
        "ts_24.229",
        "ts_29.380",
        "ts_29.582"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.2.1.2",
      "section_id": "6.6.2.1.2",
      "section_title": "Sending an INVITE request",
      "content": "This clause is referenced from other procedures.\nWhen generating an initial SIP INVITE request according to 3GPP TS 24.229 [3] the IWF performing the participating role:\n1)\tshould include the Session-Expires header field according to IETF RFC 4028 [6]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n2)\tshall include the option tag \"timer\" in the Supported header field;\n3)\tshall include in the P-Asserted-Identity header field the public service identity of the IWF performing the participating role;\n4)\tshall include the g.3gpp.mcptt media feature tag into the Contact header; and\n5)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), into the P-Asserted-Service header field.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.2.1.3",
      "section_id": "6.6.2.1.3",
      "section_title": "IWF sending a SIP BYE request",
      "content": "When the IWF is ending participation in an MCPTT session and decides to send a SIP BYE request, the IWF:\n1)\tshall interact with the media plane as specified in clause 6.4 in 3GPP TS 29.380 [31];\n2)\tshall generate a SIP BYE request as specified in 3GPP TS 24.229 [3];\n3)\tshall set the Request-URI to the MCPTT session identity of the MCPTT session;\n4)\tshall set the P-Asserted-Identity header field of the outgoing SIP BYE request to the public service identity of the IWF;\n5)\tmay insert an application/vnd.3gpp.mcptt-info+xml MIME body into the outgoing SIP BYE request; and\n6)\tshall send the SIP BYE request towards the controlling MCPTT function, according to 3GPP TS 24.229 [3].\nUpon receiving a SIP 200 (OK) response to the SIP BYE request the IWF should complete any further actions necessary to dissociate the LMR user from the MCPTT session and shall interact with the media plane to release any resources as specified in clause 6.4 in 3GPP TS 29.380 [31] for releasing media plane resources associated with the SIP session with the controlling MCPTT function.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.380_clause_6.4",
        "ts_29.380",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.2.1.4",
      "section_id": "6.6.2.1.4",
      "section_title": "Priority call conditions",
      "content": "6.6.2.1.4.1\tGeneral\nThe clauses of the parent clause contain common procedures to be used for MCPTT emergency group calls and MCPTT imminent peril group calls.\n6.6.2.1.4.2\tDetermining authorisation for originating a priority group call\nWhen the IWF performing the participating role needs to send a request to originate an MCPTT emergency group call and needs to determine if the request is an authorised request for an MCPTT emergency call, the IWF performing the participating role shall obtain the group information per 3GPP TS 24.481 [16] and check the following:\n1)\tif the IWF determines that the calling user is authorized for emergency-group-call; and\n2)\tif the IWF determines that emergency-group-calls for the selected group are allowed;\nthen the IWF performing the participating roled shall consider the MCPTT emergency group call request to be an authorised request for an MCPTT emergency group call;\nIn all other cases, the IWF performing the participating role shall consider the request to originate an MCPTT emergency group call to be an unauthorised request to originate an MCPTT emergency group call.\nWhen the IWF performing the participating role needs to send a request to originate an MCPTT imminent peril group call and needs to determine if the request is an authorised request for an MCPTT imminent peril group call the IWF performing the participating role shall obtain the group information per 3GPP TS 24.481 [16] and check the following:\n1)\tif the IWF determines that the calling user is authorized for imminent peril call; and\n2)\tif the IWF determines that imminent paril calls for the selected group are allowed;\nthen the IWF performing the participating role shall consider the MCPTT imminent peril group call request to be an authorised request for an imminent peril group call;\nIn all other cases, the IWF performing the participating role shall consider the request to originate an MCPTT imminent peril group call to be an unauthorised request to originate an MCPTT imminent peril call.\n6.6.2.1.4.3\tDetermining authorisation for initiating or cancelling an MCPTT emergency alert\nIf the IWF performing the participating role needs to send a SIP request for an MCPTT emergency alert and:\n1)\tif the calling user is authorized by the IWF to activate emergency alert; and\n2)\tif the IWF allows emergency alert for the selected group;\nthen the MCPTT emergency alert request shall be considered to be an authorised request for an MCPTT emergency alert. In all other cases, it shall be considered to be an unauthorised request for an MCPTT emergency alert.\nNOTE 1:\tHow the IWF authorizes a user to originate a request for an MCPTT emergency alert is out of scope of the present document.\nIf the IWF performing the participating role needs to send a SIP request to cancel an MCPTT emergency alert to an MCPTT group, and if the calling user is authorized by the IWF to cancel an emergency alert, then the MCPTT emergency alert cancellation request shall be considered to be an authorised request to cancel an MCPTT emergency alert. In all other cases, it shall be considered to be an unauthorised request to cancel an MCPTT emergency alert.\nNOTE 2:\tHow the IWF authorizes a user to cancel an MCPTT emergency alert is out of scope of the present document.\n6.6.2.1.4.4\tValidate priority request parameters\nThis clause is referenced from other procedures.\nTo validate the combinations of <emergency-ind>, <imminentperil-ind> and <alert-ind> which need to be sent in SIP requests, the IWF performing the participating role shall follow the procedures specified in 3GPP TS 24.379 [29], clause 6.3.3.1.17, with the IWF acting as the controlling function.\n6.6.2.1.4.5\tRetrieving Resource-Priority header field values\nThis clause is referenced from other procedures.\nThe IWF performing the participating role shall follow the procedures specified in clause 6.6.3.1.12 with the clarification that references in that procedure to the IWF performing the controlling role should be replaced with references to the IWF participating role.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_6.3.3.1.17",
        "clause_6.6.3.1.12",
        "ts_24.481",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.2.1.5",
      "section_id": "6.6.2.1.5",
      "section_title": "Sending a SIP INVITE request on receipt of SIP 3xx response",
      "content": "This clause is referenced from other procedures.\nUpon:\n1)\thaving sent a SIP INVITE request to the controlling MCPTT function; and\n2)\thaving received a SIP 302 (Moved Temporarily) response from the controlling MCPTT function sent to the SIP INVITE request in step 1) with:\na)\ta Contact header field containing a SIP URI; and\nb)\tan application/vnd.3gpp.mcptt-info+xml MIME body with an <mcptt-request-uri> element;\nthe IWF performing the participating role:\n1)\tshall generate a SIP INVITE request with the Request-URI set to the contents of the Contact header field of the SIP 302 (Moved Temporarily) response;\n2)\tshall include in the SIP INVITE request all Accept-Contact header fields and all Reject-Contact header fields, with their feature tags and their corresponding values along with parameters according to rules and procedures of IETF RFC 3841 [5] included in the original SIP INVITE request sent to the controlling MCPTT function;\n3)\tshould include the Session-Expires header field according to IETF RFC 4028 [6]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n4)\tshall include the option tag \"timer\" in the Supported header field;\n5)\tshall set the P-Asserted-Identity header field of the outgoing SIP INVITE request to the contents of the P-Asserted-Identity header field of the original SIP INVITE request sent to the controlling MCPTT function;\n6)\tshall include the g.3gpp.mcptt media feature tag into the Contact header field of the outgoing SIP INVITE request;\n7)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" in the Contact header field of the outgoing SIP INVITE request;\n8)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), into the P-Asserted-Service header field of the outgoing SIP INVITE request;\n9)\tshall copy the contents of the application/vnd.3gpp.mcptt-info+xml MIME body of the original SIP INVITE request sent to the controlling MCPTT function into the outgoing SIP INVITE request;\n10)\tshall copy the contents of the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body received in the SIP 302 (Moved Temporarily) response, to the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the outgoing SIP INVITE request;\n11)\tshall set the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP INVITE request to the MCPTT ID of the calling user that was determined by the IWF performing the participating role; and\n12)\tif the <session-type> element is received in the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP 3xx response, shall set the <session-type> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP INVITE request to the value of the <session-type> element received in the SIP 3xx response.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.2.2.1",
      "section_id": "6.6.2.2.1",
      "section_title": "SDP offer generation",
      "content": "The IWF performing the participating role shall follow the procedure in clause 6.6.2.1.1.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.2.1.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.2.2.2",
      "section_id": "6.6.2.2.2",
      "section_title": "SIP BYE request towards the terminating IWF",
      "content": "6.6.2.2.2.1\tOn-demand\nUpon receiving a SIP BYE request from the controlling MCPTT function, the IWF performing the participating role:\n1)\tshall interact with the media plane as specified in clause 6.4 in 3GPP TS 29.380 [31] for releasing media plane resource associated with the SIP session; and\n2)\tshall send a SIP 200 (OK) response to the SIP BYE request received from the controlling MCPTT function according to 3GPP TS 24.229 [3].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.380_clause_6.4",
        "ts_29.380",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.1",
      "section_id": "6.6.3.1.1",
      "section_title": "Sending an INVITE request",
      "content": "This clause is referenced from other procedures.\nThe IWF performing the controlling role shall generate an initial SIP INVITE request according to 3GPP TS 24.229 [3].\nThe IWF performing the controlling role:\n1)\tshall include in the Contact header field an MCPTT session identity for the MCPTT session with the g.3gpp.mcptt media feature tag, the isfocus media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" according to IETF RFC 3840 [9];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcptt media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [5];\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n4)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [5];\n5)\tshall include a Referred-By header field with the public service identity of the IWF;\n6)\tshould include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [6]. The refresher parameter shall be omitted;\n7)\tshall include the Supported header field set to \"timer\";\n9)\tmay include an unmodified Priv-Answer-Mode header field;\n10)\tif the request will not contain a Priv-Answer-Mode header field, shall include an Answer-Mode header field; and\n11)\tmay include an application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing INVITE request.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.2",
      "section_id": "6.6.3.1.2",
      "section_title": "Sending a SIP BYE request",
      "content": "When the IWF performing the controlling role needs to remove an MCPTT participant:\n1)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31] for the MCPTT session release;\n2)\tshall generate a SIP BYE request according to 3GPP TS 24.229 [3]; and\n3)\tshall send the SIP BYE request to the MCPTT participants according to 3GPP TS 24.229 [3].\nIf timer TNG3 (group call timer) has not expired, then when the last participant is removed from the MCPTT session, the IWF performing the controlling role shall stop timer TNG3 (group call timer).\nWhen the MCPTT group session needs to be released, the IWF performing the controlling role shall send SIP BYE requests as described in this clause, to all MCPTT participants of the group session.\nUpon receiving a SIP 200 (OK) response to a SIP BYE request the IWF performing the controlling role shall interact with the media plane as specified in clause 6.3 in 3GPP TS 29.380 [31] for releasing media plane resources associated with the session with the MCPTT clients.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.380_clause_6.3",
        "ts_29.380",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.3",
      "section_id": "6.6.3.1.3",
      "section_title": "Sending a SIP re-INVITE request for MCPTT emergency group call",
      "content": "This clause is referenced from other procedures.\nThe IWF performing the controlling role shall generate a SIP re-INVITE request according to 3GPP TS 24.229 [3].\nThe IWF performing the controlling role:\n1)\tshall include an SDP offer with the media parameters as currently established with the terminating MCPTT client according to 3GPP TS 24.229 [3];\n2)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcptt-calling-user-id> element set to the MCPTT ID of the initiating MCPTT user;\n3)\tif the in-progress emergency group state of the group is set to a value of \"true\" the IWF performing the controlling role:\na)\tshall include a Resource-Priority header field with the namespace populated with the values for an MCPTT emergency group call as specified in clause 6.6.3.1.12;\nb)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body the <emergency-ind> element set to a value of \"true\";\nc)\tif the received request included a request for an emergency alert and MCPTT emergency alerts are authorised for this group and MCPTT user as determined by the procedures of clause 6.6.3.1.8.1, shall populate the application/vnd.3gpp.mcptt-info+xml MIME body and application/vnd.3gpp.mcptt-location-info+xml MIME body as specified in clause 6.6.3.1.7. Otherwise, shall set the <alert-ind> element to a value of \"false\" in the application/vnd.3gpp.mcptt-info+xml MIME body; and\nd)\tif the in-progress imminent peril state of the group is set to a value of \"true\" shall include in the application/vnd.3gpp.mcptt-info+xml MIME body an <imminentperil-ind> element set to a value of \"false\"; and\nNOTE:\tIf the imminent peril state of the group is true at this point, the controlling function will be setting it to false as part of the calling procedure. This is in effect an upgrade of an MCPTT imminent peril group call to an MCPTT emergency group call.\n4)\tif the in-progress emergency group state of the group is set to a value of \"false\":\na)\tshall include a Resource-Priority header field populated with the values for a normal MCPTT group call as specified in clause 6.6.3.1.12; and\nb)\tif the received SIP re-INVITE request contained an application/vnd.3gpp.mcptt-info+xml MIME body with the <emergency-ind> element set to a value of \"false\" and this is an authorised request to cancel an MCPTT emergency group call as determined by the procedures of clause 6.6.3.1.8.4:\ni)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body with the <emergency-ind> element set to a value of \"false\"; and\nii)\tif the received SIP re-INVITE request contained an application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"false\" and this is an authorised request to cancel an MCPTT emergency alert as determined by the procedures of 3GPP TS 24.379 [29], clause 6.3.3.1.15 with the IWF acting as the controlling function, shall:\nA)\tinclude in the application/vnd.3gpp.mcptt-info+xml MIME body an <alert-ind> element set to a value of \"false\"; and\nB)\tif the received SIP request contains an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, copy the contents of the received <originated-by> element to an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP re-INVITE request.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.3.1.12",
        "clause_6.6.3.1.8.1",
        "clause_6.6.3.1.7",
        "clause_6.6.3.1.8.4",
        "ts_24.379_clause_6.3.3.1.15",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.4",
      "section_id": "6.6.3.1.4",
      "section_title": "Sending a SIP INVITE request for MCPTT emergency group call",
      "content": "This clause is referenced from other procedures.\nThis clause describes the procedures for inviting an MCPTT user to an MCPTT session associated with an MCPTT emergency group call or MCPTT imminent peril group call. The procedure is initiated by the IWF performing the controlling role as the result of an action in clause 10.2.3.1.1.\nThe IWF performing the controlling role:\n1)\tshall generate a SIP INVITE request as specified in clause 6.6.3.1.1;\n2)\tshall set the Request-URI to the address of the terminating participating MCPTT function associated with the MCPTT ID of the targeted MCPTT user;\n3)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element populated as follows:\na)\tthe <mcptt-request-uri> element set to the value of the MCPTT ID of the targeted MCPTT user;\nb)\tthe <mcptt-calling-user-id> element set to the value of the MCPTT ID of the calling user; and\nc)\tthe <mcptt-calling-group-id> element set to the value of the MCPTT group ID of the emergency group call.\n4)\tshall include in the P-Asserted-Identity header field the public service identity of the IWF performing the controlling role;\n5)\tshall include in the SIP INVITE request an SDP offer according to the procedures specified in 3GPP TS 24.379 [29], clause 6.3.3.1.1, with the IWF acting as the controlling function; and\n6)\tif the in-progress emergency group state of the group is set to a value of \"true\" the IWF performing the controlling role:\na)\tshall include a Resource-Priority header field populated with the values for an MCPTT emergency group call as specified in clause 6.6.3.1.12;\nb)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body an <emergency-ind> element set to a value of \"true\";\nc)\tif\ni)\tthe <alert-ind> element is set to \"true\" in the received SIP INVITE request and the requesting MCPTT user and MCPTT group are authorised for the initiation of MCPTT emergency alerts as determined by the procedures of clause 6.6.3.1.8.1, shall populate the application/vnd.3gpp.mcptt-info+xml MIME body and the application/vnd.3gpp.mcptt-location-info+xml MIME body as specified in clause 6.6.3.1.7. Otherwise, shall set the <alert-ind> element to a value of \"false\" in the application/vnd.3gpp.mcptt-info+xml MIME body; or\nii)\tthe call request originated from the IWF, and the IWF decides to indicate an emergency alert, shall populate the application/vnd.3gpp.mcptt-info+xml MIME body and the application/vnd.3gpp.mcptt-location-info+xml MIME body as specified in clause 6.6.3.1.7. Otherwise, shall set the <alert-ind> element to a value of \"false\" in the application/vnd.3gpp.mcptt-info+xml MIME body;\nd)\tif the in-progress imminent peril state of the group is set to a value of \"true\" shall include in the application/vnd.3gpp.mcptt-info+xml MIME body an <imminentperil-ind> element set to a value of \"false\"; and\nNOTE:\tIf the imminent peril state of the group is true at this point, the controlling function will set it to false as part of the calling procedure.\n7)\tif the in-progress emergency state of the group is set to a value of \"false\" and the in-progress imminent peril state of the group is set to a value of \"true\", the IWF performing the controlling role:\na)\tshall include a Resource-Priority header field populated with the values for an MCPTT imminent peril group call as specified in clause 6.6.3.1.12; and\nb)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\".",
      "chunk_type": "general",
      "cross_references": [
        "clause_10.2.3.1.1",
        "clause_6.6.3.1.1",
        "ts_24.379_clause_6.3.3.1.1",
        "clause_6.6.3.1.12",
        "clause_6.6.3.1.8.1",
        "clause_6.6.3.1.7",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.5",
      "section_id": "6.6.3.1.5",
      "section_title": "Sending a SIP UPDATE request for Resource-Priority header field correction",
      "content": "This clause is referenced from other procedures.\nThis clause describes the procedures for updating an MCPTT session associated with an MCPTT emergency group call or MCPTT imminent peril group call when the received SIP INVITE request did not include a correctly populated Resource-Priority header field. The procedure is initiated by the IWF performing the controlling role for the purpose of providing the correct Resource-Priority header field.\n1)\tshall generate a SIP 183 (Session Progress) response according to 3GPP TS 24.229 [3] with the clarifications provided specified in 3GPP TS 24.379 [29], clause 6.3.3.2.3.1, with the IWF acting as the controlling function;\n2)\tshall include the option tag \"100rel\" in a Require header field in the SIP 183 (Session Progress) response;\n3)\tshall include in the SIP 183 (Session Progress) response an SDP answer to the SDP offer in the incoming SIP INVITE request as specified in 3GPP TS 24.379 [29], clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function; and\n4)\tshall send the SIP 183 (Session Progress) response towards the MCPTT client according to 3GPP TS 24.229 [3].\nUpon receiving a SIP PRACK request to the SIP 183 (Session Progress) response the IWF performing the controlling role:\n1)\tshall send the SIP 200 (OK) response to the SIP PRACK request according to 3GPP TS 24.229 [3].\n2)\tshall generate a SIP UPDATE request according to 3GPP TS 24.229 [3] with the following clarifications:\n3)\tshall include in the SIP UPDATE request an SDP offer based on the SDP offer in the received SIP INVITE request from the originating network according to the procedures specified in 3GPP TS 24.379 [29], clause 6.3.3.1.1, with the IWF acting as the controlling function;\n4)\tif the in-progress emergency group state of the group is set to a value of \"true\" the IWF performing the controlling role shall include a Resource-Priority header field populated for an MCPTT emergency group call as specified in clause 6.6.3.1.12; and\nNOTE 1:\tThis is the case when the sending MCPTT client did not send a Resource-Priority header field populated appropriately to receive emergency-level priority. In this case, the Resource-Priority header field is populated appropriately to provide emergency-level priority.\n5)\tif the in-progress emergency group state of the group is set to a value of \"false\" the IWF performing the controlling role:\na)\tif the in-progress imminent peril state of the group is set to a value of \"false\", shall include a Resource-Priority header field populated for a normal priority MCPTT group call as specified in clause 6.6.3.1.12; and\nb)\tif the in-progress imminent peril state of the group is set to a value of \"true\", shall include a Resource-Priority header field populated for an MCPTT imminent peril group call as specified in clause 6.6.3.1.12.\nNOTE 2:\tThis is the case when the sending MCPTT client incorrectly populated a Resource-Priority header field for emergency-level or imminent peril-level priority and the controlling MCPTT function re-populates it as appropriate to an imminent peril level priority or normal priority level.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_6.3.3.2.3.1",
        "ts_24.379_clause_6.3.3.2.1",
        "ts_24.379_clause_6.3.3.1.1",
        "clause_6.6.3.1.12",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.6",
      "section_id": "6.6.3.1.6",
      "section_title": "Generating a SIP re-INVITE request to cancel an in-progress emergency",
      "content": "This clause is referenced from other procedures.\nThis clause describes the procedures for generating a SIP re-INVITE request to cancel the in-progress emergency state of a group. The procedure is initiated by the IWF performing the controlling role when it determines the cancellation of the in-progress emergency state of a group is required.\nThe IWF performing the controlling role:\n1)\tshall generate a SIP re-INVITE request as specified in 3GPP TS 24.229 [3] with the clarifications specified in 3GPP TS 24.379 [29] clause 6.3.3.1.9, with the IWF acting as the controlling function;\n2)\tshall include a Resource-Priority header field populated with the values for a normal MCPTT group call as specified in clause 6.6.3.1.12; and\n3)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body with the <emergency-ind> element set to a value of \"false\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_6.3.3.1.9",
        "clause_6.6.3.1.12",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.7",
      "section_id": "6.6.3.1.7",
      "section_title": "Populate mcptt-info and location-info MIME bodies for emergency alert",
      "content": "This clause is referenced from other procedures.\nThis clause describes the procedures for populating the application/vnd.3gpp.mcptt-info+xml and application/vnd.3gpp.mcptt-location-info+xml MIME bodies for an MCPTT emergency alert. The procedure is initiated by the IWF performing the controlling role when it has received request initiating an MCPTT emergency alert and generates a message containing the MCPTT emergency alert information required by 3GPP TS 23.379 [2].\nThe IWF performing the controlling role:\n1)\tshall include, if not already present, an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1, and set the <alert-ind> element to a value of \"true\";\n2)\tshall determine the value of the user's Mission Critical Organization identity.\nNOTE:\tHow the IWF determines the user's Mission Critical Organization identity is out of scope of the present document;\n3)\tshall include in the <mcpttinfo> element containing the <mcptt-Params> element containing an <mc-org> element set to the value of the user's Mission Critical Organization identity; and\n4)\tshall include an application/vnd.3gpp.mcptt-location-info+xml MIME body in the outgoing SIP request.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.379",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.8",
      "section_id": "6.6.3.1.8",
      "section_title": "Authorisations",
      "content": "6.6.3.1.8.1\tDetermining authorisation for initiating an MCPTT emergency alert\nIf the IWF performing the controlling role has received a SIP request targeted to an MCPTT group with the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body set to a value of \"true\", the IWF performing the controlling role shall obtain the MCPTT user profile described in 3GPP TS 24.484 [34] and check the following conditions:\n1)\tif the user is authorized to initiate an emergency alert; and\n2)\tif the IWF allows emergency alerts on the group;\nthen the MCPTT emergency alert request shall be considered to be an authorised request for an MCPTT emergency alert targeted to an MCPTT group. In all other cases, the MCPTT emergency alert request shall be considered to be an unauthorised request for an MCPTT emergency alert targeted to an MCPTT group.\nIf the IWF performing the controlling role has received a SIP request targeted to a user with the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body set to a value of \"true\", the IWF performing the controlling role shall obtain the MCPTT user profile described in 3GPP TS 24.484 [34] and check the following condition:\n1)\tif the calling user is authorized for emergency alerts;\nthen the MCPTT emergency alert request shall be considered to be an authorised request for an MCPTT emergency alert targeted to a user. In all other cases, it shall be considered to be an unauthorised request for an MCPTT emergency alert targeted to a user.\nNOTE 1:\tHow the IWF determines relevant contents of the MCPTT user profile document is out of scope of the present document.\n6.6.3.1.8.2\tDetermining authorisation for initiating an MCPTT emergency group or private call\nIf the IWF performing the controlling role has received a SIP request for an MCPTT group call with the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body set to a value of \"true\", the IWF shall obtain the MCPTT user profile described in 3GPP TS 24.484 [34] and the group information per 3GPP TS 24.481 [16] and:\n1)\tif the MCPTT user is authorized to initiate emergency calls and if the group is configured to allow emergency calls, then the IWF performing the controlling role shall consider the MCPTT emergency group call request to be an authorised request for an MCPTT emergency group call and skip the remaining step; or\n2)\tif the IWF performing the controlling role does not consider the MCPTT emergency group call request to be an authorised request for an MCPTT emergency group call by step 1) above, then the IWF performing the controlling role shall consider the MCPTT emergency group call request to be an unauthorised request for an MCPTT emergency group call.\nIf the IWF performing the controlling role has received a SIP request for an MCPTT private call with the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body set to a value of \"true\", the IWF performing the controlling role shall obtain the MCPTT user profile described in 3GPP TS 24.484 [34] and determines whether the user is authorized to initiate an emergency private call.\nNOTE 1:\tHow the IWF determines relevant contents of the MCPTT user profile document is out of scope of the present document.\n6.6.3.1.8.3\tDetermining authorisation for cancelling an MCPTT emergency alert\nIf the IWF performing the controlling role has received a SIP request with the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body set to a value of \"false\", the IWF may authorize the MCPTT emergency alert cancellation.\nNOTE:\tHow the IWF determines whether to authorize a user to cancel an emergency alert is out of scope of the present document.\n6.6.3.1.8.4\tDetermining authorisation for cancelling an MCPTT emergency group or private call\nIf the IWF performing the controlling role has received a SIP request for an MCPTT group call with the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body set to a value of \"false\", the IWF may authorize the MCPTT emergency group call cancellation request.\nNOTE 1:\tHow the IWF determines whether to authorize a user to cancel a group call emergency is out of scope of the present document.\nIf the IWF performing the controlling role has received a SIP request for an MCPTT private call with the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body set to a value of \"false\", the IWF may authorize the MCPTT emergency private call cancellation request.\nNOTE 2:\tHow the IWF determines whether to authorize a user to cancel a private call emergency is out of scope of the present document.\n6.6.3.1.8.5\tDetermining authorisation for initiating an MCPTT imminent peril call\nIf the IWF performing the controlling role has received a SIP request with the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body set to a value of \"true\", the IWF shall obtain the MCPTT user profile described in 3GPP TS 24.484 [34] and the group information per 3GPP TS 24.481 [16] and\n1)\tif the MCPTT user is authorized to initiate an imminent peril call; and\n2)\tif the IWF allows the group to support imminent peril calls;\nthen the MCPTT imminent peril call request shall be considered to be an authorised request for an MCPTT imminent peril call. In all other cases, it shall be considered to be an unauthorised request for an MCPTT imminent peril call.\nNOTE 1:\tHow the IWF determines relevant contents of the MCPTT user profile document is out of scope of the present document.\n6.6.3.1.8.6\tDetermining authorisation for cancelling an MCPTT imminent peril call\nIf the IWF performing the controlling role has received a SIP request with the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body set to a value of \"false\", the IWF may authorize the MCPTT imminent peril call cancellation request.\nNOTE:\tHow the IWF determines whether to authorize a user to cancel an imminent peril call is out of scope of the present document.\n6.6.3.1.8.7\tSending a SIP OPTIONS request to authorise an MCPTT user at a non-controlling MCPTT function of a MCPTT group\nThis clause is referenced from other procedures.\nThe IWF performing the controlling role:\n1)\tif the <associated-group-id> element is included in the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP INVITE request, shall generate a SIP OPTIONS request according to 3GPP TS 24.229 [3] and the IETF RFC 3261 [14] populated as follows:\na)\tshall set the Request-URI to the public service identity of the non-controlling MCPTT function associated with the MCPTT Group ID which was present in the <associated-group-id> element in the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP INVITE request;\nNOTE 1:\tHow the IWF performing the controlling role finds the address of the non-controlling MCPTT function is out of the scope of the current release.\nb)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7];\nc)\tshall include in the P-Asserted-Identity header field, the public service identity of the IWF performing the controlling role;\nd)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body where:\ni)\tthe <mcptt-request-uri> element shall be set to the value of the <associated-group-id> element in the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP INVITE request; and\nii)\tthe <mcptt-calling-user-id> element is set to the same value as in the <mcptt-calling-user-id> element in the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP INVITE request;\ne)\tshall include the following in the Contact header field:\ni)\tthe g.3gpp.mcptt media feature tag; and\nii)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\"; and\nf)\tsend the SIP OPTIONS request as specified in 3GPP TS 24.229 [3]; and\n2)\tif the <associated-group-id> element is not included in the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP INVITE request, shall for each constituent MCPTT group not homed in the IWF performing the controlling role generate a SIP OPTIONS request according to 3GPP TS 24.229 [3] and IETF RFC 3261 [14] populated as follows:\na)\tshall set the Request-URI to the public service identity of the non-controlling MCPTT function associated with the MCPTT group ID of the constituent group;\nNOTE 2:\tHow the IWF performing the controlling role finds the address of the non-controlling MCPTT function is out of the scope of the current release.\nb)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7];\nc)\tshall include in the P-Asserted-Identity header field, the public service identity of the IWF performing the controlling role;\nd)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body where:\ni)\tthe <mcptt-request-uri> element shall be set to the MCPTT group ID of the constituent group; and\nii)\tthe <mcptt-calling-user-id> element is set to the same value as in the <mcptt-calling-user-id> element in the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP INVITE request;\ne)\tshall include the following in the Contact header field:\ni)\tthe g.3gpp.mcptt media feature tag; and\nii)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\"; and\nf)\tsend the SIP OPTIONS request as specified in 3GPP TS 24.229 [3].\nUpon receipt of the first SIP 200 (OK) response to the SIP OPTIONS request with the mcptt-warn-code set to \"147\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, the IWF acting as the controlling function shall return a SIP 302 (Moved Temporarily) response to the \"SIP INVITE request for controlling MCPTT function of an MCPTT group\" populated as follows:\n1)\tthe URI in the Contact header field set to the P-Asserted-Identity received in the SIP 200 (OK) response;\n2)\tan application/vnd.3gpp.mcptt-info MIME body with:\na)\tthe <mcptt-request-uri> element set to the same value as received in the <mcptt-request-uri> in the SIP 2xx response to the SIP OPTIONS request; and\nb)\tthe <session-type> element set to the value received in the <session-type> element in the application/vnd.3gpp.mcptt.info+xml MIME body of the received SIP 2xx response to the SIP OPTIONS request; and\n3)\tif more than one OPTIONS request were sent, shall remove any cached SIP response and ignore any other responses to any other OPTIONS request.\nUpon receipt of a SIP 404 (Not Found) response to the SIP OPTIONS request such that the mcptt-warn-code set to \"113\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the controlling function:\n1)\tif more than one SIP OPTIONS request were sent and if no other responses to SIP OPTIONS request are expected; shall send a SIP 404 (Not Found) response to \"SIP INVITE request for controlling MCPTT function of an MCPTT group\" and include the Warning header field received in the SIP 404 (Not Found) response; and\n2)\tif more than one OPTIONS request were sent and other responses to SIP OPTIONS request are expected, shall cache the received SIP 404 (Not Found) response.\nUpon receipt of a SIP 403 (Forbidden) response to the SIP OPTIONS request, the mcptt-warn-code set to \"106\" or \"109\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server, and if more than one OPTIONS request were sent and if no other responses to the SIP OPTIONS request are expected, the IWF performing the controlling role:\n1)\tif a SIP 404 (Not Found) response is cached, send a SIP 404 (Not Found) response to \"SIP INVITE request for controlling MCPTT function of an MCPTT group\" and include the Warning header field received in the SIP 404 (Not Found) response; and\n2)\tif a SIP 404 (Not Found) response is not cached, shall return a SIP 403 (Forbidden) response to \"SIP INVITE request for controlling MCPTT function of an MCPTT group\" and include the Warning header field received in the SIP 403 (Forbidden) response.\nUpon receipt of any other response to the SIP OPTIONS response than specified above and if more than one OPTIONS request were sent and if no other responses to the SIP OPTIONS request are expected, the IWF performing the controlling role:\n1)\tif a SIP 404 (Not Found) response is cached, send a SIP 404 (Not Found) response to \"SIP INVITE request for controlling MCPTT function of an MCPTT group\" and include the Warning header field received in the SIP 404 (Not Found) response; and\n2)\tif a SIP 404 (Not Found) response is not cached, shall return a SIP 403 (Forbidden) response to \"SIP INVITE request for controlling MCPTT function of an MCPTT group\".\nNOTE 3:\tThe reason for selecting the SIP 404 (Not Found) response when a SIP 404 (Not Found) response is cached is to indicate that it was a valid request but the MCPTT user identified in the <mcptt-calling-user-id> is not a member of any of the constituent MCPTT groups in the temporary group.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_4.4",
        "ts_24.484",
        "ts_24.481",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.9",
      "section_id": "6.6.3.1.9",
      "section_title": "Generating a SIP 403 response for priority call request rejection",
      "content": "If the IWF performing the controlling role has received a SIP request with the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body is set to \"true\" and this is an unauthorised request for an MCPTT emergency call as determined by the procedures of clause 6.6.3.1.8.2, the controlling MCPTT function shall:\n1)\tinclude in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 with the <mcpttinfo> element containing the <mcptt-Params> element with the <emergency-ind>.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.6.3.1.8.2",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.10",
      "section_id": "6.6.3.1.10",
      "section_title": "Handling the expiry of timer TNG2 (in-progress emergency group call timer)",
      "content": "Upon expiry of timer TNG2 (in-progress emergency group call timer) for an MCPTT group, the IWF performing the controlling role:\n1)\tshall set the in-progress emergency state of the group to a value of \"false\";\n2)\tshall, if an MCPTT group call or MCPTT group session is in progress on the indicated group, for each of the participating members:\na)\tgenerate a SIP re-INVITE request as specified in clause 6.6.3.1.6; and\nb)\tsend the SIP re-INVITE request towards the MCPTT client according to 3GPP TS 24.229 [3]; and\n3)\tshall for each affiliated but non-participating member of the group:\na)\tgenerate a SIP MESSAGE request according to 3GPP TS 24.379 [29] clause 6.3.3.1.11, with the IWF acting as the controlling function and include in the application/vnd.3gpp.mcptt-info+xml MIME body an <emergency-ind> element set to a value of \"false\";\nb)\tshall include in the P-Asserted-Identity header field the public service identity of the controlling MCPTT function;\nc)\tinclude the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7]; and\nd)\tsend the SIP MESSAGE request towards the MCPTT client according to rules and procedures of 3GPP TS 24.229 [3].\nUpon receiving a SIP 200 (OK) response to a re-SIP INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31].",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.3.1.6",
        "ts_24.379_clause_6.3.3.1.11",
        "ts_24.229",
        "ts_24.379",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.11",
      "section_id": "6.6.3.1.11",
      "section_title": "Sending a SIP INFO request in the dialog of a SIP request for a priority call",
      "content": "This clause is referenced from other procedures and describes how the IWF performing the controlling role generates a SIP INFO request due to the receipt of a SIP request for a priority call.\nThe IWF performing the controlling role:\n1)\tshall generate a SIP INFO request according to rules and procedures of 3GPP TS 24.229 [3] and IETF RFC 6086 [26];\n2)\tshall include the Info-Package header field set to g.3gpp.mcptt-info in the SIP INFO request;\n3)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body in the SIP INFO request and:\na)\tif the received SIP request contained application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"true\" and this is an unauthorised request for an MCPTT emergency alert as specified in clause 6.6.3.1.8.1, shall set the <emergency-ind> element to a value of \"true\" and the <alert-ind> element to a value of \"false\";\nb)\tif the received SIP request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"false\" and if this is an unauthorised request for an MCPTT emergency alert cancellation, shall set <alert-ind> element to a value of \"true\"; and\nc)\tif the received SIP request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\", this is an authorised request for an MCPTT imminent peril group call and the in-progress emergency state of the group is set to a value of \"true\", shall set the <imminentperil-ind> element to a value of \"false\" and the <emergency-ind> element set to a value of \"true\"; and\n4)\tshall send the SIP INFO request towards the inviting MCPTT client in the dialog created by the SIP request from the inviting MCPTT client, as specified in 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.6.3.1.8.1",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.1.12",
      "section_id": "6.6.3.1.12",
      "section_title": "Retrieving Resource-Priority header field values",
      "content": "This clause is referenced from other procedures.\nThe IWF performing the controlling role may populate the Resource-Priority header field to assist interworked MC systems in setting bearer priorities. The IWF can set emergency, imminent peril and normal priorities for private and group calls. The priority values and namespaces are as specified in IETF RFC 8101 [23].\nNOTE:\tHow the IWF obtains the values for Resource-Priority header fields is out of scope of the present document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_6.6.3.2.1",
      "section_id": "6.6.3.2.1",
      "section_title": "Receiving a SIP BYE request",
      "content": "Upon receiving a SIP BYE request the IWF performing the controlling role:\n1)\tshall interact with the media plane as specified in clause 6.3 in 3GPP TS 29.380 [31] for releasing the media plane resource associated with the SIP session towards the MCPTT client;\nNOTE:\tThe IWF performing the non-controlling role is also regarded as a MCPTT client in a temporary MCPTT group session.\n2)\tshall generate a SIP 200 (OK) response and send the SIP response towards the MCPTT client according to 3GPP TS 24.229 [3];\n3)\tshall check the MCPTT session release policy as specified in clause 6.6.7.1 and clause 6.6.7.2 whether the MCPTT session needs to be released for each participant of the MCPTT session;\n4)\tif release of the MCPTT session is required:\na)\tshall perform the procedures as specified in the clause 6.6.3.1.2 with the clarification that if the received SIP BYE request contains an application/vnd.3gpp.mcptt-info+xml MIME body, copy the application/vnd.3gpp.mcptt-info+xml MIME body into the outgoing SIP BYE request; and\n5)\tif a release of the MCPTT session is not required:\na)\tshall send a SIP NOTIFY request to all remaining MCPTT clients in the MCPTT session with a subscription to the conference event package as specified in 3GPP TS 24.379 [29], clause 10.1.3.4.2 with the IWF acting as the controlling MCPTT function.\nUpon receiving a SIP 200 (OK) response to the SIP BYE request the IWF performing the controlling shall interact with the media plane as specified in clause 6.3 in 3GPP TS 29.380 [31] for releasing media plane resources associated with the SIP session with the MCPTT participant.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.380_clause_6.3",
        "clause_6.6.7.1",
        "clause_6.6.7.2",
        "clause_6.6.3.1.2",
        "ts_24.379_clause_10.1.3.4.2",
        "ts_29.380",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.3",
      "section_id": "6.6.3.3",
      "section_title": "Handling of the acknowledged call setup timer (TNG1)",
      "content": "When the IWF performing the controlling role receives a SIP INVITE request to initiate a group session and there are members of the group that are affiliated and are deemed by the IWF to be required for the call, then the IWF performing the controlling role shall start timer TNG1 (acknowledged call setup timer), prior to sending out SIP INVITE requests inviting group members to the group session.\nNOTE 1:\tHow the IWF obtains the value of the TNG1 timer is out of scope of the present document.\nNOTE 2:\tHow the IWF determines the required participants for the call, whether to require certain participants for the call or whether to require a certain number of participants for the call is out of scope of the present document.\nWhen the IWF performing the controlling role receives all SIP 200 (OK) responses to the SIP INVITE requests, from all affiliated and required members then the IWF performing the controlling role shall stop timer TNG1 (acknowledged call setup timer) and if the local counter of the number of SIP 200 (OK) responses received from invited members is greater than or equal to the required number of participants, the IWF performing the controlling role shall send a SIP 200 (OK) response to the initiating MCPTT client and shall interact with the media plane as specified in 3GPP TS 29.380 [31].\nNOTE 3:\tMCPTT clients that are affiliated but are not required members that have not yet responded will be considered as joining an ongoing session when the IWF performing the controlling role receives SIP 200 (OK) responses from these MCPTT clients.\nAfter expiry of timer TNG1 (acknowledged call setup timer) and the local counter of the number of SIP 200 (OK) responses received from invited members is less than the value required by the IWF performing the controlling role, then the IWF performing the controlling role shall wait until further responses have been received from invited clients and the value of the local counter of the number of SIP 200 (OK) responses received from invited members is equal to the number required by the IWF performing the controlling role, before continuing with the timer TNG1 expiry procedures in this clause.\nAfter expiry of timer TNG1 (acknowledged call setup timer) and the local counter of the number of SIP 200 (OK) responses received from invited members is greater or equal to the number required by the IWF performing the controlling role, the IWF performing the controlling role shall execute the steps described below:\n1)\tif the IWF is configured to \"proceed\" with the setup of the group call, then the IWF performing the controlling role:\na)\tshall perform the following actions:\ni)\tgenerate a SIP 200 (OK) response to the SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.2 before continuing with the rest of the steps;\nii)\tinclude in the SIP 200 (OK) response the warning text set to \"111 group call proceeded without all required group members\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server MCPTT function;\niii)\tinclude in the SIP 200 (OK) response an SDP answer to the SDP offer in the incoming SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function;\niv)\tinteract with the media plane as specified in 3GPP TS 29.380 [31]; and\nNOTE 4:\tResulting media plane processing is completed before the next step is performed.\nv)\tsend a SIP 200 (OK) response to the inviting MCPTT client according to 3GPP TS 24.229 [3];\nb)\twhen a SIP 200 (OK) response to a SIP INVITE request is received from an invited MCPTT client the IWF performing the controlling role may send an in-dialog SIP MESSAGE request to the MCPTT client that originated the group session with the text \"group call proceeded without all required group members\";\nc)\twhen the IWF performing the controlling role receives a SIP BYE request from an invited MCPTT client, shall take the actions specified in clause 6.6.3.2.1 and may send an in-dialog SIP MESSAGE request to the MCPTT client that originated the group session with the text \"group call proceeded without all required group members\"; and\nd)\tshall generate a notification package as specified in clause 6.6.3.4 and send a SIP NOTIFY request according to 3GPP TS 24.229 [3] to the MCPTT clients which have subscribed to the conference event package; and\n2)\tif the IWF is configured to \"abandon\" the setup of the group call, then the IWF performing the controlling role shall:\na)\tsend a SIP 480 (Temporarily Unavailable) response to the MCPTT client that originated the group session with the warning text set to \"112 group call abandoned due to required group members not part of the group session\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server;\nb)\tfor each confirmed dialog at the IWF performing the controlling role, send a SIP BYE request towards the MCPTT clients invited to the group session in accordance with 3GPP TS 24.229 [3] and interact with the media plane as specified in 3GPP TS 29.380 [31]; and\nc)\tfor each non-confirmed dialog at the IWF performing the controlling role, send a SIP CANCEL request towards the MCPTT clients invited to the group session in accordance with 3GPP TS 24.229 [3].\nIf the IWF performing the controlling role receives a final SIP 4xx, 5xx or 6xx response from an affiliated and required group member prior to expiry of timer TNG1 (acknowledged call setup timer) and based on policy, the IWF performing the controlling role decides not to continue with the establishment of the group call without the affiliated and required group member, then the IWF performing the controlling role:\nNOTE 5:\tIt is expected that this action is taken if the policy is to abandon the call on expiry of timer TNG1 (acknowledged call setup timer).\n1)\tshall stop timer TNG1 (acknowledged call setup timer); and\n2)\tshall forward the final SIP 4xx, 5xx or 6xx response towards the inviting MCPTT client with the warning text set to \"112 group call abandoned due to required group member not part of the group session\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server.\nIf:\n1)\tthe IWF performing the controlling role receives a final SIP 4xx, 5xx or 6xx response from an affiliated and required group member prior to expiry of timer TNG1 (acknowledged call setup timer);\n2)\tthe local counter of the number of SIP 200 (OK) responses received from invited members is greater than or equal to the required number of participants; and\n3)\tbased on policy, the IWF performing the controlling role decides to continue with the establishment of the group call without the affiliated and required group member;\nthen the IWF performing the controlling role:\nNOTE 6:\tIt is expected that this action is taken if the policy is to proceed with the call on expiry of timer TNG1 (acknowledged call setup timer).\n1)\tif all other invited clients have not yet responded, shall continue running timer TNG1 (acknowledged call setup timer); and\n2)\tif all other invited clients have responded with SIP 200 (OK) responses, shall\na)\tstop timer TNG1 (acknowledged call setup timer);\nb)\tgenerate SIP 200 (OK) response to the SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.2 before continuing with the rest of the steps;\nc)\tinclude in the SIP 200 (OK) response the warning text set to \"111 group call proceeded without all required group members\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server;\nd)\tinclude in the SIP 200 (OK) response an SDP answer to the SDP offer in the incoming SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function;\ne)\tinteract with the media plane as specified in 3GPP TS 29.380 [31]; and\nNOTE 7:\tResulting media plane processing is completed before the next step is performed.\nf)\tsend a SIP 200 (OK) response to the inviting MCPTT client according to 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_6.3.3.2.2",
        "ts_24.379_clause_4.4",
        "ts_24.379_clause_6.3.3.2.1",
        "clause_6.6.3.2.1",
        "clause_6.6.3.4",
        "ts_29.380",
        "ts_24.379",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.4",
      "section_id": "6.6.3.4",
      "section_title": "Generating a SIP NOTIFY request",
      "content": "The IWF performing the controlling role shall generate a SIP NOTIFY request according to 3GPP TS 24.229 [3] with the clarification in this clause.\nIn the SIP NOTIFY request, the IWF performing the controlling role:\n1)\tshall set the P-Asserted-Identity header field to the public service identity of the IWF performing the controlling role;\n2)\tshall include an Event header field set to \"conference\";\n3)\tshall include an Expires header field set to 3600 seconds according to IETF RFC 4575 [15], as default value;\n4)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Preferred-Service header field according to IETF RFC 6050 [7]; and\n5)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with:\na)\tthe <mcptt-calling-group-id> set to the value of the MCPTT group ID;\nb)\tif the target is a MCPTT user, the value of <mcptt-request-uri> element set to the value of MCPTT ID of the targeted MCPTT user; and\nc)\tif the target is the non-controlling MCPTT function, the value of <mcptt-request-uri> element set to the constituent MCPTT group ID.\nIn the SIP NOTIFY request, the IWF performing the controlling role shall include an application/conference-info+xml MIME body according to IETF RFC 4575 [15] with the following limitations:\n1)\tthe IWF performing the controlling role shall include the MCPTT group ID of the MCPTT group in the \"entity\" attribute of the <conference-info> element;\n2)\tfor each non-IWF connected participant in the MCPTT session with the exception of non-controlling MCPTT functions, the IWF performing the controlling role shall include a <user> element. The <user> element:\nNOTE 1:\tNon-controlling MCPTT functions will appear as a participant in temporary group sessions.\na)\tshall include the \"entity\" attribute. The \"entity\" attribute:\ni)\tshall for the MCPTT client, which initiated, joined or re-joined an MCPTT session, include the MCPTT ID of the user that originated the request; and\nii)\tshall for an invited MCPTT client include the MCPTT ID of the invited MCPTT user in case of a prearranged group call or chat group call;\nb)\tshall include a single <endpoint> element. The <endpoint> element:\ni)\tshall include the \"entity\" attribute; and\nii)\tshall include the <status> element indicating the status of the MCPTT session according to IETF RFC 4575 [14]; and\nc)\tmay include the <roles> element.\nNOTE 2:\tThe usage of <roles> is only applicable for human consumption.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.5.1",
      "section_id": "6.6.3.5.1",
      "section_title": "General",
      "content": "When the IWF performing the controlling role receives a SIP INVITE request to initiate a group session, then after an MCPTT session identity has been allocated for the group session, the IWF performing the controlling role shall start timer TNG3 (group call timer).\nNOTE 1:\tHow the IWF determines the value of the TNG3 timer is out of scope of the present document.\nIf the IWF does not have a TNG3 timer value, then the IWF performing the controlling role shall not start timer TNG3 (group call timer).\nNOTE 2:\tThe group call timer is mandated for a pre-arranged group and is optional for a chat group.\nWhen merging two or more active group calls into a temporary group call, if the IWF is hosting at least one of the active group calls shall stop timer TNG3 (group call timer) for each hosted group call, and the IWF performing the controlling role hosting the temporary group call shall start timer TNG3 (group call timer) for the temporary group call.\nNOTE 3:\tMCPTT server(s) other than the IWF that are hosting the independent active group calls become non-controlling MCPTT function(s) of an MCPTT group, for the temporary group call.\nWhen splitting a temporary group call into independent group calls, the IWF performing the controlling role hosting the temporary group call shall stop timer TNG3 (group call timer) and the controlling MCPTT function(s) hosting the independent group calls shall start TNG3 (group call timer) for each group call.\nWhen the last MCPTT client leaves the MCPTT session, the IWF performing the controlling role shall stop timer TNG3 (group call timer).\nOn expiry of timer TNG3 (group call timer), the IWF performing the controlling role shall release the MCPTT session by following the procedures in clause 6.6.3.1.2;",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.6.3.1.2"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.3.5.2",
      "section_id": "6.6.3.5.2",
      "section_title": "Interaction with the in-progress emergency group call timer (TNG2)",
      "content": "If the IWF performing the controlling role starts timer TNG2 (in-progress emergency group call timer), it shall not start timer TNG3 (group call timer).\nIf timer TNG3 (group call timer) is running and the MCPTT group call is upgraded to an MCPTT emergency group call, then the IWF performing the controlling role shall stop timer TNG3 (group call timer) and shall start timer TNG2 (in-progress emergency group call timer). If timer TNG2 (in-progress emergency group call timer) is running and the MCPTT emergency group call is cancelled, then the IWF performing the controlling role shall stop timer TNG2 (in-progress emergency group call timer) and shall start timer TNG3 (group call timer).\nNOTE 1:\tHow the IWF determines the value of the TNG2 and TNG3 timers is out of scope of the present document.\nIf timer TNG2 (in-progress emergency group call timer) is running and sequentially expires, then the controlling MCPTT function shall start timer TNG3 (group call timer).\nNOTE 2:\tThe above conditions for starting timer TNG2 (in-progress emergency group call timer) and timer TNG3 (group call timer) also apply in the case that these timers are re-started. For example: the case where the timer TNG3 was initially running, the MCPTT group call is upgraded to an MCPTT emergency group call and then the MCPTT emergency group call is cancelled.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_6.6.4.1.1",
      "section_id": "6.6.4.1.1",
      "section_title": "SDP offer generation",
      "content": "The SDP offer is generated based on the received SDP offer to be sent to MCPTT clients that are a member of the group homed in the IWF. The SDP offer generated by the IWF performing the non-controlling role of a group:\n1)\tshall include only one SDP media-level section for speech as contained in the received SDP offer; and\n2)\tshall include an SDP media-level section for one media-floor control entity, if present in the received SDP offer.\nWhen composing the SDP offer according to 3GPP TS 24.229 [3], the IWF performing the non-controlling role of a group:\n1)\tshall replace the IP address and port number for the offered media stream in the received SDP offer with the IP address and port number of the IWF performing the non-controlling role;\n2)\tshall include all media-level attributes from the received SDP offer;\n3)\tshall replace the IP address and port number for the offered media floor control entity, if any, in the received SDP offer with the IP address and port number of the IWF performing the non-controlling role; and\n4)\tshall include the offered media floor control entity 'fmtp' attributes as specified in 3GPP TS 29.380 [31] clause 14.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.380_clause_14",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.4.1.2",
      "section_id": "6.6.4.1.2",
      "section_title": "Sending an INVITE request towards the MCPTT client",
      "content": "This clause is referenced from other procedures.\nThis clause covers the situation where a group homed in the IWF is a constituent group of a group homed in an MCPTT system.\nIf the IWF receives a \"SIP INVITE request for non-controlling MCPTT function of an MCPTT group\" and does not support group regroup procedures, the IWF shall reject the SIP INVITE request with a SIP 403 (Forbidden) response with the warning text set to \"100 function not allowed due to local policy\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, and shall not execute the remainder of this procedure.\nIf there are MCPTT clients that are members of the group, the IWF performing the non-controlling role of a group shall generate initial SIP INVITE requests according to 3GPP TS 24.229 [3].\nNOTE 1:\tHow the IWF includes participants homed in the IWF is out of scope.\nFor each SIP INVITE request, the IWF performing the non-controlling role of a group:\n1)\tshall generate a new MCPTT session identity for the MCPTT session with the invited MCPTT client and include it in the Contact header field together with the g.3gpp.mcptt media feature tag, the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\", and the isfocus media feature tag according to IETF RFC 3840 [9];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcptt media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [5];\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n4)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [5];\n5)\tshall set the Request-URI to the public service identity of the terminating participating MCPTT function associated to the MCPTT ID of the MCPTT user to be invited;\nNOTE 2:\tHow the IWF finds the address of the terminating participating MCPTT function is out of the scope of the current release.\nNOTE 3:\tIf the terminating MCPTT user is part of a partner MCPTT system, then the public service identity can identify an entry point in the partner network that is able to identify the terminating participating MCPTT function.\n6)\tshall copy the application/vnd.3gpp.mcptt-info+xml MIME body in the received SIP INVITE request to the outgoing SIP INVITE request;\n7)\tshall update the application/vnd.3gpp.mcptt-info+xml MIME body with: a <mcptt-request-uri> element set to the MCPTT ID of the invited MCPTT user;\n8)\tshall include the public service identity of the IWF in the P-Asserted-Identity header field;\n9)\tshall include the received Referred-By header field with the public service identity of the IWF;\n10)\tshould include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [6]. The refresher parameter shall be omitted;\n11)\tshall include the Supported header field set to \"timer\";\n12)\tshall include an unmodified Answer-Mode header field, if present in the incoming SIP INVITE request; and\n13)\tshall include the warning text set to \"148 MCPTT group is regrouped\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4.\nNOTE 4:\tAs long as the MCPTT group is regrouped the floor control messages in the media plane includes a grouped regrouped indication as specified in 3GPP TS 29.380 [31].",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_4.4",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.4.1.3",
      "section_id": "6.6.4.1.3",
      "section_title": "Sending a SIP INFO request",
      "content": "This clause is referenced from other procedures.\nThis clause covers the situation where a group homed in the IWF is a constituent group of a group homed in an MCPTT system.\nIf the IWF performing the non-controlling role receives a \"SIP INVITE request for non-controlling MCPTT function of an MCPTT group\" and does not support group regroup procedures, the IWF shall reject the SIP INVITE request with a SIP 403 (Forbidden) response with the warning text set to \"100 function not allowed due to local policy\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, and shall not execute the remainder of this procedure.\nThe IWF shall generate a SIP INFO request according to rules and procedures of 3GPP TS 24.229 [3] and IETF RFC 6086 [26].\nThe IWF:\n1)\tshall include the Info-Package header field set to g.3gpp.mcptt-floor-request;\n2)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcptt-request-uri> set to the temporary MCPTT group ID and the <mcptt-calling-group-id> element with the constituent MCPTT group ID;\n3)\tshall include an application/vnd.3gpp.mcptt-floor-request+xml MIME body with the Content-Disposition header field set to \"Info-Package\". For each current speaker the application/vnd.3gpp.mcptt-floor-request+xml MIME body shall be populated as follows:\na)\tthe <floor-type> element set to \"general\" or \"dual\" as described in 3GPP TS 24.379 [29] clause F.5.3;\nb)\tthe SSRC of the MCPTT client or participant homed in the IWF with the permission to send media in the <ssrc> element;\nc)\tthe actual floor priority in the <floor-priority> element;\nd)\tthe MCPTT ID of the MCPTT user or participant homed in the IWF with the permission to send media in the <user-id> element;\ne)\tthe queueing capability in the <queueing-capability> element of the <track-info> element;\nf)\tthe participant type in the <participant-type> in the <track-info> element;\ng)\tone or more <floor-participant-reference> elements in the <track-info> element in the same order as the would appear in the Track Info field as specified in 3GPP TS 29.380 [31] clause 8.2.3.13; and\nh)\tif available, additional information in the <floor-indicator> element; and\n4)\tif:\na)\tthe user with permission to send media is an MCPTT client, and if:\ni)\tthe IWF has location information (see 3GPP TS 24.379 [29] clause 13.2.4) for the MCPTT client;\nii)\tthe location information for the MCPTT client either has not been sent to the controlling MCPTT function or has changed since last sent to the MCPTT controlling function; and\niii)\tthe IWF determines that the location of the MCPTT client is allowed to be sent when the MCPTT user is talking; or\nb)\tthe user with permission to send media is a participant homed in the IWF, and if:\ni)\tlocation information for the user with permission to send media homed in the IWF is available;\nii)\tthe location information for the participant homed in the IWF has either not been sent to the controlling MCPTT function or has changed since last sent to the controlling MCPTT function; and\niii)\tthe IWF determines that the location of the participant homed in the IWF is allowed to be sent when the participant homed in the IWF is talking;\nthen shall include an application/vnd.3gpp.mcptt-location-info+xml MIME body with a <Report> element included in the <location-info> root element.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_4.4",
        "ts_29.380_clause_8.2.3.13",
        "ts_24.379_clause_13.2.4",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.4.1.4",
      "section_id": "6.6.4.1.4",
      "section_title": "Sending an INVITE request towards the controlling MCPTT function",
      "content": "This clause is referenced from other procedures.\nThe IWF shall generate a SIP INVITE request according to rules and procedures of 3GPP TS 24.229 [3].\nThe IWF:\n1)\tshall include in the Contact header field the g.3gpp.mcptt media feature tag, the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\", and the isfocus media feature tag according to IETF RFC 3840 [9];\n2)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n3)\tshall set the Request-URI to the public service identity of the controlling MCPTT function;\n4)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body with:\na)\tthe <mcptt-request-uri> element set to the group identity;\nb)\tthe <mcptt-calling-user-id> element set to the MCPTT ID of the calling user; and\nc)\tthe <required> element set to \"true\", if the group document retrieved from the group management server contains <on-network-required> group members as specified in 3GPP TS 24.481 [16];\n5)\tshall include the public service identity of the IWF in the P-Asserted-Identity header field;\n6)\tshould include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [6]. The refresher parameter shall be omitted; and\n7)\tshall include the Supported header field set to \"timer\".",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.229",
        "ts_24.481"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.4.2.1",
      "section_id": "6.6.4.2.1",
      "section_title": "SDP answer generation",
      "content": "When composing the SDP answer according to 3GPP TS 24.229 [3], the IWF performing the non-controlling role of a group:\n1)\tfor the accepted media stream in the received SDP offer:\na)\tshall replace the IP address and port number in the received SDP offer with the IP address and port number of the IWF performing the non-controlling role; and\n2)\tfor the accepted media-floor control entity, if present in the received SDP offer:\na)\tshall replace the IP address and port number in the received SDP offer with the IP address and port number of the IWF performing the non-controlling role; and\nb)\tshall include 'fmtp' attributes as specified in 3GPP TS 29.380 [31] clause 14.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.380_clause_14",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.4.2.2",
      "section_id": "6.6.4.2.2",
      "section_title": "Sending a SIP response to the SIP INVITE request",
      "content": "6.6.4.2.2.1\tSending a SIP 183 (Session Progress) response\nWhen sending a SIP 183 (Session Progress) the IWF performing the non-controlling role of a group:\n1)\tshall generate a SIP 183 (Session Progress) response according to 3GPP TS 24.229 [3];\n2)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcptt media feature tag; and\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\";\n3)\tshall include the public service identity determined by the IWF performing the non-controlling role in the P-Asserted-Identity header field; and\n4)\tshall include the option tag \"tdialog\" in a Supported header field according to rules and procedures of IETF RFC 4538 [13].\n6.6.4.2.2.2\tSending a SIP 200 (OK) response\nWhen sending a SIP 200 (OK) response, the IWF performing the non-controlling role of a group homed in the IWF:\n1)\tshall generate the SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [3];\n2)\tshall include the Session-Expires header field and start supervising the SIP session according to rules and procedures of IETF RFC 4028 [6], \"UAS Behaviour\". The \"refresher\" parameter in the Session-Expires header field shall be set to \"uac\";\n3)\tshall include the option tag \"timer\" in a Require header field;\n4)\tshall include the public service identity of the IWF performing the non-controlling role in the P-Asserted-Identity header field;\n5)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcptt media feature tag; and\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\";\n6)\tshall include Warning header field(s) received from MCPTT clients in incoming responses to the SIP INVITE request;\n7)\tshall include the option tag \"tdialog\" in a Supported header field according to rules and procedures of IETF RFC 4538 [13]; and\n8)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcptt-called-party-id> element set to the constituent MCPTT group ID and the <floor-state> element set to the state of the floor.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.4.3",
      "section_id": "6.6.4.3",
      "section_title": "Generating a SIP NOTIFY request",
      "content": "The IWF performing the non-controlling role shall generate a SIP NOTIFY request according to 3GPP TS 24.229 [3] with the clarification in this clause.\nIn the SIP NOTIFY request, the IWF:\n1)\tshall set the P-Asserted-Identity header field to the public service identity of the IWF;\n2)\tshall include an Event header field set to \"conference\";\n3)\tshall include an Expires header field set to 3600 seconds according to IETF RFC 4575 [15], as default value;\n4)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Preferred-Service header field according to IETF RFC 6050 [7]; and\n5)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with:\na)\tthe <mcptt-calling-group-id> set to the value of the constituent MCPTT group ID;\nb)\tif the target is a MCPTT user, the value of <mcptt-request-uri> element set to the MCPTT ID of the targeted MCPTT user; and\nc)\tif the target is the controlling MCPTT function the value of <mcptt-request-uri> element set to the temporary MCPTT group ID.\nIn the SIP NOTIFY request, the IWF shall include application/conference-info+xml MIME body according to IETF RFC 4575 [15] as specified in clause 6.6.3.4 with the following exceptions:\n1)\tthe IWF performing the non-controlling role shall not regard the controlling MCPTT function as a participant and not include the controlling MCPTT function in a <user> element; and\nNOTE:\tThe controlling MCPTT function initiated the temporary group call and will appear as a participant in the group session.\n2)\tthe IWF shall include stored conference status information received in SIP NOTIFY requests from the controlling MCPTT function in 3GPP TS 24.379 [29] clause 10.1.3.5.3 and status information about MCPTT participants that are members of the group.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.3.4",
        "ts_24.379_clause_10.1.3.5.3",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.5.1",
      "section_id": "6.6.5.1",
      "section_title": "General",
      "content": "How an IWF performing the controlling role of a group or performing the non-controlling role of a group obtains information about the group is out of scope of the present document.\nNOTE:\tDuring the group regrouping operation as specified in 3GPP TS 24.481 [16], the IWF performing the controlling role is notified of the constituent MCPTT group identities associated with the TGI.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.481"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.5.2",
      "section_id": "6.6.5.2",
      "section_title": "Rules for joining a group session",
      "content": "The following conditions shall be met for the IWF performing the controlling role to allow an MCPTT user to join an existing group session:\n1)\tthe MCPTT user is a member of the group; and\n2)\tthe MCPTT user is authorized to join the group;\nIf both of the above conditions are met, then the MCPTT user shall be authorised to join the group session.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_6.6.5.3",
      "section_id": "6.6.5.3",
      "section_title": "Determining the group members to invite",
      "content": "The IWF shall only invite affiliated group members to a group session. The IWF determines whether MCPTT users are affiliated members of its group by following the procedures specified in 3GPP TS 24.379 [29], clause 6.3.6.\nNOTE 1:\tThe term \"affiliated group members\" used above also includes those members that are implicitly affiliated by the IWF performing the controlling role.\nNOTE 2:\tThe IWF need not store its group parameters in a GMS as described in 3GPP TS 24.481 [16] the IWF will have to respond to queries from other systems on its IWF-3 interface, which is based upon the CSC-16 interface described in 3GPP TS 23.283 [28].\nThe IWF may limit the maximum number of participants.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.379_clause_6.3.6",
        "ts_24.379",
        "ts_24.481",
        "ts_23.283"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.6.1",
      "section_id": "6.6.6.1",
      "section_title": "Public service identity does not exist",
      "content": "Upon receiving a request that includes the Request-URI set to a public service identity that is not allocated in the IWF, the IWF performing the participating role or the controlling role shall return a SIP 404 (Not Found) response.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_6.6.7.1",
      "section_id": "6.6.7.1",
      "section_title": "Session release policy for group call",
      "content": "If:\n1)\tthe call is a pre-arranged group call and if the IWF performing the controlling role receives an indication from the media plane that the T4 (Inactivity) timer specified in 3GPP TS 29.380 [31] expired and if there is at least one participant of the prearranged group call that is an MCPTT user;\n2)\tthere are only one or no participants in the call, including both MCPTT participants and participants homed in the IWF;\n3)\tif the call is a pre-arranged group call and if it is according to local policy, the initiator of the group call leaves the call;\n4)\tless than the minimum number of affiliated group members is present;\n5)\ttimer TNG3 (group call timer) expires; or\n6)\tthe call is a broadcast group call and if the controlling MCPTT function receives an indication from the media plane that the T4 (Inactivity) timer specified in 3GPP TS 29.380 [31] expired;\nthen the IWF performing the controlling role;\n1)\tshall release the MCPTT session for the group call if any participants are MCPTT users.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.6.7.2",
      "section_id": "6.6.7.2",
      "section_title": "Session release policy for private call",
      "content": "If:\n1)\tIWF performing the controlling role decides that a private call has been inactive for longer than a locally determined period; or\n2)\tthere are only one or no participants in the MCPTT session;\nthe IWF performing the controlling role shall release the MCPTT session for a private call.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_6.7",
      "section_id": "6.7",
      "section_title": "Implicit floor request",
      "content": "A SIP re-INVITE request fulfilling the following criteria shall be regarded by the IWF performing the controlling role as an implicit floor request when the originator of the request:\n1)\tperforms an upgrade of:\na)\tan MCPTT group call to an emergency MCPTT group call;\nb)\tan MCPTT private call to an emergency MCPTT private call; or\nc)\tan MCPTT group call to an imminent peril MCPTT group call; and\n2)\tincludes the \"mc_implicit_request\" 'fmtp' attribute in the associated UDP stream for the floor control in the SDP offer/answer as specified in 3GPP TS 29.380 [31] clause 12.\nIn all other cases the SIP (re-)INVITE request shall be regarded as received without an implicit floor request.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.380_clause_12",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.8.1.1",
      "section_id": "6.8.1.1",
      "section_title": "Applicability and exclusions",
      "content": "The procedures in clause 6.8 apply in general to all procedures described in clause 9, clause 10, clause 11 and clause 12.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.8",
        "clause_9",
        "clause_10",
        "clause_11",
        "clause_12"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.8.1.2",
      "section_id": "6.8.1.2",
      "section_title": "Performing XML content encryption",
      "content": "Whenever the IWF includes XML elements or attributes pertaining to the data specified in 3GPP TS 24.379 [29] clause 4.8 in SIP requests or SIP responses, the IWF shall perform the procedures in clause 6.8.2.1.1, with the exception that when the IWF receives a SIP request with XML elements or attributes in an MIME body that need to be copied from the incoming SIP request to an outgoing SIP request without modification, the IWF shall perform the procedures specified in clause 6.8.2.2.\nNOTE:\tThe procedure in clause 6.8.2.1.1 first determines (by referring to configuration) if confidentiality protection is enabled and then call the necessary procedures to encrypt the contents of the XML elements if confidentiality protection is enabled.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.379_clause_4.8",
        "clause_6.8.2.1.1",
        "clause_6.8.2.2",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.8.1.3",
      "section_id": "6.8.1.3",
      "section_title": "Performing integrity protection on an XML body",
      "content": "The IWF shall perform the procedures in clause 6.8.3.2 just prior to sending a SIP request or SIP response.\nNOTE:\tThe procedure in clause 6.8.3.2 first determines if integrity protection of XML MIME bodies is required and then calls the necessary procedures to integrity protect each XML MIME body if integrity protection is required. Each XML MIME body has its own signature.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.8.3.2"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.8.1.4",
      "section_id": "6.8.1.4",
      "section_title": "Keys used in confidentiality protection procedures",
      "content": "Confidentiality protection uses an XPK to encrypt the data which (depending on who is the sender and who is the receiver of the encrypted information) can be an SPK as specified in 3GPP TS 24.379 [29] clause 4.8. An XPK-ID (SPK-ID) is used to key the XPK (SPK). It is assumed that before the procedures in this clause are called, the SPK/SPK-ID is available on the sender and recipient of the encrypted content as described in 3GPP TS 24.379 [29] clause 4.8.\nThe procedures in 3GPP TS 24.379 [29], clause 6.6.2.3 and 3GPP TS 24.379 [29] clause 6.6.2.4 are used with an XPK equal to the SPK and a XPK-ID equal to the SPK-ID in the following circumstances as described in 3GPP TS 33.180 [27]:\n1)\tIWF sends confidentiality protected content to an MCPTT server in the same domain; and\n2)\tIWF sends confidentiality protected content to an MCPTT server in another domain.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_24.379_clause_4.8",
        "ts_24.379_clause_6.6.2.3",
        "ts_24.379_clause_6.6.2.4",
        "ts_24.379",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.8.2.1.1",
      "section_id": "6.8.2.1.1",
      "section_title": "IWF performing any role of an MCPTT server",
      "content": "If the IWF performing any role of an MCPTT server determines locally that it needs to confidentiality protect content sent to an MCPTT server, then sending confidentiality protected content between MCPTT servers is enabled.\nWhen sending confidentiality protected content, the IWF:\n1)\tshall use the appropriate keying information specified in clause 6.8.1.4;\n2)\tshall perform the procedures in 3GPP TS 24.379 [29] clause 6.6.2.3.3 to confidentiality protect XML elements containing the content described in 3GPP TS 24.379 [29] clause 4.8; and\n3)\tshall perform the procedures in 3GPP TS 24.379 [29] clause 6.6.2.3.4 to confidentiality protect URIs in XML attributes for URIs described in 3GPP TS 24.379 [29] clause 4.8.\nIf the IWF determines locally that it does not need to confidentiality protect content sent to an MCPTT server, then sending confidentiality protected content between MCPTT servers is disabled, and content is included in XML elements and attributes without encryption.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.8.1.4",
        "ts_24.379_clause_6.6.2.3.3",
        "ts_24.379_clause_4.8",
        "ts_24.379_clause_6.6.2.3.4",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.8.2.2",
      "section_id": "6.8.2.2",
      "section_title": "IWF copying received XML content",
      "content": "The following procedure is executed when an IWF receives a SIP request containing XML MIME bodies, where the content needs to be copied from the incoming SIP request to the outgoing SIP request.\nThe IWF:\n1)\tshall copy the XML elements from the XML MIME body of the incoming SIP request that do not contain a <EncryptedData> XML element, to the same XML body in the outgoing SIP request;\n2)\tfor each encrypted XML element in the XML MIME body of the incoming SIP request as determined by 3GPP TS 24.379 [29] clause 6.6.2.4.1:\na)\tshall use the keying information described in clause 6.8.1.4 to decrypt the content within the XML element by following the procedures specified in 3GPP TS 24.379 [29] clause 6.6.2.4.2, and shall continue with the steps below if the encrypted XML element was successfully decrypted;\nb)\tif confidentiality protection is enabled as specified in clause 6.8.2.1.1, then for each decrypted XML element:\ni)\tshall re-encrypt the content within the XML element using the keying information described in clause 6.8.1.4 and by following the procedures specified in 3GPP TS 24.379 [29] clause 6.6.2.3.3; and\nii)\tshall include the re-encrypted content into the same XML MIME body of the outgoing SIP request; and\nc)\tif confidentiality protection is disabled as specified in clause 6.8.2.1.1, shall include the decrypted content in the same XML MIME body of the outgoing SIP request.\n3)\tfor each encrypted XML URI attribute in the XML MIME body of the incoming SIP request as determined by 3GPP TS 24.379 [29] clause 6.6.2.4.1:\na)\tshall use the keying information described in clause 6.8.1.4 to decrypt the URI value of the XML attribute by following the procedures specified in 3GPP TS 24.379 [29] clause 6.6.2.4.3, and shall continue with the steps below if the encrypted XML attribute value was successfully decrypted;\nb)\tif confidentiality protection is enabled as specified in clause 6.8.2.1.1, then for each decrypted XML element:\ni)\tshall re-encrypt the URI value of the XML attribute using the keying information described in clause 6.8.1.4 and by following the procedures specified in 3GPP TS 24.379 [29] clause 6.6.2.3.4; and\nii)\tshall include the re-encrypted attribute value into the same XML MIME body of the outgoing SIP request; and\nc)\tif confidentiality protection is disabled as specified in clause 6.8.2.1.1, shall include the decrypted value in the same XML MIME body of the outgoing SIP request.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_6.6.2.4.1",
        "clause_6.8.1.4",
        "ts_24.379_clause_6.6.2.4.2",
        "clause_6.8.2.1.1",
        "ts_24.379_clause_6.6.2.3.3",
        "ts_24.379_clause_6.6.2.4.3",
        "ts_24.379_clause_6.6.2.3.4",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.8.3.1",
      "section_id": "6.8.3.1",
      "section_title": "Keys used in integrity protection procedures",
      "content": "Integrity protection uses an XPK to sign the data which (depending on who is the sender and who is the receiver of the signed information) can be an SPK as specified in 3GPP TS 24.379 [29] clause 4.8. An XPK-ID (SPK-ID) is used to key the XPK (SPK). It is assumed that before the procedures in 3GPP TS 24.379 [29] clause 6.6.3.3 and 3GPP TS 24.379 [29] clause 6.6.3.4 are called, the SPK/SPK-ID are available on the sender and recipient of the integrity protected content, as described in 3GPP TS 24.379 [29] clause 4.8.\nThe procedures in 3GPP TS 24.379 [29] clause 6.6.3.3 and 3GPP TS 24.379 [29] clause 6.6.3.4 shall be used with a XPK equal to the SPK and a XPK-ID equal to the SPK-ID in the following circumstances as described in 3GPP TS 33.180 [27]:\n1)\tIWF sends integrity protected content to an MCPTT server in the same domain; and\n2)\tIWF sends integrity protected content to an MCPTT server in another domain.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_24.379_clause_4.8",
        "ts_24.379_clause_6.6.3.3",
        "ts_24.379_clause_6.6.3.4",
        "ts_24.379",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.8.3.2",
      "section_id": "6.8.3.2",
      "section_title": "Integrity protection at the IWF",
      "content": "The IWF determines locally whether sending integrity protected content from the IWF to an MCPTT server is enabled.\nNOTE 1:\tHow the IWF determines whether to integrity protect content is out of scope of the present document.\nWhen sending integrity protected content, the IWF shall use the appropriate keying information specified in clause 6.8.3.1 and shall perform the procedures in 3GPP TS 24.379 [29] clause 6.6.3.3.3 to integrity protect XML MIME bodies.\nNOTE 2:\tEach XML MIME body is integrity protected separately.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.8.3.1",
        "ts_24.379_clause_6.6.3.3.3",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_6.9",
      "section_id": "6.9",
      "section_title": "Priority sharing",
      "content": "The IWF performing the participating role shall enable or disable priority sharing as specified in 3GPP TS 24.229 [3].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_7",
      "section_id": "7",
      "section_title": "Registration and service authorisation",
      "content": "The present document does not specify any registration or service authorization procedures for users homed in the IWF.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_8",
      "section_id": "8",
      "section_title": "Pre-established session",
      "content": "The present document does not specify any pre-established session procedures for users homed in the IWF.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_9.1",
      "section_id": "9.1",
      "section_title": "General",
      "content": "Clause 9.2.1.2 contains the procedures for explicit and implicit affiliation of a user homed in the IWF at the IWF homing that user.\nClauses in 9.2.1.2 also cover the case where the IWF manages affiliation to a group on behalf of the users homed in that IWF (i.e. having only one affiliation for a whole set of users homed in the IWF). In that case, the IWF needs to implement the same set of procedures but in those procedures, it shall use the MCPTT ID and the MCPTT client ID that are associated with the IWF itself instead of the ones associated with a user homed in the IWF.\nNOTE:\tHow the MCPTT ID and MCPTT client ID associated with the IWF are determined is out of the scope of this specification.\nClause 9.2.1.3 contains the procedures for explicit and implicit affiliation of an MCPTT user at the IWF owning the MCPTT group.\nThe procedures for implicit affiliation in this clause are triggered at the IWF for a user homed in the IWF in the following circumstances:\n-\twhen the IWF performing the participating role attempts to join an MCPTT chat group for a user homed in the IWF that is not already affiliated to the MCPTT group;\n-\twhen the IWF performing the participating role attempts to initiate an MCPTT emergency group call or MCPTT imminent peril group call for a user homed in the IWF that is not already affiliated to the MCPTT group;\n-\twhen the IWF performing the participating role attempts to initiate an MCPTT emergency alert targeted to an MCPTT group for a user homed in the IWF that is not already affiliated to the MCPTT group.\nThe procedures for implicit affiliation in this clause are triggered at the IWF owning the MCPTT group in the following circumstances:\n-\ton receipt of a SIP INVITE request from an MCPTT server serving an MCPTT user where the MCPTT user wants to join an MCPTT chat group homed in the IWF and the MCPTT client is not already affiliated to the MCPTT group homed in the IWF;\n-\ton receipt of a SIP INVITE request from an MCPTT server serving an MCPTT user where the MCPTT user initiates an MCPTT emergency group call or MCPTT imminent peril group call to a group homed in the IWF and the MCPTT client is not already affiliated to the MCPTT group homed in the IWF; and\n-\ton receipt of a SIP MESSAGE request from an MCPTT server serving an MCPTT user when the MCPTT user initiates an MCPTT emergency alert targeted to an MCPTT group homed in the IWF and the MCPTT client is not already affiliated to the MCPTT group homed in the IWF.\nWhen the IWF affiliates to an MCPTT group on behalf of multiple users homed in the IWF using the MCPTT ID and the MCPTT client ID that are associated with the IWF itself, the IWF internally determines when such affiliation is to be made to the MCPTT group and when de-affiliation from the MCPTT group is to be done.\nIt is understood that, since the MCPTT IDs of the actual LMR users participating in the MCPTT group are not provided to the MCPTT system, functions such as listing all affiliated group members and counting affiliated group members can give inaccurate results. It is further understood that the MCPTT ID appearing in call control signalling and floor control messages can be different from the IWF's MCPTT ID and MCPTT client ID.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_9.2.1.2",
        "clause_9.2.1.3"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.1",
      "section_id": "9.2.1.1",
      "section_title": "General",
      "content": "The IWF procedures towards the MCPTT system consist of:\n-\tprocedures towards the MCPTT system of an IWF serving the user homed in the IWF; and\n-\tprocedures of an IWF owning a group that is visible to the MCPTT system.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.1",
      "section_id": "9.2.1.2.1",
      "section_title": "General",
      "content": "The procedures towards the MCPTT system of an IWF serving the user homed in the IWF consist of:\n-\ta receiving subscription to affiliation status procedure;\n-\ta sending notification of change of affiliation status procedure;\n-\ta sending affiliation status change towards MCPTT server owning MCPTT group procedure;\n-\tan affiliation status determination from MCPTT server owning MCPTT group procedure;\n-\tan affiliation status determination procedure;\n-\tan affiliation status change by implicit affiliation procedure;\n-\tan implicit affiliation status change completion procedure;\n-\tan implicit affiliation status change cancellation procedure; and\n-\tan automatic affiliation to configured groups procedure.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.2",
      "section_id": "9.2.1.2.2",
      "section_title": "Stored information",
      "content": "The IWF maintains information equivalent to that defined in TS 24.379 [29] clause 9.2.2.2.2.\nNOTE:\tThe virtual data structure referenced in this clause is for information only. Implementors may choose other means to track affiliation status for users homed in the IWF. References to the elements of this virtual data structure are made in other clauses with the understanding that implementors choosing not to use this virtual data structure will take other appropriate actions.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_9.2.2.2.2",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.3",
      "section_id": "9.2.1.2.3",
      "section_title": "Procedure for handling affiliation status change of a user homed in the IWF",
      "content": "When the IWF determines that affiliation status should change for a user homed in the IWF, the IWF performing the participating role:\n1)\tshall determine the served MCPTT ID associated with the user homed in the IWF;\n2)\tshall determine the candidate expiration interval for the affiliation according to IETF RFC 3903 [21];\n3)\tshall determine the served MCPTT client ID associated with the user homed in the IWF;\n4)\tshall consider an MCPTT user information entry such that:\na)\tthe MCPTT user information entry is in the list of MCPTT user information entries described in clause 9.2.1.2.2; and\nb)\tthe MCPTT ID of the MCPTT user information entry is equal to the served MCPTT ID;\nas the served MCPTT user information entry;\n5)\tshall consider an MCPTT client information entry such that:\na)\tthe MCPTT client information entry is in the list of MCPTT client information entries of the served MCPTT user information entry; and\nb)\tthe MCPTT client ID of the MCPTT client information entry is equal to the served MCPTT client ID;\nas the served MCPTT client information entry;\n6)\tshall consider a copy of the list of the MCPTT group information entries of the served MCPTT client information entry as the served list of the MCPTT group information entries;\n7)\tif the candidate expiration interval is nonzero:\na)\tshall construct the candidate list of the MCPTT group information entries as follows:\ni)\tfor each MCPTT group ID which has an MCPTT group information entry in the served list of the MCPTT group information entries, such that the expiration time of the MCPTT group information entry has not expired yet, and which is determined by the IWF to be a group to which the user homed in the IWF is to be affiliated:\nA)\tshall copy the MCPTT group information entry into a new MCPTT group information entry of the candidate list of the MCPTT group information entries;\nB)\tif the affiliation status of the MCPTT group information entry is \"deaffiliating\" or \"deaffiliated\", shall set the affiliation status of the new MCPTT group information entry to the \"affiliating\" state and shall reset the affiliating p-id of the new MCPTT group information entry; and\nC)\tshall set the expiration time of the new MCPTT group information entry to the current time increased with the candidate expiration interval;\nii)\tfor each MCPTT group ID which has an MCPTT group information entry in the served list of the MCPTT group information entries, such that the expiration time of the MCPTT group information entry has not expired yet, and which is determined by the IWF to be a group to which the user homed in the IWF is not to be affiliated:\nA)\tshall copy the MCPTT group information entry into a new MCPTT group information entry of the candidate list of the MCPTT group information entries; and\nB)\tif the affiliation status of the MCPTT group information entry is \"affiliated\" or \"affiliating\":\n-\tshall set the affiliation status of the new MCPTT group information entry to the \"de-affiliating\" state; and\n-\tshall set the expiration time of the new MCPTT group information entry to the current time increased with twice the value of timer F; and\niii)\tfor each MCPTT group ID:\nA)\twhich does not have an MCPTT group information entry in the served list of the MCPTT group information entries; or\nB)\twhich has an MCPTT group information entry in the served list of the MCPTT group information entries, such that the expiration time of the MCPTT group information entry has already expired;\nand which is determined by the IWF to be a group to which the user homed in the IWF is to be affiliated:\nA)\tshall add a new MCPTT group information entry in the candidate list of the MCPTT group information list for the MCPTT group ID;\nB)\tshall set the affiliation status of the new MCPTT group information entry to the \"affiliating\" state;\nC)\tshall set the expiration time of the new MCPTT group information entry to the current time increased with the candidate expiration interval; and\nD)\tshall reset the affiliating p-id of the new MCPTT group information entry;\nb)\tdetermine the candidate number of MCPTT group IDs as the number of different MCPTT group IDs which have an MCPTT group information entry:\ni)\tin the candidate list of the MCPTT group information entries; or\nii)\tin the list of the MCPTT group information entries of an MCPTT client information entry such that:\nA)\tthe MCPTT client information entry is in the list of the MCPTT client information entries of the served MCPTT user information entry; and\nB)\tthe MCPTT client ID of the MCPTT client information entry is not equal to the served MCPTT client ID;\nwith the affiliation status set to the \"affiliating\" state or the \"affiliated\" state and with the expiration time which has not expired yet; and\nc)\tif the candidate number of MCPTT group IDs is bigger than N2 value of the served MCPTT ID, shall be based on service provider policy reduce the candidate MCPTT group IDs to that equal to N2;\nNOTE:\tThe service provider policy can determine to remove an MCPTT group ID based on the importance or priority of the MCPTT group or some other policy to determine which groups are preferred.\n8)\tif the candidate expiration interval is zero, constructs the candidate list of the MCPTT group information entries as follows:\na)\tfor each MCPTT group ID which has an entry in the served list of the MCPTT group information entries:\ni)\tshall copy the MCPTT group entry of the served list of the MCPTT group information into a new MCPTT group information entry of the candidate list of the MCPTT group information entries;\nii)\tshall set the affiliation status of the new MCPTT group information entry to the \"de-affiliating\" state; and\niii)\tshall set the expiration time of the new MCPTT group information entry to the current time increased with twice the value of timer F;\n9)\tshall replace the list of the MCPTT group information entries stored in the served MCPTT client information entry with the candidate list of the MCPTT group information entries;\n10)\tshall perform the procedures specified in clause 9.2.1.2.6 for the served MCPTT ID and each MCPTT group ID:\na)\twhich does not have an MCPTT group information entry in the served list of the MCPTT group information entries and which has an MCPTT group information entry in the candidate list of the MCPTT group information entries with the affiliation status set to the \"affiliating\" state;\nb)\twhich has an MCPTT group information entry in the served list of the MCPTT group information entries with the expiration time already expired, and which has an MCPTT group information entry in the candidate list of the MCPTT group information entries with the affiliation status set to the \"affiliating\" state;\nc)\twhich has an MCPTT group information entry in the served list of the MCPTT group information entries with the affiliation status set to the \"deaffiliating\" state or the \"deaffiliated\" state and with the expiration time not expired yet, and which has an MCPTT group information entry in the candidate list of the MCPTT group information entries with the affiliation status set to the \"affiliating\" state; or\nd)\twhich has an MCPTT group information entry in the served list of the MCPTT group information entries with the affiliation status set to the \"affiliated\" state and with the expiration time not expired yet, and which has an MCPTT group information entry in the candidate list of the MCPTT group information entries with the affiliation status set to the \"de-affiliating\" state.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.1.2.2",
        "clause_9.2.1.2.6"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.4",
      "section_id": "9.2.1.2.4",
      "section_title": "Receiving subscription to affiliation status procedure",
      "content": "Upon receiving a SIP SUBSCRIBE request such that:\n1)\tthe Request-URI of the SIP SUBSCRIBE request contains the public service identity identifying the IWF performing the terminating participating role serving the user homed in the IWF;\n2)\tthe SIP SUBSCRIBE request contains an application/vnd.3gpp.mcptt-info+xml MIME body containing the<mcptt-request-uri> element which identifies an MCPTT ID associated with a user homed in the IWF performing the terminating participating role;\n3)\tthe SIP SUBSCRIBE request contains the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service header field according to IETF RFC 6050 [7]; and\n4)\tthe Event header field of the SIP SUBSCRIBE request contains the \"presence\" event type;\nthe IWF performing the terminating participating role:\n1)\tif the IWF does not support receiving a SIP SUBSCRIBE request to the affiliation status of a user homed in the IWF, the IWF shall generate and send a SIP 501 (Not Implemented) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [3], IETF RFC 6665 [25], and shall skip the remainder of this procedure;\n2)\tshall identify the served MCPTT ID in the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP SUBSCRIBE request;\n3)\tif the Request-URI of the SIP SUBSCRIBE request contains the public service identity identifying the IWF performing the terminating participating role serving the user homed in the IWF, shall identify the originating MCPTT ID in the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP SUBSCRIBE request;\n4)\tif the originating MCPTT ID is not authorized to subscribe to the affiliation status of the user homed in the IWF, shall send a 403 (Forbidden) response and shall not continue with the rest of the steps; and\n5)\tshall generate a 200 (OK) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [3], IETF RFC 6665 [25].\nFor the duration of the subscription, the IWF performing the terminating participating role shall notify the subscriber about changes of the information of the served MCPTT ID, as described in clause 9.2.1.2.5.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.1.2.5",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.5",
      "section_id": "9.2.1.2.5",
      "section_title": "Sending notification of change of affiliation status procedure",
      "content": "In order to notify the subscriber about changes of the served MCPTT ID, the IWF:\nNOTE:\tthe served MCPTT ID identifies the user homed in the IWF whose affiliation status has been subscribed.\n1)\tshall consider an MCPTT user information entry such that:\na)\tthe MCPTT user information entry is in the list of MCPTT user information entries described in clause 9.2.1.2.2; and\nb)\tthe MCPTT ID of the MCPTT user information entry is equal to the served MCPTT ID;\nas the served MCPTT user information entry;\n2)\tshall consider the list of the MCPTT client information entries of the served MCPTT user information entry as the served list of the MCPTT client information entries;\n3)\tshall generate an application/pidf+xml MIME body indicating per-user affiliation information according to 3GPP TS 24.379 [29], clause 9.3.1 and the served list of the MCPTT client information entries with the following clarifications:\na)\tthe IWF shall not include information from an MCPTT group information entry with the expiration time already expired;\nb)\tthe IWF shall not include information from an MCPTT group information entry with the affiliation status set to the \"deaffiliated\" state; and\nc)\tif the SIP SUBSCRIBE request creating the subscription of this notification contains an application/simple-filter+xml MIME body indicating per-client restrictions of presence event package notification information according to 3GPP TS 24.379 [29], clause 9.3.2, the IWF shall restrict the application/pidf+xml MIME body according to the application/simple-filter+xml MIME body; and\n4)\tsend a SIP NOTIFY request according to 3GPP TS 24.229 [3], and IETF RFC 6665 [25] for the subscription created in clause 9.2.1.2.4. In the SIP NOTIFY request, the IWF shall include the generated application/pidf+xml MIME body indicating per-user affiliation information.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.1.2.2",
        "ts_24.379_clause_9.3.1",
        "ts_24.379_clause_9.3.2",
        "clause_9.2.1.2.4",
        "ts_24.379",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.6",
      "section_id": "9.2.1.2.6",
      "section_title": "Sending affiliation status change towards MCPTT server owning MCPTT group procedure",
      "content": "NOTE 1:\tUsage of one SIP PUBLISH request to carry information about change of affiliation state of several users homed in the same IWF and/or to several MCPTT groups owned by the same MCPTT server is not supported in this version of the specification.\nIn order:\n-\tto send an affiliation request of a user homed in the IWF to a handled MCPTT group ID;\n-\tto send a de-affiliation request of a user homed in the IWF from a handled MCPTT group ID; or\n-\tto send an affiliation request of a user homed in the IWF to a handled MCPTT group ID due to near expiration of the previously published information;\nthe IWF shall generate a SIP PUBLISH request according to 3GPP TS 24.229 [3], IETF RFC 3903 [21] and IETF RFC 3856 [24]. In the SIP PUBLISH request, the IWF:\n1)\tshall set the Request-URI to the public service identity of the controlling MCPTT function associated with the handled MCPTT group ID;\n2)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body. In the application/vnd.3gpp.mcptt-info+xml MIME body, the MCPTT server:\na)\tshall include the <mcptt-request-uri> element set to the handled MCPTT group ID; and\nb)\tshall include the <mcptt-calling-user-id> element set to MCPTT ID associated with the user homed in the IWF;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tif sending an affiliation request, shall set the Expires header field according to IETF RFC 3903 [21], to 4294967295;\nNOTE 2:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [14].\n5)\tif sending a de-affiliation request, shall set the Expires header field according to IETF RFC 3903 [21], to zero;\n6)\tshall include a P-Asserted-Identity header field set to the public service identity of the IWF according to 3GPP TS 24.229 [3];\n7)\tshall set the current p-id to a globally unique value;\n8)\tshall consider an MCPTT user information entry such that:\na)\tthe MCPTT user information entry is in the list of MCPTT user information entries described in clause 9.2.1.2.2; and\nb)\tthe MCPTT ID of the MCPTT user information entry is equal to the MCPTT ID associated with the user homed in the IWF;\nas the served MCPTT user information entry;\n9)\tfor each MCPTT group information entry such that:\na)\tthe MCPTT group information entry has the \"affiliating\" affiliation status, the MCPTT group ID set to the handled MCPTT group ID, the expiration time has not expired yet and the affiliating p-id is not set;\nb)\tthe MCPTT group information entry is in the list of the MCPTT group information entries of an MCPTT client information entry; and\nc)\tthe MCPTT client information entry is in the list of the MCPTT client information entries of the served MCPTT user information entry;\nshall set the affiliating p-id of the MCPTT group information entry to the current p-id; and\n10)\tshall include an application/pidf+xml MIME body indicating per-group affiliation information for a user homed in the IWF constructed according to 3GPP TS 24.379 [29], clause 9.3.1.2. The IWF shall indicate all MCPTT client IDs associated with the user homed in the IWF, such that:\na)\tthe affiliation status is set to \"affiliating\" or \"affiliated\", and the expiration time has not expired yet in an MCPTT group information entry with the MCPTT group ID set to the handled MCPTT group;\nb)\tthe MCPTT group information entry is in the list of the MCPTT group information entries of an MCPTT client information entry;\nc)\tthe MCPTT client information entry has the MCPTT client ID set to the served MCPTT client ID; and\nd)\tthe MCPTT client information entry is in the list of the MCPTT client information entries of the served MCPTT user information entry.\nThe IWF shall set the <p-id> child element of the <presence> root element to the current p-id.\nThe IWF shall not include the \"expires\" attribute in the <affiliation> element.\nThe IWF shall send the SIP PUBLISH request according to 3GPP TS 24.229 [3].\nIf timer F expires for the SIP PUBLISH request sent for a (de)affiliation request of the user homed in the IWF to the MCPTT group ID or upon receiving a SIP 3xx, 4xx, 5xx or 6xx response to the SIP PUBLISH request, the IWF:\n1)\tshall remove each MCPTT group ID entry such that:\na)\tthe MCPTT group information entry has the MCPTT group ID set to the handled MCPTT group ID;\nb)\tthe MCPTT group information entry is in the list of the MCPTT group information entries of an MCPTT client information entry; and\nc)\tthe MCPTT client information entry is in the list of the MCPTT client information entries of the served MCPTT user information entry.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.1.2.2",
        "ts_24.379_clause_9.3.1.2",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.7",
      "section_id": "9.2.1.2.7",
      "section_title": "Affiliation status determination from MCPTT server owning MCPTT group procedure.",
      "content": "NOTE 1:\tUsage of one SIP SUBSCRIBE request to subscribe for notification about change of affiliation state of several users homed in the same IWF is not supported in this version of the specification.\nIn order to discover whether a user homed in the IWF was successfully affiliated to a handled MCPTT group in the MCPTT server owning the handled MCPTT group, the IWF shall generate an initial SIP SUBSCRIBE request according to 3GPP TS 24.229 [3], IETF RFC 3856 [24], and IETF RFC 6665 [25].\nIn the SIP SUBSCRIBE request, the IWF:\n1)\tshall set the Request-URI to the public service identity of the controlling MCPTT function associated with the handled MCPTT group ID;\n2)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body. In the application/vnd.3gpp.mcptt-info+xml MIME body, the IWF:\na)\tshall include the <mcptt-request-uri> element set to the handled MCPTT group ID; and\nb)\tshall include the <mcptt-calling-user-id> element set to the MCPTT ID associated with the user homed in the IWF;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tif the IWF wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [25], to 4294967295;\nNOTE 2:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [14].\n5)\tif the IWF wants to fetch the current state only, shall set the Expires header field according to IETF RFC 6665 [25], to zero;\n6)\tshall include an Accept header field containing the application/pidf+xml MIME type; and\n7)\tshall include an application/simple-filter+xml MIME body indicating per-user restrictions of presence event package notification information according to 3GPP TS 24.379 [29], clause 9.3.2, indicating the MCPTT ID associated with the user homed in the IWF.\nThe IWF shall send the SIP SUBSCRIBE request according to 3GPP TS 24.229 [3].\nIn order to re-subscribe or de-subscribe, the IWF shall generate an in-dialog SIP SUBSCRIBE request according to 3GPP TS 24.229 [3], IETF RFC 3856 [24], and IETF RFC 6665 [25]. In the SIP SUBSCRIBE request, the IWF:\n1)\tif the IWF wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [25], to 4294967295;\nNOTE 3:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [14].\n2)\tif the MCPTT server wants to de-subscribe, shall set the Expires header field according to IETF RFC 6665 [25], to zero; and\n3)\tshall include an Accept header field containing the application/pidf+xml MIME type.\nUpon receiving a SIP NOTIFY request according to 3GPP TS 24.229 [3], IETF RFC 3856 [24], and IETF RFC 6665 [25], if the SIP NOTIFY request contains an application/pidf+xml MIME body indicating per-group affiliation information constructed according to 3GPP TS 24.379 [29], clause 9.3.1, then the IWF:\n1)\tfor each served MCPTT ID and served MCPTT client ID such that the application/pidf+xml MIME body of SIP NOTIFY request contains:\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the MCPTT ID associated with the user homed in the IWF;\nc)\tan <affiliation> child element of the <status> element of the <tuple> element;\nd)\tthe \"client\" attribute of the <affiliation> element indicating the MCPTT client ID associated with the user homed in the IWF; and\ne)\tthe \"expires\" attribute of the <affiliation> element indicating expiration of affiliation;\nperform the following:\na)\tif an MCPTT group information entry exists such that:\ni)\tthe MCPTT group information entry has the \"affiliating\" affiliation status, the MCPTT group ID set to the handled MCPTT group ID, and the expiration time has not expired yet;\nii)\tthe MCPTT group information entry is in the list of the MCPTT group information entries of an MCPTT client information entry with the MCPTT client ID set to the MCPTT client ID associated with the user homed in the IWF;\niii)\tthe MCPTT client information entry is in the list of the MCPTT client information entries of a served MCPTT user information entry with the MCPTT ID set to the MCPTT ID associated with the user homed in the IWF; and\niv)\tthe MCPTT user information entry is in the list of MCPTT user information entries described in clause 9.2.1.2.2; and\nb)\tshall set the affiliation status of the MCPTT group information entry to \"affiliated\"; and\nc)\tshall set the next publishing time of the MCPTT group information entry to the current time and half of the time between the current time and the expiration of affiliation;\n2)\tfor each MCPTT group information entry such that:\na)\tthe MCPTT group information entry has the \"affiliated\" affiliation status or the \"deaffiliating\" affiliation status, the MCPTT group ID set to the handled MCPTT group ID, and the expiration time has not expired yet;\nb)\tthe MCPTT group information entry is in the list of the MCPTT group information entries of an MCPTT client information entry with the MCPTT client ID set to the MCPTT client ID associated with the user homed in the IWF;\nc)\tthe MCPTT client information entry is in the list of the MCPTT client information entries of the served MCPTT user information entry with the MCPTT ID set to the MCPTT ID associated with the user homed in IWF; and\nd)\tthe MCPTT user information entry is in the list of MCPTT user information entries described in clause 9.2.1.2.2; and\nfor which the application/pidf+xml MIME body of SIP NOTIFY request does not contain\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the MCPTT ID associated with the user homed in the IWF;\nc)\tan <affiliation> child element of the <status> child element of the <tuple> element; and\nd)\tthe \"client\" attribute of the <affiliation> element indicating the MCPTT client ID associated with the user homed in the IWF;\nperform the following:\na)\tshall set the affiliation status of the MCPTT group information entry to \"deaffiliated\"; and\nb)\tshall set the expiration time of the MCPTT group information entry to the current time; and\n3)\tif a <p-id> element is included in the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request, then for each MCPTT group information entry such that:\na)\tthe MCPTT group information entry has the \"affiliating\" affiliation status, the MCPTT group ID set to the handled MCPTT group ID, the expiration time has not expired yet and with the affiliating p-id set to the value of the <p-id> element;\nb)\tthe MCPTT group information entry is in the list of the MCPTT group information entries of an MCPTT client information entry with the MCPTT client ID set to the MCPTT client ID associated with the user homed in the IWF;\nc)\tthe MCPTT client information entry is in the list of the MCPTT client information entries of the served MCPTT user information entry with the MCPTT ID set to the MCPTT ID associated with the user homed in the IWF; and\nd)\tthe MCPTT user information entry is in the list of MCPTT user information entries described in clause 9.2.1.2.2; and\nfor which the application/pidf+xml MIME body of SIP NOTIFY request does not contain:\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the MCPTT ID associated with the user homed in the IWF;\nc)\tan <affiliation> child element of the <status> child element of the <tuple> element; and\nd)\tthe \"client\" attribute of the <affiliation> element indicating the MCPTT client ID associated with the user homed in the IWF;\nperform the following:\na)\tshall set the affiliation status of the MCPTT group information entry to \"deaffiliated\"; and\nb)\tshall set the expiration time of the MCPTT group information entry to the current time.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_24.379_clause_9.3.2",
        "ts_24.379_clause_9.3.1",
        "clause_9.2.1.2.2",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.8",
      "section_id": "9.2.1.2.8",
      "section_title": "Affiliation status determination",
      "content": "This clause is referenced from other procedures.\nIf the IWF performing the participating role needs to determine the affiliation status of a user homed in the IWF to an MCPTT group, the IWF performing the participating role:\n1)\tshall determine the client and MCPTT client ID associated with the user homed in the IWF;\n2)\tshall find the user information entry in the list of MCPTT user information entries described in clause 9.2.1.2.2 such that the MCPTT ID of the MCPTT user information entry is equal to the MCPTT ID associated with the user homed in the IWF;\na)\tif the applicable MCPTT group information entry cannot be found, then the IWF performing the participating role shall determine that the user homed in the IWF is not affiliated to the MCPTT group at the determined client and the skip the rest of the steps;\n3)\tshall find the MCPTT client information entry in the list of MCPTT client information entries of MCPTT user information entry found in step 1) in which the MCPTT client id matches the value of the determined MCPTT client ID;\na)\tif the applicable MCPTT client information entry cannot be found, then the IWF performing the participating role shall determine that the user homed in the IWF is not affiliated to the MCPTT group at the determined client and the skip the rest of the steps;\n4)\tshall find the MCPTT group information entry in the list of MCPTT group information entries of MCPTT client information entry found in step 2 such that the MCPTT group identity matches the value of the identity of the targeted MCPTT group;\na)\tif the applicable MCPTT group information entry was found in step 3) and the affiliation status of the MCPTT group information entry is \"affiliating\" or \"affiliated\", shall determine that the user homed in the IWF at the determined client is affiliated to the targeted MCPTT group and skip the rest of the steps;\nb)\tif the applicable MCPTT group information entry was found in step 3) and the affiliation status of the MCPTT group information entry is \"deaffiliating\" or \"deaffiliated\", shall determine that the user homed in the IWF at the determined client to is not affiliated to the targeted MCPTT group and skip the rest of the steps; or\nc)\tif the applicable MCPTT group information entry was not found in step 3), shall determine that the user homed in the IWF at the determined client is not affiliated to the targeted MCPTT group.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.2.1.2.2"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.9",
      "section_id": "9.2.1.2.9",
      "section_title": "Affiliation status change by implicit affiliation",
      "content": "This clause is referenced from other procedures.\nUpon determining that a user homed in the IWF is to be implicitly affiliated to an MCPTT group as per the triggers defined in clause 9.1, the IWF performing the participating role:\n1)\tshall determine the served MCPTT client ID as being the MCPTT ID associated with the user homed in the IWF;\n2)\tshall determine the MCPTT group ID to which the user homed in the IWF is to be implicitly affiliated;\n3)\tshall determine the served MCPTT ID as being the MCPTT ID associated with the user homed in the IWF;\n4)\tshall consider an MCPTT user information entry such that:\na)\tthe MCPTT user information entry is in the list of MCPTT user information entries described in clause 9.2.1.2.2; and\nb)\tthe MCPTT ID of the MCPTT user information entry is equal to the served MCPTT ID;\nas the served MCPTT user information entry;\n5)\tshall consider an MCPTT client information entry such that:\na)\tthe MCPTT client information entry is in the list of MCPTT client information entries of the served MCPTT user information entry; and\nb)\tthe MCPTT client ID of the MCPTT client information entry is equal to the served MCPTT client ID;\nas the served MCPTT client information entry;\n6)\tshall consider a copy of the list of the MCPTT group information entries of the served MCPTT client information entry as the served list of the MCPTT group information entries;\n7)\tshall construct the candidate list of the MCPTT group information entries as follows:\na)\tfor each MCPTT group ID which has an MCPTT group information entry in the served list of the MCPTT group information entries shall copy the MCPTT group information entry into a new MCPTT group information entry of the candidate list of the MCPTT group information entries; and\nb)\tif the determined MCPTT group ID does not have an MCPTT group information entry in the served list of the MCPTT group information entries or has an MCPTT group information entry in the served list of the MCPTT group information entries, such that the expiration time of the MCPTT group information entry has already expired:\ni)\tshall add a new MCPTT group information entry in the candidate list of the MCPTT group information list for the determined MCPTT group ID;\nii)\tshall set the affiliation status of the new MCPTT group information entry to the \"affiliating\" state; and\niii)\tshall set the expiration time of the new MCPTT group information entry to the current time increased with the candidate expiration interval;\n8)\tdetermine the candidate number of MCPTT group IDs as the number of different MCPTT group IDs which have an MCPTT group information entry:\na)\tin the candidate list of the MCPTT group information entries; or\nb)\tin the list of the MCPTT group information entries of an MCPTT client information entry such that:\ni)\tthe MCPTT client information entry is in the list of the MCPTT client information entries of the served MCPTT user information entry; and\nii)\tthe MCPTT client ID of the MCPTT client information entry is not equal to the served MCPTT client ID;\nwith the affiliation status set to the \"affiliating\" state or the \"affiliated\" state and with the expiration time which has not expired yet; and\n9)\tif the candidate number of MCPTT group IDs is bigger than the N2 value of the served MCPTT ID, shall be based on MCPTT service provider policy reduce the candidate MCPTT group IDs to that equal to N2;\nNOTE:\tThe MCPTT service provider policy can determine to remove an MCPTT group ID based on the importance or priority of other MCPTT groups, received SIP requests containing an authorised request for originating a priority call as determined by clause 6.6.2.1.4.2 or other policy to determine which MCPTT groups are preferred.\n10)\tif the determined MCPTT group ID cannot be added to the candidate list of the MCPTT group information entries due to exceeding the N2 limit for the user homed in the IWF, shall discard the candidate list of the MCPTT group information entries and skip the remaining steps of the current procedure; and\n11)\tshall replace the list of the MCPTT group information entries stored in the served MCPTT client information entry with the candidate list of the MCPTT group information entries.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1",
        "clause_9.2.1.2.2",
        "clause_6.6.2.1.4.2"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.10",
      "section_id": "9.2.1.2.10",
      "section_title": "Implicit affiliation status change completion",
      "content": "This clause is referenced from other procedures.\nIf the IWF performing the participating role has received a SIP 2xx response from the controlling MCPTT function to a SIP request that had triggered an affiliation status change by implicit affiliation as per clause 9.2.1.2.9, the IWF performing the participating role:\n1)\tshall set the affiliation status of the MCPTT group information entry added to the candidate list of the MCPTT group information entries by the procedures of clause 9.2.1.2.9 to \"affiliated\"; and\n2)\tshall perform the procedures specified in clause 9.2.1.2.5 for the MCPTT ID associated with the user homed in the IWF.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.2.1.2.9",
        "clause_9.2.1.2.5"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.11",
      "section_id": "9.2.1.2.11",
      "section_title": "Implicit affiliation status change cancellation",
      "content": "This clause is referenced from other procedures.\nIf the IWF performing the participating role for a user homed in the IWF receives a SIP 4xx, 5xx or 6xx response from the controlling MCPTT function to a SIP request that had triggered an affiliation status change by implicit affiliation as per clause 9.2.1.2.9, the IWF performing the participating role:\n1)\tshall remove the MCPTT group ID entry added by the procedures of clause 9.2.1.2.9 such that:\na)\tthe MCPTT group information entry has the MCPTT group ID set to the MCPTT group ID of the MCPTT group targeted by the received SIP request;\nb)\tthe MCPTT group information entry is in the list of the MCPTT group information entries of an MCPTT client information entry containing the MCPTT client ID associated with the user homed in the IWF; and\nc)\tthe MCPTT client information entry is in the list of the MCPTT client information entries of the MCPTT user information entry containing the MCPTT ID associated with the user homed in the IWF.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.2.1.2.9"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.2.12",
      "section_id": "9.2.1.2.12",
      "section_title": "Automatic affiliation to configured groups procedure",
      "content": "This clause is referenced from other procedures.\nWhen the IWF determines that automatic affiliation of a user homed in the IWF to configured groups is needed, the IWF shall perform procedures 9.2.1.2.6 and 9.2.1.2.7 for the user homed in the IWF and the targeted groups.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_9.2.1.3.1",
      "section_id": "9.2.1.3.1",
      "section_title": "General",
      "content": "The procedures of the IWF owning the MCPTT group consist of:\n-\treceiving group affiliation status change procedure;\n-\treceiving subscription to affiliation status procedure;\n-\tsending notification of change of affiliation status procedure;\n-\taffiliation eligibility check procedure;\n-\timplicit affiliation eligibility check procedure;\n-\taffiliation status change by implicit affiliation procedure;\n-\treceiving subscription to group dynamic data procedure and;\n-\tsending notification of change of group dynamic data procedure.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_9.2.1.3.2",
      "section_id": "9.2.1.3.2",
      "section_title": "Stored information",
      "content": "The IWF maintains information equivalent to that defined in clause 9.2.1.3.2.\nNOTE:\tThe virtual data structure referenced in this clause is for information only. Implementors may choose other means to track affiliation status to groups owned by the IWF. References to the elements of this virtual data structure are made in other clauses with the understanding that implementors choosing not to use this virtual data structure will take other appropriate actions.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.2.1.3.2"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.3.3",
      "section_id": "9.2.1.3.3",
      "section_title": "Receiving group affiliation status change procedure",
      "content": "Upon receiving a SIP PUBLISH request such that:\n1)\tRequest-URI of the SIP PUBLISH request contains the public service identity of the IWF owning the served MCPTT group;\n2)\tthe SIP PUBLISH request contains an application/vnd.3gpp.mcptt-info+xml MIME body containing the <mcptt-request-uri> element and the <mcptt-calling-user-id> element;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tthe Event header field of the SIP PUBLISH request contains the \"presence\" event type; and\n5)\tThe SIP PUBLISH request contains an application/pidf+xml MIME body indicating per-group affiliation information constructed according to 3GPP TS 24.379 [29], clause 9.3.1.2, with the IWF acting as the controlling MCPTT function;\nthen the IWF:\n1)\tshall identify the served MCPTT group ID in the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP PUBLISH request;\n2)\tshall identify the handled MCPTT ID in the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP PUBLISH request;\n3)\tif the Expires header field of the SIP PUBLISH request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP PUBLISH request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n4)\tif an MCPTT group for the served MCPTT group ID does not exist in the IWF, shall reject the SIP PUBLISH request with SIP 403 (Forbidden) response to the SIP PUBLISH request according to 3GPP TS 24.229 [3], IETF RFC 3903 [21] and IETF RFC 3856 [24] and skip the rest of the steps;\n5)\tif the handled MCPTT ID is not a member of the MCPTT group identified by the served MCPTT group ID, shall reject the SIP PUBLISH request with SIP 403 (Forbidden) response to the SIP PUBLISH request according to 3GPP TS 24.229 [3], IETF RFC 3903 [21] and IETF RFC 3856 [24] and skip the rest of the steps;\n6)\tshall respond with SIP 200 (OK) response to the SIP PUBLISH request according to 3GPP TS 24.229 [3], IETF RFC 3903 [21]. In the SIP 200 (OK) response, the IWF:\na)\tshall set the Expires header field according to IETF RFC 3903 [21], to the selected expiration time;\n7)\tif the \"entity\" attribute of the <presence> element of the application/pidf+xml MIME body of the SIP PUBLISH request is different than the served MCPTT group ID, shall not continue with the rest of the steps;\n8)\tif the handled MCPTT ID is different from the MCPTT ID in the \"id\" attribute of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request, shall not continue with the rest of the steps;\n9)\tshall consider an MCPTT group information entry such that:\na)\tthe MCPTT group information entry is in the list of MCPTT group information entries described in clause 9.2.1.3.2; and\nb)\tthe MCPTT group ID of the MCPTT group information entry is equal to the served MCPTT group ID;\nas the served MCPTT group information entry;\n10)\tif the selected expiration time is zero:\na)\tshall remove the MCPTT user information entry such that:\ni)\tthe MCPTT user information entry is in the list of the MCPTT user information entries of the served MCPTT group information entry; and\nii)\tthe MCPTT user information entry has the MCPTT ID set to the handled MCPTT ID;\n11)\tif the selected expiration time is not zero:\na)\tshall consider an MCPTT user information entry such that:\ni)\tthe MCPTT user information entry is in the list of the MCPTT user information entries of the served MCPTT group information entry; and\nii)\tthe MCPTT ID of the MCPTT user information entry is equal to the handled MCPTT ID;\nas the served MCPTT user information entry;\nb)\tif the MCPTT user information entry does not exist:\ni)\tshall insert an MCPTT user information entry with the MCPTT ID set to the handled MCPTT ID into the list of the MCPTT user information entries of the served MCPTT group information entry; and\nii)\tshall consider the inserted MCPTT user information entry as the served MCPTT user information entry; and\nc)\tshall set the following information in the served MCPTT user information entry:\ni)\tset the MCPTT client ID list according to the \"client\" attributes of the <affiliation> elements of the <status> element of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request; and\nii)\tset the expiration time according to the selected expiration time;\n12)\tshall identify the handled p-id in the <p-id> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request; and\n13)\tshall perform the procedures specified in clause 9.2.1.3.5 for the served MCPTT group ID.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_24.379_clause_9.3.1.2",
        "clause_9.2.1.3.2",
        "clause_9.2.1.3.5",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.3.4",
      "section_id": "9.2.1.3.4",
      "section_title": "Receiving subscription to affiliation status procedure",
      "content": "NOTE:\tUsage of one SIP SUBSCRIBE request to subscribe for notification about change of affiliation state of several MCPTT users served by the same IWF is not supported in this version of the specification.\nUpon receiving a SIP SUBSCRIBE request such that:\n1)\tRequest-URI of the SIP SUBSCRIBE request contains the public service identity of the IWF owning the served MCPTT group;\n2)\tthe SIP SUBSCRIBE request contains an application/vnd.3gpp.mcptt-info+xml MIME body containing the<mcptt-request-uri> element and the <mcptt-calling-user-id> element;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tthe Event header field of the SIP SUBSCRIBE request contains the \"presence\" event type; and\n5)\tthe SIP SUBSCRIBE request contains an application/simple-filter+xml MIME body indicating per-user restrictions of presence event package notification information according to 3GPP TS 24.379 [29], clause 9.3.2 indicating the same MCPTT ID as in the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP SUBSCRIBE request;\nthen the IWF:\n1)\tshall identify the served MCPTT group ID in the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP SUBSCRIBE request;\n2)\tshall identify the handled MCPTT ID in the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP SUBSCRIBE request;\n3)\tif the Expires header field of the SIP SUBSCRIBE request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP SUBSCRIBE request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n4)\tif an MCPTT group for the served MCPTT group ID does not exist in the IWF, shall reject the SIP SUBSCRIBE request with SIP 403 (Forbidden) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [3], IETF RFC 3903 [21] and IETF RFC 3856 [24] and skip the rest of the steps;\n5)\tif the handled MCPTT ID is not a member of the MCPTT group identified by the served MCPTT group ID, shall reject the SIP SUBSCRIBE request with SIP 403 (Forbidden) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [3], IETF RFC 3903 [21] and IETF RFC 3856 [24] and skip the rest of the steps; and\n6)\tshall generate and send a SIP 200 (OK) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [3], IETF RFC 6665 [25].\nFor the duration of the subscription, the IWF shall notify subscriber about changes of the information of the served MCPTT ID, as described in clause 9.2.1.3.5.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_24.379_clause_9.3.2",
        "clause_9.2.1.3.5",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.3.5",
      "section_id": "9.2.1.3.5",
      "section_title": "Sending notification of change of affiliation status procedure",
      "content": "In order to notify the subscriber identified by the handled MCPTT ID about changes of the affiliation status of the served MCPTT group ID, the IWF:\n1)\tshall consider an MCPTT group information entry such that:\na)\tthe MCPTT group information entry is in the list of MCPTT group information entries described in clause 9.2.1.3.2; and\nb)\tthe MCPTT group ID of the MCPTT group information entry is equal to the served MCPTT group ID;\n2)\tshall consider an MCPTT user information entry such:\na)\tthe MCPTT user information entry is in the list of the MCPTT user information entries of the served MCPTT group information entry; and\nb)\tthe MCPTT ID of the MCPTT user information entry is equal to the handled MCPTT ID;\nas the served MCPTT user information entry;\n3)\tshall generate an application/pidf+xml MIME body indicating per-group affiliation information according to 3GPP TS 24.379 [29], clause 9.3.1 and the served list of the served MCPTT user information entry of the MCPTT group information entry with following clarifications:\na)\tthe MCPTT server shall include the \"expires\" attribute in the <affiliation> element; and\nb)\tif this procedure is invoked by procedure in clause 9.2.1.3.3 where the handled p-id was identified, the IWF shall set the <p-id> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request to the handled p-id value; and\n4)\tsend a SIP NOTIFY request according to 3GPP TS 24.229 [3], and IETF RFC 6665 [25] for the subscription created in clause 9.2.1.3.4. In the SIP NOTIFY request, the IWF shall include the generated application/pidf+xml MIME body indicating per-group affiliation information.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.1.3.2",
        "ts_24.379_clause_9.3.1",
        "clause_9.2.1.3.3",
        "clause_9.2.1.3.4",
        "ts_24.379",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.3.6",
      "section_id": "9.2.1.3.6",
      "section_title": "Implicit affiliation eligibility check procedure",
      "content": "This clause is referenced from other procedures.\nUpon receiving a SIP request for an MCPTT group that the MCPTT user is not currently affiliated to and that requires the IWF performing the controlling role to check on the eligibility of the MCPTT user to be implicitly affiliated to the MCPTT group, the IWF performing the controlling role:\n1)\tshall perform the procedures of clause 9.2.1.3.8 to determine if the MCPTT user is eligible to be affiliated to the MCPTT group; and\n2)\tif the MCPTT user was determined eligible to be affiliated to the MCPTT group by the procedures of clause 9.2.1.3.8, shall consider the MCPTT user to be eligible for implicit affiliation to the MCPTT group.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.1.3.8"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.3.7",
      "section_id": "9.2.1.3.7",
      "section_title": "Affiliation status change by implicit affiliation procedure",
      "content": "This clause is referenced from other procedures.\nUpon receiving a SIP request for an MCPTT group that the MCPTT user is not currently affiliated to and that requires the IWF performing the controlling role to perform an implicit affiliation to, the IWF performing the controlling role:\n1)\tshall identify the served MCPTT group ID in the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP request;\n2)\tshall identify the handled MCPTT ID in the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP request;\n3)\tshall consider an MCPTT group information entry such that:\na)\tthe MCPTT group information entry is in the list of MCPTT group information entries described in clause 9.2.1.3.2 with the IWF acting as the controlling MCPTT function; and\nb)\tthe MCPTT group ID of the MCPTT group information entry is equal to the served MCPTT group ID;\nas the served MCPTT group information entry;\n4)\tshall consider an MCPTT user information entry such that:\na)\tthe MCPTT user information entry is in the list of the MCPTT user information entries of the served MCPTT group information entry; and\nb)\tthe MCPTT ID of the MCPTT user information entry is equal to the handled MCPTT ID;\nas the served MCPTT user information entry;\nc)\tif the MCPTT user information entry does not exist:\ni)\tshall insert an MCPTT user information entry with the MCPTT ID set to the handled MCPTT ID into the list of the MCPTT user information entries of the served MCPTT group information entry; and\nii)\tshall consider the inserted MCPTT user information entry as the served MCPTT user information entry; and\nd)\tshall make the following modifications in the served MCPTT user information entry:\ni)\tadd the MCPTT client ID derived from the received SIP request to the MCPTT client ID list if not already present; and\nii)\tset the expiration time as determined by local policy;\n5)\tshall perform the procedures specified in clause 9.2.1.3.5 for the served MCPTT group ID.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.1.3.2",
        "clause_9.2.1.3.5"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.3.8",
      "section_id": "9.2.1.3.8",
      "section_title": "Affiliation eligibility check procedure",
      "content": "This clause is referenced from other procedures.\nUpon receiving a SIP request for an MCPTT group that the MCPTT user is not currently affiliated to and that requires the IWF performing the controlling role to check on the eligibility of the MCPTT user to be affiliated to the MCPTT group, the IWF performing the controlling role:\n1)\tshall identify the served MCPTT group ID in the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP request;\n2)\tshall identify the handled MCPTT ID in the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP request;\n3)\tif an MCPTT group for the served MCPTT group ID does not exist in the IWF, shall consider the MCPTT user to be ineligible for affiliation and skip the rest of the steps;\n4)\tif the handled MCPTT ID is not a member of the MCPTT group identified by the served MCPTT group ID, shall consider the MCPTT user to be ineligible for affiliation and skip the rest of the steps;\n5)\tif there is no MCPTT group information entry in the list of MCPTT group information entries described in clause 9.2.1.3.2, with the IWF acting as the controlling MCPTT function, with an MCPTT group identity matching the served MCPTT group ID, then shall consider the MCPTT user to be ineligible for affiliation and skip the rest of the steps; or\n6)\tshall consider the MCPTT user to be eligible for affiliation.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.1.3.2"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.3.9",
      "section_id": "9.2.1.3.9",
      "section_title": "Receiving subscription to group dynamic data procedure",
      "content": "Upon receiving a SIP SUBSCRIBE request such that:\n1)\tRequest-URI of the SIP SUBSCRIBE request contains the public service identity of the IWF owning the served MCPTT group;\n2)\tthe SIP SUBSCRIBE request contains an application/vnd.3gpp.mcptt-info+xml MIME body containing the<mcptt-request-uri> element and the <mcptt-calling-user-id> element;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n4)\tthe Event header field of the SIP SUBSCRIBE request contains the \"presence\" event type; and\n5)\tthe SIP SUBSCRIBE request contains an application/simple-filter+xml MIME body indicating per-group dynamic data of presence event package notification information according to 3GPP TS 24.379 [29] clause 9.3.2 indicating the same MCPTT group ID as in the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP SUBSCRIBE request;\nthen the IWF:\n1)\tshall identify the served MCPTT group ID in the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP SUBSCRIBE request;\n2)\tshall identify the handled MCPTT ID in the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP SUBSCRIBE request;\n3)\tif the Expires header field of the SIP SUBSCRIBE request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP SUBSCRIBE request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n4)\tif an MCPTT group for the served MCPTT group ID does not exist in the IWF, shall reject the SIP SUBSCRIBE request with SIP 403 (Forbidden) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [3], IETF RFC 3903 [21] and IETF RFC 3856 [24] and skip the rest of the steps;\n5)\tif the IWF does not support receiving a SIP SUBSCRIBE request to the group dynamic data of a group owned by the IWF, the IWF shall generate and send a SIP 501 (Not Implemented) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [3], IETF RFC 6665 [25], and skip the rest of the steps;\n6)\tif the handled MCPTT ID is not authorized to subscribe to group dynamic data of the MCPTT group identified by the served MCPTT group ID, shall reject the SIP SUBSCRIBE request with SIP 403 (Forbidden) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [3], IETF RFC 3903 [21] and IETF RFC 3856 [24] and skip the rest of the steps; and\n7)\tshall generate a SIP 200 (OK) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [3], IETF RFC 6665 [25].\nFor the duration of the subscription, the MCPTT server shall notify subscriber about changes of the information of the served MCPTT ID, as described in clause 9.2.1.3.10.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_24.379_clause_9.3.2",
        "clause_9.2.1.3.10",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_9.2.1.3.10",
      "section_id": "9.2.1.3.10",
      "section_title": "Sending notification of change of group dynamic data procedure",
      "content": "In order to notify the subscriber identified by the handled MCPTT ID about changes of the per-group dynamic data of the served MCPTT group ID, the IWF:\n1)\tshall consider an MCPTT group information entry such that:\na)\tthe MCPTT group information entry is in the list of MCPTT group information entries described in clause 9.2.1.3.2; and\nb)\tthe MCPTT group ID of the MCPTT group information entry is equal to the served MCPTT group ID;\n2)\tshall generate an application/pidf+xml MIME body indicating per-group dynamic data according to 3GPP TS 24.379 [29], clause 9.3.1 with the following clarifications:\na)\tthe IWF shall include the \"expires\" attribute in the <affiliation> element; and\n3)\tshall send a SIP NOTIFY request according to 3GPP TS 24.229 [3], and IETF RFC 6665 [25] for the subscription created in clause 9.2.1.3.8. In the SIP NOTIFY request, the IWF shall include the generated application/pidf+xml MIME body indicating per-group dynamic data.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.1.3.2",
        "ts_24.379_clause_9.3.1",
        "clause_9.2.1.3.8",
        "ts_24.379",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.2.1",
      "section_id": "10.1.2.1",
      "section_title": "IWF originating procedures",
      "content": "This clause is referred to by other clauses.\nTo establish an MCPTT prearranged group session, the IWF performing the participating role shall generate an initial SIP INVITE request by following the UE originating session procedures specified in 3GPP TS 24.229 [3], with the clarifications given below.\nThe IWF performing the participating role:\n1)\tif originating an MCPTT emergency group call or originating an MCPTT prearranged group call and the MCPTT emergency state is already set, the IWF performing the participating role shall comply with the procedures in clause 6.4.1.1;\n2)\tif originating an MCPTT imminent peril group call, the IWF performing the participating role shall comply with the procedures in clause 6.4.1.6;\n3)\tif originating a broadcast group call, the IWF performing the participating role shall include in the application/vnd.3gpp.mcptt-info+xml MIME body the <broadcast-ind> element set to \"true\" as defined in 3GPP TS 24.379 [29], clause F.1;\n4)\tshall include the g.3gpp.mcptt media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" in the Contact header field of the SIP INVITE request according to IETF RFC 3840 [9];\n5)\tshall include an Accept-Contact header field containing the g.3gpp.mcptt media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [5];\n6)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [5];\n7)\tshould include the \"timer\" option tag in the Supported header field;\n8)\tshould include the Session-Expires header field according to IETF RFC 4028 [6]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n9)\tif the emergency group state for this group is set to \"MEG 2: in-progress\" or \"MEG 4: confirm-pending\", the IWF performing the participating role shall include the Resource-Priority header field and comply with the procedures in clause 6.4.1.2;\n10)\tif the imminent peril group state for this group is set to \"MIG 2: in-progress\" or \"MIG 4: confirm-pending\" shall include the Resource-Priority header field and comply with the procedures in clause 6.4.1.8;\n11)\tshall contain an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with:\na)\tthe <session-type> element set to a value of \"prearranged\";\nb)\tthe <mcptt-request-uri> element set to the group identity;\nc)\tthe <mcptt-client-id> element set to a value determined by the IWF; and\nNOTE 1:\tHow the IWF determines the value of the <mcptt-client-id> element is out of scope of the present document.\nd)\tif the group identity can be determined to be a TGI and if the IWF performing the participating role can associate the TGI with a MCPTT group ID, the <associated-group-id> element set to the MCPTT group ID;\nNOTE 2:\tThe MCPTT ID will be inserted into the body of the SIP INVITE request by the referring clause.\nNOTE 3:\tThe text \"can associate the TGI with a MCPTT group ID\" means that the IWF performing the participating role is able to determine that there is a constituent group of the temporary group that it is a member of.\nNOTE 4:\tThe IWF performing the participating role is informed about temporary groups and regouping of MCPTT groups that the users homed in the IWF are members of as specified in 3GPP TS 24.481 [16].\nNOTE 5:\tIf the TGI has several MCPTT groups as constituent groups, where the user homed in the IWF is a member, the IWF performing the participating role selects one of those MCPTT groups.\n12)\tshall include an SDP offer according to 3GPP TS 24.229 [3] with the clarifications given in clause 6.1.1; and\n13)\tif an implicit floor request is required, shall indicate this as specified in clause 6.7; and shall skip the rest of the steps.\nOn receiving a SIP 2xx response to the SIP INVITE request, the IWF performing the participating role:\n1)\tshall interact with the user plane as specified in 3GPP TS 29.380 [31];\n2)\tif the MCPTT emergency group call state is set to \"MEGC 2: emergency-call-requested\" or \"MEGC 3: emergency-call-granted\" or the MCPTT imminent peril group call state is set to \"MIGC 2: imminent-peril-call-requested\" or \"MIGC 3: imminent-peril-call-granted\", the IWF performing the participating role shall perform the actions specified in clause 6.4.1.4; and\n3)\tmay subscribe to the conference event package as specified in clause 10.3.\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request:\n1)\tif the MCPTT emergency group call state is set to \"MEGC 2: emergency-call-requested\" or \"MEGC 3: emergency-call-granted\"; or\n2)\tif the MCPTT imminent peril group call state is set to \"MIGC 2: imminent-peril-call-requested\" or \"MIGC 3: imminent-peril-call-granted\";\nthe IWF performing the participating role shall perform the actions specified in clause 6.4.1.5.\nOn receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing group session, the IWF performing the participating role shall follow the actions specified in clause 6.4.1.9.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.4.1.1",
        "clause_6.4.1.6",
        "clause_6.4.1.2",
        "clause_6.4.1.8",
        "clause_6.1.1",
        "clause_6.7",
        "clause_6.4.1.4",
        "clause_10.3",
        "clause_6.4.1.5",
        "clause_6.4.1.9",
        "ts_24.229",
        "ts_24.379",
        "ts_24.481",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.2.2",
      "section_id": "10.1.2.2",
      "section_title": "IWF performing the participating role terminating procedures",
      "content": "This clause is referenced from other procedures.\nIn the procedures in this clause:\n1)\temergency indication in an incoming SIP INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n2)\timminent peril indication in an incoming SIP INVITE request refers to the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nThe IWF performing the participating role:\n1)\tmay reject the SIP INVITE request,\nNOTE:\tThe conditions under which the IWF rejects the request are out of scope of the present document.\n2)\tif the SIP INVITE request is rejected in step 1), shall respond towards the controlling MCPTT function either with an appropriate reject code as specified in 3GPP TS 24.229 [3] and warning texts as specified in clause 4.2.2 or with a SIP 480 (Temporarily unavailable) response and skip the rest of the steps of this clause;\n3)\tif the SIP INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <emergency-ind> element set to a value of \"true\":\na)\tshall set the MCPTT emergency group state to \"MEG 2: in-progress\";\nb)\tshall set the MCPTT imminent peril group state to \"MIG 1: no-imminent-peril\"; and\nc)\tshall set the MCPTT imminent peril group call state to \"MIGC 1: imminent-peril-gc-capable\"; otherwise\n4)\tif the SIP INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"true\", shall set the MCPTT imminent peril group state to \"MIG 2: in-progress\";\n5)\tshall perform the automatic commencement procedures specified in clause 6.2.1 if one of the following conditions are met:\na)\tif the SIP INVITE request contains an Answer-Mode header field with the value \"Auto\" and IWF is configured for automatic commencement mode for receiving the call;\nb)\tif the SIP INVITE request contains an Answer-Mode header field with the value \"Auto\" and IWF is configured to allow automatic commencement mode for receiving the call; or\nc)\tSIP INVITE request contains an Answer-Mode header field with the value \"Manual\" and IWF is not configured to allow manual commencement mode for receiving the call;\n6)\tshall perform the manual commencement procedures specified in clause 6.2.2 if one of the following conditions are met:\na)\tif the SIP INVITE request contains an Answer-Mode header field with the value \"Manual\" and IWF is configured for manual commencement mode for receiving the call;\nb)\tif the SIP INVITE request contains an Answer-Mode header field with the value \"Manual\" and IWF is configured to allow manual commencement mode for receiving the call; or\nc)\tSIP INVITE request contains an Answer-Mode header field with the value \"Automatic\" and IWF is not configured to allow automatic commencement mode for receiving the call; and\n7)\twhen the SIP 200 (OK) response to the SIP INVITE request is sent, may subscribe to the conference event package as specified in clause 10.3.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_4.2.2",
        "clause_6.2.1",
        "clause_6.2.2",
        "clause_10.3",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.2.3",
      "section_id": "10.1.2.3",
      "section_title": "MCPTT upgrade to in-progress emergency or imminent peril",
      "content": "This clause is referenced from other procedures.\nTo upgrade the MCPTT group session to an emergency condition or an imminent peril condition on an MCPTT prearranged group, the IWF performing the participating role shall perform the steps below.\n1)\tif the request is to upgrade the MCPTT group session to an MCPTT emergency call, the IWF performing the participating role:\na)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.1.1; and\nb)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.4.1.2.\n2)\tif the MCPTT user has requested to upgrade the MCPTT group session to an MCPTT imminent peril call, the IWF performing the participating role:\na)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.1.6; and\nb)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.4.1.8;\n3)\tif the SIP re-INVITE request is to be sent within an on-demand session, shall include in the SIP re-INVITE request an SDP offer according to 3GPP TS 24.229 [3] with the clarifications specified in clause 6.1.1;\nNOTE:\tThe SIP re-INVITE request can be sent within an on-demand session.\n4)\tif an implicit floor request is required, shall indicate this as specified in clause 6.7; and\n5)\tshall exit the procedure in the present clause.\nOn receiving a SIP 2xx response to the SIP re-INVITE request the IWF performing the participating role:\n1)\tshall perform the actions specified in clause 6.4.1.4.\nOn receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing group session, the IWF performing the participating role shall follow the actions specified in clause 6.4.1.9.\nOn receiving a SIP 4xx response, SIP 5xx response or a SIP 6xx response to the SIP re-INVITE request the IWF performing the participating role shall perform the actions specified in clause 6.4.1.5.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.4.1.1",
        "clause_6.4.1.2",
        "clause_6.4.1.6",
        "clause_6.4.1.8",
        "clause_6.1.1",
        "clause_6.7",
        "clause_6.4.1.4",
        "clause_6.4.1.9",
        "clause_6.4.1.5",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.2.4",
      "section_id": "10.1.2.4",
      "section_title": "MCPTT in-progress emergency cancel",
      "content": "This clause is referenced from other procedures.\nTo cancel the in-progress emergency condition on a prearranged MCPTT group, the IWF performing the participating role shall generate a SIP re-INVITE request by following the UE originating session procedures specified in 3GPP TS 24.229 [3], with the clarifications given below.\nThe IWF performing the participating role:\n1)\tshall, if cancelling an in-progress emergency condition and optionally an MCPTT emergency alert originated by the user homed in the IWF, include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.1.3;\n2)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with:\na)\tthe <session-type> element set to a value of \"prearranged\"; and\nb)\tthe <mcptt-request-uri> element set to the group identity;\n3)\tshall set the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP re-INVITE request to the MCPTT ID of the calling user;\n4)\tshall include the g.3gpp.mcptt media feature tag in the Contact header field of the SIP re-INVITE request according to IETF RFC 3840 [9];\n5)\tshall include in the SIP re-INVITE request an SDP offer according to 3GPP TS 24.229 [3] with the clarifications specified in clause 6.1.1;\n6)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.4.1.2; and\n7)\tshall exit the procedure in the present clause.\nOn receiving a SIP 2xx response to the SIP re-INVITE request, the IWF performing the participating role:\n1)\tshall interact with the user plane as specified in 3GPP TS 29.380 [31];\n2)\tshall set the MCPTT emergency group state of the group to \"MEG 1: no-emergency\";\n3)\tshall set the MCPTT emergency group call state of the group to \"MEGC 1: emergency-gc-capable\"; and\n4)\tif the MCPTT emergency alert state is set to \"MEA 4: Emergency-alert-cancel-pending\", the sent SIP re-INVITE request did not contain an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body and the SIP 2xx response to the SIP request for a priority group call does not contain a Warning header field as specified in clause 4.4 with the warning text containing the mcptt-warn-code set to \"149\", shall set the MCPTT emergency alert state to \"MEA 1: no-alert\".\nOn receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing group session, the IWF performing the participating role shall follow the actions specified in clause 6.4.1.9 with the IWF acting as the MCPTT client.\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request:\n1)\tshall set the MCPTT emergency group state as \"MEG 2: in-progress\";\n2)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response contains an application/vnd.3gpp.mcptt-info+xml MIME body with an <alert-ind> element set to a value of \"true\" and the sent SIP re-INVITE request did not contain an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, the IWF performing the participating role shall set the MCPTT emergency alert state to \"MEA 3: emergency-alert-initiated\"; and\n3)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response did not contain an application/vnd.3gpp.mcptt-info+xml MIME body with an <alert-ind> element and did not contain an <originated-by> element, the MCPTT emergency alert (MEA) state shall revert to its value prior to entering the current procedure.\nNOTE:\tIf the in-progress emergency group state cancel request is rejected, the state of the session does not change, i.e. continues with MCPTT emergency group call level priority.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.4.1.3",
        "clause_6.1.1",
        "clause_6.4.1.2",
        "clause_4.4",
        "clause_6.4.1.9",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.2.5",
      "section_id": "10.1.2.5",
      "section_title": "MCPTT in-progress imminent peril cancel",
      "content": "This clause is referenced from other procedures.\nTo cancel the in-progress imminent peril condition on a prearranged MCPTT group, the IWF performing the participating role shall generate a SIP re-INVITE request by following the procedures specified in 3GPP TS 24.229 [3], with the clarifications given below.\nThe IWF performing the participating role:\n1)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.1.7;\n2)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.4.1.8;\n3)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with:\na)\tthe <session-type> element set to a value of \"prearranged\"; and\nb)\tthe <mcptt-request-uri> element set to the group identity;\n4)\tshall set the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP re-INVITE request to the MCPTT ID of the calling user;\n5)\tshall include the g.3gpp.mcptt media feature tag in the Contact header field of the SIP re-INVITE request according to IETF RFC 3840 [9];\n6)\tshall include in the SIP re-INVITE request an SDP offer according to 3GPP TS 24.229 [3] with the clarifications specified in clause 6.1.1; and\n7)\tshall exit the procedure in the present clause.\nOn receiving a SIP 2xx response to the SIP re-INVITE request, the IWF performing the participating role:\n1)\tshall interact with the user plane as specified in 3GPP TS 29.380 [31];\n2)\tshall set the MCPTT imminent peril group state of the group to \"MIG 1: no-imminent-peril\"; and\n3)\tshall set the MCPTT imminent peril group call state of the group to \"MIGC 1: imminent-peril-gc-capable\".\nOn receiving a SIP 4xx, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request:\n1)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response:\na)\tcontains an application/vnd.3gpp.mcptt-info+xml MIME body with an <imminentperil-ind> element set to a value of \"true\"; or\nb)\tdoes not contain an application/vnd.3gpp.mcptt-info+xml MIME body with an <imminentperil-ind> element;\nthen the IWF performing the participating role shall set the MCPTT imminent peril group state as \"MIG 2: in-progress\".\nNOTE:\tThis is the case where the IWF performing the participating role requested the cancellation of the MCPTT imminent peril in-progress state and was rejected.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.4.1.7",
        "clause_6.4.1.8",
        "clause_6.1.1",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.2.6",
      "section_id": "10.1.2.6",
      "section_title": "Reception of SIP re-INVITE request",
      "content": "This clause is referred to by other clauses.\nThe IWF:\n1)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <emergency-ind> element set to a value of \"true\":\na)\tshall set the MCPTT emergency group state to \"MEG 2: in-progress\";\nb)\tshall set the MCPTT imminent peril group state to \"MIG 1: no-imminent-peril\"; and\nc)\tshall set the MCPTT imminent peril group call state to \"MIGC 1: imminent-peril-gc-capable\";\n2)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"true\":\na)\tshall set the MCPTT imminent peril group state to \"MIG 2: in-progress\";\n3)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <emergency-ind> element set to a value of \"false\":\na)\tif the <mcpttinfo> element containing the <mcptt-Params> element contains an <alert-ind> element set to \"false\":\ni)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body including an <originated-by> element:\nA)\tif the MCPTT ID contained in the <originated-by> element is the MCPTT ID of the receiving user homed in the IWF, shall set the MCPTT emergency alert state to \"MEA 1: no-alert\";\nb)\tshall set the MCPTT emergency group state to \"MEG 1: no-emergency\"; and\nc)\tif the MCPTT emergency group call state of the group is set to \"MEGC 3: emergency-call-granted\", shall set the MCPTT emergency group call state of the group to \"MEGC 1: emergency-gc-capable\";\n4)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"false\":\na)\tshall set the MCPTT imminent peril group state to \"MIG 1: no-imminent-peril\"; and\nb)\tshall set the MCPTT imminent peril group call state to \"MIGC 1: imminent-peril-gc-capable\";\n5)\tshall accept the SIP re-INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [3];\n6)\tshall include the g.3gpp.mcptt media feature tag in the Contact header field of the SIP 200 (OK) response;\n7)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" in the Contact header field of the SIP 200 (OK) response; and\n8)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP re-INVITE request according to 3GPP TS 24.229 [3] with the clarifications given in clause 6.1.2.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.1.2",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.3.1.1",
      "section_id": "10.1.3.1.1",
      "section_title": "On demand prearranged group call",
      "content": "In this clause, the IWF originates a prearranged group session on behalf of an LMR user.\nNOTE 1:\tHow the IWF determines the MCPTT ID of the calling user is out of scope of the present document.\nThe IWF, performing the originating participating function:\n1)\tif the user identified by the MCPTT ID is not affiliated to the group as determined by clause 9.2.1.2.8 and this is an authorised request for originating a priority call as determined by clause 6.6.2.1.4.2, shall perform the actions specified in clause 9.2.1.2.9 for implicit affiliation;\n2)\tshall determine the public service identity of the controlling MCPTT function associated with the group identity of the group on which the call is to be originated;\nNOTE 2:\tHow the IWF discovers the public service identity of the controlling MCPTT function associated with the group identity is out of scope of the present document.\n3)\tshall generate a SIP INVITE request as specified in clause 10.1.2.1;\n4)\tshall modify the SIP INVITE request as specified in clause 6.6.2.1.2;\n5)\tmay insert the calling user's location information into an application/vnd.3gpp.mcptt-location-info+xml MIME body to be included in the outgoing SIP request;\n6)\tshall set the Request-URI to the public service identity of the controlling MCPTT function associated with the group identity;\n7)\tshall set the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP INVITE request to the MCPTT ID of the calling user;\n8)\tshall update the SDP as specified in clause 6.6.2.1.1.1; and\n9)\tshall send the SIP INVITE request to the controlling MCPTT function as specified in 3GPP TS 24.229 [3].\nUpon receipt of a SIP 302 (Moved Temporarily) response to the above SIP INVITE request, the participating IWF function:\n1)\tshall generate a SIP INVITE request as specified in clause 6.6.2.1.5;\n2)\tshall include an SDP offer based upon the SDP offer in the SIP INVITE request generated by the IWF in the step above; and\n3)\tshall forward the SIP INVITE request according to 3GPP TS 24.229 [3].\nUpon receipt of a SIP 2xx response in response to the above SIP INVITE request, the IWF performing the participating role:\nNOTE 3:\tIf an <MKFC-GKTPs> element is received, the IWF ignores that element.\n1)\tif the procedures of clause 9.2.1.2.9 for implicit affiliation were performed in the present clause, shall complete the implicit affiliation by performing the procedures of clause 9.2.1.2.10;\n2)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [6].\n3)\tshall perform the steps for SIP 2xx as specified in clause 10.1.2.1.\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP INVITE request, the participating IWF function:\n1)\tif the implicit affiliation procedures of clause 9.2.1.2.9 were invoked in this procedure, shall perform the procedures of clause 9.2.1.2.11; and\n2)\tshall perform the steps for the received SIP 4xx, 5xx or 6xx as specified in clause 10.1.2.1.\nOn receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing group session, the IWF shall perform the steps for the received SIP INFO in clause 10.1.2.1.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.2.1.2.8",
        "clause_6.6.2.1.4.2",
        "clause_9.2.1.2.9",
        "clause_10.1.2.1",
        "clause_6.6.2.1.2",
        "clause_6.6.2.1.1.1",
        "clause_6.6.2.1.5",
        "clause_9.2.1.2.10",
        "clause_9.2.1.2.11",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.3.1.2",
      "section_id": "10.1.3.1.2",
      "section_title": "Sending of a SIP re-INVITE request towards MCPTT controlling function",
      "content": "Upon a need to send a SIP re-INVITE request for an MCPTT session identifying an on-demand prearranged MCPTT group session, the IWF performing the participating role:\n1)\tif the request is for an upgrade to an in-progress emergency or an imminent peril, shall perform the steps in clause 10.1.2.3;\n2)\tif the request is for a cancellation of an in-progress emergency, shall perform the steps in clause 10.1.2.4;\n3)\tif the request is for a cancellation of an in-progress imminent peril, shall perform the steps in clause 10.1.2.5;\n4)\tshall include the MCPTT ID of the originating user in <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP re-INVITE request;\nNOTE 1:\tHow the IWF determines the MCPTT ID of a user homed in the IWF is out of scope of the present document.\n5)\tshall include in the SIP re-INVITE request an SDP offer as specified in clause 6.6.2.1.1;\n6)\tif the SIP re-INVITE requires a Resource-Priority header field, shall include a Resource-Priority header field according to 6.4.1.11; and\n7)\tshall send the SIP re-INVITE request according to 3GPP TS 24.229 [3].\nUpon receipt of a SIP 2xx response to the above SIP re-INVITE request, the IWF performing the participating role:\n1)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31];\n2)\tif the request in the present clause above is for an upgrade for emergency or imminent peril, shall follow the procedures for SIP 200 (OK) response as specified in clause 10.1.2.3;\n3)\tif the request in the present clause above is for an in-progress emergency cancel, shall follow the procedures for SIP 200 (OK) response as specified in clause 10.1.2.4; and\n4)\tif the request in the present clause above is for an in-progress imminent peril cancel, shall follow the procedures for SIP 200 (OK) response as specified in clause 10.1.2.5.\nUpon receipt of a SIP 403 (Forbidden) response to the above SIP re-INVITE request, the IWF performing the participating role shall interact with the media plane as specified in 3GPP TS 29.380 [31].\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP re-INVITE request, the IWF performing the participating role:\n1)\tif the request in the present clause above is for an upgrade for emergency or imminent peril, shall follow the procedures for SIP 4xx, SIP 5xx and SIP 6xx responses as specified in clause 10.1.2.3;\n2)\tif the request in the present clause above is for an in-progress emergency cancel, shall follow the procedures for SIP 4xx, SIP 5xx and SIP 6xx responses as specified in clause 10.1.2.4; or\n3)\tif the request in the present clause above is for an in-progress imminent peril cancel, shall follow the procedures for SIP 4xx, SIP 5xx and SIP 6xx responses as specified in clause 10.1.2.5.\nUpon receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing session, the IWF performing the participating role:\n1)\tif the SIP re-INVITE request in the present clause above is for an upgrade for emergency or imminent peril, shall follow the procedures for SIP INFO as specified in clause 10.1.2.3;\n2)\tif the SIP re-INVITE request in the present clause above is for an in-progress emergency cancel, shall follow the procedures for SIP INFO as specified in clause 10.1.2.4; or\n3)\tif the SIP re-INVITE request in the present clause above is for an in-progress imminent peril cancel, shall follow the procedures for SIP INFO as specified in clause 10.1.2.5.",
      "chunk_type": "general",
      "cross_references": [
        "clause_10.1.2.3",
        "clause_10.1.2.4",
        "clause_10.1.2.5",
        "clause_6.6.2.1.1",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.3.2",
      "section_id": "10.1.3.2",
      "section_title": "Terminating Procedures",
      "content": "In the procedures in this clause:\n1)\temergency indication in an incoming SIP INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n2)\timminent peril indication in an incoming SIP INVITE request refers to the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nUpon receipt of a \"SIP INVITE request for terminating participating MCPTT function\", the IWF performing the participating role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The IWF performing the participating role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [14], and shall not continue with the rest of the steps;\n2)\tshall check the presence of the isfocus media feature tag in the URI of the Contact header field and if it is not present then the IWF performing the participating role shall reject the request with a SIP 403 (Forbidden) response with the warning text set to \"104 isfocus not assigned\" in a Warning header field as specified in clause 4.4, and shall not continue with the rest of the steps;\n3)\tmay reject the request with a SIP 480 (Temporarily Unavailable) response with the warning text set to \"146 T-PF unable to determine the service settings for the called user\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the MCPTT server and shall not continue with the rest of the steps; and\nNOTE:\tIf an <MKFC-GKTPs> element is received, the IWF ignores it.\n4)\tshall perform the steps in 3GPP TS 24.379 [29], clause 10.1.2.1.2.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_4.4",
        "ts_24.379_clause_4.4",
        "ts_24.379_clause_10.1.2.1.2",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.3.3.1",
      "section_id": "10.1.3.3.1",
      "section_title": "IWF ending group call on-demand",
      "content": "When the IWF performing the participating role determines it has to send a SIP BYE request, the IWF shall follow the procedures as specified in clause 6.6.2.1.3.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.2.1.3"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.3.4.1",
      "section_id": "10.1.3.4.1",
      "section_title": "Receipt of SIP BYE request for private call on-demand",
      "content": "Upon receiving a SIP BYE request from the controlling MCPTT function, the IWF performing the participating role shall follow the procedures as specified in clause 6.6.2.2.2.1.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.2.2.2.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.3.5.1",
      "section_id": "10.1.3.5.1",
      "section_title": "Originating procedures - on demand prearranged group call",
      "content": "To rejoin an on demand prearranged group call, the IWF performing the participating role shall follow the procedures specified in clause 10.1.3.1.1 with the clarification that the Request-URI of the SIP INVITE request shall contain a URI of the MCPTT session identity to re-join.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_10.1.3.1.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.3.6",
      "section_id": "10.1.3.6",
      "section_title": "Reception of a SIP re-INVITE request for terminating a priority call",
      "content": "In the procedures in this clause:\n1)\temergency indication in an incoming SIP INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n2)\timminent peril indication in an incoming SIP INVITE request refers to the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nUpon receipt of a SIP re-INVITE request for an MCPTT group containing an emergency indication or imminent peril indication, the IWF performing the participating role:\n1)\tshall perform the steps in clause 10.1.2.6;\n2)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\n3)\tshall send the SIP 200 (OK) response according to 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "clause_10.1.2.6",
        "ts_29.380",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.4.1.1",
      "section_id": "10.1.4.1.1",
      "section_title": "INVITE targeted to an MCPTT client",
      "content": "This clause describes the procedures for inviting an MCPTT user to an MCPTT session. The procedure is initiated by the IWF performing the controlling role as the result of a request from the LMR system or an action in clause 10.1.4.2 or as the result of receiving a SIP 403 (Forbidden) response as described in this clause.\nThe IWF performing the controlling role:\n1)\tshall generate a SIP INVITE request as specified in clause 6.6.3.1.1;\n2)\tshall set the Request-URI to the public service identity of the terminating participating MCPTT function associated to the MCPTT user to be invited;\nNOTE 1:\tHow the IWF performing the controlling role finds the address of the terminating MCPTT participating function is out of the scope of the current release.\nNOTE 2:\tIf the terminating MCPTT user is part of a partner MCPTT system, then the public service identity can identify an entry point in the partner network that is able to identify the terminating participating MCPTT function.\n3)\tshall set the P-Asserted-Identity header field to the public service identity of the IWF performing the controlling role;\n4)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP INVITE request:\na)\tthe <mcptt-request-uri> element set to the MCPTT ID of the terminating user; and\nb)\tthe <mcptt-calling-group-id> element set to the group identity;\nNOTE 3:\tThe <mcptt-calling-user-id> is already included in the MIME body as a result of calling clause 6.6.3.1.1 in step 1).\n5)\tshall include in the SIP INVITE request an SDP offer based on the SDP offer in the received SIP INVITE request from the originating network according to the procedures specified in TS 24.379 [29], clause 6.3.3.1.1, with the IWF acting as the controlling MCPTT function;\n6)\tif the in-progress emergency state of the group is set to a value of \"true\" the IWF performing the controlling role:\na)\tshall include a Resource-Priority header field populated with the values for an MCPTT emergency group call as specified in clause 6.6.3.1.12.\nb)\tif the IWF needs to set the group state to emergency:\ni)\tshall include in the outgoing SIP INVITE request in the application/vnd.3gpp.mcptt-info+xml MIME body an <emergency-ind> element set to a value of \"true\"; and\nii)\tif the IWF needs to set an emergency alert and the MCPTT group is authorised for the initiation of MCPTT emergency alerts as determined by the procedures of clause 6.6.3.1.8.1, shall populate the application/vnd.3gpp.mcptt-info+xml MIME body and the application/vnd.3gpp.mcptt-location-info+xml MIME body as specified in clause 6.6.3.1.7. Otherwise, shall set the <alert-ind> element to a value of \"false\"; and\nc)\tif the in-progress imminent peril state of the group is set to a value of \"true\" shall include in the application/vnd.3gpp.mcptt-info+xml MIME body an <imminentperil-ind> element set to a value of \"false\";\n7)\tif the in-progress emergency state of the group is set to a value of \"false\" and the in-progress imminent peril state of the group is set to a value of \"true\", the IWF performing the controlling role:\na)\tshall include a Resource-Priority header field populated with the values for an MCPTT imminent peril group call as specified in clause 6.6.3.1.12; and\nb)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\"; and\n8)\tshall send the SIP INVITE request towards the terminating network in accordance with 3GPP TS 24.229 [3].\nUpon receiving a SIP 183 (Session Progress) response containing a Require header field with the option tag \"100rel\" and containing a P-Answer-State header field with the value \"Unconfirmed\" in response to the SIP INVITE request the IWF performing the controlling role:\n1)\tshall send a SIP PRACK request towards the MCPTT client according to 3GPP TS 24.229 [3].\nUpon receiving a SIP 200 (OK) response for the SIP INVITE request the IWF performing the controlling role:\n1)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31] clause 6.3;\n2)\tshall send a SIP NOTIFY request to all MCPTT participants with a subscription to the conference event package as specified in clause 10.3; and\n3)\tshall increment the local counter of the number of SIP 200 (OK) responses received from invited members, by 1.",
      "chunk_type": "general",
      "cross_references": [
        "clause_10.1.4.2",
        "clause_6.6.3.1.1",
        "ts_24.379_clause_6.3.3.1.1",
        "clause_6.6.3.1.12",
        "clause_6.6.3.1.8.1",
        "clause_6.6.3.1.7",
        "ts_29.380_clause_6.3",
        "clause_10.3",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.4.1.2",
      "section_id": "10.1.4.1.2",
      "section_title": "INVITE targeted to the non-controlling MCPTT function of an MCPTT group",
      "content": "The IWF performing the controlling role:\n1)\tshall generate a SIP INVITE request as specified in clause 6.6.3.1.1;\n2)\tshall set the Request-URI to the public service identity of the non-controlling MCPTT function serving the group identity of the MCPTT group owned by the partner MCPTT system;\n3)\tshall set the P-Asserted-Identity to the public service identity of the IWF performing the controlling role;\n4)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP INVITE request:\na)\tthe <mcptt-request-uri> element set to the group identity of the MCPTT group hosted by the non-controlling MCPTT function in the partner MCPTT system; and\nb)\tthe <mcptt-calling-group-id> element set to the group identity of the group served by the IWF performing the controlling role;\n5)\tshall include the Recv-Info header field set to g.3gpp.mcptt-floor-request;\n6)\tvoid\n7)\tshall include in the SIP INVITE request an SDP offer; and\n8)\tshall send the SIP INVITE request towards the partner MCPTT system in accordance with 3GPP TS 24.229 [3].\nUpon receiving SIP 403 (Forbidden) response for the SIP INVITE request, if according to local policy and if:\n1)\tthe response contains a Warning header field with the MCPTT warning code \"128\"; and\n2)\tthe response contains a P-Refused-URI-List header field and an application/resource-lists+xml MIME body as specified in IETF RFC 5318 [20];\nNOTE 1:\tThe application/resource-lists+xml MIME body contains MCPTT IDs identifying MCPTT users in a partner MCPTT system that need to be invited to the prearranged group call in case of group regrouping using interrogating method as specified in 3GPP TS 23.379 [2] clause 10.6.2.4.2.\nthen the IWF performing the controlling role:\n1)\tshall check if the number of members of the MCPTT group exceeds the maximum participants allowed by the IWF performing the controlling role. If exceeded, the IWF performing the controlling role shall invite only enough members from the application/resource-lists+xml MIME body to reach the maximum allowed by the IWF performing the controlling role; and\nNOTE 2:\tThe IWF determines the maximum number of participants allowed in the prearranged group session. It is operator policy that determines which participants in the application/resource-lists+xml MIME body are invited to the group call.\n2)\tshall invite MCPTT users as specified in this clause using the list of MCPTT IDs in URI-List.\nUpon receiving a SIP 200 (OK) response for the SIP INVITE request the IWF performing the controlling role:\n1)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31] clause 6.3;\nNOTE 3:\tThe procedures executed by the IWF performing the controlling role prior to sending a response to the inviting MCPTT client are specified in clause 10.1.4.2.\n2)\tif at least one of the invited MCPTT clients has subscribed to the conference package, shall subscribe to the conference event package in the non-controlling MCPTT function as specified in clause 10.3; and\n3)\tif the 200 (OK) response includes the <floor-state> element set to \"floor-taken\", shall wait for a SIP INFO request containing a floor request from the non-controlling MCPTT function.\nUpon receiving a SIP INFO request containing a floor request where:\n1)\tthe Request-URI contains an MCPTT session ID identifying an ongoing temporary group session; and\n2)\tthe application/vnd.3gpp.mcptt-info+xml MIME body contains the <mcptt-calling-group-id> element with the MCPTT group ID of a MCPTT group invited to the temporary group session;\nthen the IWF performing the controlling role:\n1)\tshall send a SIP 200 (OK) response to the SIP INFO request to the non-controlling MCPTT function as specified in 3GPP TS 24.229 [3]; and\n2)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31] clause 6.3.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.3.1.1",
        "ts_23.379_clause_10.6.2.4.2",
        "ts_29.380_clause_6.3",
        "clause_10.1.4.2",
        "clause_10.3",
        "ts_24.229",
        "ts_23.379",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.4.2",
      "section_id": "10.1.4.2",
      "section_title": "Terminating Procedures",
      "content": "In this clause, the IWF is performing the controlling role and is terminating a call from an MCPTT participating function or an MCPTT non-controlling function destined for the IWF. For cases where both the call origination and termination are MCPTT functions, the IWF shall follow 3GPP TS 24.379 [29], clause 10.1.1.4.2, with the IWF acting as the controlling MCPTT function.\nIn the procedures in this clause:\n1)\tMCPTT ID in an incoming SIP INVITE request refers to the MCPTT ID of the originating user from the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP INVITE request;\n2)\tgroup identity in an incoming SIP INVITE request refers to the group identity from the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP INVITE request;\n3)\tindication of required group members in a SIP 183 (Session Progress) response refers to the <required> element of the application/vnd.3gpp.mcptt-info+xml MIME body set to \"true\" in a SIP 183 (Session Progress) sent by the non-controlling MCPTT function of an MCPTT group;\n4)\temergency indication in an incoming SIP INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n5)\timminent peril indication in an incoming SIP INVITE request refers to the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nUpon receipt of a \"SIP INVITE request for controlling MCPTT function of an MCPTT group\", the IWF performing the controlling role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The IWF performing the controlling role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [14] and skip the rest of the steps;\nNOTE 1:\tIf the SIP INVITE request contains an emergency indication or an imminent peril indication set to a value of \"true\" and this is an authorised request for originating an MCPTT emergency group call as determined by clause 6.6.3.1.8.2, or for originating an MCPTT imminent peril group call as determined by clause 6.6.3.1.8.5, the IWF performing the non-controlling role can, according to local policy, choose to accept the request.\n2)\tshall determine if the media parameters are acceptable and if not reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n3)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if:\na)\tan Accept-Contact header field does not include the g.3gpp.mcptt media feature tag; or\nb)\tan Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\";\n4)\tif received SIP INVITE request includes an application/vnd.3gpp.mcptt-info+xml MIME body with an <emergency-ind> element included or an <imminentperil-ind> element included, shall validate the request as described in 3GPP TS 24.379 [29], clause 6.3.3.1.17 with the IWF acting as the controlling MCPTT function;\n5)\tshall retrieve the necessary group document(s) and carry out initial processing as specified in 3GPP TS 24.379 [29], clause 6.3.5.2 with the IWF acting as the controlling MCPTT function;\n6)\tif the result of the initial processing in 3GPP TS 24.379 [29], clause 6.3.5.2 was:\na)\tthat authorization of the MCPTT ID at a non-controlling MCPTT function of an MCPTT group is required, perform the actions in clause 6.6.3.1.8.7 and do not continue with the rest of the steps in this clause; and\nb)\tthat a SIP 3xx, 4xx, 5xx or 6xx response to the \"SIP INVITE request for controlling MCPTT function of an MCPTT group\" has been sent, do not continue with the rest of the steps in this clause;\n7)\tshall perform the actions as described in 3GPP TS 24.379 [29], clause 6.3.3.2.2 with the IWF acting as the controlling MCPTT function;\n8)\tshall maintain a local counter of the number of SIP 200 (OK) responses received from invited members and shall initialise this local counter to zero;\n9)\tshall determine if an MCPTT group call for the group identity is already ongoing by determining if an MCPTT session identity has already been allocated for the group call and the MCPTT session is active;\n10)\tif the SIP INVITE request contains an unauthorised request for an MCPTT emergency group call as determined by clause 6.6.3.1.8.2:\na)\tshall reject the SIP INVITE request with a SIP 403 (Forbidden) response as specified in clause 6.6.3.1.9; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n11)\tif the SIP INVITE request contains an unauthorised request for an MCPTT imminent peril group call as determined by clause 6.6.3.1.8.5, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response with the following clarifications:\na)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"false\"; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n12)\tvoid\n13)\tif the received SIP INVITE request contains an application/vnd.3gpp.mcptt-location-info+xml MIME body with a <Report> element included in the <location-info> root element, the IWF performing the controlling role can remember the location information contained in the <location-info> root element;\n14)\tif the MCPTT group call is not ongoing then:\na)\tif:\ni)\tthe user identified by the MCPTT ID is not affiliated to the group identity contained in the SIP INVITE request as specified in 3GPP TS 24.379 [29], clause 6.3.6, with the IWF acting as the controlling MCPTT function;\nii)\tthe group identity contained in the SIP INVITE request is not a constituent MCPTT group ID;\niii)\tthe received SIP INVITE request does not contain an emergency indication or imminent peril indication; or\niv)\tthe received SIP INVITE request is an authorised request for an MCPTT emergency group call as determined by clause 6.6.3.1.8.2 or MCPTT imminent peril group call as determined by steps clause 6.6.3.1.8.5 and is determined to not be eligible for implicit affiliation as specified in clause 9.2.1.3.6;\nthen shall return a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server, and skip the rest of the steps below;\nb)\tif the user identified by the MCPTT ID is not authorised to initiate the prearranged group session, shall send a SIP 403 (Forbidden) response with the warning text set to: \"119 user is not authorised to initiate the group call\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server and skip the rest of the steps below;\nNOTE 2:\tHow the IWF determines whether the MCPTT user is authorized to initiate a prearranged group is out of scope of the present document.\nc)\tif the received SIP INVITE request contains an authorised request for an MCPTT emergency group call as determined by clause 6.6.3.1.8.2 or MCPTT imminent peril group call as determined by clause 6.6.3.1.8.5 and the MCPTT user is eligible to be implicitly affiliated with the MCPTT group as determined as determined in step 13) a) iv) above, shall perform the implicit affiliation as specified in clause 9.2.1.3.7;\nd)\tvoid\ne)\tshall create a prearranged group session and allocate an MCPTT session identity for the prearranged group call, and shall handle timer TNG3 (group call timer) as specified in clause 6.6.3.5;\nf)\tif the group identity in the \"SIP INVITE request for controlling MCPTT function of an MCPTT group\" is a TGI:\ni)\tshall for each of the constituent MCPTT groups homed in the IWF:\nA)\tinvite each member of the IWF homed group to the group session; and\nB)\tinteract with the media plane as specified in 3GPP TS 29.380 [31] clause 6.3; and\nii)\tshall for each of the constituent MCPTT groups homed on the partner MCPTT system generate a SIP INVITE request for the MCPTT group identity homed on the partner MCPTT system as specified in clause 10.1.4.1.2;\ng)\tif the group identity in the \"SIP INVITE request for controlling MCPTT function of an MCPTT group\" is an MCPTT group ID:\ni)\tshall determine the members to invite to the prearranged MCPTT group call as specified in clause 6.6.5.3;\nii)\tif necessary, shall start timer TNG1 (acknowledged call setup timer) according to the conditions stated in clause 6.6.3.3;\niii)\tif the received SIP INVITE request includes an application/vnd.3gpp.mcptt-info+xml MIME body with an <emergency-ind> element set to a value of \"true\":\nA)\tshall cache the information that the MCPTT user has initiated an MCPTT emergency call;\nB)\tif the received SIP INVITE contains an alert indication set to a value of \"true\" and this is an authorised request for an MCPTT emergency alert meeting the conditions specified in clause 6.6.3.1.8.1, shall cache the information that the MCPTT user has initiated an MCPTT emergency alert; and\nC)\tif the in-progress emergency state of the group is set to a value of \"false\":\nI)\tshall set the value of the in-progress emergency state of the group to \"true\"; and\nII)\tshall start timer TNG2 (in-progress emergency group call timer) and handle its expiry as specified in clause 6.6.3.1.10;\niv)\tif the in-progress emergency state of the group is set to a value of \"false\" and if the received SIP INVITE request contains an imminent peril indication set to a value of \"true\", the controlling MCPTT function:\nA)\tshall cache the information that the MCPTT user has initiated an MCPTT imminent peril call; and\nB)\tif the in-progress imminent peril state of the group is set to a value of \"false\", shall set the in-progress imminent peril state of the group to a value of \"true\";\nv)\tshall invite each group member determined in step 13)g)i) above, to the group session, as specified in clause 10.1.4.1.1; and\nvi)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31] clause 6.3; and\n15)\tif the MCPTT group call is ongoing then:\na)\tif:\ni)\tthe user identified by the MCPTT ID in the SIP INVITE request is not affiliated to the group identity contained in the SIP INVITE request as specified in 3GPP TS 24.379 [29] clause 6.3.6;\nii)\tthe group identity contained in the SIP INVITE request is not a constituent MCPTT group ID;\niii)\tthe received SIP INVITE request does not contain an emergency indication or imminent peril indication; or\niv)\tthe received SIP INVITE request is an authorised request for an MCPTT emergency group call as determined by clause 6.6.3.1.8.2 or MCPTT imminent peril group call as determined clause 6.6.3.1.8.5 and is determined to not be eligible for implicit affiliation as specified in clause 9.2.1.3.6;\nthen shall return a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server, and skip the rest of the steps below;\nb)\tif the user identified by the MCPTT ID in the SIP INVITE request is not authorised to join the prearranged group session as specified in clause 6.6.5.2, shall send a SIP 403 (Forbidden) response with the warning text set to \"121 user is not allowed to join the group call\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the MCPTT server and skip the rest of the steps below;\nc)\tvoid\nd)\tif the maximum number of participants allowed by the IWF performing the controlling role is already reached:\ni)\tif, according to local policy, the user identified by the MCPTT ID in the SIP INVITE request is deemed to have a higher priority than an existing user in the group session, may remove a participant from the session by following clause 10.1.4.4.3, and skip the next step; and\nNOTE 3:\tThe local policy for deciding whether to admit a user to a call that has reached its maximum amount of participants can include the user's priority and the participant type of the user as well as other information about the user. The local policy decisions can also include taking into account whether the imminent-peril indicator or emergency indicator was received in the SIP INVITE request.\nii)\tshall return a SIP 486 (Busy Here) response with the warning text set to \"122 too many participants\" to the originating network as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the MCPTT server and skip the rest of the steps;\ne)\tif the received SIP INVITE request contains an authorised request for an MCPTT emergency group call as determined by clause 6.6.3.1.8.2 or MCPTT imminent peril group call as determined by clause 6.6.3.1.8.5 and the MCPTT user is eligible to be implicitly affiliated with the MCPTT group as determined in step 14) a) iv) above, shall perform the implicit affiliation as specified in clause 9.2.1.3.7;\nf)\tif the received SIP INVITE request includes an application/vnd.3gpp.mcptt-info+xml MIME body with an <emergency-ind> element set to a value of \"true\":\ni)\tshall cache the information that the MCPTT user has initiated an MCPTT emergency call;\nii)\tif the received SIP INVITE contains an alert indication set to a value of \"true\" and this is an authorised request for an MCPTT emergency alert meeting the conditions specified in clause 6.6.3.1.8.1, shall cache the information that the MCPTT user has initiated an MCPTT emergency alert;\niii)\tif the in-progress emergency state of the group is set to a value of \"false\":\nA)\tshall set the value of the in-progress emergency state of the group to \"true\";\nB)\tshall start timer TNG2 (in-progress emergency group call timer) and handle its expiry as specified in clause 6.6.3.1.10; and\nC)\tshall generate SIP re-INVITE requests for the MCPTT emergency group call to the other call participants of the MCPTT group as specified in clause 6.6.3.1.3;\niv)\tif the in-progress imminent peril state of the group is set to a value of \"true\":\nA)\tfor each of the other affiliated member of the group generate a SIP MESSAGE request notification of the MCPTT user's imminent peril indication as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function, setting the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"true\"; and\nB)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [3]; and\nv)\tupon receiving a SIP 200 (OK) response to the SIP re-INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31];\ng)\tif the in-progress emergency state of the group is set to a value of \"false\" and if the SIP INVITE request contains an imminent peril indication set to a value of \"true\", the controlling MCPTT function:\ni)\tshall cache the information that the MCPTT user has initiated an MCPTT imminent peril call; and\nii)\tif the in-progress imminent peril state of the group is set to a value of \"false\":\nA)\tshall set the in-progress imminent peril state of the group to a value of \"true\";\nB)\tshall generate SIP re-INVITE requests for the MCPTT imminent peril group call to the other call participants of the MCPTT group as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.15; and\nC)\tupon receiving a SIP 200 (OK) response to the SIP re-INVITE request the controlling MCPTT function shall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\niii)\tif the in-progress imminent peril state of the group is set to a value of \"true\":\nA)\tfor each of the other affiliated member of the group generate a SIP MESSAGE request notification of the MCPTT user's imminent peril indication as specified in 3GPP TS 24.379 [29] clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function, setting the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"true\"; and\nB)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [3];\nh)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.379 [29], clause 6.3.3.2.3.2;\ni)\tshall include in the SIP 200 (OK) response an SDP answer to the SDP offer in the incoming SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function;\nj)\tshall include in the SIP 200 (OK) response with the warning text set to \"123 MCPTT session already exists\" as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server;\nk)\tif the received SIP re-INVITE request contains an alert indication set to a value of \"true\" and this is an unauthorised request for an MCPTT emergency alert as specified in clause 6.6.3.1.8.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server;\nl)\tif the received SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\" and if the in-progress emergency state of the group is set to a value of \"true\", shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server;\nNOTE 4:\tIn this case, the request was for an imminent peril call but a higher priority MCPTT emergency call was already in progress on the group. Hence, the imminent peril call request aspect of the request is denied but the request is granted with emergency level priority.\nm)\tshall interact with media plane as specified in 3GPP TS 29.380 [31] clause 6.3;\nNOTE 5:\tResulting media plane processing is completed before the next step is performed.\nn)\tshall send the SIP 200 (OK) response towards the inviting MCPTT client or inviting non-controlling MCPTT function according to 3GPP TS 24.229 [3];\no)\tshall generate a notification to the MCPTT clients, which have subscribed to the conference event package that the inviting MCPTT User has joined in the MCPTT group session, as specified in clause 6.6.3.4;\nNOTE 6:\tAs a group document can potentially have a large content, the IWF performing the controlling role can notify using content-indirection as defined in IETF RFC 4483 [17].\np)\tshall send a SIP NOTIFY request to each MCPTT client according to 3GPP TS 24.229 [3];\nq)\tUpon receiving a SIP ACK to the above SIP 200 (OK) response and the SIP 200 (OK) response contained a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server with the warning text containing the mcptt-warn-code set to \"149\", shall follow the procedures in clause 6.6.3.1.11; and\nr)\tshall not continue with the rest of the clause.\nUpon receiving a SIP 183 (Session Progress) response to the SIP INVITE request specified in clause 10.1.4.1 containing a P-Answer-State header field with the value \"Unconfirmed\" as specified in IETF RFC 4964 [19], the timer TNG1 (acknowledged call setup timer) is not running, the controlling MCPTT function supports media buffering and the SIP final response is not yet sent to the inviting MCPTT client:\n1)\tshall generate a SIP 200 (OK) response to SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.3.2, with the IWF acting as the controlling MCPTT function;\n2)\tshall include the warning text set to \"122 too many participants\" as specified in 3GPP TS 24.379 [29] clause 4.4 with the IWF acting as the MCPTT server, in the SIP 200 (OK) response, if the prearranged MCPTT group has more than the maximum number of members as allowed by the IWF;\n3)\tshall include in the SIP 200 (OK) response an SDP answer to the SDP offer in the incoming SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function;\n4)\tshall include a P-Answer-State header field with the value \"Unconfirmed\";\n5)\tif the SIP INVITE request contains an alert indication set to a value of \"true\" and this is an unauthorised request for an MCPTT emergency alert as specified in clause 6.6.3.1.8.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server;\n6)\tif the received SIP INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\" and if the in-progress emergency state of the group is set to a value of \"true\", shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server;\n7)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31] clause 6.3;\nNOTE 7:\tResulting user plane processing is completed before the next step is performed.\n8)\tshall send the SIP 200 (OK) response towards the inviting MCPTT client according to 3GPP TS 24.229 [3];\n9)\tshall generate a notification to the MCPTT clients, which have subscribed to the conference event package that the inviting MCPTT User has joined in the MCPTT group session, as specified in clause 6.6.3.4; and\nNOTE 8:\tAs a group document can potentially have a large content, the controlling MCPTT function can notify using content-indirection as defined in IETF RFC 4483 [17].\n10)\tshall send a SIP NOTIFY request to each MCPTT client according to 3GPP TS 24.229 [3].\nUpon receiving a SIP 183 (Session Progress) response for a SIP INVITE request as specified in clause 10.1.4.1.2 containing an indication of required group members, the timer TNG1 (acknowledged call setup timer) is running and all SIP 200 (OK) responses have been received to all SIP INVITE requests sent to MCPTT clients specified in clause 10.1.4.1.1, then the IWF performing the controlling role shall wait until the SIP 200 (OK) response has been received to the SIP INVITE request specified in clause 10.1.4.1.2 before generating a SIP 200 (OK) response to the \"SIP INVITE request for controlling MCPTT function of an MCPTT group\".\nUpon receiving a SIP 200 (OK) response for a SIP INVITE request as specified in clause 10.1.4.1 that was sent to an affiliated and required group member; and\n1)\tif the MCPTT ID in the SIP 200 (OK) response matches to the MCPTT ID in the corresponding SIP INVITE request;\n2)\tthere are no outstanding SIP 200 (OK) responses to SIP INVITE requests which were sent to affiliated and required group members; and\n3)\tthere is no outstanding SIP 200 (OK) response to a SIP INVITE request sent in clause 10.1.4.1.2 where the SIP 183 (Session Progress) response contained an indication of required group members;\nthe IWF performing the controlling role:\n1)\tshall stop timer TNG1 (acknowledged call setup timer) as described in clause 6.6.3.3;\n2)\tshall generate SIP 200 (OK) response to the SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.3.2, with the IWF acting as the controlling MCPTT function, before continuing with the rest of the steps;\n3)\tshall include the warning text set to \"122 too many participants\" as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server in the SIP 200 (OK) response, if all members were not invited because the prearranged MCPTT group has been exceeded the maximum number of members as allowed by the IWF;\n4)\tshall include in the SIP 200 (OK) response an SDP answer to the SDP offer in the incoming SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function;\n5)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31] clause 6.3;\nNOTE 9:\tResulting media plane processing is completed before the next step is performed.\n6)\tshall send a SIP 200 (OK) response to the inviting MCPTT client according to 3GPP TS 24.229 [3];\n7)\tshall generate a notification to the MCPTT clients, which have subscribed to the conference event package that the inviting MCPTT user has joined in the MCPTT group session, as specified in clause 6.6.3.4; and\nNOTE 10:\tAs a group document can potentially have a large content, the IWF performing the controlling role can notify using content-indirection as defined in IETF RFC 4483 [17].\n8)\tshall send the SIP NOTIFY request to the MCPTT clients according to 3GPP TS 24.229 [3].\nUpon:\n1)\treceiving a SIP 200 (OK) response for a SIP INVITE request as specified in clause 10.1.4.1;\n2)\tthe timer TNG1 (acknowledged call setup timer) is not running;\n3)\tthe local counter of the number of SIP 200 (OK) responses received from invited members is equal to the value of the minimum number of participants that the IWF requires to start a call;\n4)\tthe IWF performing the controlling role supports media buffering; and\n5)\tthe SIP final response has not yet been sent to the inviting MCPTT client;\nthe IWF performing the controlling role according to local policy:\n1)\tshall generate SIP 200 (OK) response to the SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.2, with the IWF acting as the controlling MCPTT function;\n2)\tshall include the warning text set to \"122 too many participants\" as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server in the SIP 200 (OK) response, if all members were not invited because the prearranged MCPTT group has exceeded the number of members as allowed by the IWF performing the controlling role;\n3)\tshall include in the SIP 200 (OK) response an SDP answer to the SDP offer in the incoming SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function;\n4)\tif the SIP INVITE request contains an alert indication set to a value of \"true\" and this is an unauthorised request for an MCPTT emergency alert as specified in clause 6.6.3.1.8.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server;\n5)\tif the received SIP INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\" and if the in-progress emergency state of the group is set to a value of \"true\", shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server;\n6)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31] clause 6.3;\nNOTE 11:\tResulting media plane processing is completed before the next step is performed.\n7)\tshall send a SIP 200 (OK) response to the inviting MCPTT client according to 3GPP TS 24.229 [3];\n8)\tshall generate a notification to the MCPTT clients, which have subscribed to the conference event package that the inviting MCPTT user has joined in the MCPTT group session, as specified in clause 6.6.3.4; and\nNOTE 12:\tAs a group document can potentially have a large content, the IWF performing the controlling role can notify using content-indirection as defined in IETF RFC 4483 [17].\n9)\tshall send the SIP NOTIFY request to the MCPTT clients according to 3GPP TS 24.229 [3].\nUpon expiry of timer TNG1 (acknowledged call setup timer), if there are outstanding SIP 200 (OK) responses to SIP INVITE requests sent to affiliated and required group members, the IWF performing the controlling role shall follow the procedures specified in clause 6.6.3.3.\nIf timer TNG1 (acknowledged call setup timer) is running and a final SIP 4xx, 5xx or 6xx response is received from an affiliated and required group member, the IWF performing the controlling role shall follow the relevant procedures specified in clause 6.6.3.3.\nIf:\n1)\ttimer TNG1 (acknowledged call setup timer) is not running;\n2)\tthe local counter of the number of SIP 200 (OK) responses received from invited members is equal to the value of the minimum number of group members required by the IWF to start a call; and\n3)\ta final SIP 4xx, 5xx or 6xx response is received from an invited MCPTT client;\nthen the IWF performing the controlling role shall perform one of the following based on policy:\n1)\tsend the SIP final response towards the inviting MCPTT client, according to 3GPP TS 24.229 [3], if a SIP final response was received from all the other invited MCPTT clients and the SIP 200 (OK) response is not yet sent; or\n2)\tremove the invited MCPTT client from the MCPTT Session as specified in clause 6.6.3.1.2, if a SIP final response other than 2xx or 3xx was received from all the invited MCPTT clients and the SIP 200 (OK) response is already sent. The IWF performing the controlling role may invite an additional member of the prearranged MCPTT group as specified in clause 10.1.4.1 that has not already been invited, if the prearranged MCPTT group has less than the maximum number of members as allowed by the IWF, and all members have not yet been invited.\nIf the group identity in the \"SIP INVITE request for controlling MCPTT function of an MCPTT group\" is a TGI and constituent MCPTT groups were invited as specified in clause 10.1.4.1.2 and,\n1)\tif all non-controlling MCPTT functions hosting the constituent MCPTT groups have responded with a SIP 2xx, SIP 3xx, SIP 4xx, SIP 5xx or SIP 6xx responses to the \"SIP INVITE request for non-controlling MCPTT function of an MCPTT group\"; and\n2)\tif all expected SIP INFO requests containing a floor request are received;\nthen the IWF performing the controlling role shall indicate to the media plane that all final responses are received.\nNOTE 13:\tIf the SIP 200 (OK) response to the SIP INVITE request for non-controlling MCPTT function of an MCPTT group included the application/vnd.3gpp.mcptt-info+xml MIME body with the <floor-state> element set to \"floor-taken\", the controlling MCPTT function expects that the non-controlling MCPTT functions sends a SIP INFO request containing a floor request.\nUpon receiving a SIP ACK to the SIP 200 (OK) response sent towards the inviting MCPTT client, and the SIP 200 (OK) response was sent with the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29] clause 4.4, with the IWF acting as the MCPTT server, the controlling MCPTT function shall follow the procedures in clause 6.6.3.1.11.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_24.379_clause_10.1.1.4.2",
        "clause_6.6.3.1.8.2",
        "clause_6.6.3.1.8.5",
        "ts_24.379_clause_6.3.3.1.17",
        "ts_24.379_clause_6.3.5.2",
        "clause_6.6.3.1.8.7",
        "ts_24.379_clause_6.3.3.2.2",
        "clause_6.6.3.1.9",
        "ts_24.379_clause_6.3.6",
        "clause_9.2.1.3.6",
        "ts_24.379_clause_4.4",
        "clause_9.2.1.3.7",
        "clause_6.6.3.5",
        "ts_29.380_clause_6.3",
        "clause_10.1.4.1.2",
        "clause_6.6.5.3",
        "clause_6.6.3.3",
        "clause_6.6.3.1.8.1",
        "clause_6.6.3.1.10",
        "clause_10.1.4.1.1",
        "clause_6.6.5.2",
        "clause_10.1.4.4.3",
        "clause_6.6.3.1.3",
        "ts_24.379_clause_6.3.3.1.11",
        "ts_24.379_clause_6.3.3.1.15",
        "ts_24.379_clause_6.3.3.2.3.2",
        "ts_24.379_clause_6.3.3.2.1",
        "clause_6.6.3.4",
        "clause_6.6.3.1.11",
        "clause_10.1.4.1",
        "clause_6.6.3.1.2",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.4.3",
      "section_id": "10.1.4.3",
      "section_title": "End group call at the IWF performing the terminating controlling role",
      "content": "Upon receiving a SIP BYE request the IWF performing the controlling role shall follow the procedures as specified in clause 6.6.3.2.1.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.3.2.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.4.4.1",
      "section_id": "10.1.4.4.1",
      "section_title": "General",
      "content": "This clause describes the procedures of each functional entity for ending the group call initiated by the IWF performing the controlling role.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_10.1.4.4.2",
      "section_id": "10.1.4.4.2",
      "section_title": "SIP BYE request for releasing MCPTT session for a group call",
      "content": "When the MCPTT session for group call needs to be released as specified in clause 6.6.7.1, the IWF performing the controlling role, shall follow the procedures in clause 6.6.3.1.2.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.7.1",
        "clause_6.6.3.1.2"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.4.4.3",
      "section_id": "10.1.4.4.3",
      "section_title": "SIP BYE request towards a MCPTT client",
      "content": "When an MCPTT client needs to be removed from the MCPTT session (e.g. due to de-affiliation or admitting a higher priority user), the IWF performing the controlling role shall follow the procedures in clause 6.6.3.1.2.\nAfter successful removing the MCPTT client from the MCPTT session, the IWF performing the controlling role may generate a notification to the MCPTT clients, which have subscribed to the conference event package that an MCPTT user has been removed from the MCPTT session, as specified in clause 6.6.3.4 and send the SIP NOTIFY request to the MCPTT client according to 3GPP TS 24.229 [3].",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.3.1.2",
        "clause_6.6.3.4",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.4.5.1",
      "section_id": "10.1.4.5.1",
      "section_title": "Terminating procedures",
      "content": "Upon receipt of a SIP INVITE request that includes an MCPTT session identity of an ongoing MCPTT session in the Request-URI the IWF performing the controlling role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The IWF performing the controlling role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [14]. Otherwise, continue with the rest of the steps;\nNOTE 1:\tif the SIP INVITE request contains an emergency indication or an imminent peril indication set to a value of \"true\" and this is an authorised request for originating an MCPTT emergency group call as determined by clause 6.6.3.1.8.2, or for originating an MCPTT imminent peril group call as determined by clause 6.6.3.1.8.5, with the IWF performing the controlling role can according to local policy choose to accept the request.\n2)\tshall reject the SIP request with a SIP 404 (Not Found) response if the MCPTT group call represented by the MCPTT session identity in Request-URI header is not present;\n3)\tshall validate that the received SDP offer includes at least one media stream for which the media parameters and at least one codec or media format is acceptable by the IWF performing the controlling role and if not, reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps Otherwise, continue with the rest of the steps;\n4)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if:\na)\tan Accept-Contact header field does not include the g.3gpp.mcptt media feature tag; or\nb)\tan Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\";\n5)\tshall determine the MCPTT ID of the calling user;\n6)\tif the user identified by the MCPTT ID is not authorised to join the prearranged group session as specified in clause 6.6.5.2, shall send a SIP 403 (Forbidden) response with the warning text set to \"121 user is not authorised to join the group call\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function. Otherwise continue with the rest of the steps below;\n7)\tshall perform the actions on receipt of an initial SIP INVITE request as described in 3GPP TS 24.379 [29], clause 6.3.3.2.2, with the IWF acting as the controlling MCPTT function;\n8)\tif the user identified by the MCPTT ID is not affiliated to the MCPTT group ID associated with the MCPTT session identity as specified in clause 6.6.5.2, shall return a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.4;\n9)\tshall check if a Resource-Priority header field is included in the incoming SIP INVITE request and may apply any preferential treatment to the SIP request as specified in 3GPP TS 24.229 [3];\n10)\tif <on-network-max-participant-count> as specified in 3GPP TS 24.481 [16] is already reached:\na)\tif, according to local policy, the user identified by the MCPTT ID in the SIP INVITE request is deemed to have a higher priority than an existing user in the group session, may remove a participant from the session by following clause 10.1.4.4.3, and skip the next step; and\nNOTE 2:\tThe local policy for deciding whether to admit a user to a call that has reached its maximum amount of participants can include the <user-priority> and the <participant-type> of the user as well as other information of the user from the group document as specified in 3GPP TS 24.481 [16]. The local policy decisions can also include taking into account whether the imminent-peril indicator or emergency indicator was received in the SIP INVITE request.\nb)\tshall return a SIP 486 (Busy Here) response with the warning text set to \"122 too many participants\" to the originating network as specified in 3GPP TS 24.379 [29], clause 4.4 with the IWF acting as the controlling MCPTT function. Otherwise, continue with the rest of the steps;\n11)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.379 [29], clause 6.3.3.2.3.2, with the IWF acting as the controlling MCPTT function;\n12)\tshall include in the SIP 200 (OK) response an SDP answer to the SDP offer in the incoming SIP INVITE request as specified in 3GPP TS 24.379 [29], clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function;\n13)\tshall interact with media plane as specified in 3GPP TS 29.380 [31] clause 6.3;\nNOTE 3:\tResulting media plane processing is completed before the next step is performed.\n14)\tshall send the SIP 200 (OK) response towards the inviting MCPTT client according to 3GPP TS 24.229 [3];\n15)\tshall generate a notification to the MCPTT clients, which have subscribed to the conference event package that the inviting MCPTT User has joined in the MCPTT group session, as specified in clause 6.6.3.4; and\nNOTE 4:\tAs a group document can potentially have a large content, the IWF performing the controlling role can notify using content-indirection as defined in IETF RFC 4483 [17].\n16)\tshall send a SIP NOTIFY request to each MCPTT client according to 3GPP TS 24.229 [3].",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.6.3.1.8.2",
        "clause_6.6.3.1.8.5",
        "clause_6.6.5.2",
        "ts_24.379_clause_4.4",
        "ts_24.379_clause_6.3.3.2.2",
        "clause_4.4",
        "clause_10.1.4.4.3",
        "ts_24.379_clause_6.3.3.2.3.2",
        "ts_24.379_clause_6.3.3.2.1",
        "ts_29.380_clause_6.3",
        "clause_6.6.3.4",
        "ts_24.379",
        "ts_24.229",
        "ts_24.481",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.4.6",
      "section_id": "10.1.4.6",
      "section_title": "Late call entry initiated by IWF performing the controlling role",
      "content": "When the IWF performing the controlling role is notified that an MCPTT client is newly affiliated or comes back from out of coverage, the IWF performing the controlling role shall invite the MCPTT client to join an ongoing MCPTT group call by following the procedures specified in clause 10.1.4.1.\nNOTE:\tHow the IWF is informed when an MCPTT client is coming back from out of coverage is out of scope of present document.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_10.1.4.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.4.7",
      "section_id": "10.1.4.7",
      "section_title": "Receipt of a SIP re-INVITE request",
      "content": "In the procedures in this clause:\n1)\temergency indication in an incoming SIP INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n2)\timminent peril indication in an incoming SIP INVITE request refers to the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nUpon receipt of a SIP re-INVITE request for an MCPTT session identity identifying an on-demand prearranged MCPTT group session, the IWF performing the controlling role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP re-INVITE request with a SIP 500 (Server Internal Error) response. The IWF performing the controlling role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [14] and skip the rest of the steps;\nNOTE 1:\tIf the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <emergency-ind> element set to a value of \"true\", the IWF performing the controlling role can choose to accept the request.\n2)\tif received SIP re-INVITE request includes an application/vnd.3gpp.mcptt-info+xml MIME body with an <emergency-ind> element included or an <imminentperil-ind> element included, shall validate the request as described in 3GPP TS 24.379 [29], clause 6.3.3.1.17, with the IWF acting as the controlling MCPTT function;\n3)\tif the received SIP re-INVITE request contains an unauthorised request for an MCPTT emergency call as determined by clause 6.6.3.1.8.2:\na)\tshall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response as specified in clause 6.6.3.1.9; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n4)\tif the received SIP re-INVITE request contains an imminent peril indication set to \"true\" for an MCPTT imminent peril group call and this is an unauthorised request for an MCPTT imminent peril group call as determined by clause 6.6.3.1.8.6, shall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response with the following clarifications:\na)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"false\"; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n5)\tif a Resource-Priority header field is included in the received SIP re-INVITE request:\na)\tif the Resource-Priority header field is set to the value indicated for emergency calls and the SIP re-INVITE request does not contain an emergency indication and the in-progress emergency state of the group is set to a value of \"false\", shall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response and skip the rest of the steps; and\nb)\tif the Resource-Priority header field is set to the value indicated for imminent peril calls and the SIP re-INVITE request does not contain an imminent peril indication and the in-progress imminent peril state of the group is set to a value of \"false\", shall reject the SIP INVITE request with a SIP 403 (Forbidden) response and skip the rest of the steps;\n6)\tif the received SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <emergency-ind> element set to a value of \"true\" and is an authorised request to initiate an MCPTT emergency group call as determined by clause 6.6.3.1.8.2, the IWF performing the controlling role:\ni)\tshall cache the MCPTT ID of the MCPTT user that has initiated an MCPTT emergency call;\nii)\tif the received SIP INVITE contains an alert indication set to a value of \"true\" and this is an authorised request for an MCPTT emergency alert meeting the conditions specified in clause 6.6.3.1.8.1, shall cache the MCPTT ID of the MCPTT user that has initiated an MCPTT emergency alert;\niii)\tif the in-progress emergency state of the group is set to a value of \"true\":\nA)\tfor each of the other affiliated MCPTT members of the group generate a SIP MESSAGE request notification of the MCPTT user's emergency indication as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function, setting the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"true\";\nB)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [3]; and\nC)\tif the in-progress imminent peril state of the group is set to a value of \"true\", shall set it to a value of \"false\"; and\niv)\tif the in-progress emergency state of the group is set to a value of \"false\":\nA)\tshall set the value of the in-progress emergency state of the group to \"true\";\nB)\tshall start timer TNG2 (in-progress emergency group call timer) and handle its expiry as specified in clause 6.6.3.1.10;\nNOTE 2:\tThe interactions of TNG2 with the TNG3 (group call timer) are explained in clause 6.6.3.5.2.\nC)\tshall generate SIP re-INVITE requests for the MCPTT emergency group call to the other MCPTT participants of the MCPTT group call as specified in clause 6.6.3.1.3;\nD)\tshall send the SIP re-INVITEs towards the other MCPTT participants of the MCPTT group call; and\nE)\tupon receiving a SIP 200 (OK) response to the SIP re-INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31];\n7)\tif the received SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <emergency-ind> element set to a value of \"false\" and is an unauthorised request for an MCPTT emergency group call cancellation as determined by clause 6.6.3.1.8.4:\na)\tshall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response;\nb)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 with an <emergency-ind> element set to a value of \"true\";\nc)\tif an <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body is included in the SIP re-INVITE request set to \"false\", and there is an outstanding MCPTT emergency alert for the MCPTT user, shall include in the application/vnd.3gpp.mcptt-info+xml MIME body an <alert-ind> element set to a value of \"true\"; and\nd)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n8)\tif the received SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <emergency-ind> element set to a value of \"false\" and is determined to be an authorised request for an MCPTT emergency call cancellation as specified in clause 6.6.3.1.10 and the in-progress emergency state of the group to is set to a value of \"true\" the IWF performing the controlling role:\na)\tshall set the in-progress emergency group state of the group to a value of \"false\";\nb)\tshall clear the cache of the MCPTT ID of the MCPTT user as having an outstanding MCPTT emergency group call;\nc)\tif an <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body is included and set to \"false\" and is determined to be an authorised request for an MCPTT emergency alert cancellation as specified in clause 6.6.3.1.8.3 and there is an outstanding MCPTT emergency alert for the MCPTT user shall:\ni)\tif the received SIP re-INVITE request contains an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, clear the cache of the MCPTT ID of the MCPTT user identified by the <originated-by> element as having an outstanding MCPTT emergency alert; or\nii)\tif the received SIP re-INVITE request does not contain an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, clear the cache of the MCPTT ID of the sender of the SIP re-INVITE request as having an outstanding MCPTT emergency alert;\nd)\tshall generate SIP re-INVITE requests to the MCPTT participants in the group call as specified in clause 6.6.3.1.3. The MCPTT controlling function:\ni)\tfor each of the other MCPTT participants in the group call shall send the SIP re-INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nii)\tUpon receiving a SIP 200 (OK) response to the SIP re-INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31];\nNOTE 3:\tClause 6.6.3.1.3 will inform the group call (MCPTT) participants of the cancellation of the MCPTT group's in-progress emergency state and the cancellation of the MCPTT emergency alert if applicable.\ne)\tshall stop timer TNG2 (in-progress emergency group call timer); and\nNOTE 4:\tThe interactions of TNG2 with the TNG3 (group call timer) are explained in clause 6.6.3.5.2;\nf)\tfor each of the affiliated MCPTT members of the group that are not participating in the call:\ni)\tgenerate a SIP MESSAGE request notification of the cancellation of the MCPTT user's emergency call as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function;\nii)\tset the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"false\";\niii)\tif indicated above in step 8) c), set the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"false\"; and\niv)\tsend the SIP MESSAGE request according to 3GPP TS 24.229 [3];\n9)\tif the received SIP re-INVITE request contains an imminent peril indication and the in-progress emergency group state of the group is set to a value of \"false\", shall perform the procedures specified in clause 10.1.4.8 and skip the rest of the steps.\nUpon receiving a SIP 200 (OK) response to a SIP re-INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31];\n1)\tshall generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [3];\n2)\tshall include in the SIP 200 (OK) response an SDP answer according to 3GPP TS 24.229 [3] with the clarifications specified in 3GPP TS 24.379 [29], clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function;\n3)\tshall include the \"norefersub\" option tag in a Supported header field according to IETF RFC 4488 [12];\n4)\tshall include the \"tdialog\" option tag in a Supported header field according to IETF RFC 4538 [13];\n5)\tif the received SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"true\" and if this is an unauthorised request for an MCPTT emergency alert as determined by clause 6.6.3.1.8.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function;\n6)\tif the received SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"false\" and if this is an unauthorised request for an MCPTT emergency alert cancellation as determined by clause 6.6.3.1.8.3, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function;\n7)\tif the received SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\", this is an authorised request for an MCPTT imminent peril group call and the in-progress emergency state of the group is set to a value of \"true\", shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function;\nNOTE 5:\tIn this case, the request was for an imminent peril call but a higher priority MCPTT emergency call was already in progress on the group. Hence, the imminent peril call request aspect of the request is denied but the request is granted with emergency level priority.\n8)\tshall interact with media plane as specified in 3GPP TS 29.380 [31]; and\n9)\tshall send the SIP 200 (OK) response towards the MCPTT client according to 3GPP TS 24.229 [3].\nUpon receiving a SIP ACK to the SIP 200 (OK) response sent towards the inviting MCPTT client, and the SIP 200 (OK) response was sent with the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function, the IWF performing the controlling role shall follow the procedures in clause 6.6.3.1.11.\nUpon receipt of a SIP 2xx response for an outgoing SIP MESSAGE request, shall handle according to 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_6.3.3.1.17",
        "clause_6.6.3.1.8.2",
        "clause_6.6.3.1.9",
        "clause_6.6.3.1.8.6",
        "clause_6.6.3.1.8.1",
        "ts_24.379_clause_6.3.3.1.11",
        "clause_6.6.3.1.10",
        "clause_6.6.3.5.2",
        "clause_6.6.3.1.3",
        "clause_6.6.3.1.8.4",
        "clause_6.6.3.1.8.3",
        "ts_29.380_clause_6.6.3.1.3",
        "clause_10.1.4.8",
        "ts_24.379_clause_6.3.3.2.1",
        "ts_24.379_clause_4.4",
        "clause_6.6.3.1.11",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.4.8",
      "section_id": "10.1.4.8",
      "section_title": "Handling of a SIP re-INVITE request for imminent peril session",
      "content": "This procedure is initiated by the IWF performing the controlling role as the result of an action in clause 10.1.4.7.\nIn the procedures in this clause:\n1)\timminent peril indication in an incoming SIP re-INVITE request refers to the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nWhen the IWF performing the controlling role receives a SIP re-INVITE request with an imminent peril indication set to \"true\", the IWF performing the controlling role:\n1)\tif the in-progress emergency state of the group is set to a value of \"false\" and if the SIP re-INVITE request contains an imminent peril indication set to a value of \"true\" or the in-progress imminent peril state of the group to \"true\", the IWF performing the controlling role shall:\nNOTE 1:\tThe calling procedure has already determined that this is not an unauthorised request for an MCPTT imminent peril call, therefore that check does not need to be repeated in the current procedure.\na)\tif the in-progress imminent peril state of the group is set to a value of \"true\" and the MCPTT user is indicating a new imminent peril indication:\ni)\tfor each of the other affiliated MCPTT member of the group generate a SIP MESSAGE request notification of the MCPTT user's imminent peril indication as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function, with the following clarifications;\nA)\tset the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"true\"; and\nB)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [3];\nb)\tif the in-progress imminent peril state of the group is set to a value of \"false\";\ni)\tset the value of the in-progress imminent peril state of the group to \"true\";\nii)\tgenerate SIP re-INVITE requests for the MCPTT imminent peril group call to MCPTT participants in the MCPTT group call as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.15, with the IWF acting as the controlling MCPTT function;\niii)\tsend the SIP re-INVITES to all of the other MCPTT participants in the MCPTT group call;\niv)\tfor each of the affiliated MCPTT members of the group not participating in the group call, generate a SIP MESSAGE request notification of the MCPTT user's imminent peril indication as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function, with the following clarifications;\nA)\tset the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"true\"; and\nB)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [3]; and\nc)\tcache the information that the MCPTT user has initiated an MCPTT imminent peril call;\n2)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"false\" and is an unauthorised request for an MCPTT imminent peril group call cancellation as determined by clause 6.6.3.1.8.6 shall:\na)\treject the SIP re-INVITE request with a SIP 403 (Forbidden) response to the SIP re-INVITE request; and\nb)\tinclude in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"false\";\nc)\tsend the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3]; and\nd)\tskip the rest of the steps;\n3)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"false\" and is determined to be an authorised request for an MCPTT imminent peril call cancellation as specified in clause 6.6.3.1.8.6 and the in-progress imminent peril state of the group to is set to a value of \"true\" the IWF performing the controlling role shall:\na)\tset the in-progress imminent peril state of the group to a value of \"false\";\nb)\tcache the information that the MCPTT user no longer has an outstanding MCPTT imminent peril group call;\nc)\tgenerate SIP re-INVITES requests to the other MCPTT participants in the MCPTT group call as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.15, with the IWF acting as the controlling MCPTT function. The MCPTT controlling function:\ni)\tfor each MCPTT participant shall send the SIP re-INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nii)\tUpon receiving a SIP 200 (OK) response to the SIP re-INVITE request the IWF performing the controlling role interact with the media plane as specified in 3GPP TS 29.380 [31]; and\nNOTE 2:\t3GPP TS 24.379 [29], clause 6.3.3.1.15, with the IWF acting as the controlling MCPTT function, will inform the affiliated and joined MCPTT members of the cancellation of the MCPTT group's in-progress emergency state and the cancellation of the MCPTT emergency alert if applicable.\nd)\tfor each of the affiliated MCPTT members of the group not participating in the call shall:\ni)\tgenerate a SIP MESSAGE request notification of the cancellation of the MCPTT user's imminent peril call as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function;\nii)\tset the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"false\"; and\niii)\tsend the SIP MESSAGE request according to 3GPP TS 24.229 [3];\n4)\tshall include in the SIP 200 (OK) response an SDP answer according to 3GPP TS 24.229 [3] with the clarifications specified in 3GPP TS 24.379 [29], clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function;\n5)\tshall include the \"norefersub\" option tag in a Supported header field according to IETF RFC 4488 [12];\n6)\tshall include the \"tdialog\" option tag in a Supported header field according to IETF RFC 4538 [13];\n7)\tshall interact with media plane as specified in 3GPP TS 29.380 [31]; and\n8)\tshall send the SIP 200 (OK) response towards the MCPTT client according to 3GPP TS 24.229 [3].\nUpon receipt of a SIP 2xx response for an outgoing SIP MESSAGE request, shall handle according to 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "clause_10.1.4.7",
        "ts_24.379_clause_6.3.3.1.11",
        "ts_24.379_clause_6.3.3.1.15",
        "clause_6.6.3.1.8.6",
        "ts_29.380_clause_6.3.3.1.15",
        "ts_24.379_clause_6.3.3.2.1",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.1.5",
      "section_id": "10.1.5",
      "section_title": "Non-controlling role procedures",
      "content": "Editor's note:\tContent to be added.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_10.2.1.1.1",
      "section_id": "10.2.1.1.1",
      "section_title": "Procedure for initiating an MCPTT chat group session and procedure for joining an MCPTT chat group session",
      "content": "This clause is referenced from other procedures.\nTo initiate or join an MCPTT group session using an MCPTT group identity, identifying an MCPTT chat group, the IWF performing the participating role shall generate an initial SIP INVITE request by following the UE originating session procedures specified in 3GPP TS 24.229 [3], with the clarifications given below.\nThe IWF performing the participating role:\n1)\tif the IWF is originating an MCPTT emergency group call shall comply with the procedures in clause 6.4.1.1;\n2)\tif the IWF is originating an MCPTT imminent peril group call, shall comply with the procedures in clause 6.4.1.6;\n3)\tshall include the g.3gpp.mcptt media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" in the Contact header field of the SIP INVITE request according to IETF RFC 3840 [9];\n4)\tshall include an Accept-Contact header field containing the g.3gpp.mcptt media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [5];\n5)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Preferred-Service header field according to IETF RFC 6050 [7] in the SIP INVITE request;\n6)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [5];\n7)\tif the emergency group state for this group is set to \"MEG 2: in-progress\" or \"MEG 4: confirm-pending\", shall comply with the procedures in clause 6.4.1.2;\n8)\tif the imminent peril group state for this group is set to \"MIG 2: in-progress\" or \"MIG 4: confirm-pending\", shall include the Resource-Priority header field and comply with the procedures in clause 6.4.1.8;\n9)\tshall contain an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with:\na)\tthe <session-type> element set to a value of \"chat\";\nb)\tthe <mcptt-request-uri> element set to the group identity; and\nc)\tthe <mcptt-client-id> element set to a value determined by the IWF;\nNOTE 1:\tHow the IWF determines the value of the <mcptt-client-id> element is out of scope of the present document.\nNOTE 2:\tThe <mcptt-calling-user-id> will be inserted into the body of the SIP INVITE request by the referring clause.\n10)\tshall include an SDP offer according to 3GPP TS 24.229 [3] with the clarifications specified in clause 6.1.1;\n11)\tif an implicit floor request is required, shall indicate this as specified in clause 6.7; and\n12)\tshall not perform the remainder of this procedure.\nOn receiving a SIP 2xx response to the SIP INVITE request, the IWF performing the participating role:\n1)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31];\n2)\tif the MCPTT emergency group call state is set to \"MEGC 2: emergency-call-requested\" or \"MEGC 3: emergency-call-granted\" or the MCPTT imminent peril group call state is set to \"MIGC 2: imminent-peril-call-requested\" or \"MIGC 3: imminent-peril-call-granted\", shall perform the actions specified in clause 6.4.1.4, with the IWF acting as the MCPTT client on behalf of the IWF user homed in the IWF; and\n3)\tmay subscribe to the conference event package as specified in clause 10.3.\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request, the IWF performing the participating role:\n1)\tif the MCPTT emergency group call state is set to \"MEGC 2: emergency-call-requested\" or \"MEGC 3: emergency-call-granted\"; or\n2)\tif the MCPTT imminent peril group call state is set to \"MIGC 2: imminent-peril-call-requested\" or \"MIGC 3: imminent-peril-call-granted\";\nshall perform the actions specified in clause 6.4.1.5, with the IWF acting as the MCPTT client on behalf of the user homed in the IWF.\nOn receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing group session, the IWF performing the participating role shall follow the actions specified in clause 6.4.1.9, with the IWF acting as the MCPTT client on behalf of the user homed in the IWF.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.4.1.1",
        "clause_6.4.1.6",
        "clause_6.4.1.2",
        "clause_6.4.1.8",
        "clause_6.1.1",
        "clause_6.7",
        "clause_6.4.1.4",
        "clause_10.3",
        "clause_6.4.1.5",
        "clause_6.4.1.9",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.1.1.2",
      "section_id": "10.2.1.1.2",
      "section_title": "IWF performing the terminating participating role receives SIP re-INVITE request for an MCPTT chat group",
      "content": "This clause is referenced from other procedures.\nUpon receipt of a SIP re-INVITE request the IWF performing the participating role:\n1)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <emergency-ind> element set to a value of \"true\":\na)\tshall set the MCPTT emergency group state to \"MEG 2: in-progress\";\nb)\tshall set the MCPTT imminent peril group state to \"MIG 1: no-imminent-peril\"; and\nc)\tshall set the MCPTT imminent peril group call state to \"MIGC 1: imminent-peril-gc-capable\";\n2)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"true\", shall set the MCPTT imminent peril group state to \"MIG 2: in-progress\";\n3)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <emergency-ind> element set to a value of \"false\":\na)\tif the <mcpttinfo> element containing the <mcptt-Params> element contains an <alert-ind> element set to \"false\":\ni)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body including an <originated-by> element:\nA)\tif the MCPTT ID contained in the <originated-by> element is the MCPTT ID associated with the targeted user, shall set the MCPTT emergency alert state to \"MEA 1: no-alert\";\nb)\tshall set the MCPTT emergency group state to \"MEG 1: no-emergency\"; and\nc)\tif the MCPTT emergency group call state of the group is set to \"MEGC 3: emergency-call-granted\", shall set the MCPTT emergency group call state of the group to \"MEGC 1: emergency-gc-capable\";\n4)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"false\":\na)\tshall set the MCPTT imminent peril group state to \"MIG 1: no-imminent-peril\"; and\nb)\tshall set the MCPTT imminent peril group call state to \"MIGC 1: imminent-peril-gc-capable\";\n5)\tshall accept the SIP re-INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [3];\n6)\tshall include the g.3gpp.mcptt media feature tag in the Contact header field of the SIP 200 (OK) response;\n7)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" in the Contact header field of the SIP 200 (OK) response;\n8)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP re-INVITE request according to 3GPP TS 24.229 [3] with the clarifications given in clause 6.1.2; and\n9)\tshall send the SIP 200 (OK) response towards the controlling MCPTT server according to rules and procedures of 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.1.2",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.1.1.3",
      "section_id": "10.2.1.1.3",
      "section_title": "MCPTT in-progress emergency cancel",
      "content": "This clause is referenced from other procedures.\nTo cancel an in-progress emergency state on an MCPTT chat group, the IWF performing the participating role shall generate a SIP re-INVITE request as specified in 3GPP TS 24.229 [3], with the clarifications given below.\nThe IWF performing the participating role:\n1)\tshall, if cancelling an in-progress emergency state and optionally an MCPTT emergency alert originated by the user homed in the IWF, include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.1.3;\n2)\tshall, if cancelling an in-progress emergency state and optionally an MCPTT emergency alert originated by another MCPTT user, include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.1.10;\n3)\tshall include in the SIP re-INVITE request an SDP offer according to 3GPP TS 24.229 [3] with the clarifications specified in clause 6.1.1;\n4)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.4.1.2; and\n5)\tshall exit the procedure in the present clause.\nOn receiving a SIP 2xx response to the SIP re-INVITE request, the IWF performing the participating role:\n1)\tshall set the MCPTT emergency group state of the group to \"MEG 1: no-emergency\";\n2)\tshall set the MCPTT emergency group call state of the group to \"MEGC 1: emergency-gc-capable\"; and\n3)\tif the MCPTT emergency alert state is set to \"MEA 4: Emergency-alert-cancel-pending\", the sent SIP re-INVITE request did not contain an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body and the SIP 2xx response to the SIP request for a priority group call does not contain a Warning header field as specified in TS 24.379 [29], clause 4.4, with the IWF acting as the MCPTT server with the warning text containing the mcptt-warn-code set to \"149\", shall set the MCPTT emergency alert state to \"MEA 1: no-alert\".\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request:\n1)\tshall set the MCPTT emergency group state as \"MEG 2: in-progress\";\n2)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response contains an application/vnd.3gpp.mcptt-info+xml MIME body with an <alert-ind> element set to a value of \"true\" and the sent SIP re-INVITE request did not contain an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, the IWF performing the participating role shall set the MCPTT emergency alert state to \"MEA 3: emergency-alert-initiated\"; and\n3)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response did not contain an application/vnd.3gpp.mcptt-info+xml MIME body with an <alert-ind> element and did not contain an <originated-by> element, the MCPTT emergency alert (MEA) state shall revert to its value prior to entering the current procedure.\nNOTE:\tIf the in-progress emergency group state cancel request is rejected, the state of the session does not change, i.e. continues with MCPTT emergency group call level priority.\nOn receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing group session, the IWF performing the participating role shall follow the actions specified in clause 6.4.1.9.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.4.1.3",
        "clause_6.4.1.10",
        "clause_6.1.1",
        "clause_6.4.1.2",
        "ts_24.379_clause_4.4",
        "clause_6.4.1.9",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.1.1.4",
      "section_id": "10.2.1.1.4",
      "section_title": "MCPTT upgrade to in-progress emergency or imminent peril",
      "content": "This clause is referenced from other procedures.\nTo upgrade the MCPTT group session to an emergency condition or an imminent peril condition on a MCPTT chat group, the IWF performing the participating role shall generate a SIP re-INVITE request as specified in 3GPP TS 24.229 [3], with the clarifications given below.\n1)\tif upgrading the MCPTT group session to an MCPTT emergency call, the IWF performing the participating role:\na)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.1.1; and\nb)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.4.1.2\n2)\tif upgrading the MCPTT group session to an MCPTT imminent peril call, the IWF performing the participating role:\na)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.1.6; and\nb)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.4.1.8;\n3)\tif the SIP re-INVITE request is to be sent within an on-demand session, the IWF performing the participating role shall include in the SIP re-INVITE request an SDP offer according to 3GPP TS 24.229 [3] with the clarifications specified in clause 6.1.1;\n4)\tif an implicit floor request is required, shall indicate this as specified in clause 6.7; and\n5)\tshall skip the rest of the steps.\nOn receiving a SIP 2xx response to the SIP re-INVITE request the IWF performing the participating role:\n1)\tshall interact with the user plane as specified in 3GPP TS 29.380 [31]; and\n2)\tshall perform the actions specified in clause 6.4.1.4, with the IWF acting as the MCPTT client.\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request the IWF performing the participating role shall perform the actions specified in clause 6.4.1.5, with the IWF acting as the MCPTT client.\nOn receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing group session, the IWF performing the participating role shall follow the actions specified in clause 6.4.1.9.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.4.1.1",
        "clause_6.4.1.2",
        "clause_6.4.1.6",
        "clause_6.4.1.8",
        "clause_6.1.1",
        "clause_6.7",
        "clause_6.4.1.4",
        "clause_6.4.1.5",
        "clause_6.4.1.9",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.1.1.5",
      "section_id": "10.2.1.1.5",
      "section_title": "MCPTT in-progress imminent peril cancel",
      "content": "This clause is referenced from other procedures.\nTo cancel the in-progress imminent peril state on a MCPTT chat group, the IWF performing the participating role shall generate a SIP re-INVITE request by following the procedures specified in 3GPP TS 24.229 [3], with the clarifications given below.\nThe IWF performing the participating role:\n1)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.1.7;\n2)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.4.1.8;\n3)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with:\na)\tthe <session-type> element set to a value of \"chat\"; and\nb)\tthe <mcptt-request-uri> element set to the group identity;\n4)\tshall include the g.3gpp.mcptt media feature tag in the Contact header field of the SIP re-INVITE request according to IETF RFC 3840 [9];\n5)\tif the SIP re-INVITE request is to be sent within an on-demand session, shall include in the SIP re-INVITE request an SDP offer according to 3GPP TS 24.229 [3] with the clarifications specified in clause 6.1.1; and\n6)\tshall exit the procedure in the present clause.\nOn receiving a SIP 2xx response to the SIP re-INVITE request, the IWF performing the participating role:\n1)\tshall interact with the user plane as specified in 3GPP TS 29.380 [31];\n2)\tshall set the MCPTT imminent peril group state of the group to \"MIG 1: no-imminent-peril\"; and\n3)\tshall set the MCPTT imminent peril group call state of the group to \"MIGC 1: imminent-peril-gc-capable\".\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request:\n1)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response:\na)\tcontains an application/vnd.3gpp.mcptt-info+xml MIME body with an <imminentperil-ind> element set to a value of \"true\"; or\nb)\tdoes not contain an application/vnd.3gpp.mcptt-info+xml MIME body with an <imminentperil-ind> element;\nthen the IWF performing the participating role shall set the MCPTT imminent peril group state as \"MIG 2: in-progress\".\nNOTE:\tThis is the case where the IWF performing the participating role requested the cancellation of the MCPTT imminent peril in-progress state and was rejected.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.4.1.7",
        "clause_6.4.1.8",
        "clause_6.1.1",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.1.1.6",
      "section_id": "10.2.1.1.6",
      "section_title": "IWF performing the terminating participating role receives a SIP INVITE request for an MCPTT chat group call",
      "content": "This clause is referenced from other procedures.\nThis procedure is used for MCPTT emergency and MCPTT imminent peril calls when the targeted client is affiliated but not joined to the chat group.\nIn the procedures in this clause:\n1)\temergency indication in an incoming SIP INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n2)\timminent peril indication in an incoming SIP INVITE request refers to the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nUpon receipt of an initial SIP INVITE request, the IWF performing the participating role:\n1)\tmay reject the SIP INVITE request for any reason outside the scope of this specification;\n2)\tif the SIP INVITE request is rejected in step 1), shall respond towards controlling MCPTT function either with appropriate reject code as specified in 3GPP TS 24.229 [3] and warning texts as specified in clause 4.2.2 or with SIP 480 (Temporarily unavailable) and skip the rest of the steps of this clause;\n3)\tif the SIP INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <emergency-ind> element set to a value of \"true\":\na)\tshall set the MCPTT emergency group state to \"MEG 2: in-progress\";\nb)\tshall set the MCPTT imminent peril group state to \"MIG 1: no-imminent-peril\"; and\nc)\tshall set the MCPTT imminent peril group call state to \"MIGC 1: imminent-peril-gc-capable\"; otherwise\n4)\tif the SIP INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"true\", shall set the MCPTT imminent peril group state to \"MIG 2: in-progress\";\n5)\tshall accept the SIP INVITE request and generate a SIP 200 (OK) response according to rules and procedures of 3GPP TS 24.229 [3];\n6)\tshall include the option tag \"timer\" in a Require header field of the SIP 200 (OK) response;\n7)\tshall include the g.3gpp.mcptt media feature tag in the Contact header field of the SIP 200 (OK) response;\n8)\tshall include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" in the Contact header field of the SIP 200 (OK) response;\n9)\tshall include the Session-Expires header field in the SIP 200 (OK) response and start the SIP session timer according to IETF RFC 4028 [6]. If no \"refresher\" parameter was included in the received SIP INVITE request the \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\", otherwise shall include a \"refresher\" parameter set to the value received in the Session-Expires header field the received SIP INVITE request;\n10)\tshall include an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [3] with the clarifications given in clause 6.1.2;\n11)\tshall send the SIP 200 (OK) response towards the controlling MCPTT server according to rules and procedures of 3GPP TS 24.229 [3]; and\n12)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31].",
      "chunk_type": "general",
      "cross_references": [
        "clause_4.2.2",
        "clause_6.1.2",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.2.1.1",
      "section_id": "10.2.2.1.1",
      "section_title": "MCPTT chat session establishment",
      "content": "In this clause, the IWF originates a chat group session on behalf of a user homed in the IWF.\nNOTE 1:\tHow the IWF determines the public user identity and the MCPTT ID of the calling user is out of scope of the present document.\nThe IWF, performing the originating participating role:\n1)\tshall determine the public service identity of the controlling MCPTT function associated with the group identity of the group on which the call is to be originated;\nNOTE 2:\tHow the IWF discovers the public service identity of the controlling MCPTT function associated with the group identity is out of scope of the current document.\n2)\tif the calling user identified by the MCPTT ID is not affiliated to the group on which the call is to be originated, as determined by clause 9.2.1.2.8, shall perform the actions specified in clause 9.2.1.2.9 for implicit affiliation;\n3)\tshall generate a SIP INVITE request as specified in clause 10.2.1.1.1;\n4)\tif step 3 was performed successfully, shall complete the SIP INVITE request as specified in clause 6.6.2.1.2;\n5)\tif steps 3 and 4 were performed successfully:\na)\tshall set the Request-URI to the public service identity of the controlling MCPTT function;\nb)\tshall set the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body to the MCPTT ID of the calling user;\nc)\tmay insert the calling user's location information into an application/vnd.3gpp.mcptt-location-info+xml MIME body;\nd)\tshall send the SIP INVITE request to the controlling MCPTT function as specified in 3GPP TS 24.229 [3].\nUpon receipt of a SIP 302 (Moved Temporarily) response to the above SIP INVITE request, the IWF, performing the originating participating role:\n1)\tshall generate a SIP INVITE request as specified in clause 6.6.2.1.5;\n2)\tshall include an SDP offer based upon the SDP offer in the SIP INVITE request generated by the IWF in the step above; and\n3)\tshall send the SIP INVITE request to the controlling MCPTT function according to 3GPP TS 24.229 [3];\nUpon receipt of a SIP 2xx response to the above SIP INVITE request in step 3) the IWF performing the participating role:\n1)\tshall perform the procedures for receiving a SIP 2xx response as specified in clause 10.2.1.1.1;\n2)\tif the procedures of clause 9.2.1.2.9 for implicit affiliation were performed in the present clause, shall complete the implicit affiliation by performing the procedures of clause 9.2.1.2.10.\n3)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [6].\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the above SIP INVITE request in step 14) the IWF performing the participating role:\n1)\tshall perform the procedures for receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response as specified in clause 10.2.1.1.1;\n2)\tif the implicit affiliation procedures of clause 9.2.1.2.9 were invoked in the current procedure, shall perform the procedures of clause 9.2.1.2.10.\nOn receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing group session, the IWF performing the participating role shall follow the actions for SIP INFO as specified in clause 10.2.1.1.1.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.2.1.2.8",
        "clause_9.2.1.2.9",
        "clause_10.2.1.1.1",
        "clause_6.6.2.1.2",
        "clause_6.6.2.1.5",
        "clause_9.2.1.2.10",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.2.1.2",
      "section_id": "10.2.2.1.2",
      "section_title": "Sending of a SIP re-INVITE request towards the MCPTT controlling function",
      "content": "Upon a need to send a SIP re-INVITE request for an MCPTT session identifying an on-demand MCPTT chat group session, the IWF performing the participating role:\n1)\tif the request is for an upgrade to an in-progress emergency group state or an imminent peril group state, the IWF performing the participating role shall perform the steps in clause 10.2.1.1.4;\n2)\tif the request is for a cancellation of an in-progress emergency group state, the IWF performing the participating role shall perform the steps in clause 10.2.1.1.3;\n3)\tif the request is for a cancellation of an in-progress imminent peril group state, the IWF performing the participating role shall perform the steps in clause 10.2.1.1.5;\n4)\tshall include the MCPTT ID of the originating user in the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP re-INVITE request;\nNOTE:\tHow the IWF determines the MCPTT ID of a user homed in the IWF is out of scope of the present document.\n5)\tshall include in the SIP re-INVITE request an SDP offer as specified in clause 6.6.2.1.1.1; and\n6)\tshall send the SIP re-INVITE request according to 3GPP TS 24.229 [3].\nUpon receipt of a SIP 2xx response to the above SIP re-INVITE request, the participating MCPTT function:\n1)\tif the SIP re-INVITE request above is for an upgrade for emergency or imminent peril, follow the procedures for SIP 2xx response as specified in clause 10.2.1.1.4;\n2)\tif the SIP re-INVITE request above is for an in-progress emergency cancel, follow the procedures for SIP 2xx response as specified in clause 10.2.1.1.3; or\n3)\tif the SIP re-INVITE request above is for an in-progress imminent peril cancel, follow the procedures for SIP 2xx response as specified in clause 10.2.1.1.5.\nUpon receipt of a SIP 403 (Forbidden) response to the sent SIP re-INVITE request the participating MCPTT function, the IWF action is out of scope of the present document.\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request the IWF:\n1)\tif the SIP re-INVITE request above is for an upgrade for emergency or imminent peril, follow the procedures for SIP 4xx, 5xx or 6xx response as specified in clause 10.2.1.1.4;\n2)\tif the SIP re-INVITE request above is for an in-progress emergency cancel, follow the procedures for SIP 4xx, 5xx or 6xx response as specified in clause 10.2.1.1.3; or\n3)\tif the SIP re-INVITE request above is for an in-progress imminent peril cancel, follow the procedures for SIP 4xx, 5xx or 6xx response as specified in clause 10.2.1.1.5.\nUpon receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing session, the IWF performing the participating role shall:\n1)\tif the SIP re-INVITE request above is for an upgrade for emergency or imminent peril, follow the procedures for SIP INFO as specified in clause 10.2.1.1.4; or\n2)\tif the SIP re-INVITE request above is for an in-progress emergency cancel, follow the procedures for SIP INFO as specified in clause 10.2.1.1.3.",
      "chunk_type": "general",
      "cross_references": [
        "clause_10.2.1.1.4",
        "clause_10.2.1.1.3",
        "clause_10.2.1.1.5",
        "clause_6.6.2.1.1.1",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.2.1.3",
      "section_id": "10.2.2.1.3",
      "section_title": "Reception of a SIP INVITE request by an IWF performing the terminating participating role",
      "content": "Upon receipt of a \"SIP INVITE request for terminating participating MCPTT function\", targeting a user homed in the IWF for an MCPTT chat group, the IWF performing the participating role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the \"SIP INVITE request for terminating participating MCPTT function\" with a SIP 500 (Server Internal Error) response. The IWF performing the participating role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [14]. Otherwise, continue with the rest of the steps;\n2)\tshall check the presence of the isfocus media feature tag in the Contact header field and if it is not present then the IWF performing the participating role shall reject the request with a SIP 403 (Forbidden) response with the warning text set to \"104 isfocus not assigned\" in a Warning header field as specified in clause 4.4. Otherwise, continue with the rest of the steps; and\n3)\tshall perform the steps in 10.2.1.1.6.",
      "chunk_type": "general",
      "cross_references": [
        "clause_4.4"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.2.1.4",
      "section_id": "10.2.2.1.4",
      "section_title": "Reception of a SIP re-INVITE request by an IWF performing the terminating participating role",
      "content": "Upon receipt of a SIP re-INVITE targeting a user homed in the IWF for an MCPTT chat group, the IWF performing the participating role shall perform the steps in 10.2.1.1.2.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_10.2.2.2.1",
      "section_id": "10.2.2.2.1",
      "section_title": "IWF ending on-demand chat session",
      "content": "When the IWF performing the participating role determines a need to send a SIP BYE request, the IWF shall follow the procedures as specified in clause 6.6.2.1.3.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.2.1.3"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.2.3.1",
      "section_id": "10.2.2.3.1",
      "section_title": "Receipt of SIP BYE request for on-demand chat session",
      "content": "Upon receiving a SIP BYE request from the controlling MCPTT function, the IWF performing the participating role shall follow the procedures as specified in clause 6.6.2.2.2.1.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.2.2.2.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.3.1.1",
      "section_id": "10.2.3.1.1",
      "section_title": "Procedure for establishing an MCPTT chat session and procedure for joining an established MCPTT chat session",
      "content": "In the procedures in this clause:\n1)\tMCPTT ID in an incoming SIP INVITE request refers to the MCPTT ID of the originating user from the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP INVITE request;\n2)\tgroup identity in an incoming SIP INVITE request refers to the group identity from the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP INVITE request;\n3)\tMCPTT ID in an outgoing SIP INVITE request refers to the MCPTT ID of the called user in the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the outgoing SIP INVITE request;\n4)\temergency indication in an incoming SIP INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n5)\talert indication in an incoming SIP INVITE request refers to the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nUpon receipt of a \"SIP INVITE request for controlling MCPTT function of an MCPTT group\" containing a group identity identifying a MCPTT chat group, the IWF performing the controlling role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The IWF performing the controlling role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [14] and skip the rest of the steps;\nNOTE 1:\tIf the SIP INVITE request contains an emergency indication set to a value of \"true\", the IWF performing the controlling role can by means beyond the scope of this specification choose to accept the request.\n2)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if:\na)\tan Accept-Contact header field does not include the g.3gpp.mcptt media feature tag;\nb)\tan Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\"; or\nc)\tthe isfocus media feature tag is present in the Contact header field;\n3)\tif received SIP INVITE request includes an application/vnd.3gpp.mcptt-info+xml MIME body with an <emergency-ind> element included or an <imminentperil-ind> element included, shall validate the request as described in 3GPP TS 24.379 [29], clause 6.3.3.1.17, with the IWF acting as the controlling MCPTT function;\n4)\tshall retrieve the necessary group document(s) from the group management server for the group identity contained in the SIP INVITE request and carry out initial processing as specified in 3GPP TS 24.379 [29], clause 6.3.5.2, with the IWF acting as the participating MCPTT function and continue with the rest of the steps if the checks in 3GPP TS 24.379 [29], clause 6.3.5.2 succeed;\n5)\tif the MCPTT user identified by the MCPTT ID in the SIP INVITE request is not affiliated with the MCPTT group identified by the group identity in the SIP INVITE request as determined by the procedures of 3GPP TS 24.379 [29], clause 6.3.6, with the IWF acting as the controlling MCPTT function:\na)\tshall check if the MCPTT user is eligible to be implicitly affiliated with the MCPTT chat group as determined by clause 9.2.1.3.6; and\nb)\tif the MCPTT user is not eligible for implicit affiliation, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function and skip the rest of the steps below;\n6)\tif the SIP INVITE request contains unauthorised request for an MCPTT emergency group call as determined by clause 6.6.3.1.8.2:\na)\tshall reject the SIP INVITE request with a SIP 403 (Forbidden) response as specified in clause 6.6.3.1.9; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n7)\tif the SIP INVITE request contains an unauthorised request for an MCPTT imminent peril group call as determined by clause 6.6.3.1.8.6, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response with the following clarifications:\na)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"false\"; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n8)\tif a Resource-Priority header field is included in the SIP INVITE request:\na)\tif the Resource-Priority header field is set to the value indicated for emergency calls and the SIP INVITE request does not contain an emergency indication and the in-progress emergency state of the group is set to a value of \"false\", shall reject the SIP INVITE request with a SIP 403 (Forbidden) response and skip the remaining steps; and\nb)\tif the Resource-Priority header field is set to the value indicated for imminent peril calls and the SIP INVITE request does not contain an imminent peril indication and the in-progress imminent peril state of the group is set to a value of \"false\", shall reject the SIP INVITE request with a SIP 403 (Forbidden) response; and skip the remaining steps;\n9)\tshall validate that the received SDP offer includes at least one media stream for which the media parameters and at least one codec or media format is acceptable by the IWF performing the controlling role and if not, reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n10)\tshall create a chat group session and allocate an MCPTT session identity for the chat group session if the MCPTT chat group session identity does not already exist, and may handle timer TNG3 (group call timer) as specified in clause 6.6.3.5;\n11)\tif the chat group session is ongoing and the <on-network-max-participant-count> as specified in 3GPP TS 24.481 [16] is already reached:\na)\tif, according to local policy, the user identified by the MCPTT ID in the SIP INVITE request is deemed to have a higher priority than an existing user in the chat group session, may remove a participant from the session by following clause 10.1.4.4.3, and skip the next step; and\nNOTE 2:\tThe local policy for deciding whether to admit a user to a call that has reached its maximum amount of participants can include the <user-priority> and the <participant-type> of the user as well as other information of the user from the group document as specified in 3GPP TS 24.481 [16]. The local policy decisions can also include taking into account whether the imminent-peril indicator or emergency indicator was received in the SIP INVITE request.\nb)\tshall return a SIP 486 (Busy Here) response with the warning text set to \"122 too many participants\" to the originating network as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function. Otherwise, continue with the rest of the steps;\n12)\tif the received SIP INVITE request was determined to be eligible for implicit affiliation in step 5) and if clause 9.2.1.3.7 was not previously invoked in the present clause, shall perform the implicit affiliation as specified in clause 9.2.1.3.7;\n13)\tif the SIP INVITE request contains an emergency indication set to a value of \"true\" or the in-progress emergency state of the group to \"true\" the IWF performing the controlling role shall:\na)\tvalidate that the SIP INVITE request includes a Resource-Priority header field populated with the values for an MCPTT emergency group call as specified in clause 6.6.3.1.12, and if not:\ni)\tperform the actions specified in clause 6.6.3.1.5;\nii)\tsend the SIP UPDATE request generated in clause 6.6.3.1.5 towards the initiator of the SIP INVITE request according to 3GPP TS 24.229 [3]; and\niii)\tupon receiving a SIP 200 (OK) response to the SIP UPDATE request sent in clause 6.6.3.1.5, proceed with the rest of the steps.\nNOTE 3:\tVerify that the Resource-Priority header is included and properly populated for both ongoing and newly- entered in-progress emergency states of the specified group.\nb)\tif the in-progress emergency state of the group is set to a value of \"true\" and the MCPTT user is indicating a new emergency indication:\ni)\tfor each of the other affiliated MCPTT members of the group generate a SIP MESSAGE request notification of the MCPTT user's emergency indication as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function, with the following clarifications:\nA)\tset the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"true\";\nB)\tif the received SIP INVITE contains an alert indication set to a value of \"true\" and this is an authorised request for an MCPTT emergency alert meeting the conditions specified in clause 6.6.3.1.8.1, perform the procedures specified in clause 6.6.3.1.7; and\nC)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [3];\nii)\tcache the information that the MCPTT user has initiated an MCPTT emergency call; and\niii)\tif the SIP INVITE request contains an authorised request for an MCPTT emergency alert as determined in step i) B) above, cache the information that the MCPTT user has initiated an MCPTT emergency alert; and\nc)\tif the in-progress emergency state of the group is set to a value of \"false\":\ni)\tshall set the value of the in-progress emergency state of the group to \"true\";\nii)\tshall start timer TNG2 (in-progress emergency group call timer) and handle its expiry as specified in clause 6.6.3.1.10;\niii)\tshall generate SIP re-INVITE requests for the MCPTT emergency group call to the other MCPTT affiliated and joined participants of the MCPTT chat group as specified in clause 6.6.3.1.3;\niv)\tshall generate SIP INVITE requests for the MCPTT emergency group call to the affiliated but not joined MCPTT members of the MCPTT chat group as specified in clause 6.6.3.1.4;\nA)\tfor each affiliated but not joined MCPTT member shall send the SIP INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nB)\tupon receiving a SIP 200 (OK) response to the SIP INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31];\nv)\tshall cache the information that the MCPTT user has initiated an MCPTT emergency call; and\nvi)\tif the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body is set to \"true\" and is an authorised request for an MCPTT emergency alert as specified in clause 6.6.3.1.8.1, shall cache the information that the MCPTT user has initiated an MCPTT emergency alert; and\nvii)\tif the in-progress imminent peril state of the group is set to a value of \"true\", shall set it to a value of \"false\";\n14)\tif the in-progress emergency state of the group is set to a value of \"false\" and if the SIP INVITE request contains an imminent peril indication set to a value of \"true\" or the in-progress imminent peril state of the group is set to \"true\", the IWF performing the controlling role shall:\na)\tvalidate that the SIP INVITE request includes a Resource-Priority header field populated with the values for an MCPTT imminent peril group call as specified in clause 6.6.3.1.12, and if not:\ni)\tperform the actions specified in clause 6.6.3.1.5;\nii)\tsend the SIP UPDATE request generated in clause 6.6.3.1.5 towards the initiator of the SIP INVITE request according to 3GPP TS 24.229 [3]; and\niii)\tupon receiving a SIP 200 (OK) response to the SIP UPDATE request sent in clause 6.6.3.1.5 proceed with the rest of the steps.\nNOTE 4:\tVerify that the Resource-Priority header is included and properly populated for both ongoing and newly- entered in-progress imminent peril states of the specified group.\nb)\tif the in-progress imminent peril state of the group is set to a value of \"true\" and the MCPTT user is indicating a new imminent peril indication:\ni)\tfor each of the other affiliated MCPTT member of the group generate a SIP MESSAGE request notification of the MCPTT user's imminent peril indication as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function, with the following clarifications;\nA)\tset the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"true\"; and\nB)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [3]; and\nii)\tcache the information that the MCPTT user has initiated an MCPTT imminent peril call; and\nc)\tif the in-progress imminent peril state of the group is set to a value of \"false\":\ni)\tshall set the value of the in-progress imminent peril state of the group to \"true\";\nii)\tshall generate SIP re-INVITE requests for the MCPTT imminent peril group call to the other MCPTT affiliated and joined participants of the MCPTT chat group as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.15, with the IWF acting as the controlling MCPTT function;\niii)\tshall generate SIP INVITE requests for the MCPTT imminent peril call to the affiliated but not joined MCPTT members of the MCPTT chat group as specified in clause 6.6.3.1.4;\nA)\tfor each affiliated but not joined MCPTT member shall send the SIP INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nB)\tUpon receiving a SIP 200 (OK) response to the SIP INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\niv)\tshall cache the information that the MCPTT user has initiated an MCPTT imminent peril call;\n15)\tshall accept the SIP request and generate a SIP 200 (OK) response to the SIP INVITE request according to 3GPP TS 24.229 [3];\n16)\tshall include in the SIP 200 (OK) response an SDP answer according to 3GPP TS 24.229 [3] with the clarifications specified in 3GPP TS 24.379 [29], clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function, unless the procedures of clause 6.6.3.1.5 were performed in step 13)a) or step 14)a) above;\n17)\tshould include the Session-Expires header field and start supervising the SIP session according to IETF RFC 4028 [6]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n18)\tshall include the \"timer\" option tag in a Require header field;\n19)\tshall include the following in a Contact header field:\na)\tthe g.3gpp.mcptt media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\";\nc)\tthe MCPTT session identity; and\nd)\tthe media feature tag isfocus;\n20)\tshall include the \"tdialog\" option tag in a Supported header field according to IETF RFC 4538 [13];\n21)\tif the SIP INVITE request contains an alert indication set to a value of \"true\" and this is an unauthorised request for an MCPTT emergency alert as specified in clause 6.6.3.1.8.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function;\n22)\tif the received SIP INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\" and if the in-progress emergency state of the group is set to a value of \"true\", shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function;\nNOTE 5:\tIn this case, the request was for an imminent peril call but a higher priority MCPTT emergency call was already in progress on the group. Hence, the imminent peril call request aspect of the request is denied but the request is granted with emergency level priority.\n23)\tshall interact with media plane as specified in 3GPP TS 29.380 [31];\n24)\tshall send the SIP 200 (OK) response to the MCPTT client according to 3GPP TS 24.229 [3]; and\n25)\tif the chat group session was already ongoing and if at least one of the MCPTT participants has subscribed to the conference event package, shall send a SIP NOTIFY request to all MCPTT participants with a subscription to the conference event package as specified in 3GPP TS 24.379 [29], clause 10.1.3.4.2 with the IWF acting as the controlling MCPTT function.\nUpon receiving a SIP ACK to the SIP 200 (OK) response sent towards the inviting MCPTT client, and the SIP 200 (OK) response was sent with the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in clause 4.4, the IWF performing the controlling role shall follow the procedures in clause 6.6.3.1.11.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_24.379_clause_6.3.3.1.17",
        "ts_24.379_clause_6.3.5.2",
        "ts_24.379_clause_6.3.6",
        "clause_9.2.1.3.6",
        "ts_24.379_clause_4.4",
        "clause_6.6.3.1.8.2",
        "clause_6.6.3.1.9",
        "clause_6.6.3.1.8.6",
        "clause_6.6.3.5",
        "clause_10.1.4.4.3",
        "clause_9.2.1.3.7",
        "clause_6.6.3.1.12",
        "clause_6.6.3.1.5",
        "ts_24.379_clause_6.3.3.1.11",
        "clause_6.6.3.1.8.1",
        "clause_6.6.3.1.7",
        "clause_6.6.3.1.10",
        "clause_6.6.3.1.3",
        "clause_6.6.3.1.4",
        "ts_24.379_clause_6.3.3.1.15",
        "ts_24.379_clause_6.3.3.2.1",
        "ts_24.379_clause_10.1.3.4.2",
        "clause_4.4",
        "clause_6.6.3.1.11",
        "ts_24.379",
        "ts_24.229",
        "ts_24.481",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.3.1.2",
      "section_id": "10.2.3.1.2",
      "section_title": "Receipt of a SIP re-INVITE request",
      "content": "In the procedures in this clause:\n1)\temergency indication in an incoming SIP re-INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n2)\timminent peril indication in an incoming SIP re-INVITE request refers to the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nUpon receipt of a SIP re-INVITE request for an MCPTT session identity identifying a MCPTT chat group session, the IWF performing the controlling role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP re-INVITE request with a SIP 500 (Server Internal Error) response. The IWF performing the controlling role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [14] and skip the rest of the steps;\nNOTE 1:\tif the SIP re-INVITE request contains an emergency indication or an imminent peril indication set to a value of \"true\" and this is an authorised request for originating an MCPTT emergency group call as determined by clause 6.6.3.1.8.2, or for originating an MCPTT imminent peril group call as determined by clause 6.6.3.1.8.5, the IWF performing the controlling role can according to local policy choose to accept the request.\n2)\tif the received SIP re-INVITE request includes an application/vnd.3gpp.mcptt-info+xml MIME body with an <emergency-ind> element included or an <imminentperil-ind> element included, shall validate the request as described in 3GPP TS 24.379 [29], clause 6.3.3.1.17, with the IWF acting as the controlling MCPTT function;\n3)\tif the SIP re-INVITE request contains an unauthorised request for an MCPTT emergency call as determined by clause 6.6.3.1.8.2:\na)\tshall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response as specified in clause 6.6.3.1.9; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n4)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <emergency-ind> element set to a value of \"true\" and is an authorised request to initiate an MCPTT emergency group call as determined by clause 6.6.3.1.8.2, the IWF performing the controlling role shall:\na)\tvalidate that the SIP re-INVITE request includes a Resource-Priority header field is populated correctly for an MCPTT emergency group call as specified in clause 6.6.3.1.12, and if not:\ni)\tshall perform the actions specified in clause 6.6.3.1.5; and\nii)\tupon receiving a SIP 200 (OK) response to the SIP UPDATE request sent in clause 6.6.3.1.5 shall proceed with the rest of the steps.\nNOTE 2:\tVerify that the Resource-Priority header is included and properly populated for both ongoing and newly-entered in-progress emergency states of the specified group.\nb)\tif the in-progress emergency state of the group is set to a value of \"true\" and the MCPTT user is indicating a new emergency indication:\ni)\tshall cache the MCPTT ID of the MCPTT user that has initiated an MCPTT emergency call;\nii)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"true\" and is an authorised request for an MCPTT emergency alert as determined by clause 6.6.3.1.8.1, shall cache the MCPTT ID of the MCPTT user that has initiated an MCPTT emergency alert; and\niii)\tfor each of the other affiliated members of the group, generate a SIP MESSAGE request notification of the MCPTT user's emergency indication as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function, with the following clarifications:\nA)\tset the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"true\";\nB)\tif the received SIP re-INVITE contains an alert indication set to a value of \"true\" and this is an authorised request for an MCPTT emergency alert meeting the conditions specified in clause 6.6.3.1.8.1, perform the procedures specified in clause 6.6.3.1.7; and\nC)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [3]; and\nc)\tif the in-progress emergency state of the group is set to a value of \"false\":\ni)\tshall set the value of the in-progress emergency state of the group to \"true\";\nii)\tshall cache the MCPTT ID of the MCPTT user that has initiated an MCPTT emergency call;\niii)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"true\" and this is an authorised request for an MCPTT emergency alert as specified in clause 6.6.3.1.8.1, shall cache the MCPTT ID of the MCPTT user that has initiated an MCPTT emergency alert;\niv)\tshall start timer TNG2 (in-progress emergency group call timer) and handle its expiry as specified in clause 6.6.3.1.10;\nv)\tshall generate SIP re-INVITE requests for the MCPTT emergency group call to the other affiliated and joined participants of the MCPTT chat group as specified in clause 6.6.3.1.3. The IWF performing the controlling role:\nA)\tfor each affiliated and joined member shall send the SIP re-INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nB)\tUpon receiving a SIP 200 (OK) response to the SIP re-INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\nvi)\tshall generate SIP INVITE requests for the MCPTT emergency group call to the affiliated but not joined MCPTT members of the MCPTT chat group as specified in clause 6.6.3.1.4. The IWF performing the controlling role:\nA)\tfor each affiliated but not joined MCPTT member shall send the SIP INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nB)\tUpon receiving a SIP 200 (OK) response to the SIP INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\nvii)\tif the in-progress imminent peril state of the group is set to a value of \"true\", shall set it to a value of \"false\";\n5)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <emergency-ind> element set to a value of \"false\" and is an unauthorised request for an MCPTT emergency group call cancellation as determined by clause 6.6.3.1.8.4:\na)\tshall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response;\nb)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 with an <emergency-ind> element set to a value of \"true\";\nc)\tif an <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body is included set to \"false\" and there is an outstanding MCPTT emergency alert for the MCPTT user, shall include in the application/vnd.3gpp.mcptt-info+xml MIME body and <alert-ind> element set to a value of \"true\"; and\nd)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n6)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <emergency-ind> element set to a value of \"false\" and is determined to be an authorised request for an MCPTT emergency call cancellation as specified in clause 6.6.3.1.8.4 and the in-progress emergency state of the group to is set to a value of \"true\" the IWF performing the controlling role shall:\na)\tvalidate that the SIP re-INVITE request includes a Resource-Priority header field is populated correctly for a normal priority MCPTT group call as specified in clause 6.6.3.1.12, and if not:\ni)\tshall perform the actions specified in clause 6.6.3.1.5; and\nii)\tupon receiving a SIP 200 (OK) response to the SIP UPDATE request sent in clause 6.6.3.1.5 shall proceed with the rest of the steps;\nNOTE 3:\tVerify that the Resource-Priority header is included and properly populated for an in-progress emergency state cancellation of the specified group.\nb)\tset the in-progress emergency group state of the group to a value of \"false\";\nc)\tclear the cache of the MCPTT ID of the MCPTT user identified by the <originated-by> element as having an outstanding MCPTT emergency group call;\nd)\tif an <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body is included and set to \"false\" and is determined to be an authorised request for an MCPTT emergency alert cancellation as specified in clause 6.6.3.1.8.3 and there is an outstanding MCPTT emergency alert for the MCPTT user shall:\ni)\tif the received SIP re-INVITE request contains an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, clear the cache of the MCPTT ID of the MCPTT user identified by the <originated-by> element as having an outstanding MCPTT emergency alert; and\nii)\tif the received SIP re-INVITE request does not contain an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, clear the cache of the MCPTT ID of the sender of the SIP re-INVITE request as having an outstanding MCPTT emergency alert;\ne)\tgenerate SIP re-INVITE requests to the other affiliated and joined members of the MCPTT group as specified in clause 6.6.3.1.3. The IWF performing the controlling role:\ni)\tfor each affiliated and joined member shall send the SIP re-INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nii)\tUpon receiving a SIP 200 (OK) response to the SIP re-INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\nNOTE 4:\tClause 6.6.3.1.3 will inform the affiliated and joined members of the cancellation of the MCPTT group's in-progress emergency state and the cancellation of the MCPTT emergency alert if applicable.\nf)\tfor each of the affiliated but not joined members of the group shall:\ni)\tgenerate a SIP MESSAGE request notification of the cancellation of the MCPTT user's emergency call as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function;\nii)\tset the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"false\";\niii)\tif indicated above in step d), set the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"false\"; and\niv)\tsend the SIP MESSAGE request according to 3GPP TS 24.229 [3];\n7)\tif a Resource-Priority header field is included in the SIP re-INVITE request:\na)\tif the Resource-Priority header field is set to the value indicated for emergency calls and the received SIP re-INVITE request does not contain an authorised request for an MCPTT emergency call as determined in step 4) above and the in-progress emergency state of the group is set to a value of \"false\", shall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response and skip the remaining steps; or\nb)\tif the Resource-Priority header field is set to the value indicated for imminent peril calls and the received SIP re-INVITE request does not contain an authorised request for an MCPTT imminent peril call as determined by the procedures of clause 6.6.3.1.8.5 and the in-progress imminent peril state of the group is set to a value of \"false\", shall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response and skip the remaining steps;\n8)\tif the received SIP re-INVITE request contains an imminent peril indication, shall perform the procedures specified in clause 10.2.3.1.3 and skip the rest of the steps;\n9)\tshall include in the SIP 200 (OK) response an SDP answer according to 3GPP TS 24.229 [3] with the clarifications specified in 3GPP TS 24.379 [29], clause 6.3.3.2.1, with the IWF acting as the controlling MCPTT function, unless the procedures of clause 6.6.3.1.5 were performed in step 6) a) i) above;\n10)\tshall include the \"tdialog\" option tag in a Supported header field according to IETF RFC 4538 [13];\n11)\tif the received SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"true\" and if this is an unauthorised request for an MCPTT emergency alert as determined by clause 6.6.3.1.8.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function;\n12)\tif the received SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"false\" and if this is an unauthorised request for an MCPTT emergency alert cancellation as determined by clause 6.6.3.1.8.3, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function;\n13)\tif the received SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"true\", this is an authorised request for an MCPTT imminent peril group call and if the in-progress emergency state of the group is set to a value of \"true\", shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function;\nNOTE 5:\tIn this case, the request was for an imminent peril call but a higher priority MCPTT emergency call was already in progress on the group. Hence, the imminent peril call request aspect of the request is denied but the request is granted with emergency level priority.\n14)\tshall interact with media plane as specified in 3GPP TS 29.380 [31]; and\n15)\tshall send the SIP 200 (OK) response towards the MCPTT client according to 3GPP TS 24.229 [3].\nUpon receiving a SIP ACK to the SIP 200 (OK) response sent towards the inviting MCPTT client, and the SIP 200 (OK) response was sent with the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling MCPTT function, the IWF performing the controlling role shall follow the procedures in clause 6.6.3.1.11.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.6.3.1.8.2",
        "clause_6.6.3.1.8.5",
        "ts_24.379_clause_6.3.3.1.17",
        "clause_6.6.3.1.9",
        "clause_6.6.3.1.12",
        "clause_6.6.3.1.5",
        "clause_6.6.3.1.8.1",
        "ts_24.379_clause_6.3.3.1.11",
        "clause_6.6.3.1.7",
        "clause_6.6.3.1.10",
        "clause_6.6.3.1.3",
        "clause_6.6.3.1.4",
        "clause_6.6.3.1.8.4",
        "clause_6.6.3.1.8.3",
        "ts_29.380_clause_6.6.3.1.3",
        "clause_10.2.3.1.3",
        "ts_24.379_clause_6.3.3.2.1",
        "ts_24.379_clause_4.4",
        "clause_6.6.3.1.11",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.3.1.3",
      "section_id": "10.2.3.1.3",
      "section_title": "Handling of a SIP re-INVITE request for imminent peril session",
      "content": "In the procedures in this clause:\n1)\timminent peril indication in an incoming SIP INVITE request refers to the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nWhen the IWF performing the controlling role receives a SIP re-INVITE request with and imminent peril indication, the IWF performing the controlling role:\n1)\tif the SIP re-INVITE request contains an unauthorised request for an MCPTT imminent peril group call as determined by clause 6.6.3.1.8.5, shall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response with the following clarifications:\na)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"false\"; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n2)\tif the in-progress emergency group state of the group is set to a value of \"false\" and if the SIP re-INVITE request contains an imminent peril indication set to a value of \"true\" or the in-progress imminent peril state of the group to \"true\", the IWF performing the controlling role shall:\na)\tvalidate that the SIP re-INVITE request includes a Resource-Priority header field with the namespace set to the MCPTT-specific namespace specified in IETF RFC 8101 [23] and the priority set to the priority designated for imminent peril calls and if not:\ni)\tperform the actions specified in clause 6.6.3.1.5;\nii)\tsend the SIP UPDATE request generated in clause 6.6.3.1.5 towards the initiator of the SIP re-INVITE request according to 3GPP TS 24.229 [3]; and\niii)\tupon receiving a SIP 200 (OK) response to the SIP UPDATE request sent in clause 6.6.3.1.5 proceed with the rest of the steps.\nNOTE 1:\tVerify that the Resource-Priority header is included and properly populated for both ongoing and newly- entered in-progress imminent peril states of the specified group.\nb)\tif the in-progress imminent peril state of the group is set to a value of \"true\" and the MCPTT user is indicating a new imminent peril indication:\ni)\tfor each of the other affiliated member of the group generate a SIP MESSAGE request notification of the MCPTT user's imminent peril indication as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling function, with the following clarifications;\nA)\tset the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"true\"; and\nB)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [3]; and\nii)\tcache the information that the MCPTT user has initiated an MCPTT imminent peril call; and\nc)\tif the in-progress imminent peril state of the group is set to a value of \"false\":\ni)\tshall set the value of the in-progress imminent peril state of the group to \"true\";\nii)\tshall generate SIP re-INVITE requests for the MCPTT imminent peril group call to the other affiliated and joined participants of the MCPTT chat group as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.15, with the IWF acting as the controlling MCPTT function;\niii)\tshall generate SIP INVITE requests for the MCPTT imminent peril group call to the affiliated but not joined members of the MCPTT chat group as specified in clause 6.6.3.1.4;\nA)\tfor each affiliated but not joined member shall send the SIP INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nB)\tUpon receiving a SIP 200 (OK) response to the SIP INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\niv)\tshall cache the information that the MCPTT user has initiated an MCPTT imminent peril call;\n3)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"false\" and is an unauthorised request for an MCPTT imminent peril group call cancellation as determined by clause 6.6.3.1.8.6 shall:\na)\treject the SIP re-INVITE request with a SIP 403 (Forbidden) response to the SIP re-INVITE request; and\nb)\tinclude in the SIP 403 (Forbidden) response:\ni)\tinclude in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 with the <mcpttinfo> element containing the <mcptt-Params> element with the <imminentperil-ind> element set to a value of \"false\";\nii)\tsend the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3]; and\niii)\tskip the rest of the steps;\n4)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <imminentperil-ind> element set to a value of \"false\" and is determined to be an authorised request for an MCPTT imminent peril call cancellation as specified in clause 6.6.3.1.8.6 and the in-progress imminent peril state of the group to is set to a value of \"true\" the IWF performing the controlling role shall:\na)\tvalidate that the SIP re-INVITE request includes a Resource-Priority header field with the namespace set to the MCPTT-specific namespace specified in IETF RFC 8101 [23], and the priority set to the priority level designated for a normal priority MCPTT group call, and if not:\ni)\tperform the actions specified in clause 6.6.3.1.5; and\nii)\tupon receiving a SIP 200 (OK) response to the SIP UPDATE request sent in clause 6.6.3.1.5, proceed with the rest of the steps;\nNOTE 2:\tverify that the Resource-Priority header is included and properly populated for an in-progress emergency group state cancellation of the specified group.\nb)\tset the in-progress imminent peril state of the group to a value of \"false\";\nc)\tcache the information that the MCPTT user no longer has an outstanding MCPTT imminent peril group call;\nd)\tgenerate SIP re-INVITES requests to the other affiliated and joined members of the MCPTT group as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.15, with the IWF acting as the controlling MCPTT function. The IWF performing the controlling role:\ni)\tfor each affiliated and joined member shall send the SIP re-INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nii)\tUpon receiving a SIP 200 (OK) response to the SIP re-INVITE request the IWF performing the controlling role shall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\nNOTE 3:\t3GPP TS 24.379 [29], clause 6.3.3.1.15, with the IWF acting as the controlling MCPTT function, will inform the affiliated and joined members of the cancellation of the MCPTT group's in-progress emergency group state and the cancellation of the MCPTT emergency alert if applicable.\ne)\tfor each of the affiliated but not joined MCPTT members of the group:\ni)\tgenerate a SIP MESSAGE request notification of the cancellation of the MCPTT user's imminent peril call as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function;\nii)\tset the <imminentperil-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"false\"; and\niii)\tsend the SIP MESSAGE request according to 3GPP TS 24.229 [3];\n5)\tinclude in the SIP 200 (OK) response an SDP answer according to 3GPP TS 24.229 [3] with the clarifications specified in 3GPP TS 24.379 [29], clause 6.3.3.2.1 unless the procedures of clause 6.6.3.1.5 were performed in step 2) or 4) above;\n6)\tinclude the \"norefersub\" option tag in a Supported header field according to IETF RFC 4488 [12];\n7)\tinclude the \"tdialog\" option tag in a Supported header field according to IETF RFC 4538 [13];\n8)\tinteract with media plane as specified in 3GPP TS 29.380 [31]; and\n9)\tsend the SIP 200 (OK) response towards the MCPTT client according to 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.6.3.1.8.5",
        "clause_6.6.3.1.5",
        "ts_24.379_clause_6.3.3.1.11",
        "ts_24.379_clause_6.3.3.1.15",
        "clause_6.6.3.1.4",
        "clause_6.6.3.1.8.6",
        "ts_29.380_clause_6.3.3.1.15",
        "ts_24.379_clause_6.3.3.2.1",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.3.2",
      "section_id": "10.2.3.2",
      "section_title": "End group call at the terminating IWF performing the controlling role",
      "content": "Upon receiving a SIP BYE request the IWF performing the controlling role shall follow the procedures as specified in clause 6.6.3.2.1.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.3.2.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.3.3.1",
      "section_id": "10.2.3.3.1",
      "section_title": "General",
      "content": "This clause describes the procedures of each functional entity for ending the group call initiated by the IWF performing the controlling role.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_10.2.3.3.2",
      "section_id": "10.2.3.3.2",
      "section_title": "SIP BYE request for releasing MCPTT session for a group call",
      "content": "When the MCPTT session for group call needs to be released as specified in clause 6.6.7.1, the IWF performing the controlling role shall follow the procedures in clause 6.6.3.1.2.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.7.1",
        "clause_6.6.3.1.2"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.3.3.3",
      "section_id": "10.2.3.3.3",
      "section_title": "SIP BYE request towards a MCPTT client",
      "content": "When an MCPTT client needs to be removed from the MCPTT session (e.g. due to de-affiliation or admitting a higher priority user), the IWF performing the controlling role shall follow the procedures in clause 6.6.3.1.2.\nAfter successfully removing the MCPTT client from the MCPTT session, the IWF performing the controlling role may generate a notification to the MCPTT clients, which have subscribed to the conference event package that an MCPTT user has been removed from the MCPTT session, as specified in clause 6.6.3.4 and send the SIP NOTIFY request to the MCPTT client according to 3GPP TS 24.229 [3].",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.3.1.2",
        "clause_6.6.3.4",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.3.3.4",
      "section_id": "10.2.3.3.4",
      "section_title": "Removal of participant homed in the IWF",
      "content": "After successfully removing a participant homed in the IWF from the MCPTT session, the IWF performing the controlling role may generate a notification to any MCPTT clients in the session, which have subscribed to the conference event package that a user has been removed from the MCPTT session, as specified in clause 6.6.3.4 and send the SIP NOTIFY request to the MCPTT client according to 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.6.3.4",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.2.4",
      "section_id": "10.2.4",
      "section_title": "Non-controlling role procedures",
      "content": "Editor's note:\tContent to be added.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_10.3.1",
      "section_id": "10.3.1",
      "section_title": "General",
      "content": "The IETF RFC 4575 [15] defines a conference event package that shall be used to obtain the status of participants in group sessions.\nThe IWF performing the participating role can send conference state subscriptions and receive notifications as specified in clause 10.3.2.\nThe IWF performing the controlling role can handle subscriptions and notification of conference events as specified in clause 10.3.3.\nThe IWF performing the non-controlling role can handle subscriptions and notification of conference events as specified in clause 10.3.4.\nWhen the non-controlling function connection model is used, the IWF performing the controlling role subscribes to the conference event package from the non-controlling MCPTT function as specified in clause 10.3.3.3.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_10.3.2",
        "clause_10.3.3",
        "clause_10.3.4",
        "clause_10.3.3.3"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.3.2",
      "section_id": "10.3.2",
      "section_title": "IWF performing the participating role",
      "content": "When the IWF performing the participating role decides to subscribe to the conference event package, the IWF:\n1)\tshall generate a SUBSCRIBE request as specified in 3GPP TS 24.229 [3];\n2)\tshall set the SIP URI in the Request-URI with the MCPTT session identity that is mapped to the MCPTT group session;\n3)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body the <mcptt-calling-user-id> element set to the MCPTT ID of the IWF:\n4)\tshall insert a Record-Route header containing a URI identifying its own address; and\n5)\tshall send the SIP SUBSCRIBE request according to 3GPP TS 24.229 [3].\nUpon receiving a SIP response to the SIP SUBSCRIBE request the IWF performing the participating role can store the information.\nUpon receiving a SIP NOTIFY request within the dialog created by the SIP SUBSCRIBE request, the IWF performing the participating role:\n1)\tshall create an outgoing SIP 200 (OK) response;\n2)\tshall include the MCPTT group session identity in the outgoing SIP response; and\n3)\tshall forward the SIP response according to 3GPP TS 24.229 [3].\nThe IWF performing the participating role can use of the information provided by the conference event package is outside the scope of the present document.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.3.3.1",
      "section_id": "10.3.3.1",
      "section_title": "Receiving a subscription to the conference event package",
      "content": "Upon receipt of a SIP SUBSCRIBE request for event package subscription, if the IWF performing the controlling role does not support the conference event package, the IWF performing the controlling role:\n1)\tshall reject the \"SIP SUBSCRIBE request for event status subscription in the controlling MCPTT function\" with a SIP 403 (Forbidden) response to the SIP SUBSCRIBE request, with warning text set to \"138 subscription of conference events not allowed\" as specified in clause 4.2; and\n2)\tshall not continue with the remaining steps.\nIf the SIP SUBSCRIBE request:\n1)\tcontains an application/vnd.3gpp.mcptt-info+xml MIME body with\na)\tthe <mcptt-request-uri> element set to the group identity of the group session and the <mcptt-calling-user-id> element set to either:\ni)\tthe MCPTT ID of a participant in the group session; or\nii)\ta constituent MCPTT group ID of a non-controlling MCPTT function in a temporary group session;\n2)\tcontains the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service header field according to IETF RFC 6050 [7];\n3)\tcontains an Accept header field containing the application/conference-info+xml MIME type; and\n4)\tis not received in a group call initiated as a broadcast group call;\nthen the IWF performing the controlling role:\n1)\tshall determine if the MCPTT ID or the constituent MCPTT group ID in the <mcptt-calling-user-id> element is allowed to subscribe to the conference event package and if not allowed:\na)\tshall reject the \"SIP SUBSCRIBE request for event status subscription in the controlling MCPTT function\" with a SIP 403 (Forbidden) response to the SIP SUBSCRIBE request, with warning text set to \"138 subscription of conference events not allowed\" as specified in clause 4.2; and\nb)\tshall not continue with the remaining steps;\n2)\tshall handle the request according to IETF RFC 6665 [25] and IETF RFC 4575 [15];\n3)\tshall cache information about the subscription;\n4)\tshall send a conference state notification as specified in clause 10.3.4.2; and\n5)\tif the SIP SUBSCRIBE request is the first SUBSCRIBE request from a participant in a temporary group session, shall subscribe to the conference event package from all non-controlling MCPTT functions in the group session as specified in clause 10.3.4.3.\nUpon receipt of a SIP SUBSCRIBE request for event package subscription in the IWF performing the controlling role in a group call initiated as a broadcast group call, the IWF performing the controlling role:\n1)\tshall generate a SIP 480 (Temporarily Unavailable) response to the SIP SUBSCRIBE request as specified in 3GPP TS 24.229 [3];\n2)\tshall include a Warning header field with the warning text set to \"105 subscription not allowed in a broadcast group call\" as specified in clause 4.2; and\n3)\tsend the SIP 480 (Temporarily Unavailable) response according to 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "clause_4.2",
        "clause_10.3.4.2",
        "clause_10.3.4.3",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.3.3.2",
      "section_id": "10.3.3.2",
      "section_title": "Sending notifications to the conference event package",
      "content": "The procedures in this clause is triggered by:\n1)\tthe receipt of a SIP SUBSCRIBE request as specified in clause 10.3.4.1;\n2)\tthe receipt of a SIP BYE request from one of the participants in a pre-arranged or a chat group session; or\n3)\twhen a new participant is added in a pre-arranged or chat group session.\nWhen sending a conference event notification, the IWF performing the controlling role:\n1)\tshall generate a notification package as specified in clause 6.6.3.4 to all MCPTT clients which have subscribed to the conference event package; and\nNOTE:\tAs a group document can potentially have a large content, the IWF performing the controlling role can notify using content-indirection as defined in IETF RFC 4483 [17].\n2)\tshall send a SIP NOTIFY request to all MCPTT participants which have subscribed to the conference event package as specified in 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "clause_10.3.4.1",
        "clause_6.6.3.4",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.3.3.3",
      "section_id": "10.3.3.3",
      "section_title": "Sending subscriptions to the conference event package",
      "content": "The procedure in this clause is triggered by:\n1)\tthe receipt of a SIP 200 (OK) response to a SIP INVITE request for non-controlling MCPTT function of an MCPTT group and if at least one participant already has subscribed to the conference event package in the IWF performing the controlling role as specified in clause 10.3.4.1; or\n2)\tthe receipt of the first SIP SUBSCRIBE request as specified in clause 10.3.4.1 and one or more participants in the group session is a non-controlling MCPTT function;\nthen, for each non-controlling MCPTT function from where a SIP 200 (OK) response to a SIP INVITE request for non-controlling MCPTT function of an MCPTT group has been received and where a SIP SUBSCRIBE request is not already sent, the IWF performing the controlling role:\n1)\tshall generate a SIP SUBSCRIBE request and use a new SIP-dialog according to IETF RFC 6665 [25], IETF RFC 4575 [15] and 3GPP TS 24.229 [3];\n2)\tshall set the Request-URI of the SIP SUBSCRIBE request to the public service identity of the non-controlling MCPTT function serving the group identity of the MCPTT group owned by the partner MCPTT system;\n3)\tshall include the same P-Asserted-Identity header field as included in the SIP INVITE request for non-controlling MCPTT function of an MCPTT group;\n4)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Preferred-Service header field according to IETF RFC 6050 [7];\n5)\tshall include an Accept-Contact header with the g.3gpp.mcptt along with \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [7];\n6)\tshall set the Expires header field according to IETF RFC 6665 [25], to 4294967295;\nNOTE 1:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [14].\n7)\tshall include an Accept header field containing the application/conference-info+xml MIME type;\n8)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body with:\na)\tthe <mcptt-request-uri> element set to the constituent MCPTT group ID; and\nb)\tthe <mcptt-calling-group-id> set to the temporary MCPTT group ID; and\n9)\tshall send the SIP SUBSCRIBE request using a new SIP dialog according to 3GPP TS 24.229 [3].\nThe responses to the SIP SUBSCRIBE request shall be handled according to IETF RFC 6665 [25], IETF RFC 4575 [15] and 3GPP TS 24.229 [3].\nUpon receiving an incoming SIP NOTIFY requests to the previously sent SIP SUBSCRIBE request, the IWF performing the controlling role:\n1)\tshall handle the request according to IETF RFC 6665 [25] and IETF RFC 4575 [15];\n2)\tshall modify the SIP NOTIFY request as specified in clause 6.6.3.4; and\n3)\tshall forward the modified SIP NOTIFY request according to 3GPP TS 24.229 [3] to all other participants with a subscription to the conference event package.\nNOTE 2:\tA non-controlling MCPTT function of an MCPTT group is regarded as a participant in a temporary group session.",
      "chunk_type": "general",
      "cross_references": [
        "clause_10.3.4.1",
        "clause_6.6.3.4",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.3.3.4",
      "section_id": "10.3.3.4",
      "section_title": "Terminating a subscription",
      "content": "Upon receipt of a SIP SUBSCRIBE request for event status subscription in the IWF performing the controlling role that terminates the subscription of the conference event package as specified in IETF RFC 6665 [25], the IWF performing the controlling role:\n1)\tshall send a SIP 200 (OK) response as specified in IETF RFC 6665 [25]; and\n2)\tif there are no remaining subscriptions to the event package in the ongoing call in a temporary group session, shall terminate the subscriptions to the conference event package as specified in IETF RFC 6665 [25] in all non-controlling MCPTT functions in the temporary group session.\nUpon expiry of the subscription timer and if there are no remaining subscriptions to the event package in the ongoing call in a temporary group session, the IWF performing the controlling role shall terminate the subscriptions to the conference event package as specified in IETF RFC 6665 [25] in all non-controlling MCPTT functions in the temporary group session.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_10.3.4",
      "section_id": "10.3.4",
      "section_title": "IWF performing the non-controlling role",
      "content": "Editor's Note:\tActions by the IWF performing the non-controlling role are FFS and need to be considered after the other clauses of TS 29.379 dealing with the IWF performing the non-controlling role become stable.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_10.4.1.1.1",
      "section_id": "10.4.1.1.1",
      "section_title": "Originating procedures",
      "content": "Originating procedures are not supported in this version of the specification.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_10.4.1.1.2",
      "section_id": "10.4.1.1.2",
      "section_title": "Terminating procedures",
      "content": "Upon receiving a \"SIP MESSAGE request for remotely initiated group call for terminating participating function\" the IWF performing the participating role shall reject the SIP MESSAGE request with a SIP 501 (Not Implemented) response.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_10.4.1.2",
      "section_id": "10.4.1.2",
      "section_title": "IWF performing the controlling role",
      "content": "Upon receiving:\n-\ta \"SIP MESSAGE request for remotely initiated group call request for controlling MCPTT function\"; or\n-\ta \"SIP MESSAGE request for remotely initiated group call response for controlling MCPTT function\";\nthe IWF performing the controlling role shall reject the SIP MESSAGE request with a SIP 501 (Not Implemented) response.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_11.1.1.1.1",
      "section_id": "11.1.1.1.1",
      "section_title": "Originating procedures",
      "content": "This clause is referenced from other procedures.\nTo establish an MCPTT private call the IWF performing the participating role shall generate an initial SIP INVITE request by following the UE originating session procedures specified in 3GPP TS 24.229 [3], with the clarifications given below.\nThe IWF performing the participating role:\n1)\tif originating an MCPTT emergency private call or originating an MCPTT private call and the MCPTT emergency state is already set, the IWF performing the participating role, shall comply with the procedures in clause 6.4.2.1;\n2)\tshall include the g.3gpp.mcptt media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" in the Contact header field of the SIP INVITE request according to IETF RFC 3840 [9];\n3)\tshall include an Accept-Contact header field containing the g.3gpp.mcptt media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [5];\n4)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref contain with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [5];\n5)\tfor the establishment of a private call shall insert in the SIP INVITE request a MIME resource-lists body with the MCPTT ID of the invited MCPTT user, according to rules and procedures of IETF RFC 5366 [11];\n6)\tif a security context needs to be established between the IWF and the MCPTT client and if the user homed in the IWF is initiating a private call then:\na)\tif necessary, request keying material from the key management server as described in 3GPP TS 33.180 [27];\nb)\tshall use the keying material to generate a PCK as described in 3GPP TS 33.180 [27];\nc)\tshall use the PCK to generate a PCK-ID with the four most significant bits set to \"0000\" to indicate that the purpose of the PCK is to protect private call communications and with the remaining twenty-eight bits being randomly generated as described in 3GPP TS 33.180 [27];\nd)\tshall encrypt the PCK to a UID associated to the MCPTT client using the MCPTT ID and KMS URI of the invited user and a time related parameter as described in 3GPP TS 33.180 [27];\nNOTE 1:\tHow the IWF obtains the KMS URI of the invited user is out of scope of the present document.\ne)\tshall generate a MIKEY-SAKKE I_MESSAGE using the encapsulated PCK and PCK-ID as specified in 3GPP TS 33.180 [27]; and\nf)\tshall add the MCPTT ID of the originating user homed in the IWF to the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [27]; and\ng)\tshall sign the MIKEY-SAKKE I_MESSAGE using the originating user homed in the IWF's signing key provided in the keying material together with a time related parameter, and add this to the MIKEY-SAKKE payload, as described in 3GPP TS 33.180 [27];\n7)\tshall include an SDP offer according to 3GPP TS 24.229 [3] with the clarification given in clause 6.1.1 and with a media stream of the offered media-floor control entity;\n8)\tif implicit floor control is required, shall comply with the conditions specified in clause 6.7;\n9)\tif force of automatic commencement mode at the invited MCPTT client is requested by the user homed in the IWF, shall include in the SIP INVITE request a Priv-Answer-Mode header field with the value \"Auto\" according to the rules and procedures of IETF RFC 5373 [10];\n10)\tif force of automatic commencement mode at the invited MCPTT client is not requested by the user homed in the IWF:\na)\tif automatic commencement mode at the invited MCPTT client is requested by the user homed in the IWF, shall include in the SIP INVITE request an Answer-Mode header field with the value \"Auto\" according to the rules and procedures of IETF RFC 5373 [10]; and\nb)\tif manual commencement mode at the invited MCPTT client is requested by the user homed in the IWF, shall include in the SIP INVITE request an Answer-Mode header field with the value \"Manual\" according to the rules and procedures of IETF RFC 5373 [10]; and\n11)\tshall contain an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <session-type> element set to a value of \"private\"; and\n12)\tif the MCPTT emergency private call state of the user homed in the IWF is set to either \"MEPC 2: emergency-pc-requested\" or \"MEPC 3: emergency-pc-granted\" or the MCPTT emergency private priority state for this private call is set to \"MEPP 2: in-progress\", the IWF shall comply with the procedures in clause 6.4.2.2.\nNOTE 2:\tUpon receiving a SIP 183(Session Progress) response to the SIP INVITE request the IWF performing the participating role's actions are out of scope of the present document.\nUpon receiving a SIP 200 (OK) response to the SIP INVITE request the IWF performing the participating role:\n1)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31];\n2)\tif the MCPTT emergency private call state is set to \"MEPC 2: emergency-pc-requested\" or \"MEPC 3: emergency-pc-granted\", shall perform the actions specified in 3GPP TS 24.379 [29], clause 6.2.8.3.4, with the IWF acting as the MCPTT client on behalf of the IWF user homed in the IWF; and\n3)\tshall consider the call successfully established.\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request:\n1)\tif the MCPTT emergency private call state is set to \"MEPC 2: emergency-pc-requested\"; or\n2)\tif the MCPTT emergency private call state is set to \"MEPC 3: emergency-pc-granted\";\nthe IWF performing the participating role shall perform the actions specified in 3GPP TS 24.379 [29], clause 6.2.8.3.5, with the IWF acting as the MCPTT client on behalf of the IWF user homed in the IWF.\nOn receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing session, the IWF performing the participating role shall follow the actions specified in 3GPP TS 24.379 [29], clause 6.2.8.3.7 with the IWF acting as the MCPTT client on behalf of the IWF user homed in the IWF.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.4.2.1",
        "clause_6.1.1",
        "clause_6.7",
        "clause_6.4.2.2",
        "ts_24.379_clause_6.2.8.3.4",
        "ts_24.379_clause_6.2.8.3.5",
        "ts_24.379_clause_6.2.8.3.7",
        "ts_24.229",
        "ts_33.180",
        "ts_29.380",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.1.1.2",
      "section_id": "11.1.1.1.2",
      "section_title": "IWF terminating procedures",
      "content": "This clause is referenced from other procedures.\nThe IWF performing the participating role:\n1)\tmay reject the SIP INVITE request for any other reason outside the scope of this specification otherwise, continue with the rest of the steps.\n2)\tif the SIP INVITE request is rejected in step 1), shall respond towards the controlling MCPTT function either with appropriate reject code as specified in 3GPP TS 24.229 [3] and warning texts as specified in clause 4.2.2 or with SIP 480 (Temporarily unavailable) response and skip the rest of the steps of this clause;\n3)\tif the SIP INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <emergency-ind> element set to a value of \"true\":\nc)\tshall set the MCPTT emergency private priority state to \"MEPP 2: in-progress\" for this private call;\n4)\tif the SDP offer of the SIP INVITE request contains an \"a=key-mgmt\" attribute field with a \"mikey\" attribute value containing a MIKEY-SAKKE I_MESSAGE:\na)\tshall extract the MCPTT ID of the originating MCPTT from the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [27];\nb)\tshall convert the MCPTT ID to a UID as described in 3GPP TS 33.180 [27];\nc)\tshall use the UID to validate the signature of the MIKEY-SAKKE I_MESSAGE as described in 3GPP TS 33.180 [27];\nd)\tif authentication verification of the MIKEY-SAKKE I_MESSAGE fails, shall reject the SIP INVITE request with a SIP 488 (Not Acceptable Here) response as specified in IETF RFC 4567 [22], and include warning text set to \"136 authentication of the MIKEY-SAKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.4; and\ne)\tif the signature of the MIKEY-SAKKE I_MESSAGE was successfully validated:\ni)\tshall extract and decrypt the encapsulated PCK using the terminating user's (KMS provisioned) UID key as described in 3GPP TS 33.180 [27]; and\nii)\tshall extract the PCK-ID, from the payload as specified in 3GPP TS 33.180 [27];\nNOTE:\tWith the PCK successfully shared between the originating and the terminating parties, the IWF and the MCPTT client are able to use SRTP/SRTCP to create a secure session.\n5)\tshall perform the automatic commencement procedures specified in clause 6.2.1 if one of the following conditions are met:\na)\tSIP INVITE request contains an Answer-Mode header field with the value \"Auto\" and the IWF is configured for automatic commencement mode for the user receiving the call;\nc)\tSIP INVITE request contains a Priv-Answer-Mode header field with the value of \"Auto\" and the IWF is able to process an automatic commencement; and\n6)\tshall perform the manual commencement procedures specified in clause 6.2.2 if either of the following conditions are met:\na)\tSIP INVITE request contains an Answer-Mode header field with the value \"Manual\" and the IWF is configured for manual commencement mode for the user receiving the call;\nb)\tSIP INVITE request contains a Priv-Answer-Mode header field with the value of \"Manual\" and the IWF is able to process a manual commencement.\nUpon receiving the SIP CANCEL request cancelling a SIP INVITE request for which a dialog exists at the IWF performing the participating role and a SIP 200 (OK) response has not yet been sent to the SIP INVITE request then the IWF performing the participating role:\n1)\tshall send a SIP 200 (OK) response to the SIP CANCEL request according to 3GPP TS 24.229 [3]; and\n2)\tshall send a SIP 487 (Request Terminated) response to the SIP INVITE request according to 3GPP TS 24.229 [3].\nUpon receiving a SIP BYE request for an established dialog, the IWF performing the participating role:\n1)\tshall follow the procedures in clause 11.4.1.1.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_4.2.2",
        "clause_4.4",
        "clause_6.2.1",
        "clause_6.2.2",
        "clause_11.4.1.1",
        "ts_24.229",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.1.1.3",
      "section_id": "11.1.1.1.3",
      "section_title": "Terminating procedures for reception of SIP re-INVITE request",
      "content": "This clause is referenced from other procedures.\nUpon receipt of a SIP re-INVITE request for an existing private call session, the IWF performing the participating role shall:\n1)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <emergency-ind> element set to a value of \"true\":\nb)\tshall set the MCPTT emergency private priority state to \"MEPP 2: in-progress\" for this private call;\n2)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <emergency-ind> element set to a value of \"false\":\na)\tif the SIP re-INVITE request contains an application/vnd.3gpp.mcptt-info+xml MIME body including an <originated-by> element:\ni)\tif the MCPTT ID contained in the <originated-by> element is the MCPTT ID of the receiving MCPTT user, shall set the MCPTT emergency alert state to \"MPEA 1: no-alert\";\nb)\tshall set the MCPTT emergency private priority state to \"MEPP 1: no-emergency\" for this private call; and\nc)\tif the MCPTT emergency private call state of the call is set to \"MEPC 3: emergency-call-granted\", shall set the MCPTT emergency private call state of the call to \"MEPC 1: emergency-pc-capable\";\n3)\tmay check if a Resource-Priority header field is included in the incoming SIP INVITE request and may perform further actions outside the scope of this specification to act upon an included Resource-Priority header field as specified in 3GPP TS 24.229 [3]; and\nNOTE:\tAs this is a re-INVITE for an existing MCPTT private call session, there is no attempt made to change the answer-mode from its current state.\n4)\tinclude an SDP answer in the SIP 200 (OK) response to the SDP offer in the incoming SIP INVITE request according to 3GPP TS 24.229 [3] with the clarifications given in clause 6.1.2 with the IWF acting as the MCPTT client.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.1.2",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.1.1.4",
      "section_id": "11.1.1.1.4",
      "section_title": "MCPTT in-progress emergency cancel",
      "content": "This clause is referenced from other procedures.\nTo cancel the in-progress emergency condition on an MCPTT emergency private call, the IWF performing the participating role shall generate a SIP re-INVITE request by following the UE session procedures specified in 3GPP TS 24.229 [3], with the clarifications given below.\nThe IWF performing the participating role:\n1)\tshall, if cancelling an in-progress emergency condition and optionally an MCPTT emergency alert originated for the user homed in the IWF, include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.2.3;\n2)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.4.2.2;\n3)\tshall include in the SIP re-INVITE request an SDP offer with the media parameters as currently established;\n4)\tif an implicit floor request is required, shall indicate this as specified in clause 6.7; and\n5)\tshall send the SIP re-INVITE request according to 3GPP TS 24.229 [3].\nOn receiving a SIP 2xx response to the SIP re-INVITE request, the IWF performing the participating role:\n1)\tshall interact with the user plane as specified in 3GPP TS 29.380 [31];\n2)\tshall set the MCPTT emergency private priority state of the MCPTT private call to \"MEPP 1: no-emergency\";\n3)\tshall set the MCPTT emergency private call state of the call to \"MEPC 1: emergency-pc-capable\"; and\n4)\tif the MCPTT emergency alert state is set to \"MPEA 4: Emergency-alert-cancel-pending\", the sent SIP re-INVITE request did not contain an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body and the SIP 2xx response to the SIP request for a priority group call does not contain a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4 with the warning text containing the mcptt-warn-code set to \"149\", shall set the MCPTT emergency alert state to \"MPEA 1: no-alert\".\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request:\n1)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response contains an application/vnd.3gpp.mcptt-info+xml MIME body with an <emergency-ind> element set to a value of \"true\", the IWF performing the participating role shall set the MCPTT emergency private priority state as \"MEPP 2: in-progress\";\n2)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response contains an application/vnd.3gpp.mcptt-info+xml MIME body with an <alert-ind> element set to a value of \"true\" and the sent SIP re-INVITE request did not contain an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, the IWF performing the participating role shall set the MCPTT emergency alert state to \"MPEA 3: emergency-alert-initiated\"; and\n3)\tif the SIP 4xx response, SIP 5xx response or SIP 6xx response did not contain an application/vnd.3gpp.mcptt-info+xml MIME body, the IWF performing the participating role shall set the MCPTT emergency private priority state as \"MEPP 2: in-progress\" and the MCPTT emergency alert (MPEA) state shall revert to its value prior to entering the current procedure.\nNOTE:\tIf the in-progress emergency private priority state cancel request is rejected, the state of the session does not change, i.e. continues with MCPTT emergency private call level priority.\nOn receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing group session, the IWF performing the participating role shall follow the actions specified in 3GPP TS 24.379 [29], clause 6.2.8.3.7 with the IWF acting as the MCPTT client.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.4.2.3",
        "clause_6.4.2.2",
        "clause_6.7",
        "ts_24.379_clause_4.4",
        "ts_24.379_clause_6.2.8.3.7",
        "ts_24.229",
        "ts_29.380",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.1.1.5",
      "section_id": "11.1.1.1.5",
      "section_title": "Upgrade to MCPTT emergency private call",
      "content": "This clause is referenced by other clauses.\nTo upgrade the ongoing MCPTT private call to an MCPTT emergency private call, the IWF performing the participating role shall generate a SIP re-INVITE request as specified in 3GPP TS 24.229 [3], with the clarifications given below.\n1)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.2.1;\n2)\tshall include a Resource-Priority header field and comply with the procedures in clause 6.4.2.2.\n3)\tshall include an SDP offer with the media parameters as currently established according to 3GPP TS 24.229 [3];\n4)\tif an implicit floor request is required, shall indicate this as specified in clause 6.7; and\n5)\tshall send the SIP re-INVITE request according to 3GPP TS 24.229 [3].\nOn receiving a SIP 2xx response to the SIP re-INVITE request the IWF performing the participating role:\n1)\tshall interact with the user plane as specified in 3GPP TS 29.380 [31]; and\n2)\tshall perform the actions specified in 3GPP TS 24.379 [29], clause 6.2.8.3.4 with the IWF acting as the MCPTT client.\nOn receiving a SIP 4xx response, SIP 5xx response or SIP 6xx response to the SIP re-INVITE request, the IWF performing the participating role shall perform the actions specified in 3GPP TS 24.379 [29], clause 6.2.8.3.5 with the IWF acting as MCPTT client.\nOn receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing group session, the IWF performing the participating role shall follow the actions specified in 3GPP TS 24.379 [29], clause 6.2.8.3.7 with the IWF acting as the MCPTT client.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.4.2.1",
        "clause_6.4.2.2",
        "clause_6.7",
        "ts_24.379_clause_6.2.8.3.4",
        "ts_24.379_clause_6.2.8.3.5",
        "ts_24.379_clause_6.2.8.3.7",
        "ts_24.229",
        "ts_29.380",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.2.1.1",
      "section_id": "11.1.2.1.1",
      "section_title": "On-demand private call",
      "content": "In the present clause, the IWF performing the participating role initiates an on-demand private call. The IWF performing the participating role:\n1)\tshall determine the MCPTT ID of the calling user;\nNOTE:\tHow the IWF determines the MCPTT ID of a user homed in the IWF is out of scope of the present document.\n2)\tshall determine the public service identity of the controlling MCPTT function for the private call service associated with the originating user's MCPTT ID identity;\n3)\tshall generate a SIP INVITE request as specified in clause 11.1.1.1.1;\n4)\tshall modify the SIP INVITE as specified in clause 6.6.2.1.2;\n5)\tshall set the Request-URI to the public service identity of the controlling MCPTT function hosting the private call service as determined by step 3;\n6)\tshall set the <mcptt-calling-user-id> element in an application/vnd.3gpp.mcptt-info+xml MIME body of the SIP INVITE request to the MCPTT ID of the calling user;\n7)\tif the SIP INVITE request contains an emergency indication set to a value of \"true\", may include a Resource-Priority header field populated with the values for an emergency call as specified in clause 6.4.1.11; otherwise, may include a Resource-Priority header field populated with the values for a normal call as specified in clause 6.4.1.11; and\n8)\tshall forward the SIP INVITE request, according to 3GPP TS 24.229 [3].\nUpon receiving a SIP 180 (Ringing) response, the IWF performing the participating role's action are out of scope of the present document.\nUpon receiving a SIP 200 (OK) response, the IWF performing the participating role:\n1)\tshall perform the procedures for receiving a SIP 200 ok as specified in clause 11.1.1.1.1; and\n2)\tshall start the SIP session timer according to rules and procedures of IETF RFC 4028 [6].\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request, the IWF performing the participating role shall follow the procedures for SIP 4xx, SIP 5xx and SIP 6xx responses as specified in clause 11.1.1.1.1.\nUpon receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing session, the IWF performing the participating role shall follow the procedures for SIP INFO as specified in clause 11.1.1.1.1.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_11.1.1.1.1",
        "clause_6.6.2.1.2",
        "clause_6.4.1.11",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.2.1.2",
      "section_id": "11.1.2.1.2",
      "section_title": "SIP re-INVITE for MCPTT private call",
      "content": "Upon deciding to send a SIP re-INVITE for an existing private call session, the IWF performing the participating role:\n1)\tshall determine the MCPTT ID of the calling user;\nNOTE 1:\tHow the IWF determines the MCPTT ID of a user homed in the IWF is out of scope of the present document.\n2)\tif the SIP re-INVITE is to upgrade the call to an emergency call, shall generate a SIP re-INVITE request as specified in clause 11.1.1.1.5;\n3)\tif the SIP re-INVITE is to cancel the emergency on the call, shall generate a SIP re-INVITE request as specified in clause 11.1.1.1.4;\n4)\tshall set the <mcptt-calling-user-id> element in an application/vnd.3gpp.mcptt-info+xml MIME body of the SIP re-INVITE request to the MCPTT ID of the calling user homed in the IWF;\nNOTE 2:\tHow the IWF determines the MCPTT ID of a user homed in the IWF is out of scope of the present document.\n5)\tshall, if the SIP re-INVITE is to be sent within an on-demand session include in the SIP re-INVITE request an SDP containing the current media parameters used by the existing session;\n6)\tshall include a Resource-Priority header field as specified in clause 6.4.1.11; and\n7)\tshall forward the SIP re-INVITE request, according to 3GPP TS 24.229 [3].\nUpon receiving a SIP 200 (OK) response, the IWF performing the participating role:\n1)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\n2)\tshall follow the procedures for SIP 200 (OK) response as specified in clause 11.1.1.1.4 if an emergency is being cancelled in the present clause or as specified in clause 11.1.1.1.5 if the call is being upgraded to emergency in the present clause. The IWF performing the participating role shall forward any other SIP response that does not contain SDP, including any MIME bodies contained therein, along the signalling path to the originating network according to 3GPP TS 24.229 [3].\nOn receiving a SIP 4xx response, a SIP 5xx response or a SIP 6xx response to the SIP INVITE request, the IWF performing the participating role shall follow the procedures for SIP 4xx, SIP5xx and SIP 6xx responses as specified in clause 11.1.1.1.4 if an emergency is being cancelled in the present clause or as specified in clause 11.1.1.1.5 if the call is being upgraded to emergency in the present clause.\nUpon receiving a SIP INFO request where the Request-URI contains an MCPTT session ID identifying an ongoing session, the IWF performing the participating role shall follow the procedures for SIP INFO as specified in clause 11.1.1.1.4 if an emergency is being cancelled in the present clause or as specified in clause 11.1.1.1.5 if the call is being upgraded to emergency in the present clause.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_11.1.1.1.5",
        "clause_11.1.1.1.4",
        "clause_6.4.1.11",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.2.2",
      "section_id": "11.1.2.2",
      "section_title": "Terminating procedures",
      "content": "Upon receipt of a \"SIP INVITE request for terminating participating MCPTT function\", the IWF performing the participating role:\n1)\tshall respond with a SIP 488 (not acceptable here) with a body part as described in clause 6.10.2 if the IWF does not support one or more parameters of the call as described in clause 6.10.1;\n2)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the \"SIP INVITE request for terminating participating MCPTT function\" with a SIP 500 (Server Internal Error) response. The IWF may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [14], and shall not continue with the rest of the steps;\nNOTE:\tIf the received SIP INVITE request contains an emergency indication set to a value of \"true\", the IWF can choose to accept the request.\n3)\tshall check the presence of the isfocus media feature tag in the URI of the Contact header field and if it is not present then the IWF shall reject the request with a SIP 403 (Forbidden) response with the warning text set to \"104 isfocus not assigned\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, and shall not continue with the rest of the steps;\n4)\tshall use the MCPTT ID present in the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP INVITE request to retrieve the binding between the MCPTT ID and public user identity; and\n5)\tthe IWF may reject the \"SIP INVITE request for terminating participating MCPTT function\" with a SIP 403 (Forbidden) response including warning text set to \"127 user not authorised to be called in private call\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4.\nThe IWF performing the participating role sends the SIP 200 (OK) response to the originating network:\n1)\tshall generate a SIP 200 (OK) response as described in 3GPP TS 24.379 [29], clause 6.3.2.2.4.2;\n2)\tshall include in the SIP 200 (OK) response an SDP answer based on the SDP answer in the received SIP 200 (OK) response as specified in 3GPP TS 24.379 [29], clause 6.3.2.2.2.1;\n3)\tshall copy the P-Asserted-Identity header field from the incoming SIP 200 (OK) response to the outgoing SIP 200 (OK) response;\n4)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31] clause 6.4; and\n5)\tshall forward the SIP 200 (OK) response according to 3GPP TS 24.229 [3].",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.10.2",
        "clause_6.10.1",
        "ts_24.379_clause_4.4",
        "ts_24.379_clause_6.3.2.2.4.2",
        "ts_24.379_clause_6.3.2.2.2.1",
        "ts_29.380_clause_6.4",
        "ts_24.379",
        "ts_29.380",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.2.3",
      "section_id": "11.1.2.3",
      "section_title": "Receipt of SIP re-INVITE request by terminating participating function",
      "content": "This clause covers the on-demand session case only.\nUpon receipt of a SIP re-INVITE request for an existing MCPTT private call session the IWF performing the participating role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, shall reject the SIP re-INVITE with a SIP 500 (Server Internal Error) response. The IWF performing the participating role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [14] and shall skip the rest of the steps;\nNOTE 1:\tIf the SIP re-INVITE request contains an emergency indication, the IWF performing the participating role can choose to accept the request.\nNOTE 2:\tAs this is the modification of an in-progress MCPTT private call, this procedure does not attempt modification of the existing answer-mode of the call.\n2)\tshall generate a SIP 200 (OK) response as described in 3GPP TS 24.379 [29], clause 6.3.2.2.4.2, with the IWF acting as the participating MCPTT function;\n3)\tshall perform the procedures in clause 11.1.1.1.3;\n4)\tshall modify the SDP answer in the received SIP 200 (OK) response as specified in 3GPP TS 24.379 [29], clause 6.3.2.2.2.1 with the IWF acting as the participating function;\n5)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\n6)\tshall forward the SIP 200 (OK) response according to 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_6.3.2.2.4.2",
        "clause_11.1.1.1.3",
        "ts_24.379_clause_6.3.2.2.2.1",
        "ts_24.379",
        "ts_29.380",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.3.1",
      "section_id": "11.1.3.1",
      "section_title": "Originating procedures",
      "content": "This clause describes the procedures for inviting an MCPTT user to an MCPTT session. The procedure is initiated by the IWF performing the controlling role.\nThe IWF performing the controlling role:\n1)\tshall generate a SIP INVITE request as specified in clause 6.6.3.1.1;\n2)\tshall set the <mcptt-calling-user-id> to the calling user's MCPTT ID in the outgoing SIP INVITE;\n3)\tif the received request is for an MCPTT emergency private call as determined by clause 6.6.3.1.8.2:\na)\tshall set the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"true\";\nb)\tif the request is for an MCPTT emergency alert, shall perform the procedures specified in clause 6.6.3.1.7; and\nc)\tif the request is not for an MCPTT emergency alert, shall set the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body to a value of \"false\";\n4)\tshall copy the MCPTT ID of the called MCPTT user into the <mcptt-request-uri> element in the application/vnd.3gpp.mcptt-info+xml MIME body of the outgoing SIP INVITE request;\n5)\tshall set the Request-URI to the public service identity of the terminating participating MCPTT function associated to the MCPTT user to be invited;\nNOTE 1:\tHow the IWF performing the controlling role finds the address of the terminating MCPTT participating function is out of the scope of the current release.\nNOTE 2:\tThe terminating MCPTT user is part of a partner MCPTT system, therefore the public service identity can identify an entry point in the partner network that is able to identify the terminating participating MCPTT function.\n6)\tshall include a Resource-Priority header field populated with the values for an MCPTT emergency private call as specified in clause 6.6.3.1.12, if either of the following conditions is met:\na)\tif the request is for an MCPTT emergency private call as determined in step 2 above; or\nb)\tthe originating user homed in the IWF is in an in-progress emergency private call state with the targeted MCPTT user;\n7)\tshall include an SDP offer according to 3GPP TS 24.229 [3] with the clarification given in clause 6.1.1 and with a media stream of the offered media-floor control entity and according to the procedures specified in 3GPP TS 24.379 [29], clause 6.3.3.1.1 with the IWF acting as the controlling MCPTT function;\n8)\tshall send the SIP INVITE request towards the core network according to 3GPP TS 24.229 [3]; and\n9)\tshall start a private call timer with a value set to the configured max private call duration for the user.\nUpon receiving SIP 200 (OK) response for the SIP INVITE request the IWF performing the controlling role:\n1)\tshall cache the contact received in the Contact header field; and\n2)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31].\nUpon expiry of the private call timer, the IWF performing the controlling role shall follow the procedure for releasing private call session as specified in clause 11.4.3.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.6.3.1.1",
        "clause_6.6.3.1.8.2",
        "clause_6.6.3.1.7",
        "clause_6.6.3.1.12",
        "clause_6.1.1",
        "ts_24.379_clause_6.3.3.1.1",
        "clause_11.4.3",
        "ts_24.229",
        "ts_24.379",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.3.2",
      "section_id": "11.1.3.2",
      "section_title": "Terminating procedures",
      "content": "In the procedures in this clause:\n1)\t<emergency–ind> refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body;\n2)\t<alert–ind> refers to the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n3)\t<session-type> refers to the <session-type> element of an application/vnd.3gpp.mcptt-info+xml MIME body.\nUpon receipt of a \"SIP INVITE request for controlling MCPTT function of a private call\", the IWF performing the controlling role:\n1)\tif the <session-type> in the SIP INVITE request is set to \"private\":\na)\tshall check whether the public service identity contained in the Request-URI is allocated for private call and perform the actions specified in clause 6.6.6.1 if it is not allocated and skip the rest of the steps; and\nb)\tshall perform actions to verify the MCPTT ID of the inviting MCPTT user in the <mcptt-calling-user-id> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP INVITE request, and authorise the request according to local policy, and if it is not authorised the IWF performing the controlling role shall return a SIP 403 (Forbidden) response with the warning text as specified in \"Warning header field\" and skip the rest of the steps;\n2)\tif the incoming SIP INVITE request does not contain an application/resource-lists MIME body shall reject the SIP INVITE request with a SIP 403 (Forbidden) response including warning text set to \"145 unable to determine called party\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, and shall not continue with the rest of the steps;\n3)\tif the <session-type> is set to \"private\" and the application/resource-lists MIME body contains more than one <entry> element, shall reject the \"SIP INVITE request for controlling MCPTT function of a private call\" with a SIP 403 (Forbidden) response including warning text set to \"145 unable to determine called party\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, and shall not continue with the rest of the steps;\n4)\tshall validate that the received SDP offer includes at least one media stream for which the media parameters and at least one codec or media format is acceptable by the IWF performing the controlling role and if not, reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n5)\tif received SIP INVITE request includes an <emergency-ind>, shall validate the request as described in 3GPP TS 24.379 [29], clause 6.3.3.1.17, with the IWF acting as the controlling function;\n6)\tif the received SIP INVITE request contains an unauthorised request for an MCPTT emergency private call as determined by clause 6.6.3.1.8.2:\na)\tshall reject the SIP INVITE request with a SIP 403 (Forbidden) response as specified in clause 6.6.3.1.9; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n7)\tif a Resource-Priority header field is included in the received SIP INVITE request and if the Resource-Priority header field is set to the value indicated for emergency calls, shall reject the SIP INVITE request with a SIP 403 (Forbidden) response and skip the remaining steps if neither one of the following conditions are true:\na)\tthe SIP INVITE request does not contain an authorised request for an MCPTT emergency call as determined in step 4 above; or\nb)\tthe originating MCPTT user is not in an in-progress emergency private call state with the targeted MCPTT user;\n8)\tif:\na)\tthe received SIP INVITE request contains an emergency indication set to a value of \"true\";\nb)\tthe originating MCPTT user is not in an in-progress emergency private call state with the targeted user homed in the IWF; and\nc)\tif the <session-type> in the SIP INVITE request is set to \"private\";\nthen:\na)\tshall cache the information that the MCPTT user has initiated an MCPTT emergency private call to the targeted user; and\nb)\tshall cache the information that the MCPTT user is in an in-progress emergency private call state with the targeted user homed in the IWF;\n9)\tshall perform actions as described in 3GPP TS 24.379 [29], clause 6.3.3.2.2, with the IWF acting as the controlling MCPTT function;\n10)\tshall allocate an MCPTT session identity for the MCPTT session; and\n11)\tshall set up a private call with the targeted user homed in the IWF (the user whose MCPTT ID is listed in the MIME resource-lists body of received SIP INVITE request).\nNOTE 1:\tHow the IWF sets up calls internally is out of scope of the present document.\nUpon deciding to send a SIP 180 (Ringing) response and if the SIP 180 (Ringing) response or the SIP final response has not yet been sent to the inviting MCPTT client, the IWF performing the controlling role shall generate a SIP 180 (Ringing) response to the SIP INVITE request and send the SIP 180 (Ringing) response towards the inviting MCPTT client according to 3GPP TS 24.229 [3].\nUpon deciding to accept the call, the IWF performing the controlling role:\n1)\tshall generate a SIP 200 (OK) response to the SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.3.2, with the IWF acting as the MCPTT controlling function, before continuing with the rest of the steps;\n2)\tshall include in the SIP 200 (OK) response an SDP answer to the SDP offer in the incoming SIP INVITE request as specified in the 3GPP TS 24.379 [29] clause 6.3.3.2.2, with the IWF acting as the controlling MCPTT function;\n3)\tif the received SIP INVITE request contains an alert indication set to a value of \"true\" and this is an unauthorised request for an MCPTT emergency alert as specified in clause 6.6.3.1.8.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling function;\nNOTE 2:\tThis is the case when the MCPTT user's request for an MCPTT emergency private call was granted but the request for the MCPTT emergency alert was denied.\n4)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\nNOTE 3:\tResulting media plane processing is completed before the next step is performed.\n5)\tshall send a SIP 200 (OK) response towards the inviting MCPTT client according to 3GPP TS 24.229 [3].\nUpon receiving a SIP ACK to the SIP 200 (OK) response sent towards the inviting MCPTT client, where the SIP 200 (OK) response was sent with a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4, with the IWF acting as the controlling function with the warning text containing the mcptt-warn-code set to \"149\", the IWF performing the controlling role shall follow the procedures in clause 6.6.3.1.11.\nUpon receiving a SIP BYE request from the originating MCPTT client containing an application/vnd.3gpp.mcptt-info+xml MIME body containing a <release-reason> element set to a value of \"authentication of the MIKEY-SAKE I_MESSAGE failed\", the IWF performing the controlling role shall follow the procedures in clause 6.6.3.2.1.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.6.6.1",
        "ts_24.379_clause_4.4",
        "ts_24.379_clause_6.3.3.1.17",
        "clause_6.6.3.1.8.2",
        "clause_6.6.3.1.9",
        "ts_24.379_clause_6.3.3.2.2",
        "ts_24.379_clause_6.3.3.2.3.2",
        "clause_6.6.3.1.8.1",
        "clause_6.6.3.1.11",
        "clause_6.6.3.2.1",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.3.3",
      "section_id": "11.1.3.3",
      "section_title": "Receiving a SIP re-INVITE for upgrade to emergency private call",
      "content": "In the procedures in this clause:\n1)\temergency indication in an incoming SIP re-INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n2)\talert indication in an incoming SIP re-INVITE request refers to the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nUpon receiving a SIP re-INVITE request with an emergency indication set to a value of \"true\", the IWF performing the controlling role:\n1)\tshall validate that the received SDP offer includes at least one media stream for which the media parameters and at least one codec or media format is acceptable by the IWF performing the controlling role and if not, reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n2)\tshall validate the request as described in 3GPP TS 24.379 [29], clause 6.3.3.1.17 with the IWF acting as the MCPTT server;\n3)\tif the SIP re-INVITE request contains an unauthorised request for an MCPTT emergency private call as determined by clause 6.6.3.1.8.2:\na)\tshall reject the SIP INVITE request with a SIP 403 (Forbidden) response as specified in clause 6.6.3.1.9; and\nb)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n4)\tif the SIP re-INVITE request contains an emergency indication set to a value of \"true\" and the originating MCPTT user is not in an in-progress emergency private call state with the targeted user:\na)\tshall cache the information that the MCPTT user is in an in-progress emergency private call state with the targeted user; and\nb)\tif the SIP re-INVITE request contains an alert indication set to \"true\", shall cache the information that the MCPTT user has sent an MCPTT emergency alert to the targeted user; and\n5)\tshall perform the steps in clause 11.1.2.3 with the IWF performing the participating role but shall not forward the SIP 200 (OK) response.\nIf the SIP response has not yet been sent towards the inviting MCPTT client, the IWF performing the controlling role:\n1)\tshall modify the SIP 200 (OK) response to the SIP re-INVITE request as specified in 3GPP TS 24.379 [29], clause 6.3.3.2.3.2 with the IWF acting as the controlling function before continuing with the rest of the steps;\n2)\tif the received SIP re-INVITE request contains an alert indication set to a value of \"true\" and this is an unauthorised request for an MCPTT emergency alert as specified in clause 6.6.3.1.8.1, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4 with the IWF acting as the MCPTT server.\nNOTE:\tWhen a SIP 200 (OK) response sent towards the originator as a response to a SIP INVITE request that contained authorised request(s) for an MCPTT emergency private call and optionally an MCPTT emergency alert, the originator will consider a SIP 200 (OK) response populated in this manner as confirmation that its request(s) for an upgrade to an MCPTT emergency private call and optionally an MCPTT emergency alert were accepted by the IWF performing the controlling role.\n3)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\n4)\tshall send the SIP 200 (OK) response towards the inviting MCPTT client according to 3GPP TS 24.229 [3].\nUpon receiving a SIP ACK to the SIP 200 (OK) response sent towards the inviting MCPTT client, and the SIP 200 (OK) response was sent with the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4 with the IWF acting as the MCPTT server, the IWF performing the controlling role shall follow the procedures in clause 6.6.3.1.11.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_6.3.3.1.17",
        "clause_6.6.3.1.8.2",
        "clause_6.6.3.1.9",
        "clause_11.1.2.3",
        "ts_24.379_clause_6.3.3.2.3.2",
        "clause_6.6.3.1.8.1",
        "ts_24.379_clause_4.4",
        "clause_6.6.3.1.11",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.3.4",
      "section_id": "11.1.3.4",
      "section_title": "Receiving a SIP re-INVITE for cancellation of emergency private call",
      "content": "In the procedures in this clause:\n1)\temergency indication in an incoming SIP INVITE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n2)\talert indication in an incoming SIP INVITE request refers to the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nUpon receiving a SIP re-INVITE request with an emergency indication set to a value of \"false\", the IWF performing the controlling role:\n1)\tshall validate that the received SDP offer includes at least one media stream for which the media parameters and at least one codec or media format is acceptable by the IWF performing the controlling role and if not, reject the request with a SIP 488 (Not Acceptable Here) response and skip the rest of the steps;\n2)\tshall validate the request as described in 3GPP TS 24.379 [29], clause 6.3.3.1.17 with the IWF acting as the controlling function;\n3)\tif the SIP re-INVITE request contains an unauthorised request for an MCPTT emergency private call cancellation as determined by local policy:\na)\tshall reject the SIP re-INVITE request with a SIP 403 (Forbidden) response;\nb)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 with an <emergency-ind> element set to a value of \"true\";\nc)\tif the SIP re-INVITE request contains an alert indication set to \"false\" and this is an unauthorised request for an MCPTT emergency alert cancellation as determined by local policy, shall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body with an <alert-ind> element set to \"true; and\nd)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\n4)\tif the SIP re-INVITE request contains an authorised request for an MCPTT emergency private call cancellation as determined by clause 6.6.3.1.8.4:\na)\tshall clear the cache of the MCPTT ID of the originator of the MCPTT emergency private call that is no longer in an in-progress emergency private call state with the targeted user; and\nb)\tif the SIP re-INVITE request contains an alert indication set to \"false\" and this is an authorised request for an MCPTT emergency alert cancellation meeting the conditions specified in clause 6.6.3.1.8.3:\ni)\tif the received SIP re-INVITE request contains an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, shall clear the cache of the MCPTT ID of user identified by the <originated-by> element as having an outstanding MCPTT emergency alert; and\nii)\tif the received SIP re-INVITE request does not contain an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, clear the cache of the MCPTT ID of the sender of the SIP re-INVITE request as having an outstanding MCPTT emergency alert; and\n5)\tshall perform the steps in clause 11.1.2.3 but shall not forward the SIP 200 (OK) response.\nIf the SIP response has not yet been sent towards the inviting MCPTT client, the IWF performing the controlling role:\n1)\tshall modify the SIP 200 (OK) response to the SIP re-INVITE request as specified in 3GPP TS 24.379 [29], clause 6.3.3.2.3.2 with the IWF acting as the controlling function before continuing with the rest of the steps;\n2)\tif the received SIP re-INVITE request contains an alert indication set to a value of \"false\" and this is an unauthorised request for an MCPTT emergency alert cancellation as specified in clause 6.6.3.1.8.3, shall include in the SIP 200 (OK) response the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4 with the IWF acting as the MCPTT server.\nNOTE:\tWhen a SIP 200 (OK) response sent towards the originator as a response to a SIP INVITE request that contained authorised request(s) for an MCPTT emergency private call cancellation and optionally an MCPTT emergency alert cancellation, the originator will consider a SIP 200 (OK) response populated in this manner as confirmation that its request(s) for cancellation of an MCPTT emergency private call and optionally an MCPTT emergency alert were accepted by the IWF performing the controlling role.\n3)\tshall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\n4)\tshall send the SIP 200 (OK) response towards the inviting MCPTT client according to 3GPP TS 24.229 [3].\nUpon receiving a SIP ACK to the SIP 200 (OK) response sent towards the inviting MCPTT client, and the SIP 200 (OK) response was sent with the warning text set to \"149 SIP INFO request pending\" in a Warning header field as specified in 3GPP TS 24.379 [29], clause 4.4 with the IWF acting as the MCPTT server, with the IWF acting as the controlling function shall follow the procedures in clause 6.6.3.1.11.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_6.3.3.1.17",
        "clause_6.6.3.1.8.4",
        "clause_6.6.3.1.8.3",
        "clause_11.1.2.3",
        "ts_24.379_clause_6.3.3.2.3.2",
        "ts_24.379_clause_4.4",
        "clause_6.6.3.1.11",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.3.5",
      "section_id": "11.1.3.5",
      "section_title": "Sending a SIP re-INVITE for upgrade to emergency private call",
      "content": "This clause describes the procedures for sending a re-INVITE request to an MCPTT user in an MCPTT private call for the purpose of upgrading the session to an emergency private call session. The procedure is initiated by the IWF performing the controlling role.\nThe IWF performing the controlling role:\n1)\tshall generate a SIP re-INVITE request as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.9, with the IWF acting as the controlling function;\n2)\tif the originating user homed in the IWF is not in an in-progress emergency private call state with the targeted MCPTT user:\na)\tshall cache the information that the user homed in the IWF is in an in-progress emergency private call state with the targeted MCPTT user; and\nb)\tif this is a request for an MCPTT emergency alert, shall cache the information that the user homed in the IWF has sent an MCPTT emergency alert to the targeted user;\n3)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.2.1;\n4)\tif an implicit floor request is required, shall indicate this as specified in clause 6.7 and may include an application/vnd.3gpp.mcptt-location-info+xml MIME body with a <Report> element included in the <location-info> root element;\n5)\tshall set the <mcptt-calling-user-id> element in an application/vnd.3gpp.mcptt-info+xml MIME body of the SIP re-INVITE request to the MCPTT ID of the calling user homed in the IWF;\nNOTE 1:\tHow the IWF determines the MCPTT ID of a user homed in the IWF is out of scope of the present document.\n6)\tshall include in the SIP re-INVITE request an SDP containing the current media parameters used by the existing session;\n7)\tif this is a request for an MCPTT emergency alert:\na)\tshall determine the value of the user's Mission Critical Organization identity; and.\nNOTE 2:\tHow the IWF determines the user's Mission Critical Organization identity is out of scope of the present document;\nb)\tshall include in the <mcpttinfo> element containing the <mcptt-Params> element containing an <mc-org> element set to the value of the user's Mission Critical Organization identity;\n8)\tshall include a Resource-Priority header field populated with the values for an MCPTT emergency private call as specified in clause 6.6.3.1.12; and\n9)\tshall send the SIP re-INVITE request towards the core network according to 3GPP TS 24.229 [3].\nUpon receiving SIP 200 (OK) response for the SIP re-INVITE request the IWF performing the controlling role:\n1)\tshall cache the contact received in the Contact header field;\n2)\tshall interact with the user plane as specified in 3GPP TS 29.380 [31]; and\n3)\tshall perform the actions specified in 3GPP TS 24.379 [29], clause 6.2.8.3.4 with the IWF acting as the MCPTT client.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_6.3.3.1.9",
        "clause_6.4.2.1",
        "clause_6.7",
        "clause_6.6.3.1.12",
        "ts_24.379_clause_6.2.8.3.4",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.1.3.6",
      "section_id": "11.1.3.6",
      "section_title": "Sending a SIP re-INVITE for cancellation of emergency private call",
      "content": "This clause describes the procedures for sending a re-INVITE request to an MCPTT user in an MCPTT emergency private call for the purpose of downgrading the session to a normal priority private call session. The procedure is initiated by the IWF performing the controlling role.\nThe IWF performing the controlling role:\n1)\tshall generate a SIP re-INVITE request as specified 3GPP TS 24.379 [29], clause 6.3.3.1.9, with the IWF acting as the controlling function;\n2)\tshall clear the cache of the MCPTT ID of the originator of the MCPTT emergency private call that is no longer in an in-progress emergency private call state with the targeted user;\n3)\tif this is a request for an MCPTT emergency alert cancellation, shall clear the cache of the MCPTT ID of user homed in the IWF as having an outstanding MCPTT emergency alert;\n4)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body populated as specified in clause 6.4.2.3;\n5)\tif an implicit floor request is required, shall indicate this as specified in clause 6.7;\n6)\tshall set the <mcptt-calling-user-id> element in an application/vnd.3gpp.mcptt-info+xml MIME body of the SIP re-INVITE request to the MCPTT ID of the calling user homed in the IWF;\nNOTE:\tHow the IWF determines the MCPTT ID of a user homed in the IWF is out of scope of the present document.\n7)\tshall include in the SIP re-INVITE request an SDP containing the current media parameters used by the existing session;\n8)\tshall include a Resource-Priority header field populated with the values for a normal MCPTT private call as specified in clause 6.6.3.1.12; and\n9)\tshall send the SIP re-INVITE request towards the core network according to 3GPP TS 24.229 [3].\nUpon receiving SIP 200 (OK) response for the SIP re-INVITE request the IWF performing the controlling role:\n1)\tshall cache the contact received in the Contact header field;\n2)\tshall set the MCPTT emergency private priority state of the MCPTT private call to \"MEPP 1: no-emergency\";\n3)\tshall set the MCPTT emergency private call state of the call to \"MEPC 1: emergency-pc-capable\"; and\n4)\tshall interact with the user plane as specified in 3GPP TS 29.380 [31].",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.379_clause_6.3.3.1.9",
        "clause_6.4.2.3",
        "clause_6.7",
        "clause_6.6.3.1.12",
        "ts_24.379",
        "ts_24.229",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.2.1.1",
      "section_id": "11.2.1.1",
      "section_title": "Originating procedures",
      "content": "To request a private call without floor control, the IWF performing the participating role shall follow the procedures as specified in clause 11.1.2.1.1 for an on-demand session but with an SDP offer not including media-level section for media-floor control entity.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_11.1.2.1.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.2.1.2",
      "section_id": "11.2.1.2",
      "section_title": "Terminating procedures",
      "content": "Upon receipt of a \"SIP INVITE request for terminating participating MCPTT function\" for the private call with SDP offer not including media-level section for media-floor control entity, the IWF performing the participating role consider it as the request for the private call without floor control and shall follow the procedures as specified in clause 11.1.2.2.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_11.1.2.2"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.2.2.1",
      "section_id": "11.2.2.1",
      "section_title": "Originating procedures",
      "content": "The IWF performing the controlling role shall follow the procedures as specified in clause 11.1.3.1.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_11.1.3.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.3.1.1.1",
      "section_id": "11.3.1.1.1",
      "section_title": "Receipt of SIP BYE request for private call on-demand",
      "content": "Upon receiving a SIP BYE request from the controlling MCPTT function, the IWF performing the participating role shall follow the procedures as specified in clause 6.6.2.2.2.1.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.2.2.2.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.4.1.1",
      "section_id": "11.4.1.1",
      "section_title": "Receiving a SIP BYE request for private call session",
      "content": "Upon receiving a SIP BYE request for private call session, the IWF shall follow the procedures as specified in clause 6.3.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.3"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.4.2.1.1",
      "section_id": "11.4.2.1.1",
      "section_title": "Receipt of SIP BYE request for private call on-demand",
      "content": "Upon receiving a SIP BYE request from the controlling MCPTT function, the IWF performing the participating role shall follow the procedures as specified in clause 6.6.2.2.2.1.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.6.2.2.2.1"
      ]
    },
    {
      "chunk_id": "ts_29.379_11.4.3",
      "section_id": "11.4.3",
      "section_title": "IWF controlling role procedures",
      "content": "When the MCPTT session for private call needs to be released as specified in clause 6.6.7.2 with the IWF acting as the controlling MCPTT function, the IWF performing the controlling role shall follow the procedures in clause 6.6.3.1.2.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.6.7.2",
        "clause_6.6.3.1.2"
      ]
    },
    {
      "chunk_id": "ts_29.379_12.1.1",
      "section_id": "12.1.1",
      "section_title": "IWF to send SIP MESSAGE request for emergency notification",
      "content": "When the IWF performing originating participating role needs to send a SIP MESSAGE request for emergency notification, the IWF:\n1)\tvoid;\n2)\tif the MCPTT ID for which the SIP MESSAGE is sent is not affiliated with the MCPTT group as determined by clause 9.2.1.2.8, shall perform the actions specified in clause 9.2.1.2.9 for implicit affiliation;\n3)\tif the actions for implicit affiliation specified in step 2) above were performed but not successful, shall skip the rest of the steps.\n4)\tshall determine the public service identity of the controlling MCPTT function associated with the group identity in the received request for emergency notification;\n5)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [3] and IETF RFC 3428 [18];\n6)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCPTT function associated with the MCPTT group;\n7)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 included in the outgoing SIP MESSAGE request based on information received from signalling received from the originating LMR user and its network entities;\n8)\tshall set the <mcptt-calling-user-id> element of the <mcpttinfo> element containing the <mcptt-Params> element to the MCPTT ID of the user homed in the IWF;\n9)\tif location information is available in the received request for emergency notification, include an application/vnd.3gpp.mcptt-location-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.3 in the outgoing SIP MESSAGE request;\n10)\tshall set the P-Asserted-Identity in the outgoing SIP MESSAGE request to the public service identity of the IWF; and\n11)\tshall send the SIP MESSAGE request as specified to 3GPP TS 24.229 [3].\nUpon receipt of a SIP 2xx response to the SIP MESSAGE request:\n1)\tif the procedures of clause 9.2.1.2.9 for implicit affiliation were performed in the present clause, shall complete the implicit affiliation by performing the procedures of clause 9.2.1.2.10.\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the sent SIP MESSAGE request and if the implicit affiliation procedures of clause 9.2.1.2.9 were invoked in the present clause, the IWF shall perform the procedures of clause 9.2.1.2.11.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.2.1.2.8",
        "clause_9.2.1.2.9",
        "clause_9.2.1.2.10",
        "clause_9.2.1.2.11",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_12.1.2",
      "section_id": "12.1.2",
      "section_title": "Receipt of a SIP MESSAGE request for emergency notification for terminating LMR user",
      "content": "In the procedures in this clause:\n1)\temergency indication in an incoming SIP MESSAGE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body; and\n2)\talert indication in an incoming SIP MESSAGE request refers to the <alert-ind> element of the application/vnd.3gpp.mcptt-info+xml MIME body.\nUpon receipt of a \"SIP MESSAGE request for emergency notification for terminating participating MCPTT function\", the IWF performing the participating role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The IWF performing the participating role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [14] and skip the rest of the steps;\nNOTE 1:\tif the SIP MESSAGE request contains an emergency indication set to a value of \"true\" or an alert indication set to a value of \"true\", the IWF can by means beyond the scope of this specification choose to accept the request.\n2)\tshall use the MCPTT ID present in the <mcptt-request-uri> element of the application/vnd.3gpp.mcptt-info+xml MIME body of the incoming SIP MESSAGE request to determine the terminating target; and\n3)\tif the terminating target is not served by the IWF the IWF shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response.\nNOTE 2: LMR specific signalling is outside the scope of this specification.\nThe IWF shall generate s SIP 2xx response and follow the procedures specified in 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.379_12.1.3",
      "section_id": "12.1.3",
      "section_title": "Receipt of a SIP MESSAGE request indicating successful delivery of emergency notification",
      "content": "Upon receipt of an indication for successful delivery of an emergency notification, internal actions performed by the IWF performing the terminating participating role are out of scope of the present document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_12.2.1",
      "section_id": "12.2.1",
      "section_title": "Handling of a SIP MESSAGE request for emergency notification",
      "content": "Upon receipt of a \"SIP MESSAGE request for emergency notification for controlling MCPTT function\", the IWF performing the controlling role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The controlling MCPTT function may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [14]. Otherwise, continue with the rest of the steps;\nNOTE:\tIf the SIP MESSAGE request contains an alert indication set to a value of \"true\", the controlling MCPTT function can, according to local policy, choose to accept the request.\n2)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if an Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\";\n3)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"false\", shall perform the procedures specified in clause 12.2.2 and skip the rest of the steps;\n4)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"true\":\na)\tif the received SIP MESSAGE request is an unauthorised request for an MCPTT emergency alert as specified in clause 6.6.3.1.8.1 shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request as specified in 3GPP TS 24.229 [3] with the following clarifications:\ni)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29], clause F.1 of 3GPP TS 24.379 [29] with the <mcpttinfo> element containing the <mcptt-Params> element with the <alert-ind> element set to a value of \"false\"; and\nii)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [3] and skip the rest of the steps; and\nb)\tif the received SIP MESSAGE request is an authorised request for an MCPTT emergency alert as specified in clause 6.6.3.1.8.1:\ni)\tif the sending MCPTT user identified by the <mcptt-calling-user-id> element included in the application/vnd.3gpp.mcptt-info+xml MIME body is not affiliated with the MCPTT group identified by the <mcptt-request-uri> element of the MIME body as determined by the procedures of 3GPP TS 24.379 [29], clause 6.3.6, with the IWF acting as the MCPTT server:\nI)\tshall check if the MCPTT user is eligible to be implicitly affiliated with the MCPTT group as determined by clause 9.2.1.3.6;\nII)\tif the MCPTT user is determined not to be eligible to be implicitly affiliated to the MCPTT group shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.4 and skip the rest of the steps below; or\nIII)\tif the procedures of clause 9.2.1.3.6 determined the MCPTT user to be eligible to be implicitly affiliated to the MCPTT group shall, perform the implicit affiliation as specified in clause 9.2.1.3.7;\nii)\tfor each of the other affiliated members of the group:\nA)\tgenerate an outgoing SIP MESSAGE request notification of the MCPTT user's emergency alert indication as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11, with the IWF acting as the controlling MCPTT function, with the clarifications of clause 6.6.3.1.7;\nB)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <mcptt-calling-user-id> element set to the value of the <mcptt-calling-user-id> element in the received SIP MESSAGE request; and\nC)\tsend the SIP MESSAGE request according to according to rules and procedures of 3GPP TS 24.229 [3];\niii)\tshall generate a SIP 200 (OK) response to the received SIP MESSAGE request as specified in 3GPP TS 24.229 [3] with the following clarifications:\nA)\tshall cache the information that the MCPTT user has initiated an MCPTT emergency alert;\niv)\tshall send the SIP 200 (OK) response to the received SIP MESSAGE according to rules and procedures of 3GPP TS 24.229 [3].\nv)\tshall generate a SIP MESSAGE request as described in 3GPP TS 24.379 [29], clause 6.3.3.1.20, with the IWF acting as the controlling MCPTT function, to indicate successful receipt of an emergency alert, and shall include in the application/vnd.3gpp.mcptt-info+xml MIME body:\nA)\tthe <alert-ind> element set to a value of \"true\";\nB)\tthe <alert-ind-rcvd> element set to a value of true; and\nC)\tthe <mcptt-client-id> element with the MCPTT client ID that was included in the incoming SIP MESSAGE request; and\nvi)\tshall send the SIP MESSAGE request according to according to rules and procedures of 3GPP TS 24.229 [3].\nUpon receipt of SIP 2xx responses to the outgoing SIP MESSAGE requests, the controlling MCPTT function shall follow the procedures specified in 3GPP TS 24.229 [3].\nIf the IWF performing the controlling role needs to generate a SIP MESSAGE request for emergency notification, the IWF performing the controlling role:\n1)\tfor each of the affiliated MCPTT group members:\na)\tshall generate an outgoing SIP MESSAGE request notification of the MCPTT user's emergency alert indication as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11 with the IWF acting as the controlling MCPTT function, with the clarifications of clause 6.6.3.1.7;\nb)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <mcptt-calling-user-id; and\nc)\tshall send the SIP MESSAGE request according to according to rules and procedures of 3GPP TS 24.229 [3];",
      "chunk_type": "general",
      "cross_references": [
        "clause_12.2.2",
        "clause_6.6.3.1.8.1",
        "ts_24.379_clause_6.3.6",
        "clause_9.2.1.3.6",
        "clause_4.4",
        "clause_9.2.1.3.7",
        "ts_24.379_clause_6.3.3.1.11",
        "clause_6.6.3.1.7",
        "ts_24.379_clause_6.3.3.1.20",
        "ts_24.229",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.379_12.2.2",
      "section_id": "12.2.2",
      "section_title": "Handling of a SIP MESSAGE request for emergency alert cancellation",
      "content": "Upon receipt of a \"SIP MESSAGE request for emergency notification for controlling MCPTT function\" containing an application/vnd.3gpp.mcptt-info+xml MIME body with the <alert-ind> element set to a value of \"false\", the IWF performing the controlling role:\n1)\tif the received SIP MESSAGE request is an unauthorised request for an MCPTT emergency alert cancellation as specified in clause 6.6.3.1.8.1:\na)\tand if the received SIP MESSAGE request does not contain an <emergency-ind> element or is an unauthorised request for an MCPTT emergency call cancellation as specified in clause 6.6.3.1.8.4, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request as specified in 3GPP TS 24.229 [3] with the following clarifications:\ni)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcptt-info+xml MIME body as specified in 3GPP TS 24.379 [29] clause F.1 with the <mcpttinfo> element containing the <mcptt-Params> element with the <alert-ind> element set to a value of \"true\";\nii)\tif the received SIP MESSAGE request contains an <emergency-ind> element of the <mcpttinfo> element set to a value of \"false\" and if the in-progress emergency state of the group is set to a value of \"true\" and this is an unauthorised request for an MCPTT emergency call cancellation as determined in step i) above, shall include an <emergency-ind> element set to a value of \"true\" in the application/vnd.3gpp.mcptt-info+xml MIME body in the SIP 403 (Forbidden) response; and\niii)\tshall send the SIP 403 (Forbidden) response according to rules and procedures of 3GPP TS 24.229 [3] and skip the rest of the steps; and\nb)\tand if the received SIP MESSAGE request contains an <emergency-ind> element and is an authorised request for an MCPTT emergency call cancellation as specified in 3GPP TS 24.379 [29] clause 6.6.3.1.8.4 and the in-progress emergency state of the MCPTT group is set to a value of \"true\":\ni)\tshall set the in-progress emergency state of the group to a value of \"false\";\nii)\tshall clear the cache of the MCPTT ID of the MCPTT user that triggered the setting of the in-progress emergency state of the MCPTT group to \"true\";\niii)\tshall generate SIP re-INVITE request to the other affiliated and joined members of the MCPTT group as specified in clause 6.6.3.1.3. The IWF performing the controlling role:\nA)\tfor each affiliated and joined member shall send the SIP re-INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nB)\tupon receiving a SIP 200 (OK) response to the SIP re-INVITE request shall interact with the media plane as specified in 3GPP TS 29.380 [31];\niv)\tfor each of the affiliated but not joined members of the group:\nA)\tgenerate a SIP MESSAGE request notification of the cancellation of the MCPTT user's emergency call as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11 with the IWF acting as the controlling MCPTT function;\nB)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <mcptt-calling-user-id> element set to the value of the <mcptt-calling-user-id> element in the received SIP MESSAGE request; and\nC)\tshall include an <emergency-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP MESSAGE request;\nv)\tshall generate a SIP 200 (OK) response to the received SIP MESSAGE request as specified in 3GPP TS 24.229 [3];\nvi)\tshall send the SIP 200 (OK) response to the received SIP MESSAGE as specified in 3GPP TS 24.229 [3] and skip the rest of the steps;\nvii)\tshall generate a SIP MESSAGE request as described in 3GPP TS 24.379 [29], clause 6.3.3.1.20 with the IWF acting as the controlling MCPTT function to indicate successful receipt of the request for emergency alert cancellation\nviii)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body of the SIP MESSAGE request:\nA)\tthe <alert-ind> element set to a value of \"true\";\nB)\tthe <alert-ind-rcvd> element set to a value of true;\nC)\tthe <emergency-ind> element set to a value of \"false\"; and\nD)\tthe <mcptt-client-id> element with the MCPTT client ID that was included in the incoming SIP MESSAGE request; and\nix)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [3]; and\n2)\tif the received SIP MESSAGE request is an authorised request for an MCPTT emergency alert cancellation as specified in clause 6.6.3.1.8.1:\na)\tif the received SIP MESSAGE request contains an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, shall clear the cache of the MCPTT ID of the MCPTT user identified by the <originated-by> element as having an outstanding MCPTT emergency alert;\nb)\tif the received SIP MESSAGE request does not contain an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, clear the cache of the MCPTT ID of the sender of the SIP MESSAGE request as having an outstanding MCPTT emergency alert;\nc)\tif the received SIP MESSAGE request does not contain an <emergency-ind> element or is an unauthorised request for an MCPTT emergency call cancellation as specified in clause 6.6.3.1.8.4, for each of the affiliated but not joined members of the group:\ni)\tshall generate a SIP MESSAGE request notification of the cancellation of the MCPTT user's emergency alert as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11 with the IWF acting as the controlling MCPTT function;\nii)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <mcptt-calling-user-id> element set to the value of the <mcptt-calling-user-id> element in the received SIP MESSAGE request;\niii)\tif the received SIP MESSAGE request contains an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, shall copy the contents of the received <originated-by> element to an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP MESSAGE request;\niv)\tshall include an <alert-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP MESSAGE request; and\nv)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [3];\nd)\tif the received SIP MESSAGE request contains an <emergency-ind> element and is an authorised request for an MCPTT emergency call cancellation as specified in clause 6.6.3.1.8.4 and the in-progress emergency state of the MCPTT group is set to a value of \"true\":\ni)\tshall set the in-progress emergency state of the group to a value of \"false\";\nii)\tcache the information that the MCPTT user has cancelled the outstanding in-progress emergency state of the group;\niii)\tshall generate SIP re-INVITES requests to the other affiliated and joined members of the MCPTT group as specified in clause 6.6.3.1.3. The MCPTT controlling function:\nA)\tfor each affiliated and joined member shall send the SIP re-INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nB)\tUpon receiving a SIP 200 (OK) response to the SIP re-INVITE request shall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\niv)\tfor each of the affiliated but not joined members of the group shall:\nA)\tgenerate a SIP MESSAGE request notification of the cancellation of the MCPTT user's emergency call as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11 with the IWF acting as the controlling MCPTT function;\nB)\tinclude in the application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <mcptt-calling-user-id> element set to the value of the <mcptt-calling-user-id> element in the received SIP MESSAGE request;\nC)\tif the received SIP MESSAGE request contains an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body, copy the contents of the received <originated-by> element to an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP MESSAGE request;\nD)\tinclude in the application/vnd.3gpp.mcptt-info+xml MIME body an <alert-ind> element set to a value of \"false\"; and\nE)\tshall include an <emergency-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP MESSAGE request;\ne)\tshall generate a SIP 200 (OK) response to the received SIP MESSAGE request as specified in 3GPP TS 24.229 [3];\nf)\tshall send the SIP 200 (OK) response to the received SIP MESSAGE as specified in 3GPP TS 24.229 [3].\ng)\tshall generate a SIP MESSAGE request as described in 3GPP TS 24.379 [29], clause 6.3.3.1.20 with the IWF acting as the controlling MCPTT function to indicate successful receipt of the request for emergency alert cancellation;\nh)\tshall include in the application/vnd.3gpp.mcptt-info+xml MIME body, the <alert-ind> element set to a value of \"false\" and the <alert-ind-rcvd> set to \"true\";\ni)\tshall populate the <mcptt-client-id> element with the MCPTT client ID that was included in the incoming SIP MESSAGE request;\nj)\tif the received SIP MESSAGE request contains an <emergency-ind> element of the <mcpttinfo> element set to a value of \"false\":\ni)\tif this is an authorised request for an MCPTT emergency call cancellation as specified in clause 6.6.3.1.8.4, shall include an <emergency-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP MESSAGE request; and\nB)\totherwise, if this is an unauthorised request for an MCPTT emergency call cancellation as specified in clause 6.6.3.1.8.4, and the in-progress emergency state of the group is set to a value of \"true\", shall include an <emergency-ind> element set to a value of \"true\" in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP MESSAGE request; and\nk)\tshall send the SIP MESSAGE request according to the rules and procedures of 3GPP TS 24.229 [3].\nUpon receipt of SIP 2xx responses to the outgoing SIP MESSAGE requests, the IWF performing the controlling role shall follow the procedures specified in 3GPP TS 24.229 [3].\nIf the IWF performing the controlling role needs to generate a SIP MESSAGE for emergency alert cancellation, the IWF performing the controlling role:\n1)\tif the in-progress emergency state of the MCPTT group is set to a value of \"false\", for each of the affiliated but not joined MCPTT members of the group:\na)\tshall generate a SIP MESSAGE request notification of the cancellation of the MCPTT user's emergency alert as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11 with the IWF acting as the controlling MCPTT function;\nb)\tshall include an <originated-by> element in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP MESSAGE request set to the MCPTT ID of the user homed in the IWF;\nc)\tshall include an <alert-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP MESSAGE request; and\nd)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [3];\n2)\tif the in-progress emergency state of the MCPTT group is set to a value of \"true\":\na)\tshall set the in-progress emergency state of the group to a value of \"false\";\nb)\tcache the information that the outstanding in-progress emergency state of the group has been cancelled;\nc)\tshall generate SIP re-INVITE requests to the other affiliated and joined MCPTT members of the MCPTT group as specified in clause 6.6.3.1.3. The IWF performing the controlling function:\ni)\tfor each affiliated and joined MCPTT member shall send the SIP re-INVITE request towards the MCPTT client as specified in 3GPP TS 24.229 [3]; and\nii)\tUpon receiving a SIP 200 (OK) response to the SIP re-INVITE request shall interact with the media plane as specified in 3GPP TS 29.380 [31]; and\nd)\tfor each of the affiliated but not joined MCPTT members of the group shall:\ni)\tgenerate a SIP MESSAGE request notification of the cancellation of the MCPTT user's emergency call as specified in 3GPP TS 24.379 [29], clause 6.3.3.1.11 with the IWF acting as the controlling MCPTT function;\nii)\tinclude in the application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <mcptt-calling-user-id> element set to MCPTT ID of the user home in the IWF;\niii)\tinclude in the application/vnd.3gpp.mcptt-info+xml MIME body an <alert-ind> element set to a value of \"false\"; and\niv)\tshall include an <emergency-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcptt-info+xml MIME body in the outgoing SIP MESSAGE request; and\n3)\tshall send the SIP MESSAGE requests according to the rules and procedures of 3GPP TS 24.229 [3].\nUpon receipt of SIP 2xx responses to the outgoing SIP MESSAGE requests, the IWF performing the controlling role shall follow the procedures specified in 3GPP TS 24.229 [3].",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.6.3.1.8.1",
        "clause_6.6.3.1.8.4",
        "ts_24.379_clause_6.6.3.1.8.4",
        "clause_6.6.3.1.3",
        "ts_24.379_clause_6.3.3.1.11",
        "ts_24.379_clause_6.3.3.1.20",
        "ts_24.229",
        "ts_24.379",
        "ts_29.380"
      ]
    },
    {
      "chunk_id": "ts_29.379_13.1",
      "section_id": "13.1",
      "section_title": "General",
      "content": "It is outside the scope of this specification how the IWF performing the participating role configures a participant homed in the IWF to provide location information or how the IWF performing the participating role explicitly request a participant homed in the IWF to provide location information.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_13.2.1",
      "section_id": "13.2.1",
      "section_title": "General",
      "content": "The IWF performing participating role provides procedures to send a location information report from a participant homed in the IWF.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_13.2.2",
      "section_id": "13.2.2",
      "section_title": "Location reporting configuration",
      "content": "Procedures for configuration of location reporting of participants homed in the IWF are out of scope of the current document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_13.2.3",
      "section_id": "13.2.3",
      "section_title": "Location reporting request",
      "content": "Procedures for requesting participants homed in the IWF to report location information are out of scope of the current document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_13.2.4",
      "section_id": "13.2.4",
      "section_title": "Location information report",
      "content": "The IWF performing the participating role uses location information of users homed in the IWF as appropriate.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.379_14.1.1",
      "section_id": "14.1.1",
      "section_title": "IWF originates Interworking Security Data message",
      "content": "Upon deciding to send an Interworking Security Data message, the IWF:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [3] and IETF RFC 3428 [18];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcptt media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [5];\n3)\tthe IWF shall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [5];\n4)\tshall include an application/vnd.3gpp.mcptt-info+xml MIME body with the <mcpttinfo> element containing the <mcptt-Params> element with the <mcptt-request-uri> element set to the value of the MCPTT ID of the targeted MCPTT user; and\n5)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcptt\" (coded as specified in 3GPP TS 24.229 [3]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [7];\n6)\tshall set the Request-URI to the address of the terminating participating function associated with the MC service ID of the targeted MC service user;\n7)\tshall include a P-Asserted-Identity header field set to the public service identity of the IWF;\n8)\tshall include an application/vnd.3gpp.interworking-data MIME body with the Interworking Security Data message payload as defined in clause 14.2.1;\n9)\tif a security context between the MCPTT client and the IWF needs to be established and the security context does not exist or if the existing security context has expired, procedures in clause 11.2.2 in 3GPP TS 33.180 [29] shall be followed; and\n10)\tsend the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [3].",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_14.2.1",
        "ts_33.180_clause_11.2.2",
        "ts_24.229",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.379_14.1.2",
      "section_id": "14.1.2",
      "section_title": "IWF receives Interworking Security Data message",
      "content": "Upon receiving a \"SIP MESSAGE request for Interworking Security Data message for participating function\", the actions performed by the IWF are out of scope of the present document. The received message, described in clause 14.2, contains an opaque payload, the contents of which are out of scope of the present document.",
      "chunk_type": "general",
      "cross_references": [
        "clause_14.2"
      ]
    },
    {
      "chunk_id": "ts_29.379_14.2.1",
      "section_id": "14.2.1",
      "section_title": "Message definition",
      "content": "This clause specifies the payload to be used when sending an Interworking Security Data message between the IWF and MCPTT clients. The Interworking Security Data (InterSD) message is defined as a MONP message.\nMessage type:\tInterSD-MESSAGE\nDirection:\tIWF to MCPTT client, MCPTT client to IWF\nTable 14.2.1-1: Interworking Security Data message content\nIEI\nInformation Element\nType/Reference\nPresence\nFormat\nLength\nSDS signalling payload message identity\nMessage type3GPP TS 24.282 [30]\nM\nV\n1\nExternal network type\n14.2.2\nM\nV\n1\n7D\nURI of LMR key management functional entity\nURI encoded as specified in IETF RFC 3986 [32]\nO\nTLV-E\n3-x\n78\nPayload\n3GPP TS 24.282 [30], clause 15.2.13 with Payload content type set to 'BINARY'\nO\nTLV-E\n3-x",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.282_clause_15.2.13",
        "table_14.2.1-1",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.379_14.2.2",
      "section_id": "14.2.2",
      "section_title": "External network type",
      "content": "The purpose of the external network type information element is to identify the type of the network represented by the IWF.\nThe value part of the external network type information element is coded as shown in Table 14.2.2-1.\nThe external network type information element is a type 3 information element with a length of 1 octet.\nTable 14.2.2-1: External network type\nBits\n8\n7\n6\n5\n4\n3\n2\n1\n0\n0\n0\n0\n0\n0\n0\n1\nP25\n0\n0\n0\n0\n0\n0\n1\n0\nTETRA\nAll other values are reserved.\nAnnex A (normative):XML Schema\nA.1\tGeneral\nThe XML schema elements defined in the present clause extend those in 3GPP TS 24.379 [29] or other 3GPP technical specifications as noted.\nA.2\tVoid\nAnnex B (normative):IANA registration forms\nB.1\tMedia type for transporting interworking data content\nYour Name:\n<MCC name>\nYour Email Address:\n<MCC email address>\nMedia Type Name:\nApplication\nSubtype name:\nvnd.3gpp.interworking-data\nRequired parameters:\nNone\nOptional parameters:\nNone\nEncoding considerations:\nbinary.\nSecurity considerations:\nGeneral mechanisms for privacy and integrity protection of protocol parameters exist. Those mechanisms as well as authentication and further security mechanisms are described in 3GPP TS 24.229.\nSecurity mechanisms specific to this media type are dependent upon the business and trust relationship between the Interworking function operator, the mission critical services operator and the SIP carrier operator. Mission critical services operators may wish to encrypt and integrity protect the content transported by this media type indepedently of mechanisms provided by the transport layer. Such mechanisms have been specified by 3GPP SA3.\nThe information transported in this media type does not include active or executable content.\nThis media type may include provisions for directives that institute actions on a recipient's files or other resources.\nThis media type does not include provisions for directives that institute actions that, while not directly harmful to the recipient, may result in disclosure of information that either facilitates a subsequent attack or else violates a recipient's privacy in any way.\nThis media type does not employ compression.\nInteroperability considerations:\nThe content transported within this media type does not need to be interpreted by a server as specific decisions are made based on the signalling content (e.g. store disposition history). The final destination point of the content is the terminating UE. Each UE and server that handles the content transported using this media type shall understand the definition of the messages and protocol elements as defined in 3GPP TS 29.379. Any messages and protocol elements not defined by 3GPP TS 29.379 shall be ignored by the recipient UE or server.\nPublished specification:\n3GPP TS 29.379 \"Mission Critical Push To Talk (MCPTT) call control interworking with LMR systems; Protocol specification\", available via http://www.3gpp.org/specs/numbering.htm.\nApplication Usage:\nApplications supporting the mission critical interworking with LMR systems procedures as described in the published specification. This media type shall contain LMR specific content that is related to the payload that is delivered to a terminating user or an application of the terminating user.\nFragment identifier considerations:\nNone.\nRestrictions on usage:\nNone\nProvisional registration? (standards tree only):\nN/A\nAdditional information:\n1.\tDeprecated alias names for this type: none\n2.\tMagic number(s): none\n3.\tFile extension(s): none\n4.\tMacintosh File Type Code(s): none\n5.\tObject Identifier(s) or OID(s): none\nIntended usage:\nCommon\nPerson to contact for further information:\n-\tName: <MCC name>\n-\tEmail: <MCC email address>\n-\tAuthor/Change controller:\ni)\tAuthor: 3GPP CT1 Working Group/3GPP_TSG_CT_WG1@LIST.ETSI.ORG\nii)\tChange controller: <MCC name>/<MCC email address>\nAnnex C (informative):Change history\nChange history\nDate\nMeeting\nTDoc\nCR\nRev\nCat\nSubject/Comment\nNew version\n2019-04\nInitial version\n0.0.0\n2019-05\nContains agreed P-CRs from CT1#117: C1‑193606, C1‑193609, C1‑193085, C1‑193093, C1‑193611, C1‑193612, C1‑193613, C1‑193614, C1‑193615, C1‑193616, C1‑193674, C1‑193675, C1‑193676\n0.1.0\n2019-06\nCT#84\nCP-191150\nPresentation to TSG CT for information\n1.0.0\n2019-06\nRapporteur's fixes to bad references and editorials.\n1.0.1\n2019-08\nContains agreed P-CRs from CT1#117: C1‑194202, C1‑194204, C1‑194206, C1‑194208, C1‑194209, C1‑194212, C1‑194802, C1‑194804, C1‑195016.\n1.1.0\n2019-10\nContains agreed P-CRs from CT1#120: C1‑196207, C1‑196870\n1.2.0\n2019-11\nContains agreed P-CRs from CT1#121: C1‑198208, C1‑198238, C1‑198662, C1‑198663, C1‑198845\n1.3.0\n2019-12\nCT#86\nCP-193150\nPresentation to TSG CT for approval\n2.0.0\n2019-12\nCT#86\nCP-193298\nA title corrected\n2.0.1\n2019-12\nCT#86\nVersion 16.0.0 created after approval\n16.0.0\n2020-09\nCT#89e\nCP-202161\n0004\nF\nCorrect XML schema\n16.1.0\n2020-09\nCT#89e\nCP-202162\n0007\n1\nF\nCorrect MIME Subtype name in Annex B.1\n16.1.0\n2020-09\nCT#89e\nCP-202252\n0005\n1\nB\nAffiliation on behalf of the multiple LMR users\n17.0.0\n2020-09\nCT#89e\nCP-202180\n0008\nD\nEditorial – SIP URI\n17.0.0\n2020-09\nCT#89e\nCP-202180\n0009\nF\nRemove EN in 10.1.4.5.1\n17.0.0\n2020-09\nCT#89e\nCP-202252\n0010\n2\nB\nAdd Conference Event Package to IWF\n17.0.0\n2020-12\nCT#90e\nCP-203195\n0012\nA\nInter-SD message payload format alignment across domains\n17.1.0\n2020-12\nCT#90e\nCP-203195\n0014\nA\nRemove EN in Annex B.1\n17.1.0\n2021-03\nCT#91e\nCP-210123\n0015\nF\nRemove private-call-parameters\n17.2.0\n2021-09\nCT#93e\nCP-212121\n0016\n1\nA\nRemove EN on end-to-end security\n17.3.0\n2021-09\nCT#93e\nCP-212121\n0017\n1\nA\nRemove ENs\n17.3.0\n2022-03\nCT#95e\nCP-220230\n0021\n1\nA\nRemoval of Editor's Notes\n17.4.0\n2022-03\nCT#95e\nCP-220281\n0020\n1\nB\nAdditional private call rejection reasons\n17.4.0\n2022-06\nCT#96\nCP-221201\n0024\n2\nA\nRemoval of ENs\n17.5.0\n2024-04\n-\n-\n-\n-\n-\nUpdate to Rel-18 version (MCC)\n18.0.0",
      "chunk_type": "general",
      "cross_references": [
        "table_14.2.2-1",
        "ts_24.379",
        "ts_24.229",
        "ts_29.379"
      ]
    }
  ]
}
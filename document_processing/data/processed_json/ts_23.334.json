{
  "metadata": {
    "specification_id": "ts_23.334",
    "version": "18.1.0",
    "title": "3GPP TS 23.334",
    "file_path": "/content/drive/MyDrive/RAG_thesis/data/23_series/23334-i10/23334-i10.docx"
  },
  "export_info": {
    "export_date": "2025-07-26T09:33:52.078252",
    "total_chunks": 199
  },
  "chunks": [
    {
      "chunk_id": "ts_23.334_1",
      "section_id": "1",
      "section_title": "Scope",
      "content": "Annex G of 3GPP TS 23.228 [2] gives out an IMS Application Level Gateway (IMS-ALG) and IMS Access Media Gateway (IMS-AGW) based reference model to support NAPT-PT, gate control and traffic policing between IP-CAN and IMS domain.\nFigure 1.1: Scope of the specification\nFigure 1.1 illustrates the reference model for Iq:\n-\tthe dashed line represents the IP signalling-path with SIP (at Gm) as call/session control protocol between the UE and the P-CSCF (IMS-ALG);\n-\tthe bold, horizontal line represents the IP media-path (also known as (IP) bearer-path or (IP) data-path; the notion 'media' is used as generic term for \"IP application data\"); and\n-\tthe vertical line represents the Iq control-path with H.248 as gateway/policy control protocol between the IMS-ALG and the IMS-AGW (H.248 messages are transported over IP).\nThe Iq reference point is between the P-CSCF (IMS-ALG) and the IMS-AGW. It conveys the necessary information that is needed to allocate, modify and release (IP) transport addresses.\nThe present document defines the stage 2 description for the Iq reference point. The stage 2 shall cover the information flow between the P-CSCF (IMS-ALG) and IMS-AGW. The protocol used over the Iq interface is the gateway control protocol according ITU-T Recommendation H.248 (which is specified for Iq by an H.248 profile according 3GPP TS 29.334 [3]).",
      "chunk_type": "general",
      "cross_references": [
        "figure_1.1",
        "ts_23.228",
        "ts_29.334"
      ]
    },
    {
      "chunk_id": "ts_23.334_2",
      "section_id": "2",
      "section_title": "References",
      "content": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non‑specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.228: \"IP Multimedia Subsystem (IMS), stage 2\".\n[3]\t3GPP TS 29.334: \"IMS Application Level Gateway (IMS-ALG) – IMS Access Gateway (IMS-AGW) Iq interface, stage 3\".\n[4]\tIETF RFC 2663: \"IP Network Address Translator (NAT) Terminology and Considerations\".\n[5]\t3GPP TS 32.260: \"Telecommunication management; Charging management; IP Multimedia Subsystem (IMS) charging\".\n[6]\tIETF RFC 3556: \"Session Description Protocol (SDP) Bandwidth Modifiers for RTP Control Protocol (RTCP) Bandwidth\".\n[7]\tIETF RFC 3605: \"Real Time Control Protocol (RTCP) attribute in Session Description Protocol (SDP)\".\n[8]\t3GPP TS 23.205: \"Bearer independent circuit-switched core network; Stage 2\".\n[9]\tITU-T Recommendation H.248.1 (05/2002): \"Gateway Control Protocol: Version 2\" including the Corrigendum1 for Version 2 (03/04).\n[10]\tIETF RFC 2216: \"Network Element Service Template\".\n[11]\t3GPP TS 24.229: \"IP Multimedia Call Control Protocol based on SIP and SDP\".\n[12]\t3GPP TS 33.328: \"IMS Media Plane Security\".\n[13]\tIETF RFC 4568: \"Session Description Protocol (SDP) Security Descriptions for Media Streams\".\n[14]\tIETF RFC 3711: \"The Secure Real-time Transport Protocol (SRTP)\".\n[15]\tIETF RFC 5124: \"Extended Secure RTP Profile for Real-time Transport Control Protocol (RTCP)-Based Feedback (RTP/SAVPF)\".\n[16]\tIETF RFC 3168: \"The Addition of Explicit Congestion Notification (ECN) to IP\".\n[17]\tIETF RFC 6679: \"Explicit Congestion Notification (ECN) for RTP over UDP\".\n[18]\t3GPP TS 23.237: \"IP Multimedia subsystem (IMS) Service Continuity; Stage 2\".\n[19]\t3GPP TS 24.237: \"IP Multimedia subsystem (IMS) Service Continuity; Stage 3\".\n[20]\t3GPP TS 29.162: \"Interworking between the IM CN subsystem and IP networks\".\n[21]\t3GPP TS 26.114: \"IP Multimedia Subsystem (IMS); Multimedia Telephony; Media handling and interaction\".\n[22]\t3GPP TS 22.153: \"Multimedia Priority Service\".\n[23]\tIETF RFC 5285: \"A General Mechanism for RTP Header Extensions\".\n[24]\tIETF RFC 6236: \"Negotiation of Generic Image Attributes in the Session Description Protocol (SDP)\".\n[25]\tIETF RFC 4975: \"The Message Session Relay Protocol (MSRP)\".\n[26]\tIETF RFC 6714: \"Connection Establishment for Media Anchoring (CEMA) for the Message Session Relay Protocol (MSRP)\".\n[27]\tIETF RFC 4583: \"Session Description Protocol (SDP) Format for Binary Floor Control Protocol (BFCP) Streams\".\n[28]\tVoid.\n[29]\tIETF RFC 793: \"Transmission Control Protocol – DARPA Internet Program – Protocol Specification\".\n[30]\tIETF RFC 4145: \"TCP-Based Media Transport in the Session Description Protocol (SDP)\".\n[31]\tIETF RFC 4582: \"The Binary Floor Control Protocol (BFCP)\".\n[32]\tVoid.\n[33]\tIETF RFC 7345: \"UDP Transport Layer (UDPTL) over Datagram Transport Layer Security (DTLS)\".\n[34]\tVoid\n[35]\tGSM Association RCC.07: \"Rich Communication Suite 5.1 Advanced Communications Services and Client Specification, Version 2.0, 03 May 2013\".\n[36]\tGSM Association RCC.07: \"Rich Communication Suite 5.1 Advanced Communications Services and Client Specification, Version 3.0, 25 September 2013\".\n[37]\tVoid\n[38]\tITU-T Recommendation H.248.84 (07/2012): \"Gateway control protocol: NAT-traversal for peer-to-peer services\".\n[39]\tVoid.\n[40]\tVoid.\n[41]\tVoid.\n[42]\tIETF RFC 5763: \"Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)\".\n[43]\tIETF RFC 5764: \"Datagram Transport Layer Security (DTLS) Extension to Establish Keys for the Secure Real-time Transport Protocol (SRTP)\".\n[44]\t3GPP TS 24.371: \"Web Real-Time Communications (WebRTC) client access to the IP Multimedia (IM) Core Network (CN) subsystem; Protocol specification\".\n[45]\tIETF RFC 6135: \"An Alternative Connection Model for the Message Session Relay Protocol (MSRP)\".\n[46]\tOMA-TS-CPM_Conversation_Function-V2_0-20150113-C: \"CPM Conversation Functions, Candidate Version 2.0 – 13 Jan 2015\".\n[47]\tIETF RFC 5746: \"Transport Layer Security (TLS) Renegotiation Indication Extension\".\n[48]\t3GPP TS 33.310: \"Network Domain Security (NDS); Authentication Framework (AF)\".\n[49]\tIETF RFC 7675: \"Session Traversal Utilities for NAT (STUN) Usage for Consent Freshness\".\n[50]\tIETF RFC 6716: \"Definition of the Opus Audio Codec\".\n[51]\t3GPP TS 26.441: \"Codec for Enhanced Voice Services (EVS); General Overview\".\n[52]\t3GPP TS 26.445: \"Codec for Enhanced Voice Services (EVS); Detailed Algorithmic Description\".\n[53]\tIETF RFC 4566: \"SDP: Session Description Protocol\".\n[54]\tIETF RFC 4867: \"RTP Payload Format and File Storage Format for the Adaptive Multi-Rate (AMR) and Adaptive Multi-Rate Wideband (AMR-WB) Audio Codecs\".\n[55]\tIETF RFC 4566: \"SDP: Session Description Protocol\".\n[56]\tIETF RFC 7587: \"RTP Payload Format for the Opus Speech and Audio Codec\".\n[57]\tIETF RFC 6544: \"TCP Candidates with Interactive Connectivity Establishment (ICE)\".\n[58]\tIETF RFC 4571: \"Framing Real-time Transport Protocol (RTP) and RTP Control Protocol (RTCP) Packets over Connection-Oriented Transport\".\n[59]\tIETF RFC 6947: \"The Session Description Protocol (SDP) Alternate Connectivity (ALTC) Attribute\".\n[60]\tIETF RFC 5761: \"Multiplexing RTP Data and Control Packets on a Single Port\".\n[61]\tIETF RFC 8831: \"WebRTC Data Channels\".\n[62]\tIETF RFC 8873: \"Message Session Relay Protocol (MSRP)\".\n[63]\tIETF RFC 4960: \"Stream Control Transmission Protocol\".\n[64]\tIETF RFC 8841: \"Session Description Protocol (SDP) Offer/Answer Procedures for Stream Control Transmission Protocol (SCTP) over Datagram Transport Layer Security (DTLS) Transport\".\n[65]\tIETF RFC 8864: \"Negotiation Data Channels Using the Session Description Protocol (SDP)\".\n[66]\tIETF RFC 5939: \"Session Description Protocol (SDP) Capability Negotiation\".\n[67]\tIETF RFC 6871: \"Session Description Protocol (SDP) Media Capabilities Negotiation\".\n[68]\tIETF RFC 4573: \"MIME Type Registration for RTP Payload Format for H.224\".\n[69]\tITU-T Recommendation H.224 (01/2005): \"A real time control protocol for simplex applications using the H.221 LSD/HSD/MLP channels\".\n[70]\tITU-T Recommendation H.281 (11/1994): \"A far end camera control protocol for videoconferences using H.224\".\n[71]\tIETF RFC 8858: \"Indicating Exclusive Support of RTP and RTP Control Protocol (RTCP) Multiplexing Using the Session Description Protocol (SDP)\".\n[72]\tIETF RFC 8035: \"Session Description Protocol (SDP) Offer/Answer Clarifications for RTP/RTCP Multiplexing\".\n[73]\tITU‑T Recommendation T.140 (02/98): \"Text conversation presentation protocol\".\n[74]\tIETF RFC 4103: \"RTP Payload for Text Conversation\".\n[75]\tIETF RFC 8865: \"T.140 Real-Time Text Conversation over WebRTC Data Channels\".\n[76]\tVoid.\n[77]\tIETF RFC 4585: \"Extended RTP Profile for Real-time Transport Control Protocol (RTCP)-Based Feedback (RTP/AVPF)\".\n[78]\tIETF RFC 5104: \"Codec Control Messages in the RTP Audio-Visual Profile with Feedback (AVPF)\".\n[79]\tIETF RFC 7728: \"RTP Stream Pause and Resume\".\n[80]\tIETF RFC 8122: \"Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)\".\n[81]\tIETF RFC 8842: \"Session Description Protocol (SDP) Offer/Answer Considerations for Datagram Transport Layer Security (DTLS) and Transport Layer Security (TLS)\".\n[82]\tIETF RFC 8445: \"Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal\".\n[83]\tIETF RFC 8839: \"Session Description Protocol (SDP) Offer/Answer Procedures for Interactive Connectivity Establishment (ICE)\".\n[84]\tIETF RFC 8489: \"Session Traversal Utilities for NAT (STUN)\".\n[85]\tIETF RFC 8656: \"Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)\".\n[86]\t3GPP TS 26.250: \"Codec for Immersive Voice and Audio Services – General Overview\".\n[87]\t3GPP TS 26.253: \"Codec for Immersive Voice and Audio Services – Detailed Algorithmic Description incl. RTP payload format and SDP parameter definitions\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905",
        "ts_23.228",
        "ts_29.334",
        "ts_32.260",
        "ts_23.205",
        "ts_24.229",
        "ts_33.328",
        "ts_23.237",
        "ts_24.237",
        "ts_29.162",
        "ts_26.114",
        "ts_22.153",
        "ts_24.371",
        "ts_33.310",
        "ts_26.441",
        "ts_26.445",
        "ts_26.250",
        "ts_26.253"
      ]
    },
    {
      "chunk_id": "ts_23.334_3.1",
      "section_id": "3.1",
      "section_title": "Definitions",
      "content": "For the purposes of the present document, the terms and definitions given in TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in TR 21.905 [1].\nEnd-to-access edge security: media protection extending between an IMS UE and the first IMS core network node in the media path without being terminated by any intermediary node.\nEnd-to-end security: media protection between two IMS UEs without being terminated by any intermediary node.\nFull ICE: The full implementation of the Interactive Connectivity Establishment (ICE) specified in IETF RFC 8445 [82].\nICE lite: The lite implementation of the Interactive Connectivity Establishment (ICE) specified in IETF RFC 8445 [82].\nLocal (near-end) NAPT control: the operation of providing network address mapping information and NAPT policy rules to a near-end NAT in the media flow.\nNAT-PT/NAPT-PT: see definition in 3GPP TS 23.228 [2].\nNAPT control and NAT traversal: controls network address translation for both near-end NA(P)T and far-end NA(P)T\nNetwork Address Translation (NA(P)T): see definition in 3GPP TS 23.228 [2].\nRemote (far-end) NAT traversal: the operation of adapting the IP addresses so that the packets in the media flow can pass through a far-end (remote) NAT.\nRTP / RTCP transport multiplexing: a single IP transport (L4) port for RTP and RTCP packets.\nTLS-client: the entity that initiates a TLS session establishment to a server.\nTLS-server: the entity that responds to requests for TLS session establishment from clients.\nTLS endpoint: either a TLS-client or a TLS-server.\nConvention:\nWherever the term NAT is used in this specification, it may be replaced by NA(P)T or NA(P)T-PT.\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.237 [18] apply:\nAccess Leg\nAccess Transfer Control Function (ATCF)\nAccess Transfer Gateway (ATGW)\nRemote Leg\nTarget Access Leg\nSource Access Leg",
      "chunk_type": "definition",
      "cross_references": [
        "ts_21.905",
        "ts_23.228",
        "ts_23.237"
      ]
    },
    {
      "chunk_id": "ts_23.334_3.2",
      "section_id": "3.2",
      "section_title": "Symbols",
      "content": "For the purposes of the present document, the following symbols apply:\nIq\tInterface between the IMS Application Level Gateway and the IMS Access Media Gateway",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_3.3",
      "section_id": "3.3",
      "section_title": "Abbreviations",
      "content": "For the purposes of the present document, the abbreviations given in TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in TR 21.905 [1].\nALTC\tAlternate Connectivity\nAMR\tAdaptive Multi-Rate\nAMR-WB\tAdaptive Multi-Rate - WideBand\nAMR-WB IO\tAdaptive Multi-Rate - WideBand Inter-operable Mode, included in the EVS and IVAS codecs\nAPP\tAPPlication-defined RTCP packet\nATCF\tAccess Transfer Control Function\nATGW\tAccess Transfer Gateway\nBFCP\tBinary Floor Control Protocol\nCCM\tCodec Control Messages\nCVO\tCoordination of Video Orientation\nDBI\tDelay Budget Information\nDC\tData Channel\nDTLS\tDatagram Transport Layer Security\nDTX\tDiscontinuous Transmission\ne2ae security\tEnd-to-access-edge security\ne2e security\tEnd-to-end security\nECN\tExplicit Congestion Notification\nECN-CE\tECN Congestion Experienced\neIMS-AGW\tIMS Access Gateway enhanced for WebRTC\neP-CSCF\tP-CSCF enhanced for WebRTC\nEVS\tEnhanced Voice Services\nFECC\tFar End Camera Control\nFIR\tFull Intra Request\nGTT\tGlobal Text Telephony\nICE\tInteractive Connectivity Establishment\nIMS-AGW\tIMS Access Media Gateway\nIMS-ALG\tIMS Application Level Gateway\nIM CN\tIMS Core Network\nIVAS\tImmersive Voice and Audio Services\nMSRP\tMessage Session Relay Protocol\nMTSI\tMultimedia Telephony Service for IMS\nNA(P)T\tNetwork Address and optional Port Translation\nNAPT\tNetwork Address Port Translation\nNAT\tNetwork Address Translation\nNA(P)T-PT NAT Address (and optional Port-) Translation and Protocol Translation\nP-CSCF\tProxy-CSCF\nPI\tProcessing Information\nROI\tRegion of Interest\nRTCP\tRTP Control Protocol\nRTP\tReal-time Transport Protocol\nSDPCapNeg\tSDP Capability Negotiation\nSRTP\tSecure Real-time Transport Protocol\nSRVCC\tSingle Radio Voice Call Continuity\nSTUN\tSession Traversal Utilities for NAT\nTLS\tTransport Layer Security\nTMMBN\tTemporary Maximum Media Stream Bit Rate Notification\nTMMBR\tTemporary Maximum Media Stream Bit Rate Request\nTURN\tTraversal Using Relay NAT\nUDPTL\tUser Datagram Protocol Transport Layer\nURN\tUniform Resource Name\nWebRTC\tWeb Real-Time Communication\nWIC\tWebRTC IMS Client\nWWSF\tWebRTC Web Server Function",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905"
      ]
    },
    {
      "chunk_id": "ts_23.334_4.1",
      "section_id": "4.1",
      "section_title": "Reference architecture",
      "content": "The reference architecture for the IMS-ALG and the IMS-AGW when  NAT is invoked between the UE and the IMS domain is shown  in figure 4.1.1 below.\nFigure 4.1.1:  Reference Architecture with NAT invoked between the UE and the IMS domain\nSee 3GPP TS 23.228 [2] Annexes G.1 and G.2 for a comprehensive description of the reference models.\nThe reference architecture for the IMS-ALG and the IMS-AGW supporting the ATCF/ATGW function is shown in figure 4.1.2 below.\nFigure 4.1.2: Reference Architecture for IMS-ALG/IMS-AGW with ATCF/ATGW function\nSee 3GPP TS 23.237 [18] clause 5.2 for a comprehensive description of the reference model.\nThe reference architecture for the IMS-ALG and IMS-AGW supporting Interactive Connectivity Establishment (ICE) is shown in figure 4.1.3, for the case when both the signalling and media traverses NAT devices. There might be an ICE process towards access network domain and/or an ICE process towards core network domain. Both ICE processes are independent of each other. The network entities that support Session Traversal Utilities for NAT (STUN) and Traversal Using Relays NAT (TURN) are described in IETF RFC 8489 [84] and IETF RFC 8656 [85] respectively.\nNOTE 1:\tIf the IMS-AGW only supports ICE lite, it will only contain a STUN server.\nNOTE 2:\tThe IMS-AGW and IMS-ALG may support ICE only towards the served UE, and will then only contain a STUN client/server and ICE support on related terminations.\nNOTE 3:\tThe TURN server is a deployment option but not required for all ICE deployments.\nNOTE 4:\tThe separate STUN server is used by the served UE while it gathers ICE candidates. The STUN server in the IMS-AGW is used to answer ICE connectivity checks.\nFigure 4.1.3: Reference architecture for ICE\nThe reference architecture for the P-CSCF enhanced for WebRTC (eP-CSCF) and the IMS-AGW enhanced for WebRTC (eIMS-AGW) to support WebRTC client access to IMS is shown in figure 4.1.4 as below, see Annex U in 3GPP TS 23.228 [2] for a comprehensive description of the reference model.\nFigure 4.1.4:  Reference Architecture for eP-CSCF/eIMS-AGW supporting WebRTC access to IMS\nNOTE 1:\tThe presence of dashed elements in the figure depends on the configuration.\nPCC functional elements are present only for EPC access with QoS.\nThe corresponding PCC elements for fixed access are also optionally supported but not shown.\nThe NAT in figure 4.1.4 is meant for non-cellular access to IMS.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.237_clause_5.2",
        "figure_4.1.1",
        "figure_4.1.2",
        "figure_4.1.3",
        "figure_4.1.4",
        "ts_23.228",
        "ts_23.237"
      ]
    },
    {
      "chunk_id": "ts_23.334_4.2",
      "section_id": "4.2",
      "section_title": "NAT Function",
      "content": "An operator may need NAT function between UE and IMS domain. Such function can be provided by the IMS-AGW and can be called local (near-end) NAT or IM CN hosted NAT (see clause 5.2). There can also be an independent NAT device between UE and IMS domain (see clause 5.4), referred as remote (far end) NAT. Thus the IMS-AGW shall support remote NA(P)T traversal.\nFigure 4.1.1 illustrates the particular IP media-path scenario with both a remote NAT and local NAT function. Each NAT function is partitioning an IP domain into two address domains, or partitioning the used IP address space (realm) into two realms.\nThe reference architecture of Figure 4.1.1 may be mapped on various network scenarios, like e.g. to three IPv4 realms, indicated by a) IP-CAN (connectivity access network), b) (Media) Access Domain and c) (Media) IM CN domain. If there would not be any remote NAT device between the UE and IMS-AGW, then there would be just two IP domains (a and c).\nThe two types of NATs are also typically different from control perspective: local (near-end) NAT can be controlled by the operators directly, and remote (far-end) NAT that cannot be controlled by the operators directly.\nThe support of local NAT is thus implicitly leading to the requirement for IP realm indication at Iq (see clause 5.3).\nThe edge node of the IP-CAN may be a remote (far-end) NAT device (see Figure 4.1.1). This NAT device provides NAT or NAPT or NA(P)T-PT for IP traffic in the media-path and signalling path (e.g. IP network addresses and possibly L4 transport port values may be translated of SIP Gm messages).\nThe remote NAT device cannot be directly controlled by the operators of the (Media) Access and IP CN domain. The IMS-ALG is consequently lacking the direct information with regards to the applied NAT bindings by the remote NAT device.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.2",
        "clause_5.4",
        "clause_5.3",
        "figure_4.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_4.3",
      "section_id": "4.3",
      "section_title": "ATCF/ATGW Function",
      "content": "The ATCF/ATGW functions may be supported by the IMS-ALG/IMS-AGW when SRVCC enhanced with ATCF is used. In this case, the Iq reference point is used for IMS sessions that the IMS-ALG (ATCF) decides to anchor at the IMS-AGW (ATGW) to provide the following functions:\n-\treservation and configuration of IMS-AGW (ATGW) resources for media anchoring during PS session origination or termination;\n-\treconfiguration of IMS-AGW (ATGW) resources during access transfer to the CS domain;\n-\trelease of IMS-AGW (ATGW) resources upon completion of the access transfer or release of the session;\n-\tmedia transcoding if the media that was used prior to the access transfer is not supported by the MSC server;\n-\tIP version interworking if different IP versions are used between the access and the remote legs;\n-\tIndication of IP realm during allocation of transport addresses/resources (the PS and CS accesses may be reachable via different IP realms);\n-\tthe ability to configure ECN properties towards the transferred to Access if ECN is supported/requested;\n-\tthe ability to reconfigure the ECN mode e.g. from ECN transparent to ECN endpoint towards the IMS CN if ECN transparent cannot be maintained after access transfer to the CS domain;\n-\tprovide priority treatment to calls identified as Multimedia Priority Service (see 3GPP TS 22.153 [22]).\nSee 3GPP TS 23.237 [18] and 3GPP TS 24.237 [19] for a comprehensive description of the ATCF and ATGW functions.",
      "chunk_type": "general",
      "cross_references": [
        "ts_22.153",
        "ts_23.237",
        "ts_24.237"
      ]
    },
    {
      "chunk_id": "ts_23.334_4.4",
      "section_id": "4.4",
      "section_title": "eP-CSCF/eIMS-AGW Function",
      "content": "The Iq reference point is used between the P-CSCF enhanced for WebRTC (eP-CSCF) and the IMS-AGW enhanced for WebRTC (eIMS-AGW), with the following additional functions:\n-\tmedia plane interworking extensions as needed for WICs;\n-\tmedia security of type \"e2ae\" (as specified in 3GPP TS 33.328 [12]) for data channels using DTLS-SCTP.\n-\tNAT traversal support including ICE;\n-\tthe ability to perform any transcoding needed for audio and video codecs supported by the browser; and\n-\ttransport level interworking between data channels and other transport options supported by IMS.\nSee 3GPP TS 23.228 [2] Annex U for a comprehensive description of the eP-CSCF and eIMS-AGW functions.",
      "chunk_type": "general",
      "cross_references": [
        "ts_33.328",
        "ts_23.228"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.1",
      "section_id": "5.1",
      "section_title": "General",
      "content": "A single IMS-ALG may control one or multiple IMS-AGW(s).",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.2",
      "section_id": "5.2",
      "section_title": "Gate Control & Local NAT",
      "content": "The IMS-ALG shall provide the NAPT control function, i.e. obtain the address binding information (according to IETF RFC 2663 [4]) and perform the NAPT policy control along with gate control (i.e. instruct the opening/closing of a gate).\nThe IMS-ALG shall request the IMS-AGW to allocate transport addresses/resources to enable media to traverse the IMS-AGW. The IMS-ALG may indicate the corresponding IP realm to the IMS-AGW – see clause 5.3. The IMS-AGW shall provide the corresponding external transport addresses to the IMS-ALG.\nTerminations for the Iq interface may be pre-defined with different levels of granularity for specific IP ports, interfaces, or groups of interfaces. These may then be defined as an IP realm (see clause 5.3) known by both the IMS-ALG and the IMS-AGW, however IP Realms may also be defined for multiple physical interfaces. In order to efficiently report a failure affecting a large number of terminations associated to specific physical interfaces, the IMS-AGW shall, when allocating a new termination, return to the IMS-ALG an associated Interface ID.\nAn IMS-AGW not supporting this procedure may allocate the same Interface ID for all IP terminations.\nAn IMS-AGW supporting the Termination Out-of-Service procedure (see clause 6.1.15) shall maintain a local mapping of Interface ID to its internal resources.\nThe IMS-AGW shall provide the NAPT enforcement function, i.e. change the address and port number of the media packets as they traverse the IMS-AGW, along with gate control (i.e. open/close a gate under the control of the IMS-ALG).\nThe IMS-AGW may provide IP version interworking. If the IP version interworking is performed and the IMS-ALG passes an SDP offer or answer, the IMS-ALG may adjust any SDP bandwidth information contained in the SDP offer or answer in accordance with 3GPP TS 29.162 [20] clause 9.1.5.\nThe IMS-ALG shall request the IMS-AGW to release its transport resources at the end of a session.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_5.3",
        "clause_6.1.15",
        "ts_29.162_clause_9.1.5",
        "ts_29.162"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.3",
      "section_id": "5.3",
      "section_title": "IP realm indication and availability",
      "content": "The IMS-ALG and the IMS-AGW shall support IP realm indication.\nThe IMS-ALG, when requesting the allocation of transport resources at the IMS-AGW, may indicate the correspondent IP realm to the IMS-AGW. The IMS-AGW shall assign the IP termination in the IP realm indicated. The same IP realm shall be applied to all media streams associated with the termination. The IP realm identifier cannot be changed after the initial assignment.\nA default IP realm may be configured such that if the IMS-AGW has not received the IP realm identifier and the IMS-AGW supports multiple IP realms then the default IP realm shall be used.\nIn order to prevent the IMS-ALG requesting an unavailable IP Realm, the IMS-ALG may audit the list of currently available realms on the IMS-AGW and may request the IMS-AGW to report any changes to that list as they occur over time.\nThe monitoring of IP realm availability is optional and if supported by IMS-AGW may be requested by the IMS-ALG.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.4",
      "section_id": "5.4",
      "section_title": "Remote NAT traversal support",
      "content": "The IMS-ALG and the IMS-AGW shall support remote NA(P)T traversal support using procedures according to the present clause. In addition they may support remote NA(P)T traversal support using Interactive Connectivity Establishment (ICE) according to clause 5.17.\nThe IMS-ALG is responsible for determining whether there is a remote NAT device (the mechanism by which this achieved is out of scope of the current document).\nIf a remote NAT device is present, the IMS-ALG shall request the IMS-AGW to perform latching or re-latching when requesting the IMS-AGW to reserve transport addresses/resources.\nIf remote NAT is applicable, the IMS-AGW shall not use the remote media address/port information (supplied by the IMS-ALG) as the destination address for outgoing media. Instead, the IMS-AGW shall dynamically learn the required destination address via the source address/port of incoming media. This mechanism is known as \"latching\".\nWhen remote NAT Traversal is applied to a stream associated with multiple flows (e.g. RTP and RTCP), the IMS-AGW shall perform individual latching and/or re-latching on the various flows. This means that an RTP and an RTCP flow of a single stream can be latched to different remote addresses and/or ports.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_5.17"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.5",
      "section_id": "5.5",
      "section_title": "Remote Source Address/Port Filtering",
      "content": "The IMS-ALG may support and the IMS-AGW shall support policing of the remote source address/port of incoming media flow(s).\nThe IMS-ALG may determine that the source address/port of received media packets should be policed.\nWhen the IMS-ALG requests the IMS-AGW to reserve transport addresses/resources, the IMS-ALG may indicate to the IMS-AGW that policing of source address and/or port of received media packets is required.\nIf such policing is applicable, the IMS-AGW shall check the source address and/or port of all received media packets and silently discard any packets that do not conform to the expected source address and/or port.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.6",
      "section_id": "5.6",
      "section_title": "Traffic Policing",
      "content": "The IMS-ALG may support traffic policing of incoming media flows.\nThe IMS-AGW shall support traffic policing of the maximum average bitrate, defined as sustainable data rate (see IETF RFC 2216 [10]) of incoming media flows and may support traffic policing of the peak data rate of incoming media flows.\nThe IMS-ALG may require the IMS-AGW to police the media flows to ensure that they conform to the expected data rates.\nWhen the IMS-ALG requests the IMS-AGW to reserve transport addresses/resources, the IMS-ALG may indicate to the IMS-AGW that policing of the related media streams is required and provide traffic policing related parameters as detailed in clause  6.2.5.\nIf such policing is requested, the IMS-AGW shall police the corresponding media streams as detailed in clause 6.2.5 by measuring the data rate for the received packets within that media stream. If the permissible data rate provided by the IMS-ALG is exceeded, the IMS-AGW shall discard packets to reduce their data rate to the permissible data rate.\nFor RTP flows where RTCP resources are reserved together with the RTP resources (see clause 5.9), the permissible data rate shall include the bandwidth used by RTP and RTCP together.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.2.5",
        "clause_5.9"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.7",
      "section_id": "5.7",
      "section_title": "Hanging Termination Detection",
      "content": "The IMS-ALG and the IMS-AGW shall support detection of hanging termination.\nThe IMS-ALG, when requesting the IMS-AGW to reserve an AGW connection point, shall indicate to the IMS-AGW to perform detection of hanging terminations.\nThe IMS-AGW shall determine a termination to be hanging if there is no signalling sent/received within a specified period.\nOn being informed of the hanging termination, the IMS-ALG shall check/determine whether the cited termination is valid and initiate any appropriate corrective action, e.g. release an invalid termination.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.8",
      "section_id": "5.8",
      "section_title": "QoS Packet Marking",
      "content": "The IMS-ALG may support and the IMS-AGW shall support control via the Iq interface of the setting of the DiffServ Code Point (DSCP) for media packets sent on a termination.\nWhen the IMS-ALG requests the IMS-AGW to reserve transport addresses/resources, the IMS-ALG may indicate to the IMS-AGW that the DSCP of outgoing media packets shall be explicitly set or copied from the DSCP of the corresponding received packet.\nIf such modification of the DSCP is required by the IMS-ALG, the IMS-AGW shall set the DSCP for outgoing packets on a termination.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.9.1",
      "section_id": "5.9.1",
      "section_title": "General",
      "content": "The IMS-ALG and the IMS-AGW shall support control via the Iq interface of the specific RTCP behaviour associated to an RTP flow.\nWhen the IMS-ALG requests the IMS-AGW to reserve transport addresses/resources for an RTP flow, the IMS-ALG should also request the IMS-AGW to reserve resources for the corresponding RTCP flow, but may alternatively request the IMS-AGW not to reserve resources for the corresponding RTCP flow. When the IMS-ALG requests the IMS-AGW to reserve transport addresses/resources for a non-RTP flow, the IMS-ALG shall not request the IMS-AGW to reserve resources for an RTCP flow.\nTo request the IMS-AGW to reserve resources for an RTCP flow, the IMS ALG shall provide the RTCP handling information element with a value indicating that resources for RTCP shall be reserved.\nTo request the IMS-AGW not to reserve resources for an RTCP flow, the IMS ALG shall either provide the RTCP handling information element with a value indicating that resources for RTCP shall not be reserved or omit the RTCP handling information element.\nIf the IMS-AGW receives the indication to reserve RTCP resources, the IMS-AGW shall allocate a local port with even number for an RTP flow and shall allocate the consecutive local port with odd number for the associated RTCP flow, and it shall send and be prepared to receive RTCP packets.\nIf the IMS-AGW receives the indication to not reserve RTCP resources, or if it does not receive any indication at all, it shall not allocate an RTCP port when allocating a port for an RTP flow. The IMS-AGW shall not send any RTCP packets and shall silently discard any received RTCP packets.\nWhen RTCP resources are requested, the IMS-ALG may also specify:\n-\tthe explicit RTCP transport address information element containing the remote RTCP port, and optionally the remote address, where to send RTCP packets; if not specified, the IMS-AGW shall send RCTP packets to the port contiguous to the remote RTP port; and\n-\tbandwidth allocation requirements for RTCP, if the RTCP bandwidth level for the session is different than the default RTCP bandwidth as specified in RFC 3556 [6].\nThe explicit RTCP transport address information element contains the \"a=rtcp\" SDP attribute (as specified in IETF RFC 3605 [7]) received within the SDP body. The explicit RTCP transport address information element is only allowed for remote endpoints and shall not be used for the local endpoint. When the IMS-ALG requests the IMS-AGW to reserve resources for an RTCP flow and provides in addition the explicit RTCP port information element, then the IMS-AGW shall use this network address and transport port as destination when sending RTCP packets towards the remote endpoint.\nThe IMS-AGW shall return an error if it can not allocate the requested RTCP resources.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.9.2",
      "section_id": "5.9.2",
      "section_title": "RTP/RTCP transport multiplexing",
      "content": "The procedure in clause 5.9.1 describing the default case of RTP/RTCP transport non-multiplexed scenarios may be extended for the transport multiplexed mode by addition of the RTP/RTCP transport multiplexing information element to indicate to the IMS-AGW that RTP and RTCP traffic shall be multiplexed on a single port (as described in IETF RFC 5761 [60]). The RTP/RTCP transport multiplexing information element may only be sent to the IMS-AGW in combination with the RTCP handling information element with the value indicating that resources for RTCP shall be reserved. The support of these procedures is optional for the IMS ALG and the IMS-AGW. The IMS-ALG shall only use these procedures when knowing support at IMS-AGW side (e.g., via configuration management).\nThe usage is conditional, given by following restrictions:\n1)\tThe transport multiplexed mode may be only supported for terminations at the access network side of the IMS-AGW.\n2)\tThe transport multiplexed mode shall be only enabled for the local connection endpoint if agreed via SIP SDP offer/answer negotiation with the served UE using:\n-\tthe \"a=rtcp-mux\" SDP attribute, see IETF RFC 5761 [60], as updated by IETF RFC 8035 [72]; and/or\n-\tthe \"a=rtcp-mux-only\" SDP attribute, see IETF RFC 8858 [71].\nNOTE 1:\tUsage of an \"rtcp-mux-only\" attribute in an SDP answer is forbidden, see IETF RFC 8858 [71]. If the associated SDP answer does not contain an SDP \"rtcp-mux\" attribute, the offerer (the IMS ALG or the UE) needs to disable the associated RTP based media by sending a new SDP offer:- with a zero port value associated with the SDP media description (\"m=\" line); or- without associating an SDP \"rtcp-mux-only\" attribute with the SDP media description (\"m=\" line).\n3)\tWhen transport multiplexed mode is agreed with the served UE, then it may be applied in both traffic directions.\nNOTE 2:\tThe last two conditions enforce a symmetrical usage of RTP/RTCP transport multiplexing in the related network domain (here the access network).",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.9.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.10",
      "section_id": "5.10",
      "section_title": "Media Inactivity Detection",
      "content": "The IMS-ALG and the IMS-AGW may support the detection of inactive media flows.\nThe IMS-ALG may require an IMS-AGW that supports media inactivity detection to detect if a media flow is inactive.\nNOTE:\tThe decision to apply or not media inactivity is general for all sessions with the same media characteristics (i.e. not user specific). It is for further study under which conditions inactivity media detection may be requested.\nWhen the IMS-ALG requests the IMS-AGW to reserve transport addresses/resources, the IMS-ALG may indicate to the IMS-AGW that detection of an inactive media flow is required and may additional specify inactivity detection time and inactivity detection direction.\nThe IMS-AGW shall determine a media flow on termination to be inactive if there is no media sent and/or received within the inactivity detection time period.\nOn being informed of the inactive media, the IMS-ALG shall initiate any appropriate corrective action.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.11.1",
      "section_id": "5.11.1",
      "section_title": "General",
      "content": "The IMS-ALG and the IMS-AGW may support IMS media plane security as specified in 3GPP TS 33.328 [12]. They may support end-to-access edge security, or end-to-end security, or both, for\n-\tRTP based media (such as e.g. audio, video information) using SRTP security, and/or\n-\tTCP based media (such as MSRP and BFCP) using TLS security; and/or\n-\tUDP based media (such as T.38 fax over UDPTL/UDP) using DTLS security.\nIf supported the IMS-ALG and the IMS-AGW shall use the procedures in the following clauses.\nNOTE:\tFor the support of end-to-end security, the presence of an IMS-ALG is not required.\nProcedures for the IMS-ALG to determine if end-to-access edge security or end-to-end security is applicable to a session are specified in 3GPP TS 33.328 [12] and 3GPP TS 24.229[11].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_33.328",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.11.2.1",
      "section_id": "5.11.2.1",
      "section_title": "End-to-access-edge security for RTP based media using SDES",
      "content": "Procedures for the IMS-ALG to determine if end-to-access edge security is applicable to RTP based media and to exchange cryptography related SDP parameters with the served UE during the SIP session setup are specified in 3GPP TS 33.328 [12] and 3GPP TS 24.229[11].\nFor media lines that can be subject to e2ae security, the IMS-ALG will receive \"RTP/AVP\" or \"RTP/AVPF\" as transport protocol in SDP from the core network. When the IMS-ALG determines that e2ae security is applicable, it will indicate \"RTP/SAVP\" (see IETF RFC 3711 [14]) or \"RTP/SAVPF\" (see IETF RFC 5124 [15]), respectively, as transport protocol in the corresponding SDP media lines send towards the served UE. When e2ae security is applied, the IMS-ALG will also receive \"RTP/SAVP\" or \"RTP/SAVPF\" in SDP from the served UE. The IMS-ALG will then indicate \"RTP/AVP\" or \"RTP/AVPF\" respectively, as transport protocol in the corresponding SDP media lines send towards the core network. When the IMS-ALG requests the IMS-AGW to reserve transport addresses/resources for media to which e2ae security is applicable, the IMS ALG shall configure \"RTP/SAVP\" or \"RTP/SAVPF\" as transport protocol at the access side termination. The IMS ALG shall configure \"RTP/AVP\" or \"RTP/AVPF\" as transport protocol at the core network side termination for media where e2ae security is applicable.\nWhen the IMS-ALG determines that e2ae security is applicable, it will generate appropriate cryptographic context parameters, in particular key(s), and will transfer them to the served UE within SDES SDP \"crypto\" attribute(s) according to IETF RFC 4568 [13]. The IMS-ALG will also receive cryptographic context parameters, in particular key(s), from the served UE within SDES SDP \"crypto\" attribute(s). When the IMS-ALG requests the IMS-AGW to reserve or configure transport addresses/resources for media to which e2ae security is applicable, the IMS-ALG shall  provide cryptography related parameters as SDES SDP \"crypto\" attributes applicable at the access side termination.\nOn the originating side of the SIP session setup, the IMS-ALG shall provide as \"Remote cryptographic SDES attribute\" the SDES crypto attribute it selected from the ones received from the IMS UE in the SDP Offer . The IMS-ALG shall provide as \"Local cryptographic SDES attribute\"  the SDES crypto attribute the IMS-ALG generated and inserted in the SDP Answer sent to IMS UE.\nOn the terminating side of the SIP session setup, the IMS-ALG shall provide as \"Remote cryptographic SDES attribute\" the SDES crypto attribute received from the IMS UE in the SDP Answer. The IMS-ALG shall provide as \"Local cryptographic SDES attribute\" the SDES crypto attribute selected by the UE from the ones the IMS-ALG generated and inserted in the SDP Offer sent to UE.  If the IMS-ALG offers only one SDES crypto attribute to the UE, the IMS-ALG may provide this attribute as \"Local cryptographic SDES attribute\" within the Reserve AGW Connection Point Procedure before receiving the SDP answer from the UE.In the present release, a modification of an established e2ae crypto session is not supported. Thus, the IMS-ALG shall not modify any previously provided \"Local cryptographic SDES attribute\" or \"Remote cryptographic SDES attribute\".\nIf the IMS-ALG applies e2ae media security for a media stream and receives an SDP bandwidth modifier related to that media stream in SIP/SDP signalling, it should modify this bandwith modifier to adjust the bandwidth overhead due to e2ae security before forwarding the SDP. The IMS-ALG should add the bandwidth overhead caused by e2ae media security to the bandwidth information received from the remote peer. The IMS-ALG should substract the bandwidth overhead caused by e2ae media security from the bandwidth information received from the served UE.\nThe IMS Access GW shall, upon reception of an SDES crypto attribute, establish an SRTP security context (as described in RFC 4568 [13] and RFC 3711 [14]) and be prepared to convert RTP packets to SRTP packets and vice versa, using the corresponding SRTP security contexts.",
      "chunk_type": "general",
      "cross_references": [
        "ts_33.328",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.11.2.2.1",
      "section_id": "5.11.2.2.1",
      "section_title": "General",
      "content": "E2ae security for TCP based media using TLS is applicable for MSRP (see IETF RFC 4975 [25]; used in IMS session-based messaging) and BFCP (see IETF RFC 4582 [31]; used in IMS conferencing). The IMS-ALG and IMS-AGW may support e2ae security for MSRP, BFCP, or both protocols.\nE2ae protection of MSRP and BFCP media is based on TLS, according to the TLS profile specified in Annex E of 3GPP TS 33.310 [48] and Annex M of 3GPP TS 33.328 [12]. TLS shall be supported over the TCP transport (see IETF RFC 793 [29]).\nKey management for e2ae protection of MSRP and BFCP is based on the ciphersuites and session keys negotiated via the TLS handshake protocol between the UE and the IMS-AGW (see 3GPP TS 33.328 [12]).\nProcedures for the IMS-ALG to determine if e2ae security for MSRP and/or BFCP is applicable to a session and to exchange the cryptographic information (i.e. certificate fingerprints, see IETF RFC 8122 [80]) over SDP with the served UE during the SIP session setup are specified in 3GPP TS 33.328 [12] and 3GPP TS 24.229 [11]. If e2ae security is not required, the e2e security procedures may apply, see clause 5.11.3.\nAccording to the TLS profile specified in Annex E of 3GPP TS 33.310 [48], the IMS-AGW shall accept TLS renegotiation only if it is secured according to IETF RFC 5746 [47].\nNOTE 1:\tIETF RFC 5746 [47] defines a \"TLS secure renegotiation\" procedure, which leaves the definition of a basic TLS renegotiation still open. H.248 based support to enable the IMS-ALG to allow or not allow the IMS-AGW to perform client initiated or server initiated TLS renegotiation is not addressed in the present release. The behaviour of the IMS-AGW for \"TLS session renegotiation\" procedure is hence not further defined in the present release.\nIf the IMS-ALG applies e2ae media security for a media stream and receives an SDP bandwidth modifier related to that media stream in SIP/SDP signalling, it should modify this bandwith modifier to adjust the bandwidth overhead due to e2ae security before forwarding the SDP. The IMS-ALG should add the bandwidth overhead caused by e2ae media security to the bandwidth information received from the remote peer. The IMS-ALG should substract the bandwidth overhead caused by e2ae media security from the bandwidth information received from the served UE.\nFor each MSRP or BFCP media stream to be set-up with e2ae security, the P-CSCF (IMS-ALG) shall:\n-\tinclude the IMS-AGW in the media path and allocate the required resources for the media stream in the IMS-AGW;\n-\trequest a certificate fingerprint from the IMS-AGW;\n-\tinclude the certificate fingerprint received from the IMS-AGW in the SDP it sends to the IMS UE;\n-\tsend the certificate fingerprint(s) received in the SDP from the IMS UE to the IMS-AGW;\n-\tinstruct the IMS-AGW to perform state-aware TCP handling by including information about the TCP setup direction;\n-\tfor each termination determine via SDP negotiation as specified in IETF RFC 4145 [30] if the IMS-AGW needs to act as TCP client or server for the terminations towards the core network and towards the access network;\n-\tindicate to the IMS-AGW how to perform the TCP connection establishment by:\na)\teither instructing the IMS‑AGW to start a TCP connection establishment on any terminations where it needs to act as TCP client; or\nb)\tindicating to the IMS‑AGW to use an incoming TCP connection establishment request at one termination as a trigger to send a TCP connection establishment request at the interconnected termination in the same context (support of this alternative is optional for the IMS-AGW and IMS‑ALG);\n-\tdetermine via SDP negotiation if the IMS-AGW needs to act as TLS client or server as specified in the clauses below;\nNOTE 2:\tThe determination of the TLS client/server role relies on different rules for MSRP and BFCP.\n-\tif the IMS-AGW needs to act as TLS client, request the IMS-AGW to start the TLS session setup once the TCP connection is established towards the UE; and\n-\tapply additional specific procedures for MSRP in clause 5.11.2.2.2 or for BFCP in clause 5.11.2.2.3.\nFor each MSRP or BFCP media stream to be set-up with e2ae security the IMS-AGW shall:\n-\tupon request from the IMS-ALG, select an own certificate for the media stream, uniquely associate own certificate with the media stream, and send the fingerprint of the own certificate to the IMS-ALG;\n-\tuniquely associate the certificate fingerprint(s) received from the IMS-ALG with the corresponding MSRP or BFCP media stream, and subsequently use the certificate fingerprint(s) (as described in IETF RFC 4975 [25]) to verify the establishment of the TLS session of the corresponding media stream to belong to the served user;\n-\tif the verification of the remote certificate fingerprint(s) during the TLS session establishment fails, regard the remote TLS endpoint as not authenticated, terminate the TLS session and report the unsuccessful TLS session setup to the IMS-ALG;\n-\tnegotiate the TLS protocol configurations with the TLS peer based on locally provisioned TLS profile parameters;\n-\twhen the TLS session has been established, convert unprotected media received from the network to protected media to send to the served UE and vice versa;\n-\tbe capable to support both the TLS server and TLS client roles;\n-\twhen being instructed to start the TLS session setup, act as a TLS client and establish the TLS session as soon as the underlying TCP bearer connection is established;\n-\tupon instruction of the IMS-ALG to perform state-aware TCP handling, not forward any TCP connection establishment request received on one termination towards the interconnected termination;\n-\tupon corresponding instructions from the IMS‑ALG, start a TCP connection establishment on the indicated termination by sending a TCP SYN, or use an incoming TCP connection establishment request received at one termination as a trigger to send a TCP connection establishment request at the interconnected termination in the same context;\n-\trelease the underlying TCP bearer connection as soon as the TLS session is released; and\n-\tapply additional specific procedures for MSRP in clause 5.11.2.2.2 or for BFCP in clause 5.11.2.2.3.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_5.11.3",
        "clause_5.11.2.2.2",
        "clause_5.11.2.2.3",
        "ts_33.310",
        "ts_33.328",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.11.2.2.2",
      "section_id": "5.11.2.2.2",
      "section_title": "e2ae security for session based messaging (MSRP)",
      "content": "For each MSRP media stream outside WebRTC data channels requiring e2ae security, the IMS-ALG shall indicate to the IMS-AGW as transport protocol:\na)\tfor application-agnostic e2ae security support:\n-\t\"TCP\" at the termination towards the core network; and\n-\t\"TCP/TLS\" at the termination towards the access network; or\nb)\tfor application-aware e2ae security support:\n-\t\"TCP/MSRP\" at the termination towards the core network; and\n-\t\"TCP/TLS/MSRP\" at the termination towards the access network.\nThe IMS-ALG shall determine via SDP negotiation if the IMS‑AGW needs to act as TLS client or TLS server using the IETF RFC 4145 [30] \"a=setup\" SDP attribute as follows:\n-\tif the IMS‑ALG send an \"a=setup:active\" SDP attribute in an SDP answer towards the UE, the IMS‑AGW shall act as TLS client;\n-\tif the IMS‑ALG send an \"a=setup:passive\" SDP attribute in an SDP answer towards the UE, the IMS‑AGW shall act as TLS server;\n-\tif the IMS‑ALG receives an \"a=setup:active\" SDP attribute in an SDP answer from the UE, the IMS‑AGW shall act as TLS server; and\n-\tif the IMS‑ALG receives an \"a=setup:passive\" SDP attribute in an SDP answer from the UE, the IMS‑AGW shall act as TLS client.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.11.2.2.3",
      "section_id": "5.11.2.2.3",
      "section_title": "e2ae security for conferencing (BFCP)",
      "content": "For each BFCP media stream requiring e2ae security, the IMS-ALG shall indicate to the IMS-AGW as transport protocol:\n-\t\"TCP\" at the termination towards the core network; and\n-\t\"TCP/TLS\" at the termination towards the access network.\nThe IMS-ALG shall determine via SDP negotiation (see IETF RFC 4583 [27]) if the IMS‑AGW needs to act as TLS client or TLS server as follows:\n-\tif the IMS‑ALG receives an initial SDP offer from the UE, the IMS‑AGW shall act as TLS server; and\n-\tif the IMS‑ALG sends an initial SDP offer towards the UE, the IMS‑AGW shall act as TLS client.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.11.2.3.1",
      "section_id": "5.11.2.3.1",
      "section_title": "General",
      "content": "The IMS-ALG and the IMS-AGW may support end-to-access-edge (e2ae) security for an UDP based media. The e2ae protection of the UDP based media relies on the usage of DTLS, according to the DTLS profiles specified in Annex E of 3GPP TS 33.310 [48] and exchange of self-signed certificates as defined in 3GPP TS 33.328 [12].\nKey management solution for the e2ae media security of UDP is based on the cipher suites and session keys negotiated via the DTLS handshake protocol between the served UE and the IMS-AGW as specified in 3GPP TS 33.328 [12]. Procedures for the IMS-ALG to determine if e2ae security is applicable to UDP based media and to exchange the cryptographic information (i.e. certificate fingerprints, see IETF RFC 8122 [80]) via SDP negotiation with the served UE during the SIP session establishment are specified in 3GPP TS 33.328 [12] and 3GPP TS 24.229 [11].\nIf the IMS-ALG applies e2ae media security for a media stream and receives an SDP bandwidth modifier related to that media stream in SIP/SDP signalling, it should modify this bandwith modifier to adjust the bandwidth overhead due to e2ae security before forwarding the SDP. The IMS-ALG should add the bandwidth overhead caused by e2ae media security to the bandwidth information received from the remote peer. The IMS-ALG should substract the bandwidth overhead caused by e2ae media security from the bandwidth information received from the served UE.\nClause 5.11.2.3.2 defines specific requirements for e2ae protection of T.38 fax media stream over UDPTL/UDP transport. The usage of UDPTL over DTLS is defined in IETF RFC 7345 [33] and IETF RFC 8842 [81].",
      "chunk_type": "definition",
      "cross_references": [
        "clause_5.11.2.3.2",
        "ts_33.310",
        "ts_33.328",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.11.2.3.2",
      "section_id": "5.11.2.3.2",
      "section_title": "e2ae security for T.38 fax over UDP/UDPTL transport",
      "content": "If the IMS-ALG and the IMS-AGW support e2ae security for the UDP based media using DTLS and certificate fingerprints, then for each T.38 fax media stream over UDPTL/UDP transport to be setup with e2ae security, the IMS-ALG shall:\n-\tinclude the IMS-AGW in the media path and allocate the required resources for the media stream in the IMS-AGW;\n-\tdetermine via SDP negotiation with the served UE if the IMS-AGW needs to act as DTLS client or DTLS server as specified in IETF RFC 7345 [33] and IETF RFC 8842 [81];\n-\twhen requesting resources towards the access network:\na)\tindicate to the IMS-AGW \"UDP/DTLS\" as transport protocol;\nb)\tsend the certificate fingerprint(s) received from the served UE to the IMS-AGW; and\nc)\trequest from the IMS-AGW the certificate fingerprint;\n-\tinclude the certificate fingerprint received from the IMS-AGW in the SDP body it sends to the served UE;\n-\tif the IMS-ALG received from the served UE an SDP offer with \"a=tls-id\" media-level SDP attribute (as specified in IETF RFC 8842 [81]), create a new DTLS association identity and include the \"a=tls-id\" SDP attribute with the new DTLS association identity in the SDP answer which the IMS-ALG sends to the served UE;\n-\tif the IMS-ALG sends to the served UE an SDP offer, create a new DTLS association identity and include the \"a=tls-id\" SDP attribute with the new DTLS association identity in the SDP offer;\nNOTE:\tAlready used certificate fingerprints can be assigned to a new DTLS association. If the IMS-AGW uses the same set of fingerprints for a new DTLS association then the IMS-ALG creates a new local \"tls-id\" attribute value so that the combination of the \"tls-id\" attribute values of the IMS-ALG and the served UE is unique across all DTLS associations that might be handled by the IMS-ALG and the served UE, as specified in IETF RFC 8842 [81].\n-\trequest the IMS-AGW to start the DTLS session setup if the IMS-AGW needs to act as DTLS client; and\n-\twhen requesting resources towards the core network:\na)\tindicate to the IMS-AGW \"UDP\" as transport protocol.\nFor each T.38 fax media stream over UDPTL/UDP transport to be setup with e2ae security, the IMS-AGW shall:\n-\tbe capable to support both the DTLS server and DTLS client roles;\n-\tupon request from the IMS-ALG, act as DTLS client and start DTLS session establishment;\n-\tupon request from the IMS-ALG, select an own certificate for the T.38 fax media stream, uniquely associate its own certificate with the media stream, and send the fingerprint of the own certificate to the IMS-ALG;\n-\tuniquely associate the certificate fingerprint(s) received from the IMS-ALG with the corresponding T.38 fax media stream; and\n-\tverify during the subsequent DTLS handshake with the served UE (as described in IETF RFC 7345 [33] and IETF RFC 8842 [81]) that the fingerprint of the certificate passed by the served UE during DTLS handshake matches the certificate fingerprint received from the IMS-ALG:\na)\tif the verification fails, the IMS-AGW shall regard the remote DTLS endpoint as not authenticated, terminate the DTLS session and report the unsuccessful DTLS session setup to the IMS-ALG;\nb)\totherwise, the IMS-AGW shall continue with DTLS session setup and when the DTLS session is established, the IMS-AGW shall be prepared to receive and convert unprotected media from the core network to the protected media to be sent to the served UE and vice versa.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.11.2.4",
      "section_id": "5.11.2.4",
      "section_title": "End-to-access-edge security for RTP based media using DTLS-SRTP",
      "content": "Support of end-to-access edge security for RTP based media using DTLS-SRTP is mandatory for WebRTC sessions and optional for other SIP sessions.\nThe P-CSCF (IMS-ALG) and IMS-AGW provide end-to-access edge security by using DTLS-SRTP, where DTLS is used to establish keys for SRTP according to IETF RFC 5763 [42], IETF RFC 8842 [81] and IETF RFC 5764 [43].\nDuring the establishment of a WebRTC or SIP session, the IMS-ALG receives \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\" as the transport protocol in SDP from the served UE (IMS UE or WebRTC IMS Client (WIC)). The IMS-ALG then shall indicate \"RTP/AVP\" or \"RTP/AVPF\" over UDP, respectively, as the transport protocol in the corresponding SDP media lines send towards the core network. When an IMS-ALG receives \"RTP/AVP\" or \"RTP/AVPF\" in SDP from the core network, the IMS-ALG shall indicate \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\" as transport protocol in SDP send towards the served UE (IMS UE or WIC). When the IMS-ALG requests the IMS-AGW to reserve transport addresses/resources for e2ae media security, the IMS ALG shall configure \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\" as transport protocol at the access side termination, and \"RTP/AVP\" or \"RTP/AVPF\" over UDP as transport protocol at the core network side termination.\nThe IMS-ALG shall send the received UE (IMS UE or WIC) certificate fingerprint(s) to the IMS-AGW that is then able to correlate the fingerprint within the media stream uniquely. For each SRTP/SRTCP media stream to be established with e2ae media security, the IMS-AGW shall send the fingerprint of its certificate via Iq interface to the IMS-ALG.\nIf the IMS-ALG received from the UE (IMS UE or WIC) an SDP offer with \"a=tls-id\" media-level SDP attribute (as specified in IETF RFC 8842 [81]), create a new DTLS association identity and include the \"a=tls-id\" SDP attribute with the new DTLS association identity in the SDP answer which the IMS-ALG sends to the UE (IMS UE or WIC).\nIf the IMS-ALG sends to the UE (IMS UE or WIC) an SDP offer, create a new DTLS association identity and include the \"a=tls-id\" SDP attribute with the new DTLS association identity in the SDP offer.\nNOTE:\tAlready used certificate fingerprints can be assigned to a new DTLS association. If the IMS-AGW uses the same set of fingerprints for a new DTLS association then the IMS-ALG creates a new local \"tls-id\" attribute value so that the combination of the \"tls-id\" attribute values of the IMS-ALG and the UE (IMS UE or WIC) is unique across all DTLS associations that might be handled by the IMS-ALG and the UE (IMS UE or WIC), as specified in IETF RFC 8842 [81].\nAccording to procedures defined in 3GPP TS 24.229[11] and 3GPP TS 24.371 [44], the IMS-AGW shall act as either a DTLS server or client in the DTLS session.\nIn DTLS-SRTP case, RTP and RTCP data are encrypted using SRTP and SRTCP as defined in IETF RFC 3711 [14].\nWhen the DTLS session is established between the UE (IMS UE or WIC) and the IMS-AGW, the IMS-AGW shall be prepared to send and receive SRTP/SRTCP packets of the incoming network side from the UE (IMS UE or WIC), and convert SRTP/SRTCP packets to RTP/RTCP packets to the outgoing network side and vice versa, if the media stream toward the IMS core network is using RTP/RTCP.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.229",
        "ts_24.371"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.11.2.5",
      "section_id": "5.11.2.5",
      "section_title": "End-to-access-edge security for RTP based voice and video media using DTLS-SRTP over TCP",
      "content": "The eP-CSCF (IMS-ALG) and eIMS-AGW for WebRTC may support end-to-access-edge security for RTP based voice and video media using DTLS-SRTP over TCP. If they do so, they shall apply the procedures in the present clause.\nNOTE 1: RTP over TCP may be used to traverse NAT/Firewalls that perform UDP blocking.\nTCP transport may be offered as an alternative to UDP transport using the ICE procedures in clause 5.18. The eP-CSCF (IMS-ALG) and eIMS-AGW for WebRTC shall then provide end-to-access edge security for voice and video by using DTLS-SRTP over TCP, where DTLS is used to establish keys for SRTP according to IETF RFC 5763 [42], IETF RFC 8842 [81] and IETF RFC 5764 [43]. Framing according to RFC 4571 [58] shall be used for RTP streams transferred over TCP.\nThe IMS-ALG shall send the received WIC certificate fingerprint(s) to the eIMS-AGW that is then able to correlate the fingerprint within the media stream uniquely. For each SRTP/SRTCP media stream to be established with e2ae media security, the eIMS-AGW shall send the fingerprint of its certificate via Iq interface to the IMS-ALG.\nNOTE 2:\tThe same fingerprint also applies for End-to-access-edge security for RTP based media using DTLS-SRTP, as described in clause 5.11.2.4.\nIf the IMS-ALG received from the WIC an SDP offer with \"a=tls-id\" media-level SDP attribute (as specified in IETF RFC 8842 [81]) create a new DTLS association identity and include the \"a=tls-id\" SDP attribute with the new DTLS association identity in the SDP answer which the IMS-ALG sends to the WIC.\nIf the IMS-ALG sends to the WIC an SDP offer, create a new DTLS association identity and include the \"a=tls-id\" SDP attribute with the new DTLS association identity in the SDP offer.\nNOTE 3:\tAlready used certificate fingerprints can be assigned to a new DTLS association. If the IMS-AGW uses the same set of fingerprints for a new DTLS association then the IMS-ALG creates a new local \"tls-id\" attribute value so that the combination of the \"tls-id\" attribute values of the IMS-ALG and the WIC is unique across all DTLS associations that might be handled by the IMS-ALG and the WIC, as specified in IETF RFC 8842 [81].\nAccording to procedures defined in 3GPP TS 24.371 [44], the eIMS-AGW shall act as either a DTLS server or client in the DTLS session.\nIn DTLS-SRTP over TCP case, RTP and RTCP data are encrypted using SRTP and SRTCP as defined in IETF RFC 3711 [14].\nWhen the DTLS session is established between the WIC and the eIMS-AGW, the eIMS-AGW shall be prepared to send and receive SRTP/SRTCP packets over TCP of the incoming network side from the WIC, and convert SRTP/SRTCP packets to RTP/RTCP packets over UDP to the outgoing network side and vice versa, if the media stream towards the IMS core network is using RTP/RTCP over UDP.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_5.18",
        "clause_5.11.2.4",
        "ts_24.371"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.11.2.6",
      "section_id": "5.11.2.6",
      "section_title": "End-to-access-edge security for WebRTC data channels using UDP/DTLS/SCTP transport",
      "content": "The procedures in clause 5.20.2 are applicable.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.20.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.11.3.1",
      "section_id": "5.11.3.1",
      "section_title": "End-to-end security for RTP based media",
      "content": "For the support of e2e-security, the IMS-ALG and the IMS-AGW shall support \"RTP/SAVP\" (see IETF RFC 3711 [14]) and/or \"RTP/SAVPF\" (see IETF RFC 5124 [15]) as transport protocol.\nIf the IMS-ALG receives SDP containing media lines with \"RTP/SAVP\" (see IETF RFC 3711 [14]) or \"RTP/SAVPF\" (see IETF RFC 5124 [15]) as transport protocol, but did not receive any request for end-to-access-edge security, the IMS-ALG shall:\n-\tforward the SDP with unmodified transport protocol for those media lines;\n-\tprovide \"RTP/SAVP\" or \"RTP/SAVPF\", as received in the SDP, to the IMS-AGW as transport protocol for all related terminations, and  provide no media related information to these terminations, to configure the IMS-AGW to pass media transparently.\nIf the IMS-ALG receives SDP containing SDES SDP attribute(s) according to IETF RFC 4568 [13], and did not receive any request for end-to-access-edge security, it shall forward the SDP with unmodified SDES SDP attribute(s), but shall not provide the SDES SDP attribute(s) to the IMS-AGW.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.11.3.2",
      "section_id": "5.11.3.2",
      "section_title": "End-to-end security for TCP-based media using TLS",
      "content": "End-to-end protection of MSRP (used in IMS session-based messaging) and BFCP (used in IMS conferencing) media is based on TLS, according to the TLS profile specified in Annex E of 3GPP TS 33.310 [48] and Annex M of 3GPP TS 33.328 [12].\nIf the IMS-ALG receives SDP containing media lines with \"TCP/TLS/MSRP\" (see IETF RFC 4975 [25] and IETF RFC 6714 [26]) and/or \"TCP/TLS/BFCP\" (see IETF RFC 4583 [27]) as transport protocol but did not receive any request for end-to-access-edge security, the IMS-ALG shall:\n-\tforward the SDP with unmodified transport protocol for those media lines and unmodified TLS related SDP attribute(s);\n-\tindicate \"TCP\" to the IMS-AGW as transport protocol for all related terminations, and provide no media related information to these terminations,  to configure the IMS-AGW to pass media transparently.\nNOTE:\tEnd-to-end security for TCP-based media using TLS is not supported between two terminals being located behind firewalls/NATs.",
      "chunk_type": "general",
      "cross_references": [
        "ts_33.310",
        "ts_33.328"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.12.1",
      "section_id": "5.12.1",
      "section_title": "General",
      "content": "An IMS-ALG and IMS-AGW may support Explicit Congestion Notification (see IETF RFC 3168 [16], IETF RFC 6679 [17] and 3GPP TS 26.114 [21]).\nAn IMS-ALG and IMS-AGW which supports ECN shall support the ECN transparent procedure i.e. the transparent forwarding of ECN bits in the IP header (see IETF RFC 3168 [16]). If the IMS-AGW does not support the transparent forwarding of ECN bits then the IMS-ALG shall not permit ECN in the SDP Offer/Answer negotiation.\nThe IMS-AGW shall treat RTCP for ECN as a RTP translator with no media translation.\nAn IMS-ALG and IMS-AGW which supports ECN may then act as an ECN endpoint to enable ECN towards the IMS access network or/and towards the IMS Core Network. The subsequent clauses describe the general support for ECN, further details on the support of ECN during PS to CS access transfer is described in clause 6.2.14.3.\nNOTE:\tIt is out of the scope of this profile to support interworking with a non-3GPP ECN IP terminal.\nAn IMS-ALG and IMS-AGW that support ECN Transparent as well as transcoding shall also support the ECN endpoint procedure.\nAn IMS-ALG/IMS-AGW supporting the ATCF/ATGW function and ECN shall support ECN Endpoint (see clause 6.2.14).\nWhen acting as an ECN endpoint, the IMS-AGW shall be capable of enabling end-to-end rate adaptation between the local terminal and the remote entity by performing the following towards the ECN-capable peer:\n-\ttrigger rate adaptation request towards the ECN-capable peer when receiving in the incoming IMS media flow IP packets marked with ECN-CE, regardless of whether the IMS-AGW applies or does not apply transcoding;\n-\tforward adaptation requests between the local and the remote peer when the IMS-AGW bridges compatible codec configurations between the interfaces without applying a transcoding function;\n-\tperform media adaptation (e.g. reduce media bit-rate) towards the ECN-capable peer when receiving from the latter an adaptation request. and the IMS-AGW applies transcoding.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.2.14.3",
        "clause_6.2.14",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.12.2",
      "section_id": "5.12.2",
      "section_title": "Incoming SDP offer with ECN",
      "content": "The IMS-ALG and IMS-AGW shall apply the requirements specified in clause 10.2.13.2 of 3GPP TS 29.162 [20] replacing the IBCF and TrGW with IMS-ALG and IMS-AGW respectively.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.162_clause_10.2.13.2",
        "ts_29.162"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.12.3",
      "section_id": "5.12.3",
      "section_title": "Incoming SDP offer without ECN",
      "content": "The IMS-ALG and IMS-AGW shall apply the requirements specified in clause 10.2.13.3 of 3GPP TS 29.162 [20] replacing the IBCF and TrGW with IMS-ALG and IMS-AGW respectively with the following additions:\n-\tif the IMS-ALG or IMS-AGW does not support the procedure to act as an ECN endpoint, the IMS-ALG shall not include the \"a=ecn-capable-rtp\" attribute in the SDP offer it forwards to the succeeding node.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.162_clause_10.2.13.3",
        "ts_29.162"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.12.4",
      "section_id": "5.12.4",
      "section_title": "Detection of ECN failures by IMS-AGW",
      "content": "An IMS-ALG and IMS-AGW that support the procedure to act as an ECN endpoint shall support the requirements specified in clause 10.2.13.3a of 3GPP TS 29.162 [20] replacing the IBCF and TrGW with IMS-ALG and IMS-AGW respectively.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.162_clause_10.2.13.3",
        "ts_29.162"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.13.1",
      "section_id": "5.13.1",
      "section_title": "General",
      "content": "The transcoding functionality, where the IMS-AGW processes and possibly converts media data (like e.g. RTP payload) is optional for the P-CSCF and IMS-AGW to support. Transcoding should be supported if the IMS-ALG and IMS-AGW support the ATCF and ATGW functions for use after an SRVCC handover if the media that was used prior to the access transfer is not supported by the MSC Server.\nAn IMS-ALG and IMS-AGW that support transcoding shall support the requirements specified for Media Control in clause 10.2.5 of 3GPP TS 29.162 [20] respectively for the IBCF and TrGW, with the following additions:\n-\tDuring an originating or terminating PS session establishment, the IMS-ALG (ATCF) may remove codecs when passing SDP offers (e.g. codecs known not to be supported by either the IMS-AGW (ATGW) or the MSC Server), but the IMS-ALG (ATCF) should pass SDP offers without adding codecs to the SDP offer and pass SDP answers without modification to the contained codecs to avoid the potential need for transcoding in the IMS-AGW (ATGW) before the PS to CS access transfer;\n-\tDuring the PS to CS access transfer procedure, the IMS-ALG (ATCF) shall preferentially select from the SDP offer it receives from the MSC Server the codec already configured on the corresponding remote leg, if available.\nThe procedures for the IMS-ALG (ATCF) and IMS-AGW (ATGW) are further detailed in clause 6.2.14.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.162_clause_10.2.5",
        "clause_6.2.14",
        "ts_29.162"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.13.2",
      "section_id": "5.13.2",
      "section_title": "Handling of common codec parameters",
      "content": "When receiving an SDP offer, the IMS-ALG may add a payload type to offer transcoding before forwarding the SDP offer (denoted as \"codec 3\" in figures 10.2.5.1 and 10.2.5.2 of 3GPP TS 29.162 [20]). If that payload type is selected in the SDP answer, the IMS-ALG needs to transcode. Table 5.13.2.1 describes the IMS-ALG handling of codec related parameters applicable to multiple codecs when the IMS-ALG adds the payload type to the SDP offer, and that payload type is selected in the SDP answer.\nTable 5.13.2.1: IMS-ALG handling of common codec parameters for transcoding.\nParameter\nHandling of common codec parameter in the sent SDP offer\nHandling of common codec parameter in the received SDP answer\nptime (NOTE)\nIf the ptime parameter is included in the received SDP offer, the IMS-ALG shall supply the parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the value is supported by the IMS-AGW for receiving media, the IMS-ALG should keep the value from the received SDP offer unchanged in the SDP offer it sends. If the IMS-AGW only supports a lower ptime value, the IMS-ALG shall supply the ptime value according to configured preferences in the SDP offer it forwards. If no ptime value was contained in the received SDP offer, the IMS-ALG may add the parameter with a value according to configured preferences to the SDP offer.\nIf the ptime parameter is included in the received SDP answer, the IMS-ALG shall supply the parameter to the IMS-AGW for the termination towards the SDP answerer in the remote descriptor.\nIf the value is supported by the IMS-AGW for receiving media, the IMS-ALG should keep the value from the received SDP answer unchanged in the SDP answer it sends. If the IMS-AGW only supports a lower ptime value, the IMS-ALG shall supply the ptime value according to configured preferences in the SDP answer it forwards. If no ptime value was contained in the received SDP answer, the IMS-ALG may add the parameter with a value according to configured preferences to the SDP answer.\nmaxptime (NOTE)\nIf the maxptime parameter is included in the received SDP offer, the IMS-ALG shall supply the parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the value is supported by the IMS-AGW for receiving media, the IMS-ALG should keep the value from the received SDP offer unchanged in the SDP offer it sends. If the IMS-AGW only supports a lower maxptime value, the IMS-ALG shall supply the maxptime value according to the IMS-AGW capabilities in the SDP offer it forwards. If no maxptime value was contained in the received SDP offer, the IMS-ALG may add the parameter with a value according to the IMS-AGW capabilities to the SDP offer.\nIf the maxptime parameter is included in the received SDP answer, the IMS-ALG shall supply the parameter to the IMS-AGW for the termination towards the SDP answerer in the remote descriptor.\nIf the value is supported by the IMS-AGW for receiving media, the IMS-ALG should keep the value from the received SDP answer unchanged in the SDP answer it sends. If the IMS-AGW only supports a lower maxptime value, the IMS-ALG shall supply the maxptime value according to the IMS-AGW capabilities in the SDP answer it forwards. If no maxptime value was contained in the received SDP answer, the IMS-ALG may add the parameter with a value according to the IMS-AGW capabilities to the SDP answer.\nNOTE:\tThis SDP attribute is defined in IETF RFC 4566 [53]. It applies to all codecs offered in an SDP media line.\nTable 5.13.2.2 describes the IMS-AGW handling of codec related parameters applicable to multiple codecs.\nTable 5.13.2.2: IMS-AGW handling of common codec parameters\nParameter\nHandling in local descriptor\nHandling in remote descriptor\nptime (NOTE)\nThe IMS-AGW should expect to receive packets with this ptime value and may use this information when deciding upon the required resources.\nThe IMS-AGW should use this ptime value when sending packets.\nmaxptime (NOTE)\nThe IMS-AGW should expect to receive packets with this maxptime value and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use this maxptime value when sending packets.\nNOTE:\tThis SDP attribute is defined in IETF RFC 4566 [53]. It applies to all codecs offered in an SDP media line.",
      "chunk_type": "parameter",
      "cross_references": [
        "table_5.13.2.1",
        "table_5.13.2.2",
        "ts_29.162"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.13.3",
      "section_id": "5.13.3",
      "section_title": "Handling of the EVS speech codec",
      "content": "The Enhanced Voice Services (EVS) speech codec is defined in 3GPP TS 26.441 [51]. Its RTP payload type is defined in 3GPP TS 26.445 [52], and procedures for its usage as IMS Multimedia Telephony speech codec are defined in 3GPP TS 26.114 [21].\nThe IMS-ALG and the IMS-AGW may support transcoding to and from the EVS speech codec. If they do so, the procedures in the present clause apply.\nWhen receiving an SDP offer, the IMS-ALG may add an EVS codec payload type before forwarding the SDP offer (denoted as \"codec 3\" in figures 10.2.5.1 and 10.2.5.2 of 3GPP TS 29.162 [20]). If that EVS payload type is selected in the SDP answer, the IMS-ALG needs to transcode the EVS codec. Table 5.13.3.1 describes the IMS-ALG handling of EVS codec parameters when the IMS-ALG adds the EVS payload type to the SDP offer, and that EVS payload type is selected in the SDP answer. In addition, rules for the parameter handling in 3GPP TS 26.445 [52] shall apply.\nTable 5.13.3.1: IMS-ALG handling of EVS related SDP parameters when the IMS-ALG adds the EVS payload type to the SDP offer.\nParameter\nHandling for EVS payload type added to the SDP offer to offer transcoding\nHandling if offered EVS payload type is accepted in the SDP answer\nevs-mode-switch (NOTE 1)\nIf the IMS-ALG expects that interworking between AMR-WB and EVS is required (e.g. because AMR-WB was the first payload type in the received SDP offer), it shall include the evs-mode-switch with value 1. Otherwise the IMS-ALG shall not include the evs-mode-switch.\nIf the evs-mode-switch parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor.\nhf-only (NOTE 1)\nIf the IMS-ALG is configured to negotiate using only the header-full EVS RTP payload format, the IMS-ALG shall include the hf-only parameter with a value 1.\nIf the hf-only parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\ndtx (NOTE 1)\nIf the usage of DTX is not desired in the sending and receiving direction (e.g. due to DTX capabilities of expected codecs to transcode with, e.g. other codecs in the received SDP offer), the IMS-ALG shall include the dtx parameter with a value 0.\nIf the dtx parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\ndtx-recv (NOTE 1)\nIf receiving DTX is not desired and the dtx parameter is not included, the IMS-ALG shall include the dtx-recv parameter with a value 0.\nIf both the dtx and dtx-recv parameters are included, those parameters shall have the same value; however, inclusion of the dtx-recv parameter is not required if the dtx parameter is included.\nIf the dtx-recv parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nbr (NOTE 1)\nIf the IMS-ALG desires the same bit rate range for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range to match IMS-AGW capabilities and possible configured policies, it shall supply the br parameter in the SDP offer it sends. Otherwise the IMS-ALG shall not include this parameter in the SDP offer.\nIf the IMS-ALG also supplies the bw, bw-send or bw-recv parameter, the value of the br parameter shall be compatible with the values of those parameters.\nIf the br parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nbr-send (NOTE 1)\nIf the IMS-ALG desires a different bit rate (range) for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range for the send direction to match IMS-AGW capabilities and possible configured policies, it shall supply the br-send parameter in the SDP offer it sends. Otherwise the IMS-ALG shall not include this parameter in the SDP offer.\nIf the IMS-ALG also supplies the bw or bw-send parameter, the value of the br-send parameter shall be compatible with the values of those parameters.\nIf the br-send parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nbr-recv (NOTE 1)\nIf the IMS-ALG desires a different bit rate (range) for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range for the receive direction to match IMS-AGW capabilities and possible configured policies, it shall supply the br-recv parameter in the SDP offer it sends. Otherwise the IMS-ALG shall not include this parameter in the SDP offer.\nIf the IMS-ALG also supplies the bw or bw-recv parameter, the value of the br-recv parameter shall be compatible with the values of those parameters.\nIf the br-recv parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nbw (NOTE 1)\nIf the IMS-ALG desires the same sampling bandwidth(s) for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidths to match IMS-AGW capabilities, sampling bandwidths of expected codecs EVS will be transcoded to (e.g. the first payload type in the received SDP offer), and possible configured policies, it shall supply the bw parameter in the SDP offer it sends. Otherwise the IMS-ALG shall not include this parameter in the SDP offer.\nIf the bw parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nbw-send (NOTE 1)\nIf the IMS-ALG desires different sampling bandwidths for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidths in the send direction to match IMS-AGW capabilities, sampling bandwidths of expected codecs EVS will be transcoded to (e.g. the first payload type in the received SDP offer) and possible configured policies, it shall supply the bw-send parameter in the SDP offer it sends. Otherwise the IMS-ALG shall not include this parameter in the SDP offer.\nIf the bw-send parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nbw-recv (NOTE 1)\nIf the IMS-ALG desires different sampling bandwidths for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidths in the receive direction to match IMS-AGW capabilities, sampling bandwidths of expected codecs EVS will be transcoded to (e.g. the first payload type in the received SDP offer), and possible configured policies, it shall supply the bw-recv parameter in the SDP offer it sends. Otherwise the IMS-ALG shall not include this parameter in the SDP offer.\nIf the bw-recv parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\ncmr (NOTE 1)\nIf the IMS-ALG desires to disable codec mode requests within the RTP payload of the EVS primary mode (due to the IMS-AGW capabilities or policies), it shall include the cmr parameter with value -1 in the SDP offer it sends.\nIf the cmr parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nch-aw-recv (NOTE 1)\nThe IMS-ALG shall include the ch-aw-recv parameter in the SDP offer if it desires to control the channel-aware mode of EVS in the receive direction, e.g. to disable it with value -1. The IMS-ALG shall consider the capabilities of the IMS-AGW when it chooses an appropriate value.\nIf the ch-aw-recv parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nnumber of channels (NOTE 2)\nThe IMS-ALG shall only include the \"number of channels\" parameter in the SDP offer if it desires to send or receive multiple channels. If the desired number of channels in the send and receive direction differs, the IMS-ALG shall include the higher value. The IMS-ALG should consider the number of channels of expected codecs EVS will be transcoded to (e.g. the first payload type in the received SDP offer).\nIf the \"number of channels\" parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nch-send (NOTE 1)\nThe IMS-ALG shall only include the ch-send parameter in the SDP offer if it desires to send multiple channels, with different numbers of channels in the send and receive direction. The IMS-ALG should consider the number of channels of expected codecs EVS will be transcoded to (e.g. the first payload type in the received SDP offer).\nIf the ch-send parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nch-recv (NOTE 1)\nThe IMS-ALG shall only include the ch-recv parameter in the SDP offer if it desires to receive multiple channels, with different numbers of channels in the send and receive direction. The IMS-ALG should consider the number of channels of expected codecs EVS will be transcoded to (e.g. the first payload type in the received SDP offer).\nIf the ch-recv parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nmode-set (NOTE 3)\nThe IMS-ALG shall only include the mode-set parameter in the SDP offer if it desires to restrict the mode-set of AMR-WB IO mode. The IMS-ALG should only restrict the mode-set if the expected codec EVS will be interworked with (e.g. the first payload type in the received SDP offer) is AMR-WB and has a restricted mode-set.\nIf the mode-set parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nIf the IMS-ALG decides that EVS will be transcoded to AMR-WB, the IMS-ALG should include the mode-set parameter for the AMR-WB payload in the SDP offer it forwards if this is permissible by AMR-WB offer answer rules in IETF RFC 4867 [54].\nmode-change-period (NOTE 3)\nThe IMS-ALG shall only include the mode-change-period parameter with value 2 in the SDP offer if it desires to restrict the mode-change-period of received packets in AMR-WB IO mode. The IMS-ALG should only restrict the mode-change-period if the expected codec EVS will be interworked with (e.g. the first payload type in the received SDP offer) is AMR-WB and has such a restriction.\nIf the mode-change-period parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nIf the IMS-ALG decides that EVS will be transcoded to AMR-WB, the IMS-ALG should include the mode-change-period parameter for the AMR-WB payload in the SDP offer it forwards.\nmode-change-capability (NOTE 3)\nThe IMS-ALG shall include the mode-change-capability parameter with value 2 in the SDP offer if it is capable of restricting the mode-change-period of packets it sends in AMR-WB IO mode. The IMS-ALG should consider the mode-change-period of the expected codec EVS will be interworked with (e.g. the first payload type in the received SDP offer) if this is AMR-WB.\nIf the mode-change-capability parameter is contained in the SDP answer, the IMS-ALG may forward this parameter to the IMS-AGW in the remote descriptor.\nIf the IMS-ALG decides that EVS will be transcoded to AMR-WB, the IMS-ALG should include the mode-change-capability parameter for the AMR-WB payload in the SDP offer it forwards.\nmode-change-neighbor (NOTE 3)\nThe IMS-ALG shall only include the mode-change-neighbor parameter in the SDP offer if it desires to restrict the mode-change within received packets of AMR-WB IO mode to neighboring modes. The IMS-ALG should consider the mode-change-neighbor parameter of the expected codec EVS will be interworked with (e.g. the first payload type in the received SDP offer) if this is AMR-WB.\nIf the mode-change-neighbor parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nIf the IMS-ALG decides that EVS will be transcoded to AMR-WB, the IMS-ALG should include the mode-change-neighbor parameter for the AMR-WB payload in the SDP offer it forwards.\nmax-red (NOTE 5)\nThe IMS-ALG shall only include the max-red parameter in the SDP offer if it desires to restrict the maximum redundancy of received packets. IMS-ALG shall consider the capabilities of the IMS-AGW, and should consider the max-red parameter of the expected codec EVS will be interworked with (e.g. the first payload type in the received SDP offer) if this is AMR-WB.\nIf the max-red parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nIf the IMS-ALG decides that EVS will be interworked with AMR-WB, the IMS-ALG should include the max-red parameter for the AMR-WB payload in the SDP offer it forwards.\n3gpp_mtsi_app_adapt (NOTE 4)\nIf the IMS-AGW supports RTCP APP based adaptation messages defined in 3GPP TS 26.114 [21], and the IMS-ALG has a policy to negotiate the usage of those messages, the IMS-ALG shall include the 3gpp_mtsi_app_adapt SDP attribute indicating the supported APP messages in the SDP offer.\nIf the 3gpp_mtsi_app_adapt attribute is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nNOTE 1:\tThis MIME parameter of the EVS RTP payload type is defined in 3GPP TS 26.445 [51]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 2:\tThis number of channels are encoded as \"encoding parameters\" of the SDP \"a=rtpmap\" attribute defined in IETF RFC 4566 [53].\nNOTE 3:\tThis MIME parameter of the EVS RTP payload type relates to AMR-WB IO mode and is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 4:\tThis SDP attribute is defined in 3GPP TS 26.114 [21]. It applies to all codecs offered in an SDP media line. However, some values are specific to EVS.\nNOTE 5:\tThis MIME parameter of the EVS RTP payload type is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nWhen receiving an SDP offer that contains an EVS codec payload type (denoted as \"codec 1\" in figure 10.2.5.2 of 3GPP TS 29.162 [20]), the IMS-ALG may add other payload types before forwarding the SDP offer (denoted as \"codec 3\" in figure 10.2.5.2 of 3GPP TS 29.162 [20]). If that added payload type is selected in the SDP answer, the IMS-ALG needs to transcode, and may select to transcode to the EVS codec. Table 5.13.3.2 describes the IMS-ALG handling of EVS codec parameters when the IMS-ALG receives an EVS payload type in an SDP offer, and selects to transcode between the EVS codec and some other codec. In addition, rules for the parameter handling in 3GPP TS 26.445 [52] shall apply.\nTable 5.13.3.2: IMS-ALG handling of EVS related SDP parameters when the IMS-ALG receives the EVS payload type in the SDP offer and decides to transcode between the EVS payload type and some other codec.\nParameter\nHandling of EVS payload type parameter received in the SDP offer\nEVS payload type supplied in the SDP answer\nevs-mode-switch (NOTE 1)\nIf the evs-mode-switch parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the evs-mode-switch parameter is contained in the SDP offer, the IMS-ALG shall include the evs-mode-switch parameter with unmodified value in the SDP answer.\nOtherwise, if the IMS-ALG decides to interwork between AMR-WB and EVS (e.g. because AMR-WB was selected in the received SDP answer), it shall include the evs-mode-switch with value 1.\nOtherwise the IMS-ALG shall not include the evs-mode-switch.\nIf the IMS-ALG supplies the evs-mode-switch in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nhf-only (NOTE 1)\nIf the hf-only parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the hf-only parameter is contained in the SDP offer, the IMS-ALG shall include the hf-only parameter with unmodified value in the SDP answer.\nOtherwise, if the IMS-ALG is configured to negotiate using only the header-full EVS RTP payload format, the IMS-ALG shall include the hf-only parameter with a value 1.\nIf the IMS-ALG supplies the hf-only parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\ndtx (NOTE 1)\nIf the dtx parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the dtx parameter is contained in the SDP offer, the IMS-ALG shall include the dtx parameter with unmodified value in the SDP answer.\nIf the dtx parameter is not contained in the SDP offer and if a dtx-recv parameter is contained in the SDP offer, the IMS-ALG may include the dtx parameter in the SDP answer, and the value of the dtx parameter shall then be identical to that of the dtx-recv parameter in the SDP offer (e.g, if that value matches DTX capabilities of expected codecs to transcode with).\nIf the dtx parameter is not contained in the SDP offer and if the dtx-recv parameter is not contained in the SDP offer, and  if the usage of DTX is not desired (e.g. due to DTX capabilities of expected codecs to transcode with, e.g. other codecs in the received SDP answer), the IMS-ALG shall include in the SDP answer the dtx parameter with a value 0.\nIf the IMS-ALG supplies the dtx parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\ndtx-recv (NOTE 1)\nIf the dtx-recv parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf no dtx parameter is included in the SDP answer and if the reception of DTX is not desired, the IMS-ALG shall include in the SDP answer the dtx-recv parameter with a value 0.\nIf both the dtx and dtx-recv parameters are included, those parameters shall have the same value; however, inclusion of the dtx-recv parameter is not required if the dtx parameter is included.\nIf the IMS-ALG supplies the dtx-recv parameter in the SDP answer, it should also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nbr (NOTE 1)\nIf the br parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the send and receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the br parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the br parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires the same bit rate range for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range to match IMS-AGW capabilities and possible configured policies, it shall supply the br parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include this parameter in the SDP answer.\nIf the IMS-ALG also supplies the bw, bw-send or bw-recv parameter, the value of the br parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br parameter in the SDP answer, it shall also supply to the IMS-AGW the br parameter in the local descriptor for the termination towards the offerer with the same value.\nbr-send (NOTE 1)\nIf the br-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the br-recv parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br-recv value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the br-send parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires a different bit rate (range) for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range for the send direction to match IMS-AGW capabilities and possible configured policies, it shall supply the br-send parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include the br-send parameter in the SDP answer.\nIf the IMS-ALG also supplies the bw or bw-send parameter, the value of the br-send parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br-send parameter in the SDP answer, it shall also supply to the IMS-AGW the br-send parameter in the local descriptor for the termination towards the offerer with the same value.\nbr-recv (NOTE 1)\nIf the br-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the send direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the br-send parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br-send value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the br-recv parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires a different bit rate (range) for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range for the receive direction to match IMS-AGW capabilities and possible configured policies, it shall supply the br-recv parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include the br-recv parameter in the SDP answer.\nIf the IMS-ALG also supplies the bw or bw-recv parameter, the value of the br-recv parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br-recv parameter in the SDP answer, it shall also supply to the IMS-AGW the br-recv parameter in the local descriptor for the termination towards the offerer with the same value.\nbw (NOTE 1)\nIf the bw parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidth(s), or a subset of them, in EVS primary mode in the send and receive direction. If the indicated sampling bandwidth(s), and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the bw parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidth value, which is either the received bw value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the bw parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires the same sampling bandwidth(s) for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidth(s) to match IMS-AGW capabilities and possible configured policies, it shall supply the bw parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include this parameter in the SDP answer.\nIf the IMS-ALG also supplies the br, br-send or br-recv parameter, the value of the bw parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw parameter in the SDP answer, it shall also supply to the IMS-AGW the bw parameter in the local descriptor for the termination towards the offerer with the same value.\nbw-send (NOTE 1)\nIf the bw-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidths, or a subset of them, in EVS primary mode in the receive direction. If the indicated sampling bandwidths, and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the bw-recv parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidths value, which is either the received bw-recv value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the bw-send parameter with the selected value in the SDP answer.\nOtherwise, if the IMS-ALG desires different sampling bandwidths for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidths for the send direction to match IMS-AGW capabilities and possible configured policies, it shall supply the bw-send parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include the br-send parameter in the SDP answer.\nIf the IMS-ALG also supplies the br or br-send parameter, the value of the bw-send parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw-send parameter in the SDP answer, it shall also supply to the IMS-AGW the bw-send parameter in the local descriptor for the termination towards the offerer with the same value.\nbw-recv (NOTE 1)\nIf the br-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidths, or a subset of them, in EVS primary mode in the send direction. If the indicated sampling bandwidths, and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward the bw-recv parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the bw-send parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidths value, which is either the received bw-send value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the bw-recv parameter with the selected value in the SDP answer.\nOtherwise, if the IMS-ALG desires a different sampling bandwidths for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidths for the receive direction to match IMS-AGW capabilities and possible configured policies, it shall supply the bw-recv parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include the bw-recv parameter in the SDP answer.\nIf the IMS-ALG also supplies the br or br-recv parameter, the value of the bw-recv parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw-send parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\ncmr (NOTE 1)\nIf the cmr parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the cmr parameter is contained in the SDP offer, the IMS-ALG shall include the cmr parameter with unmodified value in the SDP answer.\nOtherwise, if the IMS-AGW desires to disable codec mode requests within the RTP payload of the EVS primary mode (due to the IMS-AGW capabilities or policies), it shall include the cmr parameter with value -1 in the SDP answer it sends\nIf the IMS-ALG supplies the cmr parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nch-aw-recv (NOTE 1)\nIf the ch-aw-recv parameter is contained in the SDP offer the IMS-ALG shall check if the IMS-AGW supports the indicated mode in the send direction. If the indicated mode is not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the IMS-ALG it desires to control the channel-aware mode of EVS in the receive direction, e.g. to disable it with value -1, it shall include the ch-aw-recv parameter in the SDP offer and shall also supply the ch-aw-recv parameter to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value. The IMS-ALG shall consider the capabilities of the IMS-AGW when it chooses an appropriate value.\nnumber of channels (NOTE 2)\nIf the \"number of channels\" parameter is contained in the SDP offer the IMS-ALG shall check if the IMS-AGW supports the indicated number of channels. If the indicated number of channels is not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the \"number of channels\" parameter is contained in the SDP offer, the IMS-ALG shall include the \"number of channels\" parameter with unmodified value in the SDP answer and shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nch-send (NOTE 1)\nIf the ch-send parameter is contained in the SDP offer the IMS-ALG shall check if the IMS-AGW supports the indicated number of channels in the receive direction. If the indicated number of channels is not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward the ch-send parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the ch-recv parameter is contained in the SDP offer, the IMS-ALG shall include the ch-send parameter with unmodified value in the SDP answer and shall also supply the ch-send parameter to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nch-recv (NOTE 1)\nIf the ch-recv parameter is contained in the SDP offer the IMS-ALG shall check if the IMS-AGW supports the indicated number of channels in the send direction. If the indicated number of channels is not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward the ch-recv parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the ch-send parameter is contained in the SDP offer, the IMS-ALG shall include the ch-recv parameter with unmodified value in the SDP answer and shall also supply the ch-recv parameter to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmode-set (NOTE 3)\nIf the mode-set parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the mode-set parameter is contained in the SDP offer and the IMS-ALG expects that EVS will be interworked with AMR-WB (e.g. if EVS is the first payload type in the received SDP offer, and the IMS-ALG adds a AMR-WB payload type), the IMS-ALG should include the mode-set parameter with the same value for the AMR-WB payload in the SDP offer it forwards.\nIf the mode-set parameter is contained in the SDP offer, the IMS-ALG shall include the mode-set parameter with unmodified value in the SDP answer.\nOtherwise, if the mode-set parameter is contained in the SDP answer for an AMR-WB payload type and the IMS-ALG decides that the EVS codec will be interworked with that AMR-WB payload type, the IMS-ALG should include that mode-set parameter for the EVS payload in the SDP answer it forwards.\nIf the IMS-ALG supplies the mode-set parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmode-change-period (NOTE 3)\nIf the mode-change-period parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the mode-change-period parameter is contained in the SDP offer and the IMS-ALG expects that EVS will be interworked with AMR-WB (e.g. if EVS is the first payload type in the received SDP offer, and the IMS-ALG adds the AMR-WB payload type), the IMS-ALG should include the mode-change-period parameter with the same value for the AMR-WB payload type in the SDP offer it forwards.\nIf the mode-change-period parameter is contained in the SDP answer for the AMR-WB payload type and the IMS-ALG decides the EVS codec will be interworked with that AMR-WB payload type, the IMS-ALG should include the mode-change-period parameter for the EVS payload in the SDP answer it forwards.\nIf the IMS-ALG supplies the mode-change-period parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmode-change-capability (NOTE 3)\nIf the mode-change-capability parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG may forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the IMS-ALG expects that EVS will be interworked with AMR-WB (e.g. if EVS is the first payload type in the received SDP offer, and the IMS-ALG adds the AMR-WB payload type), the IMS-ALG should include the mode-change-capability parameter with value 2 for the AMR-WB payload in the SDP offer it forwards.\nIf the IMS-ALG decides that the EVS codec is selected, the IMS-ALG shall either include the mode-change-capability parameter with value 2 or omit the parameter for the EVS payload in the SDP answer it forwards.\nIf the IMS-ALG supplies the mode-change-capability parameter in the SDP answer, it may also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmode-change-neighbor (NOTE 3)\nIf the mode-change-neighbor parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the mode-change-neighbor parameter is contained in the SDP offer and the IMS-ALG expects that EVS will be interworked with AMR-WB (e.g. if EVS is the first payload type in the received SDP offer, and the IMS-ALG adds the AMR-WB payload type), the IMS-ALG should include the mode-change-neighbor with the same value for the AMR-WB payload in the SDP offer it forwards.\nIf the mode-change-neighbor parameter is contained in the SDP answer for the AMR-WB payload type and the IMS-ALG decides that the EVS codec will be interworked with that AMR-WB payload type, the IMS-ALG should include the mode-change-neighbor parameter for the EVS payload in the SDP answer it forwards.\nIf the IMS-ALG supplies the mode-change-neighbor parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmax-red (NOTE 5)\nIf the max-red parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the max-red parameter is contained in the SDP offer and the IMS-ALG expects that EVS will be interworked with AMR-WB (e.g. if EVS is the first payload type in the received SDP offer, and the IMS-ALG adds the AMR-WB payload type), the IMS-ALG should include the max-red parameter with the same value for the AMR-WB payload in the SDP offer it forwards with a value that considers the received value and the capabilities of the IMS-AGW.\nThe IMS-ALG shall only include the max-red parameter in the SDP answer if it desires to restrict the maximum redundancy of received packets. When selecting the value of the max-red parameter, the IMS-ALG shall consider the capabilities of the IMS-AGW and, if the max-red parameter is contained in the SDP answer for the AMR-WB payload type and the IMS-ALG decides that the EVS codec will be interworked with that AMR-WB payload type, the received value.\nIf the IMS-ALG supplies the max-red parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\n3gpp_mtsi_app_adapt (NOTE 4)\nIf the 3gpp_mtsi_app_adapt parameter is contained in the SDP answer, and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nIf the IMS-AGW supports RTCP APP based adaptation messages defined in 3GPP TS 26.114 [21], and the IMS-ALG has a policy to negotiate the usage of those messages, the IMS-ALG shall include the 3gpp_mtsi_app_adapt SDP attribute indicating the supported APP messages in the SDP answer.\nNOTE 1:\tThis MIME parameter of the EVS RTP payload type is defined in 3GPP TS 26.445 [51]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 2:\tThis number of channels are encoded as \"encoding parameters\" of the SDP \"a=rtpmap\" attribute defined in IETF RFC 4566 [53].\nNOTE 3:\tThis MIME parameter of the EVS RTP payload type relates to AMR-WB IO mode and is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 4:\tThis SDP attribute is defined in 3GPP TS 26.114 [21]. It applies to all codecs offered in an SDP media line. However, some values are specific to EVS.\nNOTE 5:\tThis MIME parameter of the EVS RTP payload type is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nTable 5.13.3.3 describes the IMS-AGW handling of EVS codec parameters. The IMS-AGW should support transcoding of EVS with bandwidths (sampling rates) which are supported by codec the IMS-AGW is capable to transcode EVS to/from (e.g. NB for AMR, and WB for AMR-WB).\nTable 5.13.3.3: IMS-AGW handling of EVS codec parameters\nParameter\nHandling in local descriptor\nHandling in remote descriptor\nevs-mode-switch (NOTE 1)\nThe IMS-AGW should expect to receive packets with the indicated EVS mode and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use the indicated EVS mode (e.g. AMR-WB interoperable mode for value 1) when sending packets.\nhf-only (NOTE 1)\nThe IMS-AGW should expect to receive packets with the indicated mode and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use the indicated mode (e.g. header-full EVS RTP payload format for value 1) when sending packets.\ndtx (NOTE 1)\nThe IMS-AGW should expect to receive packets with this dtx mode and may use this information when deciding upon the required resources. (NOTE 8)\nThe IMS-AGW shall use this dtx mode (i.e. no usage of DTX for value 0) when sending packets. (NOTE 8)\ndtx-recv (NOTE 1)\nThe IMS-AGW should expect to receive packets with this dtx mode and may use this information when deciding upon the required resources. (NOTE 8)\nThe IMS-AGW shall use this dtx mode (i.e. no usage of DTX for value 0) when sending packets. (NOTE 8)\nbr (NOTE 1)\nIf different values for the br parameter are provided in the local and remote descriptors, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with this bitrate range and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use this bitrate range when sending packets.\nIf different values for the br parameter are provided in the local and remote descriptors, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with this bitrate range and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use this bitrate range when sending packets.\nbr-send (NOTE 1)\nIf different values for the br-send parameter in the local descriptor and for the br-recv parameter in the remote descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW shall use this bitrate range when sending packets.\nIf different values for the br-send parameter in the remote descriptor and for the br-recv parameter in the local descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with this bitrate range and may use this information when deciding upon the required resources.\nbr-recv (NOTE 1)\nIf different values for the br-send parameter in the remote descriptor and for the br-recv parameter in the local descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with this bitrate range and may use this information when deciding upon the required resources.\nIf different values for the br-send parameter in the local descriptor and for the br-recv parameter in the remote descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW shall use this bitrate range when sending packets.\nbw (NOTE 1)\nIf different values for the bw parameter are provided in the local and remote descriptors, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with these sampling bandwidth(s) and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use these sampling bandwidth(s) when sending packets.\nIf different values for the bw parameter are provided in the local and remote descriptors, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with these sampling bandwidth(s) and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use these sampling bandwidth(s) when sending packets.\nbw-send (NOTE 1)\nIf different values for the bw-send parameter in the local descriptor and for the bw-recv parameter in the remote descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW shall use these sampling bandwidth(s) when sending packets.\nIf different values for the bw-send parameter in the remote descriptor and for the bw-recv parameter in the local descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with these sampling bandwidth(s) and may use this information when deciding upon the required resources.\nbw-recv (NOTE 1)\nIf different values for the bw-send parameter in the remote descriptor and for the bw-recv parameter in the local descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with these sampling bandwidth(s) and may use this information when deciding upon the required resources.\nIf different values for the bw-send parameter in the local descriptor and for the bw-recv parameter in the remote descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW shall use these sampling bandwidth(s) when sending packets.\ncmr (NOTE 1)\nFor cmr with value -1 or 0, the IMS-AGW should expect to receive no RTP packets containing codec mode requests for EVS primary mode and may use this information when deciding upon the required resources.\nFor cmr with value -1 or 0, the IMS-AGW shall also send no RTP packets containing codec mode requests for EVS primary mode.\nDifferent cmr values in the local and remote descriptors are an error situation, but it is permissible that this parameter is only supplied in one of those descriptors.\nFor cmr with value -1 or 0, the IMS-AGW should expect to receive no RTP packets containing codec mode requests for EVS primary mode and may use this information when deciding upon the required resources.\nFor cmr with value -1 or 0, the IMS-AGW shall also send no RTP packets containing codec mode requests for EVS primary mode.\nDifferent cmr values in the local and remote descriptors are an error situation, but it is permissible that this parameter is only supplied in one of those descriptors.\nch-aw-recv (NOTE 1, NOTE 7)\nThe IMS-AGW should expect to receive RTP packets containing the indicated partial redundancy mode and may use this information when deciding upon the required resources.\nThe IMS-AGW shall send RTP packets containing the indicated partial redundancy mode.\nnumber of channels (NOTE 2)\nIf no ch-recv parameter in the local descriptor and no ch-send parameter in the remote descriptors are received, the IMS-AGW should expect to receive RTP packets containing the indicated number of channels and may use this information when deciding upon the required resources.\nIf no ch-send parameter in the local descriptor and no ch-recv parameter in the remote descriptors are received, the IMS-AGW shall also send RTP packets containing the indicated number of channels.\nDifferent number of channels values in the local and remote descriptors is an error situation, but it is permissible that this parameter is only supplied in one of those descriptors.\nIf no ch-recv parameter in the local descriptor and no ch-send parameter in the remote descriptors are received, the IMS-AGW should expect to receive RTP packets containing the indicated number of channels and may use this information when deciding upon the required resources.\nIf no ch-send parameter in the local descriptor and no ch-recv parameter in the remote descriptors are received, the IMS-AGW shall also send RTP packets containing the indicated number of channels.\nDifferent number of channels values in the local and remote descriptors is an error situation, but it is permissible that this parameter is only supplied in one of those descriptors.\nch-send (NOTE 1)\nThe IMS-AGW shall send RTP packets containing the indicated number of channels.\nDifferent number of channels in the ch-send parameter in the local descriptor and the ch-recv parameter in the remote descriptors is an error situation, but it is permissible that this parameter is only supplied in one of those descriptors.\nThe IMS-AGW should expect to receive RTP packets containing the indicated number of channels and may use this information when deciding upon the required resources.\nDifferent number of channels in the ch-send parameter in the local descriptor and the ch-recv parameter in the remote descriptors is an error situation, but it is permissible that this parameter is only supplied in one of those descriptors.\nch-recv (NOTE 1)\nThe IMS-AGW should expect to receive RTP packets containing the indicated number of channels and may use this information when deciding upon the required resources.\nDifferent number of channels in the ch-send parameter in the local descriptor and the ch-recv parameter in the remote descriptors is an error situation, but it is permissible that this parameter is only supplied in one of those descriptors.\nThe IMS-AGW shall send RTP packets containing the indicated number of channels.\nDifferent number of channels in the ch-send parameter in the local descriptor and the ch-recv parameter in the remote descriptors is an error situation, but it is permissible that this parameter is only supplied in one of those descriptors.\nmode-set (NOTE 4)\nFor AMR-WB IO mode, the IMS-AGW should expect to receive RTP packets using only the indicated mode-set and may use this information when deciding upon the required resources.\nThe IMS-AGW shall also send RTP packets only using the indicated mode-set.\nDifferent mode-set values in the local and remote descriptors are an error situation, but it is permissible that this parameter is only supplied in one of those descriptors.\nFor AMR-WB IO mode, the IMS-AGW should expect to receive RTP packets using only the indicated mode-set and may use this information when deciding upon the required resources.\nThe IMS-AGW shall also send RTP packets only using the indicated mode-set.\nDifferent mode-set values in the local and remote descriptors are an error situation, but it is permissible that this parameter is only supplied in one of those descriptors.\nmode-change-period (NOTE 3)\nFor AMR-WB IO mode, the IMS-AGW should expect to receive packets with this mode-change-period and may use this information when deciding upon the required resources.\nFor AMR-WB IO mode, the IMS-AGW shall use this mode-change-period when sending packets.\nmode-change-capability (NOTE 6)\nFor AMR-WB IO mode, mode-change-capability with value 2 indicates that the IMS-AGW should expect to be requested to send packets with restricted mode-change-period and may use this information when deciding upon the required resources.\nNo IMS-AGW handling of this parameter id defined.\nmode-change-neighbor (NOTE 3)\nThe IMS-AGW should expect to receive packets with this mode-change-period and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use this mode-change-period when sending packets.\nmax-red (NOTE 5)\nThe IMS-AGW should expect to receive packets with redundancy up to the indicated max-red value and may use this information when deciding upon the required resources.\nThe IMS-AGW shall only send packet with redundancy up to the indicated max-red value.\n3gpp_mtsi_app_adapt (NOTE 4)\nThe IMS-AGW should expect to receive RTCP APP packets of the indicated types and may use this information when deciding upon the required resources.\nThe IMS-AGW may send RTCP APP packets of the indicated types. The IMS-AGW shall not send other RTCP APP packets. If the parameter is not supplied, the IMS-AGW shall not send any RTCP APP packets.\nNOTE 1:\tThis MIME parameter of the EVS RTP payload type is defined in 3GPP TS 26.445 [51]. The values and the defaults if a parameter is omitted, as defined in 3GPP TS 26.445 [51] shall apply.\nNOTE 2:\tThis number of channels are encoded as \"encoding parameters\" of the SDP \"a=rtpmap\" attribute defined in IETF RFC 4566 [53].\nNOTE 3:\tThis MIME parameter of the EVS RTP payload type relates to AMR-WB IO mode and is defined in IETF RFC 4867 [54]. The values and the defaults if a parameter is omitted, as defined in IETF RFC 4867 [54] shall apply.\nNOTE 4:\tThis SDP attribute is defined in 3GPP TS 26.114 [21]. It applies to all codecs offered in an SDP media line. However, some values are specific to EVS.\nNOTE 5:\tThis MIME parameter of the EVS RTP payload type is defined in IETF RFC 4867 [54]. The values and the defaults if a parameter is omitted, as defined in IETF RFC 4867 [54] shall apply.\nNOTE 6:\tThis MIME parameter of the EVS RTP payload type relates to AMR-WB IO mode and is defined in IETF RFC 4867 [54]. The values and the defaults if a parameter is omitted, as defined in 3GPP TS 26.445 [51], shall apply.\nNOTE 7:\tThe frame erasure rate indicator for the channel-aware mode has two permissible values (LO, HI) and this indicator has to be initialized to HI, as specified in clause 5.8.4 of 3GPP TS 26.445 [51].\nNOTE 8:\tIf both the dtx and the dtx-recv parameter are provided either in the local or in the remote descriptor, both parameters will have the same value within that descriptor.",
      "chunk_type": "general",
      "cross_references": [
        "ts_26.445_clause_5.8.4",
        "table_5.13.3.1",
        "ts_26.445_table_5.13.3.1",
        "table_5.13.3.2",
        "ts_26.445_table_5.13.3.2",
        "table_5.13.3.3",
        "ts_29.162_figure_10.2.5.2",
        "ts_26.441",
        "ts_26.445",
        "ts_26.114",
        "ts_29.162"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.13.4",
      "section_id": "5.13.4",
      "section_title": "Handling of the OPUS speech and audio codec for WebRTC",
      "content": "The OPUS speech and audio codec is defined in IETF RFC 6716 [50]. Its RTP payload type is defined in IETF RFC 7587 [56].\nThe eP-CSCF and the eIMS-AGW should support transcoding to and from the OPUS speech codec. If they do so, the procedures in the present clause apply.\nWhen receiving an SDP offer from the core network, the IMS-ALG may add an OPUS codec payload type (as specified in IETF RFC 7587 [56]) before forwarding the SDP offer towards the served WebRTC UE (denoted as \"codec 3\" in figure 10.2.5.2 of 3GPP TS 29.162 [20]). If that OPUS payload type is selected in the SDP answer, the IMS-ALG needs to transcode the OPUS codec. Table 5.13.4.1 describes the IMS-ALG handling of the OPUS codec parameters when the IMS-ALG adds an OPUS payload type to the SDP offer, and that OPUS payload type is selected in the SDP answer. In addition, rules for the parameter handling in IETF RFC 7587 [56] shall apply.\nTable 5.13.4.1: IMS-ALG handling of OPUS related SDP parameters when the IMS-ALG adds the OPUS payload type to the SDP offer.\nParameter\nHandling for OPUS payload type added to the SDP offer to offer transcoding\nHandling if offered OPUS payload type is accepted in the SDP answer\nmaxplaybackrate (NOTE)\nShould be set according to IMS-AGW capabilities and sampling rates of expected codecs to transcode with (E.g. other codecs in the received SDP offer).\nIf parameter is contained in the SDP answer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor.\nsprop-maxcapturerate (NOTE)\nShould be set according to IMS-AGW capabilities and sampling rates of expected codecs to transcode with (E.g. other codecs in the received SDP offer).\nIf parameter is contained in the SDP answer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor.\nmaxaveragebitrate (NOTE)\nShould be set according to IMS-AGW capabilities and sampling rates of expected codecs to transcode with (E.g. other codecs in the received SDP offer), see IETF RFC 7587 [56].\nIf parameter is contained in the SDP answer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor.\nstereo (NOTE)\nShould be set to 0 or omitted, unless the expected codecs to transcode with (E.g. other codecs in the received SDP offer) support stereo and the IMS-AGW supports stereo transcoding.\nIf parameter is contained in the SDP answer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor.\nsprop-stereo (NOTE)\nShould be set to 0 or omitted, unless the expected codecs to transcode with (E.g. other codecs in the received SDP offer) support stereo and the IMS-AGW supports stereo transcoding.\nIf parameter is contained in the SDP answer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor.\ncbr (NOTE)\nShould be set or omitted according to IMS-AGW capabilities and used encryption.\nIf parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor.\nuseinbandfec (NOTE)\nShould be set or omitted according to IMS-AGW capabilities and delay budget.\nIf parameter is contained in the SDP answer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor.\nusedtx (NOTE)\nShould be set according to IMS-AGW preferences and DTX capabilities of expected codecs to transcode with (E.g. other codecs in the received SDP offer).\nIf parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor.\nNOTE:\tThis MIME parameter of the OPUS RTP payload type is defined in IETF RFC 7587 [56]. It is encapsulated within the SDP \"a=fmtp\" attribute defined in IETF RFC 4566 [55].\nWhen receiving an SDP offer from the served WebRTC UE that contains an OPUS codec payload type, the IMS-ALG may add other payload types before forwarding the SDP offer (denoted as \"codec 3\" in figure 10.2.5.2 of 3GPP TS 29.162 [20]). If that added payload type is selected in the SDP answer, the IMS-ALG needs to transcode, and may select to transcode to the OPUS codec. Table 5.13.4.2 describes the IMS-ALG handling of the OPUS codec parameters when the IMS-ALG receives the OPUS payload type in the SDP offer, and selects to transcode between the OPUS codec and some other codec. In addition, rules for the parameter handling in IETF RFC 7587 [56] shall apply.\nTable 5.13.4.2: IMS-ALG handling of OPUS related SDP parameters when the IMS-ALG receives the OPUS payload type to the SDP offer and decides to transcode between the OPUS payload type and some other codec.\nParameter\nHandling of OPUS payload type parameter received in the SDP offer\nOPUS payload type supplied in the SDP answer\nmaxplaybackrate (NOTE)\nIf parameter is contained in the SDP offer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nShould be set according to IMS-AGW capabilities and sampling rates of expected codecs to transcode with (E.g. other codecs in the received SDP offer).\nsprop-maxcapturerate (NOTE)\nIf parameter is contained in the SDP offer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nShould be set according to IMS-AGW capabilities and sampling rates of expected codecs to transcode with (E.g. other codecs in the received SDP offer).\nmaxaveragebitrate (NOTE)\nIf parameter is contained in the SDP offer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nShould be set according to IMS-AGW capabilities and sampling rates of expected codecs to transcode with (E.g. other codecs in the received SDP offer), see IETF RFC 7587 [56].\nstereo (NOTE)\nIf parameter is contained in the SDP offer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nShould be set to 0 or omitted, unless the expected codecs to transcode with (E.g. other codecs in the received SDP offer) support stereo and the IMS-AGW supports stereo transcoding.\nsprop-stereo (NOTE)\nIf parameter is contained in the SDP offer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nShould be set to 0 or omitted, unless the expected codecs to transcode with (E.g. other codecs in the received SDP offer) support stereo and the IMS-AGW supports stereo transcoding.\ncbr (NOTE)\nIf parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nShould be set or omitted according to IMS-AGW capabilities and used encryption.\nuseinbandfec (NOTE)\nIf parameter is contained in the SDP offer, the IMS-ALG should forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nShould be set or omitted according to IMS-AGW capabilities and delay budget.\nusedtx (NOTE)\nIf parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nShould be set according to IMS-AGW preferences and DTX capabilities of expected codecs to transcode with (E.g. other codecs in the received SDP offer).\nNOTE 1:\tThis MIME parameter of the OPUS RTP payload type is defined in IETF RFC 7587 [56]. It is encapsulated within the SDP \"a=fmtp\" attribute defined in IETF RFC 4566 [55].\nTable 5.13.4.3 describes the IMS-AGW handling of the OPUS codec parameters. The IMS-AGW should support transcoding of OPUS with at least the bandwidths (sampling rates) which are supported by codec the IMS-AGW is capable to transcode OPUS to/from (e.g. NB for AMR, and WB for AMR-WB).\nTable 15.3.4.3: IMS-AGW handling of OPUS codec parameters.\nParameter\nHandling in local descriptor\nHandling in remote descriptor\nmaxplaybackrate (NOTE)\nThe IMS-AGW should expect to receive RTP packets with sampling rates up to the indicated maximum and may use this information when deciding upon the required resources.\nThe IMS-AGW should send RTP packets with the indicated sampling rate.\nsprop-maxcapturerate (NOTE)\nNo IMS-AGW handling of this parameter is defined.\nThe IMS-AGW should expect to receive RTP packets with sampling rates up to the indicated maximum and may use this information when deciding upon the required resources.\nmaxaveragebitrate (NOTE)\nThe IMS-AGW should expect to receive RTP packets with average bit rates up to the indicated maximum and may use this information when deciding upon the required resources.\nThe IMS-AGW shall send RTP packets with average bit rates up to the indicated maximum.\nstereo (NOTE)\nThe IMS-AGW should expect to receive RTP packets containing the indicated stereo mode and may use this information when deciding upon the required resources.\nThe IMS-AGW should send RTP packets containing the indicated stereo mode.\nsprop-stereo (NOTE)\nNo IMS-AGW handling of this parameter is defined.\nThe IMS-AGW should expect to receive RTP packets containing the indicated stereo mode and may use this information when deciding upon the required resources.\ncbr (NOTE)\nThe IMS-AGW should expect to receive RTP packets containing the indicated constant bit rate mode and may use this information when deciding upon the required resources.\nThe IMS-AGW should send RTP packets containing the indicated constant bit rate mode.\nuseinbandfec (NOTE)\nThe IMS-AGW should expect to receive RTP packets containing the indicated forward error correction mode and may use this information when deciding upon the required resources.\nThe IMS-AGW should send RTP packets containing the indicated forward error correction mode.\nusedtx (NOTE)\nThe IMS-AGW should expect to receive RTP packets containing the indicated DTX mode and may use this information when deciding upon the required resources.\nThe IMS-AGW should send RTP packets using the indicated DTX mode.\nNOTE 1:\tThis MIME parameter of the OPUS RTP payload type is defined in IETF RFC 7587 [56]. The default value if a parameter is omitted, as defined in IETF RFC 7587 [56], shall apply.",
      "chunk_type": "general",
      "cross_references": [
        "table_5.13.4.1",
        "table_5.13.4.2",
        "table_5.13.4.3",
        "table_15.3.4.3",
        "ts_29.162_figure_10.2.5.2",
        "ts_29.162"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.13.5",
      "section_id": "5.13.5",
      "section_title": "Handling of the IVAS speech and audio codec",
      "content": "The Immersive Voice and Audio Services (IVAS) speech and audio codec is defined in 3GPP TS 26.250 [86]. Its RTP payload type is defined in 3GPP TS 26.253 [87], and procedures for its usage as IMS Multimedia Telephony speech codec are defined in 3GPP TS 26.114 [21].\nThe IMS-ALG and the IMS-AGW may support transcoding the IVAS speech and audio codec to and from another (mono-format) codec (e.g. AMR-WB or EVS). If they do so, the IMS-ALG and the IMS-AGW shall support transcoding to and from the IVAS codec using EVS Primary or AMR-WB IO mode, shall support transcoding from the IVAS codec using the IVAS Immersive mode (i.e. decoding the IVAS codec using the IVAS Immersive mode) and they may support transcoding to the IVAS codec using the IVAS Immersive mode, and the procedures in the present clause apply.\nNOTE 1:\tDuring an SRVCC handover, when IVAS using Immersive operation is used before the access transfer procedure and the use of IVAS CMR is permitted towards IMS CN side (as signaled in the cmr parameter during the earlier SDP negotiation), the IMS-AGW can request the use of IVAS using EVS Primary or AMR-WB IO mode on the IMS CN side by using IVAS CMR to EVS Primary or AMR-WB IO operation (see clause A.3.3.3.3 of 3GPP TS 26.253 [87]) if transcoding to and from the IVAS codec using EVS Primary or AMR-WB IO mode is desired after the SRVCC handover. The IVAS mode initially used during the SRVCC handover can later be modified.\nNOTE 2:\tDuring an SRVCC handover, when IVAS using Immersive operation is used before the access transfer procedure and transcoding to and from the IVAS codec is not supported by the IMS-ALG or IMS-AGW, the IMS-ALG can initiate an SDP re-negotiation towards IMS CN side e.g. to switch to the EVS payload type.\nWhen receiving an SDP offer without the IVAS codec, the IMS-ALG should not add an IVAS codec payload type to the SDP offer it forwards to avoid the need for transcoding between IVAS immersive mode and another codec in this scenario. The IMS-ALG may add an EVS codec payload type to the SDP offer it forwards (see Table 5.13.3.1).\nWhen receiving an SDP offer that contains an IVAS codec payload type (denoted as \"codec 1\" in figure 10.2.5.2 of 3GPP TS 29.162 [20]), the IMS-ALG may add other payload types before forwarding the SDP offer (denoted as \"codec 3\" in figure 10.2.5.2 of 3GPP TS 29.162 [20]). If that added payload type is selected in the SDP answer, the IMS-ALG needs to transcode, and may select to transcode to the IVAS codec. Table 5.13.5.1 describes the IMS-ALG handling of IVAS codec parameters when the IMS-ALG receives an IVAS payload type in an SDP offer and selects to transcode between the IVAS codec and some other codec. In addition, rules for the parameter handling in 3GPP TS 26.253 [87] shall apply.\nTable 5.13.5.1: IMS-ALG handling of IVAS related SDP parameters when the IMS-ALG receives the IVAS payload type in the SDP offer and decides to transcode between the IVAS payload type and some other codec\nParameter\nHandling of IVAS payload type parameter received in the SDP offer\nIVAS payload type supplied in the SDP answer\nivas-mode-switch\n(NOTE 2)\nIf the ivas-mode-switch parameter is contained in the SDP offer and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the ivas-mode-switch parameter is contained in the SDP offer, the IMS-ALG shall include the ivas-mode-switch parameter with unmodified value in the SDP answer.\nOtherwise, if the IMS-ALG decides to interwork between AMR-WB or EVS and IVAS using EVS Primary or AMR-WB IO mode (e.g. because AMR-WB or EVS was selected in the received SDP answer), it shall include the ivas-mode-switch with value 1.\nOtherwise, the IMS-ALG shall not include the ivas-mode-switch.\nIf the IMS-ALG supplies the ivas-mode-switch in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nevs-mode-switch (NOTE 1)\nIf the evs-mode-switch parameter is contained in the SDP offer and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the evs-mode-switch parameter is contained in the SDP offer, the IMS-ALG shall include the evs-mode-switch parameter with unmodified value in the SDP answer.\nOtherwise, if the IMS-ALG decides to interwork between AMR-WB and IVAS using AMR-WB IO mode (e.g. because AMR-WB was selected in the received SDP answer), it shall include the evs-mode-switch with value 1.\nOtherwise, the IMS-ALG shall not include the evs-mode-switch.\nIf the IMS-ALG supplies the evs-mode-switch in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nhf-only (NOTE 1)\nIf the hf-only parameter is contained in the SDP offer and set to 1 and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the hf-only parameter is contained in the SDP offer and set to 1, the IMS-ALG shall include the hf-only parameter with unmodified value in the SDP answer.\nIf the IMS-ALG supplies the hf-only parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\ndtx (NOTE 1)\nIf the dtx parameter is contained in the SDP offer and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the dtx parameter is contained in the SDP offer, the IMS-ALG shall include the dtx parameter with unmodified value in the SDP answer.\nIf the dtx parameter is not contained in the SDP offer and if a dtx-recv parameter is contained in the SDP offer, the IMS-ALG may include the dtx parameter in the SDP answer, and the value of the dtx parameter shall then be identical to that of the dtx-recv parameter in the SDP offer (e.g, if that value matches DTX capabilities of expected codecs to transcode with).\nIf the dtx parameter is not contained in the SDP offer and if the dtx-recv parameter is not contained in the SDP offer, and  if the usage of DTX is not desired (e.g. due to DTX capabilities of expected codecs to transcode with, e.g. other codecs in the received SDP answer), the IMS-ALG shall include in the SDP answer the dtx parameter with a value 0.\nIf the IMS-ALG supplies the dtx parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\ndtx-recv (NOTE 1)\nIf the dtx-recv parameter is contained in the SDP offer and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf no dtx parameter is included in the SDP answer and if the reception of DTX is not desired, the IMS-ALG shall include in the SDP answer the dtx-recv parameter with a value 0.\nIf both the dtx and dtx-recv parameters are included, those parameters shall have the same value; however, inclusion of the dtx-recv parameter is not required if the dtx parameter is included.\nIf the IMS-ALG supplies the dtx-recv parameter in the SDP answer, it should also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nbr (NOTE 1)\nIf the br parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the send and receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select the IVAS payload type for transcoding. If the IMS-ALG selects the IVAS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the br parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the br parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires the same bit rate range for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range to match IMS-AGW capabilities and possible configured policies, it shall supply the br parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include this parameter in the SDP answer.\nIf the IMS-ALG also supplies the bw, bw-send or bw-recv parameter, the value of the br parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br parameter in the SDP answer, it shall also supply to the IMS-AGW the br parameter in the local descriptor for the termination towards the offerer with the same value.\nbr-send (NOTE 1)\nIf the br-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select the IVAS payload type for transcoding. If the IMS-ALG selects the IVAS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the br-recv parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br-recv value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the br-send parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires a different bit rate (range) for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range for the send direction to match IMS-AGW capabilities and possible configured policies, it shall supply the br-send parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include the br-send parameter in the SDP answer.\nIf the IMS-ALG also supplies the bw or bw-send parameter, the value of the br-send parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br-send parameter in the SDP answer, it shall also supply to the IMS-AGW the br-send parameter in the local descriptor for the termination towards the offerer with the same value.\nbr-recv (NOTE 1)\nIf the br-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the send direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select the IVAS payload type for transcoding. If the IMS-ALG selects the IVAS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the br-send parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br-send value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the br-recv parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires a different bit rate (range) for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range for the receive direction to match IMS-AGW capabilities and possible configured policies, it shall supply the br-recv parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include the br-recv parameter in the SDP answer.\nIf the IMS-ALG also supplies the bw or bw-recv parameter, the value of the br-recv parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br-recv parameter in the SDP answer, it shall also supply to the IMS-AGW the br-recv parameter in the local descriptor for the termination towards the offerer with the same value.\nbw (NOTE 1)\nIf the bw parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidth(s), or a subset of them, in EVS primary mode in the send and receive direction. If the indicated sampling bandwidth(s), and even each subset of them, are not supported, the IMS-ALG shall not select the IVAS payload type for transcoding. If the IMS-ALG selects the IVAS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the bw parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidth value, which is either the received bw value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the bw parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires the same sampling bandwidth(s) for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidth(s) to match IMS-AGW capabilities and possible configured policies, it shall supply the bw parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include this parameter in the SDP answer.\nIf the IMS-ALG also supplies the br, br-send or br-recv parameter, the value of the bw parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw parameter in the SDP answer, it shall also supply to the IMS-AGW the bw parameter in the local descriptor for the termination towards the offerer with the same value.\nbw-send (NOTE 1)\nIf the bw-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidths, or a subset of them, in EVS primary mode in the receive direction. If the indicated sampling bandwidths, and even each subset of them, are not supported, the IMS-ALG shall not select the IVAS payload type for transcoding. If the IMS-ALG selects the IVAS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the bw-recv parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidths value, which is either the received bw-recv value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the bw-send parameter with the selected value in the SDP answer.\nOtherwise, if the IMS-ALG desires different sampling bandwidths for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidths for the send direction to match IMS-AGW capabilities and possible configured policies, it shall supply the bw-send parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include the br-send parameter in the SDP answer.\nIf the IMS-ALG also supplies the br or br-send parameter, the value of the bw-send parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw-send parameter in the SDP answer, it shall also supply to the IMS-AGW the bw-send parameter in the local descriptor for the termination towards the offerer with the same value.\nbw-recv (NOTE 1)\nIf the br-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidths, or a subset of them, in EVS primary mode in the send direction. If the indicated sampling bandwidths, and even each subset of them, are not supported, the IMS-ALG shall not select the IVAS payload type for transcoding. If the IMS-ALG selects the IVAS payload type, it shall forward the bw-recv parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the bw-send parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidths value, which is either the received bw-send value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the bw-recv parameter with the selected value in the SDP answer.\nOtherwise, if the IMS-ALG desires a different sampling bandwidths for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidths for the receive direction to match IMS-AGW capabilities and possible configured policies, it shall supply the bw-recv parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include the bw-recv parameter in the SDP answer.\nIf the IMS-ALG also supplies the br or br-recv parameter, the value of the bw-recv parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw-recv parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\ncmr (NOTE 2)\nIf the cmr parameter is contained in the SDP offer and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the cmr parameter is contained in the SDP offer, the IMS-ALG shall include the cmr parameter with unmodified value in the SDP answer.\nOtherwise, if the IMS-AGW desires to disable codec mode requests within the IVAS RTP payload (due to the IMS-AGW capabilities or policies), it shall include the cmr parameter with value -1 in the SDP answer it sends.\nIf the IMS-ALG supplies the cmr parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nch-aw-recv (NOTE 1)\nIf the ch-aw-recv parameter is contained in the SDP offer the IMS-ALG shall check if the IMS-AGW supports the indicated mode in the send direction. If the indicated mode is not supported, the IMS-ALG shall not select the IVAS payload type for transcoding. If the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the IMS-ALG it desires to control the channel-aware mode of IVAS in EVS Primary mode in the receive direction, e.g. to disable it with value -1, it shall include the ch-aw-recv parameter in the SDP offer and shall also supply the ch-aw-recv parameter to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value. The IMS-ALG shall consider the capabilities of the IMS-AGW when it chooses an appropriate value.\nmode-set (NOTE 3)\nIf the mode-set parameter is contained in the SDP offer and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the mode-set parameter is contained in the SDP offer and the IMS-ALG expects that IVAS using AMR-WB IO mode will be interworked with AMR-WB (e.g. if IVAS is the first payload type in the received SDP offer, and the IMS-ALG adds a AMR-WB payload type), the IMS-ALG should include the mode-set parameter with the same value for the AMR-WB payload in the SDP offer it forwards.\nIf the mode-set parameter is contained in the SDP offer, the IMS-ALG shall include the mode-set parameter with unmodified value in the SDP answer.\nOtherwise, if the mode-set parameter is contained in the SDP answer for an AMR-WB payload type and the IMS-ALG decides that the IVAS codec using AMR-WB IO mode will be interworked with that AMR-WB payload type, the IMS-ALG should include that mode-set parameter for the IVAS payload in the SDP answer it forwards.\nIf the IMS-ALG supplies the mode-set parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmode-change-period (NOTE 3)\nIf the mode-change-period parameter is contained in the SDP offer and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the mode-change-period parameter is contained in the SDP offer and the IMS-ALG expects that IVAS using AMR-WB IO mode will be interworked with AMR-WB (e.g. if IVAS is the first payload type in the received SDP offer, and the IMS-ALG adds the AMR-WB payload type), the IMS-ALG should include the mode-change-period parameter with the same value for the AMR-WB payload type in the SDP offer it forwards.\nIf the mode-change-period parameter is contained in the SDP answer for the AMR-WB payload type and the IMS-ALG decides the IVAS codec using AMR-WB IO mode will be interworked with that AMR-WB payload type, the IMS-ALG should include the mode-change-period parameter for the IVAS payload in the SDP answer it forwards.\nIf the IMS-ALG supplies the mode-change-period parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmode-change-capability (NOTE 3)\nIf the mode-change-capability parameter is contained in the SDP offer and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG may forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the IMS-ALG expects that IVAS using AMR-WB IO mode will be interworked with AMR-WB (e.g. if IVAS is the first payload type in the received SDP offer, and the IMS-ALG adds the AMR-WB payload type), the IMS-ALG should include the mode-change-capability parameter with value 2 for the AMR-WB payload in the SDP offer it forwards.\nIf the IMS-ALG decides that the IVAS codec using AMR-WB IO mode is selected, the IMS-ALG shall either include the mode-change-capability parameter with value 2 or omit the parameter for the IVAS payload in the SDP answer it forwards.\nIf the IMS-ALG supplies the mode-change-capability parameter in the SDP answer, it may also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmode-change-neighbor (NOTE 3)\nIf the mode-change-neighbor parameter is contained in the SDP offer and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the mode-change-neighbor parameter is contained in the SDP offer and the IMS-ALG expects that IVAS using AMR-WB IO mode will be interworked with AMR-WB (e.g. if IVAS is the first payload type in the received SDP offer, and the IMS-ALG adds the AMR-WB payload type), the IMS-ALG should include the mode-change-neighbor with the same value for the AMR-WB payload in the SDP offer it forwards.\nIf the mode-change-neighbor parameter is contained in the SDP answer for the AMR-WB payload type and the IMS-ALG decides that the IVAS codec using AMR-WB IO mode will be interworked with that AMR-WB payload type, the IMS-ALG should include the mode-change-neighbor parameter for the IVAS payload in the SDP answer it forwards.\nIf the IMS-ALG supplies the mode-change-neighbor parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmax-red (NOTE 5)\nIf the max-red parameter is contained in the SDP offer and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the max-red parameter is contained in the SDP offer and the IMS-ALG expects that IVAS using AMR-WB IO mode will be interworked with AMR-WB (e.g. if IVAS is the first payload type in the received SDP offer, and the IMS-ALG adds the AMR-WB payload type), the IMS-ALG should include the max-red parameter with the same value for the AMR-WB payload in the SDP offer it forwards with a value that considers the received value and the capabilities of the IMS-AGW.\nThe IMS-ALG shall only include the max-red parameter in the SDP answer if it desires to restrict the maximum redundancy of received packets. When selecting the value of the max-red parameter, the IMS-ALG shall consider the capabilities of the IMS-AGW and, if the max-red parameter is contained in the SDP answer for the AMR-WB payload type and the IMS-ALG decides that the IVAS codec using AMR-WB IO mode will be interworked with that AMR-WB payload type, the received value.\nIf the IMS-ALG supplies the max-red parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\n3gpp_mtsi_app_adapt (NOTE 4)\nIf the 3gpp_mtsi_app_adapt parameter is contained in the SDP offer, and the IMS-ALG selects the IVAS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nIf the IMS-AGW supports RTCP APP based adaptation messages defined in 3GPP TS 26.114 [21], and the IMS-ALG has a policy to negotiate the usage of those messages, the IMS-ALG shall include the 3gpp_mtsi_app_adapt SDP attribute indicating the supported APP messages in the SDP answer.\nibr (NOTE 2)\nIf the ibr parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, for IVAS immersive operation in the send and receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select transcoding with IVAS.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the ibr parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received ibr value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the ibr parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires the same bit rate range for the send and receive direction for IVAS immersive operation, and wants to restrict the bit rate range to match IMS-AGW capabilities and possible configured policies, it shall supply the ibr parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include this parameter in the SDP answer.\nIf the IMS-ALG also supplies the ibw, ibw-send or ibw-recv parameter, the value of the ibr parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the ibr parameter in the SDP answer, it shall also supply to the IMS-AGW the ibr parameter in the local descriptor for the termination towards the offerer with the same value.\nibr-send\n(NOTE 2)\nIf the ibr-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, for IVAS immersive operation in the receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select transcoding with IVAS.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the ibr-recv parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received ibr-recv value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the ibr-send parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires a different bit rate (range) for the send and receive direction for IVAS immersive operation, and wants to restrict the bit rate range for the send direction to match IMS-AGW capabilities and possible configured policies, it shall supply the ibr-send parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include the ibr-send parameter in the SDP answer.\nIf the IMS-ALG also supplies the ibw or ibw-send parameter, the value of the ibr-send parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the ibr-send parameter in the SDP answer, it shall also supply to the IMS-AGW the ibr-send parameter in the local descriptor for the termination towards the offerer with the same value.\nibr-recv (NOTE 2)\nIf the ibr-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, for IVAS immersive operation in the send direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select transcoding with IVAS.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the ibr-send parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received ibr-send value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the ibr-recv parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires a different bit rate (range) for the send and receive direction for IVAS immersive operation, and wants to restrict the bit rate range for the receive direction to match IMS-AGW capabilities and possible configured policies, it shall supply the ibr-recv parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include the ibr-recv parameter in the SDP answer.\nIf the IMS-ALG also supplies the ibw or ibw-recv parameter, the value of the ibr-recv parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the ibr-recv parameter in the SDP answer, it shall also supply to the IMS-AGW the ibr-recv parameter in the local descriptor for the termination towards the offerer with the same value.\nibw (NOTE 2)\nIf the ibw parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bandwidth(s), or a subset of them, for IVAS immersive operation in the send and receive direction. If the indicated sampling bandwidth(s), and even each subset of them, are not supported, the IMS-ALG shall not select transcoding with IVAS.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the ibw parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidth value, which is either the received ibw value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the ibw parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires the same sampling bandwidth(s) for the send and receive direction for IVAS immersive operation, and wants to restrict the sampling bandwidth(s) to match IMS-AGW capabilities and possible configured policies, it shall supply the bw parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include this parameter in the SDP answer.\nIf the IMS-ALG also supplies the ibr, ibr-send or ibr-recv parameter, the value of the ibw parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the ibw parameter in the SDP answer, it shall also supply to the IMS-AGW the ibw parameter in the local descriptor for the termination towards the offerer with the same value.\nibw-send (NOTE 2)\nIf the ibw-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bandwidths, or a subset of them, for IVAS immersive operation in the receive direction. If the indicated sampling bandwidths, and even each subset of them, are not supported, the IMS-ALG shall not select transcoding with IVAS.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the ibw-recv parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidths value, which is either the received ibw-recv value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the ibw-send parameter with the selected value in the SDP answer.\nOtherwise, if the IMS-ALG desires different sampling bandwidths for the send and receive direction for IVAS immersive operation, and wants to restrict the sampling bandwidths for the send direction to match IMS-AGW capabilities and possible configured policies, it shall supply the ibw-send parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include the ibr-send parameter in the SDP answer.\nIf the IMS-ALG also supplies the ibw or ibw-send parameter, the value of the ibr-send parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the ibw-send parameter in the SDP answer, it shall also supply to the IMS-AGW the ibw-send parameter in the local descriptor for the termination towards the offerer with the same value.\nibw-recv (NOTE 2)\nIf the ibr-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bandwidths, or a subset of them, for IVAS immersive operation in the send direction. If the indicated sampling bandwidths, and even each subset of them, are not supported, the IMS-ALG shall not select transcoding with IVAS.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the ibw-send parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidths value, which is either the received ibw-send value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include the ibw-recv parameter with the selected value in the SDP answer.\nOtherwise, if the IMS-ALG desires a different sampling bandwidths for the send and receive direction for IVAS immersive operation, and wants to restrict the sampling bandwidths for the receive direction to match IMS-AGW capabilities and possible configured policies, it shall supply the ibw-recv parameter in the SDP answer it sends.\nOtherwise, the IMS-ALG shall not include the ibw-recv parameter in the SDP answer.\nIf the IMS-ALG also supplies the ibr or ibr-recv parameter, the value of the ibw-recv parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the ibw-send parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\ncf (NOTE 2)\nIf the cf parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated IVAS coded-formats, or a subset of them, for IVAS immersive operation in the send and receive direction. The IMS-ALG shall remove from the received list the coded-formats not supported by the IMS-AGW.\nIf none of the indicated IVAS coded-formats are supported, the IMS-ALG shall not select transcoding with IVAS.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the cf parameter is contained in the SDP offer, the IMS-ALG shall select the list of IVAS coded-format, based on the received list, IMS-AGW capabilities and possible configured policies, and shall include the cf parameter with the resulting list in the SDP answer.\nIf the IMS-ALG supplies the cf parameter in the SDP answer, the IMS-ALG shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\ncf-send (NOTE 2)\nIf the cf-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated IVAS coded-formats, or a subset of them, for IVAS immersive operation in the receive direction. The IMS-ALG shall remove from the received list the coded-formats not supported by the IMS-AGW.\nIf none of the indicated IVAS coded-formats are supported, the IMS-ALG shall not select transcoding with IVAS.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the cf-recv parameter is contained in the SDP offer, the IMS-ALG shall select the list of IVAS coded-format, based on the received list, IMS-AGW capabilities and possible configured policies, and shall include the cf-send parameter with the resulting list in the SDP answer.\nIf the IMS-ALG supplies the cf-send parameter in the SDP answer, the IMS-ALG shall also supply to the IMS-AGW the cf-send parameter in the local descriptor for the termination towards the offerer with the same value.\ncf-recv (NOTE 2)\nIf the cf-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated IVAS coded-formats, or a subset of them, for IVAS immersive operation in the send direction. The IMS-ALG shall remove from the received list the coded-formats not supported by the IMS-AGW.\nIf none of the indicated IVAS coded-formats are supported, the IMS-ALG shall not select transcoding with IVAS.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the cf-send parameter is contained in the SDP offer, the IMS-ALG shall select the list of IVAS coded-format, based on the received list, IMS-AGW capabilities and possible configured policies, and shall include the cf-recv parameter with the resulting list in the SDP answer.\nIf the IMS-ALG supplies the cf-recv parameter in the SDP answer, the IMS-ALG shall also supply to the IMS-AGW the cf-recv parameter in the local descriptor for the termination towards the offerer with the same value.\npi-types (NOTE 2)\nIf the pi-types parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the received PI data types, for IVAS immersive operation in the send and receive direction.\nThe IMS-ALG shall set the pi-types parameter based on the received value and the IMS-AGW capabilities.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward the resulting parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the pi-types parameter is contained in the SDP offer, the IMS-ALG shall set the pi-types parameter based on the received value and the IMS-AGW capabilities, and shall include the resulting pi-types parameter in the SDP answer.\nIf none of the received PI data types are supported, the IMS-ALG shall not include the pi-types parameter in the SDP answer.\nIf the IMS-ALG supplies the pi-types parameter in the SDP answer, it shall also supply to the IMS-AGW the pi-types parameter in the local descriptor for the termination towards the offerer with the same value.\npi-types-send (NOTE 2)\nIf the pi-types-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the received PI data types, for IVAS immersive operation in the receive direction.\nThe IMS-ALG shall set the pi-types-send parameter based on the received value and the IMS-AGW capabilities.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward the resulting parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the pi-types-recv parameter is contained in the SDP offer, the IMS-ALG shall set the pi-types-send parameter based on the received value and the IMS-AGW capabilities, and shall include the resulting pi-types-send parameter in the SDP answer.\nIf none of the received PI data types are supported, the IMS-ALG shall not include the pi-types-send parameter in the SDP answer.\nIf the IMS-ALG supplies the pi-types-send parameter in the SDP answer, it shall also supply to the IMS-AGW the pi-types-send parameter in the local descriptor for the termination towards the offerer with the same value.\npi-types-recv (NOTE 2)\nIf the pi-types-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the received PI data types, for IVAS immersive operation in the send direction.\nThe IMS-ALG shall set the pi-types-recv parameter based on the received value and the IMS-AGW capabilities.\nIf the IMS-ALG selects transcoding with IVAS, it shall forward the resulting parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the pi-types-send parameter is contained in the SDP offer, the IMS-ALG shall set the pi-types-recv parameter based on the received value and the IMS-AGW capabilities, and shall include the resulting pi-types-recv parameter in the SDP answer.\nIf none of the received PI data types are supported, the IMS-ALG shall not include the pi-types-recv parameter in the SDP answer.\nIf the IMS-ALG supplies the pi-types-recv parameter in the SDP answer, it shall also supply to the IMS-AGW the pi-types-recv parameter in the local descriptor for the termination towards the offerer with the same value.\npi-br (NOTE 2)\nIf the pi-br parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated maximum bitrate, for IVAS immersive operation in the send and receive direction. If the indicated maximum bitrate is not supported, the IMS-ALG shall return the pi-br parameter with the maximum bit rate supported by the IMS-AGW for PI data.\nIf the IMS-ALG selects transcoding with IVAS, the IMS-ALG shall forward the resulting pi-br parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the pi-br parameter is contained in the SDP offer, the IMS-ALG shall select the maximum bit rate value for PI data, based on the received value, IMS-AGW capabilities and possible configured policies, and shall include the pi-ibr parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, the IMS-ALG shall not include this parameter in the SDP answer.\nIf the IMS-ALG supplies the pi-br parameter in the SDP answer, it shall also supply to the IMS-AGW the pi-br parameter in the local descriptor for the termination towards the offerer with the same value.\npi-br-send (NOTE 2)\nIf the pi-br-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated maximum bitrate, for IVAS immersive operation in the receive direction. If the indicated maximum bitrate is not supported, the IMS-ALG shall return the pi-br-recv parameter in the SDP answer with the maximum bit rate supported by the IMS-AGW for PI data.\nIf the IMS-ALG selects transcoding with IVAS, the IMS-ALG shall forward the pi-br-send parameter (possibly modified to the maximum bit rate supported by the IMS-AGW for PI data) to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the pi-br-recv parameter is contained in the SDP offer, the IMS-ALG shall select the maximum bit rate value for PI data, based on the received value, IMS-AGW capabilities and possible configured policies, and shall include the pi-ibr-send parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, the IMS-ALG shall not include this parameter in the SDP answer.\nIf the IMS-ALG supplies the pi-br-send parameter in the SDP answer, it shall also supply to the IMS-AGW the pi-br-send parameter in the local descriptor for the termination towards the offerer with the same value.\npi-br-recv (NOTE 2)\nIf the pi-br-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated maximum bitrate, for IVAS immersive operation in the send direction. If the indicated maximum bitrate is not supported, the IMS-ALG shall return the pi-br-send parameter in the SDP answer with the maximum bit rate supported by the IMS-AGW for PI data.\nIf the IMS-ALG selects transcoding with IVAS, the IMS-ALG shall forward the pi-br-recv parameter (possibly modified to the maximum bit rate supported by the IMS-AGW for PI data) to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the pi-br-send parameter is contained in the SDP offer, the IMS-ALG shall select the maximum bit rate value for PI data, based on the received value, IMS-AGW capabilities and possible configured policies, and shall include the pi-br-recv parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, the IMS-ALG shall not include this parameter in the SDP answer.\nIf the IMS-ALG supplies the pi-br-recv parameter in the SDP answer, it shall also supply to the IMS-AGW the pi-br-recv parameter in the local descriptor for the termination towards the offerer with the same value.\nNOTE 1:\tThis MIME parameter of the IVAS RTP payload type is defined in 3GPP TS 26.445 [51]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 2:\tThis MIME parameter of the IVAS RTP payload type is defined in 3GPP TS 26.253 [87]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 3:\tThis MIME parameter of the IVAS RTP payload type relates to AMR-WB IO mode and is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 4:\tThis SDP attribute is defined in 3GPP TS 26.114 [21]. It applies to all codecs offered in an SDP media line. However, some values are specific to IVAS.\nNOTE 5:\tThis MIME parameter of the IVAS RTP payload type is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nTable 5.13.5.2 describes the IMS-AGW handling of IVAS codec parameters. The IMS-AGW should support transcoding of IVAS with bandwidths (sampling rates) which are supported by codec the IMS-AGW is capable to transcode IVAS to/from (e.g. AMR-WB or EVS).\nTable 5.13.5.2: IMS-AGW handling of IVAS codec parameters\nParameter\nHandling in local descriptor\nHandling in remote descriptor\nivas-mode-switch\n(NOTE 2)\nThe IMS-AGW should expect to receive packets using EVS Primary or AMR-WB IO mode (as defined by the evs-mode-switch parameter) and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use the EVS Primary or AMR-WB IO mode (as defined by the evs-mode-switch parameter) when sending packets.\nevs-mode-switch (NOTE 1)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nhf-only (NOTE 1)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\ndtx (NOTE 1)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\ndtx-recv (NOTE 1)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nbr (NOTE 1)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nbr-send (NOTE 1)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nbr-recv (NOTE 1)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nbw (NOTE 1)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nbw-send (NOTE 1)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nbw-recv (NOTE 1)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\ncmr (NOTE 2)\nFor IVAS in EVS Primary or WB-AMR IO mode: see Table 5.13.3.3.\nAdditionally, for IVAS immersive modes:\nFor cmr with value -1, the IMS-AGW should expect to receive no RTP packets containing codec mode requests and may use this information when deciding upon the required resources.\nFor cmr with value -1 the IMS-AGW shall also send no RTP packets containing codec mode requests.\nFor IVAS in EVS Primary or WB-AMR IO mode: see Table 5.13.3.3.\nAdditionally, for IVAS immersive modes:\nFor cmr with value -1, the IMS-AGW should expect to receive no RTP packets containing codec mode requests and may use this information when deciding upon the required resources.\nFor cmr with value -1 the IMS-AGW shall also send no RTP packets containing codec mode requests.\nch-aw-recv (NOTE 1)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nmode-set (NOTE 4)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nmode-change-period (NOTE 3)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nmode-change-capability (NOTE 6)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nmode-change-neighbor (NOTE 3)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nmax-red (NOTE 5)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\n3gpp_mtsi_app_adapt (NOTE 4)\nSee Table 5.13.3.3.\nSee Table 5.13.3.3.\nibr (NOTE 2)\nIf different values for the ibr parameter are provided in the local and remote descriptors, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with this bitrate range and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use this bitrate range when sending packets.\nIf different values for the ibr parameter are provided in the local and remote descriptors, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with this bitrate range and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use this bitrate range when sending packets.\nibr-send\n(NOTE 2)\nIf different values for the ibr-send parameter in the local descriptor and for the ibr-recv parameter in the remote descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW shall use this bitrate range when sending packets.\nIf different values for the ibr-send parameter in the remote descriptor and for the ibr-recv parameter in the local descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with this bitrate range and may use this information when deciding upon the required resources.\nibr-recv (NOTE 2)\nIf different values for the ibr-send parameter in the remote descriptor and for the ibr-recv parameter in the local descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with this bitrate range and may use this information when deciding upon the required resources.\nIf different values for the ibr-send parameter in the local descriptor and for the ibr-recv parameter in the remote descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW shall use this bitrate range when sending packets.\nibw (NOTE 2)\nIf different values for the ibw parameter are provided in the local and remote descriptors, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with these bandwidth(s) and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use these bandwidth(s) when sending packets.\nIf different values for the ibw parameter are provided in the local and remote descriptors, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with these sampling bandwidth(s) and may use this information when deciding upon the required resources.\nThe IMS-AGW shall use these sampling bandwidth(s) when sending packets.\nibw-send (NOTE 2)\nIf different values for the ibw-send parameter in the local descriptor and for the ibw-recv parameter in the remote descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW shall use these bandwidth(s) when sending packets.\nIf different values for the ibw-send parameter in the remote descriptor and for the ibw-recv parameter in the local descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with these sampling bandwidth(s) and may use this information when deciding upon the required resources.\nibw-recv (NOTE 2)\nIf different values for the ibw-send parameter in the remote descriptor and for the ibw-recv parameter in the local descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets with these sampling bandwidth(s) and may use this information when deciding upon the required resources.\nIf different values for the ibw-send parameter in the local descriptor and for the ibw-recv parameter in the remote descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW shall use these sampling bandwidth(s) when sending packets.\ncf (NOTE 2)\nThe IMS-AGW should expect to receive packets using the IVAS coded-formats indicated by this parameter.\nThe IMS-AGW shall only send packets using the IVAS coded-formats indicated by this parameter.\nThe IMS-AGW should expect to receive packets using the IVAS coded-formats indicated by this parameter.\nThe IMS-AGW shall only send packets using the IVAS coded-formats indicated by this parameter.\ncf-send (NOTE 2)\nIf different values for the cf-send parameter in the local descriptor and for the cf-recv parameter in the remote descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW shall only send packets using the IVAS coded-formats indicated by this parameter.\nIf different values for the cf-send parameter in the remote descriptor and for the cf-recv parameter in the local descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets using the IVAS coded-formats indicated by this parameter.\ncf-recv (NOTE 2)\nIf different values for the cf-send parameter in the remote descriptor and for the cf-recv parameter in the local descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW should expect to receive packets using the IVAS coded-formats indicated by this parameter.\nIf different values for the cf-send parameter in the local descriptor and for the cf-recv parameter in the remote descriptor are provided, one will be a subset of the other, and the smaller range shall apply.\nThe IMS-AGW shall only send packets using the IVAS coded-formats indicated by this parameter.\npi-types (NOTE 2)\nThe IMS-AGW should expect to receive PI data with the PI data types indicated by this parameter. The IMS-AGW may send PI data with the PI data types indicated by this parameter.\nThe IMS-AGW should expect to receive PI data with the PI data types indicated by this parameter. The IMS-AGW may send PI data with the PI data types indicated by this parameter.\npi-types-send (NOTE 2)\nIf different values for the pi-types-send parameter in the local descriptor and for the pi- types-recv parameter in the remote descriptor are provided, only PI data types present in both parameters should be used.\nThe IMS-AGW may send PI data with the PI data types indicated by this parameter.\nIf different values for the pi-types-send parameter in the remote descriptor and for the pi-types-recv parameter in the local descriptor are provided, the IMS-AGW should expect to receive PI data with the PI data types present in both parameters.\nThe IMS-AGW should expect to receive PI data with the PI data types indicated by this parameter.\npi-types-recv (NOTE 2)\nIf different values for the pi-types-send parameter in the remote descriptor and for the pi-types-recv parameter in the local descriptor are provided, the IMS-AGW should expect to receive PI data with the PI data types present in both parameters.\nThe IMS-AGW should expect to receive PI data with the PI data types indicated by this parameter.\nIf different values for the pi-types-send parameter in the local descriptor and for the pi- types-recv parameter in the remote descriptor are provided, only PI data types present in both parameters should be used.\nThe IMS-AGW may send PI data with the PI data types indicated by this parameter.\npi-br (NOTE 2)\nThe IMS-AGW should expect to receive PI data with the maximum bit rate indicated by this parameter.\nThe IMS-AGW may send PI data with the maximum bit rate indicated by this parameter.\nThe IMS-AGW should expect to receive PI data with the maximum bit rate indicated by this parameter.\nThe IMS-AGW may send PI data with the maximum bit rate indicated by this parameter.\npi-br-send (NOTE 2)\nIf different values for the pi-br-send parameter in the local descriptor and for the pi-br-recv parameter in the remote descriptor are provided, the smallest value of the parameters should be used.\nThe IMS-AGW may send PI data with the maximum bit rate indicated by this parameter.\nIf different values for the pi-br-send parameter in the remote descriptor and for the pi-br-recv parameter in the local descriptor are provided, the smallest value of the parameters should be used.\nThe IMS-AGW should expect to receive PI data with the maximum bit rate indicated by this parameter.\npi-br-recv (NOTE 2)\nIf different values for the pi-br-send parameter in the remote descriptor and for the pi-br-recv parameter in the local descriptor are provided, the smallest value of the parameters should be used.\nThe IMS-AGW should expect to receive PI data with the maximum bit rate indicated by this parameter.\nIf different values for the pi-br-send parameter in the local descriptor and for the pi-br-recv parameter in the remote descriptor are provided, the smallest value of the parameters should be used.\nThe IMS-AGW may send PI data with the maximum bit rate indicated by this parameter.\nNOTE 1:\tThis MIME parameter of the IVAS RTP payload type is defined in 3GPP TS 26.445 [51]. The values and the defaults if a parameter is omitted, as defined in 3GPP TS 26.445 [51] shall apply.\nNOTE 2:\tThis MIME parameter of the IVAS RTP payload type is defined in 3GPP TS 26.253 [87]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 3:\tThis MIME parameter of the IVAS RTP payload type relates to AMR-WB IO mode and is defined in IETF RFC 4867 [54]. The values and the defaults if a parameter is omitted, as defined in IETF RFC 4867 [54] shall apply.\nNOTE 4:\tThis SDP attribute is defined in 3GPP TS 26.114 [21]. It applies to all codecs offered in an SDP media line. However, some values are specific to IVAS.\nNOTE 5:\tThis MIME parameter of the IVAS RTP payload type is defined in IETF RFC 4867 [54]. The values and the defaults if a parameter is omitted, as defined in IETF RFC 4867 [54] shall apply.\nNOTE 6:\tThis MIME parameter of the IVAS RTP payload type relates to AMR-WB IO mode and is defined in IETF RFC 4867 [54]. The values and the defaults if a parameter is omitted, as defined in 3GPP TS 26.445 [51], shall apply.",
      "chunk_type": "general",
      "cross_references": [
        "table_5.13.3.1",
        "table_5.13.5.1",
        "ts_26.253_table_5.13.5.1",
        "table_5.13.5.2",
        "table_5.13.3.3",
        "ts_29.162_figure_10.2.5.2",
        "ts_26.250",
        "ts_26.253",
        "ts_26.114",
        "ts_29.162",
        "ts_26.445"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.14",
      "section_id": "5.14",
      "section_title": "Multimedia Priority Service (MPS) Support",
      "content": "The Multimedia Priority Service (MPS) is specified in 3GPP TS 22.153 [22]. The IMS-ALG and IMS-AGW may support the priority treatment of a call/session identified as an MPS call/session. If MPS is supported, the following functional requirements apply:\n-\tUpon receipt of the MPS priority information in the call control signalling:\n-\tThe IMS-ALG shall recognise the call/session as having priority.\n-\tThe IMS-ALG shall send the priority information for a context to the IMS-AGW to enable the priority treatment described below related to the IMS-AGW.\n-\tThe IMS-ALG shall apply priority handling to H.248 transactions related to priority calls/sessions when network resources are congested , e.g., preferential treatment in any queues or buffers.\n-\tThe IMS-ALG may send the updated priority information and, if DiffServ is used, provision a suitable DSCP marking for the updated MPS priority level to the IMS-AGW if it needs to change the priority information previously communicated to the IMS-AGW for an MPS call/session.\n-\tIf the H.248 control association utilises a transport with the possibility for prioritisation, the IMS-ALG may apply priority using the appropriate prioritisation procedures.\n-\tIf the MPS Priority service requires a specific MPS DSCP setting the IMS-ALG shall configure the IMS-AGW to apply a specific MPS DSCP marking to the user data transport packets to indicate that the packets are of a higher priority than those for normal calls.\n-\tIf the IMS-AGW receives an indication to apply a specific MPS DSCP marking to the user data transport packets, it shall apply this DSCP marking to the IP headers.\nNOTE 1:\tSupport of Diffserv procedures by the IMS-AGW assumes an operator uses Diffserv for prioritising user plane traffic related to an MPS call/session.\n-\tWhen the IMS-ALG marks a Context with priority information, the IMS-AGW may use the priority information for selecting resources for the media and signaling transport with priority. The following actions may be taken by the IMS-AGW if it has reached a congested state:\ni)\tseize priority reserved resources; or\nii)\tif resources are congested, indicate that in aCommand Response error code.\nNOTE 2:\tThe Priority information can be used to derive Layer 2 QoS marking and trigger priority identification and priority treatment for other QoS technologies than Diffserv.",
      "chunk_type": "general",
      "cross_references": [
        "ts_22.153"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.15",
      "section_id": "5.15",
      "section_title": "Coordination of Video Orientation",
      "content": "The IMS-ALG and the IMS-AGW may support the Coordination of Video Orientation (CVO) as defined in 3GPP TS 26.114 [21].\nIf the IMS-ALG receives an SDP body containing \"a=extmap\" attribute(s), as defined in IETF RFC 5285 [23], and the \"a=extmap\" attribute(s) contain CVO URN(s) (i.e. the CVO URN for a 2 bit granularity of rotation and/or the CVO URN for a higher granularity of rotation) as defined in 3GPP TS 26.114 [21], then:\na)\tif the IMS-ALG and the IMS-AGW support the CVO feature:\n-\tthe IMS-ALG shall include the \"extended RTP header for CVO\" information element when seizing resources in the IMS-AGW to indicate the IMS-AGW that it shall allow the RTP header extension for CVO to pass; and\nEditor´s Note: It is ffs if the IMS-ALG needs to include the \"extended RTP header for CVO\" information element when seizing terminations of a media agnostic IMS-AGW, or if a media agnostic IMS-AGW always passes any RTP header extension.\n-\tthe IMS-ALG shall forward within SIP signalling, the SDP body received from the preceding node with unmodified \"a=extmap\" attribute(s) to the succeeding node; or\nb)\tif the IMS-AGW does not support the CVO feature, the IMS-ALG shall forward within SIP signalling, the SDP body received from the preceding node without any \"a=extmap\" attributes to the succeeding node.\nNOTE 1:\tThe UE supporting the CVO feature will not send the extended RTP headers for CVO if the UE did not receive any SDP body with the CVO related \"a=extmap\" attribute.\nIf the IMS-AGW supports the CVO feature and has been instructed to pass on the extended RTP header for CVO as described above for both incoming and outgoing terminations then:\n-\tif the IMS AGW does not apply video transcoding, it shall pass any received RTP CVO header extension to succeeding RTP streams; or\n-\tif the IMS-AGW applies video transcoding, it shall keep the video orientation unchanged during the transcoding and copy the received RTP CVO header extension to the succeeding outgoing RTP stream(s) after transcoding the associated group of packets.\nNOTE 2:\tIETF RFC 5285 [23] provides a framework for header extensions and can also be used for non-CVO related purposes. It is an implementation decision of the IMS-AGW if it only passes CVO related RTP header extensions, or if it passes any RTP header extension when being instructed with the \"extended RTP header for CVO\" information element.\nNOTE 3:\tThe behaviour of the IMS-AGW when being instructed with an \"extended RTP header for CVO\" information element only at one termination is an implementation decision.\nNOTE 4:\tUnknown IETF RFC 5285 [23] RTP header extensions are ignored by the destination RTP end system.",
      "chunk_type": "general",
      "cross_references": [
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.16",
      "section_id": "5.16",
      "section_title": "Generic image attributes",
      "content": "The IMS-ALG and the IMS-AGW may support a media-level SDP image attribute \"a=imageattr\" defined in IETF RFC 6236 [24] to negotiate the image size for sending and receiving video as required by 3GPP TS 26.114 [21].\nNOTE:\tThe image attribute may be used within the SDP capability negotiation framework and its use is then specified using the \"a=acap\" parameter.\nIf the IMS-ALG:\n-\tsupports the negotiation of the image size;\n-\treceives an SDP body containing the image attribute(s) \"imageattr\" defined in IETF RFC 6236 [24]; and\n-\tdoes not support or does not apply the video transcoding procedure defined in clause 5.13;\nthe IMS-ALG shall forward the SDP body with unmodified image attribute(s).\nIf the IMS-ALG and the IMS-AGW support the ATCF/ATGW functions then during the access transfer procedures the IMS-ALG may apply the procedure described in clause 6.2.14.6 to negotiate and adjust the image size for sending and receiving video of the session.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.13",
        "clause_6.2.14.6",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.17.1",
      "section_id": "5.17.1",
      "section_title": "Stateless TCP handling",
      "content": "An IMS‑ALG and IMS‑AGW that supports TCP as transport protocol (see IETF RFC 793 [29] and IETF RFC 4145 [30]) shall support the following procedures.\nNOTE 1:\tIt is assumed that pre-Release 12 IMS‑ALGs and IMS‑AGWs also apply these procedures.\nWhen receiving an SDP offer or answer containing a media line for a new TCP based media stream (e.g. with \"TCP\", \"TCP/MSRP\" as transport protocol), the IMS‑ALG:\n-\tshall indicate \"TCP\" (for application-agnostic interworking) or \"TCP/MSRP\" (for application-aware MSRP interworking) as transport protocol to the IMS‑AGW;\n-\tshall indicate the TCP port numbers received in the SDP from the remote peer as destination port in the remote descriptor at the termination towards the SDP sender;\n-\tshall request the IMS‑AGW to allocate a TCP port number at the destination towards the SDP receiver;\n-\tshall replace the TCP port in the received SDP with the TCP port number allocated by the IMS‑AGW and forward the SDP; and\n-\tshall indicate to the IMS‑AGW to perform TCP stateless handling by not including the TCP session setup direction attribute at the interconnected terminations in the same context.\nAn IMS‑AGW receiving an indication of \"TCP\", or \"TCP/MSRP\" as transport protocol, but no indication to perform TCP state-aware handling (via information about the directionality of the TCP session setup):\n-\tshall send a TCP SYN when receiving a TCP SYN at the interconnected termination in the same context;\n-\tshall forward received TCP payload; and\n-\tshall use its own port number as TCP source port numbers and the remote port number received from the IMS‑ALG as TCP destination port numbers and calculate a new TCP checksum for all TCP packets it sends.\nNOTE 2:\tThis mode of operation corresponds to the \"TCP Relay\" mode in ITU-T Recommendation H.248.84 [38].",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.17.2.1",
      "section_id": "5.17.2.1",
      "section_title": "General",
      "content": "An IMS‑ALG and IMS‑AGW that supports TCP as transport protocol (see IETF RFC 793 [29] and IETF RFC 4145 [30]) may support the procedures specified in clause 5.17.2 for state-aware TCP handling.\nNOTE 1:\tState‑aware TCP handling enables modifications of TCP payloads by the IMS‑AGW such as changing the size of the payload and inserting extra protocol layers, e.g. for e2ae media security.\nAn IMS‑ALG and IMS‑AGW that supports state‑aware TCP handling shall support the procedures specified in clause 5.17.2.2 and may additionally support the procedures specified in clause 5.17.2.3.\nNOTE 2:\tThe procedures in clause 5.17.2.3 enable TCP connections between two peers behind remote (far-end) NATs without any other intermediate server capable of acting as a TCP B2BUA (such as a messaging server). However, they are not possible if e2e security is applied for MSRP based media.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_5.17.2",
        "clause_5.17.2.2",
        "clause_5.17.2.3"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.17.2.2",
      "section_id": "5.17.2.2",
      "section_title": "State‑aware TCP handling without support of modifying the TCP setup direction",
      "content": "When the IMS‑ALG receives an SDP offer containing a media line for a new TCP based media stream (e.g. with \"TCP\", \"TCP/MSRP\" as transport protocol), for that TCP based media stream the IMS‑ALG:\n-\tif no media security is applied, shall indicate \"TCP\" (for application-agnostic interworking) or \"TCP/MSRP\" (for application-aware MSRP interworking) as transport protocol to the IMS‑AGW;\n-\tif media security is applied, shall indicate a transport protocol according to clause 5.11 to the IMS‑AGW;\n-\tshall request the IMS‑AGW to allocate a TCP port at the destination towards the SDP answerer;\n-\tshall request the IMS‑AGW to allocate a TCP port at the destination towards the SDP offerer;\n-\tshall indicate the TCP port numbers received in the SDP offer as destination in the remote descriptor at the termination towards the SDP offerer;\n-\tshall indicate to the IMS‑AGW to perform TCP state-aware handling (by indicating the \"actpass\" TCP session setup direction at both interconnected terminations in the same context in the local descriptor);\n-\tif supported by the IMS‑AGW, may indicate to the IMS‑AGW for a given termination to use an incoming TCP connection establishment request (TCP SYN) at that termination as a trigger for sending a TCP connection establishment request at the interconnected termination in the same context;\n-\tif supported by the IMS‑AGW, may indicate to the IMS‑AGW to discard incoming TCP connection establishment requests; and\n-\tshall replace the TCP port in the received SDP offer with the TCP port number allocated by the IMS‑AGW at the termination towards the SDP answerer, shall maintain a received \"a=setup:active\" or \"a=setup:passsive\" SDP attribute (see IETF RFC 4145 [30]) in the SDP offer without modification, and shall forward the SDP offer.\nWhen the IMS‑ALG then receives the SDP answer containing a media line for a new TCP based media stream, for that TCP based media stream the IMS‑ALG:\n-\tshall indicate the TCP port numbers received in the SDP answer as destination in the remote descriptor at the termination towards the SDP answerer;\n-\tif supported by the IMS‑AGW, may indicate to the IMS‑AGW for a given termination to use an incoming TCP connection establishment request (TCP SYN) at that termination as a trigger for sending a TCP connection establishment request at the interconnected termination in the same context;\n-\tif the IMS‑ALG did not indicate to the IMS‑AGW to use the incoming TCP connection establishment request (TCP SYN) at one termination as a trigger for sending a TCP connection establishment request at the interconnected termination in the same context,\n-\tif the SDP answer contains an \"a=setup:active\" SDP attribute (see IETF RFC 4145 [30]), shall indicate to the IMS‑AGW to start a TCP connection establishment at the termination towards the SDP offerer; and\n-\tif the SDP answer contains an \"a=setup:passive\" SDP attribute, shall indicate to the IMS‑AGW to start a TCP connection establishment at the termination towards the SDP answerer;\nNOTE 1:\tClients only supporting MSRP according to IETF RFC 4975 [25] will not use the SDP \"a=setup\" attribute, but will assign the TCP client role to the SDP offerer. However, in 3GPP (Release 8 onwards), OMA and GSMA the support of IETF RFC 6135 [45] is mandated, and the \"a=setup\" attribute will thus be used.\n-\tif the IMS‑ALG previously indicated to the IMS‑AGW to discard incoming TCP connection establishment requests, shall indicate to the IMS‑AGW to process incoming TCP connection establishment requests; and\n-\tshall replace the destination TCP port in the received SDP answer with the TCP port number allocated by the IMS‑AGW at the termination towards the SDP offerer, shall maintain the received \"a=setup\" SDP attribute (RFC 4145 [30]) in the SDP answer without modification, and shall forward the SDP answer.\nAn IMS‑AGW receiving an indication of \"TCP\", or \"TCP/MSRP\" as transport protocol and an indication to perform TCP state-aware handling (via information about the directionality of the TCP session setup):\n-\tif the IMS‑ALG indicated to start a TCP connection establishment at a given termination, shall start the TCP connection establishment at that TCP termination by sending a TCP SYN;\n-\tif the IMS‑ALG indicated to discard incoming TCP connection establishment requests, shall discard any incoming TCP connection establishment requests (support optional for the IMS‑AGW);\n-\tif\na)\tthe IMS‑ALG indicated to use the incoming TCP connection establishment request (TCP SYN) at one termination as a trigger for sending a TCP connection establishment request at the interconnected termination in the same context, and\nb)\tthe IMS‑ALG did not indicate to discard incoming TCP connection establishment requests,\nshall send a TCP SYN when receiving a TCP SYN at the interconnected termination in the same context (support optional for the IMS‑AGW);\n-\tif\na)\tthe IMS‑ALG did not indicate to use the incoming TCP connection establishment request (TCP SYN) at one termination as a trigger for sending a TCP connection establishment request at the interconnected termination in the same context, and\nb)\tthe IMS‑ALG did not indicate to discard incoming TCP connection establishment requests, and\nc)\tthe IMS‑ALG already configured the remote IP address and port or requested latching,\nshall answer any received TCP SYN at a given termination with appropriate messages according to TCP procedures;\n-\tshall forward received TCP payload, performing any required modifications on the TCP payload according to procedures in other parts of this specification; and\n-\tshall use its own port number as TCP source port and the remote port number indicated by the IMS‑ALG as TCP destination port numbers and shall calculate a new TCP checksum for all TCP packets it sends.\nNOTE 2:\tThis mode of operation corresponds to the \"TCP Proxy\" mode in ITU-T Recommendation H.248.84 [38].",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.11"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.17.2.3",
      "section_id": "5.17.2.3",
      "section_title": "State‑aware TCP handling with support of modifying the TCP setup direction",
      "content": "The IMS‑ALG and IMS‑AGW shall perform the same procedures as in clause 5.17.2.2 with modification according to the present clause.\nWhen the IMS‑ALG receives an SDP offer containing a media line for a new TCP based media stream (e.g. with \"TCP\", \"TCP/MSRP\" as transport protocol), for that TCP based media stream the IMS‑ALG:\n-\tif an \"a=setup:active\" SDP attribute (see IETF RFC 4145 [30]) is received in an SDP offer towards a served UE that is possibly behind a remote NAT, the IMS‑ALG\n-\tshould replace this attribute with a \"a=setup:actpass\" or \"a=setup:passive\" SDP attribute; and\n-\tshall then not indicate to the IMS‑AGW to use the incoming TCP connection establishment request (TCP SYN) at the termination towards the offerer as a trigger for sending a TCP connection establishment request at the interconnected termination in the same context towards the answerer;\n-\tif an \"a=setup:active\" SDP attribute (see IETF RFC 4145 [30]) is received in an SDP offer from a served UE, the IMS‑ALG\n-\tmay replace this attribute with a \"a=setup:actpass\" SDP attribute; and\n-\tshall then not indicate to the IMS‑AGW to use the incoming TCP connection establishment request (TCP SYN) at the termination towards the answerer as a trigger for sending a TCP connection establishment request at the interconnected termination in the same context towards the offerer;\nNOTE 1:\tClients only supporting MSRP according to IETF RFC 4975 [25] will not use the SDP \"a=setup\" attribute, but will assign the TCP client role to the SDP offerer. However, in 3GPP (Release 8 onwards), OMA and GSMA the support of IETF RFC 6135 [45] is mandated, and the \"a=setup\" attribute will thus be used.\n-\tshall indicate to the IMS‑AGW to perform TCP state-aware handling, either by indicating the \"actpass\" TCP session setup direction at both interconnected terminations in the same context in the local descriptors, or by indicating the \"passive\" TCP session setup direction at both interconnected terminations in the same context.\nWhen the IMS‑ALG then receives the SDP answer containing a media line for a new TCP based media stream, for that TCP based media stream the IMS‑ALG:\n-\tif\na)\tthe IMS‑ALG received an \"a=setup:active\" SDP attribute in the SDP offer, and\nb)\tthe SDP answer containes an \"a=setup:active\" SDP attribute,\nthen\n-\tif the IMS‑ALG previously indicated \"actpass\" TCP session setup direction at both interconnected terminations to the IMS‑AGW, shall indicate to the IMS‑AGW the \"passive\" TCP session setup direction at both interconnected terminations in the same context in the local descriptors, and\n-\tshall replace the \"a=setup:active\" SDP attribute in the SDP answer with an \"a=setup:passive\" SDP attribute before forwarding the answer.\n-\tif\na)\tthe IMS‑ALG received an \"a=setup:active\" SDP attribute in the SDP offer, and\nb)\tthe SDP answer containes an \"a=setup:passive\" SDP attribute,\nthen\n-\tif the IMS‑ALG previously indicated \"passive\" TCP session setup direction at both interconnected terminations to the IMS‑AGW, shall indicate to the IMS‑AGW the \"actpass\" TCP session setup direction at both interconnected terminations in the same context in the local descriptors, and\n-\tshall retain the \"a=setup:passive\" SDP attribute in the forwarded SDP answer;\n-\tif the IMS‑ALG did not indicate to the IMS‑AGW to use the incoming TCP connection establishment request (TCP SYN) at one termination as a trigger for sending a TCP connection establishment request at the interconnected termination in the same context,\n-\tif the sent SDP answer towards the offerer contains an \"a=setup:active\" SDP attribute (RFC 4145 [30]), indicate to the IMS‑AGW to start a TCP connection establishment at the termination towards the SDP offerer; and\n-\tif the received SDP answer contains an \"a=setup:passive\" SDP attribute, indicate to the IMS‑AGW to start a TCP connection establishment at the termination towards the SDP answerer.\nWhen the IMS‑ALG indicated a \"passive\" TCP setup direction for a termination, the IMS-AGW shall wait for an incoming TCP connection establishment at that termination and shall not start a TCP connection establishment on its own.\nNOTE 2:\tIf the \"passive\" TCP session setup direction has been indicated to the IMS‑AGW at both interconnected terminations, the mode of operation corresponds to the \"TCP Merge\" mode in ITU-T Recommendation H.248.84 [38]. If the \"actpass\" TCP session setup direction has been indicated to the IMS‑AGW at both interconnected terminations, the mode of operation corresponds to the \"TCP Proxy\" mode in ITU-T Recommendation H.248.84 [38].",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_5.17.2.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.18.1",
      "section_id": "5.18.1",
      "section_title": "General",
      "content": "The IMS-ALG and the IMS-AGW may support ICE functionality as specified in IETF RFC 8445 [82] and IETF RFC 8839 [83], and 3GPP TS 24.229 [11] to support a UE residing behind a remote NAT. The present clause describes the requirements for P-CSCF (IMS-ALG) and IMS-AGW when the ICE procedures are supported.\nSupport of full ICE functionality is optional, but if ICE is supported, the IMS-ALG and IMS-AGW shall at least support ICE lite as specified in IETF RFC 8445 [82].\nAn IMS-ALG and IMS-AGW supporting ICE lite may in addition support ICE for TCP according to IETF RFC 6544 [57].\nNOTE 1:\tICE for TCP can be used to offer an alternative transport for media streams with default UDP transport to enable a traversal of UDP-blocking NATs or firewalls. In the present release, the support of ICE for TCP is restricted to media streams with default UDP transport, and to ICE lite.\nThe IMS-ALG and IMS-AGW shall only use host candidates as local ICE candidates.\nNOTE 2:\tIMS-ALG and IMS-AGW are not located behind a NAT (from perspective of the ICE deployment model according to figure 1 in IETF RFC 8445 [82]).\nThe IMS-ALG with IMS-AGW inserted on the media plane shall perform separate ICE negotiation and procedures with the offerer and the answerer and ICE may be applied independently at either side. Furthermore, the IMS-ALG may be configured to apply ICE procedures only towards the access network side.\nWhen the P-CSCF (IMS-ALG) detects no ICE parameters in the received SDP, it shall not configure the IMS-AGW to apply any ICE and STUN related procedures toward the call leg from where the SDP has been received, and if applicable may apply the remote NAT traversal using latching according to clause 5.4.\nAny IMS-AGW supporting ICE shall advertise its support of incoming STUN continuity check procedures. An IMS-AGW supporting full ICE procedures shall in addition advertise its support for originating STUN connectivity check procedures.\nIf the IMS-AGW does not indicate the support of STUN procedures, or if the IMS-ALG is configured not to apply ICE toward a call leg, the IMS-ALG:\n-\tshall not configure the IMS-AGW to apply STUN procedures;\n-\tshall remove any received SDP candidate information from the SDP it forwards; and\n-\tmay apply remote NAT traversal using latching according to clause 5.4.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_5.4",
        "figure_1",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.18.2",
      "section_id": "5.18.2",
      "section_title": "ICE lite",
      "content": "If the IMS-ALG is configured to use ICE lite, or supports only ICE lite, or controls an IMS-AGW that only support ICE lite, the procedures in the present clause apply.\nIf the IMS-ALG receives an initial SDP offer with ICE candidate information but no \"a=ice-lite\" attribute, the IMS-ALG:\n-\tshall not forward the received candidate information in the SDP it sends towards the answerer;\n-\tshall request the IMS-AGW for each media line with UDP as default transport where it decides to use ICE to reserve an ICE host candidate and provide its address information and a related ICE user name fragment and password;\nNOTE 1:\tRequesting only one host candidate per m-line prevents that the IMS-ALG will receive \"a=remote-candidates\" SDP attributes in a subsequent SDP. Requesting separate ufrag and password for each media line simplifies H.248 encoding.\n-\tmay request the IMS-AGW for each media line with UDP as default transport where it decides to use ICE to reserve an additional passive TCP ICE host candidate and provide its address information and a related ICE user name fragment and password;\n-\tshall configure the IMS-AGW to act as STUN server at the host candidate address, i.e. to answer STUN connectivity checks;\n-\tmay provide received remote ICE candidates and the received related ICE user name fragment and password to the IMS-AGW;\n-\tif an \"a=ice-options\" attribute with the value \"ice2\" was present in the received SDP offer, shall include the \"a=ice-options\" attribute with the value \"ice2\" in the SDP answer it forwards;\n-\tshall include the host candidate and related ICE user name fragment and password received from the IMS-AGW in the SDP answer it forwards;\n-\tshall include the \"a=ice-lite\" attribute in the SDP answer it forwards; and\n-\tshall not apply the remote NAT traversal using latching according to clause 5.4.\nIf the IMS-ALG receives SDP offer with ICE candidate information and an \"a=ice-lite\" attribute, the IMS-ALG shall not apply ICE towards that call leg and not include any ICE related SDP attributes in the SDP answer.\nNOTE 2: This avoids that the ICE lite peer needs to send extra SDP offers to complete ICE procedures.\nIf the IMS-ALG sends an SDP offer (or forwards a received SDP offer) towards a call leg where ICE is to be applied, the IMS-ALG:\n-\tshall request the IMS-AGW to reserve a host candidate for each media line with UDP as default transport where it decides to use ICE and provide its address information, user name fragment and password;\n-\tmay request the IMS-AGW for each media line with UDP as default transport where it decides to use ICE to reserve an additional passive TCP ICE host candidate and provide its address information and a related ICE user name fragment and password;\n-\tshall configure the IMS-AGW to act as STUN server at the host candidate address, i.e. to answer STUN connectivity checks;\n-\tshall include the \"a=ice-options\" attribute with the value \"ice2\" in the SDP offer;\n-\tshall include the host candidate provided by the IMS-AGW and related ICE user name fragment and password in the SDP offer; and\n-\tshall include the \"a=ice-lite\" attribute in the SDP offer.\nIf the IMS-ALG then receives an SDP answer with candidate information from the call leg where ICE is to be applied, the IMS-ALG:\n-\tshall not forward the received candidate information in the SDP it sends towards the offerer;\n-\tmay provide received remote ICE candidates and the received related ICE user name fragment and password to the IMS-AGW; and\n-\tshall not apply the remote NAT traversal using latching according to clause 5.4.\nAfter the initial SDP offer-answer exchange, the IMS-ALG can receive a new offer from the peer that includes updated address and port information in the SDP \"c=\" line, \"m=\" line, or \"a=rtcp\" line SDP attributes. If the ICE user name fragment and password in the SDP offer differ from the ones received in the previous SDP (i.e. the peer restarts ICE), the IMS-ALG shall apply the same procedures as for the initial SDP offer.\nWhen receiving a request for a host candidate for a media line, the IMS-AGW shall allocate one host candidate for that media line and send it to the IMS-ALG within the reply. The IP address and port shall be the same as indicated separately as Local IP Resources. The IMS-AGW shall also indicate that it supports ICE lite in the reply.\nFor a passive TCP ICE host candidate, the IMS-AGW shall be prepared to receive and answer the TCP connection establishment requests.\nNOTE 3:\tThe TCP connection control procedures in clause 5.17 do not apply to TCP host candidates.\nWhen receiving a request for an ICE user name fragment and password, the IMS-AGW shall generate an ICE user name fragment and password and send it to the IMS-ALG within the reply. The IMS-AGW shall store the password and user name fragment to be able to authenticate incoming STUN binding request according to clause 7.3 of IETF RFC 8445 [82].\nWhen receiving a request to act as STUN server, the IMS-AGW shall be prepared to answer STUN binding request according to clause 7.3 of IETF RFC 8445 [82]. Once a STUN binding request with the \"USE-CANDIDATE\" flag has been received, the IMS-AGW may send media towards the source of the binding request.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.4",
        "clause_5.17",
        "clause_7.3"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.18.3",
      "section_id": "5.18.3",
      "section_title": "Full ICE",
      "content": "If the IMS-ALG supports and is configured to use full ICE, and controls an IMS-AGW that supports full ICE, the procedures in the present clause apply.\nIf the IMS-ALG receives an initial SDP offer with ICE candidate information, the IMS-ALG:\n-\tshall not forward the received candidate information in the SDP it sends towards the answerer;\n-\tshall request the IMS-AGW for each media line where it decides to use ICE to reserve an ICE host candidate and provide its address information and a related ICE user name fragment and password;\nNOTE:\tRequesting only one host candidate per m-line prevents that the IMS-ALG will receive \"a=remote-candidates\" SDP attributes in a subsequent SDP. Requesting separate ufrag and password for each media line simplifies H.248 encoding.\n-\tshall request the IMS-AGW to provide the desired pacing value for connectivity checks (Ta timer value);\n-\tshall configure the IMS-AGW to act as STUN server at the host candidate address, i.e. to answer STUN connectivity checks;\n-\tshall provide received remote ICE candidates and the received related ICE user name fragment and password to the IMS-AGW;\n-\tshall provide the remote pacing value to the IMS-AGW as follows:\na)\tif the \"a=ice-pacing\" attribute was present in the received SDP answer, the received pacing value; or\nb)\totherwise the default pacing value of 50 ms;\n-\tif an \"a=ice-options\" attribute with the value \"ice2\" was present in the received SDP offer, shall include the \"a=ice-options\" attribute with the value \"ice2\" in the SDP answer it forwards;\n-\tshall include the \"a=ice-pacing\" attribute with the pacing value provided by the IMS-AGW in the SDP answer it forwards;\n-\tshall include the host candidate and related ICE user name fragment and password received from the IMS-AGW in the SDP answer it forwards;\n-\tshall determine the role of IMS-ALG in ICE (controlling or controlled) according to clause 6.1.1 of IETF RFC 8445 [82];\n-\tshall configure the IMS-AGW to perform connectivity checks in accordance with the determined ICE role;\n-\tshall configure the IMS-AGW to report connectivity check results;\n-\tshall configure the IMS-AGW to report a new peer reflexive candidate if discovered during the connectivity check; and\n-\tshall not apply the remote NAT traversal using latching according to clause 5.4.\nIf the IMS-ALG sends an SDP offer (or forwards a received SDP offer) towards a call leg where ICE is to be applied, the IMS-ALG:\n-\tshall request the IMS-AGW to reserve a host candidate for each media line were it decides to use ICE and provide its address information, ICE user name fragment and password;\n-\tshall request the IMS-AGW to provide the pacing value for connectivity checks;\n-\tshall configure the IMS-AGW to act as STUN server at the host candidate address, i.e. to answer STUN connectivity checks; and\n-\tshall include the \"a=ice-options\" attribute with the value \"ice2\" in the SDP offer it sends;\n-\tshall include the \"a=ice-pacing\" attribute with the pacing value provided by the IMS-AGW in the SDP offer it sends; and\n-\tshall include the host candidate provided by the IMS-AGW and related ICE user name fragment and password in the SDP offer it sends.\nIf the IMS-ALG then receives an SDP answer with candidate information from the call leg where ICE is to be applied, the IMS-ALG:\n-\tshall not forward the received candidate information in the SDP it sends towards the offerer;\n-\tshall provide received remote ICE candidates and the received related ICE user name fragment and password to the IMS-AGW;\n-\tshall provide the remote pacing value to the IMS-AGW as follows:\na)\tif the \"a=ice-pacing\" attribute was present in the received SDP answer, the received pacing value; or\nb)\totherwise the default pacing value of 50 ms;\n-\tshall determine the role of IMS-ALG in ICE (controlling or controlled) according to clause 6.1.1 of IETF RFC 8445 [82];\n-\tshall configure the IMS-AGW to perform connectivity checks in accordance with the determined ICE role;\n-\tshall configure the IMS-AGW to report connectivity check results;\n-\tshall configure the IMS-AGW to report a new peer reflexive candidate if discovered during the connectivity check; and\n-\tshall not apply the remote NAT traversal using latching according to clause 5.4.\nWhen the IMS-ALG is informed by the IMS-AGW about new peer reflexive candidate(s) discovered by the connectivity checks, it shall configure the IMS-AGW to perform additional connectivity checks for those candidates.\nWhen the IMS-ALG is informed by the IMS-AGW about successful candidate pairs determined by the connectivity checks, the IMS-ALG shall send a new SDP offer to its peer with contents according to clause 4.4.1 of IETF RFC 8839 [83] if it has the controlling role and the highest-priority candidate pair differs from the default candidates in previous SDP.\nAfter the initial SDP offer-answer exchange, the IMS-ALG can receive a new offer from the peer that includes updated address and port information in the SDP \"c=\" line, \"m=\" line, or \"a=rtcp\" line SDP attributes. If the ICE user name fragment and password in the SDP offer differ from the ones received in the previous SDP (i.e. the peer restarts ICE), the IMS-ALG shall apply the same procedures as for the initial SDP offer.\nWhen receiving a request for a host candidate for a media line, the IMS-AGW shall allocate one host candidate for that media line and send it to the IMS-ALG within the reply. The IP address and port shall be the same as indicated separately as Local IP Resources.\nWhen receiving a request to provide a desired pacing value for connectivity checks (Ta timer value), the IMS-AGW shall calculate Ta timer value based on the characteristics of the associated data or shall use the default value of 50 ms and provide it as desired Ta timer value. The IMS-AGW shall compare the own desired Ta timer value with the Ta timer value provided by the IMS-ALG and shall use the higher value for connectivity checks (as specified in IETF RFC 8445 [82]).\nWhen receiving a request for an ICE user name fragment and password, the IMS-AGW shall generate an ICE user name fragment and password and send it to the IMS-ALG within the reply. The IMS-AGW shall store the password and user name fragment to be able to authenticate incoming STUN binding request according to clause 7.3 of IETF RFC 8445 [82].\nWhen receiving a request to act as STUN server, the IMS-AGW shall be prepared to answer STUN binding request according to clause 7.3 of IETF RFC 8445 [82]. Once a STUN binding request with the \"USE-CANDIDATE\" flag has been received, the IMS-AGW may send media towards the source of the binding request.\nWhen receiving a request to perform connectivity checks and to report connectivity check results, the IMS AGW:\n-\tshall compute ICE candidate pairs according to clause 6.1.2 of IETF RFC 8445 [82];\n-\tshall schedule checks for the ICE candidate pairs according to clause 6.1.4 of IETF RFC 8445 [82];\n-\tshall send STUN connectivity checks for the scheduled checks according to clause 7.2 of IETF RFC 8445 [82];\n-\tshall inform the IMS-ALG about successful candidate pairs determined by the connectivity checks;\n-\tshall inform the IMS-ALG about new peer reflexive candidate(s) discovered by the connectivity checks; and\n-\tshould send media using the highest priority candidate pair for which connectivity checks have been completed.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.1.1",
        "clause_5.4",
        "clause_4.4.1",
        "clause_7.3",
        "clause_6.1.2",
        "clause_6.1.4",
        "clause_7.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.18.4",
      "section_id": "5.18.4",
      "section_title": "STUN consent freshness for WebRTC",
      "content": "The eIMS-AGW, which implements ICE, shall support the STUN consent freshness test defined in IETF RFC 7675 [49].\nIf the eP-CSCF supports and is configured to use full ICE, and controls an eIMS-AGW that supports full ICE, to initiate the STUN consent freshness procedures, the eP-CSCF shall request the eIMS-AGW to perform periodic STUN consent tests towards the WIC (WebRTC IMS Client). On receipt of requesting STUN consent test signal, the eIMS-AGW shall start sending STUN binding requests in order to verify consent, based on the interval value indicated by the eP-CSCF, after the tansport address has been selected via the ICE-related connectivity check.\nIf the eP-CSCF is configured to use ICE lite, or supports only ICE lite, or controls an IMS-AGW that only support ICE lite, the eIMS-AGW shall not send STUN consent request checks. Instead, the IMS-AGW shall act as STUN server and only respond to incoming STUN binding requests received from the WIC (WebRTC IMS Client).\nIf STUN consent expires on a given transport address, the eIMS-AGW shall stop forwarding media on that transport address, and inform the eP-CSCF about the failure. In addition, the eIMS-AGW shall stop sending STUN consent request checks on the transport address. Once upon an indicated test failure, the eP-CSCF may request for appropriate action related to the H.248 stream, such as the removal of the H.248 stream.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.19.1",
      "section_id": "5.19.1",
      "section_title": "General",
      "content": "The IMS-ALG and IMS-AGW may support MSRP handling. If they support MSRP handling, they shall apply the procedures as specified in the present clause 5.19.\nFor WebRTC terminations, MSRP is transferred over data channels. For WebRTC terminations the procedures in the present clause 5.19 shall apply with the modifications described in clause 5.19.6.\nThe IMS-AGW shall support application-agnostic MSRP handling.\nNOTE 1:\tApplication-agnostic MSRP handling suffices when IETF RFC 6714 [26] or IETF draft-ietf-simple-msrp-sessmatch is supported by both ends (e.g. between Rel-8 onwards IMS UEs) and no MSRP relays are used.\nNOTE 2:\tThe expired IETF draft-ietf-simple-msrp-sessmatch modifies the session matching procedure defined by IETF RFC 4975 [25]. A peer applying IETF draft-ietf-simple-msrp-sessmatch will only compare the session-id part of the first MSRP URI in the SDP \"a=path\" attribute with the session-id part of the first MSRP URI in the \"To-Path\" header field of the received MSRP packets. This draft is still used by OMA and GSMA as an alternative option to IETF RFC 6714 [26].\nThe IMS-AGW may in addition support application-aware MSRP interworking, as described in clause 5.19.5..\nNOTE 3:\tApplication-aware MSRP interworking enables direct communication:\n-\tbetween an MSRP client applying IETF RFC 6714 [26] and an MSRP client applying IETF RFC 4975 [25] without extensions by either IETF RFC 6714 [25] or IETF draft-ietf-simple-msrp-sessmatch.\n-\tbetween an MSRP client applying IETF draft-ietf-simple-msrp-sessmatch and an MSRP client applying IETF RFC 4975 [25] without extensions by either IETF RFC 6714 [26] or IETF draft-ietf-simple-msrp-sessmatch.\n-\tbetween an MSRP client applying IETF RFC 6714 [26] and an MSRP client applying IETF draft-ietf-simple-msrp-sessmatch.\n-\tbetween two MSRP clients applying IETF RFC 4975 [25] without extensions by either IETF RFC 6714 [26] or IETF draft-ietf-simple-msrp-sessmatch.\nHowever, to address these scenarios, application aware MSRP interworking can also be applied in other network elements than the IMS-ALG and IMS-AGW, for instance in an CPM Participating Function or CPM Interworking Function as defined in OMA-TS-CPM_Conversation_Function-V2 [46].\nNOTE 4:\tMSRP relays external to the IMS-AGW are not supported in the present release.\nThe IMS-ALG procedures depend on whether the IMS-AGW applies application-agnostic MSRP interworking or application-aware MSRP interworking, and on the MSRP extensions applied on the interconnected call legs. The support of related procedures in clauses 5.19.2 to 5.19.4 below are all optional, but the IMS-ALG shall support at least one of them.\nHowever the procedures in clauses 5.19.4 and 5.19.5 shall not be applied for media with e2e media security.\nTable 5.19.1-1: Behaviour of MSRP clients and related IMS-ALG and IMS-AGW procedures for MSRP with different extensions.\nIETF document:\nMSRP client takes destination address for TCP connection setup from\nSession matching at MSRP client between SDP path and \"To-Path\" in MSRP messages includes address information\nIMS-AGW needs to insert own address into \"To‑Path\" in MSRP messages\nIMS-ALG needs to modify SDP path attribute\nSupport of extension is negotiated\nIETF RFC 4975 [25]\nSDP MSRP path attribute\nYes\nYes\nYes\n-\nExpired draft-ietf-simple-msrp-sessmatch\nSDP MSRP path attribute\nNo\nNo\nYes\nNo\nIETF RFC 6714 [26]\nSDP c-line and m-line\nYes\nNo\n(Yes if fallback to IETF RFC 4975 [6] occurs and is supported)\nNo\nYes, via SDP CEMA attribute",
      "chunk_type": "definition",
      "cross_references": [
        "clause_5.19",
        "clause_5.19.6",
        "clause_5.19.5",
        "table_5.19.1-1"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.19.2",
      "section_id": "5.19.2",
      "section_title": "IMS-ALG procedures to support IETF RFC 6714 with application agnostic MSRP handling by the IMS-AGW",
      "content": "A peer applying IETF RFC 6714 [26] will include the \"a=msrp-cema\" SDP attribute in the first SDP offer it sends.\nIf the \"a=msrp-cema\" SDP attribute is contained in an SDP offer, the IMS-ALG:\n-\tshall ensure that the IMS-AGW performs application agnostic MSRP handling by not configuring the IMS-AGW to apply application-aware MSRP interworking;\n-\tshall indicate \"TCP\" or \"TCP/TLS\" (if e2ae media security is applied) as transport protocol to the IMS‑AGW;\n-\tshall forward the \"a=path\" attribute and the \"a=msrp-cema\" SDP attribute in the SDP offer without modification; and\n-\tshall forward the \"a=path\" SDP attribute in the corresponding SDP answer without modification (even if the \"a=msrp-cema\" SDP attribute is not contained in the answer).\nNOTE:\tIf the \"a=msrp-cema\" SDP attribute is not contained in the SDP answer and the \"a=path\" SDP attribute is not modified, the offerer will discover a mismatch and send a new SDP offer without the \"a=msrp-cema\" SDP attribute according to IETF RFC 6714 [26] procedures.\nIf the \"a=msrp-cema\" SDP attribute is not contained in an SDP offer, the IMS ALG shall either apply the procedures in clause 5.19.3 or clause 5.19.4 (if supported).",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_5.19.3",
        "clause_5.19.4"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.19.3",
      "section_id": "5.19.3",
      "section_title": "IMS-ALG procedures to support IETF draft-ietf-simple-msrp-sessmatch with application agnostic MSRP handling by the IMS-AGW",
      "content": "A peer applying the expired IETF draft-ietf-simple-msrp-sessmatch will not include the \"a=msrp-cema\" SDP attribute in the SDP it sends, and will only compare the session-id part of the first MSRP URI in the SDP \"a=path\" attribute with the session-id part of the first MSRP URI in the \"To-Path\" header field of the first received MSRP packet.\nIf the \"a=msrp-cema\" SDP attribute is not contained in an SDP offer, the IMS-ALG:\n-\tshall ensure that the IMS-AGW performs application agnostic MSRP handling by not configuring the IMS-AGW to apply application-aware MSRP interworking;\n-\tshall indicate \"TCP\" or \"TCP/TLS\" (if e2ae media security is applied) as transport protocol to the IMS‑AGW; and\n-\tshall replace the IP address and TCP port in the only entry of the \"a=path\" SDP attribute in received SDP offer or answer with the IP address and TCP port allocated for the media stream at the IMS-AGW before forwarding the SDP.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.19.4",
      "section_id": "5.19.4",
      "section_title": "IMS-ALG procedures for application aware MSRP interworking by the IMS-AGW",
      "content": "The IMS ALG:\n-\tshall provide the SDP \"a=path\" attribute, as received in SIP/SDP signalling, to the IMS‑AGW as \"MSRP Path\" with the remote descriptor of the corresponding call leg;\n-\tshall ensure that the IMS-AGW performs application aware MSRP interworking by configuring the IMS-AGW to apply application-aware MSRP interworking; and\n-\tshall indicate \"TCP/MSRP\" or \"TCP/TLS/MSRP\" (if e2ae media security is applied) as transport protocol to the IMS‑AGW.\nIf interworking between an MSRP client applying IETF RFC 6714 [26] and an MSRP client applying IETF RFC 4975 [25] without extensions by either IETF RFC 6714 [26] or IETF draft-ietf-simple-msrp-sessmatch needs to be supported, the IMS ALG should:\n-\twhen receiving an SDP offer including the \"a=msrp-cema\" SDP attribute, include the \"a=msrp-cema\" SDP attribute in the SDP answer on that call leg;\n-\twhen sending an SDP offer, include the \"a=msrp-cema\" SDP attribute; and\n-\tif the \"a=msrp-cema\" SDP attribute is not contained in a received SDP answer and the SDP c/m-line address information does not match the \"a=path\" attribute, send a new SDP offer without the \"a=msrp-cema\" SDP attribute according to IETF RFC 6714 [26] procedures.\nNOTE:\tThe second SDP offer can be omitted if the IMS-ALG knows that there is no SBC in the path (e.g. between the IMS-ALG and the UE).",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.19.5",
      "section_id": "5.19.5",
      "section_title": "Application-aware MSRP interworking at the IMS-AGW",
      "content": "The IMS‑AGW shall apply application-aware MSRP interworking either if being statically configured to do so, or if being instructed from the IMS-ALG. Support of dynamic instructions from the IMS-ALG is optional.\nTo apply application-aware MSRP interworking, the IMS-AGW:\n-\tshall modify the MSRP \"To-Path\" header field in application (i.e. MSRP) data by replacing the IP address and TCP port of the only entry with the corresponding information in the \"MSRP path\" provided by the IMS_ALG while retaining the MSRP session ID part of the entry as received in the MSRP \"To-Path\"; and\n-\tshall forward the MSRP data without further modification.\nNOTE:\tMSRP session matching will be performed only be the MSRP clients.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.19.6",
      "section_id": "5.19.6",
      "section_title": "MSRP data channels",
      "content": "MSRP signalling can be transferred over WebRTC data channels as a data channel sub-protocol using the SDP offer/answer negotiation according to IETF RFC 8873 [62]. WebRTC data channels are described in clause 5.20.2. For WebRTC terminations the procedures in clause 5.19 shall apply with the modifications described in the present clause.\nWithin received SIP/SDP signalling related to a WebRTC termination MSRP contents within a data channel will be marked with the \"subprotocol=\"MSRP\"\" subfield in the \"a=dcmap\" SDP attribute according to IETF RFC 8864 [65]. The MSRP related \"a=msrp-cema\", \"a=path\", \"a=accept-types\" and \"a=setup\" SDP attributes will be encapsulated in \"a=dcsa\" SDP attributes according to IETF RFC 8864 [65]. The \"a=msrp-cema\" can be present or omitted in received SIP/SDP signalling related to a termination where no WebRTC data channel is to be used, but IETF RFC 6714 [26] is always applicable for MSRP within WebRTC data channels and the \"a=msrp-cema\" shall be present in SIP/SDP signalling related to a WebRTC termination.\nWhen receiving an SDP offer including such MSRP related information in SIP/SDP signalling related to a WebRTC data channel, and forwarding the SDP offer towards a termination where no WebRTC data channel is to be used, the IMS-ALG shall:\n-\tdescribe each MSRP data channel in a separate SDP media line in the SDP offer it forwards;\n-\tinclude \"a=msrp-cema\", \"a=path\", \"a=accept-types\" and \"a=setup\" SDP attributes received encapsulated in \"a=dcsa\" SDP attributes in the forwarded SDP offer for the corresponding MSRP media line(s) without the encapsulation; and\n-\texecute the procedures in the clause 5.19 as if an \"a=msrp-cema\" SDP attribute had been received.\n-\texecute the procedures in the clause 5.19 as if an \"a=msrp-cema\" SDP attribute had been received.\nWhen receiving an SDP offer including MSRP related information without an indication of WebRTC data channel usage in SIP/SDP signalling, and forwarding the SDP offer towards a termination where a WebRTC data channel is to be used, the IMS-ALG shall:\n-\tdescribe each received MSRP media line as a separate data channel;\n-\tinclude any received \"a=msrp-cema\", \"a=path\", \"a=accept-types\" and \"a=setup\" SDP attributes received for the MSRP media line(s) encapsulated in \"a=dcsa\" SDP attributes in the forwarded SDP offer;\n-\tif the \"a=msrp-cema\" SDP attribute was not received for the MSRP media line(s), include \"a=msrp-cema\" SDP attribute for the corresponding MSRP media line(s) encapsulated in \"a=dcsa\" SDP attribute in the forwarded SDP offer;\n-\tinclude an \"subprotocol=\"MSRP\"\" subfield in a \"a=dcmap\" SDP attribute; and\n-\tnot include the \"max-retr\", \"max-time\" and \"ordered\" parameters in the \"a=dcmap\" SDP attribute.\nFor terminations with MSRP within a WebRTC data channel, the IMS-ALG shall:\n-\tindicate a transport protocol according to clause 5.20.2 to the eIMS-AGW; and\n-\tfor application aware MSRP interworking:\na)\tindicate that MSRP is used within the data channel to the eIMS-AGW; and\nb)\tprovide the SDP \"a=path\" attribute encapsulated in \"a=dcsa\" SDP attribute, as received in SIP/SDP signalling, to the eIMS‑AGW as \"Encapsulated MSRP Path\" with the remote descriptor of the corresponding call leg.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.20.2",
        "clause_5.19"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.20.1",
      "section_id": "5.20.1",
      "section_title": "General",
      "content": "The following requirements apply for a \"P-CSCF enhanced for WebRTC (eP-CSCF)\" and an \"IMS-AGW enhanced for WebRTC (eIMS-AGW)\":\n-\tEnd-to-access-edge security for RTP based media using DTLS-SRTP, clause 5.11.2.4, shall be supported.\n-\tEnd-to-access-edge security for RTP based media using DTLS-SRTP over TCP transport, clause 5.11.2.5, may be supported.\n-\tInteractive Connectivity Establishment (ICE), clause 5.18, shall be supported. ICE for TCP may be supported in addition to offer an alternative transport for UDP based media as specified in clause 5.18.\n-\tSTUN Consent Freshness, clause 5.18.4, shall be supported.\n-\tRTP/RTCP transport multiplexing, clause 5.9.2 shall be supported.\n-\tAudio transcoding, clause 5.13, shall be supported. Video transcoding may be supported.\n-\tTranscoding to/from the Opus Audio Codec, IETF RFC 6716 [50], clause 5.13.4, should be supported.\n-\tProcedures for the eIMS-AGW to act as a data channel endpoint should be supported according to IETF draft ietf-rtcweb-data-channel [61], see clause 5.20.2.\n-\tData channels used for WebRTC to transport MSRP as a data channel sub-protocol, i.e. MSRP data channels between the UE and the eIMS-AGW should be supported according to IETF RFC 8873 [62] and the procedures in clause 5.19.6. SCTP/DTLS/UDP should be transported as protocol stack for data channels and SCTP/DTLS/TCP may be supported.\n-\tData channels used for WebRTC to transport T.140 (used for Global Text Telephony, GTT) as a data channel sub-protocol, i.e. T.140 data channels between the UE and the eIMS-AGW may be supported according to IETF RFC 8865 [75] and the procedures in clause 5.20.2.6.\n-\tThe media plane optimization procedures in clause 5.20.3 may be supported.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_5.11.2.4",
        "clause_5.11.2.5",
        "clause_5.18",
        "clause_5.18.4",
        "clause_5.9.2",
        "clause_5.13",
        "clause_5.13.4",
        "clause_5.20.2",
        "clause_5.19.6",
        "clause_5.20.2.6",
        "clause_5.20.3"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.20.2.1",
      "section_id": "5.20.2.1",
      "section_title": "General",
      "content": "In the WebRTC framework, non-media data communication between UEs is handled by using data channels according to IETF RFC 8831 [61]; within SCTP (see IETF RFC 4960 [63]), encapsulated in DTLS. The related SDP signalling is described in IETF RFC 8841 [64] and IETF RFC 8864 [65].",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.20.2.2",
      "section_id": "5.20.2.2",
      "section_title": "Data Channel Establishment",
      "content": "Data channels can use either a SCTP/DTLS/UDP or SCTP/DTLS/TCP based transport. If the eP-CSCF (IMS-ALG) and the eIMS-AGW support data channels, they shall support the SCTP/DTLS/UDP based transport and may support the SCTP/DTLS/TCP based transport.\nNOTE 1:\tThis clause assumes that the UDP based option is used as default ICE candidate for WebRTC terminations. TCP based transport can be offered in addition as alternative transport using ICE for TCP as specified in clause 5.18.\nUpon receipt of an SDP offer containing SDP attributes for new SCTP associations and/or new data channels according to IETF RFC 8841 [64] and IETF RFC 8864 [65] from the WebRTC access network, the eP-CSCF (IMS-ALG):\n-\tshall check if a new DTLS association and SCTP association is to be set up or an existing DTLS association and SCTP association are to be reused (NOTE 1) according to IETF RFC 8842 [81] and IETF RFC 8841 [64];\nNOTE 2:\tThe present procedures assume that the DTLS association and SCTP association are established together. A separate establishment of DTLS association and SCTP association is not supported in the present release.\n-\tif a new DTLS connection and SCTP association are to be set up:\n1)\tshall request a new H.248 stream group (see details below) on a new termination towards the WebRTC access network from the eIMS-AGW;\n2)\tshall request a deaggregation stream to handle the SCTP association and DTLS association, and for the H.248 deaggregation stream:\na)\tshall send the remote UDP port and SCTP port to the eIMS-AGW;\nb)\tshall request the local UDP port and SCTP port from the eIMS-AGW;\nc)\tshall insert the local UDP port and SCTP port received from the eIMS-AGW into the SDP answer towards the WebRTC access network;\nd)\tshall provide the remote SCTP maximum message size, as received within the \"a=max-message-size\" SDP attribute, to the eIMS-AGW;\ne)\tshall request the eIMS-AGW to provide its own local SCTP maximum message size;\nf)\tshall insert the SCTP maximum message size received from the eIMS-AGW into the SDP answer towards the WebRTC access network;\ng)\tshall check the received value of the \"a=setup\" SDP attribute to determine if the eIMS-AGW needs to act as DTLS client or DTLS server. When the received value is equal to:\ni)\t\"active\" the eIMS-AGW needs to act as DTLS server;\nii)\t\"passive\" the eIMS-AGW needs to act as DTLS client; or\niii)\t\"actpass\" the eP-CSCF (IMS-ALG) shall decide if the eIMS-AGW needs to act as DTLS client or DTLS server;\nh)\tif the eIMS-AGW needs to act as DTLS client;\ni)\tshall provide the Establish (D)TLS session information element to request the eIMS-AGW to start the DTLS session setup; and\nii)\tshall provide the Establish SCTP association information element to request the eIMS-AGW to start the SCTP association setup as soon as DTLS association is data transfer ready;\nNOTE 3:\tSuch an H.248 control leads to the emulation of \"simultaneous SCTP association establishment\" (i.e., the eIMS-AGW behaves according to clause 5.2.1 of IETF RFC 4960 [63]).\ni)\tif the eIMS-AGW needs to act as DTLS server, may include the Notify (D)TLS session establishment information element to request the eIMS-AGW to notify the eP-CSCF (IMS-ALG) about an incoming DTLS session setup;\nj)\tshall indicate to the eIMS-AGW \"UDP/DTLS/SCTP\" as transport protocol;\nk)\tshall provide to the eIMS-AGW the Remote certificate fingerprint information element with the value of the received fingerprint SDP attribute(s) from the WIC;\nl)\tshall include the Local certificate fingerprint Request information element to request the certificate fingerprint of the eIMS-AGW; and\nm)\tshall indicate to the eIMS-AGW the SCTP stream identifiers of H.248 component stream(s) (i.e. SCTP streams corresponding to data channels) to be de-multiplexed;\n3)\tshall indicate the grouping of the H.248 deaggregation stream and the H.248 component stream(s) with SCTP semantics to the eIMS-AGW; and\n4)\tshall request the eIMS-AGW to provide a notification when receiving an SCTP stream reset request and to autonomously answer that SCTP stream reset request;\n-\tif an existing DTLS association and SCTP association are to be reused, shall modify the existing termination for that SCTP association by:\n1)\tindicating to the eIMS-AGW the SCTP stream identifiers of H.248 component stream(s) (i.e. SCTP streams corresponding to data channels) to be de-multiplexed; and\n2)\tindicating the H.248 stream grouping of the H.248 deaggregation stream and the H.248 component stream(s) with SCTP semantics to the eIMS-AGW;\nNOTE 4:\tThe information element relates to an H.248 Stream Group (SG) which allows:a) to separate the protocol stack in the levels of data channels (DC) and the commonly shared lower transport, andb) to support multiple DCs. The SG is part of the WebRTC termination.\n-\tfor each data channel to be established:\n1)\tshall reserve a separate H.248 stream at the termination towards the WebRTC access network;\n2)\tshall provide the SCTP stream identifier to the eIMS-AGW;\n3)\tshall provide the information received in the SDP \"a=dcmap\" attribute to the eIMS-AGW;\nNOTE 5:\tFor MSRP and T.140 within data channels, the default values of the \"max-retr\" parameter, the \"max-time\" parameter and the \"ordered\" parameter apply and those parameters are not included.\n4)\tif application aware handling of the contents within the data channel is required, may provide the information received in SDP \"a=dcsa\" attributes to the eIMS-AGW as \"remote dcsa\" information elements, taking into account the specific procedures defined for the subprotocols within the data channel;\n5)\tif the first data channel is to be established, shall reserve a termination towards the core network;\n6)\tshall reserve a H.248 stream towards the core network;\n7)\tshall indicate to the eIMS-AGW how to interwork the information send or received in data channels with information send or received on streams towards the IMS core network by using the same H.248 stream identifier for the H.248 stream towards the WebRTC access network and towards the core network;\n8)\tshall indicate to the eIMS-AGW an appropriate transport protocol towards the IMS core network (e.g. \"TCP\" for MSRP) for the media described in the dcmap attribute for the data channel when reserving the transport addresses/resources towards the IMS core network;\n9)\tshall provide an appropriate media line for the media described in the dcmap attribute in the SDP offer towards the IMS core network; and\n10)\tshould de-encapsulate SDP attributes within the received SDP \"a=dcsa\" attributes in the SDP offer and include the de-encapsulated SDP attributes in the SDP offer towards the IMS core network as media attributes for the media line corresponding to the data channel, taking into account specific procedures defined for the subprotocol within the data channel; and\n-\tshall remove the \"a=setup\", \"a=connection\" \"a=dcmap\" and possible \"a=dcsa\" SDP attributes and fingerprint information from the SDP offer towards the IMS core network.\nUpon receipt of a corresponding SDP answer from the IMS core network, if the SDP answer does not indicate that media plane optimization is to be applied (see clause 5.20.3.2), the eP-CSCF (IMS-ALG):\n-\tinstead of the media line(s) describing media that are to be transported within data channel(s), shall provide an \"m=\" line with the transport protocol \"UDP/DTLS/SCTP\";\n-\tshall insert the fingerprint SDP attribute with the value of the Local certificate fingerprint information element received from the eIMS-AGW;\n-\tif the IMS-ALG received from the WIC an SDP offer with \"a=tls-id\" media-level SDP attribute for the DTLS association:\n1)\tif an existing DTLS association is reused, shall include the \"a=tls-id\" SDP attribute with the value assigned to that DTLS association in the SDP answer which the IMS-ALG sends to the WIC; and\n2)\tif a new DTLS association is to be established, shall include the \"a=tls-id\" SDP attribute with a new unique value in the SDP answer which the IMS-ALG sends to the WIC;\n-\tshall insert the \"a=setup\" SDP attribute with the value:\n1) \"active\" if the eP-CSCF (IMS-ALG) requested the eIMS-AGW to act as DTLS client; or\n2) \"passive\" if the eIMS-AGW shall take the DTLS server role; and\n-\tfor each received media line describing media that are to be transported within a data channel:\n1)\tshall insert an \"a=dcmap\" attribute with the same values for the SCTP stream identifier, \"subprotocol\" and \"label\" parameters as received in the SDP offer, and with possible values for the \"max-retr\", \"max-time\", and \"ordered\" parameters according to the requirements of the transported data flow and capabilities of the eIMS-AGW;\nNOTE 6:\tFor MSRP and T.140 within data channels, the default values of the \"max-retr\" parameter, the \"max-time\" parameter and the \"ordered\" parameter apply and those parameters are not included.\n2)\tshould insert SDP \"a=dcsa\" attributes into the SDP answer towards the WebRTC access network encapsulating subprotocol specific SDP attributes received in the SDP answer, taking into account specific procedures defined for the subprotocol within the data channel;\n3)\tshall provide the information in the sent SDP \"a=dcmap\" attribute to the eIMS-AGW; and\n4)\tmay provide the information within the sent SDP \"a=dcsa\" attributes to the eIMS-AGW as \"local dcsa\" information elements, taking into account specific procedures defined for the subprotocol within the data channel.\nUpon receipt of an SDP offer from the IMS core network for new media streams that need to be transported within a WebRTC data channel on the WebRTC access network, if the SDP offer does not indicate that media plane optimization is to be applied (see clause 5.20.3.3), the eP-CSCF (IMS-ALG):\n-\tshall determine if it can reuse an existing DTLS association and SCTP association or if it needs to set up a new DTLS association and SCTP association;\n-\tif a new DTLS association and SCTP association are to be set up:\n1)\tshall request a new termination towards the WebRTC access network from the eIMS-AGW;\n2)\tshall request a deaggregation stream to handle the SCTP association and DTLS association, and for the H.248 deaggregation stream:\na)\tshall request the local UDP port and SCTP port from the eIMS-AGW;\nb)\tshall insert the local UDP port and SCTP port received from the eIMS-AGW into the SDP offer towards the WebRTC access network;\nc)\tshall request the eIMS-AGW to provide its own local SCTP maximum message size;\nd)\tshall insert the SCTP maximum message size received from the eIMS-AGW into the SDP offer towards the WebRTC access network;\ne)\tshall add an SDP \"a=setup\" attribute with value \"actpass\" into the SDP offer;\nf)\tshall indicate to the eIMS-AGW \"UDP/DTLS/SCTP\" as transport protocol;\ng)\tshall include the Local certificate fingerprint Request information element to request the certificate fingerprint of the eIMS-AGW;\nh\tshall insert the fingerprint SDP attribute with the value of the Local certificate fingerprint information element received from the eIMS-AGW into the SDP offer towards the WebRTC access network; and\ni)\tshall indicate to the eIMS-AGW the SCTP stream identifiers of H.248 component stream(s) (i.e. SCTP streams corresponding to data channels) to be de-multiplexed;\n3)\tshall indicate the H.248 stream grouping of the H.248 deaggregation stream and the H.248 component stream(s) with SCTP semantics to the eIMS-AGW; and\n4)\tshall request the eIMS-AGW to provide a notification when receiving an SCTP stream reset request and to autonomously answer that SCTP stream reset request;\n-\tif an existing DTLS association and SCTP association are to be reused, shall modify the existing termination towards the WebRTC access network for that SCTP association by:\n1)\tindicating to the eIMS-AGW the SCTP stream identifiers of H.248 component stream(s) (i.e. SCTP streams corresponding to data channels) to be de-multiplexed; and\n2)\tindicating the H.248 stream grouping of the H.248 deaggregation stream and the H.248 component stream(s) with SCTP semantics to the eIMS-AGW;\n-\tinstead of the media line(s) describing media that are to be transported within data channel(s), shall provide an \"m=\" line with the transport protocol \"UDP/DTLS/SCTP\";\n-\tshall insert an \"a=tls-id\" SDP attribute in the SDP offer with a new or reused value (depending on whether an existing DTLS association is reused); and\n-\tfor each received media line describing media that are to be transported within a data channel:\n1)\tshall reserve a separate H.248 stream at the termination towards the WebRTC access network;\n2)\tshall insert an \"a=dcmap\" attribute with an unused SCTP stream identifier, and with \"subprotocol\" and \"label\" parameters according to the requirements of the transported data flow, and with possible values for the \"max-retr\", \"max-time\", and \"ordered\" parameters according to the requirements of the transported data flow and capabilities of the eIMS-AGW;\nNOTE 7:\tFor MSRP and T.140 within data channels, the default values of the \"max-retr\" parameter, the \"max-time\" parameter and the \"ordered\" parameter apply and those parameters are not included.\n3)\tshall provide the SCTP stream identifier to the eIMS-AGW;\n4)\tshall provide the information in the sent SDP \"a=dcmap\" attribute to the eIMS-AGW;\n5)\tshould insert SDP \"a=dcsa\" attributes into the SDP offer towards the WebRTC access network encapsulating any subprotocol specific SDP attributes received in the SDP offer, taking into account specific procedures defined for the subprotocol within the data channel;\n6)\tif application aware handling of the contents within the data channel is required, may provide the information within the sent SDP \"a=dcsa\" attributes to the eIMS-AGW as \"local dcsa\" information elements, taking into account specific procedures defined for the subprotocol within the data channel;\n7)\tif the first data channel is to be established, shall reserve a termination towards the core network;\n8)\tshall reserve a H.248 stream towards the core network; and\n9)\tshall indicate to the eIMS-AGW how to interwork the information sent or received in data channels with information sent or received on terminations and/or streams towards the IMS core network by using the same H.248 stream identifier for the stream towards the WebRTC access network and towards the core network.\nUpon receipt of a corresponding SDP answer from the WebRTC access network, the eP-CSCF (IMS-ALG):\n-\tif a new DTLS association and SCTP association are to be set up, for the H.248 deaggregation stream to handle the SCTP association and DTLS connection:\n1)\tshall send the received remote UDP port and SCTP port to the eIMS-AGW;\n2)\tshall include the Remote certificate fingerprint information element with the value of the received fingerprint SDP attribute(s) from the WebRTC access network;\n3)\tshall check the received value of the \"a=setup\" SDP attribute to determine if the eIMS-AGW needs to act as DTLS client or DTLS server. When the received value is equal to:\na) \"active\" the eIMS-AGW needs to act as DTLS server; or\nb) \"passive\" the eIMS-AGW needs to act as DTLS client;\n4)\tif the eIMS-AGW needs to act as DTLS client:\na)\tshall include the Establish (D)TLS session information element to request the eIMS-AGW to start the DTLS session setup; and\nb)\tshall provide the Establish SCTP association information element to request the eIMS-AGW to start the SCTP association setup as soon as DTLS connection is data transfer ready;\n5)\tif the eIMS-AGW needs to act as DTLS server, may include the Notify (D)TLS session establishment information element to request the eIMS-AGW to notify the eP-CSCF (IMS-ALG) about an incoming DTLS session setup; and\n6)\tshall provide the remote SCTP maximum message size, as received within the \"a=max-message-size\" SDP attribute, to the eIMS-AGW;\n-\tshall remove the \"a=setup\", \"a=connection\" \"a=dcmap\" and possible \"a=dcsa\" SDP attributes and fingerprint information from the SDP answer and indicate the transport protocol \"TCP\" in the SDP answer towards the IMS core network; and\n-\tfor each accepted data channel:\n1)\tshall provide the information received in the SDP \"a=dcmap\" attribute to the eIMS-AGW;\n2)\tif application aware handling of the contents within the data channel is required, may provide the information within the received SDP \"a=dcsa\" attributes in the SDP answer to the eIMS-AGW as \"remote dcsa\" information elements, taking into account specific procedures defined for the subprotocol within the data channel; and\n3)\tshould de-encapsulate SDP attributes within the received SDP \"a=dcsa\" attributes in the SDP answer and include the de- encapsulated SDP attributes in the SDP answer towards the IMS core network, taking into account specific procedures defined for the subprotocol within the data channel.\nIf requested to set up a new DTLS association and SCTP association, the eIMS-AGW shall:\n-\tallocate the local UDP port and SCTP port, and send them to the eP-CSCF (IMS-ALG);\n-\twhen being instructed to start the DTLS bearer session setup, act as a DTLS client and establish the DTLS bearer session;\n-\tupon request from the eP-CSCF (IMS-ALG), provide the SCTP maximum message size;\n-\tupon request from the eP-CSCF (IMS-ALG), select an own certificate, and send the fingerprint of the own certificate to the eP-CSCF (IMS-ALG);\n-\tuniquely associate the certificate fingerprint(s) received from the eP-CSCF (IMS-ALG) with the corresponding DTLS association, and subsequently use the certificate fingerprint(s) to verify the establishment of the DTLS bearer session;\n-\tif the verification of the remote certificate fingerprint(s) during the DTLS bearer session establishment fails, regard the remote DTLS endpoint as not authenticated, terminate the DTLS bearer session and report the unsuccessful DTLS bearer session setup to the eP-CSCF (IMS-ALG);\n-\tupon completion of the DTLS association establishment, set up the SCTP association according to IETF RFC 4960 [63]; and\n-\tdeaggregate H.248 component streams upon request from the eP-CSCF (IMS-ALG).\nIf the eP-CSCF (IMS-ALG) requests that a termination with an existing SCTP association is being modified, the eIMS-AGW shall reuse an existing DTLS association and SCTP association.\nIf the eP-CSCF (IMS-ALG) requests that a new H.248 component stream with a H.248 stream group related to an SCTP association is being reserved, the eIMS-AGW shall set up the data channel according to IETF RFC 8831 [61] procedures. The eIMS-AGW shall also interwork the information sent or received in data channels with information sent or received on terminations and/or streams towards the IMS core network according to the configuration received by the eP-CSCF (IMS-ALG).\nNOTE 8:\tThe handling of priority information that is part of the dcmap information received from the eP-CSCF (IMS-ALG) is left to the eIMS-AGW implementation.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_5.18",
        "clause_5.2.1",
        "clause_5.20.3.2",
        "clause_5.20.3.3"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.20.2.3.1",
      "section_id": "5.20.2.3.1",
      "section_title": "General",
      "content": "In the present Release, the closure of individual WebRTC data channels (clause 5.20.2.3.2) and the complete release of the entire WebRTC data service (clause 5.20.2.3.3) are supported.\nNOTE 1:\tThe hierarchical protocol stack for WebRTC data (\"DC/SCTP/DTLS/(UDP|TCP)/IP\") contains up to four levels of user plane bearer control procedures, from top to bottom:\t1)\tDC: SCTP Stream reconfiguration procedures for resetting SCTP Streams;\t2) SCTP Association: shutdown procedure;\t3) DTLS: DTLS connection release procedure (apart from resumption and renegotiation procedures); and\t4) TCP: TCP connection release procedure. (However, TCP transport of WebRTC data channels is not supported in the present Release).The present Release does not consider specific release variations at levels 2 to 4, such as the shutdown of an SCTP Association without a DTLS connection release.\nA data channel can be closed before the end of the WebRTC call. In the present Release, the H.248 Stream endpoint related to a data channel may be removed after the closure of the data channel, but a subsequent reuse of the corresponding SCTP Stream identifier is possible via an SDP offer-answer exchange triggering the reservation of new H.248 Stream endpoint.\nNOTE 2:\tThere are multiple variations possible because the \"CLOSURE of a data channel\" results in a reset of the SCTP Stream (see clause 6.7 of IETF RFC 8831 [61]), i.e. the concerned SCTP Stream still exists from protocol stack perspective. Such a reset SCTP Stream could be reused again (for the same or another WebRTC data application). There are consequently two options from the eP-CSCF (IMS-ALG) perspective: the correspondent H.248 Stream endpoint remains allocated and part of the H.248 Stream Group for a possible future reuse, or the H.248 Stream endpoint is completely removed from the termination.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_5.20.2.3.2",
        "clause_5.20.2.3.3",
        "clause_6.7"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.20.2.3.2",
      "section_id": "5.20.2.3.2",
      "section_title": "Release of one WebRTC data channel",
      "content": "When the eP-CSCF (IMS-ALG) receives:\n-\tan SDP offer or answer from the WebRTC access network releasing a particular WebRTC data channel while maintaining the corresponding SCTP Association, encoded according to IETF RFC 8864 [65]; or\nNOTE 1:\tSuch an SDP offer or answer is characterized by the exclusion of the \"a=dcmap:\" and \"a=dcsa:\" attribute lines for an existing data channel (DC). See clause 5.2.4 of IETF RFC 8864 [65] related to the general closure of an application-agnostic DC and clause 5.1.5 of IETF RFC 8873 [62] for an example of an application-aware DC closure.\n-\tan SDP offer or answer from the IMS core network disabling media streams that need to be transported within a WebRTC data channel on the WebRTC access network (i.e. media line with port zero) while maintaining other media streams that are transported within another data channel within the same SCTP Association enabled; or\n-\ta notification from the eIMS-AGW that the peer has reset the incoming SCTP Stream that corresponds to a data channel;\nthen the eP-CSCF (IMS-ALG):\n1)\tshall provide the Send SCTP Stream Reset Requests Indicator information element to the eIMS-AGW to request the eIMS-AGW to start the SCTP Stream reset for the corresponding outgoing SCTP Stream;\nNOTE 2:\tThis will trigger the peer to also reset the corresponding incoming SCTP Stream, unless the peer has already done so before.\n2)\tmay provide the Received SCTP Stream Reset Response information element to the eIMS-AGW if the eP-CSCF (IMS-ALG) wants to receive an explicit notification from the eIMS-AGW that the peer has reset the corresponding incoming SCTP Stream;\n3)\tupon the reception of a Notification from the eIMS-AGW that the peer has reset the corresponding incoming SCTP Stream and the additional notification from the eIMS-AGW about the result of the outgoing SCTP Stream (if requested), may release the corresponding H.248 Stream endpoints at the terminations towards the WebRTC access network and towards the IMS core network;\n4)\tif an received SDP offer or answer from the WebRTC access network triggered the release of the data channel, shall forward the SDP offer or answer to IMS core network with the media line corresponding to the media stream in the data channel disabled by port zero;\n5)\tif an received SDP offer or answer from the IMS core network triggered the release of the data channel, shall forward the SDP offer or answer to WebRTC access network with the corresponding WebRTC data channel released with encoding according to IETF RFC 8864 [65]; and\n6)\tif all of the following conditions apply:\n-\ta notification from the eIMS-AGW that the peer has reset the incoming SCTP Stream triggered the release of the data channel;\n-\tthe application subprotocol does not mandate that the closing of a data channel is also signalled via a new SDP offer/answer exchange; and\n-\tno corresponding SIP/SDP information is received in due time;\nshould send the appropriate SIP message with the SDP body to the IMS core network with the media line corresponding to the media stream in the data channel disabled by port zero.\nNOTE 3:\tAccording to IETF RFC 8864 [65], it is specific to the subprotocol whether this closing of a data channel MUST in addition the the SCTP SCTP SSN reset also be signalled to the peer via a new SDP offer/answer exchange. For MSRP, if the peer triggers a data channel release by resetting the incoming SCTP Stream, it is also mandated to send corresponding SIP/SDP information.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.2.4",
        "clause_5.1.5"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.20.2.3.3",
      "section_id": "5.20.2.3.3",
      "section_title": "Release of all or last active WebRTC data channels within an SCTP Association",
      "content": "When the eP-CSCF (IMS-ALG) receives:\n-\tan SDP offer or answer from the WebRTC access network requesting to release the SCTP Association used to transport data channels, encoded according to IETF RFC 8864 [65] (i.e. media line with port zero); or\n-\tan SDP offer or answer from the IMS core network disabling all media stream(s) that need to be transported within a WebRTC data channel on the WebRTC access network (i.e. media line(s) with port zero);\nthen the eP-CSCF (IMS-ALG):\n1)\tshall release the corresponding H.248 Stream group or termination towards the WebRTC access network;\nNOTE 1:\tIn the present release, a separate DTLS connection is used for each for each SCTP Association and for each audio or video media stream (for their DTLS-SRTP-based key exchange).\n2)\tshall release the corresponding H.248 streamendpoint(s) or termination towards the IMS core network;\nNOTE 2:\tIf a new SDP offer from the access network arrives that requests a new data channel, then a stream end point and possibly a termination towards the IMS core network has to be added again.\n3)\tif an received SDP offer or answer from the WebRTC access network triggered the release of the SCTP Association, shall forward the SDP offer or answer to the IMS core network with all media line(s) corresponding to the media stream(s) in the data channel(s) within that SCTP Association disabled by port zero; and\n4)\tif an received SDP offer or answer from the IMS core network triggered the release of the SCTP Association, shall forward the SDP offer or answer to WebRTC access network with the corresponding release of the SCTP Association with encoding according to IETF RFC 8864 [65] (i.e. media line with port zero).\nWhen the eP-CSCF (IMS-ALG) requests the eIMS-AGW to release an entire H.248 Stream group or termination associated with an SCTP Association, then the eIMS-AGW should execute appropriate bearer control procedures to release the DTLS connection.\nNOTE 3:\tIf one DTLS connection endpoint closes the DTLS connection (e.g. sends a DTLS fatal alert), then the other DTLS connection endpoint unambiguously knows that also the SCTP association and all previously existing data channel instances are implicitly closed.\nNOTE 4:\t'TCP' as L4 protocol is supported for WebRTC audio and video, but not for data in the present release.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_5.20.2.4",
      "section_id": "5.20.2.4",
      "section_title": "MSRP within WebRTC data channel",
      "content": "See clause 5.19.6.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.19.6"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.20.2.6",
      "section_id": "5.20.2.6",
      "section_title": "T.140 within WebRTC data channel",
      "content": "T.140 (see ITU‑T Recommendation T.140 [73]) is used for Global Text Telephony (GTT). T.140 signalling can be transferred over WebRTC data channels as a data channel sub-protocol according to IETF RFC 8865 [75]. The WebRTC data channel procedures in clause 5.20.2.2 shall apply with the modifications described in the present clause.\nT.140 within a data channel is identified via the \"t140\" value of the \"subprotocol\" parameter of the SDP \"a=dcmap\" attribute.\nT.140 transported outside the data channel in the IMS core network is identified via the \"RTP/AVP\" or \"RTP/AVPF\" value of the \"proto\" parameter and the \"text\" value of the \"media\" parameter of the SDP m-line, and via the \"t140\" MIME subtype signalled in the SDP \"a=rtpmap\" attribute (see IETF RFC 4103 [74]).\nThe eIMS-ALG shall apply the procedures in clause 5.20.2.2 to configure the eIMS-AGW for an application-aware handling of the contents within the data channel.\nFor the termination toward the IMS core network, the eIMS-ALG:\n-\tshall provision \"RTP/AVP\" or \"RTP/AVPF\" as transport and the \"t140\" payload type;\n-\tshall de-encapsulate the SDP \"fmtp:t140 cps\" attributes, \"sendrecv\", \"sendonly\", \"recvonly\", \"inactive\", \"hlang-send\" and \"hlang-recv\" received within \"a=dcsa\" attributes from the served WIC;\n-\tshall forward those attributes within the SDP body in the corresponding SIP message sent to the IMS core network; and\n-\tshall provision the SDP \"fmtp:t140 cps\" attributes to the eIMS-AGW.\nFor the termination towards the WebRTC access network, the eIMS-ALG:\n-\tshall not include the \"max-retr\", \"max-time\" and \"ordered\" parameters in the \"a=dcmap\" SDP attribute;\n-\tshall encapsulate SDP \"fmtp:t140 cps\", \"sendrecv\", \"sendonly\", \"recvonly\", \"inactive\", \"hlang-send\" and \"hlang-recv\" attributes received from the IMS core network within \"a=dcsa\" attributes and forward those attributes within the SDP body in the corresponding SIP message sent to the served WIC; and\n-\tshall provision SDP \"fmtp:t140 cps\" attributes received from the IMS core network to the eIMS-AGW.\nThe eIMS-AGW should handle T.140 protocol layer in the following application specific manner:\n-\tthe eIMS-AGW should detect inactivity of T.140 traffic from the served WIC and then send empty RTP packets towards the IMS core network;\n-\tthe eIMS-AGW should buffer the T.140 payload received within incoming RTP packets from the IMS core network to correct out-of-order delivery; and\n-\tthe eIMS-AGW should detect missing RTP packets from the IMS core network and then send new T140 blocks with \"missing text marker\" information to the served WIC.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.20.2.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.20.3.1",
      "section_id": "5.20.3.1",
      "section_title": "General",
      "content": "Media plane optimization procedures for WebRTC are described in 3GPP TS 23.228 [2], annex U.2.4, and in 3GPP TS 24.371 [44], sublause 7.4.5. The purpose of media plane optimization procedures is to convey media between WebRTC clients without bearer level protocol conversion. When both ends are WebRTC IMS clients (WIC), the eIMS-AGWs remain allocated but media plane interworking is disabled, except when LI is needed. Depending on configuration in the eP-CSCF (IMS-ALG), the eIMS-AGW then forwards all protocol layers either including DTLS, or on top of DTLS transparently.\nNOTE 1:\tTerminating the DTLS protocol layer for all calls can improve the transparency of LI.\nNOTE 2:\tIn Rel-13, the media plane optimization procedure only supports the transparent forwarding of all protocol layers including DTLS, and no related configuration in the eP-CSCF (IMS-ALG) is thus required. The configuration in the eP-CSCF (IMS-ALG) needs to take into account if the eIMS-AGW supports the media plane optimization procedures with DTLS layer termination added in Rel-14.\nThe SDP attributes associated with WebRTC media plane optimization procedures \"tra-contact\", \"tra-m-line\", \"tra-att\", \"tra-SCTP-association\", \"tra-media-line-number\" and \"tra-bw\" are defined in 3GPP TS 24.229 [11], clause 7.5.4.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.229_clause_7.5.4",
        "ts_23.228",
        "ts_24.371",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.20.3.2",
      "section_id": "5.20.3.2",
      "section_title": "WIC originating call",
      "content": "If an eP-CSCF (IMS-ALG) forwards an SDP offer from the WIC, and supports media plane optimization, and does not need to perform legal interception, then the eP-CSCF (IMS-ALG) will include media suitable for non-WebRTC IMS UEs, but also encapsulate information about the media in the original encoding as received in the SDP offer from the WIC in \"tra-m-line\", \"tra-att\" and \"tra-bw\" SDP attributes, as described in 3GPP TS 24.371 [44]. The eP-CSCF (IMS-ALG) shall:\n-\tconfigure the eIMS-AGW to reserve resources suitable for the media described in the SDP offer outside the \"tra-m-line\", \"tra-att\" and \"tra-bw\" SDP attributes;\n-\tinclude the IP address received from the eIMS-AGW for the termination towards the IMS core network in the SDP contact line and also encapsulate the address information provided by the eIMS-AGW into a \"tra-contact\" attribute;\n-\tif the eP-CSCF (IMS-ALG) is configured to apply media plane optimization including the DTLS layer, for each media line in the SDP offer sent on the Mw interface that does not relate to a data channel or that is the first media line within the SDP offer that relates to a data channel, replace the UDP port number with a port number provided by the eIMS-AGW and encapsulate the UDP port number allocated by the eIMS-AGW in the \"tra-m-line\" SDP attribute; and\n-\tif the eP-CSCF (IMS-ALG) is configured to apply media plane optimization excluding the DTLS layer, in addition for each media line in the SDP offer sent on the Mw interface that does not relate to a data channel or that is the first media line within the SDP offer that relates to a data channel within one SCTP association:\na)\treserve a stream endpoint or termination towards the IMS core network in \"inactive\" mode with \"UDP/DTLS\" as transport protocol, and the same IP address as allocated by the eIMS-AGW for the termination or stream endpoint with resources suitable for the media described in the SDP offer outside the \"tra-m-line\", \"tra-att\" and \"tra-bw\" SDP attributes;\nb)\trequest from the eIMS-AGW a certificate fingerprint for that stream endpoint or termination;\nc)\tencapsulate a \"fingerprint\" attribute as provided by the eIMS-AGW into an \"tra-att\" attribute, and add this attribute as a media level attribute in the SDP offer; and\nd)\tfor a DTLS association that will be established towards the IMS core network create a DTLS association identity;\ne)\tencapsulate an \"a=tls-id\" SDP attribute with the new DTLS association identity into an \"tra-att\" attribute, and add this attribute as a media level attribute in the SDP offer; and\nf)\treplace the UDP port number with a port number provided by the eIMS-AGW and encapsulate the UDP port number allocated by the eIMS-AGW for the stream endpoint or termination towards the IMS core network with \"UDP/DTLS\" transport in the \"tra-m-line\" SDP attribute.\nIf an ePCSCF (IMS-ALG) receives an SDP answer from the IMS core network and the SDP answer includes \"tra-m-line\" media level SDP attributes, the eP-CSCF (IMS-ALG) will de-encapsulate information to the optimized media from the received SDP answer and construct the SDP answer towards the WIC based on that de-encapsulated information as described in 3GPP TS 24.371 [44]. The eP-CSCF (IMS-ALG) shall:\n-\tfor each media line in the SDP answer, which is not marked with a \"tra-SCTP-association\" SDP attribute or which is the first media line in the SDP answer marked with a \"tra-SCTP-association\" SDP attribute that indicates an SCTP association:\n1.\tif the eP-CSCF (IMS-ALG) is configured to apply media plane optimization including the DTLS layer, reconfigure the terminations or stream endpoints towards the IMS core network and towards the WIC related to that media line to transport \"UDP\" and media format agnostic information; or\nNOTE:\tIf interconnected H.248 Stream endpoints or terminations at the eIMS-AGW are configured with transport \"UDP\", they will pass the payload within UDP without modifications, known as UDP transparent forwarding. For WebRTC media plane optimization, the UDP payload will be either DTLS encapsulating SCTP and data channel(s), DTLS-SRTP encapsulating key management information, or SRTP encapsulating audio or video media. However, the eIMS-AGW will be configured at terminations towards the WIC to apply ICE procedures according to clause 5.18.\n2.\tif the eP-CSCF (IMS-ALG) is configured to apply media plane optimization excluding the DTLS layer:\na)\tconfigure the eIMS-AGW to release the termination or stream endpoint towards the IMS core network with resources suitable for the media described in the SDP offer outside the \"tra-m-line\", \"tra-att\" and \"tra-bw\" SDP attributes;\nb)\tconfigure the eIMS-AGW to through-connect the stream endpoint or termination towards the IMS core network with \"UDP/DTLS\" as transport protocol;\nprovide the fingerprint(s) received in the corresponding \"tra-att\" SDP attribute(s) to the eIMS-AGW for the stream endpoint or termination towards the IMS core network and do not provide those fingerprint attribute(s) towards the WIC;\nd)\treserve a stream endpoint or termination towards the WIC with \"UDP/DTLS\" as transport protocol;\ne)\tprovide the fingerprint(s) received in the corresponding \"fingerprint\" SDP attribute(s) in the previous SDP offer from the WIC to the eIMS-AGW for the stream endpoint or termination towards the WIC;\nf)\trequest from the eIMS-AGW a certificate fingerprint for the stream endpoint or termination towards the WIC;\ng)\tinclude fingerprint provided by the eIMS-AGW into an \"fingerprint\" attribute, and add this attribute as a media level attribute in the SDP answer sent towards the WIC;\nh)\tfor a DTLS association that will be established towards WIC create a DTLS association identity and include an \"a=tls-id\" attribute with the new DTLS association identity in the SDP answer sent towards the WIC;\ni)\tdetermine via the SDP \"a=setup\" attribute (see IETF RFC 7345 [33]) encapsulated in \"tra-att\" SDP attribute if the eIMS-AGW needs to act as DTLS client or DTLS server towards the IMS core network and towards the WIC; and\nj)\tfor the termination where the eIMS-AGW needs to act as DTLS server, provide the Establish (D)TLS session information element to request the eIMS-AGW to start the DTLS session setup; and\n3.\tinclude the UDP port number allocated by the eIMS-AGW for the termination or stream endpoint towards the WIC in the SDP media line in the SDP answer to the WIC;\n-\tinclude the IP address received from the eIMS-AGW for the termination towards the WIC in the SDP contact line sent toward the WIC; and\n-\tif several media lines in the SDP answer are marked with \"tra-SCTP-association\" SDP attributes indicating the same SCTP association, release the stream endpoints related to the second and subsequent of those media lines (in the order they appear in the SDP answer).",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.18",
        "ts_24.371"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.20.3.3",
      "section_id": "5.20.3.3",
      "section_title": "WIC terminating call",
      "content": "If an eP-CSCF (IMS-ALG) receives an SDP offer from the IMS core network and the eP-CSCF (IMS-ALG) supports media plane optimization, then the eP-CSCF (IMS-ALG) will determine whether media plane optimization is to be applied as described in 3GPP TS 24.371 [44]. If media plane optimization is to be applied, then the eP-CSCF (IMS-ALG) will de-encapsulate information to the optimized media from the received SDP offer and construct the SDP offer towards the WIC based on that de-encapsulated information as described in 3GPP TS 24.371 [44], and the eP-CSCF (IMS-ALG) shall:\n-\tfor each media line in the SDP offer, which is not marked with a \"tra-SCTP-association\" SDP attribute or which is the first media line in the SDP answer marked with \"tra-SCTP-association\" SDP attribute that indicates an SCTP association:\n1.\treserve a termination or stream endpoint towards the WIC related to that media line;\n2.\tif the eP-CSCF (IMS-ALG) is configured to apply media plane optimization including the DTLS layer, provide transport \"UDP\" and media format agnostic information for the termination or stream endpoint towards the WIC;\nNOTE:\tIf interconnected H.248 Stream endpoints or terminations at the eIMS-AGW are configured with transport \"UDP\", they will pass the payload within UDP without modifications, known as UDP transparent forwarding. For WebRTC media plane optimization, the UDP payload will be either DTLS encapsulating SCTP and data channel(s) or DTLS-SRTP encapsulating key management information, or SRTP encapsulating audio or video media. However, the eIMS-AGW will be configured at terminations towards the WIC to apply ICE procedures according to clause 5.18.\n3.\tif the eP-CSCF (IMS-ALG) is configured to apply media plane optimization excluding the DTLS layer:\na)\tprovide transport \"UDP/DTLS\" and media format agnostic information for the termination or stream endpoints toward the WIC;\nb)\trequest from the eIMS-AGW a certificate fingerprint for the stream endpoint or termination towards the WIC;\nc)\tencapsulate fingerprint provided by the eIMS-AGW into an \"fingerprint\" attribute, and add this attribute as a media level attribute in the SDP offer sent towards the WIC; and\nd)\tdo not provide the fingerprint received in the SDP offer in the corresponding \"tra-att\" SDP attributes towards the WIC;\ne)\tfor a DTLS association that will be established towards WIC create a DTLS association identity, and add an \"a=tls-id\" SDP attribute with the new DTLS association identity in the SDP offer sent towards the WIC; and\n4.\tinclude the UDP port number allocated by the eIMS-AGW for the stream endpoint or termination towards the WIC in the SDP media line; and\n-\tinclude the IP address received from the eIMS-AGW for the termination towards the WIC in the SDP contact line sent toward the WIC.\nIf the eP-CSCF (IMS-ALG) receives an SDP answer from the WIC and the eP-CSCF (IMS-ALG) decided to apply media plane optimization when processing the corresponding SDP offer, then the eP-CSCF (IMS-ALG) will construct the SDP answer towards the IMS core network encapsulating received information as described in 3GPP TS 24.371 [44], and the eP-CSCF (IMS-ALG) shall:\n-\treserve a termination or stream endpoint towards the IMS core network;\n-\tfor each media line in the received SDP answer:\n1.\tif the eP-CSCF (IMS-ALG) is configured to apply media plane optimization including the DTLS layer, provide transport \"UDP\" and media format agnostic information for the termination or stream endpoint towards the IMS core network;\n2.\tif the eP-CSCF (IMS-ALG) is configured to apply media plane optimization excluding the DTLS layer:\na)\tprovide the fingerprint(s) received in the \"fingerprint\" SDP attribute from the WIC to the eIMS-AGW for the stream endpoint or termination towards the WIC;\nb)\tprovide transport \"UDP/DTLS\" and media format agnostic information for the termination or stream endpoint towards the IMS core network;\nc)\trequest from the eIMS-AGW a certificate fingerprint for the stream endpoint or termination towards the IMS core network;\nd)\tencapsulate fingerprint provided by the eIMS-AGW for the termination or stream endpoint towards the IMS core network into a \"tra-att\" SDP attribute, and add this attribute as a media level attribute in the SDP answer sent towards the IMS core network;\ne)\tfor a DTLS association that will be established towards the IMS core network create a DTLS association identity;\nf)\tencapsulate an \"a=tls-id\" SDP attribute with the new DTLS association identity into an \"tra-att\" attribute, and add this attribute as a media level attribute in the SDP answer sent towards the IMS core network;\ng)\tdetermine via the SDP \"a=setup\" attribute (see IETF RFC 7345 [33]) if the eIMS-AGW needs to act as DTLS client or DTLS server towards the IMS core network and towards the WIC; and\nh)\tfor the termination where the eIMS-AGW needs to act as DTLS server, provide the Establish (D)TLS session information element to request the eIMS-AGW to start the DTLS session setup; and\n3.\tencapsulate the UDP port number allocated by the eIMS-AGW for the stream endpoint or termination towards the IMS core network in the \"tra-m-line\" SDP attribute; and\n-\tinclude the IP address received from the eIMS-AGW for the termination towards the IMS core network in the SDP contact line.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.18",
        "ts_24.371"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.21.1",
      "section_id": "5.21.1",
      "section_title": "General",
      "content": "The IMS-ALG and the IMS-AGW may support the functionalities related to the support of the ALTC functionality as specified in IETF RFC 6947 [59] and 3GPP TS 24.229 [11] to support dual stack UEs. The present clause describes the requirements for P-CSCF (IMS-ALG) and IMS-AGW when the ALTC procedures are supported.\nIf the IMS-ALG supports ALTC and, based on local policies, decides to insert ALTC information in the SDP offer sent to the terminating side, the IMS-ALG shall request the IMS-AGW to reserve two sets of transport addresses/resources towards the access network to enable media to traverse the IMS-AGW, one for each media line associated to ALTC information. The IMS-ALG shall request the IMS-AGW to release the transport resources reserved for the address type finally not used.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.22.1",
      "section_id": "5.22.1",
      "section_title": "General",
      "content": "The IMS-ALG and the IMS-AGW may support the video Region-of-Interest (ROI) as defined in 3GPP TS 26.114 [21]. Three modes are specified for supporting ROI, including \"Far End Camera Control (FECC)\", \"Arbitrary ROI\" and \"Predefined ROI\". The IMS-ALG and the IMS-AGW may independently support any of these modes.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.22.2",
      "section_id": "5.22.2",
      "section_title": "\"Far End Camera Control\" mode",
      "content": "The IMS-ALG and IMS-AGW may support the \"Far End Camera Control\" mode as specified in 3GPP TS 26.114 [21]. If the IMS-ALG and IMS-AGW support the \"Far End Camera Control\" mode, the IMS-ALG and IMS-AGW shall apply the procedures in the present clause.\nIf the IMS-ALG receives an SDP body containing an \"m=\" line with a media type \"application/h224\", as defined by IETF RFC 4573 [68] which indicates support for FECC (ITU-T Recommendation H.281 [70]) using ITU-T Recommendation H.224 [69], the IMS-ALG shall:\n-\tforward within SIP signalling the SDP body received from the preceding node with unmodified SDP \"m=\" and \"a=\" lines related to the \"application/h224\" media types (see the related SDP examples in annex A.4.2e of 3GPP TS 26.114 [21]) to the succeeding node; and\nNOTE 1:\tThere may be one media type \"application/h224\" \"m=\" line for each video \"m=\" line.\n-\trequest the IMS-AGW to provide a separate IP/UDP/RTP transport for the \"application/h224\" media stream by setting the \"m=\" line media type to \"application\" and \"RTP/AVP\" or \"RTP/AVPF\" over UDP as transport protocol when reserving the transport addresses/resources towards the MTSI client and IMS core network.\nNOTE 2:\tThe use of FECC itself is internal to the H.224 frame and is identified by the client ID field of the H.224 packet. The IMS-ALG only indicates the use of IP/UDP/RTP. The use of FECC is signalled via H.224 by a MTSI client.\nThe IMS-AGW shall then:\n-\tassign resources for the requested media stream, i.e., resources for a media-format agnostic RTP flow; and\n-\tforward transparently RTP/UDP packets (with the transparent (H.224)-PDU) between the incoming and outgoing network.",
      "chunk_type": "general",
      "cross_references": [
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.22.3",
      "section_id": "5.22.3",
      "section_title": "\"Predefined ROI\" mode",
      "content": "The IMS-ALG and IMS-AGW may support the \"Predefined ROI\" mode as specified in 3GPP TS 26.114 [21]. If the IMS-ALG and IMS-AGW support the \"Predefined ROI\", the IMS-ALG and IMS-AGW shall apply the procedures in the present clause.\nIf the IMS-ALG receives an SDP body containing an \"a=rtcp-fb\" line with the \"Predefined ROI\" type expressed by the parameter \"3gpp-roi-predefined\", as described in 3GPP TS 26.114 [21], the IMS-ALG shall:\n-\tforward within SIP signalling the SDP body received from the preceding node with unmodified SDP \"a=rtcp-fb\" lines related to the \"3gpp-roi-predefined\" parameter to the succeeding node (see the related SDP examples in annex A.4.2e of 3GPP TS 26.114 [21]); and\n-\tinclude the \"Predefined ROI\" information element when seizing resources in the IMS-AGW to request the IMS-AGW to assign the resources for the corresponding RTCP control flow to convey pre-defined ROI information.\nThe IMS-AGW shall then assign resources for the requested RTCP control flow and forward transparently the RTCP \"FB ROI\" packets between the incoming and outgoing network. The procedures described in clause 5.9 shall also apply.\nNOTE 1:\tThe RTCP control flow contains multiple RTCP packet types.\nIf the IMS-ALG receives an SDP body containing the predefined ROI attribute(s) \"a=predefined_ROI\" defined in 3GPP TS 26.114 [21], the IMS-ALG shall forward the SDP body with unmodified predefined ROI attribute(s) for the send and receive directions when seizing or modifying resources in the IMS-AGW.\nIf the IMS-ALG receives an SDP body containing \"a=extmap\" attribute(s), as defined in IETF RFC 5285 [23], and the \"a=extmap\" attribute(s) contain the pre-defined ROI URN(s) (i.e. the ROI URN for carriage of pre-defined region of interest information in the sent video stream is given by \"urn:3gpp:predefined-roi-sent\") as defined in 3GPP TS 26.114 [21], then the IMS-ALG shall:\n-\tinclude the \"Extended RTP header for Sent ROI\" information element when seizing resources in the IMS-AGW to indicate to the IMS-AGW that it shall allow the RTP header extension for predefined ROI to pass; and\n-\tforward within SIP signalling, the SDP body received from the preceding node with unmodified \"a=extmap\" attribute(s) to the succeeding node (see the related SDP examples in annex A.4.2e of 3GPP TS 26.114 [21]).\nNOTE 2:\tThe UE supporting the Predefined ROI feature will not send the extended RTP headers for Sent ROI if the UE did not receive any SDP body with the Predefined ROI related \"a=extmap\" attribute.\nIf the IMS-AGW has been instructed to pass on the extended RTP header for predefined ROI as described above for both incoming and outgoing terminations then:\n-\tif the IMS AGW does not apply video transcoding, it shall pass any received RTP header extension for Predefined ROI to succeeding RTP streams; or\n-\tif the IMS-AGW applies video transcoding, it shall keep the predefined ROI information unchanged during the transcoding and copy the received RTP header extension for Predefined ROI to the succeeding outgoing RTP stream(s) after transcoding the associated group of packets.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_5.9",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.22.4",
      "section_id": "5.22.4",
      "section_title": "\"Arbitrary ROI\" mode",
      "content": "The IMS-ALG and IMS-AGW may support the \"Arbitrary ROI\" mode as specified in 3GPP TS 26.114 [21]. If the IMS-ALG and IMS-AGW support the \"Arbitray ROI\", the IMS-ALG and IMS-AGW shall apply the procedures in the present clause.\nIf the IMS-ALG receives an SDP body containing an \"a=rtcp-fb\" line with the \"Arbitrary ROI\" type expressed by the parameter \"3gpp-roi-arbitrary\", as described in 3GPP TS 26.114 [21], the IMS-ALG shall:\n-\tforward within SIP signalling the SDP body received from the preceding node with unmodified SDP \"a=rtcp-fb\" lines related to the \"3gpp-roi-arbitrary\" parameter to the succeeding node (see the related SDP examples in annex A.4.2e of 3GPP TS 26.114 [21]); and\n-\tinclude the \"Arbitrary ROI\" information element when seizing resources in the IMS-AGW to request the IMS-AGW to assign the resources for the corresponding RTCP control flow to convey arbitrary ROI information.\nThe IMS-AGW shall then assign resources for the requested RTCP control flow and forward transparently the RTCP \"FB ROI\" packets between the incoming and outgoing network. The procedures described in clause 5.9 shall also apply.\nNOTE 1:\tThe RTCP control flow contains multiple RTCP packet types.\nIf the IMS-ALG receives an SDP body containing \"a=extmap\" attribute(s), as defined in IETF RFC 5285 [23], and the \"a=extmap\" attribute(s) contain the arbitrary ROI URN(s) (i.e. the ROI URN for carriage of arbitrary region of interest information in the sent video stream is given by \"urn:3gpp:roi-sent\") as defined in 3GPP TS 26.114 [21], then the IMS-ALG shall:\n-\tinclude the \"Extended RTP header for Sent ROI\" information element when seizing resources in the IMS-AGW to indicate to the IMS-AGW that it shall allow the RTP header extension for arbitrary ROI to pass; and\n-\tforward within SIP signalling, the SDP body received from the preceding node with unmodified \"a=extmap\" attribute(s) to the succeeding node (see the related SDP examples in annex A.4.2e of 3GPP TS 26.114 [21]).\nNOTE 2:\tThe UE supporting the Arbitrary ROI feature will not send the extended RTP headers for Sent ROI if the UE did not receive any SDP body with the Arbitrary ROI related \"a=extmap\" attribute.\nIf the IMS-AGW has been instructed to pass on the extended RTP header for arbitrary ROI as described above for both incoming and outgoing terminations then:\n-\tif the IMS AGW does not apply video transcoding, it shall pass any received RTP header extension for Arbitrary ROI to succeeding RTP streams; or\n-\tif the IMS-AGW applies video transcoding, it shall keep the arbitrary ROI information unchanged during the transcoding and copy the received RTP header extension for Arbitrary ROI to the succeeding outgoing RTP stream(s) after transcoding the associated group of packets.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_5.9",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.23",
      "section_id": "5.23",
      "section_title": "SDP Capability Negotiation (SDPCapNeg)",
      "content": "The SDP Capability Negotiation (SDPCapNeg) as specified in IETF RFC 5939 [66] is adopted as an optional functionality to negotiate capabilities and their associated configurations according to 3GPP TS 24.229 [11]. If the ICS service is supported then the IMS-ALG and the IMS-AGW may further optionally support SDP Media Capability Negotiation as specified in IETF RFC 6871 [67] for alternative CS configuration.\nUpon receipt of an incoming SDP offer containing the attributes of SDP capability negotiation, e.g. offer AVPF and AVP together for the RTP profile negotiation using \"a=tcap\", \"a=pcfg\" and \"a=acfg\" attributes, the IMS-ALG shall:\n-\trequest the IMS-AGW to reserve resources only for the default configuration without SDPCapNeg, and make the decision on support of the alternative configurations based on the IMS-ALG/IMS-AGW capability as provisioned before forwarding the SDP offer, i.e. handling SDPCapNeg at the controller level; or\n-\trequest the IMS-AGW to reserve resources for all of these configurations by signalling SDPCapNeg to the IMS-AGW, and update the SDP offer based on the response from the IMS-AGW before forwarding.\nNOTE:\tThe additional benefit of signalling SDPCapNeg between the IMS-ALG and the IMS-AGW is to check the resource availability for the corresponding configurations and to avoid the further session failure in case of inadequate resources for the configuration changes in the final confirmation. However, due to the extra resources reserved only during the call establishment phase, there is increased risk of call establishment failure.\nIn case the IMS-ALG decides to request the IMS-AGW to reserve resources for all of those configurations, the IMS-ALG shall:\n-\tuse legacy SDP attributes as specified in IETF RFC 4566 [53] to do the mapping of actual and potential configurations with the H.248 ReserveGroup concept; or\n-\tuse SDP extensions for SDP capability negotiation as specified in IETF RFC 5939 [66], if supported by the IMS-AGW.\nBefore using SDP extensions for SDP capability negotiation as specified in IETF RFC 5939 [66] towards the IMS-AGW, the IMS-ALG shall perform the necessary checks (i.e. through auditing or via prior provisioning) to ensure that the IMS-AGW supports the syntax and capabilities requested. For an auditing the procedure in clause 6.1.8.1 is used with the \"SDPCapNeg Supported Capabilities\" as the object.\nWhen receiving a request from the IMS-ALG with information element \"SDPCapNeg configuration\" indicating the potential use of multiple configurations, the IMS-AGW shall reserve resources for all of those configurations that it supports and shall send indicate the configurations for which it reserved resources in an \"SDPCapNeg configuration\" information element in the response. The IMS-ALG shall update the SDP offer with SDPCapNeg configurations in the response from the IMS-AGW and shall forward the SDP offer to the next hop.\nThe IMS-ALG may also provide SDP configurations to the IMS-AGW with no dependency on the incoming SDP offer, e.g. the IMS-ALG may wildcard the supported configurations in order to construct or update an SDP offer with the addition of alternative configurations via SDPCapNeg attributes.\nOn receipt of an SDP answer with SDPCapNeg, the IMS-ALG shall request the IMS-AGW to configure the resources for the selected configuration. If the IMS-AGW previously reserved any temporary resources for configurations that were not selected, the IMS-ALG shall also request the IMS-AGW to release those resources.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.1.8.1",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.24",
      "section_id": "5.24",
      "section_title": "RTP-level pause and resume",
      "content": "The IMS-ALG and the IMS-AGW may support the \"RTP-level pause and resume\" signalling as defined in 3GPP TS 26.114 [21] and IETF RFC 7728 [79].\nRTCP feedback messages to request for pause and resume of media streams can be used by conference participants supporting Multi-stream Multiparty Conferencing Media Handling feature, as specified in 3GPP TS 26.114 [21] annex S. Usage of the RTCP feedback \"pause and resume\" messages is negotiated via SDP offer/answer exchange through an extension of RTCP feedback capability attribute \"a=rtcp-fb\" (defined in IETF RFC 4585 [77]).\nIf the IMS-ALG and IMS-AGW support the \"RTP-level pause and resume\" signalling, the IMS-ALG and IMS-AGW shall apply the procedures in the present clause.\nIf the IMS-ALG receives an SDP offer containing \"a=rtcp-fb\" line(s) with a \"CCM\" parameter (as defined in IETF RFC 5104 [78]) and a \"pause\" CCM parameter (as defined in IETF RFC 7728 [79]), and if the IMS-ALG does not support or does not apply the transcoding procedure defined in clause 5.13, the IMS-ALG shall forward within SIP signalling, the SDP offer received from the preceding node with unmodified \"a=rtcp-fb\" line(s) with a \"pause\" CCM parameter. Otherwise, if the IMS-ALG does insert any transcoding or if the IMS-AGW does not support the \"RTP-level pause and resume\" signalling, the IMS-ALG shall forward within SIP signalling, the SDP offer received from the preceding node without any \"a=rtcp-fb\" line(s) with a \"pause\" CCM parameter.\nIf the IMS-ALG forwarded the SDP offer containing the \"a=rtcp-fb\" line(s) with a \"pause\" CCM parameter and receives an SDP answer also containing the \"a=rtcp-fb\" line(s) with a \"pause\" CCM parameter (the reception of the attribute indicates a successful \"RTP-level pause and resume\" negotiation) then the IMS-ALG shall:\na)\twhen requesting the IMS-AGW to configure resources towards the succeeding node and towards the preceding node, include the \"CCM pause-resume\" information element to indicate that the IMS-AGW shall forward RTCP feedback \"CCM PAUSE-RESUME\" messages transparently; and\nb)\tforward the SDP answer containing the \"a=rtcp-fb\" line(s) with a \"pause\" CCM parameter to its preceding node.\nThe IMS-AGW shall then assign resources for the requested RTCP control flow and shall transparently forward the RTCP \"CCM PAUSE\" packets between incoming and outgoing networks.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.13",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.25",
      "section_id": "5.25",
      "section_title": "RTCP Codec Control Commands and Indications",
      "content": "The IMS-ALG and the IMS-AGW may support signalling of \"RTCP Codec Control Commands and Indications\", as defined in 3GPP TS 26.114 [21] and IETF RFC 5104 [78].\nNOTE 1:\t3GPP TS 26.114 [21] specifies support of the following RTCP feedback codec control messages (CCM): \"Full Intra Request (FIR)\", \"Temporary Maximum Media Stream Bit Rate Request (TMMBR)\" and \"Temporary Maximum Media Stream Bit Rate Notification (TMMBN)\".\nThe RTCP feedback FIR message can be used both by point-to-point video calls, and by conference participants supporting Multi-stream Multiparty Conferencing Media Handling feature, as specified in 3GPP TS 26.114 [21] annex S, to request the media sender to send a decoder refresh point.\nThe RTCP TMMBR and TMMBN feedback messages can also be used in reaction to the Explicit Congestion Notification, as specified in clause 5.12.\nUsage of the RTCP feedback \"CCM\" messages is negotiated via SDP offer/answer exchange through an extension (defined in IETF RFC 5104 [78]) of the RTCP feedback capability attribute \"a=rtcp-fb\" (defined in IETF RFC 4585 [77]).\nNOTE 2:\tThe SDP offer/answer negotiation is performed with a separate \"a=rtcp-fb\" attribute line for each CCM message type.\nIf the IMS-ALG and IMS-AGW support the \"RTCP Codec Control Commands and Indications\" signalling, the IMS-ALG and IMS-AGW shall apply the procedures in the present clause.\nIf the IMS-ALG receives an SDP offer containing \"a=rtcp-fb\" line(s) with a \"CCM\" parameter and with a \"fir\" and/or \"tmmbr\" CCM parameters (defined in IETF RFC 5104 [78]) under video \"m=\" line(s), and if the IMS-ALG does not configure the IMS-AGW to transcode the corresponding video media stream and/or to act as ECN endpoint for the corresponding video media stream, the IMS-ALG shall forward within SIP signalling, the SDP offer received from the preceding node with unmodified \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and with \"fir\" and/or \"tmmbr\" CCM parameters.\nNOTE 3:\tIf the IMS-ALG configures the IMS-AGW to transcode a video media stream and/or to act as ECN endpoint for the corresponding video media stream, the IMS-ALG can insert \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and with \"fir\" and/or \"tmmbr\" CCM parameters within SDP offer irrespective of whether they were received from the preceding node.\nIf the IMS-ALG does not configure the IMS-AGW to transcode the corresponding video media stream and/or to act as ECN endpoint, and if the IMS-ALG received an SDP answer also containing the \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and with the same \"fir\" and/or \"tmmbr\" CCM parameters (the presence of the same \"a=rtcp-fb ccm\" line(s) in the SDP answer indicates a successful negotiation of the particular CCM message), then the IMS-ALG shall:\n-\twhen requesting the IMS-AGW to configure resources towards the succeeding node and towards the preceding node, include the \"CCM BASE\" information element with the \"fir\" and/or \"tmmbr\" CCM parameters to indicate that the IMS-AGW shall be prepared to receive and is allowed to send the RTCP CCM \"FIR\" and/or \"TMMBR/TMMBN\" feedback messages; and\n-\tforward the SDP answer containing the \"a=rtcp-fb\" line(s) with the \"fir\" and/or \"tmmbr\" CCM parameters (from the received SDP answer) to its preceding node.\nIf the IMS-ALG configures the IMS-AGW to transcode the corresponding video media stream and/or to act as ECN endpoint:\n-\tif the IMS-ALG did not send towards the succeeding node the SDP offer containing the \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and the with \"fir\" and/or \"tmmbr\" CCM parameters, then the IMS-ALG may:\na)\twhen requesting the IMS-AGW to configure resources towards the preceding node, include the \"CCM BASE\" information element with the \"fir\" and/or \"tmmbr\" CCM parameters to indicate that the IMS-AGW shall be prepared to receive and is allowed to send the RTCP CCM \"FIR\" and/or \"TMMBR/TMMBN\" feedback messages; and\nb)\tinclude in the SDP answer it sends to the preceding node the \"a=rtcp-fb\" line(s) with the \"fir\" and/or \"tmmbr\" CCM parameters (as received SDP offer); and\n-\tif the IMS-ALG sent towards the succeeding node the SDP offer containing the \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and the with \"fir\" and/or \"tmmbr\" CCM parameters, and received an SDP answer also containing the \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and with the same \"fir\" and/or \"tmmbr\" CCM parameters, then the IMS-ALG shall:\na)\twhen requesting the IMS-AGW to configure resources towards the succeeding node, include the \"CCM BASE\" information element with the \"fir\" and/or \"tmmbr\" CCM parameters to indicate that the IMS-AGW shall be prepared to receive and is allowed to send the RTCP CCM \"FIR\" and/or \"TMMBR/TMMBN\" feedback messages; and\nb)\tif the the IMS-ALG received from the preceding node the SDP offer containing the \"a=rtcp-fb\" line(s) with the \"CCM\" parameter and the with \"fir\" and/or \"tmmbr\" CCM parameters, include in the SDP answer it sends to the preceding node the \"a=rtcp-fb\" line(s) with the \"fir\" and/or \"tmmbr\" CCM parameters (as received SDP offer).\nThe IMS-AGW shall then assign resources for the requested RTCP control flow:\n-\tif the IMS-AGW acts as an ECN endpoint (as described in clause 5.12) or applies the video transcoding procedure, the IMS-AGW:\na)\tmay send the RTCP TMMBR feedback message with an \"IMS-AGW-generated\" value in an \"SSRC of media sender\" field that is kept constant for the duration of the session, different from any SSRC value in the active RTP streams for the session, to request the media sender to limit the maximum bit rate for a media stream to, or below, the provided value;\nNOTE 4:\tTrigger for sending of the RTCP TMMBR feedback message can be reception of RTP packets marked with ECN-CE, as described in clause 5.12. The reason to use an \"IMS-AGW-generated\" value in \"SSRC of media sender\" and to keep that value constant in the session is that the IMS-AGW must be possible to identify as being a separate source of sending TMMBR messages, to avoid TMMBR induced by ECN restrictions interfering with other TMMBR restrictions set by other media receivers in the media path, as described in clause 3.5.4 of IETF RFC 5104 [78].\nb)\tupon reception of the RTCP TMMBR feedback message and if performing transcoding, shall adjust the sent media rate to the requested rate or lower and shall respond by sending the RTCP TMMBN feedback message; and\nc)\tmay send the RTCP FIR feedback message to request the media sender to send a decoder refresh point; or\n-\tif the IMS-AGW does not act as an ECN endpoint and does not apply the video transcoding procedure, the IMS-AGW shall transparently forward received RTCP FIR feedback message, and received RTCP TMMBR and TMMBN feedback messages between the incoming and outgoing networks.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.12",
        "clause_3.5.4",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_5.26",
      "section_id": "5.26",
      "section_title": "Delay Budget Information (DBI)",
      "content": "The IMS-ALG and the IMS-AGW may support the \"DBI\" signalling as defined in 3GPP TS 26.114 [21].\nRTCP feedback messages to report or request additional delay budget for voice and video media streams (as defined in 3GPP TS 26.114 [21] clause 7.3.8) can be used by participants in a point-to-point MTSI session, and by conference participants, as specified in 3GPP TS 26.114 [21].\nIf the IMS-ALG and IMS-AGW support the \"DBI\" signalling, the IMS-ALG and IMS-AGW shall apply the procedures in the present clause.\nIf the IMS-ALG receives an SDP offer containing an \"a=rtcp-fb\" line(s) with a \"3GPP-delay-budget\" parameter as defined in 3GPP TS 26.114 [21], the IMS-ALG shall forward within SIP signalling, the SDP offer received from the preceding node with the unmodified \"a=rtcp-fb\" line(s) with \"3GPP-delay-budget\" parameter. Otherwise, if the IMS-AGW does not support the \"DBI\" signalling, the IMS-ALG shall forward within SIP signalling, the SDP offer received from the preceding node without any \"a=rtcp-fb\" line(s) with a \"3GPP-delay-budget\" parameter.\nIf the IMS-ALG forwarded the SDP offer containing the \"a=rtcp-fb\" line(s) with a \"3GPP-delay-budget\" parameter and receives an SDP answer also containing the \"a=rtcp-fb\" line(s) with a \"3GPP-delay-budget\" parameter (the reception of the attribute indicates a successful \"3GPP-delay-budget\" negotiation) then the IMS-ALG shall:\na)\twhen requesting the IMS-AGW to configure resources towards the succeeding node and towards the preceding node, include the \"DBI\" information element to indicate that the IMS-AGW shall forward RTCP DBI feedback messages transparently; and\nb)\tforward the SDP answer containing the \"a=rtcp-fb\" line(s) with a \"3GPP-delay-budget\" parameter to its preceding node.\nThe IMS-AGW shall then assign resources for the requested RTCP control flow and shall transparently forward the RTCP DBI feedback messages between incoming and outgoing networks.",
      "chunk_type": "general",
      "cross_references": [
        "ts_26.114_clause_7.3.8",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.1",
      "section_id": "6.1.1",
      "section_title": "General",
      "content": "The non-call related procedures are based on corresponding procedures of 3GPP TS 23.205 [8] where the IMS-ALG takes the place of the MSC server and the IMS-AGW takes the place of the MGW.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_23.205"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.2",
      "section_id": "6.1.2",
      "section_title": "IMS-AGW Unavailable",
      "content": "The IMS-ALG server recognises that the IMS-AGW is unavailable in the following 4 cases:\n1.\tThe signalling connection is unavailable\nFigure 6.1.2.1: Signalling connection failure\n2.\tThe IMS-AGW indicates the failure or the maintenance locking condition to all connected IMS-ALG servers\nFigure 6.1.2.2: IMS-AGW indicates the Failure/Maintenance locking\nThe failure or maintenance locking indication indicates that the IMS-AGW is locked for new calls or will soon go out of service and that no new connections should be established using this IMS-AGW. The IMS-AGW can choose between the \"graceful\" and the \"forced\" method. In the graceful method the connections are cleared when the corresponding calls are disconnected. In the forced method all connection are cleared immediately.\n3.\tThe IMS-ALG recognises that the IMS-AGW is not functioning correctly, e.g. because there is no reply on periodic sending of Audits. The periodic sending of Audits by IMS-ALG should go on.\nIn all of the above cases the IMS-ALG shall prevent the usage of the IMS-AGW until the IMS-AGW has recovered or the communication with the IMS-AGW is restored.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.2.1",
        "figure_6.1.2.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.3",
      "section_id": "6.1.3",
      "section_title": "IMS-AGW Available",
      "content": "The IMS-ALG discovers that the IMS-AGW is available when it receives an IMS-AGW Communication Up message or an IMS-AGW Restoration message. If the IMS-ALG does not wish to sustain an association with the IMS-AGW, the response sent to the IMS-AGW may indicate an alternative IMS-ALG signalling address, in which case the IMS-AGW shall not consider itself registered and should preferably attempt to re-register with this alternative IMS-ALG before any further alternate IMS-ALGs. Otherwise, the response shall not indicate any alternative IMS-ALG signalling address.\nWhen the IMS-ALG discovers that the IMS-AGW is available the following shall occur:\n1.\tSignalling recovery\nThe IMS-AGW indicates to all connected IMS-ALGs that the signalling connection is restored.\nFigure 6.1.3.1: Communication goes up\n2.\tIMS-AGW restoration/maintenance unlocking indication.\nThe IMS-AGW indicates to all connected IMS-ALGs that normal operation has resumed.\nFigure 6.1.3.2: IMS-AGW indicates recovery from a failure/or maintenance unlocking\nNOTE:\tThis procedure may be used after recovery from a signalling failure.\n3.\tThe IMS-ALG recognises that the IMS-AGW is now functioning correctly, e.g. because there is a reply on periodic sending of Audits.\nAfter this the IMS-ALG can use the IMS-AGW.\nIf none of 1, 2, and 3 happens the IMS-ALG server can initiate the IMS-ALG Ordered Re-register procedure.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.3.1",
        "figure_6.1.3.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.4",
      "section_id": "6.1.4",
      "section_title": "IMS-AGW Recovery",
      "content": "If the IMS-AGW recovers from a failure, is maintenance unlocked, or it has been restarted, it registers to its known IMS-ALGs using the IMS-AGW Restoration procedure or the IMS-AGW Registration procedure. The IMS-AGW can indicate whether the Service has been restored or whether it has restarted with a cold or warm boot. If the IMS-ALG does not wish to sustain an association with the IMS-AGW, the response sent to the IMS-AGW may indicate an alternative IMS-ALG signalling address, in which case the IMS-AGW shall not consider itself registered and should preferably attempt to re-register with this alternative IMS-ALG before any further alternate IMS-ALGs. Otherwise, the response shall not indicate any alternative IMS-ALG signalling address.\nFigure 6.1.4.1: IMS-AGW Restoration\nFigure 6.1.4.2 IMS-AGW Registration\nAfter the recovery the IMS-ALG can use the IMS-AGW.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.4.1",
        "figure_6.1.4.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.5.1",
      "section_id": "6.1.5.1",
      "section_title": "General",
      "content": "If an IMS-AGW-unavailable condition is provoked by a failure/recovery action, the IMS-ALG recovery sequence will, from an information flow point of view, look like IMS-AGW unavailable and then IMS-AGW available. If an IMS-AGW-unavailable condition is not provoked, the IMS-ALG recovery sequence will look like IMS-AGW available.\nAfter the information flow, the terminations affected by the recovery action are released.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_6.1.5.2",
      "section_id": "6.1.5.2",
      "section_title": "IMS-ALG Restoration",
      "content": "NOTE:\tNormal release procedure may also be initiated.\nFigure 6.1.5.2.1: IMS-ALG Restoration\nAfter the recovery action is complete and it is possible to signal to the IMS-AGW the IMS-ALG starts a timer Tw. If recovery indications are not received (IMS-AGW Communication Up or IMS-AGW Restoration) from the IMS-AGW during Tw an Audit is sent. If the IMS-ALG receives a recovery indication or IMS-AGW communication up indication, it shall acknowledge the indication before the IMS-ALG Restoration may be sent or the release procedure is initiated.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.5.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.6",
      "section_id": "6.1.6",
      "section_title": "IMS-AGW Re-register",
      "content": "When the IMS-ALG requests an IMS-AGW to perform a registration (see clauses 6.1.3, 6.1.4 and 6.1.7), the IMS-AGW performs a re-registration to the IMS-ALG which is defined in the IMS-ALG address.\nFigure 6.1.6.1: Re-registration of an IMS-AGW",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.6.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.7",
      "section_id": "6.1.7",
      "section_title": "IMS-AGW Re-registration Ordered by IMS-ALG",
      "content": "If the IMS-ALG knows that communication is possible, but the IMS-AGW has not registered, the IMS-ALG can order re-registration of the IMS-AGW.\nFigure 6.1.7.1: Re-registration ordered by the IMS-ALG\nIf the re-registration request is accepted the IMS-AGW uses the IMS-AGW Re-register procedure to register with the IMS-ALG.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.7.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.8.1",
      "section_id": "6.1.8.1",
      "section_title": "Audit of Value",
      "content": "The IMS-ALG may request the IMS-AGW to report the current values assigned to distinct objects in the IMS-AGW. This procedure may be used when a change has occurred in the IMS-ALG such that the IMS-ALG is unsure of the current Service State of Terminations.\nFigure 6.1.8.1.1: Audit Value",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.8.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.8.2",
      "section_id": "6.1.8.2",
      "section_title": "Audit of Capability",
      "content": "The IMS-ALG may request the IMS-AGW to report the capabilities of distinct objects in the MGW.\nFigure 6.1.8.2.1: Audit Capability",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.8.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.9",
      "section_id": "6.1.9",
      "section_title": "IMS-AGW Capability Change",
      "content": "The IMS-AGW reports a change of capability of distinct objects in the MGW.\nFigure 6.1.9.1: Capability Update\nThe IMS-ALG may use the Audit Value and/or Audit Capability procedures to obtain further information, about the objects whose capabilities have changed.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.9.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.10",
      "section_id": "6.1.10",
      "section_title": "IMS-ALG Out of service",
      "content": "Figure 6.1.10.1: IMS-ALG Out of Service\nIf an IMS-ALG discovers that it wants to go out of service it may start an IMS-ALG Out of Service procedure. The IMS-ALG can indicate whether it requires the context to be cleared immediately (forced) or cleared as the bearer control protocol clears the bearer (Graceful).",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.10.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.11",
      "section_id": "6.1.11",
      "section_title": "IMS-AGW Resource Congestion Handling - Activate",
      "content": "When the IMS-ALG requires that an IMS-AGW congestion notification mechanism be applied in the MGW, the IMS-ALG shall use the IMS-AGW Resource Congestion Handling - Activate procedure towards the IMS-AGW.\nFigure 6.1.11.1: IMS-AGW Resource Congestion Handling - Activate",
      "chunk_type": "requirement",
      "cross_references": [
        "figure_6.1.11.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.12",
      "section_id": "6.1.12",
      "section_title": "MGW Resource Congestion Handling -Indication",
      "content": "When the IMS-ALG receives a load reduction notification from the IMS-AGW via the IMS-AGW Resource Congestion Handling - Indication procedure, the IMS-ALG tries to reduce the processing load that the IMS-ALG creates on the IMS-AGW. The IMS-AGW shall decide the actual level of traffic reduction.\nFigure 6.1.12.1: IMS-AGW Resource Congestion Handling – Indication",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.12.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.13",
      "section_id": "6.1.13",
      "section_title": "Control association monitoring",
      "content": "Monitoring of the H.248 control association may be performed by monitoring the status of the transport link association where the transport protocol provides sufficient coupling to the H.248.1 protocol, i.e. if the transport link association is disconnected when no local H.248.1 protocol connection exists.\nAn alternative method for the IMS-AGW to detect loss of the IMS-ALG may be achieved by requesting the IMS-AGW to poll the IMS-ALG periodically\nUpon registration of an IMS-AGW, the IMS-ALG may use the Inactivity Timeout - Activate procedure towards the IMS-AGW to request the IMS-AGW to monitor incoming messages for periods of silence exceeding the maximum inactivity timer value.\nFigure 6.1.13.1: Inactivity Timeout - Activate\nUpon receipt of an inactivity timeout notification from the IMS-AGW via the Inactivity Timeout - Indication procedure, the IMS-ALG shall send a reply to the IMS-AGW. If the IMS-ALG has failed, the IMS-AGW will not receive a reply.\nFigure 6.1.13.2: Inactivity Timeout - Indication\nIf no Inactivity Timeout – Indication Ack reply is received, the IMS-AGW shall consider the IMS-ALG to have failed. The IMS-AGW may then attempt to re-contact its controlling IMS-ALG by performing IMS-AGW Communication Up. If not successful, the IMS-AGW may then attempt to register to a new IMS-ALG.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1.13.1",
        "figure_6.1.13.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.14",
      "section_id": "6.1.14",
      "section_title": "Realm Availability Monitoring",
      "content": "If the IMS-AGW supports IP Realm Availability monitoring, the IMS-ALG may request the monitoring of the available IP Realms by the IMS-AGW; the IMS-AGW shall inform the IMS-ALG of any changes in realm availability.\nNOTE:\tThe IMS-ALG can use the AuditValue procedure to determine which IP realms are currently available.\nThe  IMS-ALG may use the Realm Availability - Activate procedure towards the IMS-AGW to request the IMS-AGW to monitor the status of its IP Realms.\nFigure 6.1.14.1: Realm Availability - Activate\nThe IMS-AGW shall inform the IMS-ALG via the Realm Availability – Notification procedure.\nFigure 6.1.14.2: Realm Availability - Indication\nOn being informed of newly available/unavailable realms, IMS-ALG shall take appropriate action (e.g. update its list of available realms etc.).",
      "chunk_type": "requirement",
      "cross_references": [
        "figure_6.1.14.1",
        "figure_6.1.14.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.1.15",
      "section_id": "6.1.15",
      "section_title": "Failure of IP Port, Interface or Group of Interfaces",
      "content": "This procedure only applies when text encoding is used on the H.248 interface.\nThe IMS-ALG shall and the IMS-AGW may support the Termination Out-of-Service procedure.\nIf the IMS AGW suffers a loss of physical IP device(s) that pertain to a whole IP Realm it may report the IP Realm as unavailable (see clause 6.1.14). However, it is possible that a failure affects a physical port or group of ports that forms a subset of the IP Realm and therefore many terminations are affected. In such cases the IMS-AGW may initiate a Termination Out of Service procedure to inform the IMS-ALG that the set of terminations is out of service. This is shown in Figure 6.1.15.1.\nFigure 6.1.15.1: Termination Out of Service\nOn receipt of the Termination Out Of Service the IMS-ALG shall initiate the appropriate actions, e.g. by subtracting the affected terminations and releasing the affected calls.\nNOTE:\tThis procedure provides an alternative failure reporting to the IP Bearer Released procedure (which allows reporting the failure of one IP Bearer / termination). The Termination Out-of-Service procedure avoids sending an avalanche of notifications when the failure affects multiple ephemeral terminations.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.1.14",
        "figure_6.1.15.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.1",
      "section_id": "6.2.1",
      "section_title": "Gate Control & Local NA(P)T procedure",
      "content": "The session establishment and session release procedures are specified in 3GPP TS 23.228 [2] Annex G.4.3 and G.4.4.\nFigure 6.2.1.2 depicts the signalling flow for a session setup from the IMS access network towards the IMS core network when the P‑CSCF invokes the IMS-ALG function for a session. The same signalling flow applies for a session setup from the IMS core network towards the IMS access network with the exception that terminations T1 and T2 are then exchanged.\nFigure 6.2.1.1: H.248 Context Model\nFigure 6.2.1.2: IMS-ALG and IMS-AGW interaction at session establishment\nUpon receipt of a session initiation request, the IMS-ALG shall extract the offerer's destination network address(es) and port number(s) from the signalling message body received from the calling party endpoint. It shall then request the IMS-AGW to allocate transport resources (T2) via the Reserve AGW Connection Point procedure. Upon receipt of the response from the IMS-AGW, the IMS-ALG shall modify the offerer's destination address(es) and/or port(s) contained in the application signalling message body and propagate the session establishment toward the terminating party.\nOn receipt of the terminating end SDP in the session establishment response, the IMS-ALG shall pass the information to the IMS-AGW in the Configure AGW Connection Point procedure and shall request the IMS-AGW to allocate transport resources (T1) via the Reserve and Configure AGW Connection Point. Upon receiving the response from the IMS-AGW, the IMS-ALG shall modify the answerer's destination address(es) and/or port(s) contained in the application signalling message body and pass the information to the originating party.\nOn session termination, the IMS-ALG shall request the IMS-AGW to release its transport resources via the Release AGW Termination procedure.",
      "chunk_type": "procedure",
      "cross_references": [
        "figure_6.2.1.2",
        "figure_6.2.1.1",
        "ts_23.228"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.2",
      "section_id": "6.2.2",
      "section_title": "IP realm indication procedure",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally specifying the required IP Realm to the IMS-AGW when requesting the allocation of transport resources on the IMS-AGW.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.3",
      "section_id": "6.2.3",
      "section_title": "Remote NA(P)T traversal support procedure",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally indicating to the IMS-AGW that the remote media address/port information (supplied by the IMS-ALG) shall not be used as the destination address for outgoing media. Instead, the IMS-AGW shall \"latch\" or \"relatch\" onto the required destination address via the source address/port of the incoming media.  The IMS-ALG may command the IMS-AGW to latch once (on the first received packet) or to re-latch (i.e. to check for a change of source address on the incoming media stream and latch once on this new address).",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.4",
      "section_id": "6.2.4",
      "section_title": "Remote Source Address/Port Filtering",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally specifying the required IP address and/or port to be used to screen received media packets on a termination.\nThis clause considers when the IMS-ALG is acting as an Entry point and remote source transport address filtering is required towards the external network.\nAs a security related option, on request from the IMS-ALG, filtering may be enabled to check/validate the source address or source address and port number of incoming packets from the external network. If the IMS-ALG requests address filtering, it may additionally provide an address specification, which may identify either a single address or a range of addresses, against which filtering is to be performed. The absence of such an address specification in the request shall implicitly request filtering against the IP address of the remote connection address. In addition to address filtering, the IMS-ALG may also request port filtering. If the IMS-ALG requests port filtering, it may additionally include either a port or a range of ports, against which filtering is to be performed. The absence of a port specification in the request shall implicitly request filtering against the port of the remote connection address.\nIf the IMS-AGW is requested to apply source IP address and possibly source port filtering, it shall only pass incoming IP packets from the identified source, and discard IP packets from other sources.\nIf remote source address filtering is required for the created termination, then the IMS-ALG shall include the information element \"Remote source address filtering\" in the request sent to the IMS-AGW. In addition, it may also include the information element \"Remote source address mask\" in order to request filtering of a range of addresses.\nIf remote source port filtering is required for the created termination (in addition to remote source address filtering), then the IMS-ALG shall include the information element \"Remote source port filtering\" in the request sent to the IMS-AGW. It may also include one of the information elements \"Remote source port\" or \"Remote source port range\".\nSubsequently, the IMS-AGW shall apply filtering as requested to the packets arriving from the external network. Any packet arriving, which does not meet the filtering requirement, shall be discarded.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.5",
      "section_id": "6.2.5",
      "section_title": "Traffic Policing",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally requesting the IMS-AGW to police the media stream flow according to one or more of the following media policing(s) through the IMS-AGW, in accordance with IETF RFC 2216 [10].\nNOTE 1:\tIn order to support services that generate media with variable bitrate (e.g. video), the policing function needs to provide sufficient buffer space. The derivation of the correspondent token bucket size can be based on the estimated traffic volume over the expected maximum burst length (supposed time interval of the burst). For example, for MTSI media, 3GPP TS 26.114 [21] clause 7.5.5 recommends a default period of 2 seconds for the derivation of average bitrates and provides further considerations regarding suitable time periods for speech and video.\nNOTE 2:\tThe decision to apply or not traffic policing is general for all sessions with the same media characteristics (i.e. not user specific). The conditions which media policing to apply are beyond the scope of this specification. This can be based on the media characteristics of the session (e.g. media type).\nThe following media policing shall be supported at the IMS-AGW:\n-\tSustainable Data Rate (SDR) Policing: To request policing of the sustainable data rate of a media stream, the IMS-ALG shall request media policing for that media stream and shall provide the sustainable data rate, and shall provide a maximum burst size (MBS) indicating the expected maximum size of packet bursts for that media stream. The IMS-AGW shall then measure the data rate for the received packets within that media stream as per IETF RFC 2216 [10]  for \"Token Bucket\", where r = SDR and b = MBS. If the permissible sustainable data rate is exceeded, the IMS-AGW shall discard packets to reduce the data rate to the permissible sustainable data rate.\nNOTE 3:\tThe IMS-ALG can derive the sustainable data rate from bandwidth parameters if it receives them within an SDP media description. The IMS-ALG can:-\tuse the \"b=AS\" bandwidth modifier if received within an SDP body; or-\tif the IMS-ALG supports the enhanced bandwidth negotiation mechanism, use the \"maximum supported bandwidth for the receiving direction\" property value from the \"a=bw-info\" SDP attribute received within an SDP answer.If the value of the \"maximum supported bandwidth for the receiving direction\" for the selected RTP payload type differs from the value of the \"b=AS\" bandwidth modifier then the IMS-ALG can use \"maximum supported bandwidth for the receiving direction\" property value from the \"a=bw-info\" SDP attribute to determine the sustainable data rate for the selected RTP payload.\nThe following media policing may be supported in addition at the IMS-AGW ; if supported then the following applies:\n-\tPeak Data Rate Policing: To request policing of the peak data rate of a media stream, the  IMS-ALG shall request media policing for that media stream and shall provide the peak data rate, and may provide a Delay Variation Tolerance indicating the expected maximum delay variation due to jitter for that media stream. The IMS-AGW shall then measure the data rate for the received packets within that media stream. If the permissible peak data rate is exceeded, the IMS-AGW shall discard packets to reduce the data rate to the permissible peak data rate. If both peak data rate and sustainable data rate have been provided for the same media stream, the IMS-AGW shall discard packets to reduce the data rate to the permissible peak data rate and should discard packets to reduce the data rate to the permissible sustainable data rate.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "ts_26.114_clause_7.5.5",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.6",
      "section_id": "6.2.6",
      "section_title": "Hanging Termination Detection",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG  requesting the IMS-AGW to periodically report termination heartbeat indications to detect hanging context and termination in the IMS-AGW that may result e.g. from a loss of communication between the IMS-ALG and the IMS-AGW.\nWhen the IMS-ALG receives a termination heartbeat notification from the IMS-AGW via the Termination heartbeat - Indication procedure, the IMS-ALG shall return a Termination heartbeat –Indication Ack (without an error) if the context id / termination identity combination exists in the IMS-ALG. If it does not exist, the IMS-ALG shall return an error and shall correct the mismatch, e.g. by requesting the IMS-AGW to subtract the indicated termination and to clear any associated context.\nFigure 6.2.6.1: Termination heartbeat – Indication",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.6.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.7",
      "section_id": "6.2.7",
      "section_title": "QoS Packet Marking",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally specifying the setting of the DSCP for outgoing packets on a termination. The DSCP value may be explicitly set by the IMS-AGW or else copied from that received in the corresponding received packet.\nIf differentiated services are required for the created termination, then the IMS-ALG shall include the information elements \"DiffServ Code Point\" and/or \"DiffServ Tagging Behaviour\" in the request sent to the IMS-AGW.\nSubsequently, for all egress packets, the IMS-AGW shall set the DiffServ Code Point in the IP header as specified by the IMS-ALG:\n-\tIf the DiffServ Tagging Behaviour information element was received with a value to indicate that the DiffServ Code Point should be copied, then the DiffServ Code Point in the IP header of the egress packet is copied from the ingress packet.\n-\tIf the Diffserv Tagging Behaviour information element was not received, or was received with a value to indicate that the DiffServ Code Point should be set to a specific value, then:\n-\tIf the DiffServ Code Point information element was received, then the DiffServ Code Point in the IP header of the egress packet shall be set to the value received in the DiffServ Code Point information element.\n-\tIf the DiffServ Code Point information element was not received, then the DiffServ Code Point in the IP header of the egress packet shall be  set to a configured default value.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.8",
      "section_id": "6.2.8",
      "section_title": "Media Inactivity Detection",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally requesting the IMS-AGW to detect inactive media.\nIf media inactivity detection is required for the created termination, the IMS-ALG may include the information elements \"Inactivity detection time\" and \"Inactivity detection direction\" in the request sent to the IMS-AGW. The IMS-ALG may request the detection of media inactivity on a termination or a stream basis.\nWhen the IMS-ALG receives a notification of inactive media from the IMS-AGW via the Media Inactivity Notification procedure, the IMS-ALG shall return a Media Inactivity Notification Ack and shall take appropriate action (e.g. release the termination).\nFigure 6.2.8.1: Media Inactivity Notification",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.8.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.9",
      "section_id": "6.2.9",
      "section_title": "Handling of RTCP streams",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally requesting the IMS-AGW to allocate or not allocate RTCP resources. Additionally if RTCP handling is requested, the IMS ALG may include:\n-\tthe explicit RTCP transport address information element;\n-\tthe RTP/RTCP transport multiplexing information element; and\n-\tthe bandwidth allocation for RTCP,\nas described in clause 5.9.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "clause_5.9"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.10.1",
      "section_id": "6.2.10.1",
      "section_title": "General",
      "content": "All message sequence charts in this clause are examples.\nThe H.248 context model is defined in Figure 6.2.1.1.",
      "chunk_type": "definition",
      "cross_references": [
        "figure_6.2.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.10.2",
      "section_id": "6.2.10.2",
      "section_title": "End-to-access-edge security for RTP based media using SDES",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally requesting the IMS-AGW to provide IMS media plane security in accordance with 3GPP TS 33.328 [12].\nThe IMS-ALG shall provide the following media plane security related parameters to the IMS-AGW:\n-\tthe SDES crypto attributes",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "ts_33.328"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.10.3.1",
      "section_id": "6.2.10.3.1",
      "section_title": "End-to-access-edge security for session based messaging (MSRP)",
      "content": "6.2.10.3.1.1\tIMS UE originating procedures for e2ae\n6.2.10.3.1.1.1\tIncoming TCP bearer establishment triggers an outgoing TCP bearer establishment\nFigure 6.2.10.3.1.1.1.1 shows an example call flow for the originating session set-up procedures for one MSRP media stream using e2ae security, where an incoming TCP bearer establishment triggers an outgoing TCP bearer establishment.\nFigure 6.2.10.3.1.1.1.1: Originating example call flow for e2ae security for MSRP where an incoming TCP bearer establishment triggers an outgoing TCP bearer establishment\nThe IMS UE A performs an IMS originating session set-up according to 3GPP TS 23.228 [2], with modifications as described in 3GPP TS 33.328 [12].\nThe procedure in the above figure for requesting e2ae security for a media stream is described step-by-step with an emphasis on the additional aspects for IMS-ALG and IMS-AGW of media protection using TLS.\n1.\tIMS UE A sends an SDP offer for a media stream containing cryptographic information, together with an \"a=3ge2ae:requested\" SDP attribute for the MSRP-related SDP m-line, to the P‑CSCF (IMS‑ALG). For e2ae protection of MSRP the cryptographic information contained in the SDP offer consists of the fingerprint of the certificate of IMS UE A in accordance to IETF RFC 4975 [25]. For each media stream that uses transport \"TCP/TLS/MSRP\", the P‑CSCF (IMS‑ALG) checks for the presence of the \"a=3ge2ae:requested\" SDP attribute. If that indication is present and the P‑CSCF (IMS‑ALG) indicated support of e2ae-security for MSRP during registration, the P‑CSCF (IMS‑ALG) allocates the required resources, includes the IMS‑AGW in the media path and proceeds as specified in this clause.\nNOTE 1:\tAn operator can choose to terminate TLS in the IMS‑AGW according to the following steps for all media streams that are signalled in SIP INVITE messages with transport TCP/TLS/MSRP and a certificate fingerprint attribute, even if the UE did not indicate support for e2ae security during registration and did not indicate usage of e2ae security for the respective media streams in the INVITE. This can lead to session failures for pre-Rel-12 IMS UEs or non-IMS UEs due to a mismatch of security parameters sent by the network and expected by the UE, but on the other hand, it will ensure compatibility with GSMA RCS 5.1 [35, 36], which specifies that TLS for MSRP is always terminated in the network.\n2.-4.\tThe IMS-ALG uses the \"Reserve AGW Connection Point\" procedure to request a termination for \"TCP\" media (for application-agnostic interworking) or \"TCP/MSRP\" media (for application-aware interworking) towards the core network. To indicate that the IMS-AGW shall operate in TCP Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute. The IMS-ALG sets the interlinkage topology on the termination T2 to configure the IMS-AGW to use the TCP connection establishment request (TCP SYN) received at the termination T2 as a trigger to send a TCP connection establishment on the termination T1.\nNOTE 2:\tIf \"a=setup:passive\" is received in the SDP answer in step 12, the IMS-ALG then needs to set the interlinkage topology on the termination T1 (not depicted).\n5.-7.\tThe IMS-ALG uses the \"Reserve And Configure AGW Connection Point\" procedure to request a termination for \"TCP/TLS\" media (for application-agnostic interworking) or \"TCP/TLS/MSRP\" media (for application-aware interworking) towards the access network. In the remote descriptor, it provides the IP address, port and fingerprint attribute received from the UE containing the fingerprint of the UE´s certificate in accordance to IETF RFC 4975 [25]. This instructs the IMS‑AGW to verify during the subsequent TLS handshake with the IMS UE that the fingerprint of the certificate passed by the IMS UE during this TLS handshake matches the fingerprint passed by the P‑CSCF (IMS‑ALG) to the IMS‑AGW. In turn, the IMS‑AGW communicates the fingerprint of the certificate it is going to use for setting up protection for this media stream to the P‑CSCF (IMS‑ALG). To indicate that the IMS-AGW shall operate in TCP Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute.\nNOTE 3:\tThese steps could be combined with steps 16.-18. This saves H.248 signalling interactions but can delay the TCP connection setup.\n8.\tThe P‑CSCF (IMS‑ALG) changes the transport from \"TCP/TLS/MSRP\" to \"TCP/MSRP\" in the SDP offer, removes the \"a=3ge2ae:requested\" SDP attribute and the fingerprint SDP attribute,  and inserts the address information received from the IMS-AGW.\n9.\tThe P‑CSCF (IMS‑ALG) forwards the SDP offer.\n10.\tThe remote peer chooses to become the active party in the TCP connection establishment and sends a TCP SYN to establish the TCP connection. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any incoming TCP connection establishment requests (TCP SYN), e.g. to enable a remote source transport address filtering, or if the P-CSCF (IMS-ALG) did not indicate to the IMS-AGW at step 2 that it shall latch onto the required destination address via the source address/port of the incoming media, the IMS-AGW shall drop the TCP SYN received from the remote peer.If the TCP SYN is not answered before a timer expiry, the remote peer will send the TCP SYN a second time (step 10'). The IMS‑AGW will answer a repeated TCP SYN if it is received after step 13 (step 10').The IMS-AGW answers the TCP SYN and the remote peer completes the TCP connection establishment.\n11.\tThe IMS-AGW uses the TCP SYN received at the termination T2 (at step 10 or step 10' if the TCP SYN is dropped at step 10) as a trigger to send a TCP SYN towards the UE to establish a TCP connection (effectively making the IMS-AGW acting as the TCP client towards the UE).. The UE answers the TCP SYN and the IMS-AGW completes the TCP connection establishment.\n12.\tThe P‑CSCF (IMS‑ALG) receives the SDP answer.\n13.-15.\tThe IMS-ALG uses the \"Configure AGW Connection Point\" procedure to configure the termination towards the core network with remote address information. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any incoming TCP connection establishment requests (TCP SYN), the IMS-ALG indicates to the IMS-AGW to accept incoming TCP connection establishment (TCP SYN) only from the indicated remote transport address.\nNOTE 4:\tFor \"a=setup:active\" in the SDP answer, these steps could possibly be skipped if the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall latch onto the required destination address via the source address/port of the incoming media, as the IMS-AGW will then use the address information in the TCP SYN when replying.\n16.-18.\tThe IMS-ALG uses the \"Configure AGW Connection Point\" procedure to configure the termination towards the access network with the request to establish the TLS session once the TCP connection is established (effectively making the IMS-AGW acting as the TLS client), in accordance with the information in the \"a=setup\" attribute in the SDP answer.\n19.\tThe P‑CSCF (IMS‑ALG) modifies the SDP answer before sending it to the UE A. The P‑CSCF (IMS‑ALG) sets the transport to \"TCP/TLS/MSRP\" and includes the fingerprint of the IMS‑AGW´s certificate in accordance to IETF RFC 4975 [25].\n20.\tThe P-CSCF (IMA-ALG) then sends the updated SDP answer to IMS UE A. After receiving this message IMS UE A completes the media security setup.\n21.\tUpon completion of the TCP connection establishment, the IMS-AGW starts the establishment of the TLS session.\n6.2.10.3.1.1.2\tIMS-ALG requests sending an outgoing TCP bearer establishment\nFigure 6.2.10.3.1.1.2.1 shows an example call flow for the originating session set-up procedures for one MSRP media stream using e2ae security, where the IMS-ALG requests sending an outgoing TCP bearer establishment.\nFigure 6.2.10.3.1.1.2.1: Originating example call flow for e2ae security for MSRP where the IMS-ALG requests sending an outgoing TCP bearer establishment\nThe IMS UE A performs an IMS originating session set-up according to 3GPP TS 23.228 [2], with modifications as described in 3GPP TS 33.328 [12].\nThe procedure in the above figure for requesting e2ae security for a media stream is described step-by-step with an emphasis on the additional aspects for IMS-ALG and IMS-AGW of media protection using TLS.\n1.\tAs step 1 in figure 6.2.10.3.1.1.1.1.\n2.-4.\tAs steps 2-4 in figure 6.2.10.3.1.1.1.1 with the exception that the IMS-ALG does not set the interlinkage topology on the termination T2.\n5.-7.\tAs steps 5-7 in figure 6.2.10.3.1.1.1.1.\n8.\tAs step 8 in figure 6.2.10.3.1.1.1.1.\n9.\tAs step 9 in figure 6.2.10.3.1.1.1.1.\n10.\tAs step 10 in figure 6.2.10.3.1.1.1.1.\nNOTE:\tThe incoming TCP SYN does not trigger the sending of an outgoing TCP SYN, and step 11 in figure 6.2.10.3.1.1.1.1thus does not apply.\n11.\tAs step 12 in figure 6.2.10.3.1.1.1.1.\n12.-14.\tAs steps 13-15 in figure 6.2.10.3.1.1.1.1.\n15.-17.\tAs steps 16-18 in figure 6.2.10.3.1.1.1.1with the exception that the IMS-ALG uses the \"Configure AGW Connection Point\" procedure also to configure the termination towards the access network with the request to establish the TCP connection (effectively making the IMS-AGW acting as the TCP client), in accordance with the information in the \"a=setup\" attribute in the SDP answer.\n18.\tThe IMS-AGW sends a TCP SYN towards the UE to establish a TCP connection. The UE answers with a TCP SYN ACK and the IMS‑AGW replies with a TCP ACK, completing the TCP connection establishment.\n19.\tAs step 21 in figure 6.2.10.3.1.1.1.1.\n20.\tAs step 19 in figure 6.2.10.3.1.1.1.1.\n21.\tAs step 20 in figure 6.2.10.3.1.1.1.1.\n6.2.10.3.1.2\tIMS UE terminating procedures for e2ae\n6.2.10.3.1.2.1\tIncoming TCP bearer establishment triggers an outgoing TCP bearer establishment\nFigure 6.2.10.3.1.2.1.1 shows an example call flow for the terminating session set-up procedures for one MSRP media stream using e2ae security, where an incoming TCP bearer establishment triggers an outgoing TCP bearer establishment.\nFigure 6.2.10.3.1.2.1.1: Terminating example call flow for e2ae security for MSRP where an incoming TCP bearer establishment triggers an outgoing TCP bearer establishment\nThe IMS UE B performs an IMS terminating session set-up according to 3GPP TS 23.228 [2], with modifications as described in 3GPP TS 33.328 [12].\nThe procedure in the above figure for requesting e2ae security for a media stream is described step-by-step with an emphasis on the additional aspects for IMS-ALG and IMS-AGW of media protection using TLS.\n1.\tThe P‑CSCF (IMS‑ALG) receives an SDP offer for an MSRP media stream. For each MSRP media stream offered with transport \"TCP/MSRP\", if both the IMS UE and P‑CSCF (IMS‑ALG) indicated support for e2ae-security for MSRP during registration, the P‑CSCF (IMS‑ALG) allocates the required resources, includes the IMS‑AGW in the media path and proceeds as specified in this clause.\nNOTE 1:\tAn operator can choose to terminate TLS in the IMS‑AGW according to the following steps for all media streams that are signalled in SIP INVITE messages with transport TCP/MSRP, even if the UE did not indicate support for e2ae security during registration. This can lead to session failures for pre-Rel-12 IMS UEs or non-IMS UEs due to a mismatch of security parameters sent by the network and expected by the UE, but on the other hand, it will ensure compatibility with GSMA RCS 5.1 [35, 36], which recommends to always use e2ae security for MSRP on the terminating leg.\n2.-4.\tThe IMS-ALG uses the \"Reserve AGW Connection Point\" procedure to request a termination for \"TCP/TLS\" media (for application-agnostic interworking) or \"TCP/TLS/MSRP\" media (for application-aware interworking) towards the access network. In turn, the IMS‑AGW communicates the fingerprint of the certificate it is going to use for setting up protection for this media stream to the P‑CSCF (IMS‑ALG). To indicate that the IMS-AGW shall operate in TCP Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute. The IMS-ALG sets the interlinkage topology on the termination T1 to configure the IMS-AGW to use the TCP connection establishment request (TCP SYN) received at the termination T1 as a trigger to send a TCP connection establishment on the termination T2.\nNOTE 2:\tIf \"a=setup:passive\" is received in the SDP answer in step 13, the IMS-ALG then needs to sets the interlinkage topology on the termination T2 (not depicted)\n5.-7.\tThe IMS-ALG uses the \"Reserve And Configure AGW Connection Point\" procedure to request a termination for \"TCP\" media (for application-agnostic interworking) or \"TCP/ MSRP\" media (for application-aware interworking) towards the core network. To indicate that the IMS-AGW shall operate in TCP Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute.\n8.\tThe P‑CSCF (IMS‑ALG) changes the transport from \"TCP/ MSRP\" to \"TCP/TLS/MSRP\" in the SDP offer, adds the \"a=3ge2ae:applied\" SDP attribute and the fingerprint SDP attribute received from the IMS-AGW, and inserts the address information received from the IMS-AGW.\n9.\tThe P‑CSCF (IMS‑ALG) forwards the SDP offer.\n10.\tThe UE B chooses to become the active party in the TCP connection establishment and sends a TCP SYN to establish the TCP connection. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any incoming TCP connection establishment requests (TCP SYN), e.g. to enable a remote source transport address filtering, or if the P-CSCF (IMS-ALG) did not indicate to the IMS-AGW at step 2 that it shall latch onto the required destination address via the source address/port of the incoming media, the IMS-AGW shall drop the TCP SYN received from the UE. If the TCP SYN is not answered before a timer expiry, the UE will send the TCP SYN a second time (step 10'). The IMS‑AGW will answer a repeated TCP SYN if it is received after step 14 (step 10').The IMS-AGW answers the TCP SYN and the remote peer completes the TCP connection establishment.\n11.\tThe IMS-AGW uses the TCP SYN received at the termination T1 (at step 10 or step 10' if the TCP SYN is dropped at step 10) as a trigger to send a TCP SYN towards the core network to establish a TCP connection (effectively making the IMS-AGW acting as the TCP client towards the core network). The remote peer answers the TCP SYN and the IMS-AGW completes the TCP connection establishment.\n12.\tUpon completion of the TCP connection establishment, the UE B starts the establishment of the TLS session. The IMS-AGW needs to wait until step 14 to verify the received fingerprint.\n13.\tThe P‑CSCF (IMS‑ALG) receives the SDP answer. It contains the fingerprint attribute with the UE´s certificate in accordance to IETF RFC 4975 [25].\n14.-16.\tThe IMS-ALG uses the \"Configure AGW Connection Point\" procedure to configure the termination towards the UE B with remote address information. In the remote descriptor, it also provides fingerprint attribute received from the UE. This instructs the IMS‑AGW to verify during the subsequent TLS handshake with the IMS UE that the fingerprint of the certificate passed by the IMS UE during this TLS handshake matches the fingerprint passed by the P‑CSCF (IMS‑ALG) to the IMS‑AGW. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any incoming TCP connection establishment requests (TCP SYN), the IMS-ALG indicates to the IMS-AGW to accept incoming TCP connection establishment (TCP SYN) only from the indicated remote transport address.\n17.\tThe P‑CSCF (IMS‑ALG) modifies the SDP answer before sending it to the core network. The P‑CSCF (IMS‑ALG) sets the transport to \"TCP/ MSRP\" and removes the SDP fingerprint attribute.\n18.\tThe P-CSCF (IMA-ALG) then sends the updated SDP answer to core network.\n6.2.10.3.1.2.2\tIMS-ALG requests sending an outgoing TCP bearer establishment\nFigure 6.2.10.3.1.2.2.1 shows an example call flow for the terminating session set-up procedures for one MSRP media stream using e2ae security, where the IMS-ALG requests sending an outgoing TCP bearer establishment.\nFigure 6.2.10.3.1.2.2.1: Terminating example call flow for e2ae security for MSRP where the IMS-ALG requests sending an outgoing TCP bearer establishment\nThe IMS UE B performs an IMS terminating session set-up according to 3GPP TS 23.228 [2], with modifications as described in 3GPP TS 33.328 [12].\nThe procedure in the above figure for requesting e2ae security for a media stream is described step-by-step with an emphasis on the additional aspects for IMS-ALG and IMS-AGW of media protection using TLS.\n1.\tAs step 1 in figure 6.2.10.3.1.2.1.1.\n2.-4.\tAs steps 2-4 in figure 6.2.10.3.1.2.1.1 with the exception that the IMS-ALG does not set the interlinkage topology on the termination T1.\n5.-7.\tAs steps 7-7 in figure 6.2.10.3.1.2.1.1.\n8.\tAs step 8 in figure 6.2.10.3.1.2.1.1.\n9.\tAs step 9 in figure 6.2.10.3.1.2.1.1.\n10.\tAs step 10 in figure 6.2.10.3.1.2.1.1.\nNOTE:\tThe incoming TCP SYN does not trigger the sending of an outgoing TCP SYN, and step 11 in figure 6.2.10.3.1.2.1.1 thus does not apply.\n11.\tAs step 12 in figure 6.2.10.3.1.2.1.1.\n12.\tAs step 13 in figure 6.2.10.3.1.2.1.1.\n13.-15.\tAs steps 14-16 in figure 6.2.10.3.1.2.1.1.\n16.-18.\tThe IMS-ALG uses the \"Configure AGW Connection Point\" procedure to configure the termination towards the core network with the request to establish the TCP connection, in accordance with the information in the \"a=setup\" attribute in the SDP answer.\n19.\tThe IMS-AGW sends a TCP SYN towards the core network to establish a TCP connection. The remote peer answers with a TCP SYN ACK and the IMS‑AGW replies with a TCP ACK, completing the TCP connection establishment.\n20.\tAs step 17 in figure 6.2.10.3.1.2.1.1.\n21.\tAs step 18 in figure 6.2.10.3.1.2.1.1.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.10.3.1.1.1.1",
        "figure_6.2.10.3.1.1.2.1",
        "figure_6.2.10.3.1.2.1.1",
        "figure_6.2.10.3.1.2.2.1",
        "ts_23.228",
        "ts_33.328"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.10.3.2",
      "section_id": "6.2.10.3.2",
      "section_title": "End-to-access-edge security for conferencing (BFCP)",
      "content": "6.2.10.3.2.1\tIMS UE originating procedures for e2ae\n6.2.10.3.2.1.1\tIncoming TCP bearer establishment triggers an outgoing TCP bearer establishment\nFigure 6.2.10.3.2.1.1.1 shows the originating session set-up procedures for one or more BFCP media stream(s) using e2ae security.\nFigure 6.2.10.3.2.1.1.1: Originating example call flow for e2ae security for BFCP where an incoming TCP bearer establishment triggers an outgoing TCP bearer establishment\nThe IMS UE A performs an IMS originating session set-up according to 3GPP TS 23.228 [2], with modifications as described in 3GPP TS 33.328 [12].\nThe procedure in the above figure for requesting e2ae security for a media stream is described step-by-step with an emphasis on the additional aspects for IMS-ALG and IMS-AGW of media protection using TLS.\n1.\tIMS UE A sends an SDP offer for a media stream containing cryptographic information, together with an \"a=3ge2ae:requested\" SDP attribute for the BFCP-related SDP m-line, to the P‑CSCF (IMS‑ALG). For e2ae protection of BFCP the cryptographic information contained in the SDP offer consists of the fingerprint of the certificate of IMS UE A in accordance to IETF RFC 4975 [25]. For each media stream that uses transport \"TCP/TLS/BFCP\", the P‑CSCF (IMS‑ALG) checks for the presence of the \"a=3ge2ae:requested\" SDP attribute. If that indication is present and the P‑CSCF (IMS‑ALG) indicated support of e2ae-security for BFCP during registration, the P‑CSCF (IMS‑ALG) allocates the required resources, includes the IMS‑AGW in the media path and proceeds as specified in this clause.\n2.-4.\tThe IMS-ALG uses the \"Reserve AGW Connection Point\" procedure to request a termination for \"TCP\" media towards the core network. To indicate that the IMS-AGW shall operate in TCP Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute. The IMS-ALG sets the interlinkage topology on the termination T2 to configure the IMS-AGW to use the TCP connection establishment request (TCP SYN) received at the termination T2 as a trigger to send a TCP connection establishment on the termination T1.\nNOTE 1:\tIf \"a=setup:passive\" is received in the SDP answer in step 13, the IMS-ALG then needs to set the interlinkage topology on the termination T1 (not depicted).\n5.-7.\tThe IMS-ALG uses the \"Reserve And Configure AGW Connection Point\" procedure to request a termination for \"TCP/TLS\" media towards the access network. In the remote descriptor, it provides the IP address, port and fingerprint attribute received from the UE containing the fingerprint of the UE´s certificate in accordance to IETF RFC 4975 [25]. This instructs the IMS‑AGW to verify during the subsequent TLS handshake with the IMS UE that the fingerprint of the certificate passed by the IMS UE during this TLS handshake matches the fingerprint passed by the P‑CSCF (IMS‑ALG) to the IMS‑AGW. In turn, the IMS‑AGW communicates the fingerprint of the certificate it is going to use for setting up protection for this media stream to the P‑CSCF (IMS‑ALG). To indicate that the IMS-AGW shall operate in TCP Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute.\n8.\tThe P‑CSCF (IMS‑ALG) changes the transport from \"TCP/TLS/BFCP\" to \"TCP/BFCP\" in the SDP offer, removes the \"a=3ge2ae:requested\" SDP attribute and the fingerprint SDP attribute,  and inserts the address information received from the IMS-AGW.\n9.\tThe P‑CSCF (IMS‑ALG) forwards the SDP offer.\n10.\tThe remote peer chooses to become the active party in the TCP connection establishment and sends a TCP SYN to establish the TCP connection. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any incoming TCP connection establishment requests (TCP SYN), e.g. to enable a remote source transport address filtering, or if the P-CSCF (IMS-ALG) did not indicate to the IMS-AGW at step 2 that it shall latch onto the required destination address via the source address/port of the incoming media, the IMS-AGW shall drop the TCP SYN received from the remote peer.If the TCP SYN is not answered before a timer expiry, the remote peer will send the TCP SYN a second time (step 10'). The IMS‑AGW will answer a repeated TCP SYN if it is received after step 14 (step 10').The IMS-AGW answers the TCP SYN and the remote peer completes the TCP connection establishment.\n11.\tThe IMS-AGW uses the TCP SYN received at the termination T2 (at step 10 or step 10' if the TCP SYN is dropped at step 10) as a trigger to send a TCP SYN towards the UE to establish a TCP connection (effectively making the IMS-AGW acting as the TCP client towards the UE). The UE answers the TCP SYN and the IMS-AGW completes the TCP connection establishment.\n12.\tUpon completion of the TCP connection establishment, the UE B starts the establishment of the TLS session. The IMS-AGW needs to wait until step 14 to verify the received fingerprint.\n13.\tThe P‑CSCF (IMS‑ALG) receives the SDP answer.\n14.-16.\tThe IMS-ALG uses the \"Configure AGW Connection Point\" procedure to configure the termination towards the core network with remote address information. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any incoming TCP connection establishment requests (TCP SYN), the IMS-ALG indicates to the IMS-AGW to accept incoming TCP connection establishment (TCP SYN) only from the indicated remote transport address.\nNOTE 2:\tFor \"a=setup:active\" in the SDP answer, these steps could possibly be skipped if the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall latch onto the required destination address via the source address/port of the incoming media, as the IMS-AGW will then use the address information in the TCP SYN when replying.\n17.\tThe P‑CSCF (IMS‑ALG) modifies the SDP answer before sending it to the UE A. The P‑CSCF (IMS‑ALG) sets the transport to \"TCP/TLS/BFCP\" and includes the fingerprint of the IMS‑AGW´s certificate in accordance to IETF RFC 4975 [25].\n18.\tThe P-CSCF (IMA-ALG) then sends the updated SDP answer to IMS UE A. After receiving this message IMS UE A completes the media security setup.\n6.2.10.3.2.2\tIMS UE terminating procedures for e2ae\n6.2.10.3.2.2.1\tIncoming TCP bearer establishment triggers an outgoing TCP bearer establishment\nFigure 6.2.10.3.2.2.1.1 shows the terminating session set-up procedures for one or more BFCP media stream(s) using e2ae security.\nFigure 6.2.10.3.2.2.1.1: Terminating example call flow for e2ae security for MSRP where an incoming TCP bearer establishment triggers an outgoing TCP bearer establishment\nThe IMS UE B performs an IMS terminating session set-up according to 3GPP TS 23.228 [2], with modifications as described in 3GPP TS 33.328 [12].\nThe procedure in the above figure for requesting e2ae security for a media stream is described step-by-step with an emphasis on the additional aspects for IMS-ALG and IMS-AGW of media protection using TLS.\n1.\tThe P‑CSCF (IMS‑ALG) receives an SDP offer for an MSRP media stream. For each BFCP media stream offered with transport \"TCP/BFCP\", if both the IMS UE and P‑CSCF (IMS‑ALG) indicated support for e2ae-security for BFCP during registration, the P‑CSCF (IMS‑ALG) allocates the required resources, includes the IMS‑AGW in the media path and proceeds as specified in this clause.\n2.-4.\tThe IMS-ALG uses the \"Reserve AGW Connection Point\" procedure to request a termination for \"TCP/TLS\" media towards the access network. The IMS-ALG configures the IMS-AGW with the request to start the establishment of the TLS session once the TCP connection is established (effectively making the IMS-AGW acting as the TLS client). . To indicate that the IMS-AGW shall operate in TCP Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute. The IMS-ALG sets the interlinkage topology on the termination T1 to configure the IMS-AGW to use the TCP connection establishment request (TCP SYN) received at the termination T1 as a trigger to send a TCP connection establishment on the termination T2.The IMS‑AGW communicates the fingerprint of the certificate it is going to use for setting up protection for this media stream to the P‑CSCF (IMS‑ALG).\nNOTE:\tIf \"a=setup:passive\" is received in the SDP answer in step 13, the IMS-ALG then needs to sets the interlinkage topology on the termination T2 (not depicted)\n5.-7.\tThe IMS-ALG uses the \"Reserve And Configure AGW Connection Point\" procedure to request a termination for \"TCP\" media towards the core network. To indicate that the IMS-AGW shall operate in TCP Proxy mode, the IMS-ALG provides \"a=setup:actpass\" attribute.\n8.\tThe P‑CSCF (IMS‑ALG) changes the transport from \"TCP/ BFCP\" to \"TCP/TLS/BFCP\" in the SDP offer, adds the \"a=3ge2ae:applied\" SDP attribute and the fingerprint SDP attribute received from the IMS-AGW, and inserts the address information received from the IMS-AGW.\n9.\tThe P‑CSCF (IMS‑ALG) forwards the SDP offer.\n10.\tThe UE B chooses to become the active party in the TCP connection establishment and sends a TCP SYN to establish the TCP connection. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any incoming TCP connection establishment requests (TCP SYN), e.g. to enable a remote source transport address filtering, or if the P-CSCF (IMS-ALG) did not indicate to the IMS-AGW at step 2 that it shall latch onto the required destination address via the source address/port of the incoming media, the IMS-AGW shall drop the TCP SYN received from the UE. If the TCP SYN is not answered before a timer expiry, the UE will send the TCP SYN a second time (step 10'). The IMS‑AGW will answer a repeated TCP SYN if it is received after step 14 (step 10').The IMS-AGW answers the TCP SYN and the remote peer completes the TCP connection establishment.\n11.\tThe IMS-AGW sends a TCP SYN towards the core network to establish a TCP connection.  The remote peer answers the TCP SYN and the IMS-AGW completes the TCP connection establishment.\n12.\tUpon completion of the TCP connection establishment, the IMS-AGW starts the establishment of the TLS session. The IMS-AGW needs to wait until step 14 to verify the received fingerprint.\n13.\tThe P‑CSCF (IMS‑ALG) receives the SDP answer. It contains the fingerprint attribute with the UE´s certificate in accordance to IETF RFC 4975 [25].\n14.-16.\tThe IMS-ALG uses the \"Configure AGW Connection Point\" procedure to configure the termination towards the UE B with remote address information. In the remote descriptor, it also provides fingerprint attribute received from the UE. This instructs the IMS‑AGW to verify during the TLS handshake with the IMS UE (see step 12) that the fingerprint of the certificate passed by the IMS UE during this TLS handshake matches the fingerprint passed by the P‑CSCF (IMS‑ALG) to the IMS‑AGW. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any incoming TCP connection establishment requests (TCP SYN), the IMS-ALG indicates to the IMS-AGW to accept incoming TCP connection establishment (TCP SYN) only from the indicated remote transport address.\n17.\tThe P‑CSCF (IMS‑ALG) modifies the SDP answer before sending it to the core network. The P‑CSCF (IMS‑ALG) sets the transport to \"TCP/ BFCP\" and removes the SDP fingerprint attribute.\n18.\tThe P‑CSCF (IMS‑ALG) then sends the updated SDP answer to core network.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.10.3.2.1.1.1",
        "figure_6.2.10.3.2.2.1.1",
        "ts_23.228",
        "ts_33.328"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.10.4.1",
      "section_id": "6.2.10.4.1",
      "section_title": "General",
      "content": "The IMS-ALG and the IMS-AGW may support e2ae security for the UDP based media using DTLS and certificate fingerprints.\nThe following clauses describe extensions to the Iq signalling procedures and their interactions with SIP signalling in the control plane and with user plane procedures if the e2ae security for the UDP based media using DTLS and certificate fingerprints is supported by the IMS-ALG and the IMS-AGW and if the IMS-ALG indicated support of e2ae security for the UDPTL using DTLS and certificate fingerprints during registration.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_6.2.10.4.2",
      "section_id": "6.2.10.4.2",
      "section_title": "Session establishment from IMS access network for T.38 fax using \"UDP/TLS/UDPTL\"",
      "content": "Upon receipt of an SDP offer from the IMS access network containing T.38 fax media using the \"UDP/TLS/UDPTL\" transport protocol with the associated:\n-\t3ge2ae SDP attribute, as defined in 3GPP TS 24.229 [11], with a value \"requested\";\n-\tfingerprint SDP attribute(s) as defined in IETF RFC 8122 [80];\n-\tDTLS association identity SDP attribute \"a=tls-id\" defined in IETF RFC 8842 [81]; and\n-\tsetup SDP attribute as defined in IETF RFC 4145 [30];\nthe IMS-ALG shall:\n-\tcheck the received value of the setup SDP attribute to determine if the IMS-AGW needs to act as DTLS client or DTLS server. When the received value is equal to:\na) \"active\" the IMS-AGW needs to act as DTLS server;\nb) \"passive\" the IMS-AGW needs to act as DTLS client; or\nc) \"actpass\" the IMS-ALG shall decide if the IMS-AGW needs to act as DTLS client or DTLS server;\n-\twhen reserving the transport addresses/resources towards the IMS access network:\na)\tindicate to the IMS-AGW \"UDP/DTLS\" as transport protocol;\nb)\tif the IMS-AGW needs to act as DTLS client, include the Establish (D)TLS session information element to request the IMS-AGW to start the DTLS session setup;\nc)\tinclude the Notify (D)TLS session establishment Failure Event information element to request the IMS-AGW to report the unsuccessful DTLS session setup;\nd)\tinclude the Remote certificate fingerprint information element with the value of the received fingerprint SDP attribute(s); and\ne)\tinclude the Local certificate fingerprint Request information element to request the certificate fingerprint of the IMS-AGW;\n-\tindicate to the IMS-AGW \"UDP\" as transport protocol when reserving the transport addresses/resources towards the IMS core network; and\n-\tremove the setup SDP attribute and indicate the transport protocol \"UDPTL\" in the SDP offer towards the IMS core network.\nUpon receipt of an SDP answer from the IMS core network, the IMS-ALG shall:\n-\tin the \"m=\" line indicating T.38 fax using UDPTL, change the transport protocol to \"UDP/TLS/UDPTL\";\n-\tinsert the fingerprint SDP attribute with the value of the Local certificate fingerprint information element received from the IMS-AGW;\n-\tinsert the \"a=tls-id\" SDP attribute containing a new DTLS association identity; and\n-\tinsert the setup SDP attribute with the value:\na) \"active\" if the IMS-ALG requested the IMS-AGW to act as DTLS client; or\nb) \"passive\" if the IMS-AGW shall take the DTLS server role.\nThe message sequence chart shown in the figure 6.2.10.4.2.1 gives an example of a session establishment from the IMS access network with an emphasis on the additional aspects for the IMS-ALG and the IMS-AGW for the e2ae protection of the T.38 fax media using UDPTL over DTLS.\nFigure 6.2.10.4.2.1: Session setup from the IMS access network with e2ae protection of T.38 fax",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.10.4.2.1",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.10.4.3",
      "section_id": "6.2.10.4.3",
      "section_title": "Session establishment towards IMS access network for T.38 fax using \"UDP/TLS/UDPTL\"",
      "content": "Upon receipt of an SDP offer from the IMS core network containing T.38 fax media using the \"UDPTL\" transport protocol the IMS-ALG shall:\n-\twhen reserving the transport addresses/resources towards the IMS access network:\na)\tindicate to the IMS-AGW \"UDP/DTLS\" as transport protocol;\nb)\tinclude the Notify (D)TLS session establishment Failure Event information element to request the IMS-AGW to report the unsuccessful DTLS session setup; and\nNOTE 1:\tThe IMS-ALG may omit this information element when reserving resources and instead send it to the IMS-AGW when modifying the resources towards the IMS access network.\nc)\tinclude the Local certificate fingerprint Request information element to request the certificate fingerprint of the IMS-AGW; and\n-\twhen reserving the transport addresses/resources towards the IMS core network indicate to the IMS-AGW \"UDP\" as transport protocol.\n-\tmodify the SDP offer that will be sent to the IMS access network by:\n-\tin the \"m=\" line indicating T.38 fax using UDPTL, changing the transport protocol to \"UDP/TLS/UDPTL\";\n-\tinserting the 3ge2ae SDP attribute, as defined in 3GPP TS 24.229 [11], with a value \"applied\";\n-\tinserting the fingerprint SDP attribute, as defined in IETF RFC 8122 [80], with the value of the Local certificate fingerprint information element received from the IMS-AGW;\n-\tinserting the \"tls-id\" SDP attribute with the new DTLS association identity; and\n-\tinserting the setup SDP attribute, as defined in IETF RFC 4145 [30], e.g. with the value \"actpass\".\nNOTE 2:\tAlternatively, the IMS-ALG can set the value of the setup SDP attribute to \"active\" if the IMS-ALG wants that the IMS-AGW provides the DTLS client role or to \"passive\" if the IMS-ALG wants that the IMS-AGW provides the DTLS server role e.g. for NAT traversal.\nUpon receipt of an SDP answer from the IMS access network containing T.38 fax media using the \"UDP/TLS/UDPTL\" transport protocol with the associated fingerprint and setup SDP attributes, the IMS-ALG shall:\n-\tcheck the value of the received setup SDP attribute to determine if the IMS-AGW needs to act as DTLS client or DTLS server. When the received value is equal to:\na) \"active\" the IMS-AGW needs to act as DTLS server; or\nb) \"passive\" the IMS-AGW needs to act as DTLS client;\n-\twhen modifying the transport addresses/resources towards the IMS access network:\na)\tif the IMS-AGW needs to act as DTLS client, include the Establish (D)TLS session information element to request the IMS-AGW to start the DTLS session setup;\nb)\tinclude the Remote certificate fingerprint information element with the value of the received fingerprint SDP attribute(s); and\nc)\tif not already provided, include the Notify (D)TLS session establishment Failure Event information element to request the IMS-AGW to report the unsuccessful DTLS session setup; and\n-\tremove the setup SDP attribute and indicate the transport protocol \"UDPTL\" in the SDP answer sent towards the IMS core network.\nThe message sequence chart shown in the figure 6.2.10.4.3.1 gives an example of a session establishment towards the IMS access network with an emphasis on the additional aspects for the IMS-ALG and the IMS-AGW for the e2ae protection of the T.38 fax media using UDPTL over DTLS.\nNOTE 3:\tIn the shown example it is assumed that the IMS-ALG requested the IMS-AGW at step 2 to latch onto the address of the received media packets to determine the corresponding destination address. Otherwise, the DTLS ClientHello message received at the step 10 will be dropped until the IMS-AGW receives a repeated DTLS ClientHello message after the step 13.\nFigure 6.2.10.4.3.1: Session setup towards the IMS access network with e2ae protection of T.38 fax",
      "chunk_type": "requirement",
      "cross_references": [
        "figure_6.2.10.4.3.1",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.10.4.4",
      "section_id": "6.2.10.4.4",
      "section_title": "IMS-AGW procedure for e2ae security of T.38 fax using \"UDP/TLS/UDPTL\"",
      "content": "The IMS-AGW shall:\n-\tupon reception of the Local certificate fingerprint Request information element, select an own certificate for the T.38 fax media stream, uniquely associate the own certificate with the T.38 media stream, and send to the IMS-ALG the Local certificate fingerprint information element with the fingerprint of the own certificate;\n-\tuniquely associate the value of the Remote certificate fingerprint information element, received from the IMS-ALG, with the corresponding T.38 fax media stream;\n-\ttake a DTLS server role and be prepared to receive a DTLS ClientHello message from the served UE;\n-\tupon reception of the Establish (D)TLS session information element, take a DTLS client role and start DTLS session establishment by sending the DTLS ClientHello message to the served UE; and\n-\tverify during the subsequent DTLS handshake with the served UE (as described in IETF RFC 7345 [33] and IETF RFC 8842 [81]) that the fingerprint of the certificate passed by the served UE during DTLS handshake matches the value of the Remote certificate fingerprint information element received from the IMS-ALG:\na)\tif the verification fails, the IMS-AGW shall regard the remote DTLS endpoint as not authenticated, terminate the DTLS session and as specified in clause 6.2.10.4.5, shall report the unsuccessful DTLS session setup to the IMS-ALG; or\nb)\tif the verification succeeds, the IMS-AGW shall continue with DTLS session setup and when the DTLS session is established, the IMS-AGW shall be prepared to receive and convert the protected media from the served UE to the unprotected media to be sent to the core network and vice versa.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.2.10.4.5"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.10.4.5",
      "section_id": "6.2.10.4.5",
      "section_title": "DTLS session establishment failure indication",
      "content": "The IMS-AGW shall use a Notify (D)TLS session establishment Failure Indication procedure to report DTLS session establishment related failures.\nThe figure 6.2.10.4.5.1 shows the message sequence chart example when the IMS-AGW reports the unsuccessful DTLS session setup to the IMS-ALG.\nFigure 6.2.10.4.5.1: DTLS session establishment failure indication",
      "chunk_type": "requirement",
      "cross_references": [
        "figure_6.2.10.4.5.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.10.5",
      "section_id": "6.2.10.5",
      "section_title": "End-to-access-edge security for RTP based media using DTLS-SRTP",
      "content": "The procedures are similar to that of clause 6.2.1 apart from the IMS-ALG optionally requesting the eIMS-AGW to provide IMS media plane security using DTLS.\nUpon receipt of an SDP offer from the IMS access network, the IMS-ALG shall:\n-\tcheck the received value of the setup SDP attribute to determine if the IMS-AGW needs to act as DTLS client or DTLS server. When the received value is equal to:\na) \"active\" the IMS-AGW needs to act as DTLS server;\nb) \"passive\" the IMS-AGW needs to act as DTLS client; or\nc) \"actpass\" the IMS-ALG shall decide if the IMS-AGW needs to act as DTLS client or DTLS server;\n-\tif the received SDP offer contains \"a=tls-id\" media-level SDP attribute (as specified in IETF RFC 8842 [81]), create a new DTLS association identity;\n-\twhen reserving the transport addresses/resources towards the IMS access network:\na)\tindicate to the IMS-AGW \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\" as transport protocol;\nb)\tinclude the Remote certificate fingerprint information element with the value of the received fingerprint SDP attribute from the UE (IMS UE or WIC);\nc)\tinclude the Local certificate fingerprint Request information element to request the certificate fingerprint of the IMS-AGW; and\nd)\tif the IMS-AGW needs to act as DTLS client, include the Establish (D)TLS session information element to request the IMS-AGW to start the DTLS session setup;\n-\tindicate to the IMS-AGW \"RTP/AVP\" or \"RTP/AVPF\" over UDP as transport protocol when reserving the transport addresses/resources towards the IMS core network; and\n-\tremove the setup SDP attribute and indicate the transport protocol \"RTP/AVP\" in the offer towards the IMS core network.\nUpon receipt of an SDP answer from the IMS core network, the IMS-ALG shall:\n-\tin the \"m=\" line indicating the use of SRTP, change the transport protocol to \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\";\n-\tinsert the fingerprint SDP attribute with the value of the Local certificate fingerprint information element received from the IMS-AGW; and\n-\tinsert the \"a=tls-id\" SDP attribute containing a new DTLS association identity; and\n-\tinsert the setup SDP attribute with the value:\na) \"active\" if the IMS-ALG requested the IMS-AGW to act as DTLS client; or\nb) \"passive\" if the IMS-AGW shall take the DTLS server role.\nFigure 6.2.10.5.1 shows the message sequence chart example of UE (IMS UE or WIC) originated procedure using DTLS-SRTP.\nNOTE 1:\tThere are two served user instances of the DTLS service within WebRTC: the data channel and the key exchange for SRTP. Thus, there are either two DTLS connections behind a single DTLS session, or two separate DTLS sessions. Below establishment procedures when applied for WebRTC are based on the assumption that there wasn't yet any DTLS procedure triggered from WebRTC data channel side.\nFigure 6.2.10.5.1: UE originated procedure using DTLS-SRTP\nNOTE 2:\tThe UE (IMS UE or WIC) may receive the ClientHello prior the SDP answer, thus the handshake might be initiated, but the handshake will not complete until the SDP answer has been received by the UE (IMS UE or WIC).\nUpon receipt of an SDP offer from the IMS core network using the \"RTP/AVP\" or \"RTP/AVPF\" over UDP as transport protocol the IMS-ALG shall:\n-\twhen reserving the transport addresses/resources towards the IMS access network:\na)\tindicate to the IMS-AGW \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\" as transport protocol; and\nb)\tinclude the Local certificate fingerprint Request information element to request the certificate fingerprint of the IMS-AGW;\n-\twhen reserving the transport addresses/resources towards the IMS core network indicate to the IMS-AGW \"RTP/AVP\" or \"RTP/AVPF\" over UDP as transport protocol; and\n-\tmodify the SDP offer that will be sent to the IMS access network by:\na)\tin the \"m=\" line that is indicating the use of SRTP, changing the transport protocol to \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\";\nb)\tinserting the fingerprint SDP attribute with the value of the Local certificate fingerprint information element received from the IMS-AGW;\nc)\tinserting the \"tls-id\" SDP attribute with the new DTLS association identity; and\nd)\tinserting the setup SDP attribute, as defined in IETF RFC 4145 [30], with the value \"actpass\".\nUpon receipt of an SDP answer from the IMS access network containing the use of the \"UDP/TLS/RTP/SAVP\" or \"UDP/TLS/RTP/SAVPF\" transport protocol with the associated fingerprint and setup SDP attributes, the IMS-ALG shall:\n-\tcheck the value of the received setup SDP attribute to determine if the IMS-AGW needs to act as DTLS client or DTLS server. When the received value is equal to:\na) \"active\" the IMS-AGW needs to act as DTLS server; or\nb) \"passive\" the IMS-AGW needs to act as DTLS client;\n-\twhen modifying the transport addresses/resources towards the IMS access network:\na)\tif the IMS-AGW needs to act as DTLS client, include the Establish (D)TLS session information element to request the IMS-AGW to start the DTLS session setup;\nb)\tinclude the Remote certificate fingerprint information element with the value of the received fingerprint SDP attribute; and\nc)\tif not already provided, include the Notify (D)TLS session establishment Failure Event information element to request the IMS-AGW to report the unsuccessful DTLS session setup; and\n-\tremove the setup SDP attribute and indicate the transport protocol \"RTP/AVP\" in the SDP answer towards the IMS core network.\nThe message sequence chart shown in the figure 6.2.10.5.2 shows the message sequence chart example of UE (IMS UE or WIC) terminated procedure using DTLS-SRTP.\nFigure 6.2.10.5.2: UE terminated procedure using DTLS-SRTP\nNOTE 3:\tThe IMS-AGW might receive the ClientHello prior receiving the MOD-request, but the DTLS handshake will not finish before the MOD-request (more specific: the fingerprint from UE (IMS UE-b or WIC-b) has been received.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.10.5.1",
        "figure_6.2.10.5.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.10.6.1",
      "section_id": "6.2.10.6.1",
      "section_title": "General",
      "content": "The requirements on eP-CSCF (IMS-ALG) and eIMS-AGW for the procedures to establish WebRTC data channels are specified in clause 5.20.2.\nThe following clauses describe extensions to the Iq signalling procedures and their interactions with SIP signalling in the control plane and with user plane procedures if the e2ae security for the WebRTC data channels using \"SCTP over DTLS\" is supported by the eP-CSCF (IMS-ALG) and the eIMS-AGW.\nAll message sequence charts in this clause are examples. The example high-level H.248 context model is defined in Figure 6.2.1.1 and further detailed below.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_5.20.2",
        "figure_6.2.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.10.6.2",
      "section_id": "6.2.10.6.2",
      "section_title": "Call flow for data channel establishment from WIC towards IMS access network and MSRP session establishment",
      "content": "Support of multiple WebRTC data channels per WebRTC calls implies support of so called H.248 stream grouping. Figure 6.2.10.6.2.1 shows an example H.248 Context model for a WebRTC call with unbundled audio and video, and with multiple data components.\nFigure 6.2.10.6.2.1: eIMS-AGW – H.248 Context model for WebRTC gateway inclusive H.248 Stream Group for WebRTC data components\nThe example flow in this clause focuses on the WebRTC data channel part only. Thus, only H.248 Streams S1 (for deaggregation of multiple data channels) and S2 (for MSRP traffic) are indicated subsequently.\nFigure 6.2.10.6.2.2 shows the message sequence chart example for the WIC originated procedure to establish a WebRTC MSRP data channel using SCTP-over-DTLS transport.\nFigure 6.2.10.6.2.2: WIC originated procedure for WebRTC data channel establishment and MSRP stream establishment\nThe IMS UE A embedded WIC-A performs an IMS originating session set-up according to 3GPP TS 23.228 [2] with modifications for support of WebRTC service control.\nThe procedure in the above figure for requesting an MSRP profiled WebRTC data channel is described step-by-step with an emphasis on the additional aspects for eP-CSCF (IMS-ALG) and eIMS-AGW with regards to the creation of an H.248 Context for interworking MSRP-over-DC to MSRP-over-TCP:\n1.\tIMS UE-A (WIC-A) sends an SDP offer for an MSRP WebRTC data channel. A new \"SCTP association over DTLS association \" is requested.\n2. - 4.\tThe eP-CSCF (IMS-ALG) uses the \"Reserve AGW Connection Point\" procedure to request a termination and H.248 Stream '2' for \"MSRP-over-TCP\" media towards the core network.\n5.\tThe eP‑CSCF (IMS‑ALG) modifies the SDP offer to offers TCP transport for MSRP, and to requests the remote peer to select the TCP setup direction.\n6.\tThe eP‑CSCF (IMS‑ALG) forwards the SDP offer.\n7. – 10. The configuration of core network side H.248 Stream endpoint S2/T2 is completed based on the received SDP answer (7).\n11.\tThe eP-CSCF (IMS-ALG) uses the \"Reserve and Configure AGW Connection Point\" procedure to request a termination inclusive an H.248 Stream Group for WebRTC DC traffic. The eP-CSCF (IMS-ALG) uses an H.248 Context model with H.248 Stream grouping as required for WebRTC DC support. The Stream Group (SG) configurations according to Figure 6.2.10.6.2.1 is applied: The eP-CSCF (IMS-ALG) decides to assign H.248 StreamID value '1' to the H.248 deaggregation stream and to use H.248 StreamID value '2' for the WebRTC data channel. The following aspects should be emphasized:\na)\tH.248 deaggregation stream (S1): - covers the protocol stack segment \"SCTP Association over DTLS connection over L4/IP\";- the 'UDP' is indicated as L4 protocol;- the SDP information related to the underlying ICE procedures is omitted in the abstracted ADD.req command;- the deaggregation stream embedded SDP covers the attributes for configuration of the SCTP Association;\nb)\tH.248 component stream (S2): - covers the upper protocol levels of the logical DC and the IP application layer (here 'MSRP');\nc)\tDTLS session/DTLS association establishment:- an outgoing establishment procedure is enabled (\"which will be executed by the eIMS-AGW after successful L4 connectivity\");\nd)\tSCTP association establishment:- both, an incoming and outgoing establishment procedure is enabled (\"in order to emulate \"SCTP simultaneous open\" behaviour\");- the eIMS-AGW would start to send an SCTP INIT chunk as soon as the DTLS connection is \"data transfer ready\" (see step 16);\ne)\tPreparation of DC release already in DC establishment phase:- Background: DC release is based on SCTP Association level SCTP Stream reset procedures. Incoming reset requests could be either autonomously handled by the eIMS-AGW or explicitly controlled by the eP-CSCF (IMS-ALG). - The activation of a notification mechanism is required in any case (indicating the autonomous behaviour by the default value 'accept' of the correspondent event parameter).\n12./13.\tThe eIMS-AGW confirms the successful creation and configuration of the requested H.248 Stream Group for WebRTC DC traffic.\n14./15.\tThe eP-CSCF (IMS-ALG) then sends the updated SDP answer to the IMS UE-A embedded WIC-A.\nNOTE:\tIn figure 6.2.10.6.2.2. \"a=dcmap\" does not contain priority information and the default priority thus applies.\n6.2.10A\tIMS end-to-end Media Plane Security\n6.2.10A.1\tEnd-to-end security for RTP based media using SDES\nThis procedure is identical to that of clause 6.2.1 apart from the IMS-ALG providing \"RTP/SAVP\" or \"RTP/SAVPF\", as received in the SDP, to the IMS-AGW as transport protocol and not providing any other media related information to the corresponding terminations, and configuring the IMS-AGW to pass media transparently.\nThe IMS-ALG shall forward the SDP with unmodified transport protocol for those media lines and unmodified SDES SDP attribute(s).\n6.2.10A.2\tEnd-to-end security for TCP-based media using TLS\nThis procedure is identical to that of clause 6.2.1 apart from the IMS-ALG providing \"TCP\" to the IMS-AGW as transport protocol and not providing any TLS related information nor any other media related information to the corresponding terminations, and configuring the IMS-AGW to pass media transparently.\nThe IMS-ALG shall forward the SDP with unmodified transport protocol for those media lines and unmodified TLS related SDP attribute(s).\nNOTE:\tEnd-to-end security for TCP-based media using TLS is not supported between two terminals being located behind firewalls/NATs.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.10.6.2.1",
        "figure_6.2.10.6.2.2",
        "ts_23.228"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.11",
      "section_id": "6.2.11",
      "section_title": "Change Through-Connection",
      "content": "The Change Through-Connection procedure is used for opening and closing of gates and is mandatory for IMS-ALG and IMS-AGW to support. The IMS-ALG sets the Stream mode parameter using the Change Through-Connection procedure to request the IMS-AGW to one-way or both-way through-connect or block media streams on a termination.\nThe IMS-ALG may combine the Change Through-Connection procedure with the Reserve and Configure AGW Connection Point, Reserve AGW Connection Point or Configure AGW Connection Point procedure as in Figure 6.2.1.2., or may apply this procedure separately.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.1.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.12",
      "section_id": "6.2.12",
      "section_title": "Emergency Calls",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG requesting the IMS-AGW to treat the call as emergency call with a preferential handling by including the information element \"Emergency Call Indicator\" within the \"Reserve and Configure AGW Connection Point\" or \"Reserve AGW Connection Point procedure\".",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.13.1",
      "section_id": "6.2.13.1",
      "section_title": "General",
      "content": "An IMS-ALG may configure the IMS-AGW to transfer the ECN bits in the IP header transparent (see clause 6.2.13.2) or to act as an ECN endpoint (see clause 6.2.13.3). See clause 5.12.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.2.13.2",
        "clause_6.2.13.3",
        "clause_5.12"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.13.2",
      "section_id": "6.2.13.2",
      "section_title": "ECN Active Indicated (ECN transparent)",
      "content": "Figure 6.2.13.2.1 shows the message sequence chart example for indicating ECN transparent.\nFigure 6.2.13.2.1: Procedure to indicate ECN transparent negotiated\nUpon receipt of the indication that ECN transparent has been negotiated, the IMS-AGW shall forward ECN bits within IP packets unmodified. Any RTCP feedback received shall be passed unchanged.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.13.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.13.3",
      "section_id": "6.2.13.3",
      "section_title": "ECN support requested (ECN endpoint)",
      "content": "Figure 6.2.13.3.1 shows the message sequence chart example for requesting ECN endpoint.\nFigure 6.2.13.3.1: Procedure to Request ECN endpoint\nUpon receipt of a request to apply ECN the IMS-AGW shall set the ECN field of the IP header in accordance with 3GPP TS 26.114 [21] when sending any data packets.\nUpon receipt of any IP headers indicating ECN Congestion Experienced (ECN-CE) the IMS-AGW shall trigger rate adaptation in accordance with 3GPP TS 26.114 [21].\nNOTE:\tECN endpoint requires the IMS-ALG to configure the IMS-AGW with all media attributes to allow rate adaptation even if no transcoding is required/supported in the IMS-AGW.",
      "chunk_type": "requirement",
      "cross_references": [
        "figure_6.2.13.3.1",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.13.4",
      "section_id": "6.2.13.4",
      "section_title": "ECN Failure Indication (ECN endpoint)",
      "content": "Figure 6.2.13.4.1 shows the message sequence chart example for an ECN Failure Event.\nFigure 6.2.13.4.1: Procedure to Report ECN Failure\nWhen the IMS-ALG receives a Notification indicating that a failure has occurred, the IMS-ALG may trigger a new SDP offer to disable ECN.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.13.4.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.14.1",
      "section_id": "6.2.14.1",
      "section_title": "General",
      "content": "This clause describes extensions to the Iq signalling procedures and their interactions with SIP signalling in the control plane and with user plane procedures to support the \"SRVCC enhanced with ATCF\" procedures between the IMS-ALG (ATCF) and IMS-AGW (ATGW) when the IMS-ALG and IMS-AGW support the ATCF and ATGW functionality, as specified in 3GPP TS 23.237 [18] and 3GPP TS 24.237 [19].\nThe Access Transfer procedures are optional to support on the Iq reference point. The requirements in this clause shall apply if these procedures are supported.\nAll message sequence charts in this clause are examples.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_23.237",
        "ts_24.237"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.14.2",
      "section_id": "6.2.14.2",
      "section_title": "H.248 context model",
      "content": "Figure 6.2.14.2.1 shows the H.248 context model after the PS originating or terminating session establishment and before the PS to CS access transfer procedure. The \"squared\" line represents the call control signalling. The \"dotted\" line represents the bearer. The bearer termination T1 is used for the media path of the PS access leg, the bearer termination T2 is used for the media path of the remote leg.\nFigure 6.2.14.2.1: H.248 Context Model before Access Transfer\nFigure 6.2.14.2.2 shows the H.248 context model during the PS to CS access transfer procedure. The IMS-ALG (ATCF) may seize a new bearer termination T3 for the new media path of the CS access leg, e.g. if the PS and CS nodes before and after the handover are reachable via different IP realms or use a different IP version. The IMS-ALG (ATCF) may alternatively reconfigure the T1 termination with the new remote configuration (e.g. IP address and media) instead of seizing a new termination; in that case, the H.248 context model remains as before access transfer.\nBi-casting is not supported during access transfer, i.e. the IMS-AGW (ATGW) does not duplicate downlink media packets received from the remote leg to the source and target access legs simultaneously.\nFigure 6.2.14.2.2: H.248 Context Model during Access Transfer\nFigure 6.2.14.2.3 shows the H.248 context model after the PS to CS access transfer procedure if the source access leg is released. If the UE chooses to retain some media flow(s) in the transferred-out access, the H.248 context model remains as during access transfer.\nFigure 6.2.14.2.3: H.248 Context Model after Access Transfer",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.14.2.1",
        "figure_6.2.14.2.2",
        "figure_6.2.14.2.3"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.14.3",
      "section_id": "6.2.14.3",
      "section_title": "PS session origination or termination with media anchoring in IMS-AGW (ATGW) signaling procedures",
      "content": "If the IMS-ALG (ATCF) decides to anchor the media of a session in the IMS-AGW (ATGW) the call related procedures shall follow the basic procedures for IMS ALG (i.e. as specified in clause 6.2.1) with the following differences:\n-\tThe IMS-ALG (ATCF) shall seize a termination towards the terminating user, using the \"Reserve AGW Connection Point\" procedure before sending a SDP offer to the terminating user. The IMS-ALG (ATCF) may signal media related information to the IMS-AGW (ATGW) or omit media when adding the IP termination at this stage.\nNOTE :\tThe signalling of media related information to a MGW requires that it reserve the indicated resources before returning a positive response to the H.248 command, by omitting media related information the IMS-AGW (ATGW) does not need to reserve any associated resources at this stage.\n-\tWhen the IMS-ALG (ATCF) receives the SDP answer from the terminating user, the IMS-ALG (ATCF) shall configure the IMS-AGW (ATGW) accordingly by either supplying the same media related information for all interconnected terminations or by omitting the media related information.\nFigure 6.2.14.3.1: PS session establishment with media anchoring in IMS-AGW (ATGW)\n1.\tThe IMS-ALG (ATCF) receives an SDP offer in SIP signalling. The IMS-ALG (ATCF) requires an IMS-AGW (ATGW) for media anchoring (or for another IMS-AGW use case) but does not offer transcoding.\n2.\tThe IMS-ALG (ATCF) sends a H.248 ADD request command to create the outgoing termination and to request IP resources to execute ATGW function. As no media transcoding is required this may be indicated by signalling \"-\". Alternatively any codec (e.g. Codec 1) can be signalled. If the IMS-ALG (ATCF) selects an IMS-AGW (ATGW) that does not support transcoding, the IMS-ALG (ATCF) may signal media related sub-fields in the media descriptor to the IMS-AGW (ATGW) if the IMS-AGW (ATGW) supports media encoding. The IMS-AGW (ATGW)  shall accept the ADD request even though it cannot reserve any transcoding resources for the indicated media.\n3.\tThe IMS-AGW (ATGW) creates the outgoing termination.\n4.\tThe IMS-AGW (ATGW) replies to IMS-ALG (ATCF) with a H.248 ADD reply command and provides the local address and port of the outgoing termination.\n5.\tThe IMS-ALG (ATCF) replaces the IP address inside the SDP using the information coming from IMS-AGW (ATGW).\n6.\tThe IMS-ALG (ATCF) forwards the new offer to the succeeding node.\n7.\tThe SDP answer is received by IMS-ALG (ATCF). In this example the codec1 received in the original SDP offer in step1 has been selected.\n8.\tThe IMS-ALG (ATCF) sends a H.248 MOD request command to configure the outgoing termination with address and port information. As no media transcoding is needed this may be indicated by signalling \"-\" .Alternatively the selected codec (Codec 1) can be signalled.\n9.\tThe IMS-AGW (ATGW) configures the outgoing termination.\n10.\tThe IMS-AGW (ATGW) replies to IMS-ALG (ATCF) with a H.248 MOD reply command.\n11.\tThe IMS-ALG (ATCF) sends a H.248 ADD command to create the incoming termination to configure this termination with remote address and port information and to request resources to execute ATGW function. As no media transcoding is needed this may be indicated by signalling \"-\" .Alternatively media related sub-fields in the media descriptor for the codec indicated to the incoming termination may be signalled (e.g. the selected codec received in step 7 (Codec 1).\n12.\tThe IMS-AGW (ATGW) creates the incoming termination.\n13.\tThe IMS-AGW (ATGW) replies to the IMS-ALG (ATCF) with a H.248 ADD reply command and provides the local address and port of the incoming termination.\n14.\tThe IMS-ALG (ATCF) replaces the IP address inside the SDP answer using the information coming from IMS-AGW (ATGW).\n15.\tSDP answer is sent to the network at the incoming side.\nSimilar principles shall apply during the establishment of a mobile terminating session.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.14.3.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.14.4",
      "section_id": "6.2.14.4",
      "section_title": "PS to CS Access Transfer procedure with media anchored in IMS-AGW (ATGW)",
      "content": "The signalling flow shown in figure 6.2.14.4.1 gives an example for PS to CS access transfer with media anchored in the IMS-AGW (ATGW). In this case, the media has been anchored in IMS-AGW (ATGW) as specified in clause 6.2.14.3.\n1.\tThe IMS-ALG (ATCF) receives an SDP offer in SIP signalling from the MSC Server. The IMS-ALG (ATCF) checks whether transcoding is required.2.\tThe IMS-ALG (ATCF) sends a H.248 ADD request command to create the target access leg termination and to request IP resources to execute ATGW function. Topology is changed and media reconfigured to connect media between T2 and T3. If no media transcoding is required this may be indicated by signalling \"-\" or by signalling the same media information on T3 as is configured on T2, following the principles specified in clause 6.2.14.3. If media transcoding is required (as illustrated in this example), the IMS-ALG (ATCF) signals media related sub-fields in the media descriptor to the IMS-AGW (ATGW). The IMS-AGW (ATGW) determines from the media configuration whether transcoding is required on a stream between two terminations between which data flow is permitted.\n3.\tThe IMS-AGW (ATGW) creates the target access leg termination T3 and starts to apply transcoding between T2 and T3 (if required).\n4.\tThe IMS-AGW (ATGW) replies to IMS-ALG (ATCF) with a H.248 ADD reply command and provides the local address and port of the outgoing termination.\n5.\tThe IMS-ALG (ATCF) returns an SDP answer to the MSC Server; the IP address inside the SDP uses the information coming from IMS-AGW (ATGW).\n6.\tUpon successful completion of the access transfer procedure, the IMS-ALG (ATCF) receives a BYE request from the SCC AS if there is no more media flows on the PS access.\n7.\tThe IMS-ALG (ATCF) sends a H.248 SUB request command to subtract the source access leg termination.\n8.\tThe IMS-AGW (ATGW) releases the source access leg termination.\n9.\tThe IMS-AGW (ATGW) replies to IMS-ALG (ATCF) with a H.248 SUB reply command.\nFigure 6.2.14.4.1: PS to CS Access Transfer with transcoding in IMS-AGW (ATGW)",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.2.14.3",
        "figure_6.2.14.4.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.14.5",
      "section_id": "6.2.14.5",
      "section_title": "ECN support during PS to CS Access Transfer procedure with media anchored in IMS-AGW (ATGW)",
      "content": "The signalling flow shown in figure 6.2.14.4.1 gives an example for PS to CS access transfer with media anchored in the IMS-AGW (ATGW). The following additional actions are required if ECN is supported by the IMS-ALG/IMS-AGW:\n1.\na)\tIf ECN was supported during the PS session transparently and the SDP offer received from the MSC Server does not indicate ECN support, it is not possible to maintain transparent ECN support to the IMS CN. The IMS-ALG (ATCF) shall modify the Termination T2 to act as an ECN endpoint toward the IMS CN (see Clause 5.12). Additionally the IMS-ALG (ATCF) shall disable ECN on the termination T3 (or T1).\nb)\tIf ECN was supported during the PS session transparently and the SDP offer received from the MSC Server does indicate ECN support and no transcoding is required (codec types and modes are aligned between ICS side and IMS CN), then the IMS-ALG (ATCF) shall request ECN transparent properties when seizing T3 and respond to the MSC Server with ECN supported in the SDP answer (step 5).\nc)\tIf ECN was supported during the PS session transparently and the SDP offer received from the MSC Server does indicate ECN support and transcoding is required between the CS leg and the IMS-CN,  then the IMS-ALG (ATCF) shall request ECN endpoint properties when seizing T3 (or modify the termination T1 with ECN endpoint properties) and respond to the MSC Server with ECN supported in the SDP answer (step 5). Additionally the IMS-ALG (ATCF) shall modify the Termination T2 to act as an ECN endpoint toward the IMS CN (see Clause 5.12).\nd)\tIf ECN was not supported during the PS session and the SDP Offer received from the MSC Server indicates ECN support, the IMS-ALG (ATCF) shall not accept ECN support in the SDP answer (step 5).",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_5.12",
        "figure_6.2.14.4.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.14.6.1",
      "section_id": "6.2.14.6.1",
      "section_title": "General",
      "content": "The IMS-ALG (ATCF) and the IMS-AGW (ATGW) may support a media-level SDP image attribute \"a=imageattr\" defined in IETF RFC 6236 [24] to negotiate the image size for sending and receiving video.\nThe list of image sizes per payload type supported by the IMS-AGW (ATGW) shall be preconfigured in the IMS-ALG (ATCF). If the image sizes received within an SDP body on the Mw/Mx interface are not all supported by the IMS-AGW (ATGW) then the IMS-ALG (ATCF) shall only send the list of corresponding IMS-AGW (ATGW) supported image sizes to the IMS-AGW (ATGW). If no image size is supported by the IMS-AGW (ATGW), the IMS-ALG (ATCF) shall not send the generic image attribute parameter to the IMS-AGW (ATGW).\nThe signalling flow shown in figure 6.2.14.3.1 gives an example for a PS session establishment with media anchored in the IMS-AGW (ATGW). The following additional actions may be performed if the negotiation of the image size is supported by the IMS-ALG/IMS-AGW:\na)\tupon receipt of an SDP offer containing the image attribute(s) and if the received image sizes are supported by the IMS-AGW (ATGW) then the IMS-ALG (ATCF) may send the generic image attribute parameters for the send and receive directions to the IMS-ALG (ATCF) (step 2 or step 8) when seizing or modifying an outgoing termination;\nNOTE 1:\tIf the offered image attributes are not supported by the IMS-AGW (ATGW) then the IMS-ALG (ATCF) will not send the generic image attribute parameter to the IMS-AGW (ATGW).\nb)\tthe IMS-ALG (ATCF) shall include the SDP image attribute(s) \"a=imageattr\" indicating the supported image sizes in the modified SDP offer (step 5);\nc)\tupon receipt of an SDP answer containing the generic image attribute(s) and if the received image sizes are supported by the IMS-AGW (ATGW) then the IMS-ALG (ATCF) may include the generic image attribute parameter to the IMS-AGW (ATGW) (step 11) when seizing an incoming termination; and\nd)\tthe IMS-ALG (ATCF) shall include the SDP image attribute(s) \"a=imageattr\" indicating the supported image sizes in the modified SDP answer (step 14).\nNOTE 2:\tThe IMS-ALG (ATCF) not supporting the negotiation of generic image attributes will ignore the SDP image attribute received in the SDP offer and will send the SDP offer/answer without any associated SDP image attribute.\nWhen sending the SDP body with image attribute(s) on the Mw/Mx interface the IMS-ALG (ATCF) shall include in the \"a=imageattr\":\n-\t\"recv\" keyword and corresponding image sizes which the IMS-AGW (ATGW) supports in the receiving direction; and\n-\t\"send\" keyword and corresponding image sizes which the IMS-AGW (ATGW) supports in the sending direction.\nThe signalling flow shown in figure 6.2.14.4.1 gives an example for PS to CS access transfer with media anchored in the IMS-AGW (ATGW). The following additional actions may be performed if the negotiation of the image size is supported by the IMS-ALG/IMS-AGW:\na)\tif the image sizes were negotiated during the PS session and if the IMS-AGW (ATGW) applies the video transcoding (step 3) and if the IMS-AGW (ATGW) is configured with different image sizes on the receive direction of one termination and the send direction of another interconnected termination, then it shall adjust the frame sizes accordingly when forwarding video media streams and use the image size as described in 3GPP TS 26.114 [21] when sending media.\nNOTE 3:\tThe relation between the negotiated image sizes and CVO are specified in 3GPP TS 26.114 [21].\nNOTE 4:\tThe generic image attribute includes information related to the send and receive capabilities of a single termination, and the adjustment of image sizes is typically based on the setting of two connected terminations in a single context.",
      "chunk_type": "definition",
      "cross_references": [
        "figure_6.2.14.3.1",
        "figure_6.2.14.4.1",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.14.6.2",
      "section_id": "6.2.14.6.2",
      "section_title": "Indication of generic image attributes",
      "content": "The IMS-ALG (ATCF) may include the generic image attributes to the IMS-AGW (ATGW). The example sequence is shown in figure 6.2.14.6.2.1.\nFigure 6.2.14.6.2.1: Request to reserve AGW connection point with generic image attribute",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.14.6.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.14.7",
      "section_id": "6.2.14.7",
      "section_title": "Handling of common codec parameters",
      "content": "For PS session origination, figure 6.2.14.3.1 shall apply with the handling of codec related parameters applicable to multiple codecs in table 6.2.14.7.1, assuming that codec related information is signalled to the IMS-AGW(ATGW) at this stage. If no codec related information is signalled to the IMS-AGW at this stage, the common codec related parameters for the termination towards the SDP answerer in table 6.2.14.7.1 shall be signalled towards the IMS-AGW during a PS to CS Access Transfer procedure.\nTable 6.2.14.7.1: IMS-ALG handling of common codec related SDP parameters during PS session origination.\nParameter\nHandling in SDP offer\nHandling in the SDP answer\nptime (NOTE)\nIf the ptime parameter is included in the received SDP offer, the IMS-ALG shall supply the parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the value is supported by the IMS-AGW for receiving media, the IMS-ALG should keep the value from the received SDP offer unchanged in the SDP offer it sends. If the IMS-AGW only supports a lower ptime value, the IMS-ALG shall supply the ptime value according to configured preferences in the SDP offer it forwards. If no ptime value was contained in the received SDP offer, the IMS-ALG may add the parameter with a value according to configured preferences to the SDP offer.\nIf the ptime parameter is included in the received SDP answer, the IMS-ALG shall supply the parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor.\nIf the value is supported by the IMS-AGW for receiving media, the IMS-ALG should keep the value from the received SDP answer unchanged in the SDP answer it sends. If the IMS-AGW only supports a lower ptime value, the IMS-ALG shall supply the ptime value according to configured preferences in the SDP answer it forwards. If no ptime value was contained in the received SDP answer, the IMS-ALG may add the parameter with a value according to configured preferences to the SDP answer.\nmaxptime (NOTE)\nIf the maxptime parameter is included in the received SDP offer, the IMS-ALG shall supply the parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the value is supported by the IMS-AGW for receiving media, the IMS-ALG should keep the value from the received SDP offer unchanged in the SDP offer it sends. If the IMS-AGW only supports a lower maxptime value, the IMS-ALG shall supply the maxptime value according to the IMS-AGW capabilities in the SDP offer it forwards. If no maxptime value was contained in the received SDP offer, the IMS-ALG may add the parameter with a value according to the IMS-AGW capabilities to the SDP offer.\nIf the maxptime parameter is included in the received SDP answer, the IMS-ALG shall supply the parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor.\nIf the value is supported by the IMS-AGW for receiving media, the IMS-ALG should keep the value from the received SDP answer unchanged in the SDP answer it sends. If the IMS-AGW only supports a lower maxptime value, the IMS-ALG shall supply the maxptime value according to the IMS-AGW capabilities in the SDP answer it forwards. If no maxptime value was contained in the received SDP answer, the IMS-ALG may add the parameter with a value according to the IMS-AGW capabilities to the SDP answer.\nNOTE:\tThis SDP attribute is defined in IETF RFC 4566 [53]. It applies to all codecs offered in an SDP media line.\nFor PS to CS Access Transfer, figure 6.2.14.4.1 shall apply with the handling of codec related parameters applicable to multiple codecs in in table 6.2.14.A.2.\nTable 6.2.14.7.2: IMS-ALG handling of common codec related SDP parameters during PS to CS Access Transfer.\nParameter\nHandling of common codec parameters received in the SDP offer\nCommon Codec parameters supplied in the SDP answer\nptime (NOTE)\nIf the ptime parameter is included in the received SDP offer, the IMS-ALG shall supply the parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nThe IMS-ALG may add the parameter with a value according to configured preferences to the SDP answer.\nmaxptime (NOTE)\nIf the maxptime parameter is included in the received SDP offer, the IMS-ALG shall supply the parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nThe IMS-ALG may add the parameter with a value according to the IMS-AGW capabilities to the SDP answer.\nNOTE:\tThis SDP attribute is defined in IETF RFC 4566 [53]. It applies to all codecs offered in an SDP media line.",
      "chunk_type": "parameter",
      "cross_references": [
        "table_6.2.14.7.1",
        "table_6.2.14",
        "table_6.2.14.7.2",
        "figure_6.2.14.3.1",
        "figure_6.2.14.4.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.14.8",
      "section_id": "6.2.14.8",
      "section_title": "EVS speech codec support",
      "content": "For PS session origination, figure 6.2.14.3.1 shall apply with the EVS parameter handling in table 6.2.14.8.1, assuming that EVS is \"codec 1\", which is selected, and that \"codec 1\" related information is signalled to the IMS-AGW(ATGW) at this stage. If no codec related information is signalled to the IMS-AGW at this stage, the EVS related parameters for the termination towards the SDP answerer in table 6.2.14.8.1 shall be signalled towards the IMS-AGW during a PS to CS Access Transfer procedure.\nTable 6.2.14.8.1: IMS-ALG handling of EVS related SDP parameters during PS session origination.\nParameter\nHandling for EVS payload type in SDP offer\nHandling if offered EVS payload type is accepted in the SDP answer\nevs-mode-switch (NOTE 1)\nIf the evs-mode-switch parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer and shall retain the parameter in the SDP offer it forwards.\nIf the evs-mode-switch parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nhf-only (NOTE 1)\nIf the hf-only parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer and shall retain the parameter in the SDP offer it forwards.\nOtherwise, if the IMS-ALG is configured to negotiate using only the header-full EVS RTP payload format, the IMS-ALG shall provide the hf-only parameter with a value 1 to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer, and within the SDP offer it forwards.\nIf the hf-only parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\ndtx (NOTE 1)\nIf the dtx parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer and shall retain the parameter in the SDP offer it forwards.\nOtherwise, if the dtx-recv parameter is contained in the SDP offer, the IMS-ALG may include the dtx parameter in the SDP offer it forwards with the same value as the dtx-recv parameter in the SDP offer.\nOtherwise, if the usage of DTX is not desired in the sending and receiving direction, the IMS-ALG shall include the dtx parameter with a value 0 to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer, and within the SDP offer it forwards.\nIf the dtx parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\ndtx-recv (NOTE 1)\nIf the dtx-recv parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer and shall retain the parameter in the SDP offer it forwards.\nOtherwise, if the reception of DTX is not desired and the dtx parameter is not included in the forwarded SDP offer, the IMS-ALG shall include the dtx-recv parameter with a value 0 to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer, and within the SDP offer it forwards.\nIf both the dtx and dtx-recv parameters are included, those parameters shall have the same value; however, inclusion of the dtx-recv parameter is not required if the dtx parameter is included.\nIf the dtx-recv parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nbr (NOTE 1)\nIf the br parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the send and receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG should remove the EVS payload from the SDP offer.\nOtherwise, If the br parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include that br parameter with the selected value in the SDP offer it forwards.\nOtherwise, if the IMS-ALG desires the same bit rate range for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range to match IMS-AGW capabilities and possible configured policies, it shall supply the br parameter in the SDP offer it sends.\nIf the IMS-ALG also supplies the bw, bw-send or bw-recv parameter, the value of the br parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br parameter in the SDP offer it forwards, it shall also supply to the IMS-AGW the br parameter in the local descriptor for the termination towards the offerer with the same value.\nIf the br parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nbr-send (NOTE 1)\nIf the br-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the send and receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG should remove the EVS payload from the SDP offer.\nOtherwise, If the br-send parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br-send value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include that br-send parameter with the selected value in the SDP offer it forwards.\nOtherwise, if the IMS-ALG desires a different bit rate (range) for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range for the send direction towards the offerer to match IMS-AGW capabilities and possible configured policies, it shall supply the br-send parameter in the SDP offer it sends. Otherwise the IMS-ALG shall not include this parameter in the SDP offer.\nIf the IMS-ALG also supplies the bw or bw-send parameter, the value of the br-send parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br-send parameter in the SDP offer it forwards, it shall also supply to the IMS-AGW the br-send parameter in the local descriptor for the termination towards the offerer with the same value.\nIf the br-send parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nbr-recv (NOTE 1)\nIf the br-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the send and receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG should remove the EVS payload from the SDP offer.\nOtherwise, If the br-recv parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br-recv value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include that br-recv parameter with the selected value in the SDP offer it forwards.\nOtherwise, if the IMS-ALG desires a different bit rate (range) for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range for the receive direction towards the offerer to match IMS-AGW capabilities and possible configured policies, it shall supply the br-recv parameter in the SDP offer it sends. Otherwise the IMS-ALG shall not include this parameter in the SDP offer.\nIf the IMS-ALG also supplies the bw or bw-recv parameter, the value of the br-recv parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br-recv parameter in the SDP offer it forwards, it shall also supply to the IMS-AGW the br-recv parameter in the local descriptor for the termination towards the offerer with the same value.\nIf the br-recv parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nbw (NOTE 1)\nIf the bw parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidth(s), or a subset of them, in EVS primary mode in the send and receive direction. If the indicated sampling bandwidth(s), and even each subset of them, are not supported, the IMS-ALG should remove the EVS payload from the SDP offer.\nOtherwise, If the bw parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received bw value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include that bw parameter with the selected value in the SDP offer it forwards.\nOtherwise, if the IMS-ALG desires the same sampling bandwidth(s) for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidth(s) to match IMS-AGW capabilities and possible configured policies, it shall supply the bw parameter in the SDP offer it sends.\nIf the IMS-ALG also supplies the br, br-send or br-recv parameter, the value of the bw parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw parameter in the SDP offer it forwards, it shall also supply to the IMS-AGW the bw parameter in the local descriptor for the termination towards the offerer with the same value.\nIf the bw parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nbw-send (NOTE 1)\nIf the bw-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidth(s), or a subset of them, in EVS primary mode in the send and receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG should remove the EVS payload from the SDP offer.\nOtherwise, If the bw-send parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidth value, which is either the received bw-send value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include that bw-send parameter with the selected value in the SDP offer it forwards.\nOtherwise, if the IMS-ALG desires different sampling bandwidth(s) for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidth(s) for the send direction towards the offerer to match IMS-AGW capabilities and possible configured policies, it shall supply the bw-send parameter in the SDP offer it sends. Otherwise the IMS-ALG shall not include this parameter in the SDP offer.\nIf the IMS-ALG also supplies the br or br-send parameter, the value of the bw-send parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw-send parameter in the SDP offer it forwards, it shall also supply to the IMS-AGW the bw-send parameter in the local descriptor for the termination towards the offerer with the same value.\nIf the bw-send parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nbw-recv (NOTE 1)\nIf the bw-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidth(s), or a subset of them, in EVS primary mode in the send and receive direction. If the indicated sampling bandwidth(s), and even each subset of them, are not supported, the IMS-ALG should remove the EVS payload from the SDP offer.\nOtherwise, If the bw-recv parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidth(s) value, which is either the received bw-recv value or a subset of it, based on IMS-AGW capabilities and possible configured policies, and shall include that bw-recv parameter with the selected value in the SDP offer it forwards.\nOtherwise, if the IMS-ALG desires different sampling bandwidth(s) for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidth(s) for the receive direction towards the offerer to match IMS-AGW capabilities and possible configured policies, it shall supply the bw-recv parameter in the SDP offer it sends. Otherwise the IMS-ALG shall not include this parameter in the SDP offer.\nIf the IMS-ALG also supplies the br or br-recv parameter, the value of the bw-recv parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw-recv parameter in the SDP offer it forwards, it shall also supply to the IMS-AGW the bw-recv parameter in the local descriptor for the termination towards the offerer with the same value.\nIf the bw-recv parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\ncmr (NOTE 1)\nIf the cmr parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer and shall retain the parameter in the SDP offer it forwards.\nOtherwise, if the IMS-ALG desires to disable codec mode requests within the RTP payload of the EVS primary mode (due to the IMS-AGW capabilities or policies), it shall include the cmr parameter with value -1 to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer, and within the SDP offer it forwards.\nIf the cmr parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nch-aw-recv (NOTE 1)\nIf the ch-aw-recv parameter is contained in the SDP offer the IMS-ALG shall check if the IMS-AGW supports the indicated mode in the send direction. If the indicated mode is not supported, the IMS-ALG shall remove the payload type from the SDP offer. If the IMS-AGW supports the indicated mode in the send direction for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor, and shall include the unmodified parameter within the SDP offer it forwards. Otherwise, if the IMS-ALG desires to disable partial redundancy mode, it shall include the ch-aw-send parameter with value -1 in the SDP offer it forwards.\nIf the ch-aw-recv parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nnumber of channels (NOTE 2)\nIf the \"number of channels\" parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated number of channels. If the indicated number of channels is not supported, the IMS-ALG should remove the EVS payload from the SDP offer.\nOtherwise, if the \"number of channels\" parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor and shall retain the parameter in the SDP offer it forwards.\nIf the \"number of channels\" parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nch-send (NOTE 1)\nIf the ch-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated number of channels in the send and receive direction. If the indicated number of channels is not supported, the IMS-ALG should remove the EVS payload from the SDP offer.\nOtherwise, if the ch-send parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor and shall retain the parameter in the SDP offer it forwards.\nIf the ch-send parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nch-recv (NOTE 1)\nIf the ch-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated number of channels in the send and receive direction. If the indicated number of channels is not supported, the IMS-ALG should remove the EVS payload from the SDP offer.\nOtherwise, if the ch-recv parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor and shall retain the parameter in the SDP offer it forwards.\nIf the ch-recv parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the answerer, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nmode-set (NOTE 3)\nIf the mode-set parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer and shall retain the parameter in the SDP offer it forwards.\nIf the mode-set parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nmode-change-period (NOTE 3)\nIf the mode-change-period parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer and shall retain the parameter in the SDP offer it forwards.\nIf the mode-change-period parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nmode-change-capability (NOTE 3)\nIf the mode-change-capability parameter is contained in the SDP offer, the IMS-ALG may forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer and shall retain the parameter in the SDP offer it forwards.\nIf the mode-change-capability parameter is contained in the SDP answer, the IMS-ALG may forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nmode-change-neighbor (NOTE 3)\nIf the mode-change-neighbor parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer and shall retain the parameter in the SDP offer it forwards.\nIf the mode-change-neighbor parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor, and the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nmax-red (NOTE 5)\nIf the max-red parameter is contained in the SDP offer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor for the termination towards the SDP offerer and shall retain the parameter in the SDP offer it forwards with a value that considers the received value and the capabilities of the IMS-AGW.\nIf the max-red parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the answerer in the remote descriptor, and the IMS-ALG shall retain this parameter in the SDP answer it forwards with a value that considers the received value and the capabilities of the IMS-AGW.\n3gpp_mtsi_app_adapt (NOTE 4)\nIf the IMS-AGW supports RTCP APP based adaptation messages defined in 3GPP TS 26.114 [21], and the IMS-ALG has a policy to negotiate the usage of those messages, the IMS-ALG shall include the 3gpp_mtsi_app_adapt SDP attribute indicating the supported APP messages in the SDP offer.\nIf the 3gpp_mtsi_app_adapt parameter is contained in the SDP answer, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nNOTE 1:\tThis MIME parameter of the EVS RTP payload type is defined in 3GPP TS 26.445 [51]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 2:\tThis number of channels are encoded as \"encoding parameters\" of the SDP \"a=rtpmap\" attribute defined in IETF RFC 4566 [53].\nNOTE 3:\tThis MIME parameter of the EVS RTP payload type relates to AMR-WB IO mode and is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 4:\tThis SDP attribute is defined in 3GPP TS 26.114 [21]. It applies to all codecs offered in an SDP media line. However, some values are specific to EVS.\nNOTE 5:\tThis MIME parameter of the EVS RTP payload type is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nFor PS to CS Access Transfer, figure 6.2.14.4.1 shall apply with the EVS parameter handling in table 6.2.14.8.2, assuming that EVS is \"codec 3\", which is selected.\nTable 6.2.14.8.2: IMS-ALG handling of EVS related SDP parameters during PS to CS Access Transfer.\nParameter\nHandling of EVS payload type parameter received in the SDP offer\nEVS payload type supplied in the SDP answer\nevs-mode-switch (NOTE 1)\nIf the evs-mode-switch parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the evs-mode-switch parameter is contained in the SDP offer, the IMS-ALG shall include the evs-mode-switch parameter with unmodified value in the SDP answer.\nOtherwise, if EVS was used before the access transfer, the IMS-ALG should include the evs-mode-switch parameter with a value indicating the mode that was negotiated before the access transfer.\nOtherwise, if the IMS-ALG decides to transcode between AMR-WB and EVS (e.g. because AMR-WB was used before the access transfer), it shall include the evs-mode-switch with value 1.\nOtherwise the IMS-ALG shall not include the evs-mode-switch.\nIf the IMS-ALG supplies the evs-mode-switch in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nhf-only (NOTE 1)\nIf the hf-only parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the hf-only parameter is contained in the SDP offer, the IMS-ALG shall include the hf-only parameter with unmodified value in the SDP answer.\nOtherwise, if the IMS-AGW is configured to negotiate using only the header-full EVS RTP payload format, the IMS-ALG shall include the hf-only parameter with a value 1.\nOtherwise, if EVS was used before the access transfer, the IMS-ALG should include the hf-only parameter with a value indicating the mode that was negotiated before the access transfer.\nIf the IMS-ALG supplies the hf-only parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\ndtx (NOTE 1)\nIf the dtx parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the dtx parameter is contained in the SDP offer, the IMS-ALG shall include the dtx parameter with unmodified value in the SDP answer.\nOtherwise, if the dtx-recv parameter is contained in the SDP offer, the IMS-ALG may include the dtx parameter in the SDP answer with the same value as the dtx-recv parameter in the SDP offer.\nOtherwise, if the usage of DTX is not desired (e.g. due to DTX capabilities of expected codecs to transcode with), the IMS-ALG shall include the dtx parameter with a value 0.\nOtherwise, if EVS was used before the access transfer, the IMS-ALG should include the dtx parameter with a value indicating the mode that was negotiated before the access transfer.\nIf the IMS-ALG supplies the dtx parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\ndtx-recv (NOTE 1)\nIf the dtx-recv parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the reception of DTX is not desired and the dtx parameter is not included, the IMS-ALG shall include the dtx-recv parameter with a value 0.\nIf both the dtx and dtx-recv parameters are included, those parameters shall have the same value; however, inclusion of the dtx-recv parameter is not required if the dtx parameter is included.\nIf the IMS-ALG supplies the dtx-recv parameter in the SDP answer, it should also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nbr (NOTE 1)\nIf the br parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the send and receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the br parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br value or a subset of it, based on IMS-AGW capabilities, possible configured policies, and the negotiated br range of an EVS codec used before the access transfer, and shall include the br parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires the same bit rate range for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range to match IMS-AGW capabilities possible configured policies, and the negotiated br range of the EVS codec used before the access transfer, the IMS-ALG shall supply the br parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include this parameter in the SDP answer.\nIf the IMS-ALG also supplies the bw, bw-send or bw-recv parameter, the value of the br parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br parameter in the SDP answer, it shall also supply to the IMS-AGW the br parameter in the local descriptor for the termination towards the offerer with the same value.\nbr-send (NOTE 1)\nIf the br-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the receive direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the br-recv parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br-recv value or a subset of it, based on IMS-AGW capabilities possible configured policies, and the negotiated br range of an EVS codec used before the access transfer, and the IMS-ALG shall include the br-send parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires a different bit rate (range) for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range for the send direction to match IMS-AGW capabilities and possible configured policies, it shall supply the br-send parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include the br-send parameter in the SDP answer.\nIf the IMS-ALG also supplies the bw or bw-send parameter, the value of the br-send parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br-send parameter in the SDP answer, it shall also supply to the IMS-AGW the br-send parameter in the local descriptor for the termination towards the offerer with the same value.\nbr-recv (NOTE 1)\nIf the br-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated bitrates, or a subset of them, in EVS primary mode in the send direction. If the indicated bitrates, and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the br-send parameter is contained in the SDP offer, the IMS-ALG shall select a bitrate value, which is either the received br-send value or a subset of it, based on IMS-AGW capabilities, possible configured policies, and the negotiated br range of an EVS codec used before the access transfer, and the IMS-ALG shall include the br-recv parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires a different bit rate (range) for the send and receive direction in EVS primary mode, and wants to restrict the bit rate range for the receive direction to match IMS-AGW capabilities and possible configured policies, it shall supply the br-recv parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include the br-recv parameter in the SDP answer.\nIf the IMS-ALG also supplies the bw or bw-recv parameter, the value of the br-recv parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the br-recv parameter in the SDP answer, it shall also supply to the IMS-AGW the br-recv parameter in the local descriptor for the termination towards the offerer with the same value.\nbw (NOTE 1)\nIf the bw parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidth(s), or a subset of them, in EVS primary mode in the send and receive direction. If the indicated sampling bandwidth(s), and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the bw parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidth value, which is either the received bw value or a subset of it, based on IMS-AGW capabilities, possible configured policies, and the negotiated bw range of an EVS codec used before the access transfer, and the IMS-ALG shall include the bw parameter with the selected value that is also supplied towards the IMS-AGW in the SDP answer.\nOtherwise, if the IMS-ALG desires the same sampling bandwidth(s) for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidth(s) to match IMS-AGW capabilities, possible configured policies, and the negotiated bw range of the EVS codec used before the access transfer, the IMS-ALG shall supply the bw parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include this parameter in the SDP answer.\nIf the IMS-ALG also supplies the br, br-send or br-recv parameter, the value of the bw parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw parameter in the SDP answer, it shall also supply to the IMS-AGW the bw parameter in the local descriptor for the termination towards the offerer with the same value.\nbw-send  (NOTE 1)\nIf the bw-send parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidths, or a subset of them, in EVS primary mode in the receive direction. If the indicated sampling bandwidths, and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the bw-recv parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidths value, which is either the received bw-recv value or a subset of it, based on IMS-AGW capabilities, possible configured policies, and the negotiated bw range of an EVS codec used before the access transfer, and the IMS-ALG shall include the bw-send parameter with the selected value in the SDP answer.\nOtherwise, if the IMS-ALG desires a different sampling bandwidths for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidths for the send direction to match IMS-AGW capabilities, possible configured policies, and the negotiated bw range of the EVS codec used before the access transfer, the IMS-ALG shall supply the bw-send parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include the br-send parameter in the SDP answer.\nIf the IMS-ALG also supplies the br or br-send parameter, the value of the bw-send parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw-send parameter in the SDP answer, it shall also supply to the IMS-AGW the bw-send parameter in the local descriptor for the termination towards the offerer with the same value.\nbw-recv (NOTE 1)\nIf the br-recv parameter is contained in the SDP offer, the IMS-ALG shall check if the IMS-AGW supports the indicated sampling bandwidths, or a subset of them, in EVS primary mode in the send direction. If the indicated sampling bandwidths, and even each subset of them, are not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type, it shall forward the bw-recv parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the bw-send parameter is contained in the SDP offer, the IMS-ALG shall select a sampling bandwidths value, which is either the received bw-send value or a subset of it, based on IMS-AGW capabilities, possible configured policies, and the negotiated bw range of an EVS codec used before the access transfer, and the IMS-ALG shall include the bw-recv parameter with the selected value in the SDP answer.\nOtherwise, if the IMS-ALG desires a different sampling bandwidths for the send and receive direction in EVS primary mode, and wants to restrict the sampling bandwidths for the receive direction to match IMS-AGW capabilities, possible configured policies, and the negotiated bw range of the EVS codec used before the access transfer, the IMS-ALG shall supply the bw-recv parameter in the SDP answer it sends.\nOtherwise the IMS-ALG shall not include the bw-recv parameter in the SDP answer.\nIf the IMS-ALG also supplies the br or br-recv parameter, the value of the bw-recv parameter shall be compatible with the values of those parameters.\nIf the IMS-ALG supplies the bw-send parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\ncmr (NOTE 1)\nIf the cmr parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the cmr parameter is contained in the SDP offer, the IMS-ALG shall include the cmr parameter with unmodified value in the SDP answer.\nOtherwise, if the IMS-AGW desires to disable codec mode requests within the RTP payload of the EVS primary mode (due to the IMS-AGW capabilities, possible configured policies, and the negotiated CMR mode of an EVS codec used before the access transfer), it shall include the cmr parameter with value -1 in the SDP answer it sends.\nIf the IMS-ALG supplies the cmr parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nch-aw-recv (NOTE 1)\nIf the ch-aw-recv parameter is contained in the SDP offer the IMS-ALG shall check if the IMS-AGW supports the indicated mode in the send direction. If the indicated mode is not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the IMS-ALG it desires to control the channel-aware mode of EVS in the receive direction, e.g. to disable it with value -1, it shall include the ch-aw-recv parameter in the SDP offer and shall also supply the ch-aw-recv parameter to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value. The IMS-ALG shall consider the capabilities of the IMS-AGW and the negotiated ch-aw-recv mode of an EVS codec used before the access transfer when it chooses an appropriate value.\nnumber of channels (NOTE 2)\nIf the \"number of channels\" parameter is contained in the SDP offer the IMS-ALG shall check if the IMS-AGW supports the indicated number of channels. If the indicated number of channels is not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the \"number of channels\" parameter is contained in the SDP offer, the IMS-ALG shall include the \"number of channels\" parameter with unmodified value in the SDP answer and shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nch-send (NOTE 1)\nIf the ch-send parameter is contained in the SDP offer the IMS-ALG shall check if the IMS-AGW supports the indicated number of channels in the receive direction. If the indicated number of channels is not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward the ch-send parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the ch-recv parameter is contained in the SDP offer, the IMS-ALG shall include the ch-send parameter with unmodified value in the SDP answer and shall also supply the ch-send parameter to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nch-recv (NOTE 1)\nIf the ch-recv parameter is contained in the SDP offer the IMS-ALG shall check if the IMS-AGW supports the indicated number of channels in the send direction. If the indicated number of channels is not supported, the IMS-ALG shall not select the EVS payload type for transcoding. If the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward the ch-recv parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the ch-send parameter is contained in the SDP offer, the IMS-ALG shall include the ch-recv parameter with unmodified value in the SDP answer and shall also supply the ch-recv parameter to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmode-set (NOTE 3)\nIf the mode-set parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf the mode-set parameter is contained in the SDP offer, the IMS-ALG shall include the mode-set parameter with unmodified value in the SDP answer.\nOtherwise, if EVS or AMR-WB was used before the access transfer, the IMS-ALG should include the mode-set parameter with a value indicating the mode that was negotiated before the access transfer (or omit it if no restrictions applied before).\nIf the IMS-ALG supplies the mode-set parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmode-change-period (NOTE 3)\nIf the mode-change-period parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf EVS or AMR-WB was used before the access transfer, the IMS-ALG should include the mode-change-period parameter with a value indicating the mode that was negotiated before the access transfer (or omit it if no restrictions applied before).\nIf the IMS-ALG supplies the mode-change-period parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmode-change-capability (NOTE 3)\nIf the mode-change-capability parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG may forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nThe IMS-ALG shall either include the mode-change-capability parameter with a value 2 or omit the parameter.\nIf the IMS-ALG supplies the mode-change-capability parameter in the SDP answer, it may also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmode-change-neighbor (NOTE 3)\nIf the mode-change-neighbor parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nIf EVS or AMR-WB was used before the access transfer, the IMS-ALG should include the mode-change-neighbor parameter with a value indicating the mode that was negotiated before the access transfer (or omit it if no restrictions applied before).\nIf the IMS-ALG supplies the mode-change-neighbor parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\nmax-red (NOTE 5)\nIf the max-red parameter is contained in the SDP offer and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW for the termination towards the offerer in the remote descriptor.\nThe IMS-ALG shall only include the max-red parameter in the SDP answer if it desires to restrict the maximum redundancy of received packets. When selecting the value of the max-red parameter, the IMS-ALG shall consider the capabilities of the IMS-AGW and, if EVS or AMR-WB was used before the access transfer, the redundancy that was negotiated before the access transfer.\nIf the IMS-ALG supplies the max-red parameter in the SDP answer, it shall also supply it to the IMS-AGW in the local descriptor for the termination towards the offerer with the same value.\n3gpp_mtsi_app_adapt (NOTE 4)\nIf the 3gpp_mtsi_app_adapt parameter is contained in the SDP answer, and the IMS-ALG selects the EVS payload type for transcoding, the IMS-ALG shall forward this parameter to the IMS-AGW in the remote descriptor.\nIf the IMS-AGW supports RTCP APP based adaptation messages defined in 3GPP TS 26.114 [21], and the IMS-ALG has a policy to negotiate the usage of those messages, the IMS-ALG shall include the 3gpp_mtsi_app_adapt SDP attribute indicating the allowed APP messages in the SDP answer. If EVS was used before the access transfer, the IMS-ALG should consider the negotiated RTCP APP packet types in addition to the IMS AGW capabilities when selecting the allowed RTCP APP messages.\nNOTE 1:\tThis MIME parameter of the EVS RTP payload type is defined in 3GPP TS 26.445 [51]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 2:\tThis number of channels are encoded as \"encoding parameters\" of the SDP \"a=rtpmap\" attribute defined in IETF RFC 4566 [53].\nNOTE 3:\tThis MIME parameter of the EVS RTP payload type relates to AMR-WB IO mode and is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 4:\tThis SDP attribute is defined in 3GPP TS 26.114 [21]. It applies to all codecs offered in an SDP media line. However, some values are specific to EVS.\nNOTE 5:\tThis MIME parameter of the EVS RTP payload type is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.2.14.8.1",
        "table_6.2.14.8.2",
        "figure_6.2.14.3.1",
        "figure_6.2.14.4.1",
        "ts_26.114",
        "ts_26.445"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.14.9",
      "section_id": "6.2.14.9",
      "section_title": "IVAS speech codec support",
      "content": "For PS session origination, figure 6.2.14.3.1 shall apply with the IVAS parameter handling in table 6.2.14.9.1, assuming that IVAS is \"codec 1\", which is selected, and that \"codec 1\" related information is not signalled to the IMS-AGW(ATGW) at this stage. If no codec related information is signalled to the IMS-AGW at this stage, the IVAS related parameters for the terminations towards the SDP offerer and the SDP answerer shall be signalled towards the IMS-AGW during a PS to CS Access Transfer procedure.\nTable 6.2.14.9.1: IMS-ALG handling of IVAS related SDP parameters during PS session origination\nParameter\nHandling for IVAS payload type in SDP offer\nHandling if offered IVAS payload type is accepted in the SDP answer\nSince this table addresses the case where the IVAS payload received in the SDP offer is accepted in the SDP answer, no transcoding to and from IVAS is required upon the PS session origination and these parameters need not be signaled to the IMS-AGW. They shall be signaled towards the IMS-AGW for the terminations towards the SDP offerer and SDP answerer during a PS to CS Access Transfer procedure, if IVAS was used before the PS to CS access transfer and if transcoding to and from IVAS is supported and required upon the PS to CS access transfer.\nivas-mode-switch\n(NOTE 2)\nIf the parameter is contained in the SDP offer, the IMS-ALG shall retain the parameter in the SDP offer it forwards. The IMS-ALG may modify the value of the parameter to match with the IMS-AGW capabilities, if transcoding to and from IVAS is supported by the IMS-ALG and IMS-AGW and it is expected that such a transcoding may be required later on.\nIf this parameter is contained in the SDP answer, the IMS-ALG shall retain this parameter in the SDP answer it forwards.\nevs-mode-switch (NOTE 1)\nhf-only (NOTE 1)\ndtx (NOTE 1)\ndtx-recv (NOTE 1)\nbr (NOTE 1)\nbr-send (NOTE 1)\nbr-recv (NOTE 1)\nbw (NOTE 1)\nbw-send (NOTE 1)\nbw-recv (NOTE 1)\ncmr (NOTE 2)\nch-aw-recv (NOTE 1)\nmode-set (NOTE 3)\nmode-change-period (NOTE 3)\nmode-change-capability (NOTE 3)\nmode-change-neighbor (NOTE 3)\nmax-red (NOTE 5)\n3gpp_mtsi_app_adapt (NOTE 4)\nibr (NOTE 2)\nibr-send\n(NOTE 2)\nibr-recv (NOTE 2)\nibw (NOTE 2)\nibw-send (NOTE 2)\nibw-recv (NOTE 2)\ncf (NOTE 2)\ncf-send (NOTE 2)\ncf-recv (NOTE 2)\npi-types (NOTE 2)\npi-types-send (NOTE 2)\npi-types-recv (NOTE 2)\npi-br (NOTE 2)\npi-br-send (NOTE 2)\npi-br-recv (NOTE 2)\nNOTE 1:\tThis MIME parameter of the IVAS RTP payload type is defined in 3GPP TS 26.445 [51]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 2:\tThis MIME parameter of the IVAS RTP payload type is defined in 3GPP TS 26.253 [87]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 3:\tThis MIME parameter of the IVAS RTP payload type relates to AMR-WB IO mode and is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE 4:\tThis SDP attribute is defined in 3GPP TS 26.114 [21]. It applies to all codecs offered in an SDP media line. However, some values are specific to IVAS.\nNOTE 5:\tThis MIME parameter of the IVAS RTP payload type is defined in IETF RFC 4867 [54]. It is encapsulated within the SDP \"a=fmtp\" attribute defined IETF RFC 4566 [53].\nNOTE:\tDuring the PS to CS Access Transfer procedure, the IMS-ALG is not expected to receive an IVAS codec payload type in the SDP offer from the MSC Server.",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.2.14.9.1",
        "figure_6.2.14.3.1",
        "ts_26.445",
        "ts_26.253",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.15.1",
      "section_id": "6.2.15.1",
      "section_title": "General",
      "content": "The IMS-ALG and IMS-AGW may support the priority treatment of a call/session identified as an MPS call/session. This clause describes the Iq signalling procedures and their interactions with SIP signalling in the control plane and with user plane procedures to support the requirements for Multimedia Priority Service. These Iq signalling procedures may or may not apply depending on the network configuration (e.g. whether the IMS-AGW is shared by multiple IMS-ALGs or whether the IMS-ALG controls multiple IMS-AGWs for a given route – Media Gateway Group).\nThe IMS-ALG can receive a SIP INVITE with MPS priority information (see 3GPP TS 23.228 [2], clause 5.21).",
      "chunk_type": "definition",
      "cross_references": [
        "ts_23.228_clause_5.21",
        "ts_23.228"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.15.2",
      "section_id": "6.2.15.2",
      "section_title": "IMS-AGW Resource Congestion in ADD response, request is queued",
      "content": "If the IMS-ALG requests a resource via the procedure Reserve and Configure AGW Connection Point or Reserve AGW Connection Point and receives an error indicating that the requested resource could not be seized (e.g. H.248 error code  #510 \"insufficient resources\") and the IMS-ALG does not have alternative IMS-AGW through which it can route the call it queues the priority session and gives it priority over any further Reserve and Configure AGW Connection Point or Reserve AGW Connection Point procedures for lower priority sessions towards this IMS-AGW until the requested resource for this queued session is successful seized. The example sequence is shown in Figure 6.2.15.2.1.\nFigure 6.2.15.2.1: Request to reserve IMS-AGW MPS Priority call resources when IMS-AGW is congested",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.15.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.15.3",
      "section_id": "6.2.15.3",
      "section_title": "IMS-AGW Resource Congestion in ADD response, IMS-ALG seizes new IMS-AGW",
      "content": "If the IMS-ALG requests a resource via the procedure Reserve and Configure AGW Connection Point or Reserve AGW Connection Point and receives an error indicating that the requested resources could not be seized (e.g. H.248 error code  #510 \"insufficient resources\") and Media Gateway Groups are implemented it should seize a new IMS-AGW from the same Media Gateway Group before resorting to any queuing of the priority session (as described in 6.2.15.2) to enable the MPS call/session to proceed as early as possible.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_6.2.15.4",
      "section_id": "6.2.15.4",
      "section_title": "IMS-AGW Priority Resource Allocation",
      "content": "If the IMS-AGW supports the Priority information (e.g. determined through provisioning or package profile) the IMS-ALG requests a resource via the procedure Reserve and Configure AGW Connection Point or Reserve AGW Connection Point and includes the Priority information. The IMS-AGW may then provide priority allocation of resources once a congestion threshold is reached. If the IMS-AGW is completely congested it shall indicate this to the IMS-ALG as described in 6.2.15.2. The example sequence is shown in Figure 6.2.15.4.1.\nFigure 6.2.15.4.1: Request to reserve IMS-AGW MPS Priority call resources when IMS-AGW is congested, priority resources are allocated",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.15.4.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.15.5",
      "section_id": "6.2.15.5",
      "section_title": "IMS-AGW Priority User Data marking",
      "content": "The IMS-ALG may request the streams associated to an MPS Priority Call to be marked with certain priority code point as described in clause 6.2.7. The IMS-AGW shall then mark each IP packet header accordingly. The example sequence is shown in Figure 6.2.15.5.1.\nFigure 6.2.15.5.1: Request to reserve IMS-AGW call resources and apply DCSP marking for MPS\nThe IMS-AGW may also provide priority allocation for resources requested via a subsequent Configure AGW Connection Point procedure not including Priority information if the related context has been marked with priority information during the Reserve AGW Connection Point or Reserve and Configure AGW Connection Point procedure.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.2.7",
        "figure_6.2.15.5.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.15.6",
      "section_id": "6.2.15.6",
      "section_title": "IMS-AGW Priority Modification",
      "content": "If the IMS-ALG seized an IP termination for a priority call/session with a default priority and subsequently needs to modify the priority information previously communicated to the IMS-AGW (e.g. subject to subsequent authorisation by an authorisation point, see 3GPP TS 24.229 [11] clause 4.11), the IMS-ALG may modify the existing IP termination for the MPS call/session with the actual priority and, if DiffServ is used, provision a suitable DSCP marking for the updated MPS priority level to the IMS-AGW via the Configure AGW Connection Point Procedure.\nNOTE:\tThe specific Iq related call sequence which details the handling to support the requirements defined in 3GPP TS 24.229 [11], clause 4.11 and 3GPP TS 23.228 [2], clause 5.21 is not specified, and therefore implementations might exist which fulfil these requirements but do not require modification of the priority information across the Iq interface.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.229_clause_4.11",
        "ts_23.228_clause_5.21",
        "ts_24.229",
        "ts_23.228"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.16",
      "section_id": "6.2.16",
      "section_title": "Coordination of Video Orientation",
      "content": "Figure 6.2.16.1 shows the message sequence chart example for indicating extended RTP header for Coordination of Video Orientation.\nFigure 6.2.16.1: Procedure to indicate RTP extension header for CVO\nThis procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally requesting the IMS-AGW to support the RTP Header Extension capability as defined in IETF RFC 5285 [23].\nNOTE:\tIf the IMS-ALG receives an SDP answer, which includes the \"a=extmap\" attribute with a CVO URN with a granularity that the IMS-AGW has not included in its response, or if the SDP answer does not include any \"a=extmap\" CVO related attribute, it is not necessary to modify the IMS-AGW settings for this reason alone. Doing that would only add unnecessary signalling without requiring any action or changes in the IMS-AGW. However, if the IMS-ALG needs to modify the media attributes for other purposes, in particular due to transcoding, then the IMS-AGW is updated in accordance with the received SDP answer, that is, either with the received CVO related \"a=extmap\" attribute if present in the received SDP answer or without it if not included in the received SDP answer (thus removing the requirement for supporting \"a=extmap\" and for sending the header and CVO bits for the transcoded stream).",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.16.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.17.1",
      "section_id": "6.2.17.1",
      "section_title": "ICE lite",
      "content": "Figure 6.2.17.1.1 shows a message sequence chart example for performing the ICE lite procedure towards the offerer.\nFigure 6.2.17.1.1: Procedure for interactive connectivity establishment using ICE lite towards the offerer",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.17.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.17.2",
      "section_id": "6.2.17.2",
      "section_title": "Full ICE",
      "content": "Figure 6.2.17.2.1 shows a message sequence chart example for performing the full ICE procedure towards the offerer.\nFigure 6.2.17.2.1: Procedure for interactive connectivity establishment using full ICE towards the offerer",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.17.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.17.3",
      "section_id": "6.2.17.3",
      "section_title": "Connectivity check result notification (full ICE)",
      "content": "Figure 6.2.17.3.1 shows the message sequence chart example for an ICE connectivity check result Event.\nFigure 6.2.17.3.1: Procedure to report ICE connectivity check result",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.17.3.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.17.4",
      "section_id": "6.2.17.4",
      "section_title": "New peer reflexive candidate notification (full ICE)",
      "content": "Figure 6.2.17.4.1 shows the message sequence chart example for additional connectivity check when new peer reflexive candidate is discovered in full ICE.\nFigure 6.2.17.4.1: Procedure to perform additional connectivity check upon the report of new peer reflexive candidate",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.17.4.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.17.5",
      "section_id": "6.2.17.5",
      "section_title": "STUN consent freshness test",
      "content": "Figure 6.2.17.5.1 shows a message sequence chart example for requesting the STUN consent freshness test procedure towards the offerer when full ICE is supported by the eIMS-AGW.\nFigure 6.2.17.5.1: Procedure for STUN consent freshness test towards the offerer",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.17.5.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.17.6",
      "section_id": "6.2.17.6",
      "section_title": "STUN Consent Freshness Test Failure Notification",
      "content": "Figure 6.2.17.6.1 shows the message sequence chart example for an ICE STUN consent freshness test failure Event.\nFigure 6.2.17.6.1: Procedure to report STUN consent freshness test failure",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.17.6.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.18.1",
      "section_id": "6.2.18.1",
      "section_title": "General",
      "content": "All message sequence charts in this clause are examples. The H.248 context model is defined in Figure 6.2.1.1.",
      "chunk_type": "definition",
      "cross_references": [
        "figure_6.2.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.18.2",
      "section_id": "6.2.18.2",
      "section_title": "Stateless TCP handling",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG and IMS-AGW applying the requirements specified in clause 5.16.1.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "clause_5.16.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.18.3",
      "section_id": "6.2.18.3",
      "section_title": "State-aware TCP handling without support of modifying the TCP setup direction",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG and IMS-AGW applying the requirements specified in clause 5.16.2.2.\nClause 6.2.10.3.1 provides example call flows for TCP bearer connection establishment without modyfing the TCP setup direction.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "clause_5.16.2.2",
        "clause_6.2.10.3.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.18.4",
      "section_id": "6.2.18.4",
      "section_title": "State-aware TCP handling with support of modifying the TCP setup direction",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG and IMS-AGW applying the requirements specified in clause 5.16.2.3.\nFigure 6.2.18.4.1 shows an example call flow for a terminating session set-up procedure, where the IMS-ALG receives an incoming SDP offer containing media line for a new MSRP media stream with an \"a=setup:active\" SDP attribute towards a served UE located behind a remote NAT.\nFigure 6.2.18.4.1: Terminating example call flow for MSRP between UEs located behind NAT\nThe IMS UE B performs an IMS terminating session set-up according to 3GPP TS 23.228 [2], with modifications as described in 3GPP TS 33.328 [12].\nThe procedure in the above figure is described step-by-step with an emphasis on the additional aspects for IMS-ALG and IMS-AGW of TCP bearer connection control.\n1.\tThe P‑CSCF (IMS‑ALG) receives an SDP offer for an MSRP media stream with an \"a=setup:active\" attribute. For the MSRP media stream offered with transport \"TCP/MSRP\", the P‑CSCF (IMS‑ALG) allocates the required resources, includes the IMS‑AGW in the media path and proceeds as specified in this clause.\n2.-4.\tThe IMS-ALG uses the \"Reserve AGW Connection Point\" procedure to request a termination for \"TCP\" media (for application-agnostic interworking) or \"TCP/MSRP\" media (for application-aware interworking) towards the access network. The IMS-ALG preconfigures the IMS-AGW to operate in TCP merge mode by providing the \"a=setup:passive\" attribute.\n5.-7.\tThe IMS-ALG uses the \"Reserve And Configure AGW Connection Point\" procedure to request a termination for \"TCP\" media (for application-agnostic interworking) or \"TCP/ MSRP\" media (for application-aware interworking) towards the core network. The IMS-ALG preconfigures the IMS-AGW to operate in TCP Merge mode by providing the \"a=setup:passive\" attribute.\n8.\tThe P‑CSCF (IMS‑ALG) changes the \"a=setup\" SDP attribute to \"actpass\" in the SDP offer and inserts the address information received from the IMS-AGW.\n9.\tThe P‑CSCF (IMS‑ALG) forwards the SDP offer.\n10.\tThe UE B chooses to become the active party in the TCP connection establishment and sends a TCP SYN to establish the TCP connection. If the P-CSCF (IMS-ALG) indicated to the IMS-AGW at step 2 that it shall ignore any incoming TCP connection establishment requests (TCP SYN), e.g. to enable a remote source transport address filtering, or if the P-CSCF (IMS-ALG) did not indicate to the IMS-AGW at step 2 that it shall latch onto the required destination address via the source address/port of the incoming media, the IMS-AGW shall drop the TCP SYN received from the UE. If the TCP SYN is not answered before a timer expiry, the UE will send the TCP SYN a second time (step 10').\n11.\tThe P‑CSCF (IMS‑ALG) receives the SDP answer. It contains the SDP answer with an \"a=setup:active\" attribute.\n12.-14.\tThe IMS-ALG uses the \"Configure AGW Connection Point\" procedure to configure the termination towards the UE B with remote address information.\n15.\tThe P‑CSCF (IMS‑ALG) modifies the SDP answer before sending it to the core network. The P‑CSCF (IMS‑ALG) sets the \"a=setup:passive\" SDP attribute.\n16.\tThe P-CSCF (IMA-ALG) then sends the updated SDP answer to core network.\n17. The IMS-AGW answers the TCP SYN and the remote peer completes the TCP connection establishment.\n18.\tThe IMS-AGW answers the TCP SYN and UE B completes the TCP connection establishment.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "clause_5.16.2.3",
        "figure_6.2.18.4.1",
        "ts_23.228",
        "ts_33.328"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.19",
      "section_id": "6.2.19",
      "section_title": "Application-aware MSRP interworking at the IMS-AGW",
      "content": "This procedure is identical to that of clause 6.2.1 apart from the IMS-ALG:\n-\tindicating \"TCP/MSRP\" or \"TCP/TLS/MSRP\" (if e2ae media security is applied) as transport protocol to the IMS‑AGW;\n-\tconfiguring the IMS-AGW to apply application-aware MSRP interworking; and\n-\tproviding the SDP \"a=path\" attribute, as received in SIP/SDP signalling, to the IMS‑AGW as \"MSRP Path\" with the remote descriptor of the corresponding call leg.\nThe IMS‑AGW applies application-aware MSRP interworking if being instructed from the IMS-ALG. Support of dynamic instructions from the IMS-ALG is optional.\nIf the IMS-AGW applies application-aware MSRP interworking, it modifies the MSRP \"To-Path\" header field in MSRP packets by replacing the IP address and TCP port of the only entry with the corresponding information in the \"MSRP path\" provided by the IMS_ALG while retaining the MSRP session ID part of the entry as received in the MSRP \"To-Path\" and then forward the MSRP data without further modification.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.20",
      "section_id": "6.2.20",
      "section_title": "Alternate Connection (ALTC) Addresses Management",
      "content": "Figure 6.2.20.1 shows a message sequence chart example for a terminating session setup with a dual stack UE using the SDP attributes \"altc\" inserted by the IMS-ALG in the SDP offer to indicate the IP addresses for potential alternative connection addresses.\nFigure 6.2.20.1: Terminating session setup with insertion of the SDP attribute \"altc\" by the IMS-ALG\nUpon receipt of a session initiation request, the IMS-ALG shall extract the offerer's destination network address(es) and port number(s) from the SDP offer received from the calling party endpoint. Based on local policies, the IMS-ALG may decide to provide an alternative IP address and to insert then \"altc\" attributes in the SDP offer sent to the terminating side. The IMS-ALG shall then request the IMS-AGW to allocate transport resources for the terminating side (e.g. terminations T2 for IPv6 and T3 for IPv4) via two Reserve AGW Connection Point procedures, one per address type.\nNOTE:\tThe IMS-AGW is \"ALTC agnostic\" and does not have any awareness about preferred and alternate IP connection resources as described in the in IETF RFC 6947 [59]. Moreover, there is not any context-internal topology between terminations T1, T2 and T3 (via the H.248 topology descriptor) defined: T1 is either implicitly interlinked with T2 or T3 dependent on the used H.248 Stream identifier values. However, such aspects are ignored due to the expected short-term aspects of the temporary context configuration with three terminations.\nBased on the responses received from the IMS-AGW, the IMS-ALG shall modify the offerer's destination addresses and/or ports initially contained in the SDP offer, insert the \"altc\" SDP attributes carrying the preferred and alternate IP addresses and propagate the session establishment toward the terminating party.\nOn receipt of the SDP answer of the called party endpoint, the IMS-ALG shall pass the IP address, port and address type chosen by the called party endpoint for the session to the IMS-AGW in the Configure AGW Connection Point procedure and shall request the IMS-AGW to allocate transport resources (T1) for the calling party endpoint via the Reserve and Configure AGW Connection Point. Upon receiving the response from the IMS-AGW, the IMS-ALG shall modify the answerer's destination address(es) and/or port(s) contained in the application SDP answer and pass the information to the calling party endpoint. The IMS-ALG shall also request the IMS-AGW to release the transport resources (e.g. termination T3 with IPv4) reserved for the unused address type via the Release AGW Termination procedure.",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.2.20.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.21.1",
      "section_id": "6.2.21.1",
      "section_title": "Video Region-of-Interest (ROI) using FECC",
      "content": "Figure 6.2.21.1.1 shows the message sequence chart example for indicating Video Region-of-Interest (ROI) using FECC.\nFigure 6.2.21.1.1: Procedure to indicate Video ROI using FECC\nThis procedure is identical to that of clause 6.2.1.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.21.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.21.2",
      "section_id": "6.2.21.2",
      "section_title": "\"Predefined ROI\" mode",
      "content": "Figure 6.2.21.2.1 shows the message sequence chart example for indicating Predefined ROI mode.\nFigure 6.2.21.2.1: Procedure to indicate Predefined ROI mode\nThis procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally requesting the IMS-AGW to support the RTCP feedback message capability for \"Predefined ROI\" type expressed by the parameter \"3gpp-roi-predefined\", as described in 3GPP TS 26.114 [21], and the RTP Header Extension capability for carriage of predefined ROI information as defined in IETF RFC 5285 [23] and 3GPP TS 26.114 [21].",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.21.2.1",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.21.3",
      "section_id": "6.2.21.3",
      "section_title": "\"Arbitrary ROI\" mode",
      "content": "Figure 6.2.21.3.1 shows the message sequence chart example for indicating Arbitrary ROI mode.\nFigure 6.2.21.3.1: Procedure to indicate Arbitrary ROI mode\nThis procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally requesting the IMS-AGW to support the RTCP feedback message capability for \"Arbitrary ROI\" type expressed by the parameter \"3gpp-roi-arbitrary\", as described in 3GPP TS 26.114 [21], and the RTP Header Extension capability for carriage of arbitrary ROI information as defined in IETF RFC 5285 [23] and 3GPP TS 26.114 [21].",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.21.3.1",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.22.1",
      "section_id": "6.2.22.1",
      "section_title": "Establishment of a WebRTC data channel",
      "content": "See clause 6.2.10.6.2.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.10.6.2"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.22.2",
      "section_id": "6.2.22.2",
      "section_title": "Release of a WebRTC data channel",
      "content": "The H.248 Context model for a WebRTC call in figure 6.2.10.6.2.1 is assumed. However, the example flow in this clause focuses on the WebRTC data channel part only. Thus, only H.248 Streams S1 (for de-aggregation of multiple data channels) and S2 (for MSRP traffic) are indicated subsequently.\nFigure 6.2.22.2.1 shows the message sequence chart example for the WIC originated procedure to release a WebRTC MSRP data channel following the procedures in clause 5.20.2.3.2.\nFigure 6.2.22.2.1: Call flow for the Release of a single WebRTC data channel\nNOTE:\tSteps 9, 10, 13 and 14: A data channel is constituted by a pair of unidirectional SCTP Streams (with the same SCTP Stream identifier value in above flow). The SCTP Outgoing SSN Reset Request procedure does reset a single SCTP Stream only (due to the configuration in this example), hence the procedure will be executed twice (towards and from remote WIC).",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.20.2.3.2",
        "figure_6.2.10.6.2.1",
        "figure_6.2.22.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.22.3.1",
      "section_id": "6.2.22.3.1",
      "section_title": "Media Plane Optimization including DTLS layer for WIC originating call",
      "content": "The H.248 Context model for a WebRTC call in figure 6.2.10.6.2.1 is assumed. However, the example flow in this clause focuses on the WebRTC data channel part only. Thus, only H.248 Streams S1 (for de-aggregation of multiple data channels) and S2 (for MSRP traffic) are indicated subsequently.\nFigure 6.2.22.3.1.1 shows the message sequence chart example for the WIC originated procedure to establish a WebRTC data channel with media plane optimization following the procedures in clause 5.20.3.2.\nNOTE:\tMessage 16 (DTLS ClientHello) can be received by the eIMS-AGW from the remote peer before the eIMS-AGW is configured to pass it (in steps 8.-13.) and will then be dropped by the eIMS-AGW. However, the remote peer will then resend message 16 after a timeout while waiting for a response.\nFigure 6.2.22.3.1.1: WIC originated procedure for WebRTC data channel establishment with media plane optimization including DTLS layer",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.20.3.2",
        "figure_6.2.10.6.2.1",
        "figure_6.2.22.3.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.22.3.2",
      "section_id": "6.2.22.3.2",
      "section_title": "Media Plane Optimization excluding DTLS layer for WIC originating call",
      "content": "The H.248 Context model for a WebRTC call in figure 6.2.10.6.2.1 is assumed. However, the example flow in this clause focuses on the WebRTC data channel part only. Thus, only H.248 Streams S1 (for de-aggregation of multiple data channels) and S2 (for MSRP traffic) are indicated subsequently. Furthermore, there is an additional termination T3 towards the IMS core network to handle DTLS.\nFigure 6.2.22.3.2.1 shows the message sequence chart example for the WIC originated procedure to establish a WebRTC data channel with media plane optimization following the procedures in clause 5.20.3.2.\nFigure 6.2.22.3.2.1: WIC originated procedure for WebRTC data channel establishment with media plane optimization excluding DTLS layer",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.20.3.2",
        "figure_6.2.10.6.2.1",
        "figure_6.2.22.3.2.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.23",
      "section_id": "6.2.23",
      "section_title": "RTP-level pause and resume",
      "content": "Figure 6.2.23.1 shows the message sequence chart example for indicating RTP-level pause and resume.\nFigure 6.2.23.1: Procedure to indicate RTP-level pause and resume\nThis procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally requesting the IMS-AGW to transparently forward the RTCP \"CCM PAUSE\" packets (as defined in IETF RFC 7728 [79]) between incoming and outgoing network.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.23.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.24",
      "section_id": "6.2.24",
      "section_title": "RTCP Codec Control Commands and Indications",
      "content": "Figure 6.2.24.1 shows the message sequence chart example for indicating \"RTCP Codec Control Commands and Indications\".\nFigure 6.2.24.1: Procedure to indicate RTCP Codec Control Commands and Indications\nThis procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally indicates that the IMS-AGW shall be prepared to receive and is allowed to send the RTCP CCM \"FIR\" and/or \"TMMBR/TMMBN\" feedback messages (as defined in IETF RFC 5104 [78]).",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.24.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_6.2.25",
      "section_id": "6.2.25",
      "section_title": "Delay Budget Information (DBI)",
      "content": "Figure 6.2.25.1 shows a message sequence chart example for indicating DBI.\nFigure 6.2.25.1: Procedure to indicate DBI\nThis procedure is identical to that of clause 6.2.1 apart from the IMS-ALG optionally requesting the IMS-AGW to transparently forward the RTCP feedback DBI packets (as defined in 3GPP TS 26.114 [21]) between incoming and outgoing network.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.1",
        "figure_6.2.25.1",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_7",
      "section_id": "7",
      "section_title": "Charging",
      "content": "The charging is specified in 3GPP TS 32.260 [5]. No requirements are identified for the Iq interface.",
      "chunk_type": "general",
      "cross_references": [
        "ts_32.260"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.1",
      "section_id": "8.1",
      "section_title": "General",
      "content": "This clause describes logical signalling procedures between the IMS-ALG and IMS-AGW. The procedures within this clause are intended to be implemented using the standard H.248 procedure as defined in ITU recommendation H.248.1 [9] with appropriate parameter combinations.\nNOTE:\tWhenever the stage 2 description is referring to a \"(stage 2) information element\", then there is the premise of a one-to-one mapping to a stage 3 signalling element.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.334_8.2",
      "section_id": "8.2",
      "section_title": "Reserve and Configure AGW Connection Point",
      "content": "This procedure is used to reserve multimedia-processing resources for the Iq interface connection.\nTable 8.2.1: Procedures between IMS-ALG and IMS-AGW: Reserve and Configure AGW Connection Point\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nReserve and Configure AGW Connection Point\nIMS-ALG\nContext/Context Request\nM\nThis information element indicates the existing context or requests a new context for the bearer termination.\nEmergency Call Indicator\nO\nThis information element identifies the call as emergency call that requires a preferential handling.\nPriority information\nO\nThis information element requests the IMS-AGW to apply priority treatment for the terminations and bearer connections in the specified context.\nBearer Termination Request\nM\nThis information element indicates the existing bearer termination or requests a new bearer termination for the bearer to be established.\nLocal IP Resources\nO\nThis information element indicates the resource(s) for which the IMS-AGW shall be prepared to receive user data. May be excluded (i.e. \"-\" is used in SDP m-line) if no transcoding or media related functions are required.\nFor terminations supporting any combination of video, audio and messaging this IE shall contain separate resources per stream.\nReserveValue\nO\nThis information element indicates if multiple local resources are to be reserved.\nThis information element shall be included if a speech codec and auxiliary payload types are configured.\nRemote IP Resources\nO\nThis information element indicates the resource(s) for which the IMS-AGW shall send data.\nFor terminations supporting any combination of video, audio and messaging this IE shall contain separate resources per stream.\nMay be excluded (i.e. \"-\" is used in SDP m-line) if no transcoding or media related functions are required.\nLocal Connection Address Request\nM\nThis information element requests an IP address and port number(s) on the IMS-AGW that the remote end can send user plane data to.\nFor terminations supporting any combination of video, audio and messaging this may contain multiple addresses.\nRemote Connection Address\nM\nThis information element indicates the remote IP address and port number(s) that the IMS-AGW can send user plane data to.\nFor terminations supporting any combination of video, audio and messaging this may contain multiple addresses.\nNotify termination heartbeat\nM\nThis information element requests termination heartbeat indications. This information element shall be included when requesting a new bearer termination. Otherwise the information element is optional.\nNotify Released Bearer\nO\nThis information element requests a notification of a released bearer.\nLatching Requirement\nO\nThis information element indicates that the IMS-AGW should (re)latch onto the address of received media packets to determine the corresponding destination address.\nIP Realm Identifier\nO\nThis information element indicates the IP realm of the bearer termination.\nRemote Source Address Filtering\nO\nThis information element indicates that remote source address filtering is required.\nRemote Source Address Mask\nC\nThis information element provides information on the valid remote source addresses. This is required if a range of remote source address filtering is required.\nRemote Source Port Filtering\nO\nThis information element indicates that remote source port filtering is required.\nRemote Source Port\nC\nThis information element identifies the valid remote source port. This may be included if remote source port filtering is included. (NOTE 1)\nRemote Source Port Range\nC\nThis information element identifies a range of valid remote source ports. This may be included if remote source port filtering is included. (NOTE 1)\nTraffic Policing Required\nO\nThis information element indicates that policing of the media flow is required.\nPeak Data Rate\nO\nThis information element may be present if Policing is required and specifies the permissible peak data rate  for a media stream. (NOTE 2)..\nSustainable Data Rate\nO\nThis information element may be present if Policing is required and specifies the permissible sustainable data rate for a media stream. (NOTE 2).\nDelay Variation Tolerance\nO\nThis information element may be present if Policing on Peak Data Rate is required and specifies the maximum expected delay variation tolerance for the corresponding media stream.\nMaximum Burst Size\nC\nThis information element shall be present if Policing on Sustainable Data Rate is required and specifies the maximum expected burst size for the corresponding media stream.\nDiffServ Code Point\nO\nThis information element indicates a specific DiffServ code point to be used in the IP header in packets sent on the bearer termination.\nDiffServ Tagging Behaviour\nO\nThis information element indicates whether the Diffserv code point in the IP header in packets sent on the bearer termination shall be copied from the received value or set to a specific value.\nMedia Inactivity Detection Required\nO\nThis information element indicates that detection of inactive media flows is required.\nMedia Inactivity Detection Time\nC\nThis information element may be present if Inactive Media Detection is required and specifies the Inactivity Detection time.\nMedia Inactivity Detection Direction\nC\nThis information element may be present if Inactive Media Detection is required and specifies the Inactivity Detection direction.\nRTCP handling\nO\nThis information element is present if IMS-ALG wants to explicitly control the reservation of RTCP resources (NOTE 4).\nRTP/RTCP transport multiplexing\nC\nThis information element requests the IMS-AGW to apply the RTP/RTCP transport multiplexing. This information element may only be present if RTCP handling is required.\nExplicit RTCP transport address\nC\nThis information element indicates the remote RTCP port and optionally the remote network address where to send RTCP packets. This information element may only be present if RTCP handling is required.\nLocal cryptographic SDES attribute\nC\nThis information element is present if IMS-ALG wants that the media is encrypted and/or integrity protected by the IMS-AGW (NOTE 3). It indicates the SDES local cryptographic parameters such as key(s)\nRemote cryptographic SDES attribute\nC\nThis information element is present if IMS-ALG wants that the media is decrypted, and/or integrity checked by the IMS-AGW (NOTE 3). It indicates the SDES remote cryptographic parameters such as key(s)\nECN Enable\nO\nThis information element requests the IMS-AGW to apply ECN procedures.\nECN Initiation Method\nC\nThis information element specifies the ECN Initiation method and requests the IMS-AGW to perform IP header settings as an ECN endpoint, or indicates that ECN bits shall be passed transparently. It may be included only if ECN is enabled.\nNotify ECN Failure Event\nC\nThis information element requests a notification if a ECN failure occurs due to ECN. It may only be supplied if ECN is enabled and the IMS-AGW acts as ECN endpoint.\nExtended RTP Header for CVO\nO\nThis information element requests the IMS-AGW to pass on the CVO extended RTP header as defined by IETF RFC 5285 [23].\nExtended RTP Header for Sent ROI\nO\nThis information element requests the IMS-AGW to pass on the ROI extended RTP header for carriage of predefined and/or arbitrary ROI information as defined by IETF RFC 5285 [23] and 3GPP TS 26.114 [21].\nPredefined ROI\nO\nThis information element requests the IMS-AGW to support the RTCP feedback message capability for \"Predefined ROI\" type expressed by the parameter \"3gpp-roi-predefined\", as described in 3GPP TS 26.114 [21].\nArbitrary ROI\nO\nThis information element requests the IMS-AGW to support the RTCP feedback message capability for \"Arbitrary ROI\" type expressed by the parameter \"3gpp-roi-arbitrary\", as described in 3GPP TS 26.114 [21].\nGeneric Image Attributes\nO\nThis information element indicates image attributes (e.g. image size) as defined by IETF RFC 6236 [24].\nLocal certificate fingerprint Request\nO\nThis information element is present if the IMS-ALG wants that the media is decrypted, and/or integrity protected by the IMS-AGW (NOTE 3). It requests the IMS-AGW to provide a local certificate fingerprint.\nRemote certificate fingerprint\nO\nThis information element is present if the IMS-ALG wants that the media is decrypted, and/or integrity checked by the IMS-AGW (NOTE 3). It indicates the remote certificate fingerprint.\nEstablish (D)TLS session\nO\nThis information element requests the IMS-AGW to take the (D)TLS client role and to initiate the establishment of the (D)TLS session. (NOTE 3)\nNotify (D)TLS session establishment Failure Event\nO\nThis information element requests a notification if a (D)TLS session establishment failure occurs. (NOTE 3)\nTCP State-aware Handling Indicator and Setup Direction\nC\nThis information element indicates that TCP state-aware handing is required and indicates the TCP setup direction. It may only be included if the IMS‑AGW supports TCP state-aware handling.\nDiscard Incoming TCP Connection Establishment Requests Indicator\nC\nThis information element indicates whether incoming TCP connection establishment requests (TCP SYN) shall be discarded. It may only be included if the IMS‑AGW supports TCP state-aware handling and discarding incoming TCP connection establishment requests.\nForward Incoming TCP Connection Establishment Requests Indicator\nC\nThis information element indicates for a given termination to use the incoming TCP connection establishment request (TCP SYN) at that termination as a trigger for sending a TCP connection establishment request at the interconnected termination in the same context. It may only be included if the IMS‑AGW supports TCP state-aware handling and the Forward Incoming TCP Connection Establishment Requests Indicator.\nNotify TCP Connection Establishment Failure Event\nC\nThis information element requests a notification if a TCP connection establishment failure occurs. It may only be included if the IMS‑AGW supports TCP state-aware handling.\nSTUN server request\nO\nThis information element is present if IMS-ALG requests the IMS-AGW to answer STUN connectivity checks for ICE.\nICE Connectivity Check\nC\nThis information element requests the IMS-AGW to perform ICE connectivity check as defined by IETF RFC 8445 [82]. It is only applicable for full ICE.\nNotify ICE Connectivity Check Result\nC\nThis information element requests a notification of ICE connectivity check result. It is only applicable for full ICE.\nNotify New Peer Reflexive Candidate\nC\nThis information element requests a notification of new peer reflexive candidate was discovered during a connectivity check. It is only applicable for full ICE.\nICE password request\nO\nThis information element is present if IMS-ALG requests an ICE password.\nICE Ufrag request\nO\nThis information element is present if IMS-ALG requests an ICE ufrag.\nICE host candidate request\nO\nThis information element is present if IMS-ALG requests an ICE host candidate.\nICE pacing request\nO\nThis information element is present if IMS-ALG requests a pacing value for connectivity checks (Ta timer value). It is only applicable for full ICE.\nICE received candidate\nO\nThis information element is present if IMS-ALG indicates a received candidate for ICE.\nICE received password\nO\nThis information element is present if IMS-ALG indicates a received password for ICE.\nICE received Ufrag\nO\nThis information element is present if IMS-ALG indicates a received Ufrag for ICE.\nICE received pacing\nO\nThis information element is present if IMS-ALG indicates a received pacing value for connectivity checks (Ta timer value). It is only applicable for full ICE. It is only applicable for full ICE.\nMSRP Path\nO\nThis information element is present for application-aware MSRP Interworking. It provides the path information that the IMS-AGW shall insert in the MSRP layer \"To‑Path\" Information element.\nApplication-aware MSRP interworking request\nO\nThis information element is present if IMS-ALG requests the IMS-AGW to perform application-aware MSRP Interworking.\nNotify STUN consent freshness test failure Event\nO\nThis information element requests a notification if a STUN consent freshness test failure occurs (full ICE only).\nSTUN consent freshenss test request\nO\nThis information element is present if eP-CSCF requests the eIMS-AGW to perform a STUN consent freshness test (full ICE only).\nLocal SCTP Port Request\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It requests the IMS-AGW to provide a local SCTP Port.\nRemote SCTP Port\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It indicates the remote SCTP port.\nLocal SCTP maximum message size Request\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It requests the IMS-AGW to provide a local max message size.\nRemote SCTP maximum message size\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It indicates the remote max message size.\nSCTP Group Semantics\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It indicates the H.248 component streams that are grouped in the same SCTP association.\nSCTP stream deaggregation\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It indicates the H.248 component streams that transport media that are to be deaggregated from the H.248 deaggregation stream used to control the SCTP association.\nSCTP stream ID\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an WEBRTC data channel. It indicates the SCTP stream ID to be used for that data channel.\nLocal Dcmap\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish the WEBRTC data channel. It indicates the information within an SDP \"dcmap\" attribute sent towards the remote peer, including the Subprotocol to exchange via the data channel.\nRemote Dcmap\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish the WEBRTC data channel. It indicates the information within an SDP \"dcmap\" attribute received from the remote peer, including the Subprotocol to exchange via the data channel.\nLocal Dcsa\nO\nThis information element can be present if the IMS-ALG requests the IMS-AGW to establish the WEBRTC data channel and to handle its contents in an application-aware manner. It indicates the information within an SDP \"dcsa\" attribute sent towards the remote peer, encapsulating a subprotocol specific SDP attribute.\nRemote Dcsa\nO\nThis information element can be present if the IMS-ALG requests the IMS-AGW to establish the WEBRTC data channel and to handle its contents in an application-aware manner. It indicates the information within an SDP \"dcsa\" attribute received from the remote peer, encapsulating a subprotocol specific SDP attribute.\nReceived SCTP Stream Reset Request\nO\nThis information element is present if the eP-CSCF (IMS-ALG) requests the eIMS-AGW to establish the WEBRTC data channel. It requests the eIMS-AGW to provide a notification when receiving an SCTP Stream reset request and to autonomously answer that SCTP Stream reset request\nAllowed RTCP APP message types\nO\nThis information element is present if IMS-ALG allows the IMS-AGW to send RTCP APP packets of the indicated types. The IMS-AGW shall not send other RTCP APP packets. If the parameter is not supplied, the IMS-AGW shall not send any RTCP APP packets.\nSDPCapNeg configuration\nO\nThis information element provides SDPCapNeg configuration(s) using as \"a=acap\", \"a=tcap\", \"a=pcfg\" and \"a=acfg\" SDP attributes.\nAdditional Bandwidth Properties\nO\nThis information element indicates additional bandwidth properties using \"a=bw-info\" SDP attribute(s) as defined by 3GPP TS 26.114 [21].\nCCM BASE\nO\nThis information element indicates that the IMS-AGW shall be prepared to receive and is allowed to send, respectively, the RTCP feedback \"CCM FIR\" and/or \"CCM TMMBR\" messages (defined in IETF RFC 5104 [78]).\nCCM pause-resume\nO\nThis information element indicates to the IMS-AGW that RTCP feedback \"CCM PAUSE-RESUME\" messages shall be passed transparently.\nDBI\nO\nThis information element indicates to the IMS-AGW that RTCP DBI feedback messages (as defined in 3GPP TS 26.114 [21] clause 7.3.8) shall be passed transparently.\nReserve and Configure AGW Connection Point Ack\nIMS-AGW\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.\nLocal IP Resources\nC\nThis information element indicates the resource(s) for which the IMS-AGW shall be prepared to receive user data. This IE shall be present if it was contained in the request. If the IE was not contained in the request, it may be present in the reply.\nFor terminations supporting any combination of video, audio and messaging this IE shall contain separate resources per stream.\nRemote IP Resources\nO\nThis information element indicates the resource(s) for which the IMS-AGW shall send data.\nFor terminations supporting any combination of video, audio and messaging this IE shall contain separate resources per stream.\nLocal Connection Address\nM\nThis information element indicates the IP address and port number(s) the IMS-AGW shall receive user plane data from IMS.\nFor terminations supporting any combination of video, audio and messaging this may contain multiple addresses.\nRemote Connection Address\nO\nThis information element indicates the remote IP address and port number(s) that the IMS-AGW can send user plane data to.\nFor terminations supporting any combination of video, audio and messaging this may contain multiple addresses.\nLocal cryptographic SDES attribute\nC\nThis information element may be present only if it was contained in the request. It indicates the SDES local cryptographic parameters such as key(s)\nRemote cryptographic SDES attribute\nC\nThis information element may be present only if it was contained in the request. It indicates the SDES remote cryptographic parameters such as key(s)\nLocal certificate fingerprint\nC\nThis information element may be present only if the Local certificate fingerprint Request was contained in the request. It indicates the local certificate fingerprint. (NOTE 3)\nICE password\nC\nThis information element shall be present only if it was contained in the request. It indicates the ICE password assigned by the IMS-AGW.\nICE Ufrag\nC\nThis information element shall be present only if it was contained in the request. It indicates the ICE Ufrag assigned by the IMS-AGW.\nICE host candidate\nC\nThis information element shall be present only if it was contained in the request. It indicates the ICE host candidate assigned by the IMS-AGW.\nICE pacing\nC\nThis information element shall be present only if it was contained in the request. It indicates a desired pacing value for connectivity checks (Ta timer value).\nLocal SCTP Port\nC\nThis information element may be present only if the Local SCTP Port Request was contained in the request. It indicates the local SCTP Port.\nLocal SCTP maximum message size\nC\nThis information element may be present only if the Local max message size Request was contained in the request. It indicates the local max message size.\nICE lite indication\nC\nThis information element shall be present only if an ICE host candidate request was contained in the request, and the IMS-AGW supports ICE lite, but not full ICE. It indicates that the IMS-AGW only supports ICE lite.\nSDPCapNeg configuration\nC\nThis information element shall be present only if it was contained in the request. It provides SDPCapNeg configuration(s) using as \"a=acap\", \"a=tcap\", \"a=pcfg\" and \"a=acfg\" SDP attributes.\nNOTE 1:\tRemote Source Port and Remote Source Port Range are mutually exclusive.\nNOTE 2:\tOne of those IEs shall at least be present when policing is required.\nNOTE 3:\tThis IE may only be present for access network terminations.\nNOTE 4:\tThe concerned RTCP resource component is related to the RTCP port value.",
      "chunk_type": "general",
      "cross_references": [
        "ts_26.114_clause_7.3.8",
        "table_8.2.1",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.3",
      "section_id": "8.3",
      "section_title": "Reserve AGW Connection Point Procedure",
      "content": "This procedure is used to reserve local connection addresses and local resources in IMS-AGW.\nTable 8.3.1: Procedures between IMS-ALG and IMS-AGW: Reserve AGW Connection Point\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nReserve AGW Connection Point\nIMS-ALG\nContext /Context Request\nM\nThis information element indicates the existing context or requests a new context for the bearer termination.\nEmergency Call Indicator\nO\nThis information element identifies the call as emergency call that requires a preferential handling.\nPriority information\nO\nThis information element requests the IMS-AGW to apply priority treatment for the terminations and bearer connections in the specified context.\nBearer Termination Request\nM\nThis information element requests a new bearer termination\nLocal IP Resources\nO\nThis information element indicates the resource(s) for which the IMS-AGW shall be prepared to receive user data.\nFor terminations supporting any combination of video, audio and messaging this IE shall contain separate resources per stream.\nMay be excluded (i.e. \"-\" is used in SDP m-line) if no transcoding or media related functions are required.\nReserveValue\nO\nThis information element indicates if multiple local resources are to be reserved.\nThis information element shall be included if a speech codec and auxiliary payload types are configured.\nLocal Connection Address Request\nM\nThis information element requests an IP address and port number(s) on the IMS-AGW that the remote end can send user plane data to.\nFor terminations supporting any combination of video, audio and messaging this may contain multiple addresses.\nNotify termination heartbeat\nM\nThis information element requests termination heartbeat indications.\nNotify Released Bearer\nO\nThis information element requests a notification of a released bearer.\nLatching Requirement\nO\nThis information element indicates that the IMS-AGW should (re)latch onto the address of received media packets to determine the corresponding destination address.\nIP Realm Identifier\nO\nThis information element indicates the IP realm of the bearer termination.\nRemote Source Address Filtering\nO\nThis information element indicates that remote source address filtering is required.\nRemote Source Address Mask\nC\nThis information element provides information on the valid remote source addresses. This is required if a range of remote source address filtering is required.\nRemote Source Port Filtering\nO\nThis information element indicates that remote source port filtering is required.\nRemote Source Port\nC\nThis information element identifies the valid remote source port. This may be included if remote source port filtering is included. (NOTE 1)\nRemote Source Port Range\nC\nThis information element identifies a range of valid remote source ports. This may be included if remote source port filtering is included. (NOTE 1)\nPolicing Required\nO\nThis information element indicates that policing of the media flow is required.\nPeak Data Rate\nO\nThis information element may be present if Policing is required and specifies the permissible peak data rate for a media stream. (NOTE 2).\nSustainable Data Rate\nO\nThis information element may be present if Policing is required and specifies the permissible sustainable data rate for a media stream. (NOTE 2).\nDelay Variation Tolerance\nO\nThis information element may be present if Policing on Peak Data Rate is required and specifies the maximum expected delay variation tolerance for the corresponding media stream.\nMaximum Burst Size\nC\nThis information element shall be present if Policing on Sustainable Data Rate is required and specifies the maximum expected burst size for the corresponding media stream.\nDiffServ Code Point\nO\nThis information element indicates a specific DiffServ code point to be used in the IP header in packets sent on the bearer termination.\nDiffServ Tagging Behaviour\nO\nThis information element indicates whether the Diffserv code point in the IP header in packets sent on the bearer termination should be copied from the received value or set to a specific value.\nMedia Inactivity Detection Required\nO\nThis information element indicates that detection of inactive media flows is required.\nMedia Inactivity Detection Time\nC\nThis information element may be present if Inactive Media Detection is required and specifies the Inactivity Detection time.\nMedia Inactivity Detection Direction\nC\nThis information element may be present if Inactive Media Detection is required and specifies the Inactivity Detection direction.\nRTCP handling\nO\nThis information element is present if IMS-ALG wants explicitly control the reservation of RTCP resources by the IMS-AGW.\nRTP/RTCP transport multiplexing\nC\nThis information element requests the IMS-AGW to apply the RTP/RTCP transport multiplexing. This information element may only be present if RTCP handling is required.\nLocal cryptographic SDES attribute\nC\nThis information element is present if IMS-ALG wants that the media is encrypted and/or integrity protected by the IMS-AGW (NOTE 3). It indicates the SDES local cryptographic parameters such as key(s).\nECN Enable\nO\nThis information element requests the IMS-AGW to apply ECN procedures.\nECN Initiation Method\nC\nThis information element specifies the ECN Initiation method and requests the IMS-AGW to perform IP header settings as an ECN endpoint, or indicates that ECN bits shall be passed transparently. It may be included only if ECN is enabled.\nNotify ECN Failure Event\nC\nThis information element requests a notification if a ECN failure occurs due to ECN. It may only be supplied if ECN is enabled and the IMS-AGW acts as ECN endpoint.\nExtended RTP Header for CVO\nO\nThis information element requests the IMS-AGW to pass on the CVO extended RTP header as defined by IETF RFC 5285 [23].\nExtended RTP Header for Sent ROI\nO\nThis information element requests the IMS-AGW to pass on the ROI extended RTP header for carriage of predefined and/or arbitrary ROI information as defined by IETF RFC 5285 [23] and 3GPP TS 26.114 [21].\nPredefined ROI\nO\nThis information element requests the IMS-AGW to support the RTCP feedback message capability for \"Predefined ROI\" type expressed by the parameter \"3gpp-roi-predefined\", as described in 3GPP TS 26.114 [21].\nArbitrary ROI\nO\nThis information element requests the IMS-AGW to support the RTCP feedback message capability for \"Arbitrary ROI\" type expressed by the parameter \"3gpp-roi-arbitrary\", as described in 3GPP TS 26.114 [21].\nGeneric Image Attributes\nO\nThis information element indicates image attributes (e.g. image size) as defined by IETF RFC 6236 [24].\nLocal certificate fingerprint Request\nO\nThis information element is present if the IMS-ALG wants that the media is decrypted, and/or integrity protected by the IMS-AGW (NOTE 4). It requests the IMS-AGW to provide a local certificate fingerprint.\nEstablish (D)TLS session\nO\nThis information element requests the IMS-AGW to take the (D)TLS client role and to initiate the establishment of the (D)TLS session. (NOTE 4)\nNotify (D)TLS session establishment Failure Event\nO\nThis information element requests a notification if a (D)TLS session establishment failure occurs. (NOTE 4)\nTCP State-aware Handling Indicator and Setup Direction\nC\nThis information element indicates that TCP state-aware handing is required and indicates the TCP setup direction. It may only be included if the IMS‑AGW supports TCP state-aware handling.\nDiscard Incoming TCP Connection Establishment Requests Indicator\nC\nThis information element indicates whether incoming TCP connection establishment requests (TCP SYN) shall be discarded. It may only be included if the IMS‑AGW supports TCP state-aware handling and discarding incoming TCP connection establishment requests.\nForward Incoming TCP Connection Establishment Requests Indicator\nC\nThis information element indicates for a given termination to use the incoming TCP connection establishment request (TCP SYN) at that termination as a trigger for sending a TCP connection establishment request at the interconnected termination in the same context. It may only be included if the IMS‑AGW supports TCP state-aware handling and the Forward Incoming TCP Connection Establishment Requests Indicator.\nNotify TCP Connection Establishment Failure Event\nC\nThis information element requests a notification if a TCP connection establishment failure occurs. It may only be included if the IMS‑AGW supports TCP state-aware handling.\nICE password request\nO\nThis information element is present if IMS-ALG requests an ICE password.\nICE Ufrag request\nO\nThis information element is present if IMS-ALG requests an ICE ufrag.\nICE host candidate request\nO\nThis information element is present if IMS-ALG requests an ICE host candidate.\nICE pacing request\nO\nThis information element is present if IMS-ALG requests a pacing value for connectivity checks (Ta timer value). It is only applicable for full ICE.\nSTUN server request\nO\nThis information element is present if IMS-ALG requests the IMS-AGW to answer STUN connectivity checks for ICE.\nApplication-aware MSRP interworking request\nO\nThis information element is present if IMS-ALG requests the IMS-AGW to perform application-aware MSRP Interworking.\nNotify STUN consent freshness test failure Event\nO\nThis information element requests a notification if a STUN consent freshness test failure occurs (full ICE only).\nSTUN consent freshenss test request\nO\nThis information element is present if eP-CSCF requests the eIMS-AGW to perform a STUN consent freshness test (full ICE only).\nLocal SCTP Port Request\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It requests the IMS-AGW to provide a local SCTP Port.\nLocal SCTP maximum message size Request\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It requests the IMS-AGW to provide a local max message size.\nLocal Dcmap\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish the WEBRTC data channel. It indicates the information within an SDP \"dcmap\" attribute sent towards the remote peer, including the Subprotocol to exchange via the data channel.\nLocal Dcsa\nO\nThis information element can be present if the IMS-ALG requests the IMS-AGW to establish the WEBRTC data channel and to handle its contents in an application-aware manner. It indicates the information within an SDP \"dcsa\" attribute sent towards the remote peer, encapsulating a subprotocol specific SDP attribute.\nSCTP Group Semantics\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It indicates the H.248 component streams that are grouped in the same SCTP association.\nSCTP stream deaggregation\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It indicates the H.248 component streams that transport media that are to be deaggregated from the H.248 deaggregation stream used to control the SCTP association.\nSCTP stream ID\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an WEBRTC data channel. It indicates the SCTP stream ID to be used for that data channel.\nReceived SCTP Stream Reset Request\nO\nThis information element is present if the eP-CSCF (IMS-ALG) requests the eIMS-AGW to establish the WEBRTC data channel. It requests the eIMS-AGW to provide a notification when receiving an SCTP Stream reset request and to autonomously answer that SCTP Stream reset request\nSDPCapNeg configuration\nO\nThis information element provides SDPCapNeg configuration(s) using as \"a=acap\", \"a=tcap\", \"a=pcfg\" and \"a=acfg\" SDP attributes.\nReserve AGW Connection Point Ack\nIMS-AGW\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.\nLocal IP Resources\nC\nThis information element indicates the resource(s) for which the IMS-AGW shall be prepared to receive user data. This IE shall be present if it was contained in the request. If the IE was not contained in the request, it may be present in the reply.\nFor terminations supporting any combination of video, audio and messaging this IE shall contain separate resources per stream.\nLocal Connection Address\nM\nThis information element indicates the IP address and port number(s) the IMS-AGW shall receive user plane data from IMS.\nFor terminations supporting any combination of video, audio and messaging this may contain multiple addresses.\nLocal cryptographic SDES attribute\nC\nThis information element may be present only if it was contained in the request. It indicates the SDES local cryptographic parameters such as key(s)\nLocal certificate fingerprint\nC\nThis information element may be present only if the Local certificate fingerprint Request was contained in the request. It indicates the local certificate fingerprint. (NOTE 4)\nICE password\nC\nThis information element shall be present only if it was contained in the request. It indicates the ICE password assigned by the IMS-AGW.\nICE Ufrag\nC\nThis information element shall be present only if it was contained in the request. It indicates the ICE Ufrag assigned by the IMS-AGW.\nICE host candidate\nC\nThis information element shall be present only if it was contained in the request. It indicates the ICE host candidate assigned by the IMS-AGW.\nICE pacing\nC\nThis information element shall be present only if it was contained in the request. It indicates a desired pacing value for connectivity checks (Ta timer value).\nICE lite indication\nC\nThis information element shall be present only if an ICE host candidate request was contained in the request, and the IMS-AGW supports ICE lite, but not full ICE. It indicates that the IMS-AGW only supports ICE lite.\nLocal SCTP Port\nC\nThis information element may be present only if the Local SCTP Port Request was contained in the request. It indicates the local SCTP Port.\nLocal SCTP maximum message size\nC\nThis information element may be present only if the Local max message size Request was contained in the request. It indicates the local max message size.\nSDPCapNeg configuration\nC\nThis information element shall be present only if it was contained in the request. It provides SDPCapNeg configuration(s) using as \"a=acap\", \"a=tcap\", \"a=pcfg\" and \"a=acfg\" SDP attributes.\nNOTE 1:\tRemote Source Port and Remote Source Port Range are mutually exclusive.\nNOTE 2:\tOne of those IEs shall at least be present when policing is required.\nNOTE 3:\tThis IE may only be present for access network terminations, and only if the IMS-ALG includes only one SDES crypto attribute in the SDP sent towards the served UE.\nNOTE 4:\tThis IE may only be present for access network terminations.",
      "chunk_type": "procedure",
      "cross_references": [
        "table_8.3.1",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.4",
      "section_id": "8.4",
      "section_title": "Configure AGW Connection Point Procedure",
      "content": "This procedure is used to select or modify multimedia-processing resources for the Iq interface connection.\nTable 8.4.1: Procedures between IMS-ALG and IMS-AGW: Configure AGW Connection Point\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nConfigure AGW Connection Point\nIMS-ALG\nContext\nM\nThis information element indicates the context for the bearer termination.\nPriority information\nO\nThis information element shall be present if the priority information needs to be modified, it may be present otherwise.\nBearer Termination\nM\nThis information element indicates the existing bearer termination.\nLocal IP Resources\nO\nThis information element indicates the resource(s) for which the IMS-AGW shall be prepared to receive user data.\nFor terminations supporting any combination of video, audio and messaging this IE shall contain separate resources per stream.\nMay be excluded (i.e. \"-\" is used in SDP m-line) if no transcoding or media related functions are required.\nRemote IP Resources\nO\nThis information element indicates the resource(s) for which the IMS-AGW shall send data.\nFor terminations supporting any combination of video, audio and messaging this IE shall contain separate resources per stream.\nMay be excluded (i.e. \"-\" is used in SDP m-line) if no transcoding or media related functions are required.\nLocal Connection Address\nO\nThis information element indicates the IP address and port number(s) on the IMS-AGW that the IMS user can send user plane data to.\nFor terminations supporting video any combination of video, audio and messaging may contain multiple addresses.\nRemote Connection Address\nO\nThis information element indicates the remote IP address and port number(s) that the IMS-AGW can send user plane data to.\nFor terminations supporting any combination of video, audio and messaging this may contain multiple addresses.\nLatching Requirement\nO\nThis information element indicates that the IMS-AGW should (re)latch onto the address of received media packets to determine the corresponding destination address.\nIP Realm Identifier\nO\nThis information element indicates the IP realm of the bearer termination. (NOTE 3)\nRemote Source Address Filtering\nO\nThis information element indicates that remote source address filtering is required.\nRemote Source Address Mask\nC\nThis information element provides information on the valid remote source addresses. This is required if a range of remote source address filtering is required.\nRemote Source Port Filtering\nO\nThis information element indicates that remote source port filtering is required.\nRemote Source Port\nC\nThis information element identifies the valid remote source port. This may be included if remote source port filtering is included. (NOTE 1)\nRemote Source Port Range\nC\nThis information element identifies a range of valid remote source ports. This may be included if remote source port filtering is included. (NOTE 1)\nPolicing Required\nO\nThis information element indicates that policing of the media flow is required.\nPeak Data Rate\nO\nThis information element may be present if Policing is required and specifies the permissible peak data rate for a media stream. (NOTE 2).\nSustainable Data Rate\nO\nThis information element may be present if Policing is required and specifies the permissible sustainable data rate for a media stream. (NOTE 2).\nDelay Variation Tolerance\nO\nThis information element may be present if Policing on Peak Data Rate is required and specifies the maximum expected delay variation tolerance for the corresponding media stream.\nMaximum Burst Size\nC\nThis information element shall be present if Policing on Sustainable Data Rate is required and specifies the maximum expected burst size for the corresponding media stream.\nDiffServ Code Point\nO\nThis information element indicates a specific DiffServ code point to be used in the IP header in packets sent on the bearer termination.\nDiffServ Tagging Behaviour\nO\nThis information element indicates whether the Diffserv code point in the IP header in packets sent on the bearer termination should be copied from the received value or set to a specific value.\nMedia Inactivity Detection Required\nO\nThis information element indicates that detection of inactive media flows is required.\nMedia Inactivity Detection Time\nC\nThis information element may be present if Inactive Media Detection is required and specifies the Inactivity Detection time.\nMedia Inactivity Detection Direction\nC\nThis information element may be present if Inactive Media Detection is required and specifies the Inactivity Detection direction.\nRTCP handling\nO\nThis information element is present if IMS-ALG wants to explicitly control the reservation of RTCP resources  (NOTE 5).\nRTP/RTCP transport multiplexing\nC\nThis information element requests the IMS-AGW to apply the RTP/RTCP transport multiplexing. This information element may only be present if RTCP handling is required.\nExplicit RTCP transport address\nC\nThis information element indicates the remote RTCP port and optionally the remote network address where to send RTCP packets. This information element may only be present if RTCP handling is required.\nLocal cryptographic SDES attribute\nC\nThis information element is present if IMS-ALG wants that the media is encrypted and/or integrity protected by the IMS-AGW (NOTE 4). It indicates the SDES local cryptographic parameters such as key(s).\nRemote cryptographic SDES attribute\nC\nThis information element is present if IMS-ALG wants that the media is decrypted, and/or integrity checked by the IMS-AGW (NOTE 4). It indicates the SDES remote cryptographic parameters such as key(s).\nECN Enable\nO\nThis information element requests the IMS-AGW to apply ECN procedures.\nECN Initiation Method\nC\nThis information element specifies the ECN Initiation method and requests the IMS-AGW to perform IP header settings as an ECN endpoint, or indicates that ECN bits shall be passed transparently. It may be included only if ECN is enabled.\nNotify ECN Failure Event\nC\nThis information element requests a notification if a ECN failure occurs due to ECN. It may only be supplied if ECN is enabled and the IMS-AGW acts as ECN endpoint.\nExtended RTP Header for CVO\nO\nThis information element requests the IMS-AGW to pass on the CVO extended RTP header as defined by IETF RFC 5285 [23].\nExtended RTP Header for Sent ROI\nO\nThis information element requests the IMS-AGW to pass on the ROI extended RTP header for carriage of predefined and/or arbitrary ROI information as defined by IETF RFC 5285 [23] and 3GPP TS 26.114 [21].\nPredefined ROI\nO\nThis information element requests the IMS-AGW to support the RTCP feedback message capability for \"Predefined ROI\" type expressed by the parameter \"3gpp-roi-predefined\", as described in 3GPP TS 26.114 [21].\nArbitrary ROI\nO\nThis information element requests the IMS-AGW to support the RTCP feedback message capability for \"Arbitrary ROI\" type expressed by the parameter \"3gpp-roi-arbitrary\", as described in 3GPP TS 26.114 [21].\nGeneric Image Attributes\nO\nThis information element indicates image attributes (e.g. image size) as defined by IETF RFC 6236 [24].\nRemote certificate fingerprint\nO\nThis information element is present if the IMS-ALG wants that the media is decrypted, and/or integrity checked by the IMS-AGW (NOTE 4). It indicates the remote certificate fingerprint.\nEstablish (D)TLS session\nO\nThis information element requests the IMS-AGW to take the (D)TLS client role and to initiate the establishment of the (D)TLS session. (NOTE 4)\nRelease (D)TLS session\nO\nThis information element requests the IMS-AGW to release the (D)TLS session. (NOTE 4)\nNotify (D)TLS session establishment Failure Event\nO\nThis information element requests a notification if a TLS session establishment failure occurs. (NOTE 4)\nTCP State-aware Handling Indicator and Setup Direction\nC\nThis information element indicates that TCP state-aware handing is required and indicates the TCP setup direction. It may only be included if the IMS‑AGW supports TCP state-aware handling.\nDiscard Incoming TCP Connection Establishment Requests Indicator\nC\nThis information element indicates whether incoming TCP connection establishment requests (TCP SYN) shall be discarded. It may only be included if the IMS‑AGW supports TCP state-aware handling and discarding incoming TCP connection establishment requests.\nForward Incoming TCP Connection Establishment Requests Indicator\nC\nThis information element indicates for a given termination to use the incoming TCP connection establishment request (TCP SYN) at that termination as a trigger for sending a TCP connection establishment request at the interconnected termination in the same context. It may only be included if the IMS‑AGW supports TCP state-aware handling and the Forward Incoming TCP Connection Establishment Requests Indicator.\nSend TCP Connection Establishment Requests Indicator\nC\nThis information element indicates for a given termination to send a TCP connection establishment request (TCP SYN). It may only be included if the IMS‑AGW supports TCP state-aware handling.\nNotify TCP Connection Establishment Failure Event\nC\nThis information element requests a notification if a TCP connection establishment failure occurs. It may only be included if the IMS‑AGW supports TCP state-aware handling.\nICE Connectivity Check\nC\nThis information element requests the IMS-AGW to perform ICE connectivity check as defined by IETF RFC 8445 [82]. It is only applicable for full ICE.\nNotify ICE Connectivity Check Result\nC\nThis information element requests a notification of ICE connectivity check result. It is only applicable for full ICE.\nNotify New Peer Reflexive Candidate\nC\nThis information element requests a notification of new peer reflexive candidate was discovered during a connectivity check. It is only applicable for full ICE.\nAdditional ICE Connectivity Check\nC\nThis information element requests the IMS-AGW to perform additional ICE connectivity check as defined by IETF RFC 8445 [82]. It is only applicable for full ICE.\nICE received candidate\nO\nThis information element is present if IMS-ALG indicates a received candidate for ICE.\nICE received password\nO\nThis information element is present if IMS-ALG indicates a received password for ICE.\nICE received Ufrag\nO\nThis information element is present if IMS-ALG indicates a received Ufrag for ICE.\nICE received pacing\nO\nThis information element is present if IMS-ALG indicates a received pacing value for connectivity checks (Ta timer value). It is only applicable for full ICE.\nMSRP Path\nO\nThis information element is present for application-aware MSRP Interworking. It provides the path information that the IMS-AGW shall insert in the MSRP layer \"To‑Path\" Information element.\nNotify STUN consent freshness test failure Event\nO\nThis information element requests a notification if a STUN consent freshness test failure occurs (full ICE only).\nSTUN consent freshness test request\nO\nThis information element is present if eP-CSCF requests the eIMS-AGW to perform a STUN consent freshness test (full ICE only).\nAllowed RTCP APP message types\nO\nThis information element is present if IMS-ALG allows the IMS-AGW to send RTCP APP packets of the indicated types. The IMS-AGW shall not send other RTCP APP packets. If the parameter is not supplied, the IMS-AGW shall not send any RTCP APP packets.\nLocal Dcmap\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish the WEBRTC data channel. It indicates the information within an SDP \"dcmap\" attribute sent towards the remote peer, including the Subprotocol to exchange via the data channel.\nRemote Dcmap\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish the WEBRTC data channel. It indicates the information within an SDP \"dcmap\" attribute received from the remote peer, including the Subprotocol to exchange via the data channel.\nLocal Dcsa\nO\nThis information element can be present if the IMS-ALG requests the IMS-AGW to establish the WEBRTC data channel and to handle its contents in an application-aware manner. It indicates the information within an SDP \"dcsa\" attribute sent towards the remote peer, encapsulating a subprotocol specific SDP attribute.\nRemote Dcsa\nO\nThis information element can be present if the IMS-ALG requests the IMS-AGW to establish the WEBRTC data channel and to handle its contents in an application-aware manner. It indicates the information within an SDP \"dcsa\" attribute received from the remote peer, encapsulating a subprotocol specific SDP attribute.\nRemote SCTP port\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It indicates the remote SCTP port.\nRemote SCTP max message size\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an SCTP association. It indicates the remote max message size.\nSCTP Group Semantics\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to modify an SCTP association. It indicates the H.248 component streams that are grouped in the same SCTP association.\nSCTP stream deaggregation\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to modify an SCTP association. It indicates the H.248 component streams that transport media that are to be deaggregated from the H.248 deaggregation stream used to control the SCTP association.\nSCTP stream ID\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to establish an WEBRTC data channel. It indicates the SCTP stream ID to be used for that data channel.\nReceived SCTP Stream Reset Request\nO\nThis information element is present if the eP-CSCF (IMS-ALG) requests the eIMS-AGW to establish the WEBRTC data channel. It requests the eIMS-AGW to provide a notification when receiving an SCTP Stream reset request and to autonomously answer that SCTP Stream reset request.\nSend SCTP Stream Reset Requests Indicator\nO\nThis information element is present if the eP-CSCF (IMS-ALG) requests the eIMS-AGW to reset an SCTP Stream to release the WEBRTC data channel. It requests the eIMS-AGW to send an SCTP Stream reset request.\nReceived SCTP Stream Reset Response\nO\nThis information element may be present if the eP-CSCF (IMS-ALG) requests the eIMS-AGW to reset an SCTP Stream to release the WEBRTC data channel. It requests the eIMS-AGW to provide a notification when receiving a response to an SCTP Stream reset request.\nInitiate Outgoing SCTP Stream Reset\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to close an individual WEBRTC data channel.\nOutgoing SCTP Stream Response\nO\nThis information element is present if the IMS-ALG requests the IMS-AGW to acknowledge the request to close an individual WEBRTC data channel.\nNotify Detect Outgoing SCTP Stream Reset\nO\nThis information element requests a notification of outgoing SCTP Stream reset requests from remote peers (here IMS WebRTC client).\nNotify Outgoing SCTP Stream Reset Result\nO\nThis information element requests a notification of the result of an outgoing SCTP Stream reset sent to the remote peer (here IMS WebRTC client).\nSDPCapNeg configuration\nO\nThis information element provides SDPCapNeg configuration(s) using as \"a=acap\", \"a=tcap\", \"a=pcfg\" and \"a=acfg\" SDP attributes.\nAdditional Bandwidth Properties\nO\nThis information element indicates additional bandwidth properties using \"a=bw-info\" SDP attribute(s) as defined by 3GPP TS 26.114 [21].\nCCM BASE\nO\nThis information element indicates that the IMS-AGW shall be prepared to receive and is allowed to send, respectively, the RTCP feedback \"CCM FIR\" and/or \"CCM TMMBR\" messages (defined in IETF RFC 5104 [78]).\nCCM pause-resume\nO\nThis information element indicates to the IMS-AGW that RTCP feedback \"CCM PAUSE-RESUME\" messages shall be passed transparently.\nDBI\nO\nThis information element indicates to the IMS-AGW that RTCP DBI feedback messages (as defined in 3GPP TS 26.114 [21] clause 7.3.8) shall be passed transparently.\nConfigure AGW Connection Point Ack\nIMS-AGW\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.\nLocal IP Resources\nO\nThis information element indicates the resource(s) for which the IMS-AGW shall be prepared to receive user data\nFor terminations supporting any combination of video, audio and messaging this IE shall contain separate resources per stream.\nRemote IP Resources\nO\nThis information element indicates the resource(s) for which the IMS-AGW shall send data.\nFor terminations supporting any combination of video, audio and messaging this IE shall contain separate resources per stream.\nLocal Connection Address\nO\nThis information element indicates the IP address and port number(s) on the IMS-AGW that the IMS user can send user plane data to.\nFor terminations supporting any combination of video, audio and messaging this may contain multiple addresses.\nRemote Connection Address\nO\nThis information element indicates the remote IP address and port number(s) that the IMS-AGW can send user plane data to.\nFor terminations supporting any combination of video, audio and messaging this may contain multiple addresses.\nLocal cryptographic SDES attribute\nC\nThis information element may be present only if it was contained in the request. It indicates the SDES local cryptographic parameters such as key(s)\nRemote cryptographic SDES attribute\nC\nThis information element may be present only if it was contained in the request. It indicates the SDES remote cryptographic parameters such as key(s)\nNOTE 1:\tRemote Source Port and Remote Source Port Range are mutually exclusive.\nNOTE 2:\tOne of those IEs shall at least be present when policing is required.\nNOTE 3:\tAdditional streams may be added by the Configure AGW Connection Point procedure. The additional streams shall then carry the same IP Realm Identifier as the very first Stream.\nNOTE 4:\tThis IE may only be present for access network terminations.\nNOTE 5:\tThe concerned RTCP resource component is related to the RTCP port value.\nEditor's Note :\tThe details of how the transparent indication included in ECN Control is subject of stage 3 specification. It also needs to be determined if this indication is needed on both incoming and outgoing terminations.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_26.114_clause_7.3.8",
        "table_8.4.1",
        "ts_26.114"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.5",
      "section_id": "8.5",
      "section_title": "Release AGW Termination",
      "content": "This procedure is used to release a termination towards the IMS and free all related resources.\nTable 8.5.1: Procedures between IMS-ALG and IMS-AGW: Release AGW Termination\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nRelease AGW Termination\nIMS-ALG\nContext\nM\nThis information element indicates the existing context for the bearer termination.\nBearer Termination\nM\nThis information element indicates the bearer termination to be released.\nRelease AGW Termination Ack\nIMS-AGW\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.5.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.6",
      "section_id": "8.6",
      "section_title": "Termination heartbeat indication",
      "content": "This procedure is used to report a termination heartbeat.\nTable 8.6.1: Procedures between IMS-ALG and IMS-AGW: Termination heartbeat indication\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nTermination heartbeat indication\nIMS-AGW\nContext\nM\nThis information element indicates the context for the bearer termination.\nBearer Termination\nM\nThis information element indicates the bearer termination for which the termination heartbeat is reported.\nTermination heartbeat\nM\nHanging Termination event, as defined in 3GPP TS 29.334 [3].\nTermination heartbeat indication Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.6.1",
        "ts_29.334"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.7",
      "section_id": "8.7",
      "section_title": "IMS-AGW Out-of-Service",
      "content": "This procedure is used to indicate that the IMS-AGW will go out of service or is maintenance locked.\nTable 8.7.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Out-of-Service\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nIMS-AGW Out-of-Service\nIMS-AGW\nContext\nM\nThis information element indicates the context for the command.\nRoot  Termination\nM\nThis information element indicates the root  termination for the command.\nReason\nM\nThis information element indicates the reason for service change.\nMethod\nM\nThis information element indicates the method for service change.\nIMS-AGW Out-of-Service Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nRoot  Termination\nM\nThis information element indicates the root  termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.7.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.8",
      "section_id": "8.8",
      "section_title": "IMS-AGW  Communication Up",
      "content": "This procedure is used to indicate that the IMS-AGW is back in service using an existing control association.\nTable 8.8.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Communication Up\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nIMS-AGW Communication\nUp\nIMS-AGW\nContext\nM\nThis information element indicates the context for the command.\nRoot  Termination\nM\nThis information element indicates the root  termination for the command.\nReason\nM\nThis information element indicates the reason for service change.\nMethod\nM\nThis information element indicates the method for service change.\nIMS-AGW Communication\nUp Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nRoot  Termination\nM\nThis information element indicates the root  termination where the command was executed.\nIMS-ALG Address\nO\nThis information element indicates the IMS-ALG signalling address to which the IMS-AGW should preferably attempt to re-register.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.8.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.9",
      "section_id": "8.9",
      "section_title": "IMS-AGW Restoration",
      "content": "This procedure is used to indicate the IMS-AGW has recovered from a failure.\nTable 8.9.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Restoration\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nIMS-AGW Restoration\nIMS-AGW\nContext\nM\nThis information element indicates the context for the command.\nRoot  Termination\nM\nThis information element indicates the root  termination for the command.\nReason\nM\nThis information element indicates the reason for the service change.\nMethod\nM\nThis information element indicates the method for service change.\nIMS-AGW Restoration Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nRoot  Termination\nM\nThis information element indicates the root  termination where the command was executed.\nIMS-ALG Address\nO\nThis information element indicates the IMS-ALG signalling address to which the IMS-AGW should preferably attempt to re-register.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.9.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.10",
      "section_id": "8.10",
      "section_title": "IMS-AGW Register",
      "content": "This procedure is used to register the IMS-AGW after a cold/warm boot.\nTable 8.10.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Register\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nIMS-AGW Register\nIMS-AGW\nContext\nM\nThis information element indicates the context for the command.\nRoot  Termination\nM\nThis information element indicates the root  termination for the command.\nReason\nM\nThis information element indicates the reason for the service change.\nMethod\nM\nThis information element indicates the method for service change.\nProtocol Version\nM\nThis information element indicates the protocol version for Iq interface requested by the IMS-AGW.\nService Change Profile\nM\nThis information element indicates the profile for the Iq interface requested by the IMS-AGW.\nIMS-AGW Register Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nRoot  Termination\nM\nThis information element indicates the root  termination where the command was executed.\nProtocol Version\nO\nThis information element indicates the protocol version for Iq interface supported by the IMS-ALG.\nService Change Profile\nO\nThis information element indicates the profile for the Iq interface supported by the IMS-ALG.\nIMS-ALG Address\nO\nThis information element indicates the IMS-ALG signalling address to which the IMS-AGW should preferably attempt to re-register.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.10.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.11",
      "section_id": "8.11",
      "section_title": "IMS-ALG Restoration",
      "content": "This procedure is used to indicate the IMS-ALG has recovered from a failure.\nTable 8.11.1: Procedures between IMS-ALG and IMS-AGW: IMS-ALG Restoration\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nIMS-ALG Restoration\nIMS-ALG\nContext\nM\nThis information element indicates the context for the command.\nRoot  Termination\nM\nThis information element indicates the root  termination for the command.\nReason\nM\nThis information element indicates the reason for the service change.\nMethod\nM\nThis information element indicates the method for service change.\nIMS-ALG Restoration Ack\nIMS-AGW\nContext\nM\nThis information element indicates the context where the command was executed.\nRoot  Termination\nM\nThis information element indicates the root  termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.11.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.12",
      "section_id": "8.12",
      "section_title": "IMS-AGW Re-register",
      "content": "This procedure is used to re-register the IMS-AGW (having been requested to do so by the IMS-ALG).\nTable 8.12.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Re-register\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nIMS-AGW Re-register\nIMS-AGW\nContext\nM\nThis information element indicates the context for the command.\nRoot  Termination\nM\nThis information element indicates the root  termination for the command.\nReason\nM\nThis information element indicates the reason for the service change.\nMethod\nM\nThis information element indicates the method for service change.\nProtocol Version\nM\nThis information element indicates the protocol version for Iq interface requested by the IMS-AGW.\nService Change Profile\nM\nThis information element indicates the profile for the Iq interface requested by the IMS-AGW.\nIMS-AGW Re-register Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nRoot  Termination\nM\nThis information element indicates the root  termination where the command was executed.\nProtocol Version\nO\nThis information element indicates the protocol version for Iq interface supported by the IMS-ALG.\nService Change Profile\nO\nThis information element indicates the profile for the Iq interface supported by the IMS-ALG.\nIMS-ALG Address\nO\nThis information element indicates the IMS-ALG signalling address to which the IMS-AGW should preferably attempt to re-register.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.12.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.13",
      "section_id": "8.13",
      "section_title": "IMS-ALG Ordered Re-registration",
      "content": "This procedure is used by the IMS-ALG to request the IMS-AGW to re-register.\nTable 8.13.1: Procedures between IMS-ALG and IMS-AGW: IMS-ALG Ordered Re-register\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nIMS-ALG Ordered Re-\nregister\nIMS-ALG\nContext\nM\nThis information element indicates the context for the command.\nRoot  Termination\nM\nThis information element indicates the root  termination for the command.\nReason\nM\nThis information element indicates the reason for the service change.\nIMS-ALG Address\nO\nThis information element indicates the IMS-ALG signalling address.\nIMS-ALG Ordered Re-\nregister Ack\nIMS-AGW\nContext\nM\nThis information element indicates the context where the command was executed.\nRoot  Termination\nM\nThis information element indicates the root  termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.13.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.14",
      "section_id": "8.14",
      "section_title": "Audit Value",
      "content": "This procedure is used to audit values of different object(s).\nTable 8.14.1: Procedures between IMS-ALG and IMS-AGW: Audit Value\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nAudit Value\nIMS-ALG\nContext\nM\nThis information element indicates the context for the command.\nBearer Termination\nM\nThis information element indicates the bearer termination(s) for the command.\nObject(s)\nM\nThis information element indicates the object(s) to be audited.\nAudit Value Ack\nIMS-AGW\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.\nValue(s)\nM\nThis information element indicates the value(s) of the object(s).",
      "chunk_type": "general",
      "cross_references": [
        "table_8.14.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.15",
      "section_id": "8.15",
      "section_title": "Audit Capability",
      "content": "This procedure is used to audit capabilities of different object(s).\nTable 8.15.1: Procedures between IMS-ALG and IMS-AGW: Audit Capability\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nAudit Capability\nIMS-ALG\nContext\nM\nThis information element indicates the context for the command.\nBearer Termination\nM\nThis information element indicates the bearer termination(s) for the command.\nObject(s)\nM\nThis information element indicates the object(s) which capability is requested.\nAudit Capability Ack\nIMS-AGW\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.\nCapabilities(s)\nM\nThis information element indicates the capabilities of the object(s).",
      "chunk_type": "general",
      "cross_references": [
        "table_8.15.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.16",
      "section_id": "8.16",
      "section_title": "Capability Update",
      "content": "This procedure is used to indicate update of an object capability.\nTable 8.16.1: Procedures between IMS-ALG and IMS-AGW: Capability Update\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nCapability Update\nIMS-AGW\nContext\nM\nThis information element indicates the context for the command.\nBearer Termination\nM\nThis information element indicates the bearer termination(s) for the command.\nReason\nM\nThis information element indicates the reason for service change.\nMethod\nM\nThis information element indicates the method for service change.\nCapability Update Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.16.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.17",
      "section_id": "8.17",
      "section_title": "IMS-ALG Out of Service",
      "content": "This procedure is used to indicate that IMS-ALG has gone out of service.\nTable 8.17.1: Procedures between IMS-ALG and IMS-AGW: IMS-ALG Out of Service\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nIMS-ALG Out of Service\nIMS-ALG\nContext\nM\nThis information element indicates the context for the command.\nRoot  Termination\nM\nThis information element indicates the root  termination for the command.\nReason\nM\nThis information element indicates the reason for the service change.\nMethod\nM\nThis information element indicates the method for service change.\nIMS-ALG Out of Service\nAck\nIMS-AGW\nContext\nM\nThis information element indicates the context where the command was executed.\nRoot  Termination\nM\nThis information element indicates the root  termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.17.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.18",
      "section_id": "8.18",
      "section_title": "IMS-AGW Resource Congestion Handling - Activate",
      "content": "This procedure is used to activate the congestion handling mechanism.\nTable 8.18.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Resource Congestion Handling - Activate\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nIMS-AGW Resource Congestion Handling –\nActivate\nIMS-ALG\nContext\nM\nThis information element indicates that all context are applicable for the root termination.\nRoot Termination\nM\nThis information element indicates that root termination is where the congestion mechanism is activated.\nCongestion Activate\nM\nThis information element requests to activate the congestion mechanism.\nIMS-AGW Resource Congestion Handling -\nActivate Ack\nIMS-AGW\nContext\nM\nThis information element indicates that all context are where the command was executed.\nRoot Termination\nM\nThis information element indicates that root termination is where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.18.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.19",
      "section_id": "8.19",
      "section_title": "IMS-AGW Resource Congestion Handling - Indication",
      "content": "This procedure is used to inform the IMS-ALG that traffic restriction is advised.\nTable 8.19.1: Procedures between IMS-ALG and IMS-AGW: IMS-AGW Resource Congestion Handling -Indication\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nIMS-AGW Resource Congestion Handling -\nIndication\nIMS-AGW\nContext\nM\nThis information element indicates all context are applicable for the root termination.\nRoot Termination\nM\nThis information element indicates that root termination is where the congestion mechanism was activated.\nReduction\nM\nThis information element indicates the load percentage to be reduced.\nIMS-AGW Resource Congestion Handling -\nIndication Ack\nIMS-ALG\nContext\nM\nThis information element indicates all context are where the command was executed.\nRoot Termination\nM\nThis information element indicates that root termination is where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.19.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.20",
      "section_id": "8.20",
      "section_title": "Inactivity Timeout Activate",
      "content": "This procedure is used to activate the inactivity timeout mechanism.\nTable 8.20.1: Procedures between IMS-ALG and IMS-AGW: Inactivity Timeout Activate\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nInactivity Timeout Activate\nIMS-ALG\nContext\nM\nThis information element indicates all context are applicable for the root termination.\nRoot Termination\nM\nThis information element indicates that root termination is where inactivity timeout mechanism was activated.\nInactivity Timeout Activate\nM\nThis information element activates the Inactivity Timeout request.\nInactivity Timeout\nO\nThis information element indicates the maximum length of time before triggering the related notification.\nInactivity Timeout Activate Ack\nIMS-AGW\nContext\nM\nThis information element indicates all context are where the command was executed.\nRoot Termination\nM\nThis information element indicates that root termination is where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.20.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.21",
      "section_id": "8.21",
      "section_title": "Inactivity Timeout Notification",
      "content": "This command is used to notify the IMS-ALG of an inactive control association.\nTable 8.21.1: Procedures between IMS-AGW  and IMS-ALG: Inactivity Timeout Notification\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nInactivity Timeout Notification\nIMS-AGW\nContext\nM\nThis information element indicates all context are applicable for the root termination.\nRoot Termination\nM\nThis information element indicates that root termination is where the inactivity timeout mechanism was activated.\nInactivity Timeout Notification\nM\nThis information element notifies the IMS-ALG of an inactivity time period.\nInactivity Timeout Notifcation Ack\nIMS-ALG\nContext\nM\nThis information element indicates all context are where the command was executed.\nRoot Termination\nM\nThis information element indicates that root termination is where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.21.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.22",
      "section_id": "8.22",
      "section_title": "Command Reject",
      "content": "This command is used to reject the received command request. It may be used as response to any of the procedures.\nTable 8.22.1: Procedures between IMS-ALG and IMS-AGW: Command Reject\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nCommand Reject\nBoth\nContext\nO\nThis information element indicates the context where the command was rejected.\nBearer Termination\nO\nThis information element indicates the bearer termination where the command was rejected.\nError\nM\nThis information element indicates the error that caused command rejection.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.22.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.23",
      "section_id": "8.23",
      "section_title": "Realm Availability Activate",
      "content": "This command is used to request the IMS-AGW to monitor the status of its IP Realms and to report any changes to the IMS-ALG.\nTable 8.23.1: Procedures between IMS-ALG and IMS-AGW: Realm Availability Activate\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nRealm Availability Activate\nIMS-ALG\nContext\nM\nThis information element indicates all context are applicable for the root termination.\nRoot Termination\nM\nThis information element indicates that root termination is where the realm availability monitoring was activated.\nRealm Availability Activate\nM\nThis information element activates the monitoring of the availability of IP Realms on the IMS-AGW.\nRealm Availability Activate Ack\nIMS-AGW\nContext\nM\nThis information element indicates all context are where the command was executed.\nRoot Termination\nM\nThis information element indicates that root termination is where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.23.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.24",
      "section_id": "8.24",
      "section_title": "Realm Availability Notification",
      "content": "This command is used to notify the IMS-ALG of any changes in the availability of IP Realms on the IMS-AGW.\nTable 8.24.1: Procedures between IMS-ALG and IMS-AGW: Realm Availability Notification\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nRealm Availability Notification\nIMS-AGW\nContext\nM\nThis information element indicates all context are applicable for the root termination.\nRoot Termination\nM\nThis information element indicates that root termination is where the realm availability monitoring was activated.\nRealm Availability Changes\nM\nThis information element notifies the IMS-ALG of newly available/unavailable IP Realms.\nRealm Availability Notifcation Ack\nIMS-ALG\nContext\nM\nThis information element indicates all context are where the command was executed.\nRoot Termination\nM\nThis information element indicates that root termination is where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.24.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.25",
      "section_id": "8.25",
      "section_title": "IP Bearer Released",
      "content": "Table 8.25.1: Procedures between IMS-ALG and IMS-AGW: IP Bearer Released\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nIP Bearer Released\nIMS-AGW\nContext\nM\nThis information element indicates the context for the bearer termination.\nBearer Termination\nM\nThis information element indicates the bearer termination where the bearer was released.\nBearer Released\nM\nThis information element notifies a bearer release.\nRelease Cause\nM\nThis information element indicates the cause of a bearer release.\nIP Bearer Released Ack\nIMS-ALG\nContext\nM\nThis information element indicates all context are where the command was executed.\nBearer Termination\nM\nThis information element indicates that Bearer termination is where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.25.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.26",
      "section_id": "8.26",
      "section_title": "Media Inactivity Notification",
      "content": "This command is used to notify the IMS-ALG of media inactivity on the IMS-AGW.\nTable 8.26.1: Procedures between IMS-ALG and IMS-AGW: Media Inactivity Notification\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nMedia Inactivity Notification\nIMS-AGW\nContext\nM\nThis information element indicates the existing context for the bearer termination.\nBearer Termination\nM\nThis information element indicates that bearer termination is where the media inactivity detection was activated.\nMedia Inactivity\nM\nThis information element notifies the IMS-ALG of Media inactivity detection on the bearer termination.\nMedia Inactivity Notification Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.26.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.27",
      "section_id": "8.27",
      "section_title": "Termination Out-of-Service",
      "content": "This procedure is used to indicate that a termination on the IMS-AGW has gone out of service\nTable 8.27.1: Procedures between IMS-ALG and IMS-AGW: Termination Out-of-Service\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nTermination Out-of-Service\nIMS-AGW\nContext\nM\nThis information element indicates the context for the command.\nBearer Termination\nM\nThis information element indicates the bearer termination(s) for the command.\nReason\nM\nThis information element indicates the reason for service change.\nMethod\nM\nThis information element indicates the method for service change.\nTermination Out-of-Service Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination(s) where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.27.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.28",
      "section_id": "8.28",
      "section_title": "Change Through-Connection",
      "content": "This procedure is used to change the through-connection in the bearer termination\nTable 8.28.1: Procedures between IMS-ALG and IMS-AGW: Change Through-Connection\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nChange Through-Connection\nIMS-ALG\nContext/Context Request\nM\nThis information element indicates the existing context or requests a new context for the bearer termination.\nBearer Termination/Bearer Termination Request\nM\nThis information element indicates the existing bearer termination or requests a new bearer termination where the through-connection is changed.\nThrough-Connection\nM\nThis information element indicates the through-connection of the bearer termination\nChange Through-Connection Ack\nIMS-AGW\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.\nNOTE:\tThis procedure may be combined with Reserve and Configure AGW Connection Point, Reserve AGW Connection Point or Configure AGW Connection Point procedure. This list of procedures is not exhaustive.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.28.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.29",
      "section_id": "8.29",
      "section_title": "Change Flow Direction",
      "content": "This procedure is used to change the flow direction between bearer terminations within the context.\nTable 8.29: Procedures between IMS-ALG and IMS-AGW: Configure AGW Connection Point\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nChange Flow Direction\nIMS-ALG\nContext/Context Request\nM\nThis information element indicates the existing context or a new context where the flow direction is changed.\nBearer Termination 1/ Bearer Termination 1 Request\nM\nThis information element indicates the existing bearer termination or a new bearer termination from where the new flow direction is applied.\nBearer Termination 2/ Bearer Termination 2 Request\nM\nThis information element indicates the existing bearer termination or a new bearer termination where to the new flow direction is applied.\nFlow Direction\nM\nThis information element indicates the flow direction from the bearer termination 1 to bearer termination 2 within the context.\nChange Flow Direction Ack\nIMS-AGW\nContext\nM\nThis information element indicates the context where the command was executed.",
      "chunk_type": "procedure",
      "cross_references": [
        "table_8.29"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.30",
      "section_id": "8.30",
      "section_title": "ECN Failure Indication",
      "content": "This procedure is used to report ECN related failures (see clause 6.2.13.4).\nTable 8.30.1: Procedures between IMS-ALG and IMS-AGW: ECN Failure Indication\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nECN Failure Indication\nIMS-AGW\nContext\nM\nThis information element indicates the context for the bearer termination.\nBearer Termination\nM\nThis information element indicates the bearer termination for which the ECN failure is reported.\nECN Error Indication\nM\nThis information element indicates an ECN failure event.\nECN Failure Indication Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.13.4",
        "table_8.30.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.31",
      "section_id": "8.31",
      "section_title": "Notify (D)TLS session establishment Failure Indication",
      "content": "This procedure is used to report (D)TLS session establishment failures.\nTable 8.31.1: Procedures between IMS-ALG and IMS-AGW: (D)TLS session establishment Failure Indication\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\n(D)TLS session establishment Failure Indication\nIMS-AGW\nContext\nM\nThis information element indicates the context for the bearer termination.\nBearer Termination\nM\nThis information element indicates the bearer termination for which the (D)TLS session establishment failure is reported.\n(D)TLS session establishment Error Indication\nM\nThis information element indicates a (D)TLS session establishment failure event.\n(D)TLS session establishment Failure Indication Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.31.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.32",
      "section_id": "8.32",
      "section_title": "Notify TCP connection establishment Failure Indication",
      "content": "This procedure is used to report TCP connection establishment failures.\nTable 8.32.1: Procedures between IMS-ALG and IMS-AGW: TCP connection establishment Failure Indication\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nTCP connection establishment Failure Indication\nIMS-AGW\nContext\nM\nThis information element indicates the context for the bearer termination.\nBearer Termination\nM\nThis information element indicates the bearer termination for which the TCP connection establishment failure is reported.\nTCP connection establishment Error Indication\nM\nThis information element indicates a TCP connection establishment failure event.\nTCP connection establishment Failure Indication Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.32.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.33",
      "section_id": "8.33",
      "section_title": "ICE Connectivity Check Result Notification",
      "content": "This procedure is used to report ICE connectivity check result for Full ICE (see clause 6.2.17.3).\nTable 8.33.1: Procedures between IMS-ALG and IMS-AGW: ICE Connectivity Check Result Notification\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nICE Connectivity Check Result Notification\nIMS-AGW\nContext\nM\nThis information element indicates the context for the bearer termination.\nBearer Termination\nM\nThis information element indicates the bearer termination for which the ICE Connectivity Check Result is reported.\nICE Connectivity Check Result\nM\nThis information element indicates an ICE Connectivity Check Result event.\nICE Connectivity Check Result Notification Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.17.3",
        "table_8.33.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.34",
      "section_id": "8.34",
      "section_title": "ICE New Peer Reflexive Candidate Notification",
      "content": "This procedure is used to report ICE new peer reflexive candidate for Full ICE (see clause 6.2.17.4).\nTable 8.34.1: Procedures between IMS-ALG and IMS-AGW: ICE New Peer Reflexive Candidate Notification\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nICE New Peer Reflexive Candidate Notification\nIMS-AGW\nContext\nM\nThis information element indicates the context for the bearer termination.\nBearer Termination\nM\nThis information element indicates the bearer termination for which the ICE New Peer Reflexive Candidate is reported.\nICE New Peer Reflexive Candidate\nM\nThis information element indicates an ICE New Peer Reflexive Candidate event.\nICE New Peer Reflexive Candidate Notification Ack\nIMS-ALG\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.17.4",
        "table_8.34.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.35",
      "section_id": "8.35",
      "section_title": "STUN Consent Freshness Test Failure Notification",
      "content": "This procedure is used to report STUN consent freshness test failures.\nTable 8.35.1: Procedures between eP-CSCF and eIMS-AGW: STUN Consent Freshness Test Failure Notification\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nSTUN consent freshness test Failure Notification\neIMS-AGW\nContext\nM\nThis information element indicates the context for the bearer termination.\nBearer Termination\nM\nThis information element indicates the bearer termination for which the STUN consent freshness test failure is reported.\nSTUN consent freshness test failure\nM\nThis information indicates a STUN consent freshness failure event.\nSTUN consent freshness test Failure Notification\neP-CSCF\nContext\nM\nThis information element indicates the context where the command was executed.\nBearer Termination\nM\nThis information element indicates the bearer termination where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.35.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.36",
      "section_id": "8.36",
      "section_title": "Notify SCTP Stream Reset",
      "content": "Table 8.36.1: Procedures between IMS-ALG and IMS-AGW: Notify SCTP Stream Reset\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nNotify SCTP Stream Reset\nIMS-AGW\nContext\nM\nThis information element indicates the context for the bearer termination.\nBearer Termination\nM\nThis information element indicates the bearer termination where the bearer was released.\nReceived SCTP Stream Reset Request\nM\nThis information element indicates that an SCTP Stream reset request has been received\nSCTP Stream ID\nM\nThis information element indicates the SCTP Stream ID of the related SCTP Stream.\nNotify SCTP Stream Reset Ack\nIMS-ALG\nContext\nM\nThis information element indicates all context are where the command was executed.\nBearer Termination\nM\nThis information element indicates that Bearer termination is where the command was executed.",
      "chunk_type": "general",
      "cross_references": [
        "table_8.36.1"
      ]
    },
    {
      "chunk_id": "ts_23.334_8.37",
      "section_id": "8.37",
      "section_title": "Notify SCTP Stream Reset Result",
      "content": "Table 8.37.1: Procedures between IMS-ALG and IMS-AGW: Notify SCTP Stream Reset Result\nProcedure\nInitiated\nInformation element name\nInformation element required\nInformation element description\nNotify SCTP Stream Reset Result\nIMS-AGW\nContext\nM\nThis information element indicates the context for the bearer termination.\nBearer Termination\nM\nThis information element indicates the bearer termination where the bearer was released.\nReceived SCTP Stream Reset Result\nM\nThis information element indicates that an SCTP Stream reset result has been received and the received result.\nSCTP Stream ID\nM\nThis information element indicates the SCTP Stream ID of the related SCTP Stream.\nNotify SCTP Stream Reset Result Ack\nIMS-ALG\nContext\nM\nThis information element indicates all context are where the command was executed.\nBearer Termination\nM\nThis information element indicates that Bearer termination is where the command was executed.\nAnnex A (informative):Change history\nDate\nTSG #\nTSG Doc.\nCR\nRev\nCat\nSubject/Comment\nNew\n2009-12\nCT#46\nCP-090822\n3GPP TS Presented for approval in CT#46\n9.0.0\n2009-12\nEditiorial clean up\n9.0.1\n2010-03\nCT#47\nCP-100050\n0001\n2\nIMS media plane security stage 2\n9.1.0\n2010-06\nCT#48\nCP-100289\n0003\n1\nTransport protocol to be indicated to gateway for end-to-end media security\n9.2.0\n2010-06\nCT#48\nCP-100284\n0004\n1\nHandling of Through Connection\n9.2.0\n2010-06\nCT#48\n0005\n-\nHandling of RTCP streams requirement update\n9.2.0\n2010-09\nCT#49\nCP-100461\n0006\n1\nProcedures for Emergency call\n9.3.0\n2010-09\nCT#49\n0007\n1\nLocal IP Resources IE: changing of property\n9.3.0\n2010-12\nCT#50\nCP-100685\n0008\n-\nSupport of ECN\n10.0.0\n2011-03\nCT#51\nCP-110058\n0009\n2\nHandling of ICE Initialisation method for ECN\n10.1.0\n2011-03\nCT#51\n0010\n2\nECN Support in Iq Interface\n10.1.0\n2011-09\nCT#53\nCP-110573\n0011\n2\nTranscoding at ATCF/ATGW during eSRVCC\n10.2.0\n2011-12\nCT#54\nCP-110798\n0012\n1\nExplicit Congestion Notification\n10.3.0\n2011-12\nCT#54\nCP-110798\n0013\n1\nCorrections to Stage 2 Procedures for Access Transfer Function\n10.3.0\n2012-03\nCT#55\nCP-120046\n0014\n2\nFunctional Requirements for eMPS MGW control\n11.0.0\n2012-06\nCT#56\nCP-120239\n0015\n3\nMultimedia Priority Control of Media Gateway resources\n11.1.0\n2012-06\nCT#56\nCP-120226\n0018\n1\nReference update: draft-ietf-avtcore-ecn-for-rtp\n11.1.0\n2012-11\nVersion in the header corrected\n11.1.1\n2012-12\nCT#58\nCP-120723\n0025\n-\nReference update: RFC 6679\n11.2.0\n2012-12\nCT#58\nCP-120734\n0026\n3\nSupport of Multimedia Priority Service (MPS) in Modify over Iq Interface\n11.2.0\n2013-06\nCT#60\nCP-130299\n0029\n3\nIntroduction of support for Coordination of Video Orientation (CVO)\n12.0.0\n2013-09\nCT#61\nCP-130471\n0030\n3\nIntroduction of support for Generic Image Attribute/signalling of image size\n12.1.0\n2013-09\nCT#61\nCP-130452\n0034\n2\nCVO Procedural Clarifications\n12.1.0\n2013-12\nCT#62\nCP-130636\n0035\n1\nUsage of generic image attributes\n12.2.0\n2013-12\nCT#62\nCP-130636\n0038\n1\nCorrection of Image Size description\n12.2.0\n2013-12\nCT#62\nCP-130619\n0037\n1\nCorrection of CVO description\n12.2.0\n2014-03\nCT#63\nCP-140025\n0040\n-\nAlignment of IE name for CVO\n12.3.0\n2014-06\nCT#64\nCP-140245\n0041\n1\ne2e media security for TCP-based media using TLS – Functional requirements\n12.4.0\n2014-06\nCT#64\nCP-140245\n0042\n4\ne2ae media security for TCP based media using TLS – Functional requirements\n12.4.0\n2014-06\nCT#64\nCP-140245\n0043\n2\ne2ae media security for UDP-based media using DTLS – Functional requirements\n12.4.0\n2014-06\nCT#64\nCP-140245\n0054\n1\ne2e media security for TCP-based media using TLS - Procedures\n12.4.0\n2014-06\nCT#64\nCP-140245\n0055\n2\ne2ae media security for TCP-based media using TLS - Procedures\n12.4.0\n2014-06\nCT#64\nCP-140245\n0056\n1\ne2ae media security for UDP-based media using DTLS – procedures\n12.4.0\n2014-06\nCT#64\nCP-140245\n0057\n3\nIq requirements for end-to-end TCP bearer connection control and related NAT traversal support\n12.4.0\n2014-06\nCT#64\nCP-140256\n0045\n1\nFunctional requirements – clarification of \"stage 2\" convention\n12.4.0\n2014-06\nCT#64\nCP-140248\n0046\n3\nSupport for Interactive Connectivity Establishment (ICE)\n12.4.0\n2014-06\nCT#64\nCP-140249\n0052\n2\nWebRTC media security using DTLS-SRTP\n12.4.0\n2014-06\nCT#64\nCP-140249\n0053\n2\nWebRTC support for Iq\n12.4.0\n2014-09\nCT#65\nCP-140504\n0058\n1\nProcedures for TCP bearer connection control\n12.5.0\n2014-09\nCT#65\nCP-140504\n0060\n1\nBandwidth adjustment due to e2ae media security\n12.5.0\n2014-09\nCT#65\nCP-140504\n0061\n-\nMSRP handling\n12.5.0\n2014-12\nCT#66\nCP-140798\n0047\n3\nRTCP port allocation rules – Semantical clarification\n12.6.0\n2014-12\nCT#66\nCP-140786\n0062\n2\nE2e media security for TCP-based media – terminals behind NAT\n12.6.0\n2014-12\nCT#66\nCP-140786\n0066\n-\nReference update: RFC 7345 (draft-ietf-mmusic-udptl-dtls)\n12.6.0\n2014-12\nCT#66\nCP-140786\n0074\n-\nReference update: draft-schwarz-mmusic-sdp-for-gw\n12.6.0\n2014-12\nCT#66\nCP-140786\n0075\n2\nClient-initiated TLS session renegotiation not supported on the Iq interface\n12.6.0\n2014-12\nCT#66\nCP-140777\n0063\n1\nWebRTC Architecture Update\n12.6.0\n2014-12\nCT#66\nCP-140777\n0064\n4\nConsent Refreshness in WebRTC\n12.6.0\n2014-12\nCT#66\nCP-140777\n0067\n4\nH.248 requirements for WebRTC\n12.6.0\n2014-12\nCT#66\nCP-140777\n0068\n3\nIq requirements for OPUS codec in WebRTC\n12.6.0\n2014-12\nCT#66\nCP-140777\n0069\n3\nIq requirements for ICE-TCP\n12.6.0\n2014-12\nCT#66\nCP-140777\n0072\n5\nEnd-to-access-edge security for DTLS over TCP\n12.6.0\n2014-12\nCT#66\nCP-140788\n0070\n3\nIq requirements for EVS\n12.6.0\n2014-12\nCT#66\nCP-140791\n0071\n3\nAlternative connection (ALTC) addresses management\n12.6.0\n2014-12\nCT#66\nCP-140799\n0039\n7\nSupport of RTP transport multiplexing (Iq, stage 2)\n13.0.0\n2015-03\nCT#67\nCP-150027\n0077\n1\nIMS WebRTC reference updates\n13.1.0\n2015-03\nCT#67\nCP-150030\n0079\n1\nDTLS roles and cross-reference correction\n13.1.0\n2015-06\nCT#68\nCP-150258\n0085\n-\n3GPP TLS profile reference\n13.2.0\n2015-06\nCT#68\nCP-150260\n0083\n1\nBearer Termination in Acknowledgements\n13.2.0\n2015-06\nCT#68\nCP-150259\n0081\n1\nEVS corrections\n13.2.0\n2015-09\nCT#69\nCP-150457\n0088\n2\nMSRP and WebRTC data channels\n13.3.0\n2015-09\nCT#69\nCP-150452\n0091\n4\nSupport for Video Enhancements by Region-of-Interest Information Signalling\n13.3.0\n2015-12\nCT#70\nCP-150786\n0092\n7\nSupport of SDP capability negotiation\n13.4.0\n2015-12\nCT#70\nCP-150779\n0093\n4\nWebRTC Data Channel Call flows\n13.4.0\n2015-12\nCT#70\nCP-150779\n0095\n3\nUpdate of WebRTC data channel references\n13.4.0\n2015-12\nCT#70\nCP-150779\n0100\n2\nSupport of WebRTC data channels (stage 2)\n13.4.0\n2015-12\nCT#70\nCP-150779\n0101\n1\nWebRTC Data Channel Procedures\n13.4.0\n2015-12\nCT#70\nCP-150779\n0102\n1\nWebRTC Data Channel Information Elements\n13.4.0\n2015-12\nCT#70\nCP-150779\n0094\n4\nSupport for Video Enhancements by Region-of-Interest Information Signalling\n13.4.0\n2015-12\nCT#70\nCP-150779\n0097\n1\nUpdate of media security references\n13.4.0\n2015-12\nCT#70\nCP-150779\n0099\n2\nUpdate of IMS WebRTC references\n13.4.0\n2016-03\nCT#71\nCP-160015\n0109\n1\nCorrections to EVS AMR-WB IO mode-change-capability MIME parameter handling\n13.5.0\n2016-03\nCT#71\nCP-160028\n0104\n2\nRelease of WebRTC Data Channels\n13.5.0\n2016-03\nCT#71\nCP-160034\n0106\n2\nSupport of enhanced bandwidth negotiation mechanism for MTSI sessions\n13.5.0\n2016-03\nCT#71\nCP-160032\n0107\n2\nWebRTC media plane optimization procedure\n13.5.0\n2016-09\nCT#73\nCP-160429\n0112\n1\nMandatory support of RTP/RTCP multiplexing\n14.0.0\n2016-09\nCT#73\nCP-160429\n0114\n1\nTransport of T.140 and BFCP within data channels\n14.0.0\n2016-12\nCT#74\nCP-160684\n0115\n1\nSupport of RTP-level pause and resume functionality\n14.1.0\n2016-12\nCT#74\nCP-160648\n0116\n4\nSDP offer/answer for TLS and DTLS protected media\n14.1.0\n2016-12\nCT#74\nCP-160671\n0118\n2\nWebRTC Media plane optimization with DTLS termination\n14.1.0\n2016-12\nCT#74\nCP-160671\n0119\n1\nTCP transport for WebRTC data channels\n14.1.0\n2016-12\nCT#74\nCP-160647\n0125\n1\nCorrections to handling of the DTX related EVS MIME parameter\n14.1.0\n2016-12\nCT#74\nCP-160661\n0127\n2\nReference update for draft-ietf-mmusic-data-channel-sdpneg\n14.1.0\n2017-03\nCT#75\nCP-170023\n0129\n-\nReference update: draft-ietf-mmusic-dtls-sdp\n14.2.0\n2017-03\nCT#75\nCP-170023\n0131\n-\nRFC 4572 obsoleted by draft-ietf-mmusic-4572-update\n14.2.0\n2017-03\nCT#75\nCP-170030\n0135\n1\nUpdates for WebRTC media plane optimization procedures related to the usage of the \"dtls-id\" SDP attribute and multiple fingerprints\n14.2.0\n2017-03\nCT#75\nCP-170033\n0132\n-\nReference update: RFC 8035\n14.2.0\n2017-03\nCT#75\nCP-170051\n0133\n2\nRTCP Codec Control Commands and Indications\n14.2.0\n2017-06\nCT#76\nCP-171015\n0137\n-\nReference update: RFC 8122\n14.3.0\n2017-06\nCT#76\nCP-171027\n0138\n-\nReference update: draft-ietf-mmusic-mux-exclusive\n14.3.0\n2017-06\nCT#76\nCP-171024\n0140\n-\nReference update: draft-ietf-mmusic-sctp-sdp\n14.3.0\n2017-06\nCT#76\nCP-171015\n0142\n-\nReference update: draft-ietf-mmusic-dtls-sdp\n14.3.0\n2017-12\nCT#78\nCP-173014\n0144\n-\nReference update: draft-ietf-mmusic-dtls-sdp\n14.4.0\n2018-03\nCT#79\nCP-180014\n0145\n1\nRemoval of IETF draft for transport BFCP within data channels\n14.5.0\n2018-06\nCT#80\n-\n-\n-\nUpdate to Rel-15 version (MCC)\n15.0.0\n2019-06\nCT#84\nCP-191053\n0149\n2\nUpdate IMS-ALG/IMS-AGW procedures for DBI support\n16.0.0\n2019-12\nCT#86\nCP-193019\n0156\n-\nReference update: draft-ietf-mmusic-msrp-usage-data-channel\n16.1.0\n2019-12\nCT#86\nCP-193021\n0152\n1\nReference update: draft-ietf-mmusic-t140-usage-data-channel\n16.1.0\n2020-12\nCT#90e\nCP-203024\n0164\n-\nUpdate on draft references\n16.2.0\n2020-12\nCT#90e\nCP-203025\n0159\n-\nReference update: draft-ietf-mmusic-t140-usage-data-channel\n16.2.0\n2021-03\nCT#91e\nCP-210065\n0168\n-\nReference update: RFC 8842\n16.3.0\n2021-03\nCT#91e\nCP-210066\n0172\n-\nReference update: RFC 8831, RFC 8841, RFC 8864 and RFC 8873\n16.3.0\n2021-03\nCT#91e\nCP-210068\n0175\n-\nReference update: RFC 8858 and RFC 8865\n16.3.0\n2021-03\nCT#91e\nCP-213104\n0176\n-\nB\nAlignment with SA3 supported TLS profiles\n17.0.0\n2022-03\nCT#95e\nCP-220052\n0177\n1\nB\nUpdate of IETF references for ICE, STUN and TURN\n17.1.0\n2022-06\nCT#96\nCP-221041\n0178\n1\nB\nSupport of e2ae security using DTLS-SRTP for non WebRTC sessions\n17.2.0\n2024-03\nCT#103\nCP-240076\n0184\n1\nA\nIETF reference cleanup\n17.3.0\n2024-03\n-\n-\n-\n-\nUpdate to Rel-18 version (MCC)\n18.0.0\n2024-06\nCT#104\nCP-241037\n0185\n1\nB\nAdding support for IVAS codec\n18.1.0",
      "chunk_type": "general",
      "cross_references": [
        "table_8.37.1",
        "ts_12.4",
        "ts_13.2",
        "ts_13.4",
        "ts_14.2"
      ]
    }
  ]
}
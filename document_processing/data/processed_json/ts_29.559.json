{
  "metadata": {
    "specification_id": "ts_29.559",
    "version": "18.3.0",
    "title": "3GPP TS 29.559",
    "file_path": "/content/drive/MyDrive/RAG_thesis/data/29_series/29559-i30/29559-i30.docx"
  },
  "export_info": {
    "export_date": "2025-07-26T08:47:02.497553",
    "total_chunks": 101
  },
  "chunks": [
    {
      "chunk_id": "ts_29.559_1",
      "section_id": "1",
      "section_title": "Scope",
      "content": "The present document specifies the stage 3 protocol and data model for the Npkmf Service Based Interface. It provides stage 3 protocol definitions and message flows, and specifies the API for each service offered by the 5G PKMF as specified in 3GPP TS 33.503 [4].\nThe 5G System stage 2 architecture and procedures are specified in 3GPP TS 23.501 [2] and 3GPP TS 23.502 [3].\nThe Technical Realization of the Service Based Architecture and the Principles and Guidelines for Services Definition are specified in 3GPP TS 29.500 [5] and 3GPP TS 29.501 [6].",
      "chunk_type": "general",
      "cross_references": [
        "ts_33.503",
        "ts_23.501",
        "ts_23.502",
        "ts_29.500",
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.559_2",
      "section_id": "2",
      "section_title": "References",
      "content": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non‑specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[3]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".\n[4]\t3GPP TS 33.503: \"Security Aspects of Proximity based Services (ProSe) in the 5G System (5GS)\".\n[5]\t3GPP TS 29.500: \"5G System; Technical Realization of Service Based Architecture; Stage 3\".\n[6]\t3GPP TS 29.501: \"5G System; Principles and Guidelines for Services Definition; Stage 3\".\n[7]\tOpenAPI : \"OpenAPI Specification Version 3.0.0\", https://spec.openapis.org/oas/v3.0.0.\n[8]\tIETF RFC 9113: \"HTTP/2\".\n[9]\tIETF RFC 8259: \"The JavaScript Object Notation (JSON) Data Interchange Format\".\n[10]\tIETF RFC 9457: \"Problem Details for HTTP APIs\".\n[11]\t3GPP TS 33.501: \"Security architecture and procedures for 5G system\".\n[12]\tIETF RFC 6749: \"The OAuth 2.0 Authorization Framework\".\n[13]\t3GPP TS 29.510: \"Network Function Repository Services; Stage 3\".\n[14]\t3GPP TR 21.900: \"Technical Specification Group working methods\".\n[15]\t3GPP TS 29.571: \"5G System; Common Data Types for Service Based Interfaces; Stage 3\".\n[16]\t3GPP TS 24.554: \"Proximity-services (ProSe) in 5G System (5GS) protocol aspects; Stage 3\".\n[17]\t3GPP TS 29.503: \"5G System; Unified Data Management Services; Stage 3\".\n[18]\t3GPP TS 29.509: \"5G System; Authentication Server Services; Stage 3\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905",
        "ts_23.501",
        "ts_23.502",
        "ts_33.503",
        "ts_29.500",
        "ts_29.501",
        "ts_33.501",
        "ts_29.510",
        "ts_21.900",
        "ts_29.571",
        "ts_24.554",
        "ts_29.503",
        "ts_29.509"
      ]
    },
    {
      "chunk_id": "ts_29.559_3.1",
      "section_id": "3.1",
      "section_title": "Terms",
      "content": "For the purposes of the present document, the terms given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905"
      ]
    },
    {
      "chunk_id": "ts_29.559_3.2",
      "section_id": "3.2",
      "section_title": "Symbols",
      "content": "Void",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_3.3",
      "section_id": "3.3",
      "section_title": "Abbreviations",
      "content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\n5G PKMF\t5G ProSe Key Management Function\n5G ProSe\t5G Proximity based Services\nRPAUID\tRestricted ProSe Application User ID\nPDUID\tProSe Discovery UE ID\nUP-PRUK\tUser Plane ProSe Remote User Key",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905"
      ]
    },
    {
      "chunk_id": "ts_29.559_4",
      "section_id": "4",
      "section_title": "Overview",
      "content": "The 5G ProSe Key Management Function (5G PKMF) is the logical function handling network related actions required for the key management and the security material for discovery of a 5G ProSe UE-to-Network Relay by a 5G ProSe Remote UE, for establishing a secure PC5 communication link between a 5G ProSe Remote UE and 5G ProSe UE-to-Network Relay, for discovery of a 5G ProSe UE-to-UE Relay by a 5G ProSe End UE, and for establishing a secure PC5 communication link between a 5G ProSe End UE and a 5G ProSe UE-to-UE Relay (see 3GPP TS 33.503 [4]).\nFigure 4-1 provides the reference model (in service based interface representation and in reference point representation), with focus on the 5G PKMF:\nFigure 4-1: Reference model – 5G PKMF\nThe functionalities supported by the 5G PKMF are listed in clause 4.2.1.2 of 3GPP TS 33.503 [4].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_33.503_clause_4.2.1.2",
        "ts_33.503_figure_4-1",
        "figure_4-1",
        "ts_33.503"
      ]
    },
    {
      "chunk_id": "ts_29.559_5.1",
      "section_id": "5.1",
      "section_title": "Introduction",
      "content": "The table 5.1-1 shows the 5G PKMF Services and 5G PKMF Service Operations:\nTable 5.1-1: List of 5G PKMF Services\nService Name\nService Operations\nOperation\nSemantics\nExample Consumer(s)\nNpkmf_PKMFKeyRequest\nProseKey\nRequest/Response\n5G PKMF\nNpkmf_ResolveRemoteUserId\nRetrieve\nRequest/Response\nSMF, 5G PKMF\nNpkmf_Discovery\nAnnounceAuthorize\nRequest/Response\n5G PKMF\nMonitorKey\nRequest/Response\n5G PKMF\nDiscoveryKey\nRequest/Response\n5G PKMF\nTable 5.1-2 summarizes the corresponding APIs defined for this specification.\nTable 5.1-2: API Descriptions\nService Name\nClause\nDescription\nOpenAPI Specification File\napiName\nAnnex\nNpkmf_PKMFKeyRequest\n6.1\nPKMF Key Request Service\nTS29559_Npkmf_PKMFKeyRequest.yaml\nnpkmf-keyrequest\nA.2\nNpkmf_ResolveRemoteUserId\n6.2\nPKMF Resolve Remote User ID Service\nTS29559_Npkmf_UserId.yaml\nnpkmf-userid\nA.3\nNpkmf_Discovery\n6.3\nPKMF Discovery Service\nTS29559_Npkmf_Discovery.yaml\nnpkmf-disc\nA.4",
      "chunk_type": "general",
      "cross_references": [
        "table_5.1-1",
        "table_5.1-2"
      ]
    },
    {
      "chunk_id": "ts_29.559_5.2.1",
      "section_id": "5.2.1",
      "section_title": "Service Description",
      "content": "This service enables an NF (i.e. another 5G PKMF in another PLMN) to request information related to 5G ProSe keying. The following are the key functionalities of this NF service.\n-\tProvide 5G ProSe related keying material",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_5.2.2.2.1",
      "section_id": "5.2.2.2.1",
      "section_title": "General",
      "content": "The ProseKey service operation is invoked by a NF Service Consumer, i.e. another 5G PKMF in another PLMN, towards the 5G PKMF to retrieve the keying material related to 5G ProSe.\nThe ProseKey service operation is used during the following procedure:\n-\tPC5 security establishment for 5G ProSe UE-to-Network relay communication over User Plane (see 3GPP TS 33.503 [4], clause 6.3.3.2.2)\nThe NF Service Consumer (i.e. another 5G PKMF in another PLMN) shall retrieve the 5G ProSe related keying material by invoking the \"request \" custom method on the resource URI of \"Prose Keys Collection\" resource, see clause 6.1.3.2.4. See also Figure 5.2.2.2.1-1.\nFigure 5.2.2.2.1-1 ProseKey service operation\n1.\tThe NF Service Consumer shall send a HTTP POST request to invoke \"request\" custom method. The payload of the request shall be an object of \"ProseKeyReqData\" data type.\tThe payload shall include the Relay Service Code, the KNRP freshness parameter 1, and either the SUCI of the 5G ProSe UE (Remote UE or End UE) or the UP-PRUK ID.\n2a.\tOn success, the 5G PKMF shall respond with the status code \"200 OK\". The payload of the response shall be an object of \"ProseKeyRspData\" data type. They payload shall include the KNRP, the KNRP freshness parameter 2 and optionally the GPI.\n2b.\tOn failure or redirection, one of the HTTP status codes listed in table 6.1.3.2.4.2.2-2 shall be returned. For a 4xx/5xx response, the message body shall contain a ProblemDetails structure with the \"cause\" attribute set to one of the application errors listed in table 6.1.3.2.4.2.2-2.\n3.\t[conditional] If synchronization failed when UE processes the authentication challenge in the GPI and a subsequent Key Request is send for resynchronization, the NF Service Consumer shall send a HTTP POST request to invoke \"request\" custom method. The payload of the request shall be an object of \"ProseKeyReqData\" data type. The payload shall include the Relay Service Code, the KNRP freshness parameter 1, the information for resynchronization (RAND and AUTS).\n4a.\tOn success, the 5G PKMF shall respond with the status code \"200 OK\". The payload of the response shall be an object of \"ProseKeyRspData\" data type. They payload shall include the KNRP, the KNRP freshness parameter 2 and the GPI.\n4b.\tOn failure or redirection, one of the HTTP status codes listed in table 6.1.3.2.4.2.2-2 shall be returned. For a 4xx/5xx response, the message body shall contain a ProblemDetails structure with the \"cause\" attribute set to one of the application errors listed in table 6.1.3.2.4.2.2-2.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_33.503_clause_6.3.3.2.2",
        "clause_6.1.3.2.4",
        "table_6.1.3.2.4.2.2-2",
        "figure_5.2.2.2.1-1",
        "ts_33.503"
      ]
    },
    {
      "chunk_id": "ts_29.559_5.3.1",
      "section_id": "5.3.1",
      "section_title": "Service Description",
      "content": "The Npkmf_ResolveRemoteUserId service enables a NF to request the 5G PKMF to resolve Remote User ID (i.e., UP-PRUK ID) to SUPI.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_5.3.2.1",
      "section_id": "5.3.2.1",
      "section_title": "Introduction",
      "content": "The service operation defined for the Npkmf_ResolveRemoteUserId service is as follows:\n-\tRetrieve: It allows a consumer NF to get an user’s SUPI from Remote User ID.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_5.3.2.2.1",
      "section_id": "5.3.2.2.1",
      "section_title": "General",
      "content": "The Retrieve service operation is used during the following procedure:\n-\tPC5 security establishment for 5G ProSe UE-to-Network relay communication over User Plane (see 3GPP TS 33.503 [4], clause 6.3.3.2.2)\nThe NF Service Consumer (e.g., SMF, 5G PKMF) shall request the 5G PKMF to get the SUPI of a 5G ProSe Remote UE as shown in Figure 5.3.2.2.1-1\nFigure 5.3.2.2.1-1: Requesting the SUPI of a ProSe Remote UE\n1.\tThe NF service consumer (e.g., SMF, 5G PKMF) sends a POST request to the resource representing the resolve-id custom operation. The request body shall contain the UP-PRUK ID.\n2a.\tOn success, the 5G PKMF responds with \"200 OK\" with the message body containing the corresponding SUPI.\n2b.\tIf there is no valid data, HTTP status code \"404 Not Found\" shall be returned including additional error information in the response body (in the \"ProblemDetails\" element).\nOn failure, the appropriate HTTP status code indicating the error shall be returned and appropriate additional error information should be returned in the POST response body.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_33.503_clause_6.3.3.2.2",
        "figure_5.3.2.2.1-1",
        "ts_33.503"
      ]
    },
    {
      "chunk_id": "ts_29.559_5.4.1",
      "section_id": "5.4.1",
      "section_title": "Service Description",
      "content": "This service enables an NF (i.e. another 5G PKMF in another PLMN) to request authorization information. The following are the key functionalities of this NF service.\n-\tProvide the authorization from the 5G PKMF for announcing in the PLMN\n-\tProvide the discovery key from the 5G PKMF for monitoring in the PLMN\n-\tProvide the discovery key from the 5G PKMF for a discoverer UE in the PLMN to operate Model B restricted discovery",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_5.4.2.1",
      "section_id": "5.4.2.1",
      "section_title": "Introduction",
      "content": "The Npkmf_Discovery service supports following service operations:\n-\tAnnounceAuthorize\n-\tMonitorKey\n-\tDiscoveryKey",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_5.4.2.2.1",
      "section_id": "5.4.2.2.1",
      "section_title": "General",
      "content": "The AnnounceAuthorize service operation is invoked by a NF Service Consumer, i.e. another 5G PKMF in another PLMN, towards the 5G PKMF to retrieve the authorization from the 5G PKMF for announcing in the PLMN.\nThe NF Service Consumer (e.g., 5G PKMF) shall request the 5G PKMF to get authorization as shown in Figure 5.4.2.2.1-1\nFigure 5.4.2.2.1-1: Announce Authorize\n1.\tThe NF service consumer (e.g., 5G PKMF) sends a HTTP PUT request to the resource representing the announce-authorize custom operation. The request body shall contain the RSC.\n2a.\tIf the context indicated by the userInfoId doesn't exist, the 5G PKMF shall create the new resource, and upon success of creation of the resource, \"201 created\" shall be returned.\n2b.\tIf the context indicated by the userInfoId already exists, the 5G PKMF shall replace the stored data using the received data, and upon success of the update of the resource, \"204 No Content\" shall be returned.\n2c.\tOn failure or redirection, one of the HTTP status code listed in Table 6.3.3.2.3.1-3 may be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.3.3.2.3.1-3.",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.3.3.2.3.1-3",
        "figure_5.4.2.2.1-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_5.4.2.3.1",
      "section_id": "5.4.2.3.1",
      "section_title": "General",
      "content": "The MonitorKey service operation is invoked by a NF Service Consumer, i.e. another 5G PKMF in another PLMN, towards the 5G PKMF to retrieve the discovery key from the 5G PKMF for monitoring in the PLMN.\nThe NF Service Consumer (e.g., 5G PKMF) shall request the 5G PKMF to get authorization as shown in Figure 5.4.2.3.1-1\nFigure 5.4.2.3.2-1: Monitor Key\n1.\tThe NF Service Consumer (e.g., 5G PKMF) shall send an HTTP PUT request to the resource representing the monitor-key custom operation. The request body shall contain the RSC and PC5 UE security capability.\n2a.\tIf the context indicated by the userInfoId doesn't exist, the 5G PKMF shall create the new resource, and upon success of creation of the resource, \"201 created\" shall be returned.\n2b.\tIf the context indicated by the userInfoId already exists, the 5G PKMF shall replace the stored data using the received data, and upon success of the update of the resource, \"204 No Content\" shall be returned.\n2c.\tOn failure or redirection, one of the HTTP status code listed in Table 6.3.3.3.3.1-3 may be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.3.3.3.3.1-3.",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.3.3.3.3.1-3",
        "figure_5.4.2.3.1-1",
        "figure_5.4.2.3.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_5.4.2.4.1",
      "section_id": "5.4.2.4.1",
      "section_title": "General",
      "content": "The DiscoverKey service operation is invoked by a NF Service Consumer, i.e. another 5G PKMF in another PLMN, towards the 5G PKMF to retrieve the discovery key from the 5G PKMF for a discoverer UE in the PLMN to operate Model B restricted discovery.\nThe NF Service Consumer (e.g., 5G PKMF) shall request the 5G PKMF to get authorization as shown in Figure 5.4.2.4.1-1\nFigure 5.4.2.4.2-1: Discover Key\n1.\tThe NF Service Consumer (e.g., 5G PKMF) shall send an HTTP PUT request to the resource representing the monitor-key custom operation. The request body shall contain the RSC and PC5 UE security capability.\n2a.\tIf the context indicated by the userInfoId doesn't exist, the 5G PKMF shall create the new resource, and upon success of creation of the resource, \"201 created\" shall be returned.\n2b.\tIf the context indicated by the userInfoId already exists, the 5G PKMF shall replace the stored data using the received data, and upon success of the update of the resource, \"204 No Content\" shall be returned.\n2c.\tOn failure or redirection, one of the HTTP status code listed in Table 6.3.3.3.3.1-3 may be returned. For a 4xx/5xx response, the message body may contain a ProblemDetails structure with the \"cause\" attribute set to one of the application error listed in Table 6.3.3.3.3.1-3.",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.3.3.3.3.1-3",
        "figure_5.4.2.4.1-1",
        "figure_5.4.2.4.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.1",
      "section_id": "6.1.1",
      "section_title": "Introduction",
      "content": "The Npkmf_PKMFKeyRequest shall use the Npkmf_PKMFKeyRequest API.\nThe API URI of the Npkmf_PKMFKeyRequest API shall be:\n{apiRoot}/<apiName>/<apiVersion>\nThe request URIs used in HTTP requests from the NF service consumer towards the NF service producer shall have the Resource URI structure defined in clause 4.4.1 of 3GPP TS 29.501 [6], i.e.:\n{apiRoot}/<apiName>/<apiVersion>/<apiSpecificResourceUriPart>\nwith the following components:\n-\tThe {apiRoot} shall be set as described in 3GPP TS 29.501 [6].\n-\tThe <apiName> shall be \"npkmf-keyrequest \".\n-\tThe <apiVersion> shall be \"v1\".\n-\tThe <apiSpecificResourceUriPart> shall be set as described in clause 6.1.3.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.501_clause_4.4.1",
        "clause_6.1.3",
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.2.1",
      "section_id": "6.1.2.1",
      "section_title": "General",
      "content": "HTTP/2, IETF RFC 9113 [8], shall be used as specified in clause 5 of 3GPP TS 29.500 [5].\nHTTP/2 shall be transported as specified in clause 5.3 of 3GPP TS 29.500 [5].\nThe OpenAPI [7] specification of HTTP messages and content bodies for the Npkmf_PKMFKeyRequest API is contained in Annex A.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5",
        "ts_29.500_clause_5.3",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.2.2.1",
      "section_id": "6.1.2.2.1",
      "section_title": "General",
      "content": "See clause 5.2.2 of 3GPP TS 29.500 [5] for the usage of HTTP standard headers.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.2",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.2.2.2",
      "section_id": "6.1.2.2.2",
      "section_title": "Content type",
      "content": "JSON, IETF RFC 8259 [9], shall be used as content type of the HTTP bodies specified in the present specification as specified in clause 5.4 of 3GPP TS 29.500 [5]. The use of the JSON format shall be signalled by the content type \"application/json\".\n\"Problem Details\" JSON object shall be used to indicate additional details of the error in a HTTP response body and shall be signalled by the content type \"application/problem+json\", as defined in IETF RFC 9457 [10].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.4",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.2.3",
      "section_id": "6.1.2.3",
      "section_title": "HTTP custom headers",
      "content": "The mandatory HTTP custom header fields specified in clause 5.2.3.2 of 3GPP TS 29.500 [5] shall be applicable, and the optional HTTP custom header fields specified in clause 5.2.3.3 of 3GPP TS 29.500 [5] may be supported.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.3.2",
        "ts_29.500_clause_5.2.3.3",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.3.1",
      "section_id": "6.1.3.1",
      "section_title": "Overview",
      "content": "This clause describes the structure for the Resource URIs and the resources and methods used for the service.\nFigure 6.1.3.1-1 describes the resource URI structure of the Npkmf_PKMFKeyRequest API.\nFigure 6.1.3.1-1: Resource URI structure of the Npkmf_PKMFKeyRequest API\nTable 6.1.3.1-1 provides an overview of the resources and applicable HTTP methods.\nTable 6.1.3.1-1: Resources and methods overview\nResource name\nResource URI\nHTTP method or custom operation\nDescription\nProSe Keys Collection\n/prose-keys\nrequest\n(POST)\nProseKey service operation",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.1.3.1-1",
        "figure_6.1.3.1-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.3.2.1",
      "section_id": "6.1.3.2.1",
      "section_title": "Description",
      "content": "This resource represents the collection of the ProSe Keys managed by the 5G PKMF.\nThis resource is modelled with the Collection resource archetype (see clause C.2 of 3GPP TS 29.501 [5]).",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.3.2.2",
      "section_id": "6.1.3.2.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/<apiName>/<apiVersion>/prose-keys\nThis resource shall support the resource URI variables defined in table 6.1.3.2.2-1.\nTable 6.1.3.2.2-1: Resource URI variables for this resource\nName\nData type\nDefinition\napiRoot\nstring\nSee clause 6.1.1",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.1.1",
        "table_6.1.3.2.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.3.2.3",
      "section_id": "6.1.3.2.3",
      "section_title": "Resource Standard Methods",
      "content": "There is no standard method supported by the resource.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.1.3.2.4.1",
      "section_id": "6.1.3.2.4.1",
      "section_title": "Overview",
      "content": "Table 6.1.3.2.4.1-1: Custom operations\nOperation name\nCustom operaration URI\nMapped HTTP method\nDescription\nrequest\n{resourceUri}/request\nPOST\nProseKey service operation",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.1.3.2.4.1-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.3.2.4.2",
      "section_id": "6.1.3.2.4.2",
      "section_title": "Operation: request",
      "content": "6.1.3.2.4.2.1\tDescription\nThis custom operation requests the keying material related to 5G ProSe in the 5G PKMF.\n6.1.3.2.4.2.2\tOperation Definition\nThis operation shall support the request data structures specified in table 6.1.3.2.4.2.2-1 and the response data structure and response codes specified in table 6.1.3.2.4.2.2-2.\nTable 6.1.3.2.4.2.2-1: Data structures supported by the POST Request Body on this resource\nData type\nP\nCardinality\nDescription\nProseKeyReqData\nM\n1\nRepresentation of the input to request the keying material.\nTable 6.1.3.2.4.2.2-2: Data structures supported by the POST Response Body on this resource\nData type\nP\nCardinality\nResponse\ncodes\nDescription\nProseKeyRspData\nM\n1\n200 OK\nRepresentation of the successfully requested keying material.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n403 Not Found\nThe \"cause\" attribute shall be set to one of the following application error:\n- UE_NOT_AUTHORIZED\nSee table 6.1.7.3-1 for the description of these errors.\nProblemDetails\nO\n0..1\n404 Not Found\nThe \"cause\" attribute shall be set to one of the following application error:\n- UE_NOT_FOUND\nSee table 6.1.7.3-1 for the description of these errors.\nNOTE1:\tThe manadatory HTTP error status code for the POST method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [5] also apply.\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [4].\nTable 6.1.3.2.4.2.2-3: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same 5G PKMF or 5G PKMF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target 5G PKMF (service) instance ID towards which the request is redirected\nTable 6.1.3.2.4.2.2-4: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same 5G PKMF or 5G PKMF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [4].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target 5G PKMF (service) instance ID towards which the request is redirected",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_6.10.9.1",
        "table_6.1.3.2.4.2.2-1",
        "table_6.1.3.2.4.2.2-2",
        "table_6.1.7.3-1",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.1.3.2.4.2.2-3",
        "table_6.1.3.2.4.2.2-4",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.4",
      "section_id": "6.1.4",
      "section_title": "Custom Operations without associated resources",
      "content": "There is no custom operation without associated resources supported in Npkmf_PKMFKeyRequest Service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.1.5",
      "section_id": "6.1.5",
      "section_title": "Notifications",
      "content": "There is no notification defined for Npkmf_PKMFKeyRequest service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.1.6.1",
      "section_id": "6.1.6.1",
      "section_title": "General",
      "content": "This clause specifies the application data model supported by the API.\nTable 6.1.6.1-1 specifies the data types defined for the Npkmf_PKMFKeyRequest service based interface protocol.\nTable 6.1.6.1-1: Npkmf_PKMFKeyRequest specific Data Types\nData type\nClause defined\nDescription\nApplicability\nProseKeyReqData\n6.1.6.2.2\nRepresentation of the input to request the keying material.\nProseKeyRspData\n6.1.6.2.3\nRepresentation of the successfully requested keying material.\nPrukId\n6.1.6.3\nUser Plane Prose Remote User Key ID\nKnrp\n6.1.6.3\nKey for NR PC5\nKnrpFreshnessParameter1\n6.1.6.3\nKNRP Freshness Parameter 1\nKnrpFreshnessParameter2\n6.1.6.3\nKNRP Freshness Parameter 2\nGpi\n6.1.6.3\nGBA Push Information\nTable 6.1.6.1-2 specifies data types re-used by the Npkmf_PKMFKeyRequest service based interface protocol from other specifications, including a reference to their respective specifications and when needed, a short description of their use within the Npkmf_PKMFKeyRequest service based interface.\nTable 6.1.6.1-2: Npkmf_PKMFKeyRequest re-used Data Types\nData type\nReference\nComments\nApplicability\nRelayServiceCode\n3GPP TS 29.571 [15]\nRelay Service Code\nResynchronizationInfo\n3GPP TS 29.503 [17]\nResynchronization Information\nSuci\n3GPP TS 29.509 [18]\nString contains the SUCI",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.1.6.1-1",
        "table_6.1.6.1-2",
        "ts_29.571",
        "ts_29.503",
        "ts_29.509"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.6.2.1",
      "section_id": "6.1.6.2.1",
      "section_title": "Introduction",
      "content": "This clause defines the structures to be used in resource representations.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.1.6.2.2",
      "section_id": "6.1.6.2.2",
      "section_title": "Type: ProseKeyReqData",
      "content": "Table 6.1.6.2.2-1: Definition of type ProseKeyReqData\nAttribute name\nData type\nP\nCardinality\nDescription\nApplicability\nrelayServCode\nRelayServiceCode\nM\n1\nThis IE shall indicate the Relay Service Code from the 5G ProSe Remote UE or the 5G ProSe End UE.\nknrpFreshness1\nKnrpFreshnessParameter1\nM\n1\nThis IE shall carry the KNRP Freshness Parameter 1 in the 5G ProSe Remote UE or the 5G ProSe End UE.\nresyncInfo\nResynchronizationInfo\nC\n0..1\nThis IE shall be present in service request for subsequent key request handling synchronization failure.\nWhen present, this IE shall carry information (RAND, AUTS) from the 5G ProSe Remote UE or the 5G ProSe End UE related to the synchronization Failure.\nprukId\nPrukId\nC\n0..1\nThis IE may be present in service request for initial key request.\nWhen present, this IE shall indicate the UP-PRUK ID from the 5G ProSe Remote UE or the 5G ProSe End UE.\n(See NOTE)\nsuci\nSuci\nC\n0..1\nThis IE may be present in service request for initial key request.\nWhen present, this IE shall carry the SUCI of the 5G ProSe Remote UE or the 5G ProSe End UE\n(See NOTE).\nNOTE:\tEither prukId IE or suci IE shall be present in service request for initial key request.",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.1.6.2.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.6.2.3",
      "section_id": "6.1.6.2.3",
      "section_title": "Type: ProseKeyRspData",
      "content": "Table 6.1.6.2.3-1: Definition of type ProseKeyRspData\nAttribute name\nData type\nP\nCardinality\nDescription\nApplicability\nknrp\nKnrp\nM\n1\nThis IE shall carry the KNRP derived by the 5G PKMF.\nknrpFreshness2\nKnrpFreshnessParameter2\nM\n1\nThis IE shall carry the KNRP Freshness Parameter 2 generated by the 5G PKMF.\ngpi\nGpi\nC\n0..1\nThis IE shall be present if GPI is generated or requested.\nWhen present, this IE shall carry the GPI.",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.1.6.2.3-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.6.3.1",
      "section_id": "6.1.6.3.1",
      "section_title": "Introduction",
      "content": "This clause defines simple data types and enumerations that can be referenced from data structures defined in the previous clauses.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.1.6.3.2",
      "section_id": "6.1.6.3.2",
      "section_title": "Simple data types",
      "content": "The simple data types defined in table 6.1.6.3.2-1 shall be supported.\nTable 6.1.6.3.2-1: Simple data types\nType Name\nType Definition\nDescription\nApplicability\nPrukId\nstring\nUser Plane Prose Remote User Key ID\nString type as defined in OpenAPI Specification [7], carrying the value of the \"UP-PRUK ID\" parameter via PC8 (with \"xs:string\" type in XML schema) as specified in clause 11.6.2.3 of 3GPP TS 24.554 [16].\nKnrp\nstring\nKey for NR PC5\nString type as defined in OpenAPI Specification [7], carrying the value of the \"KNRP\" parameter via PC8 (with \"xs:hexBinary\" type in XML schema) as specified in clause 11.6.2.25 of 3GPP TS 24.554 [16].\nKnrpFreshnessParameter1\nstring\nKNRP Freshness Parameter 1\nString type as defined in OpenAPI Specification [7], carrying the value of the \"KNRP freshness parameter 1\" parameter via PC8 (with \"xs:hexBinary\" type in XML schema) as specified in clause 11.6.2.22 of 3GPP TS 24.554 [16].\nKnrpFreshnessParameter2\nstring\nKNRP Freshness Parameter 2\nString type as defined in OpenAPI Specification [7], carrying the value of the \"KNRP freshness parameter 2\" parameter via PC8 (with \"xs:hexBinary\" type in XML schema) as specified in clause 11.6.2.26 of 3GPP TS 24.554 [16].\nGpi\nstring\nGBA Push Information\nString type as defined in OpenAPI Specification [7], carrying the value of the \"GPI\" parameter via PC8 (with \"xs:hexBinary\" type in XML schema) as specified in clause 11.6.2.16 of 3GPP TS 24.554 [16].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.554_clause_11.6.2.3",
        "ts_24.554_clause_11.6.2.25",
        "ts_24.554_clause_11.6.2.22",
        "ts_24.554_clause_11.6.2.26",
        "ts_24.554_clause_11.6.2.16",
        "table_6.1.6.3.2-1",
        "ts_24.554"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.6.4",
      "section_id": "6.1.6.4",
      "section_title": "Data types describing alternative data types or combinations of data types",
      "content": "There is no data type describing alternative data types or combinations of data types in Npkmf_PKMFKeyRequest Service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.1.6.5",
      "section_id": "6.1.6.5",
      "section_title": "Binary data",
      "content": "There is no binary data type in Npkmf_PKMFKeyRequest Service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.1.7.1",
      "section_id": "6.1.7.1",
      "section_title": "General",
      "content": "For the Npkmf_PKMFKeyRequest API, HTTP error responses shall be supported as specified in clause 4.8 of 3GPP TS 29.501 [6]. Protocol errors and application errors specified in table 5.2.7.2-1 of 3GPP TS 29.500 [5] shall be supported for an HTTP method if the corresponding HTTP status codes are specified as mandatory for that HTTP method in table 5.2.7.1-1 of 3GPP TS 29.500 [5].\nIn addition, the requirements in the following clauses are applicable for the Npkmf_PKMFKeyRequest API.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.501_clause_4.8",
        "ts_29.500_table_5.2.7.2-1",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.501",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.7.2",
      "section_id": "6.1.7.2",
      "section_title": "Protocol Errors",
      "content": "Protocol errors handling shall be supported as specified in clause 5.2.7 of 3GPP TS 29.500 [5].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.7.3",
      "section_id": "6.1.7.3",
      "section_title": "Application Errors",
      "content": "The application errors defined for the Npkmf_PKMFKeyRequest service are listed in Table 6.1.7.3-1.\nTable 6.1.7.3-1: Application errors\nApplication Error\nHTTP status code\nDescription\nUE_NOT_AUTHORIZED\n403 Forbidden\nThe UE is not authorized for the requested service.\nUE_NOT_FOUND\n404 Not Found\nThe UE indicated by the SUCI or related to the UP-PRUK ID is not found in the 5G PKMF.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1.7.3-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.8",
      "section_id": "6.1.8",
      "section_title": "Feature negotiation",
      "content": "The optional features in table 6.1.8-1 are defined for the Npkmf_PKMFKeyRequest API. They shall be negotiated using the extensibility mechanism defined in clause 6.6 of 3GPP TS 29.500 [5].\nTable 6.1.8-1: Supported Features\nFeature number\nFeature Name\nDescription\nN/A",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_6.6",
        "table_6.1.8-1",
        "ts_29.500_table_6.1.8-1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.9",
      "section_id": "6.1.9",
      "section_title": "Security",
      "content": "As indicated in 3GPP TS 33.501 [11] and 3GPP TS 29.500 [5], the access to the Npkmf_PKMFKeyRequest API may be authorized by means of the OAuth2 protocol (see IETF RFC 6749 [12]), based on local configuration, using the \"Client Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [13]) plays the role of the authorization server.\nIf OAuth2 is used, an NF Service Consumer, prior to consuming services offered by the Npkmf_PKMFKeyRequest API, shall obtain a \"token\" from the authorization server, by invoking the Access Token Request service, as described in 3GPP TS 29.510 [13], clause 5.4.2.2.\nNOTE:\tWhen multiple NRFs are deployed in a network, the NRF used as authorization server is the same NRF that the NF Service Consumer used for discovering the Npkmf_PKMFKeyRequest service.\nThe Npkmf_PKMFKeyRequest API defines a single scope \"npkmf-keyrequest\" for OAuth2 authorization (as specified in 3GPP TS 33.501 [11]) for the entire service, and it does not define any additional scopes at resource or operation level.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.510_clause_5.4.2.2",
        "ts_33.501",
        "ts_29.500",
        "ts_29.510"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.1.10",
      "section_id": "6.1.10",
      "section_title": "HTTP redirection",
      "content": "An HTTP request may be redirected to a different 5G PKMF service instance, within the same 5G PKMF or a different 5G PKMF of an 5G PKMF set, e.g. when an 5G PKMF service instance is part of an 5G PKMF (service) set or when using indirect communications (see 3GPP TS 29.500 [5]).\nAn SCP that reselects a different 5G PKMF producer instance will return the NF Instance ID of the new 5G PKMF producer instance in the 3gpp-Sbi-Producer-Id header, as specified in clause 6.10.3.4 of 3GPP TS 29.500 [5].\nIf an 5G PKMF within an 5G PKMF set redirects a service request to a different 5G PKMF of the set using an 307 Temporary Redirect or 308 Permanent Redirect status code, the identity of the new 5G PKMF towards which the service request is redirected shall be indicated in the 3gpp-Sbi-Target-Nf-Id header of the 307 Temporary Redirect or 308 Permanent Redirect response as specified in clause 6.10.9.1 of 3GPP TS 29.500 [5].",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.500_clause_6.10.3.4",
        "ts_29.500_clause_6.10.9.1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.1",
      "section_id": "6.2.1",
      "section_title": "Introduction",
      "content": "The Npkmf_ResolveRemoteUserId service shall use the Npkmf_ResolveRemoteUserId API.\nThe API URI of the Npkmf_ResolveRemoteUserId API shall be:\n{apiRoot}/<apiName>/<apiVersion>\nThe request URIs used in HTTP requests from the NF service consumer towards the NF service producer shall have the Resource URI structure defined in clause 4.4.1 of 3GPP TS 29.501 [6], i.e.:\n{apiRoot}/<apiName>/<apiVersion>/<apiSpecificResourceUriPart>\nwith the following components:\n-\tThe {apiRoot} shall be set as described in 3GPP TS 29.501 [6].\n-\tThe <apiName> shall be \"npkmf-userid\".\n-\tThe <apiVersion> shall be \"v1\".\n-\tThe <apiSpecificResourceUriPart> shall be set as described in clause 6.2.3.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.501_clause_4.4.1",
        "clause_6.2.3",
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.2.1",
      "section_id": "6.2.2.1",
      "section_title": "General",
      "content": "HTTP/2, IETF RFC 9113 [8], shall be used as specified in clause 5 of 3GPP TS 29.500 [5].\nHTTP/2 shall be transported as specified in clause 5.3 of 3GPP TS 29.500 [5].\nThe OpenAPI [7] specification of HTTP messages and content bodies for the Npkmf_ResolveRemoteUserId API is contained in Annex A.3.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5",
        "ts_29.500_clause_5.3",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.2.2.1",
      "section_id": "6.2.2.2.1",
      "section_title": "General",
      "content": "See clause 5.2.2 of 3GPP TS 29.500 [5] for the usage of HTTP standard headers.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.2",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.2.2.2",
      "section_id": "6.2.2.2.2",
      "section_title": "Content type",
      "content": "JSON, IETF RFC 8259 [9], shall be used as content type of the HTTP bodies specified in the present specification as specified in clause 5.4 of 3GPP TS 29.500 [5]. The use of the JSON format shall be signalled by the content type \"application/json\".\n\"Problem Details\" JSON object shall be used to indicate additional details of the error in a HTTP response body and shall be signalled by the content type \"application/problem+json\", as defined in IETF RFC 9457 [10].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.4",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.2.3",
      "section_id": "6.2.2.3",
      "section_title": "HTTP custom headers",
      "content": "The mandatory HTTP custom header fields specified in clause 5.2.3.2 of 3GPP TS 29.500 [5] shall be supported, and the optional HTTP custom header fields specified in clause 5.2.3.3 of 3GPP TS 29.500 [5] may be supported.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.3.2",
        "ts_29.500_clause_5.2.3.3",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.3.1",
      "section_id": "6.2.3.1",
      "section_title": "Overview",
      "content": "This clause describes the structure for the Resource URIs and the resources and methods used for the service.\nFigure 6.2.3.1-1 depicts the resource URIs structure for the Npkmf_ResolveRemoteUserId API.\nFigure 6.2.3.1-1: Resource URI structure of the Npkmf_ResolveRemoteUserId API\nTable 6.2.3.1-1 provides an overview of the resources and applicable HTTP methods.\nTable 6.2.3.1-1: Resources and methods overview\nResource name\nResource URI\nHTTP method or custom operation\nDescription",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.2.3.1-1",
        "figure_6.2.3.1-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.4.1",
      "section_id": "6.2.4.1",
      "section_title": "Overview",
      "content": "The URI structure for Custom Operations without associated resources is included as part of the Figure 6.2.3.1-1\nTable 6.2.4.1-1: Custom operations without associated resources\nCustom operation URI\nMapped HTTP method\nDescription\nresolve-id\nPOST\nResolve ProSe Remote User ID (i.e., UP-PRUK ID) to SUPI",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.2.4.1-1",
        "figure_6.2.3.1-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.4.2.1",
      "section_id": "6.2.4.2.1",
      "section_title": "Description",
      "content": "This custom operation is used by the NF service consumer (e.g., SMF, 5G PKMF) to request to resolve ProSe Remote User ID (i.e., UP-PRUK) to SUPI.\nThe URI of this custom operation is: {apiRoot}/npkmf-userid/<apiVersion>/resolve-id",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.2.4.2.2",
      "section_id": "6.2.4.2.2",
      "section_title": "Operation Definition",
      "content": "This operation shall support the response data structures and response codes specified in tables 6.2.4.2.2-1 and 6.2.4.2.2-2.\nTable 6.2.4.2.2-1: Data structures supported by the POST Request Body on this resource\nData type\nP\nCardinality\nDescription\nResolveRequest\nM\n1\nResolve Request data.\nTable 6.2.4.2.2-2: Data structures supported by the POST Response Body on this resource\nData type\nP\nCardinality\nResponse\ncodes\nDescription\nResolveResponse\nM\n1\n200 OK\nUpon success, the response data contain the SUPI of the ProSe Remote UE.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n404 Not Found\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- USER_NOT_FOUND\nSee table  6.2.7.3-1 for the description of these errors.\nNOTE 1:\tThe manadatory HTTP error status code for the POST method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [5] also apply.\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [5].\nTable 6.2.4.2.2-3: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same 5G PKMF or 5G PKMF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [5].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target 5G PKMF (service) instance ID towards which the request is redirected\nTable 6.2.4.2.2-4: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same 5G PKMF or 5G PKMF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [5].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target 5G PKMF (service) instance ID towards which the request is redirected",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_6.10.9.1",
        "table_6.2.4.2.2-1",
        "table_6.2.4.2.2-2",
        "table_6.2.7.3-1",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.2.4.2.2-3",
        "table_6.2.4.2.2-4",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.5",
      "section_id": "6.2.5",
      "section_title": "Notifications",
      "content": "There is no notification defined for Npkmf_ResolveRemoteUserId service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.2.6.1",
      "section_id": "6.2.6.1",
      "section_title": "General",
      "content": "This clause specifies the application data model supported by the API.\nTable 6.2.6.1-1 specifies the data types defined for the Npkmf_ResolveRemoteUserId service based interface protocol.\nTable 6.2.6.1-1: Npkmf_ResolveRemoteUserId specific Data Types\nData type\nClause defined\nDescription\nApplicability\nResolveRequest\n6.2.6.2.2\nRequest Data\nResolveResponse\n6.2.6.2.3\nResponse Data\nTable 6.2.6.1-2 specifies data types re-used by the Npkmf_ResolveRemoteUserId service based interface protocol from other specifications and from other service APIs in current specification, including a reference to the respective specifications and when needed, a short description of their use within the Npkmf_ResolveRemoteUserId service based interface.\nTable 6.2.6.1-2: Npkmf_ResolveRemoteUserId re-used Data Types\nData type\nReference\nComments\nApplicability\nPrukId\nClause 6.1.6.3.2\nDefined in Npkmf_PKMFKeyRequest API.\nPlmnId\n3GPP TS 29.571 [15]\nPLMN ID\nSupi\n3GPP TS 29.571 [15]\nSubscription Permanent Identifier",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.1.6.3.2",
        "table_6.2.6.1-1",
        "table_6.2.6.1-2",
        "ts_29.571"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.6.2.1",
      "section_id": "6.2.6.2.1",
      "section_title": "Introduction",
      "content": "This clause defines the structures to be used in resource representations.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.2.6.2.2",
      "section_id": "6.2.6.2.2",
      "section_title": "Type: ResolveRequest",
      "content": "Table 6.2.6.2.2-1: Definition of type ResolveRequest\nAttribute name\nData type\nP\nCardinality\nDescription\nApplicability\nupPrukId\nPrukId\nM\n1\nUP-PRUK ID of the ProSe Remote UE\nplmnId\nPlmnId\nO\n0..1\nHPLMN ID of the 5G ProSe Remote UE",
      "chunk_type": "general",
      "cross_references": [
        "table_6.2.6.2.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.6.2.3",
      "section_id": "6.2.6.2.3",
      "section_title": "Type: ResolveResponse",
      "content": "Table 6.2.6.2.2-1: Definition of type ResolveResponse\nAttribute name\nData type\nP\nCardinality\nDescription\nApplicability\nsupi\nSupi\nM\n1\nThe SUPI of the UE",
      "chunk_type": "general",
      "cross_references": [
        "table_6.2.6.2.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.6.3",
      "section_id": "6.2.6.3",
      "section_title": "Simple data types and enumerations",
      "content": "There are no simply data types and enumerations defined in Npkmf_ResolveRemoteUserId Service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.2.6.4",
      "section_id": "6.2.6.4",
      "section_title": "Data types describing alternative data types or combinations of data types",
      "content": "There is no data type describing alternative data types or combinations of data types in Npkmf_ResolveRemoteUserId Service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.2.6.5",
      "section_id": "6.2.6.5",
      "section_title": "Binary data",
      "content": "There is no binary data type in Npkmf_ResolveRemoteUserId Service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.2.7.1",
      "section_id": "6.2.7.1",
      "section_title": "General",
      "content": "For the Npkmf_ResolveRemoteUserId API, HTTP error responses shall be supported as specified in clause 4.8 of 3GPP TS 29.501 [6]. Protocol errors and application errors specified in table 5.2.7.2-1 of 3GPP TS 29.500 [5] shall be supported for an HTTP method if the corresponding HTTP status codes are specified as mandatory for that HTTP method in table 5.2.7.1-1 of 3GPP TS 29.500 [5].\nIn addition, the requirements in the following clauses are applicable for the Npkmf_ResolveRemoteUserId API.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.501_clause_4.8",
        "ts_29.500_table_5.2.7.2-1",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.501",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.7.2",
      "section_id": "6.2.7.2",
      "section_title": "Protocol Errors",
      "content": "No specific procedures for the Npkmf_ResolveRemoteUserId service are specified.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.2.7.3",
      "section_id": "6.2.7.3",
      "section_title": "Application Errors",
      "content": "The application errors defined for the Npkmf_ResolveRemoteUserId service are listed in Table 6.2.7.3-1.\nTable 6.2.7.3-1: Application errors\nApplication Error\nHTTP status code\nDescription\nUSER_NOT_FOUND\n404 Not Found\nThe provided subscriber identifier is not found.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.2.7.3-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.8",
      "section_id": "6.2.8",
      "section_title": "Feature negotiation",
      "content": "The optional features in table 6.2.8-1 are defined for the Npkmf_ResolveRemoteUserId API. They shall be negotiated using the extensibility mechanism defined in clause 6.6 of 3GPP TS 29.500 [5].\nTable 6.2.8-1: Supported Features\nFeature number\nFeature Name\nDescription",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_6.6",
        "table_6.2.8-1",
        "ts_29.500_table_6.2.8-1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.9",
      "section_id": "6.2.9",
      "section_title": "Security",
      "content": "As indicated in 3GPP TS 33.501 [8] and 3GPP TS 29.500 [5], the access to the Npkmf_ResolveRemoteUserId API may be authorized by means of the OAuth2 protocol (see IETF RFC 6749 [9]), based on local configuration, using the \"Client Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [13]) plays the role of the authorization server.\nIf OAuth2 is used, an NF Service Consumer, prior to consuming services offered by the Npkmf_ResolveRemoteUserId API, shall obtain a \"token\" from the authorization server, by invoking the Access Token Request service, as described in 3GPP TS 29.510 [13], clause 5.4.2.2.\nNOTE:\tWhen multiple NRFs are deployed in a network, the NRF used as authorization server is the same NRF that the NF Service Consumer used for discovering the Npkmf_ResolveRemoteUserId service.\nThe Npkmf_ResolveRemoteUserId API defines a single scope \"npkmf-userid\" for the entire service, and it does not define any additional scopes at resource or operation level.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.510_clause_5.4.2.2",
        "ts_33.501",
        "ts_29.500",
        "ts_29.510"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.2.10",
      "section_id": "6.2.10",
      "section_title": "HTTP redirection",
      "content": "An HTTP request may be redirected to a different 5G PKMF service instance, within the same 5G PKMF or a different 5G PKMF of an 5G PKMF set, e.g. when an 5G PKMF service instance is part of an 5G PKMF (service) set or when using indirect communications (see 3GPP TS 29.500 [5]).\nAn SCP that reselects a different 5G PKMF producer instance will return the NF Instance ID of the new 5G PKMF producer instance in the 3gpp-Sbi-Producer-Id header, as specified in clause 6.10.3.4 of 3GPP TS 29.500 [5].\nIf an 5G PKMF within an 5G PKMF set redirects a service request to a different 5G PKMF of the set using an 307 Temporary Redirect or 308 Permanent Redirect status code, the identity of the new 5G PKMF towards which the service request is redirected shall be indicated in the 3gpp-Sbi-Target-Nf-Id header of the 307 Temporary Redirect or 308 Permanent Redirect response as specified in clause 6.10.9.1 of 3GPP TS 29.500 [5].",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.500_clause_6.10.3.4",
        "ts_29.500_clause_6.10.9.1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.1",
      "section_id": "6.3.1",
      "section_title": "Introduction",
      "content": "The Npkmf_Discovery shall use the Npkmf_Discovery API.\nThe API URI of the Npkmf_Discovery API shall be:\n{apiRoot}/<apiName>/<apiVersion>\nThe request URIs used in HTTP requests from the NF service consumer towards the NF service producer shall have the Resource URI structure defined in clause 4.4.1 of 3GPP TS 29.501 [6], i.e.:\n{apiRoot}/<apiName>/<apiVersion>/<apiSpecificResourceUriPart>\nwith the following components:\n-\tThe {apiRoot} shall be set as described in 3GPP TS 29.501 [6].\n-\tThe <apiName> shall be \"npkmf-discovery\".\n-\tThe <apiVersion> shall be \"v1\".\n-\tThe <apiSpecificResourceUriPart> shall be set as described in clause 6.3.3.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.501_clause_4.4.1",
        "clause_6.3.3",
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.2.1",
      "section_id": "6.3.2.1",
      "section_title": "General",
      "content": "HTTP/2, IETF RFC 9113 [8], shall be used as specified in clause 5 of 3GPP TS 29.500 [5].\nHTTP/2 shall be transported as specified in clause 5.3 of 3GPP TS 29.500 [5].\nThe OpenAPI [7] specification of HTTP messages and content bodies for the Npkmf_Discovery API is contained in Annex A.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5",
        "ts_29.500_clause_5.3",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.2.2.1",
      "section_id": "6.3.2.2.1",
      "section_title": "General",
      "content": "See clause 5.2.2 of 3GPP TS 29.500 [5] for the usage of HTTP standard headers.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.500_clause_5.2.2",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.2.2.2",
      "section_id": "6.3.2.2.2",
      "section_title": "Content type",
      "content": "JSON, IETF RFC 8259 [9], shall be used as content type of the HTTP bodies specified in the present specification as specified in clause 5.4 of 3GPP TS 29.500 [5]. The use of the JSON format shall be signalled by the content type \"application/json\".\n\"Problem Details\" JSON object shall be used to indicate additional details of the error in a HTTP response body and shall be signalled by the content type \"application/problem+json\", as defined in IETF RFC 7807 [10].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.4",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.2.3",
      "section_id": "6.3.2.3",
      "section_title": "HTTP custom headers",
      "content": "The mandatory HTTP custom header fields specified in clause 5.2.3.2 of 3GPP TS 29.500 [5] shall be applicable, and the optional HTTP custom header fields specified in clause 5.2.3.3 of 3GPP TS 29.500 [5] may be supported.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.3.2",
        "ts_29.500_clause_5.2.3.3",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.3.1",
      "section_id": "6.3.3.1",
      "section_title": "Overview",
      "content": "This clause describes the structure for the Resource URIs and the resources and methods used for the service.\nFigure 6.3.3.1-1 describes the resource URI structure of the Npkmf_Discovery API.\nFigure 6.3.3.1-1: Resource URI structure of the Npkmf_Discovery API\nTable 6.3.3.1-1 provides an overview of the resources and applicable HTTP methods.\nTable 6.3.3.1-1: Resources and methods overview\nResource name\nResource URI\nHTTP method or custom operation\nDescription\nAnnounceAuthorize\n/{ueId}/announce-authorize/{userInfoId}\nPUT\nObtain the authorization from the 5G PKMF for announcing in the PLMN\nMonitorKey\n/{ueId}/monitor-key/{userInfoId}\nPUT\nObtain the discovery key from the 5G PKMF for monitoring in the PLMN\nDiscoveryKey\n/{ueId}/discovery-key/{userInfoId}\nPUT\nObtain the discovery key from the 5G PKMF for a discoverer UE in the PLMN to operate Model B restricted discovery\nNOTE:\tThe Custom operation URI above are deviating from the URI Path Segment Naming Conventions defined in clause 5.1.3.2 of 3GPP TS 29.501 [5], but they are not changed to maintain backwards compatibility.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.501_clause_5.1.3.2",
        "table_6.3.3.1-1",
        "figure_6.3.3.1-1",
        "ts_29.501"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.3.2.2",
      "section_id": "6.3.3.2.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/npkmf-disc/<apiVersion>/{ueId}/announce-authorize/{userInfoId}\nThis resource shall support the resource URI variables defined in table 6.3.3.2.2-1.\nTable 6.3.3.2.2-1: Resource URI variables for this resource\nName\nData type\nDefinition\napiRoot\nstring\nSee clause 6.3.1\nueId\nVarUeId\nRepresents the Subscription Identifier SUPI or GPSI (see 3GPP TS 23.501 [2] clause 5.9.2)\tpattern: See pattern of type VarUeId in 3GPP TS 29.571 [16]\nuserInfoId\nUserInfoId\nRepresents User Info Id.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.3.1",
        "ts_23.501_clause_5.9.2",
        "table_6.3.3.2.2-1",
        "ts_23.501",
        "ts_29.571"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.3.2.3",
      "section_id": "6.3.3.2.3",
      "section_title": "Resource Standard Methods",
      "content": "6.3.3.2.3.1\tPUT\nThis method shall support the URI query parameters specified in table 6.3.3.2.3.1-1.\nTable 6.3.3.2.3.1-1: URI query parameters supported by the PUT method on this resource\nName\nData type\nP\nCardinality\nDescription\nApplicability\nn/a\nThis method shall support the request data structures specified in table 6.3.3.2.3.1-2 and the response data structures and response codes specified in table 6.3.3.2.3.1-3.\nTable 6.3.3.2.3.1-2: Data structures supported by the PUT Request Body on this resource\nData type\nP\nCardinality\nDescription\nAnnounceAuthData\nM\n1\nContains the Announce Authorization Data for the indicated UE and indicated user info id.\nTable 6.3.3.2.3.1-3: Data structures supported by the PUT Response Body on this resource\nData type\nP\nCardinality\nResponse\ncodes\nDescription\nAnnounceAuthData\nM\n1\n201 Created\nUpon success of creation of the resource, a response body shall be returned.\nThe HTTP response shall include a \"Location\" HTTP header that contains the resource URI of the created resource.\nn/a\n204 No Content\nUpon success of the update of the resource, an empty response body shall be returned.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n403 Forbidden\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- PROSE_SERVICE_UNAUTHORIZED\nSee table 6.3.7.3-1 for the description of these errors.\nNOTE 1:\tThe manadatory HTTP error status code for the PUT method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [5] also apply.\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [5].\nTable 6.3.3.2.3.1-4: Headers supported by the 201 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nContains the URI of the newly created resource, according to the structure: {apiRoot}/npkmf-disc/<apiVersion>/{ueId}/announce-authorize/{userInfoId}\nTable 6.3.3.2.3.1-5: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same 5G PKMF or 5G PKMF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [5].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target 5G PKMF (service) instance ID towards which the request is redirected\nTable 6.3.3.2.3.1-6: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same 5G PKMF or 5G PKMF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [5].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target 5G PKMF (service) instance ID towards which the request is redirected",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_6.10.9.1",
        "table_6.3.3.2.3.1-1",
        "table_6.3.3.2.3.1-2",
        "table_6.3.3.2.3.1-3",
        "table_6.3.7.3-1",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.3.3.2.3.1-4",
        "table_6.3.3.2.3.1-5",
        "table_6.3.3.2.3.1-6",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.3.3.1",
      "section_id": "6.3.3.3.1",
      "section_title": "Description",
      "content": "This resource represents the Monitor Key.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.3.3.3.2",
      "section_id": "6.3.3.3.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/npkmf-disc/<apiVersion>/{ueId}/monitor-key/{userInfoId}\nThis resource shall support the resource URI variables defined in table 6.3.3.3.2-1.\nTable 6.3.3.3.2-1: Resource URI variables for this resource\nName\nData type\nDefinition\napiRoot\nstring\nSee clause 6.1.1\nueId\nVarUeId\nRepresents the Subscription Identifier SUPI or GPSI (see 3GPP TS 23.501 [2] clause 5.9.2)\tpattern: See pattern of type VarUeId in 3GPP TS 29.571 [16]\nuserInfoId\nUserInfoId\nRepresents User Info Id.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.1.1",
        "ts_23.501_clause_5.9.2",
        "table_6.3.3.3.2-1",
        "ts_23.501",
        "ts_29.571"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.3.3.3",
      "section_id": "6.3.3.3.3",
      "section_title": "Resource Standard Methods",
      "content": "6.3.3.3.3.1\tPUT\nThis method shall support the URI query parameters specified in table 6.3.3.3.3.1-1.\nTable 6.3.3.3.3.1-1: URI query parameters supported by the PUT method on this resource\nName\nData type\nP\nCardinality\nDescription\nApplicability\nn/a\nThis method shall support the request data structures specified in table 6.3.3.3.3.1-2 and the response data structures and response codes specified in table 6.3.3.3.3.1-3.\nTable 6.3.3.3.3.1-2: Data structures supported by the PUT Request Body on this resource\nData type\nP\nCardinality\nDescription\nMonitorKeyReqData\nM\n1\nContains the Monitor Key Data for the indicated UE and indicated user info id.\nTable 6.3.3.3.3.1-3: Data structures supported by the PUT Response Body on this resource\nData type\nP\nCardinality\nResponse\ncodes\nDescription\nMonitorKeyRespData\nM\n1\n201 Created\nUpon success of creation of the resource, a response body containing a representation of the discovery key data to monitor for the UE shall be returned.\nThe HTTP response shall include a \"Location\" HTTP header that contains the resource URI of the created resource.\nn/a\n204 No Content\nUpon success of the update of the resource, an empty response body shall be returned.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n403 Forbidden\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- PROSE_SERVICE_UNAUTHORIZED\nSee table 6.3.7.3-1 for the description of these errors.\nProblemDetails\nO\n0..1\n404 Not Found\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n-\tAPPLICATION_NOT_FOUND\nSee table 6.3.7.3-1 for the description of these errors.\nNOTE 1:\tThe manadatory HTTP error status code for the PUT method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [5] also apply.\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [5].\nTable 6.3.3.3.3.1-4: Headers supported by the 201 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nContains the URI of the newly created resource, according to the structure: {apiRoot}/npkmf-disc/<apiVersion>/{ueId}/monitor-key/{userInfoId}\nTable 6.3.3.3.3.1-5: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same 5G PKMF or 5G PKMF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [5].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target 5G PKMF (service) instance ID towards which the request is redirected\nTable 6.3.3.3.3.1-6: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same 5G PKMF or 5G PKMF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [5].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target 5G PKMF (service) instance ID towards which the request is redirected",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_6.10.9.1",
        "table_6.3.3.3.3.1-1",
        "table_6.3.3.3.3.1-2",
        "table_6.3.3.3.3.1-3",
        "table_6.3.7.3-1",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.3.3.3.3.1-4",
        "table_6.3.3.3.3.1-5",
        "table_6.3.3.3.3.1-6",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.3.4.1",
      "section_id": "6.3.3.4.1",
      "section_title": "Description",
      "content": "This resource represents the Discovery Key.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.3.3.4.2",
      "section_id": "6.3.3.4.2",
      "section_title": "Resource Definition",
      "content": "Resource URI: {apiRoot}/npkmf-disc/<apiVersion>/{ueId}/discovery-key/{userInfoId}\nThis resource shall support the resource URI variables defined in table 6.3.3.4.2-1.\nTable 6.3.3.4.2-1: Resource URI variables for this resource\nName\nData type\nDefinition\napiRoot\nstring\nSee clause 6.1.1\nueId\nVarUeId\nRepresents the Subscription Identifier SUPI or GPSI (see 3GPP TS 23.501 [2] clause 5.9.2)\tpattern: See pattern of type VarUeId in 3GPP TS 29.571 [16]\nuserInfoId\nUserInfoId\nRepresents User Info Id.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.1.1",
        "ts_23.501_clause_5.9.2",
        "table_6.3.3.4.2-1",
        "ts_23.501",
        "ts_29.571"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.3.4.3",
      "section_id": "6.3.3.4.3",
      "section_title": "Resource Standard Methods",
      "content": "6.3.3.4.3.1\tPUT\nThis method shall support the URI query parameters specified in table 6.3.3.4.3.1-1.\nTable 6.3.3.4.3.1-1: URI query parameters supported by the PUT method on this resource\nName\nData type\nP\nCardinality\nDescription\nApplicability\nn/a\nThis method shall support the request data structures specified in table 6.3.3.4.3.1-2 and the response data structures and response codes specified in table 6.3.3.4.3.1-3.\nTable 6.3.3.4.3.1-2: Data structures supported by the PUT Request Body on this resource\nData type\nP\nCardinality\nDescription\nDiscoveryKeyReqData\nM\n1\nContains the Discovery Key Data for the indicated UE and indicated user info id.\nTable 6.3.3.4.3.1-3: Data structures supported by the PUT Response Body on this resource\nData type\nP\nCardinality\nResponse\ncodes\nDescription\nDiscoveryKeyRespData\nM\n1\n201 Created\nUpon success of creation of the resource, a response body containing a representation of the discovery key data for the discoverer UE in the PLMN to operate Model B restricted discovery shall be returned.\nThe HTTP response shall include a \"Location\" HTTP header that contains the resource URI of the created resource.\nn/a\n204 No Content\nUpon success of the update of the resource, an empty response body shall be returned.\nRedirectResponse\nO\n0..1\n307 Temporary Redirect\nTemporary redirection.\n(NOTE 2)\nRedirectResponse\nO\n0..1\n308 Permanent Redirect\nPermanent redirection.\n(NOTE 2)\nProblemDetails\nO\n0..1\n403 Forbidden\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n- PROSE_SERVICE_UNAUTHORIZED\nSee table 6.3.7.3-1 for the description of these errors.\nProblemDetails\nO\n0..1\n404 Not Found\nThe \"cause\" attribute may be used to indicate one of the following application errors:\n-\tAPPLICATION_NOT_FOUND\nSee table 6.3.7.3-1 for the description of these errors.\nNOTE 1:\tThe manadatory HTTP error status code for the PUT method listed in Table 5.2.7.1-1 of 3GPP TS 29.500 [5] also apply.\nNOTE 2:\tRedirectResponse may be inserted by an SCP, see clause 6.10.9.1 of 3GPP TS 29.500 [5].\nTable 6.3.3.4.3.1-4: Headers supported by the 201 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nContains the URI of the newly created resource, according to the structure: {apiRoot}/npkmf-disc/<apiVersion>/{ueId}/discovery-key/{userInfoId}\nTable 6.3.3.4.3.1-5: Headers supported by the 307 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same 5G PKMF or 5G PKMF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [5].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target 5G PKMF (service) instance ID towards which the request is redirected\nTable 6.3.3.4.3.1-6: Headers supported by the 308 Response Code on this resource\nName\nData type\nP\nCardinality\nDescription\nLocation\nstring\nM\n1\nAn alternative URI of the resource located on an alternative service instance within the same 5G PKMF or 5G PKMF (service) set.\nFor the case, when a request is redirected to the same target resource via a different SCP, see clause 6.10.9.1 in 3GPP TS 29.500 [5].\n3gpp-Sbi-Target-Nf-Id\nstring\nO\n0..1\nIdentifier of the target 5G PKMF (service) instance ID towards which the request is redirected",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_6.10.9.1",
        "table_6.3.3.4.3.1-1",
        "table_6.3.3.4.3.1-2",
        "table_6.3.3.4.3.1-3",
        "table_6.3.7.3-1",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.500_table_6.3.3.4.3.1-4",
        "table_6.3.3.4.3.1-5",
        "table_6.3.3.4.3.1-6",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.4",
      "section_id": "6.3.4",
      "section_title": "Custom Operations without associated resources",
      "content": "There is no custom operation without associated resources supported in Npkmf_Discovery Service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.3.5",
      "section_id": "6.3.5",
      "section_title": "Notifications",
      "content": "There is no notification defined for Npkmf_Discovery service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.3.6.1",
      "section_id": "6.3.6.1",
      "section_title": "General",
      "content": "This clause specifies the application data model supported by the API.\nTable 6.3.6.1-1 specifies the data types defined for the Npkmf_Discovery service based interface protocol.\nTable 6.3.6.1-1: Npkmf_Discovery specific Data Types\nData type\nClause defined\nDescription\nApplicability\nAnnounceAuthData\n6.3.6.2.2\nRepresents Data used to request the authorization to announce for a UE\nMonitorKeyReqData\n6.3.6.2.3\nRepresents Data used to request the discovery key data to monitor for a UE\nMonitorKeyRespData\n6.3.6.2.4\nRepresents the obtained Monitor discovery key data for a UE\nDiscoveryKeyReqData\n6.3.6.2.5\nRepresents Data used to request the discovery key data for a discoverer UE\nDiscoveryKeyRespData\n6.3.6.2.6\nRepresents the obtained the discovery key data for a discoverer UE.\nDiscSecMaterials\n6.3.6.2.7\nRepresents the discovery security materials\nUeSecurityCapability\n6.3.6.3\nPC5 UE security capability\nChosenPc5CipheringAlgorithm\n6.3.6.3\nThe chosen PC5 ciphering algorithm\nDuik\n6.3.6.3\nDiscovery User Integrity Key\nDuck\n6.3.6.3\nDiscovery User Confidentility Key\nDusk\n6.3.6.3\nDiscovery User Scrambling Key\nUserInfoId\n6.3.6.3\nUser Info ID\nTable 6.3.6.1-2 specifies data types re-used by the Npkmf_Discovery service based interface protocol from other specifications, including a reference to their respective specifications and when needed, a short description of their use within the Npkmf_Discovery service based interface.\nTable 6.3.6.1-2: Npkmf_Discovery re-used Data Types\nData type\nReference\nComments\nApplicability\nVarUeId\n3GPP TS 29.571 [15]\nString represents the SUPI or GPSI.\nRelayServiceCode\n3GPP TS 29.571 [15]\nRelay Service Code",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.3.6.1-1",
        "table_6.3.6.1-2",
        "ts_29.571"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.6.2.1",
      "section_id": "6.3.6.2.1",
      "section_title": "Introduction",
      "content": "This clause defines the structures to be used in resource representations.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.3.6.2.2",
      "section_id": "6.3.6.2.2",
      "section_title": "Type: AnnounceAuthData",
      "content": "Table 6.3.6.2.2-1: Definition of type AnnounceAuthData\nAttribute name\nData type\nP\nCardinality\nDescription\nApplicability\nrelayServCode\nRelayServiceCode\nM\n1\nThis IE shall indicate the Relay Service Code.",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.3.6.2.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.6.2.3",
      "section_id": "6.3.6.2.3",
      "section_title": "Type: MonitorKeyReqData",
      "content": "Table 6.3.6.2.3-1: Definition of type MonitorKeyReqData\nAttribute name\nData type\nP\nCardinality\nDescription\nApplicability\nrelayServCode\nRelayServiceCode\nM\n1\nThis IE shall indicate the Relay Service Code.\nueSecurityCapability\nUeSecurityCapability\nM\n1\nThis IE shall indicate the PC5 UE security capability",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.3.6.2.3-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.6.2.4",
      "section_id": "6.3.6.2.4",
      "section_title": "Type: MonitorKeyRespData",
      "content": "Table 6.3.6.2.4-1: Definition of type MonitorKeyRespData\nAttribute name\nData type\nP\nCardinality\nDescription\nApplicability\nchosenPc5CipheringAlgorithm\nChosenPc5CipheringAlgorithm\nM\n1\nThis IE shall indicate the chosen PC5 ciphering algorithm\ndiscSecMaterials\nDiscSecMaterials\nM\n1\nThis IE shall indicate the discovery security materials",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.3.6.2.4-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.6.2.5",
      "section_id": "6.3.6.2.5",
      "section_title": "Type: DiscoveryKeyReqData",
      "content": "Table 6.3.6.2.5-1: Definition of type DiscoveryKeyReqData\nAttribute name\nData type\nP\nCardinality\nDescription\nApplicability\nrelayServCode\nRelayServiceCode\nM\n1\nThis IE shall indicate the Relay Service Code.\nueSecurityCapability\nUeSecurityCapability\nM\n1\nThis IE shall indicate the PC5 UE security capability",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.3.6.2.5-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.6.2.6",
      "section_id": "6.3.6.2.6",
      "section_title": "Type: DiscoveryKeyRespData",
      "content": "Table 6.3.6.2.6-1: Definition of type DiscoveryKeyRespData\nAttribute name\nData type\nP\nCardinality\nDescription\nApplicability\nchosenPc5CipheringAlgorithm\nChosenPc5CipheringAlgorithm\nM\n1\nThis IE shall indicate the chosen PC5 ciphering algorithm\ndiscSecMaterials\nDiscSecMaterials\nM\n1\nThis IE shall indicate the discovery security materials",
      "chunk_type": "requirement",
      "cross_references": [
        "table_6.3.6.2.6-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.6.2.7",
      "section_id": "6.3.6.2.7",
      "section_title": "Type: DiscSecMaterials",
      "content": "Table 6.3.6.2.7-1: Definition of type DiscSecMaterials\nAttribute name\nData type\nP\nCardinality\nDescription\nApplicability\nduik\nDuik\nO\n0..1\nDiscovery User Integrity Key\nduck\nDuck\nO\n0..1\nDiscovery User Confidentility Key\ndusk\nDusk\nO\n0..1\nDiscovery User Scrambling Key",
      "chunk_type": "general",
      "cross_references": [
        "table_6.3.6.2.7-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.6.3.1",
      "section_id": "6.3.6.3.1",
      "section_title": "Introduction",
      "content": "This clause defines simple data types and enumerations that can be referenced from data structures defined in the previous clauses.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.3.6.3.2",
      "section_id": "6.3.6.3.2",
      "section_title": "Simple data types",
      "content": "The simple data types defined in table 6.3.6.3.2-1 shall be supported.\nTable 6.3.6.3.2-1: Simple data types\nType Name\nType Definition\nDescription\nApplicability\nUserInfoId\nstring\nUser Info ID is a string of hexadecimal characters, encoding the value of the user info ID parameter which is a 48-bit long bit string.\nUeSecurityCapability\nBytes\nString with format \"byte\" as defined in OpenAPI Specification [7], i.e. base64-encoded characters, encoding the \"UE security capability\" IE as specified in clause 11.3.11 of 3GPP TS 24.554 [16] (starting from octet 1).\nChosenPc5CipheringAlgorithm\ninteger\nThis IE shall indicate the chosen PC5 ciphering algorithm as specified in clause 11.4.2.51 of 3GPP TS 24.554 [16]\nDuik\nBytes\nString with format \"byte\" as defined in OpenAPI Specification [7], i.e. base64-encoded characters, encoding the \"DUIK\" IE as specified in clause 11.6.2.13 of 3GPP TS 24.554 [16].\nDuck\nBytes\nString with format \"byte\" as defined in OpenAPI Specification [7], i.e. base64-encoded characters, encoding the \"DUCK\" IE as specified in clause 11.6.2.14 of 3GPP TS 24.554 [16].\nDusk\nBytes\nString with format \"byte\" as defined in OpenAPI Specification [7], i.e. base64-encoded characters, encoding the \"DUSK\" IE as specified in clause 11.6.2.12 of 3GPP TS 24.554 [16].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.554_clause_11.3.11",
        "ts_24.554_clause_11.4.2.51",
        "ts_24.554_clause_11.6.2.13",
        "ts_24.554_clause_11.6.2.14",
        "ts_24.554_clause_11.6.2.12",
        "table_6.3.6.3.2-1",
        "ts_24.554"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.6.4",
      "section_id": "6.3.6.4",
      "section_title": "Data types describing alternative data types or combinations of data types",
      "content": "There is no data type describing alternative data types or combinations of data types in Npkmf_Discovery Service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.3.6.5",
      "section_id": "6.3.6.5",
      "section_title": "Binary data",
      "content": "There is no binary data type in Npkmf_Discovery Service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.559_6.3.7.1",
      "section_id": "6.3.7.1",
      "section_title": "General",
      "content": "For the Npkmf_Discovery API, HTTP error responses shall be supported as specified in clause 4.8 of 3GPP TS 29.501 [6]. Protocol errors and application errors specified in table 5.2.7.2-1 of 3GPP TS 29.500 [5] shall be supported for an HTTP method if the corresponding HTTP status codes are specified as mandatory for that HTTP method in table 5.2.7.1-1 of 3GPP TS 29.500 [5].\nIn addition, the requirements in the following clauses are applicable for the Npkmf_Discovery API.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_29.501_clause_4.8",
        "ts_29.500_table_5.2.7.2-1",
        "ts_29.500_table_5.2.7.1-1",
        "ts_29.501",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.7.2",
      "section_id": "6.3.7.2",
      "section_title": "Protocol Errors",
      "content": "Protocol errors handling shall be supported as specified in clause 5.2.7 of 3GPP TS 29.500 [5].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_5.2.7",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.7.3",
      "section_id": "6.3.7.3",
      "section_title": "Application Errors",
      "content": "The application errors defined for the Npkmf_Discovery service are listed in Table 6.3.7.3-1.\nTable 6.3.7.3-1: Application errors\nApplication Error\nHTTP status code\nDescription\nPROSE_SERVICE_UNAUTHORIZED\n403 Forbidden\nIt is used when the requested ProSe service is not authorized for this UE Identity.\nAPPLICATION_NOT_FOUND\n404 Not Found\nIt is used when the requested ProSe Application doesn't exist",
      "chunk_type": "general",
      "cross_references": [
        "table_6.3.7.3-1"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.8",
      "section_id": "6.3.8",
      "section_title": "Feature negotiation",
      "content": "The optional features in table 6.3.8-1 are defined for the Npkmf_Discovery API. They shall be negotiated using the extensibility mechanism defined in clause 6.6 of 3GPP TS 29.500 [5].\nTable 6.3.8-1: Supported Features\nFeature number\nFeature Name\nDescription\nN/A",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.500_clause_6.6",
        "table_6.3.8-1",
        "ts_29.500_table_6.3.8-1",
        "ts_29.500"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.9",
      "section_id": "6.3.9",
      "section_title": "Security",
      "content": "As indicated in 3GPP TS 33.501 [11] and 3GPP TS 29.500 [5], the access to the Npkmf_Discovery API may be authorized by means of the OAuth2 protocol (see IETF RFC 6749 [12]), based on local configuration, using the \"Client Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [13]) plays the role of the authorization server.\nIf OAuth2 is used, an NF Service Consumer, prior to consuming services offered by the Npkmf_Discovery API, shall obtain a \"token\" from the authorization server, by invoking the Access Token Request service, as described in 3GPP TS 29.510 [13], clause 5.4.2.2.\nNOTE:\tWhen multiple NRFs are deployed in a network, the NRF used as authorization server is the same NRF that the NF Service Consumer used for discovering the Npkmf_Discovery service.\nThe Npkmf_Discovery API defines the following scopes \"npkmf-keyrequest\" for OAuth2 authorization as specified in 3GPP TS 33.501 [8]:\nTable 6.3.9-1: OAuth2 scopes defined in Npanf_ProseKey API\nScope\nDescription\n\"npkmf-disc\"\nAccess to the Npkmf_Discovery API\n\"npkmf-disc:announce-authorize:modify\"\nAccess to modify the authorization to announce for a UE in the PLMN\n\"npkmf-disc:monitor-key:modify\"\nAccess to modify the authorization for monitoring for an UE in the PLMN\n\"npkmf-disc:discovery-authorize:modify\"\nAccess to modify the authorization from the 5G DDNMF for a discoverer UE in the PLMN to operate Model B restricted discovery",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.510_clause_5.4.2.2",
        "ts_33.501_table_6.3.9-1",
        "ts_33.501",
        "ts_29.500",
        "ts_29.510"
      ]
    },
    {
      "chunk_id": "ts_29.559_6.3.10",
      "section_id": "6.3.10",
      "section_title": "HTTP redirection",
      "content": "An HTTP request may be redirected to a different 5G PKMF service instance, within the same 5G PKMF or a different 5G PKMF of an 5G PKMF set, e.g. when an 5G PKMF service instance is part of an 5G PKMF (service) set or when using indirect communications (see 3GPP TS 29.500 [5]).\nAn SCP that reselects a different 5G PKMF producer instance will return the NF Instance ID of the new 5G PKMF producer instance in the 3gpp-Sbi-Producer-Id header, as specified in clause 6.10.3.4 of 3GPP TS 29.500 [5].\nIf an 5G PKMF within an 5G PKMF set redirects a service request to a different 5G PKMF of the set using an 307 Temporary Redirect or 308 Permanent Redirect status code, the identity of the new 5G PKMF towards which the service request is redirected shall be indicated in the 3gpp-Sbi-Target-Nf-Id header of the 307 Temporary Redirect or 308 Permanent Redirect response as specified in clause 6.10.9.1 of 3GPP TS 29.500 [5].\nAnnex A (normative):OpenAPI specification\nA.1\tGeneral\nThis Annex specifies the formal definition of the API(s) defined in the present specification. It consists of OpenAPI 3.0.0 specifications in YAML format.\nThis Annex takes precedence when being discrepant to other parts of the specification with respect to the encoding of information elements and methods within the API(s).\nNOTE 1:\tThe semantics and procedures, as well as conditions, e.g. for the applicability and allowed combinations of attributes or values, not expressed in the OpenAPI definitions but defined in other parts of the specification also apply.\nInformative copies of the OpenAPI specification files contained in this 3GPP Technical Specification are available on a Git-based repository that uses the GitLab software version control system (see clause 5.3.1 of 3GPP TS 29.501 [6] and clause 5B 3GPP TR 21.900 [14]).\nA.2\tNpkmf_PKMFKeyRequest API\nopenapi: 3.0.0\ninfo:\ntitle: Npkmf_PKMFKeyRequest\nversion: 1.0.1\ndescription: |\nPKMF KeyRequest Service.\n© 2022, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC).\nAll rights reserved.\nexternalDocs:\ndescription: 3GPP TS 29.559 V17.2.0; 5G System; 5G ProSe Key Management Services; Stage 3.\nurl: https://www.3gpp.org/ftp/Specs/archive/29_series/29.559/\nservers:\n- url: '{apiRoot}/npkmf-keyrequest/v1'\nvariables:\napiRoot:\ndefault: https://example.com\ndescription: apiRoot as defined in clause 4.4 of 3GPP TS 29.501\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- npkmf-keyrequest\npaths:\n/prose-keys/request:\npost:\nsummary: Request Keying Materials for 5G ProSe\noperationId: ProseKey\ntags:\n- ProSe Keys Collection (Collection)\nrequestBody:\nrequired: true\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/ProseKeyReqData'\nresponses:\n'200':\ndescription: Success\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/ProseKeyRspData'\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\n$ref: 'TS29571_CommonData.yaml#/components/responses/default'\ncomponents:\nsecuritySchemes:\noAuth2ClientCredentials:\ntype: oauth2\nflows:\nclientCredentials:\ntokenUrl: '{nrfApiRoot}/oauth2/token'\nscopes:\nnpkmf-keyrequest: Access to the Npkmf_PKMFKeyRequest API\nschemas:\n#\n#  Structured Data Types\n#\nProseKeyReqData:\ndescription: Representation of the input to request the keying material.\ntype: object\nproperties:\nrelayServCode:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RelayServiceCode'\nknrpFreshness1:\n$ref: '#/components/schemas/KnrpFreshnessParameter1'\nresyncInfo:\n$ref: 'TS29503_Nudm_UEAU.yaml#/components/schemas/ResynchronizationInfo'\nprukId:\n$ref: '#/components/schemas/PrukId'\nsuci:\n$ref: 'TS29509_Nausf_UEAuthentication.yaml#/components/schemas/Suci'\nrequired:\n- relayServCode\n- knrpFreshness1\nProseKeyRspData:\ndescription: Representation of the successfully requested keying material.\ntype: object\nproperties:\nknrp:\n$ref: '#/components/schemas/Knrp'\nknrpFreshness2:\n$ref: '#/components/schemas/KnrpFreshnessParameter2'\ngpi:\n$ref: '#/components/schemas/Gpi'\nrequired:\n- knrp\n- knrpFreshness2\n#\n#  Simple Data Types\n#\nPrukId:\ndescription: User Plane Prose Remote User Key ID\ntype: string\nKnrp:\ndescription: Key for NR PC5\ntype: string\nKnrpFreshnessParameter1:\ndescription: KNRP Freshness Parameter 1\ntype: string\nKnrpFreshnessParameter2:\ndescription: KNRP Freshness Parameter 2\ntype: string\nGpi:\ndescription: GBA Pushing Information\ntype: string\n#\n#  Enumeration Data Types\n#\nA.3\tNpkmf_ResolveRemoteUserId API\nopenapi: 3.0.0\ninfo:\ntitle: Npkmf_ResolveRemoteUserId\nversion: 1.0.0\ndescription: |\nPKMF Resolve Remote User Id Service.\n© 2023, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC).\nAll rights reserved.\nexternalDocs:\ndescription: 3GPP TS 29.559 V17.3.0; 5G System; 5G ProSe Anchor Services; Stage 3.\nurl: https://www.3gpp.org/ftp/Specs/archive/29_series/29.559/\nservers:\n- url: '{apiRoot}/npkmf-userid/v1'\nvariables:\napiRoot:\ndefault: https://example.com\ndescription: apiRoot as defined in clause 4.4 of 3GPP TS 29.501\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- npkmf-userid\npaths:\n/resolve-id:\npost:\nsummary: Retrieve the SUPI of the ProSe Remote UE\noperationId: RetrieveSUPI\ntags:\n- SUPI Retrieval\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/ResolveRequest'\nrequired: true\nresponses:\n'200':\ndescription: Expected response to a valid request\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/ResolveResponse'\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\ndescription: Unexpected error\ncomponents:\nsecuritySchemes:\noAuth2ClientCredentials:\ntype: oauth2\nflows:\nclientCredentials:\ntokenUrl: '{nrfApiRoot}/oauth2/token'\nscopes:\nnpkmf-userid: Access to the Npkmf_ResolveRemoteUserId API\nschemas:\n#\n#  Structured Data Types\n#\nResolveRequest:\ndescription: Request Data\ntype: object\nproperties:\nupPrukId:\n$ref: 'TS29559_Npkmf_PKMFKeyRequest.yaml#/components/schemas/PrukId'\nplmnId:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/PlmnId'\nrequired:\n- upPrukId\nResolveResponse:\ndescription: Response Data\ntype: object\nproperties:\nsupi:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Supi'\nrequired:\n- supi\n#\n#  Simple Data Types\n#\n#\n#  Enumeration Data Types\n#\nA.4\tNpkmf_Discovery API\nopenapi: 3.0.0\ninfo:\ntitle: Npkmf_Discovery API\nversion: '1.0.0'\ndescription: |\nNpkmf_Discovery Service.\n© 2023, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC).\nAll rights reserved.\nexternalDocs:\ndescription: 3GPP TS 29.559 V17.5.0; 5G System; 5G ProSe Key Management Services; Stage 3.\nurl: https://www.3gpp.org/ftp/Specs/archive/29_series/29.559/\nservers:\n- url: '{apiRoot}/npkmf-discovery/v1'\nvariables:\napiRoot:\ndefault: https://example.com\ndescription: apiRoot as defined in clause 4.4 of 3GPP TS 29.501\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- npkmf-discovery\npaths:\n/{ueId}/announce-authorize/{userInfoId}:\nput:\nsummary: Obtain the authorization from the 5G PKMF for announcing in the PLMN\noperationId: ObtainAnnounceAuth\ntags:\n- Obtain the authorization from the 5G PKMF for announcing in the PLMN\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- npkmf-disc\n- oAuth2ClientCredentials:\n- npkmf-disc\n- npkmf-disc:announce-authorize:modify\nparameters:\n- name: ueId\nin: path\ndescription: Identifier of the UE\nrequired: true\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/VarUeId'\n- name: userInfoId\nin: path\ndescription: User Info Id\nrequired: true\nschema:\n$ref: '#/components/schemas/UserInfoId'\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/AnnounceAuthData'\nrequired: true\nresponses:\n'201':\ndescription: Successful creation of the resource\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/AnnounceAuthData'\nheaders:\nLocation:\ndescription: >\nContains the URI of the newly created resource, according to the structure:\n{apiRoot}/npkmf-disc>/<apiVersion>/{ueId}/announce-authorize/{userInfoId}\nrequired: true\nschema:\ntype: string\n'204':\ndescription: Successful update of the resource.\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\ndescription: Unexpected error\n/{ueId}/monitor-key/{userInfoId}:\nput:\nsummary: Obtain the discovery key from the 5G PKMF for monitoring in the PLMN\noperationId: ObtainMonitorKey\ntags:\n- Obtain the discovery key from the 5G PKMF for monitoring in the PLMN\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- npkmf-disc\n- oAuth2ClientCredentials:\n- npkmf-disc\n- npkmf-disc:monitor-key:modify\nparameters:\n- name: ueId\nin: path\ndescription: Identifier of the UE\nrequired: true\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/VarUeId'\n- name: userInfoId\nin: path\ndescription: User Info Id\nrequired: true\nschema:\n$ref: '#/components/schemas/UserInfoId'\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/MonitorKeyReqData'\nrequired: true\nresponses:\n'201':\ndescription: Created\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/MonitorKeyRespData'\nheaders:\nLocation:\ndescription: >\nContains the URI of the newly created resource, according to the structure:\n{apiRoot}/npkmf-disc>/<apiVersion>/{ueId}/monitor-key/{userInfoId}\nrequired: true\nschema:\ntype: string\n'204':\ndescription: Successful update of the resource.\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\ndescription: Unexpected error\n/{ueId}/discovery-key/{userInfoId}:\nput:\nsummary: Obtain the discovery key from the 5G PKMF for a discoverer UE\noperationId: ObtainDiscKey\ntags:\n- Obtain the discovery key for a discoverer UE\nsecurity:\n- {}\n- oAuth2ClientCredentials:\n- npkmf-disc\n- oAuth2ClientCredentials:\n- npkmf-disc\n- npkmf-disc:discovery-authorize:modify\nparameters:\n- name: ueId\nin: path\ndescription: Identifier of the UE\nrequired: true\nschema:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/VarUeId'\n- name: userInfoId\nin: path\ndescription: User Info Id\nrequired: true\nschema:\n$ref: '#/components/schemas/UserInfoId'\nrequestBody:\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/DiscoveryKeyReqData'\nrequired: true\nresponses:\n'201':\ndescription: Created\ncontent:\napplication/json:\nschema:\n$ref: '#/components/schemas/DiscoveryKeyRespData'\nheaders:\nLocation:\ndescription: >\nContains the URI of the newly created resource, according to the structure:\n{apiRoot}/npkmf-disc>/<apiVersion>/{ueId}/discovery-key/{userInfoId}\nrequired: true\nschema:\ntype: string\n'204':\ndescription: Successful update of the resource.\n'307':\n$ref: 'TS29571_CommonData.yaml#/components/responses/307'\n'308':\n$ref: 'TS29571_CommonData.yaml#/components/responses/308'\n'400':\n$ref: 'TS29571_CommonData.yaml#/components/responses/400'\n'401':\n$ref: 'TS29571_CommonData.yaml#/components/responses/401'\n'403':\n$ref: 'TS29571_CommonData.yaml#/components/responses/403'\n'404':\n$ref: 'TS29571_CommonData.yaml#/components/responses/404'\n'411':\n$ref: 'TS29571_CommonData.yaml#/components/responses/411'\n'413':\n$ref: 'TS29571_CommonData.yaml#/components/responses/413'\n'415':\n$ref: 'TS29571_CommonData.yaml#/components/responses/415'\n'429':\n$ref: 'TS29571_CommonData.yaml#/components/responses/429'\n'500':\n$ref: 'TS29571_CommonData.yaml#/components/responses/500'\n'502':\n$ref: 'TS29571_CommonData.yaml#/components/responses/502'\n'503':\n$ref: 'TS29571_CommonData.yaml#/components/responses/503'\ndefault:\ndescription: Unexpected error\ncomponents:\nsecuritySchemes:\noAuth2ClientCredentials:\ntype: oauth2\nflows:\nclientCredentials:\ntokenUrl: '{nrfApiRoot}/oauth2/token'\nscopes:\nnpkmf-disc: Access to the Npkmf_Discovery API\nnpkmf-disc:announce-authorize:modify: >\nAccess to modify the authorization to announce for a UE in the PLMN\nnpkmf-disc:monitor-key:modify: >\nAccess to modify the authorization for monitoring for an UE in the PLMN\nnpkmf-disc:discovery-key:modify: >\nAccess to modify the authorization from the 5G DDNMF for a discoverer UE\nin the PLMN to operate Model B restricted discovery\nschemas:\n# STRUCTURED TYPES:\nAnnounceAuthData:\ntype: object\ndescription: Represents Data used to request the authorization to announce for a UE\nrequired:\n- relayServCode\nproperties:\nrelayServCode:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RelayServiceCode'\nMonitorKeyReqData:\ntype: object\ndescription: Data used to request the discovery key to monitor for a UE\nrequired:\n- relayServCode\n- ueSecurityCapability\nproperties:\nrelayServCode:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RelayServiceCode'\nueSecurityCapability:\n$ref: '#/components/schemas/UeSecurityCapability'\nMonitorKeyRespData:\ntype: object\ndescription: Represents the obtained Monitor Discovery Key Data for a UE\nrequired:\n- chosenPc5CipheringAlgorithm\n- discSecMaterials\nproperties:\nchosenPc5CipheringAlgorithm:\n$ref: '#/components/schemas/ChosenPc5CipheringAlgorithm'\ndiscSecMaterials:\n$ref: '#/components/schemas/DiscSecMaterials'\nDiscoveryKeyReqData:\ntype: object\ndescription: Data used to request the discovery key to monitor for a discoverer UE\nrequired:\n- relayServCode\n- ueSecurityCapability\nproperties:\nrelayServCode:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/RelayServiceCode'\nueSecurityCapability:\n$ref: '#/components/schemas/UeSecurityCapability'\nDiscoveryKeyRespData:\ntype: object\ndescription: Represents the obtained Monitor Discovery Key Data for a discoverer UE\nrequired:\n- chosenPc5CipheringAlgorithm\n- discSecMaterials\nproperties:\nchosenPc5CipheringAlgorithm:\n$ref: '#/components/schemas/ChosenPc5CipheringAlgorithm'\ndiscSecMaterials:\n$ref: '#/components/schemas/DiscSecMaterials'\nDiscSecMaterials:\ntype: object\ndescription: Represents the discovery security materials\nproperties:\nduik:\n$ref: '#/components/schemas/Duik'\ndusk:\n$ref: '#/components/schemas/Dusk'\nduck:\n$ref: '#/components/schemas/Duck'\n# SIMPLE TYPES:\nUserInfoId:\ntype: string\nUeSecurityCapability:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\nChosenPc5CipheringAlgorithm:\ndescription: Contains the chosen PC5 ciphering algorithm.\ntype: integer\nDuik:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\nDusk:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\nDuck:\n$ref: 'TS29571_CommonData.yaml#/components/schemas/Bytes'\n# ENUMS:\nAnnex B (informative):Change history\nChange history\nDate\nMeeting\nTDoc\nCR\nRev\nCat\nSubject/Comment\nNew version\n2022-04\nC4#109-e\nC4-222345\nImplementation of pCRs agreed in CT4#109-e including  C4-222355, C4-222356, C4-222023, C4-222024, C4-222025, C4-222026, C4-222027, C4-222028, C4-222029, C4-222031, C4-222409, C4-222410, C4-222411, C4-222412, C4-222413, C4-222414\n0.1.0\n2022-05\nC4#110-e\nC4-223454\nImplementation of pCRs agreed in CT4#110-e including  C4-223135, C4-223157, C4-223158, C4-223160, C4-223351, C4-223352, C4-223416, C4-223417\n0.2.0\n2022-06\nCT#96\nCP-221082\nTS presented for information and approval\n1.0.0\n2022-06\nCT#96\nCP-221082\nTS approved in CT#96\n17.0.0\n2022-09\nCT#97e\nCP-222035\n0001\n-\nF\nAlignment on the service name used with template\n17.1.0\n2022-12\nCT#98e\nCP-223054\n0003\n2\nF\nPRUK Name Alignment\n17.2.0\n2022-12\nCT#98e\nCP-223054\n0004\n-\nF\nCorrect the server url and some table styles\n17.2.0\n2022-12\nCT#98e\nCP-223054\n0006\n-\nF\nUpdate on the procedure title\n17.2.0\n2022-12\nCT#98e\nCP-223066\n0007\n-\nF\n29.559 Rel-17 API version and External doc update\n17.2.0\n2023-06\nCT#100\nCP-231202\n0010\n3\nF\nAdd service Npkmf_ResolveRemoteUserId\n18.0.0\n2023-06\nCT#100\nCP-231026\n0008\n3\nF\nLocation header description\n18.0.0\n2023-09\nCT#101\nCP-232071\n0018\n1\nA\nRemove the EN and add the missing reference point\n18.1.0\n2023-12\nCT#102\nCP-233069\n0024\n3\nA\nNpkmf_Discovery_AnnounceAuthorize service operation\n18.2.0\n2023-12\nCT#102\nCP-233069\n0026\n1\nA\nNpkmf_Discovery_MonitorKey service operation\n18.2.0\n2023-12\nCT#102\nCP-233069\n0028\n1\nA\nNpkmf_Discovery_DiscoveryKey service operation\n18.2.0\n2023-12\nCT#102\nCP-233055\n0029\n-\nF\nAlign with the SBI template\n18.2.0\n2023-12\nCT#102\nCP-233055\n0031\n-\nF\nPKMF replace by 5G PKMF\n18.2.0\n2023-12\nCT#102\nCP-233028\n0032\n1\nF\nRFC7540 obsoleted by RFC9113\n18.2.0\n2023-12\nCT#102\nCP-233055\n0033\n1\nB\nEnhancement to support UE-to-UE relay\n18.2.0\n2023-12\nCT#102\nCP-233030\n0035\n-\nF\nProblemDetails RFC 7807 obsoleted by 9457\n18.2.0\n2024-06\nCT#104\nCP-241050\n0039\n1\nF\nClarification on URI Path Segment Naming Conventions\n18.3.0\n2024-06\nCT#104\nCP-241050\n0040\n1\nF\nClarifying the self-references\n18.3.0",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.500_clause_6.10.3.4",
        "ts_29.500_clause_6.10.9.1",
        "ts_29.501_clause_5.3.1",
        "ts_29.501_clause_5",
        "ts_29.501_clause_4.4",
        "ts_29.500",
        "ts_29.501",
        "ts_21.900",
        "ts_29.559"
      ]
    }
  ]
}
{
  "metadata": {
    "specification_id": "ts_23.271",
    "version": "18.0.0",
    "title": "3GPP TS 23.271",
    "file_path": "/content/drive/MyDrive/RAG_thesis/data/23_series/23271-i00/23271-i00.docx"
  },
  "export_info": {
    "export_date": "2025-07-26T09:30:11.845725",
    "total_chunks": 237
  },
  "chunks": [
    {
      "chunk_id": "ts_23.271_1",
      "section_id": "1",
      "section_title": "Scope",
      "content": "The present document specifies the stage 2 of the LoCation Services (LCS) feature in UMTS, GSM and EPS (for E-UTRAN), which provides the mechanisms to support mobile location services for operators, subscribers and third party service providers.\nLocation Services in 5GC are restricted to regulatory services and are specified in TS 23.501 [54] and TS 23.502 [55] in this release of the specification. The architecture and signalling procedures in NG-RAN are defined in TS 38.305 [56].\nThe present document replaces the specifications TS 23.171 (Release 1999) and the system and core network parts of GSM 03.71 (Release 1999). TS 43.059 [16] replaces the radio access network parts of GSM 03.71 (Release 1999).\nLocation Services may be considered as a network provided enabling technology consisting of standardised service capabilities, which enable the provision of location applications. The application(s) may be service provider specific. The description of the numerous and varied possible location applications which are enabled by this technology are outside the scope of the present document. However, clarifying examples of how the functionality being described may be used to provide specific location services may be included.\nThis stage 2 service description covers the LCS system functional model for the whole system, the LCS system architecture, state descriptions, message flows, etc.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.501",
        "ts_23.502",
        "ts_38.305",
        "ts_23.171",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_2",
      "section_id": "2",
      "section_title": "References",
      "content": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non‑specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TS 25.305: \"Stage 2 functional specification of UE positioning in UTRAN\".\n[2]\t(void).\n[3]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[4]\t3GPP TS 22.071: \"Technical Specification Group Systems Aspects; Location Services (LCS); Stage 1\".\n[5]\t(void).\n[6]\t(void).\n[7]\t(void).\n[8]\t3GPP TS 22.101: \"Service principles\".\n[9]\t(void).\n[10]\t(void).\n[11]\t3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".\n[12]\t(void).\n[13]\t(void).\n[14]\t3GPP TS 25.413: \"UTRAN Iu Interface RANAP signalling\".\n[15]\t3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service description; Stage 2\".\n[16]\t3GPP TS 43.059: \"Functional Stage 2 description of Location Services in GERAN\".\n[17]\t3GPP TS 23.003: \"Numbering, addressing and identification\".\n[18]\t3GPP TS 29.002: \"Mobile Application Part (MAP) Specification\".\n[19]\t(void).\n[20]\t3GPP TS 23.002: \"Network architecture\".\n[21]\t3GPP TS 23.078: \"Customised Applications for Mobile network Enhanced Logic (CAMEL) - stage 2\".\n[22]\t3GPP TS 23.011: \"Technical realization of Supplementary Services\".\n[23]\t3GPP TS 23.007: \"Restoration procedures\".\n[24]\t3GPP TS 24.008: \"Mobile Radio Interface - Layer 3 MM/CC Specification\".\n[25]\t3GPP TS 25.331: \"RRC protocol specification\".\n[26]\t3GPP TS 23.127: \"Virtual Home Environment/Open Service Access\".\n[27]\t3GPP TS 29.198‑1: \"Open Service Access (OSA); Application Programming Interface (API); Part 1; Overview\".\n[28]\t3GPP TS 29.198‑2: \"Open Service Access (OSA); Application Programming Interface (API); Part 2; Common Data\".\n[29]\t3GPP TS 29.198‑3: \"Open Service Access (OSA); Application Programming Interface (API); Part 3; Framework\".\n[30]\t3GPP TS 29.198‑6: \"Open Service Access (OSA); Application Programming Interface (API); Part 6: Mobility\".\n[31]\tOMA MLP TS: \"Mobile Location Protocol\", [http://www.openmobilealliance.org].\n[32]\tANSI J-STD-036B: \"Enhanced Wireless 9-1-1 Phase 2\".\n[33]\tRFC 2396: \"Uniform Resource Identifiers\".\n[34]\tRFC 3261: \"SIP: Session Initiation Protocol\".\n[35]\t3GPP TS 23.228: \"IP multimedia subsystem (IMS)\".\n[35a]\tITU Recommendation E.164: \"The international public telecommunication numbering plan\".\n[35b]\t3GPP TS 22.060: \"General Packet Radio Service (GPRS); Service Description, Stage 1\".\n[36]\tOMA RLP TS: \"Roaming Location Protocol\", [http://www.openmobilealliance.org].\n[36a]\t3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".\n[37]\t3GPP TS 31.111: \"Universal Subscriber Identity Module (USIM) Application Toolkit (USAT)\".\n[38]\tOpen Mobile Alliance, OMA AD SUPL: \"Secure User Plane Location Architecture\", (http://www.openmobilealliance.org).\n[39]\tOpen Mobile Alliance, OMA TS ULP: \"User Plane Location Protocol\", (http://www.openmobilealliance.org).\n[40]\tIETF RFC 4119: \"A Presence-based GEOPRIV Location Object Format\".\n[41]\t3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".\n[42]\t3GPP TS 36.305: \"Stage 2 functional specification of UE positioning in E-UTRAN\".\n[43]\t3GPP TS 23.216: \"Single Radio Voice Call Continuity (SRVCC); Stage 2\".\n[44]\t3GPP TS 23.402: \"Architecture enhancements for non-3GPP accesses\".\n[45]\t3GPP TS 29.173: \"Location Services (LCS); Diameter-based SLh interface for Control Plane LCS\".\n[46]\t3GPP TS 29.171: \"LCS Application Protocol (LCS-AP) between MME and E-SMLC; SLs Interface\".\n[47]\t3GPP TS 36.355: \"Evolved Universal Terrestrial Radio Access (E-UTRA); LTE Positioning Protocol (LPP)\".\n[48]\t3GPP TS 36.455: \"Evolved Universal Terrestrial Radio Access (E-UTRA); LTE Positioning Protocol Annex (LPPa)\".\n[49]\t3GPP TS 36.413: \"Evolved Universal Terrestrial Radio Access Network (E-UTRAN); S1 Application Protocol (S1AP)\".\n[50]\t3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall Description; Stage 2\".\n[51]\t3GPP TS 29.272: \"Evolved Packet System (EPS);Mobility Management Entity (MME) and Serving GPRS Support Node (SGSN) related interfaces based on Diameter protocol\".\n[52]\t3GPP TS 23.234: \"3GPP system to Wireless Local Area Network (WLAN) interworking\".\n[53]\t3GPP TS 23.237: \"IP Multimedia Subsystem (IMS) Service Continuity; Stage 2\".\n[54]\t3GPP TS 23.501: \" System Architecture for the 5G System; Stage 2\".\n[55]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".\n[56]\t3GPP TS 38.305: \"Stage 2 functional specification of User Equipment (UE) positioning in NG-RAN\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_25.305",
        "ts_21.905",
        "ts_22.071",
        "ts_22.101",
        "ts_23.032",
        "ts_25.413",
        "ts_23.060",
        "ts_43.059",
        "ts_23.003",
        "ts_29.002",
        "ts_23.002",
        "ts_23.078",
        "ts_23.011",
        "ts_23.007",
        "ts_24.008",
        "ts_25.331",
        "ts_23.127",
        "ts_29.198",
        "ts_23.228",
        "ts_22.060",
        "ts_23.167",
        "ts_31.111",
        "ts_23.401",
        "ts_36.305",
        "ts_23.216",
        "ts_23.402",
        "ts_29.173",
        "ts_29.171",
        "ts_36.355",
        "ts_36.455",
        "ts_36.413",
        "ts_36.300",
        "ts_29.272",
        "ts_23.234",
        "ts_23.237",
        "ts_23.501",
        "ts_23.502",
        "ts_38.305"
      ]
    },
    {
      "chunk_id": "ts_23.271_3.1",
      "section_id": "3.1",
      "section_title": "Definitions",
      "content": "For the purposes of the present document, the following terms and definitions apply:\nCAMEL: CAMEL is a network functionality, which provides the mechanisms of Intelligent Network to a mobile user.\nCall Related: any LCS related operation which is associated with an established call in CS domain and a session via an active PDP context in PS domain.\nCodeword: access code, which is used by a Requestor or LCS Client in order to gain acceptance of a location request for a Target UE. The codeword is part of the privacy information that may be registered by a Target UE user.\nCurrent Location: after a location attempt has successfully delivered a location estimate and its associated time stamp, the location estimate and time stamp is referred to as the \"current location\" at that point in time.\nDeferred location request: location request where the location response (responses) is (are) required after a specific event has occurred. The event may or may not occur immediately.\nGlobal Navigation Satellite System: Global Navigation Satellite System (GNSS) consists of three functional elements: Space Segment (satellites), User Segment (receivers), and Control Segment (maintenance etc.). The GNSS receiver calculates its own position based on the received time differences for several satellites. GNSS include Global Positioning System (GPS) and GALILEO.\nImmediate location request: location request where a single location response only is required immediately\nInitial Location: in the context of an originating emergency call the location estimate and the associated time stamp at the commencement of the call set-up is referred to as \"initial location\".\nLast Known Location: current location estimate and its associated time stamp for Target UE stored in the LCS Server is referred to as the \"last known location\" and until replaced by a later location estimate and a new time stamp is referred to as the \"last known location\".\nLCS (LoCation Services): LCS is a service concept in system (e.g. GSM or UMTS) standardization. LCS specifies all the necessary network elements and entities, their functionalities, interfaces, as well as communication messages, due to implement the positioning functionality in a cellular network. Note that LCS does not specify any location based (value added) services except locating of emergency calls.\nLCS Client: software and/or hardware entity that interacts with a LCS Server for the purpose of obtaining location information for one or more Mobile Stations. LCS Clients subscribe to LCS in order to obtain location information. LCS Clients may or may not interact with human users. The LCS Client is responsible for formatting and presenting data and managing the user interface (dialogue). The LCS Client may reside in the Mobile Station (UE).\nLCS Client Access barring list: optional list of MSISDNs per LCS Client where the LCS Client is not allowed to locate any MSISDN therein.\nLCS Client Subscription Profile: collection of subscription attributes of LCS related parameters that have been agreed for a contractual period of time between the LCS client and the service provider.\nLCS Feature: capability of a PLMN to support LCS Client/server interactions for locating Target UEs.\nLCS QoS Class: The QoS class determines the degree of adherence to the quality of service information as required by the source of a location request.\nLCS Server: software and/or hardware entity offering LCS capabilities. The LCS Server accepts requests, services requests, and sends back responses to the received requests. The LCS server consists of LCS components, which are distributed to one or more PLMN and/or service provider.\nLDR reference number: the identity which is assigned and maintained by the H-GMLC and circulated between the LCS Client, R-GMLC, H-GMLC, V-GMLC, MSC/SGSN and UE. With the identity of the UE, the LDR reference number can unique identify a Location Deferred Request. Notes: UE is involved only when the event type of the deferred request is \"change of area\" or \"periodic location\". In addition, in a Periodical Immediate/deferred LCS Service Request, the LDR reference number is exclusive.\nLinear Distance Threshold: a straight line distance used for a deferred location request for the motion event. The linear distance threshold is defined by the LCS client and triggers a motion event when a UE moves by more than this distance from a previous location. The linear distance threshold is equivalent to a change of area event for leaving an area where the area is a circle with the linear distance threshold as a radius and centred on the previous location.\nLocal Information: information related to a given location, or general information, which is made available in a given location.\nLocal Service: service, which can be exclusively provided in the current serving network by a Value added Service Provider.\nLocation (Based) Application: location application is an application software processing location information or utilizing it in some way. The location information can be input by a user or detected by network or UE. Navigation is one location application example.\nLocation Based Service (LBS): service provided either by teleoperator or a 3rd party service provider that utilizes the available location information of the terminal. Location Application offers the User Interface for the service. LBS is either a pull or a push type of service (see Location Dependent Services and Location Independent Services). In ETSI/GSM documentation of SoLSA, LBS is called \"Location Related Service\". ETSI and/or 3GPP -wide terminology harmonization is expected here.\nLocation Dependent Service: service provided either by teleoperator or a 3rd party service provider that is available (pull type) or is activated (push type) when the user arrives to a certain area. It doesn't require any subscription in advance, but the push type activation shall be confirmed by the user. The offered service itself can be any kind of service (e.g. a public Xerox machine or the discount list in a store).\nLocation Estimate: geographic location of an UE and/or a valid Mobile Equipment (ME), expressed in latitude and longitude data. The Location Estimate shall be represented in a well-defined universal format. Translation from this universal format to another geographic location system may be supported, although the details are considered outside the scope of the primitive services. The location estimate may include the velocity of the UE.\nLocation Identifier: information about the current location of the UE in the network. Location is indicated in network terms, for example using the global cell id in cellular networks, line-id in fixed broadband networks, the (MAC) address of the WLAN AP or Location Object as defined by IETF RFC 4119 [40], (OMA-Location also uses this term, but OMA so far defines the Location Identifier only for cellular access).\nLocation Independent Service: service provided either by teleoperator or a 3rd party service provider that is available and therefore can be activated anywhere in the network coverage. It is activated by the user's request or by other user's activated service, and therefore it requires a subscription in advance (pull type). The offered service itself can be any kind of service (e.g. MMS, SWDL, or LBS!).\nLocation Retrieval Function (LRF): this functional entity handles the retrieval of location information for the UE including, where required, interim location information, initial location information and updated location information. The LRF may interact with a separate RDF or contain an integrated RDF in order to obtain routing information. The LRF may interact with a separate GMLC or contain an integrated GMLC in order to obtain location information. The LRF may interact with or contain other types of location server functions in order to obtain location information.\nMaximum reporting time: maximum allowed time between successive area/motion event reports. Expiration of the maximum reporting time triggers a report, the UE indicates expiration of the maximum reporting time as the trigger event.\nMinimum reporting time: minimum allowed time between successive area/motion event reports. The UE defers any event report if needed until minimum reporting time expires.\nMobile Assisted positioning: any mobile centric positioning method (e.g. IPDL-OTDOA, E-OTD, GPS) in which the UE provides position measurements to the network for computation of a location estimate by the network. The network may provide assistance data to the UE to enable position measurements and/or improve measurement performance.\nMobile Based positioning: any mobile centric positioning method (e.g. IPDL-OTDOA, E-OTD, GPS) in which the UE performs both position measurements and computation of a location estimate and where assistance data useful or essential to one or both of these functions is provided to the UE by the network. Position methods where an UE performs measurements and location computation without network assistance data are not considered within this category.\nMobile Station: mobile station (MS) consists of Mobile or User Equipment (ME or UE) with a valid SIM or USIM attached. The abbreviation \"UE\" in this specification refers both to MS and User Equipment, see below.\nMO-LR Short Circuit: use of an MO-LR based procedure to provide a location estimate directly from the UE to the serving SGSN or MSC using a Mobile Based positioning method (e.g. GPS) according to the requested LCS QoS and that is not obtained or verified by the RAN.\nNetwork-based positioning: a positioning method (i.e. UTDOA) in which multiple network nodes (e.g. LMUs) perform position radio measurements based on UL transmissions from a mobile terminal to provide them to an E‑SMLC for computation of a location estimate for the mobile terminal.\nNon-dialable call back number: In case of a SIM-less emergency call, or a non-registered (U)SIM emergency call, a non-dialable callback number shall be used to identify the target UE. The format and structure of the non-dialable callback number is according to national or regional regulations.\nNon-registered (U)SIM emergency call: The emergency call where the U(SIM) has not been authenticated and have not been registered in the VLR. Examples of such cases could be emergency call from a blocked (U)SIM due to mistyped PIN, or when the UE is in \"enter PIN\" mode, or the emergency call is performed in another network with no roaming agreement with the home PLMN. Any IMSI retrieved from such a (U)SIM cannot be trusted and so cannot be used to identify the calling party.\nPLMN Access barring list: optional list of MSISDN per PLMN where any LCS Client is not allowed to locate any MSISDN therein except for certain exceptional cases.\nPositioning (/location detecting): positioning is a functionality, which detects a geographical location and optionally, velocity (of e.g. a mobile terminal).\nPositioning method (/locating method): method or technical solution, which is used to get an estimate of the target mobile's geographical location. For example positioning methods based on radio cell coverage, GPS or Assisted GPS methods, which are based on the Time-Of-Arrival (TOA) algorithm, and UTDOA, OTDOA or E-OTD methods, which are based on the Time-Difference-Of-Arrival (TDOA) algorithm. The positioning methods are further described in E-UTRAN Stage 2, TS 36.305 [42], UTRAN Stage 2, TS 25.305 [1] and GERAN Stage 2, TS 43.059 [16].\nPredefined area: geographical area, which is not related to cell or radio coverage. The mobile may take special action when it recognises it has entered or left a predefined area.\nPrivacy Class: list of LCS Clients defined within a privacy exception class to which permission may be granted to locate the target UE. The permission shall be granted either on activation by the target UE or permanently for a contractual period of time agreed between the target UE and the service provider.\nPrivacy Exception List: list consisting of various types of privacy classes (i.e. operator related, personal etc.). Certain types of classes may require agreement between the service provider and the target UE.\nPrivacy Profile Register, PPR: The PPR stores privacy information of the target mobile. The PPR also executes privacy checks and sends the privacy check results to other network elements using the Lpp interface. PPR may be a standalone network entity or the PPR functionality may be integrated in H-GMLC.\nProhibited area: area where the mobile must not activate its transmitter. The Prohibited area may be a Predefined area described above or related to radio cell(s).\nPseudo-external identity: The pseudo-external identity is not the identity of real external LCS client but the identity, which is used for notifying the result of the enhanced privacy check. The pseudo-external identity shall keep the compatibility with pre Rel-6 privacy mechanisms, which does not understand privacy check result made by H-GMLC/PPR. Each operator defines its own the pseudo-external identities.\nPseudonym: A fictitious identity, which may be used to conceal the true identity (i.e. MSISDN and IMSI) of a target UE from the requestor and the LCS client.\nPseudonym mediation device: Functionality that verifies pseudonyms to verinyms.\nRequest id: identity which is used to identify the correspondence of a location request to multiple responses when the Response method is ASYNC. Each receiving GMLC (R-GMLC or V-GMLC or H-GMLC) allocates and maintains the Request id to identify each ASYNC location request, and includes it in the responses to the source entity of the location request (i.e. LCS client or GMLC).\nRequestor: the originating entity which has requested the location of the target UE from the LCS client.\nRequestor Identity: This identifier is identifying the Requestor and can be e.g. MSISDN or logical name.\nResponse method: method how a GMLC, which receives a location request message from another entity (i.e. LCS client or GMLC), responds to the location request. There are two methods, synchronous (SYNC) and asynchronous (ASYNC). When the requesting entity wishes multiple responses (either about one or several target UE's location) to a single location request the procedure is ASYNC and when the requesting entity wishes a single response the procedure is SYNC. The source entity of the location request (i.e. LCS client or GMLC) can choose a preferred method and informs the method to the receiving GMLC. However, the selection of the method used is made by the receiving GMLC and when the ASYNC method is selected the Request id is notified to the source entity. The receiving GMLC can turn a SYNC request into an ASYNC procedure, e.g. in an overload situation, and the source entity (i.e. LCS client or GMLC) should be able to receive multiple responses even though the request was SYNC.\nRouting Determination Function (RDF): The functional entity, which may be integrated in a Location Server (e.g. GMLC) or in an LRF, provides the proper PSAP destination address to the E-CSCF for routing the emergency request. It can interact with a location functional entity (e.g. GMLC) to manage ESQK allocation and management, and deliver location information to the PSAP.\nService Area Identifier (SAI): information, which is used to identify an area consisting of one or more cells belonging to the same Location Area, see TS 25.413 [14]. Such an area is called a Service Area and can be used for indicating the location of a UE to the CN. For this specification, only a Service Area that is defined to be applicable to the PS and CS domains shall be used.\nService coverage: a list of country codes where an LCS client offers its location services. Country code in this context means E.164 country code for a geographic area [35a].\nService Type: attribute of specific location based service provided by the LCS client, as defined in TS 22.071 [4].\nServing cell identity: the Cell Global Identification (CGI), see TS 23.003 [17], of the cell currently used by the target UE, e.g. for an emergency call in A-mode.\nSIM-less emergency call: The emergency call that is originated from a UE, which does not have a SIM or USIM.\nSubscription Profile: profile detailing the subscription to various types of privacy classes.\nTarget area: geographical area which is used for change of area type deferred location request. The target area is defined by the LCS client and is expressed as geographical area using a shape defined in TS 23.032 [11], as a geographical area using local coordinate system, as an E.164 country code for a geographic area [35a], as a PLMN identity or as a geopolitical name of the area (e.g. London).\nTarget UE: UE being positioned.\nUser Equipment: term 'User Equipment', or 'UE', as defined in TR 21.905 [3]. UE in this specification may also refer to a Mobile Equipment or User Equipment used for emergency calls, that do not have valid SIM or USIM.\nVelocity: The speed of a UE and the direction in which it is travelling, encoded as defined in TS 23.032 [11]. Velocity may be defined as either 2-D (horizontal) velocity or 3-D (horizontal and vertical) velocity. Both 2-D and 3-D velocity may be reported either with or without uncertainty.\nVerinym: True identity, i.e. MSISDN or IMSI, of the target UE.\nFurther UMTS related definitions are given in TS 22.101 [8].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_36.305",
        "ts_25.305",
        "ts_43.059",
        "ts_25.413",
        "ts_22.071",
        "ts_23.003",
        "ts_23.032",
        "ts_21.905",
        "ts_22.101"
      ]
    },
    {
      "chunk_id": "ts_23.271_3.2",
      "section_id": "3.2",
      "section_title": "Symbols",
      "content": "For the purposes of the present document, the following symbols apply:\nDh\tInterface between LIMS-IWF and SLF\nGb\tInterface between 2G-SGSN and BSS\nGs\tInterface between MSC and SGSN\nLa\tInterface between GMLC and AAA\nLc\tInterface between gateway MLC and gsmSCF (CAMEL interface)\nLe\tInterface between External User and MLC (external interface)\nLg\tInterface between Gateway MLC - VMSC, GMLC - MSC Server, GMLC - SGSN (gateway MLC interface)\nLgd\tInterface between GMLC and SGSN (Diameter based)\nLh\tInterface between Gateway MLC and HLR (MAP based)\nLid\tInterface between GMLC and PMD.\nLpp\tInterface between GMLC(H-GMLC) and PPR entity.\nLr\tInterface between Gateway MLCs\nMl\tInterface between the E-CSCF and LRF\nSh\tInterface between LIMS-IWF and HSS\nSLg\tInterface between GMLC and MME\nSLh\tInterface between GMLC and HSS (Diameter based)\nSLs\tInterface between MME and E-SMLC\nUm\tGERAN Air Interface\nUu\tUTRAN Air Interface",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_3.3",
      "section_id": "3.3",
      "section_title": "Abbreviations",
      "content": "For the purposes of the present document, the following abbreviations apply:\n2G-\tSecond Generation\n3G-\tThird Generation\nA-GNSS\tAssisted Global Navigation Satellite System\nAAA\tAuthentication, Authorization, Accounting\nAC\tAdmission Control\nAI\tApplication Interface (prefix to interface class method)\nANM\tAnswer Message (ISUP)\nAPN\tAccess Point Name\nAPN-NI\tAPN Network Identifier\nARIB\tAssociation of Radio Industries and Business\nATD\tAbsolute Time Difference\nBCCH\tBroadcast Control Channel\nBER\tBit Error Rate\nBSSID\tBasic Service Set Identifier\nBSS\tBase Station Subsystem\nBTS\tBase Transceiver Station\nCAMEL\tCustomised Application For Mobile Network Enhanced Logic\nCAP\tCAMEL Application Part\nCM\tConnection Management\nCN\tCore Network\nCSCF\tCall Service Control Function\nCSE\tCamel Service Environment\nDL\tDownlink\nDNS\tDomain Name System\nDRNC\tDrift RNC\nE-CSCF\tEmergency CSCF\nE-OTD\tEnhanced Observed Time Difference\nE-SLP\tEmergency SUPL Location Platform\nE-SMLC\tEvolved Serving Mobile Location Centre\nE-STN-DR\tEmergency Session Transfer Number for DRVCC\nFER\tFrame Error Rate\nGERAN\tGSM EDGE Radio Access Network\nGGSN\tGateway GPRS Support Node\nGMLC\tGateway MLC\nGNSS\tGlobal Navigation Satellite System\nGPRS\tGeneral Packet Radio Service\nGPS\tGlobal Positioning System\nHE\tHome Environment\nH-GMLC\tHome-GMLC\nH-LIMS-IWF\tHome-LIMS-IWF\nHSS\tHome Subscriber Server\nHLR\tHome Location Register\nHPLMN\tHome Public Land Mobile Network\nIMEI\tInternational Mobile Equipment Identity\nIMS\tIP Multimedia Subsystem\nIMSI\tInternational Mobile Subscriber Identity\nIP\tInternet Protocol\nIPDL\tIdle Period Downlink\nIW-MT-LR\tMobile Terminated Location Request for an I-WLAN\nI-WLAN\tInterworking WLAN\nLA\tLocation Application\nLAF\tLocation Application Function\nLBS\tLocation Based Services\nLCAF\tLocation Client Authorization Function\nLCCF\tLocation Client Control Function\nLCCTF\tLocation Client Co-ordinate Transformation Function\nLCF\tLocation Client Function\nLCZTF\tLocation Client Zone Transformation Function\nLCS\tLoCation Services\nLDR\tLocation Deferred Request\nLIMS-IWF\tLocation IMS – Interworking Function\nLIR\tLocation Immediate Request\nLMU\tLocation Measurement Unit\nLRF\tLocation Retrieval Function\nLSAF\tLocation Subscriber Authorization Function\nLSBcF\tLocation System Broadcast Function\nLSBF\tLocation System Billing Function\nLSCF\tLocation System Control Function\nLSCTF\tLocation System Co-ordinate Transformation Function\nLSOF\tLocation System Operation Function\nLSPF\tLocation Subscriber Privacy Function\nLSTF\tLocation Subscriber Translation Function\nMAP\tMobile Application Part\nME\tMobile Equipment\nMExE\tMobile Execution Environment\nMGCF\tMedia Gateway Control Function\nMLC\tMobile Location Centre\nMLP\tMobile Location Protocol\nMM\tMobility Management\nMO-LR\tMobile Originated Location Request\nMS\tMobile Station\nMSC\tMobile services Switching Centre\nMSISDN\tMobile Station Integrated Services Data Network\nMT-LR\tMobile Terminated Location Request\nNA-ESRD\tNorth American Emergency Service Routing Digits\nNA-ESRK\tNorth American Emergency Service Routing Key\nNI-LR\tNetwork Induced Location Request\nNPLI\tNetwork Provided Location Information\nOMA\tOpen Mobile Alliance\nOSA\tOpen Service Architecture\nOTDOA\tObserved Time Difference Of Arrival\nPC\tPower Control\nPCF\tPower Calculation Function\nPLMN\tPublic Land Mobile Network\nPMD\tPseudonym mediation device functionality\nPOI\tPrivacy Override Indicator\nPPR\tPrivacy Profile Register\nPRCF\tPositioning Radio Co-ordination Function\nPRRM\tPositioning Radio Resource Management\nPSAP\tPublic Safety Answering Point\nPSE\tPersonal Service Environment\nPSM\tPower Saving Mode\nPSMF\tPositioning Signal Measurement Function\nPSTN\tPublic Switched Telephone Network\nQoS\tQuality of Service\nRA\tRouting Area\nRACH\tRandom Access Channel\nRAN\tRadio Access Network\nRANAP\tRadio Access Network Application Part\nR-GMLC\tRequesting-GMLC\nRDF\tRouting Determination Function\nRIS\tRadio Interface Synchronization\nR-LIMS-IWF\tRequesting-LIMS-IWF\nRLP\tRoaming Location Protocol\nRNC\tRadio Network Controller\nRRM\tRadio Resource Management\nRTD\tReal Time Difference\nRTT\tRound Trip Time\nSAI\tService Area Identifier\nSAT\tSIM Application Tool-Kit\nSCCP\tSignalling Connection Control Part\nSCS\tService Capability Server\nSGSN\tServing GPRS Support Node\nSI\tService Interface (prefix to interface class method)\nSIM\tSubscriber Identity Module\nSIP\tSession Initiation Protocol\nSIP-URI\tSIP Uniform Resource Identifier\nSIR\tSignal Interference Ratio\nSLF\tSubscription Locator Function\nSLP\tSUPL Location Platform\nSLPP\tSubscriber LCS Privacy Profile\nSMLC\tServing Mobile Location Centre\nSMS\tShort Message Service\nSP\tService Point\nSRNC\tServing RNC\nSS7\tSignalling System No 7\nSUPL\tSecure User Plane Location\nTA\tTiming Advance\nTAU\tTracking Area Update\nTEL-URL\tTelephone Uniform Resource Locator\nTMSI\tTemporary Mobile Subscriber Identity\nTOA\tTime Of Arrival\nTTTP\tTransfer To Third Party\nUDT\tSCCP Unitdata message\nUE\tUser Equipment\nUL\tUplink\nUMTS\tUniversal Mobile Telecommunication System\nUPLI\tUE Provided Location Information\nUSIM\tUniversal Subscriber Identity Module\nUTDOA\tUplink Time Difference of Arrival\nUTRAN\tUniversal Terrestrial Radio Access Network\nVASP\tValue Added Service Provider\nV-GMLC\tVisited -GMLC\nVHE\tVirtual Home Environment\nWCDMA\tWideband Code Division Multiple Access\nFurther related abbreviations are given in TR 21.905 [3].",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905"
      ]
    },
    {
      "chunk_id": "ts_23.271_4",
      "section_id": "4",
      "section_title": "Main concepts",
      "content": "A general description of location services and service requirements are given in the specification TS 22.071 [4]. The positioning of the UE is a service provided by the Access Network. In particular, all Access Networks (e.g. UTRAN, GERAN, E-UTRAN), that facilitate determination of the locations of User Equipments, shall be able to exchange location information with the core network as defined in the present document (when connected to a Core Network). Optionally, location information may also be communicated between GMLCs, located in the same or a different PLMN, via the specified GMLC to GMLC interface.\nBy making use of the radio signals the capability to determine the (geographic) location of the user equipment (UE) or mobile station (UE) shall be provided. The location information may be requested by and reported to a client (application) associated with the UE, or by a client within or attached to the Core Network. The location information may also be utilised internally in the system; for example, for location assisted handover or to support other features such as home location billing. The location information request may ask for the velocity of the UE as part of the positioning information. The position information shall be reported in standard, i.e. geographical co-ordinates, together with the time-of-day and the estimated errors (uncertainty) of the location of the UE according to specification TS 23.032 [11]. The velocity of the UE may be optionally returned in a format specified in TS 23.032 [11].\nIt shall be possible for the majority of the UE (active or idle) within a network to use the feature without compromising the radio transmission or signalling capabilities of the GSM/UMTS/EPS networks.\nThe UE and the network may support a number of different positioning methods and the UE may support or not support privacy invocation request and response. The UE informs the core network and radio access network about its LCS capabilities in this respect as defined in TS 24.008 [24] and TS 25.331 [25].\nThe uncertainty of the location measurement shall be network design (implementation) dependent at the choice of the network operator, this is further described in TS 25.305 [1], TS 36.305 [42], and TS 43.059 [16].\nThere are many different possible uses for the location information. The positioning feature may be used internally by the GSM/UMTS/EPS network (or attached networks), by value-added network services, by the UE itself or through the network, and by \"third party\" services. The positioning feature may also be used by an emergency service (which may be mandated or \"value-added\"), but the position service is not exclusively for emergencies.\nThere are regulatory requirements to support anonymity in location services in some countries.",
      "chunk_type": "general",
      "cross_references": [
        "ts_22.071",
        "ts_23.032",
        "ts_24.008",
        "ts_25.331",
        "ts_25.305",
        "ts_36.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_4.1",
      "section_id": "4.1",
      "section_title": "Assumptions",
      "content": "As a basis for the further development work on LCS in GSM, UMTS and EPS the following assumptions apply:\n-\tpositioning methods are Access Network specific, although commonalties should be encouraged between Access Networks;\n-\tcommercial location services are only applicable for an UE with a valid SIM or USIM;\n-\tthe provision of the location services in the Access Network is optional through support of the specified method(s);\n-\tthe provision of location services is optional in MSC, SGSN and MME;\n-\tLCS is applicable to any target UE whether or not the UE supports LCS, but with restrictions on choice of positioning method or notification of a location request to the UE user when LCS or individual positioning methods, respectively, are not supported by the UE;\n-\tLCS shall be applicable for both circuit switched and packet switched services;\n-\tthe location information may be used for internal system operations to improve system performance;\n-\tit shall be possible to accommodate future techniques of measurement and processing to take advantage of advancing technology so as to meet new service requirements;\n-\tit may be necessary to support LCS signalling between separate access networks via the core network. For UMTS, the Iur interface should be used if available;\n-\tProvide positioning procedures through the circuit-switched domain are also applicable to GPRS UEs which are GPRS and IMSI attached;\n-\tit shall be possible for more than one LCS Client to request and obtain the location of the same target UE at the same time.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_4.2",
      "section_id": "4.2",
      "section_title": "Location Services Categories",
      "content": "Generally there are four categories of usage of the location service. These are the Commercial LCS, the Internal LCS, the Emergency LCS and the Lawful Intercept LCS. The definition of these services and their categories is outside the scope of the present document.\n-\tThe Commercial LCS (or Value Added Services) will typically be associated with an application that provides a value-added service to the subscriber of the service, through knowledge of the UE location (and optionally, velocity) and if available, and at the operator's discretion, the positioning method used to obtain the location estimate. This may be, for example, a directory of restaurants in the local area of the UE, together with directions for reaching them from the current UE location.\n-\tThe Internal LCS will typically be developed to make use of the location information of the UE for Access Network internal operations. This may include; for example, location assisted handover and traffic and coverage measurement. This may also include support certain O&M related tasks, supplementary services, IN related services and GSM bearer services and teleservices.\n-\tThe Emergency LCS will typically be part of a service provided to assist subscribers who place emergency calls. In this service, the location of the UE caller and, if available, the positioning method used to obtain the location estimate is provided to the emergency service provider to assist them in their response. This service may be mandatory in some jurisdictions. In the United States, for example, this service is mandated for all mobile voice subscribers.\n-\tThe Lawful Intercept LCS will use the location information to support various legally required or sanctioned services.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_4.3",
      "section_id": "4.3",
      "section_title": "Positioning methods",
      "content": "The LCS feature utilises one or more positioning methods in order to determine the location of user equipment (UE). Determining the position of a UE involves two main steps:\n-\tRadio signal measurements; and\n-\tPosition estimate computation based on the measurements.\nThe positioning methods for UTRAN are further described in TS 25.305 [1].",
      "chunk_type": "general",
      "cross_references": [
        "ts_25.305"
      ]
    },
    {
      "chunk_id": "ts_23.271_4.3.1",
      "section_id": "4.3.1",
      "section_title": "Standard LCS Methods in UTRAN",
      "content": "The specification TS 25.305 [1] UTRAN Stage 2 specifies the locating methods to be supported:\n-\tcell coverage based positioning method;\n-\tOTDOA positioning method;\n-\tA-GNSS based positioning methods;\n-\tUTDOA positioning method;\n-\tBarometric pressure sensor method;\n-\tWLAN method;\n-\tBluetooth method;\n-\tTerrestrial Beacon System method.\nFor more details on these positioning methods, refer to TS 25.305 [1].",
      "chunk_type": "general",
      "cross_references": [
        "ts_25.305"
      ]
    },
    {
      "chunk_id": "ts_23.271_4.3.2",
      "section_id": "4.3.2",
      "section_title": "Standard LCS Methods in GERAN",
      "content": "The specification TS 43.059 [16] GERAN LCS Stage 2 specifies the locating methods to be supported in GERAN:\n-\tcell coverage based positioning method;\n-\tEnhanced Observed Time Difference (E-OTD) positioning method;\n-\tA-GNSS based positioning methods;\n-\tUplink Time Difference of Arrival (UTDOA) positioning method.",
      "chunk_type": "general",
      "cross_references": [
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_4.3.3",
      "section_id": "4.3.3",
      "section_title": "Standard LCS Methods in E-UTRAN",
      "content": "Locating methods specified in TS 36.305 [42] applicable to E-UTRAN comprise:\n-\tuplink and downlink cell coverage based positioning methods;\n-\tOTDOA positioning method;\n-\tA-GNSS based positioning methods;\n-\tUTDOA positioning method;\n-\tBarometric pressure sensor method;\n-\tWLAN method;\n-\tBluetooth method;\n-\tTerrestrial Beacon System methods.\nHybrid positioning using multiple methods from the list of positioning methods above is also supported.\nIn case of the Home eNodeB, applicable locating methods may be restricted, e.g. when a Home eNodeB is connected via Home eNodeB GW.",
      "chunk_type": "general",
      "cross_references": [
        "ts_36.305"
      ]
    },
    {
      "chunk_id": "ts_23.271_4.4.1",
      "section_id": "4.4.1",
      "section_title": "Immediate Location Request",
      "content": "Request for location where the LCS Server replies immediately to the LCS Client with the current location estimate if this could be obtained.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_4.4.2",
      "section_id": "4.4.2",
      "section_title": "Deferred Location Request",
      "content": "Request for location contingent on some current or future events where the response from the LCS Server to the LCS Client may occur some time after the request was sent.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_4.4.2.1",
      "section_id": "4.4.2.1",
      "section_title": "Types of event",
      "content": "a)\tUE available: Any event in which the MSC/SGSN/MME has established a contact with the UE. Note, this event is considered to be applicable when the UE is temporarily unavailable due to inaction by the user, temporarily loss of radio connectivity or IMSI detach and so on. Note that IMSI detach is only applicable in the case the UE has previously been registered and information is still kept in the node. The UE Available event only requires one response and after this response, the UE Available event is concluded.\nb)\tChange of Area: An event where the UE enters or leaves a pre-defined geographical area or if the UE is currently within the pre-defined geographical area. Only one type of area event may be defined (i.e. entering, leaving or remaining within the area). The LCS client defines the target area as a geographical area, as an E.164 country code for a geographic area [35a], as a PLMN identity or as a geopolitical name of the area. The LCS server may translate and define the target area as the identities of one or more radio cells, location areas, routing areas, tracking areas, country code or PLMN identity. The target UE must not give the target UE user access to the area definitions and network identities. The change of area event may be reported one time only, or several times. The area event report must not be repeated more often than allowed by the LCS client. The change of area event report shall contain an indication of the event occurrence. The location estimate may be included in the report. If an area event is detected by the UE but an event report cannot be sent (e.g. because the UE cannot access the network or due to a minimum reporting interval), a report shall be sent later when possible irrespective of whether the area event still applies for the current UE location. For E-UTRAN access, area event reporting is controlled by a minimum and a maximum reporting time. The minimum reporting time defines the minimum allowed time between successive area events. The maximum reporting time defines the maximum time between successive reports. When a UE sends a report due to expiration of the maximum reporting time, the UE indicates expiration of the maximum reporting time as the trigger event. The maximum reporting time enables the LCS client, R-GMLC and H-GMLC to remain aware of continuing support by the UE for the area event (e.g. to detect if area event reporting may have been aborted due to UE power off).\nc)\tPeriodic Location: An event where a defined periodic timer expires in the UE and activates a location report or a location request. If a periodic event is detected by the UE but an event report cannot be sent (e.g. because the UE cannot access the network temporarily), a report shall be sent later when possible and the periodic timer for the next event shall then be started. The reporting duration for periodic location shall equal the requested number of reports multiplied by the periodic interval even when reports are delayed.\nd)\tMotion: An event where the UE moves by more than some predefined linear distance from a previous location. The motion event may be reported one time only, or several times. The motion event report shall contain an indication of the event occurrence. A location estimate may be included in the report if requested by the LCS client. For successive motion event reports, motion is determined relative to the UE location corresponding to the immediately preceding event report (including an event report triggered by expiration of the maximum reporting time). If a motion event is detected by the UE but an event report is deferred (e.g. because the UE cannot access the network temporarily), a report shall be sent later when possible irrespective of whether the motion event still applies to the current UE location. Motion reporting is controlled by a minimum and a maximum reporting time. The minimum reporting time defines the minimum allowed time between successive event reports. The maximum reporting time defines the maximum time between successive reports. When a UE sends a report due to expiration of the maximum reporting time, the UE indicates expiration of the maximum reporting time as the trigger event. The maximum reporting time enables the LCS client, R-GMLC and H-GMLC to remain aware of continuing support by the UE for the motion event (e.g. to detect if motion event reporting may have been aborted due to UE power off).\ne)\tOther events are FFS.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_4.5",
      "section_id": "4.5",
      "section_title": "Concurrent Location Requests",
      "content": "The LCS Server is enabled to support concurrent location requests for the same target UE. The following principles apply.\n1.\tUnder certain conditions, an entity may combine concurrent location requests by fully executing one request and using the ensuing location estimate result(s) to satisfy the other request(s) without fully executing the latter and as allowed by QoS requirements. The allowed conditions for each type of entity are defined below:\na)\tAn R‑GMLC may combine concurrent MT‑LR requests for the same target UE‑LCS Client pair.\nb)\tAn H‑GMLC may combine concurrent MT‑LR requests for the same target UE if privacy requirements can be fully resolved by the H‑GMLC (e.g. no notification or verification needed for the UE for any MT‑LR that will not be fully executed).\nc)\tA V‑GMLC may combine concurrent MT‑LR and NI‑LR related location requests for the same target UE provided it is clear and unambiguous for any MT‑LR that will not be fully executed (e.g. from the contents of any MAP Provide Subscriber Location request received from the H‑GMLC) that no outstanding privacy related actions are required for the UE (e.g. no privacy notification and/or privacy verification interaction with the UE and no privacy subscription verification in the VLR, SGSN or MME).\nd)\tAn MSC, MSC server, SGSN or MME may combine concurrent MT‑LR, MO‑LR and NI‑LR location requests once any needed privacy related actions (e.g. UE notification and verification) have been performed for each MT‑LR.\ne)\tA UE may combine concurrent MO‑LR requests for LCS Clients internal to or associated with the UE.\n2.\tExcept under the conditions permitted in (1), different concurrent location requests shall be treated separately and shall not be visibly combined or made dependent on one another by any entity within the LCS Server. This means that the procedures defined here in clause 9 continue to apply to each separate location request and do not visibly impact one another.\n3.\tImplementation limitations are allowed whereby an entity that, either itself or in association with another entity, cannot support concurrent location requests or more than a certain number of concurrent location requests is allowed to reject or defer a new concurrent request or cancel one or more existing requests. When concurrent location requests are supported, each entity needs to ensure it correlates each location/position response with the associated request.\n4.\tIn support of principles 1, 2 and 3, an entity (e.g. GMLC, MSC, MSC server, SGSN, MME, UE) that receives a new location request (e.g. MT‑LR, MO‑LR, NI‑LR) while already supporting previous location requests for the same target UE may reject the new location request, defer (i.e. queue) the new request, cancel one or more previous requests (where a procedure for cancellation has been defined), allow the new location request to proceed concurrently with and separately from the previous requests if allowed on applicable interfaces or, for the specific cases defined in principle 1, combine the new request with one or more previous requests if this will not impair or affect service support for the new request (e.g. privacy and QoS).\n5.\tIn support of principle 4, LCS Client priority and any other relevant priority information (e.g. UE subscription preferences) should be considered. In particular, location requests associated with emergency services or lawful interception clients should be given priority over other location requests.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.1",
      "section_id": "5.1",
      "section_title": "LCS access interfaces",
      "content": "One or more LCS Clients may access a Location Server via its Le interface. Location Servers, resident in the same or different PLMNs, may communicate with each other, indirectly, via the Lg interface to their associated MSC/SGSNs. Optionally, the Lr interface, as specified for direct GMLC to GMLC messaging, may be used for this purpose. For EPS, Location Servers, resident in the same PLMN, may communicate via the SLg interface to their associated MME. A fuller description of the LCS architecture, together with a diagram showing other LCS related interfaces, can be found in clause 6.\nFigure 5.1: LCS Access Interfaces and Reference Points",
      "chunk_type": "general",
      "cross_references": [
        "clause_6",
        "figure_5.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.2",
      "section_id": "5.2",
      "section_title": "LCS Functional diagram, high level functions",
      "content": "TS 22.071 [4] describes LCS services from the LCS client point of view. In the present document, a more detailed description of LCS is given. The LCS functional diagram shown in figure 5.2 depicts the interaction of the LCS client and the LCS server within the PLMN. The PLMN uses the various LCS components within the LCS server to provide the target UE Location Information to the LCS client.\nFigure 5.2: LCS capability server Functional Diagram\nThe following list gives the logical functional entities for the LCS. Two main functional groupings are defined which encompass a number of smaller functions.\nThe LCS Functional entities are grouped as follows:\n-\tthe LCS Client functional group;\n-\tthe LCS Server functional group consists of functions in the GSM, UMTS or EPS PLMN supporting LCS:\n-\tclient handling component;\n-\tsystem handling component;\n-\tsubscriber handling component;\n-\tpositioning component.\nThe functions of the LCS Client and the LCS Server in the PLMN are described in more detail in this clause.\nThe allocation of LCS functions to network elements is specified in clause 6.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6",
        "figure_5.2",
        "ts_22.071"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.3",
      "section_id": "5.3",
      "section_title": "LCS Client functional group",
      "content": "An LCS client contains an LCS component with one or more client(s), which by using location information can provide location, based services.\nAn LCS client is a logical functional entity that requests from the LCS server in the PLMN location information for one or more than one target UE within a specified set of parameters such as Quality of Service (QoS). The LCS Client may reside in an entity (including the UE) within the PLMN or in an entity external to the PLMN.\nThe specification of the LCS Client's internal logic and its relation to the external use is outside the scope of the present document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.3.1",
      "section_id": "5.3.1",
      "section_title": "External Location Client Function (LCF)",
      "content": "The Location Client Function (LCF) provides a logical interface between the LCS client and the LCS server.\nThis function is responsible for requesting location information for one or more UEs, with a specified \"QoS\" and receiving a response, which contains either location information or a failure indicator.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4",
      "section_id": "5.4",
      "section_title": "LCS Server functional group",
      "content": "The LCS server functional group consists of the functions that are needed for GSM, UMTS and EPS to support Location Services.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.1.1",
      "section_id": "5.4.1.1",
      "section_title": "Location Client Control Function (LCCF)",
      "content": "The Location Client Control Function (LCCF) manages the external interface towards LCF. The LCCF identifies the LCS client by requesting client verification and authorization (i.e. verifies that the LCS client is allowed to position the subscriber) through interaction with the Location Client Authorization Function (LCAF). The LCCF handles mobility management for location services (LCS) e.g., forwarding of positioning requests to VMSC, SGSN or MME. The LCCF determines if the final positioning estimate satisfies the QoS for the purpose of retry/reject. The LCCF provides flow control of positioning requests between simultaneous positioning requests. It may order the Location Client Co-ordinate Transformation Function (LCCTF) to perform a transformation to local co-ordinates. It may also order a transformation of local co-ordinates to network identities via the Location System Co-ordinate Transformation Function (LSCTF). It also generates charging and billing related data for LCS via the Location System Billing Function (LSBF).",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.1.2",
      "section_id": "5.4.1.2",
      "section_title": "Location Client Authorization Function (LCAF)",
      "content": "The Location Client Authorization Function (LCAF) is responsible for providing access and subscription authorization to a client. Specifically, it provides authorization to a LCS client requesting access to the network and authorizes the subscription of a client. LCAF provides authorization to a LCS client requesting Location Information of a specific UE.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.1.2.1",
      "section_id": "5.4.1.2.1",
      "section_title": "Access Subfunction",
      "content": "An Access Subfunction enables LCS clients to access LCS services. This subfunction provides verification and authorization of the requesting client.\nWhen a LCS is requested, the Access Subfunction uses the information stored in the LCS client subscription profile to verify that:\n-\tthe LCS client is registered; and\n-\tthe LCS client is authorized to use the specified LCS request type;\n-\tthe LCS client is allowed to request location information for the subscriber(s) specified in the LCS request.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.1.2.2",
      "section_id": "5.4.1.2.2",
      "section_title": "Subscription Subfunction",
      "content": "The LCS client Subscription profile shall contain a minimum set of parameters assigned on per LCS client basis for an agreed contractual period. The LCS client profile shall contain the following set of access parameters:\n-\tLCS client identity;\n-\tallowed LCS request types (i.e. LIR, LDR or both) (see note);\n-\tmaximum number of subscribers allowed in a single LCS request;\n-\tpriority;\n-\tposition override indicator;\n-\tstate(s);\n-\tevent(s) (applicable to LDR requests only);\n-\tlocal coordinate system;\n-\tLCS client access barring list (optional);\n-\tPLMN access barring list applicability.\nNOTE:\tLIR = Location Immediate Request; andLDR = Location Deferred Request.\nFor certain authorized LCS client internal to the PLMN, a subscription profile is unnecessary. These clients are empowered to access any defined service that is not barred for an UE subscriber. This permits positioning of emergency calls without the need for pre-subscription.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.1.3",
      "section_id": "5.4.1.3",
      "section_title": "Location Client Co-ordinate Transformation Function (LCCTF)",
      "content": "The Location Client Co-ordinate Transformation Function (LCCTF) provides conversion of a location estimate expressed according to a universal latitude and longitude system into an estimate expressed according to a local geographic system understood by the LCF and known as location information. The local system required for a particular LCF will be either known from subscription information or explicitly indicated by the LCF. The LCCTF also provides the conversion of a target area to either a shape as defined in TS 23.032 [11], a PLMN, or country code. This is performed only if target area information is received from the LCS Client.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.032"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.4.1.4",
      "section_id": "5.4.1.4",
      "section_title": "Location Client Zone Transformation Function (LCZTF)",
      "content": "The Location Client Zone Transformation Function (LCZTF) performs transformations of a location (latitude and longitude) into a zone identity, which in North America identifies a particular emergency services zone.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.2.1",
      "section_id": "5.4.2.1",
      "section_title": "Location System Control Function(LSCF)",
      "content": "The Location System Control Function (LSCF) is responsible for co-ordinating location requests. This function manages call-related and non-call-related positioning requests of LCS and allocates network resources for handling them. The LSCF retrieves UE classmark information for the purpose of determining the LCS capabilities of UE.\nThe LSCF performs call setup if required as part of a LCS e.g., putting the UE on dedicated radio resources. It also caters for co-ordinating resources and activities with regard to requests related to providing assistance data needed for positioning. This function interfaces with the LCCF, LSPF, LSBF and PRCF. Using these interfaces, it conveys positioning requests to the PRCF, relays positioning data to the LCCF and passes charging related data to the LSBF.\nThe U-LSCF for UTRAN is further described in TS 25.305 [1], LSCF for GERAN is described in TS 43.059 [16].",
      "chunk_type": "general",
      "cross_references": [
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.4.2.2",
      "section_id": "5.4.2.2",
      "section_title": "Location System Billing Function (LSBF)",
      "content": "The Location System Billing Function (LSBF) is responsible for charging and billing activity within the network related to location services (LCS). This includes charging and billing of both clients and subscribers. Specifically, it collects charging related data and data for accounting between PLMNs.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.2.3",
      "section_id": "5.4.2.3",
      "section_title": "Location System Operations Function (LSOF)",
      "content": "The Location System Operations Function (LSOF) is responsible for provisioning of data, positioning capabilities, data related to clients and subscription (LCS client data and UE data), validation, fault management and performance management of LCS.\nAn LSOF may be associated with each entity.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.2.4",
      "section_id": "5.4.2.4",
      "section_title": "Location System Broadcast Function (LSBcF)",
      "content": "The Location System Broadcast Function (LSBcF) provides broadcast capability. The LSBcF capability is only used when broadcast data is required for E-OTD, OTDOA or A-GNSS positioning methods.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.2.5",
      "section_id": "5.4.2.5",
      "section_title": "Location System Co-ordinate Transformation Function (LSCTF)",
      "content": "The Location System Co-ordinate Transformation Function (LSCTF) provides the conversion of an area definition, expressed in a geographic shape as defined in TS 23.032 [11], to network identities recognised only within a PLMN (such as Cell Identity, Location Area Identity). The area definition may convert to more than one network identity such as a collection of Cell Global Identities.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.032"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.4.2.6",
      "section_id": "5.4.2.6",
      "section_title": "Location IMS – Interworking Function (LIMS-IWF)",
      "content": "The Location IMS – Interworking Function (LIMS-IWF) in the requesting network provides the capability to route LCS service requests based on an IMS Public User Identity (SIP-URI) to the home network of the target user. The LIMS-IWF in the home network of the target user is responsible to determine the appropriate HSS and to obtain the MSISDN associated with a IMS Public User Identity from the HSS.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.3.1",
      "section_id": "5.4.3.1",
      "section_title": "Location Subscriber Authorization Function (LSAF)",
      "content": "The Location Subscriber Authorization Function (LSAF) is responsible for authorizing the provision of a location service (LCS) for a particular mobile station (UE with SIM/USIM). Specifically, this function validates that a LCS can be applied to a given subscriber. In case LCF is in the UE then LSAF verifies that the UE subscriber has subscribed to the requested LCS service. LSAF also detects if the identity used to address the target UE is a pseudonym. If the identity used is detected as a pseudonym, the LSAF can then call the Location Subscriber Translation Function to perform the translation to verinym.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.3.2",
      "section_id": "5.4.3.2",
      "section_title": "Location Subscriber Translation Function (LSTF)",
      "content": "The Location Subscriber Translation Function (LSTF) is responsible for the mapping between pseudonyms and verinyms of the target UE.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.3.3",
      "section_id": "5.4.3.3",
      "section_title": "Location Subscriber Privacy Function (LSPF)",
      "content": "The Location Subscriber Privacy function is responsible performs all privacy related authorizations. For a target UE it shall authorize the positioning request versus the privacy options of the target UE, if any.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.4.4",
      "section_id": "5.4.4",
      "section_title": "Positioning components",
      "content": "The positioning components Positioning Radio Co-ordination Function (PRCF), Positioning Calculation Function (PCF), Positioning Signal Measurement Function (PSMF) and Positioning Radio Resource Management (PRRM) are described in documents specific to each Access Network type.\nFor location services for GSM and UMTS, the Access Network shall send the result of the positioning to the core network in geographical co-ordinates as defined in TS 23.032 [11]. For location services for EPS (for E-UTRAN access), the E-SMLC shall determine the result of the positioning in geographical co-ordinates as defined in TS 23.032 [11]. If requested and if available, the positioning result may also include the velocity of the UE as defined in TS 23.032 [11]. The Access Network or E-SMLC shall map the cell(s) the Target UE is associated with into geographical co-ordinates, but this mapping is not standardized.\nThese entities are defined in TS 36.305 [42] for E-UTRAN, TS 25.305 [1] for UTRAN and in TS 43.059 [16] for GERAN.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.032",
        "ts_36.305",
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.5",
      "section_id": "5.5",
      "section_title": "Information Flows between Client and Server",
      "content": "Other types of national specific information flows may be supported in addition to the information flow specified here.\nAny of the information flows here indicated may not be externally realized if the information does not flow over an open interface.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_5.5.1",
      "section_id": "5.5.1",
      "section_title": "Location Service Request",
      "content": "Via the Location Service Request, the LCS client communicates with the LCS server to request for the location information of one or more than one UE within a specified quality of service. There exist two types of location service requests:\n-\tLocation Immediate Request (LIR); and\n-\tLocation Deferred Request (LDR).\nThe attributes for the information exchange between the LCS Client and the LCS Server have been standardized by OMA in MLP [31].\nThe following attributes are identified for Location Service Request information flow:\n-\tTarget UE identity (either verinym or pseudonym);\n-\tLCS Client identity;\n-\tService identity, if needed;\n-\tResponse method (SYNC or ASYNC), if needed;\n-\tCodeword, if needed;\n-\tRequestor identity, if needed (and type of Requestor identity if available);\n-\tNumber dialled by the target mobile user or APN-NI, if the request is call or session related;\n-\tType of Event definition, i.e. UE available, change of area, motion or periodic location, applicable to deferred location requests only;\n-\tDefinitions for change of area type deferred location requests. Following parameters may be defined, if needed;\na)\tIndication for event trigger, i.e. UE enters, leaves or is within requested target area;\nb)\tIndication of either a single event report or multiple event reports;\nc)\tMinimum time interval between area event reports, if multiple event reports are requested;\nd)\tIndication of the requested location estimate; i.e. whether the location estimate of the target UE should be contained in the change of area event report;\ne)\tDuration of event reporting;\nf)\tFor EPC access, the maximum time interval between reports;\ng)\tFor EPC access, the maximum sampling time for event detection;\n-\tDefinitions for motion type deferred location requests. Following parameters may be defined, if needed;\na)\tLinear distance threshold;\nb)\tIndication of either a single event report or multiple event reports;\nc)\tMinimum time interval between motion event reports, if multiple event reports are requested;\nd)\tIndication of the requested location estimate; i.e. whether the location estimate of the target UE should be contained in the motion event report;\ne)\tDuration of event reporting;\ne)\tMaximum time interval between reports;\nf)\tMaximum sampling time for event detection;\n-\tDefinitions for periodic location type deferred location requests. Following parameters may be defined, if needed:\na)\tTime interval between successive location reports;\nb)\tTotal number of reports;\n-\tStart time, stop time (i.e. specifying the validity time of LCS request), if needed;\n-\tInterval, applicable to periodical requests only;\n-\tRequested Quality of Service information, if needed, i.e. accuracy, response time and LCS QoS Class;\n-\tRequested type of location, i.e. \"current location\", \"current or last known location\" or \"initial location\" applicable to LIR only (current location is only available for LDR);\n-\tVelocity of the UE, if needed;\n-\tPriority, if needed;\n-\tService coverage (i.e. E.164 country codes for geographic areas [35a]), if needed;\n-\tRequested maximum age of location, if needed;\n-\tLocal coordinate reference system, if needed;\n-\tTarget area, i.e. geographical area expressed as one of the following format, if needed.\na)\ta shape defined in TS 23.032 [11]\nb)\tlocal coordinate system\nc)\tE.164 country code for a geographic area [35a]\nd)\tPLMN identity\ne)\tgeopolitical name of the area (e.g. London)\nSome of the information may be stored in GMLC and the LCS client does not need to include such information in the location service request.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.032"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.5.2",
      "section_id": "5.5.2",
      "section_title": "Location Service Response",
      "content": "The LCS server (GMLC) sends the Location Service Response to the LCS client either as an:\n-\tImmediate Response; or a\n-\tDeferred Response, these deferred responses can be either single or periodic.\nThe following attributes are identified for the Location Service Response information flow:\n-\tLocation indication of UE in geographical coordinates expressed as a shape as defined in TS 23.032 [11] or local coordinate system;\n-\tVelocity of the UE as defined in TS 23.032 [11], if requested and if available;\n-\tThe information about the positioning method used to obtain the location estimate of the UE, if it is available at the LCS server and if needed;\n-\tTime stamp of location estimate;\n-\tIndication when UE enters, is within or leaves the Geographical area, if needed;\n-\tAcknowledgement for a deferred location request, if needed.\n-\tRequest id, if needed.\n-\tLDR reference number, if needed.\n-\tIndication that the requested QoS was not met, if needed, only applicable if the request was for best effort class\n-\tIndication of a periodic event.\n-\tIndication of a motion event.\n-\tIndication that a deferred location request has been activated in a UE.\n-\tIndication of expiration of the maximum reporting interval for the area event or motion event.\nIn addition the information attributes of the location service request may be used also in the location service response.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.032"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.6",
      "section_id": "5.6",
      "section_title": "Information Flows between LCS Servers",
      "content": "Other types of national specific information flows may be supported in addition to the information flow specified here.\nAny of the information flows here indicated may not be externally realized if the information does not flow over an open interface.\nWhen the LCS server's associated GMLC uses the Lr interface then this interface shall conform to the procedures defined in clause 9 of the current specification.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.6.1",
      "section_id": "5.6.1",
      "section_title": "Location Service Request",
      "content": "Via the Location Service Request, the source LCS server communicates with the destination LCS server to request for the location information of one UE within a specified quality of service. There exist two types of location service requests:\n-\tLocation Immediate Request (LIR); and\n-\tLocation Deferred Request (LDR).\nThe attributes for the information exchange between the LCS Servers have been standardized by OMA in RLP [36].\nThe following attributes are identified for Location Service Request information flow:\n-\tTarget UE identity, (either one or both of MSISDN and IMSI, or SIP-URI, or pseudonym);\n-\tLCS Client identity, i.e. LCS client external identity or internal identity;\n-\tLCS Client type, (i.e. Value added, Emergency, PLMN operator or Lawful interception);\n-\tLCS Client name, if needed (and type of LCS client name if available);\n-\tService type, if needed;\n-\tResponse method (SYNC or ASYNC), if needed;\n-\tCodeword, if needed;\n-\tRequestor identity, if needed (and type of Requestor identity if available);\n-\tNumber dialled by the target mobile user or APN-NI, if the request is call or session related;\n-\tType of Event definition, i.e. UE available, change of area, motion or periodic location, applicable to deferred location requests only;\n-\tDefinitions for change of area type deferred location requests. Following parameters may be defined, if needed;\na)\tIndication for event trigger, i.e. UE enters, leaves or is within requested target area;\nb)\tIndication of either a single event report or multiple event reports;\nc)\tMinimum time interval between area event reports;\nd)\tStart time, stop time, i.e. specifying the validity time of LCS area event request;\ne)\tIndication of the requested location estimate; i.e. whether the location estimate of the target UE should be contained in the change of area event report;\nf)\tDuration of event reporting;\ng)\tFor EPC access, the maximum time interval between reports;\nh)\tFor EPC access, the maximum sampling time for event detection;\n-\tDefinitions for periodic location type deferred location requests. Following parameters may be defined, if needed:\na)\tTime interval between successive location reports;\nb)\tTotal number of reports;\nc)\tIndication of whether MO-LR Short Circuit is permitted (not applicable to EPC access);\nd)\tReporting PLMN list;\n-\tDefinitions for motion type deferred location requests. Following parameters may be defined, if needed;\na)\tLinear distance threshold;\nb)\tIndication of either a single event report or multiple event reports;\nc)\tMinimum time interval between motion event reports, if multiple event reports are requested;\nd)\tIndication of the requested location estimate; i.e. whether the location estimate of the target UE should be contained in the motion event report;\ne)\tDuration of event reporting;\ne)\tMaximum time interval between reports;\nf)\tMaximum sampling time for event detection;\n-\tRequested Quality of Service information, if needed, i.e. accuracy, response time and LCS QoS Class;\n-\tRequested type of location, i.e. \"current location\", \"current or last known location\" or \"initial location\" applicable to LIR only (current location is only available for LDR);\n-\tVelocity of the UE, if needed;\n-\tPriority, if needed;\n-\tRequested maximum age of location, if needed;\n-\tPrivacy override indicator, if needed;\n-\tService coverage (i.e. E.164 country codes for geographic areas [35a]), if needed;\n-\tIndicator of privacy check related actions, if needed;\n-\tSupported GAD shapes, if needed;\n-\tHPLMN LCS server address, i.e. H-GMLC address, if needed;\n-\tVPLMN LCS server address, i.e. V-GMLC address, if needed;\n-\tNetwork address of Privacy Profile Register, if needed;\n-\tNetwork numbers of serving nodes;\n-\tLCS capability sets of serving nodes, if needed.\n-\tTarget area, i.e. geographical area expressed as one of the following format, if needed.\na)\ta shape defined in TS 23.032 [11]\nb)\tE.164 country code for a geographic area [35a]\nc)\tPLMN identity\n-\tLDR reference number, if needed.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.032"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.6.2",
      "section_id": "5.6.2",
      "section_title": "Location Service Response",
      "content": "The Location Service Response is sent to the source LCS server as the result of the Location Service Request by the destination LCS Server:\n-\tImmediate Response; or a\n-\tDeferred Response, these deferred responses can be either single or periodic.\nThe following attributes are identified for the Location Service Response information flow:\n-\tLocation indication of UE in geographical coordinates expressed as a shape as defined in TS 23.032 [11];\n-\tVelocity of the UE as defined in TS 23.032 [11], if requested and if available;\n-\tIndication when UE enters, is within or leaves the geographical area, if needed;\n-\tThe information about the positioning method used to obtain the location estimate of the UE, if it is available at the LCS server and needed;\n-\tAge of location estimate;\n-\tAcknowledgement for a deferred location request, if needed.\n-\tRequest id, if needed\n-\tIndication that the requested QoS was not met, if needed, only applicable if the request was for best effort QoS class\n-\tIndication of a periodic event.\n-\tIndication of a motion event.\n-\tIndication that a deferred location request has been activated in a UE.\n-\tIndication of expiration of the maximum reporting interval for the area event or motion event.\nIn addition the information attributes of the location service request may be used also in the location service response.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.032"
      ]
    },
    {
      "chunk_id": "ts_23.271_5.7",
      "section_id": "5.7",
      "section_title": "Optimized Lgd Procedure",
      "content": "Optimized Lgd is an optional feature, applicable when Lgd is used, which allows signalling savings for when the GMLC needs the location information from the UE served by a combined MME/SGSN. It requires support from the following network elements:\n-\tCombined MME / SGSN when both MME and SGSN parts of the combined MME / SGSN are serving the UE.\n-\tHSS.\n-\tGMLC.\nA combined MME/SGSN supporting this feature shall indicate its support to the HSS via 'Optimized Lgd' indicator during Update Location Request procedures when network supports ISR, as specified in TS 29.272 [51].\nAn HSS supporting this feature shall indicate its support to the GMLC via 'Optimized Lgd' indicator in response to Send Routing Info for LCS request if the combined MME/SGSN registered for the given UE has indicated support for this procedure as specified in TS 29.173 [45]. Upon receipt of 'Optimized Lgd' indicator from the HSS, and if the GMLC supports this feature, then the GMLC shall consider this feature as activated for a given LCS Service Request procedure.\nOnce the GMLC receives \"Optimized Lgd\" indicator from the HSS indicating support for this feature, and the GMLC has received both MME and SGSN addresses from the HSS, and the GMLC has determined to execute either PS-MT-LR or EPS-MT-LR procedures, and the GMLC has determined to not execute deferred location procedures, then the GMLC shall send only a single Provide Subscriber Location request to the combined MME/SGSN. When the combined MME/SGSN receives a single Provide Subscriber Location request, it shall perform either EPC-MT-LR or PS-MT-LR procedure depending upon the knowledge of the current RAT type of the UE. e.g. if the UE is in connected mode in E-UTRAN, the combined MME/SGSN performs only EPC-MT-LR procedure; if the ISR activated UE is in idle mode, the combined MME/SGSN performs the paging procedure followed by either EPC-MT-LR or PS-MT-LR procedure (depending upon the RAT where the UE is active).",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_29.272",
        "ts_29.173"
      ]
    },
    {
      "chunk_id": "ts_23.271_6.0",
      "section_id": "6.0",
      "section_title": "Introduction",
      "content": "Figure 6.1 shows the general arrangement of the Location Service feature in GSM, UMTS and EPS. This illustrates, generally, the relation of LCS Clients and servers in the core network with the GERAN, UTRAN and E‑UTRAN Access Networks. The LCS entities within the Access Network communicate with the Core Network (CN) across the A, Gb, Iu and S1 interfaces. Communication among the Access Network LCS entities makes use of the messaging and signalling capabilities of the Access Network.\nAs part of their service or operation, the LCS Clients may request the location information of UE. There may be more than one LCS client. These may be associated with the GSM/UMTS/EPS networks or the Access Networks operated as part of a UE application or accessed by the UE through its access to an application (e.g. through the Internet).\nThe clients make their requests to a LCS Server. There may be more than one LCS Server. The client must be authenticated and the resources of the network must be co-ordinated including the UE and the calculation functions, to estimate the location and optionally, velocity of the UE and result returned to the client. As part of this process, information from other systems (other Access Networks) can be used. As part of the location information returned to the client, an estimate of the accuracy of the estimate and the time-of-day the measurement was made may be provided.\nNOTE 1:\tHSS includes both 2G-HLR and 3G-HLR functionality. LCS is included in the overall network architecture in TS 23.002 [20].\nNOTE 2:\tAs one alternative the LCS client may get location information directly from GMLC, which may contain OSA Mobility SCS with support for the OSA user location interfaces. See TS 23.127 [26], TS 29.198‑1 [27], TS 29.198‑2 [28], TS 29.198‑3 [29] and TS 29.198‑6 [30].\nNOTE 3:\tThe PPR functionality may be integrated in GMLC\nNOTE 4:\tThe PMD functionality may be integrated in GMLC or PPR.\nNOTE 5:\tThe LIMS-IWF may optionally be located within the GMLC.\nNOTE 6:\tLRF may interact with a separate GMLC or contain an integrated GMLC.\nNOTE 7:\tthe SLP, which may be an H-SLP, V-SLP or E-SLP, may optionally be associated with an E-SMLC in order to share assistance data for support of both control plane LCS and OMA SUPL for an operator who deploys both solutions. Interaction between the E-SMLC and SLP is outside the scope of this TS.\nNOTE 8:\tThe E-UTRAN may also comprise an LMU as noted in TS 36.300 [50] which interacts with an E-SMLC via the SLm interface. This LMU may be standalone or integrated into an eNodeB, as noted in TS 36.305 [42].\nNOTE 9:\tInterface between SGSN and GMLC when MAP-based is referred to as Lg and when Diameter-based is referred to as Lgd.\nFigure 6.1-1: General arrangement of LCS\nFigure 6.1-1a shows the general arrangement of the Location Service feature in I‑WLAN. This illustrates, generally, the relation of LCS Clients and servers in the core network with the WLAN Access Networks defined in TS 23.234 [52].\nNOTE 1:\tThe support of location services for the I-WLAN architecture is no longer maintained.\nNOTE 1:\tThe shaded area refers to WLAN 3GPP IP Access functionality.\nNOTE 2:\tThe LCS La interface is added to support LCS for I‑WLAN\nNOTE 3:\tThe GMLC can have the SLP functionality or GMLC can be connected to the SLP.\nNOTE 4:\tFor I-WLAN emergency location determination, the Ml interface between E-CSCF and LRF will be used.  For roaming scenario, the Lr will be used.\nFigure 6.1-1a: General arrangement of LCS for I-WLAN defined in TS 23.234 [52]\nNOTE 1:\tLRF may interact with a separate GMLC or contain an integrated GMLC.\nNOTE 2:\tthe SLP, which may be an H-SLP, V-SLP or E-SLP, may optionally be associated with an E-SMLC in order to share assistance data for support of both control plane LCS and OMA SUPL for an operator who deploys both solutions. Interaction between the E-SMLC and SLP is outside the scope of this TS.\nNOTE 3:\tThe E-UTRAN may also comprise an LMU as noted in TS 36.300 [50] which interacts with an E-SMLC via the SLm interface. This LMU may be standalone or integrated into an eNodeB, as noted in TS 36.305 [42].\nNOTE 4:\tInterface between SGSN and GMLC when MAP-based is referred to as Lg and when Diameter-based is referred to as Lgd.\nFigure 6.1-2: General arrangement of LCS with inter-GMLC and LIMS-IWF [Lr] interface\nNOTE 2:\tFor the scope of supporting location retrieval for IMS Emergency Service for WLAN access to EPC see TS 23.167 [36a].",
      "chunk_type": "general",
      "cross_references": [
        "figure_6.1",
        "figure_6.1-1",
        "figure_6.1-2",
        "ts_23.002",
        "ts_23.127",
        "ts_29.198",
        "ts_36.300",
        "ts_36.305",
        "ts_23.234",
        "ts_23.167"
      ]
    },
    {
      "chunk_id": "ts_23.271_6.1",
      "section_id": "6.1",
      "section_title": "Schematic functional description of LCS operations",
      "content": "The allocation of LCS functional blocks to the Client, LCS server, Core Network, Access Network and UE is based on the schematic functional description below. The detailed functions and interactions are specified later in the present document and in TS 36.305 [42] for E-UTRAN, TS 25.305 [1] for UTRAN, in TS 43.059 [16] for GERAN and in corresponding Stage 3 specifications.\nThe operation begins with a LCS Client requesting location information for a UE from the LCS server. The LCS server will pass the request to the LCS functional entities in the core network. The LCS functional entities in the core network shall then:\n-\tverify that the LCS Client is authorized to request the location of the UE or subscriber;\n-\tverify that LCS is supported by the UE;\n-\testablish whether it is allowed to locate the UE or subscriber, for privacy or other reasons;\n-\testablish which network element in the Access Network for GERAN or UTRAN, or EPC for E‑UTRAN, should receive the Location request;\n-\trequest the Access Network (via the A, Gb or Iu interface) for GERAN or UTRAN, or the E-SMLC (via the SLs interface) for E‑UTRAN, to provide location information for an identified UE, with indicated QoS;\n-\treceive information about the location of the UE from the Access Network or E-SMLC and forward it to the Client;\n-\tsend appropriate accounting information to an accounting function.\nThe Access Network LCS functional entities shall determine the position of the target UE according to TS 36.305 [42] for E-UTRAN, TS 25.305 [1] for UTRAN and TS 43.059 [16] for GERAN.",
      "chunk_type": "general",
      "cross_references": [
        "ts_36.305",
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_6.2",
      "section_id": "6.2",
      "section_title": "Allocation of LCS functions to network elements",
      "content": "Table 6.1 shows a summary of the Functional Groups and Functional Blocks for Location services. Table 6.2 and figure 6.2 show the generic configuration for LCS and the distribution of LCS functional blocks to network elements. Different positioning methods, including network-based, mobile-based, mobile-assisted and network-assisted positioning methods may be used. With this configuration both the network and the mobiles are able to measure the timing of signals and compute the mobile's location estimate. Depending on the applied positioning method it is possible to utilise the corresponding configuration containing all needed entities. For instance, if network-based positioning is applied, the entities that are involved in measuring the mobile's signal and calculating its location estimate are allocated to the network elements of the access stratum. On the other hand, in case mobile-based or network-assisted methods are used these entities should be allocated to the UE.\nLCS is logically implemented on the network structure through the addition of one network node, the Mobile Location Centre (MLC). It is necessary to name a number of new interfaces. The LCS generic architecture can be combined to produce LCS architecture variants.\nTable 6.1: Summary of Functional Groups and Functional Blocks for Location services\nFunct.Group\nFunctional component\nFull name of Functional Block\nAbbrev.\nLoc.\nLocation Client\n(External) Location Client Function\nLCF\nClient\nComponent\nInternal Location Client Function\nLCF\n-internal\nLCS\nClient handling\nLocation Client Control Function\nLCCF\nServer in\ncomponent\nLocation Client Authorization Function\nLCAF\nPLMN\nLocation Client Co-ordinate Transformation Function\nLCCTF\nLocation Client Zone Transformation Function\nLCZTF\nSystem\nLocation System Control Function\nLSCF\nhandling\nLocation System Billing Function\nLSBF\ncomponent\nLocation System Operations Function\nLSOF\nLocation System Broadcast Function\nLSBcF\nLocation System Co-ordinate Transformation Function\nLSCTF\nLocation IMS – Interworking Function\nLIMS-IWF\nSubscriber\nLocation Subscriber Authorization Function\nLSAF\nHandling\nLocation Subscriber Translation Function\nLSTF\ncomponent\nLocation Subscriber Privacy function\nLSPF\nPositioning\nPositioning Radio Control Function\nPRCF\ncomponent\nPositioning Calculation Function\nPCF\nPositioning Signal Measurement Function\nPSMF\nPositioning Radio Resource Management\nPRRM\nTables 6.2 and 6.2a and figure 6.2 illustrate the allocation of functional entities in the reference configuration of LCS. It is assumed that the CS and PS have either their own independent mobility management or use the joint mobility management through the optional Gs interface.\nIt is also seen that LCS may take benefit of the Iur interface between RNCs, when uplink radio information and measurement results are collected.\nThe functional model presented in the figure includes functional entities for both CS and PS related LCS. In addition, it consists of all the entities needed for different positioning methods, i.e. network based, mobile based, mobile assisted, and network assisted positioning, exploiting either uplink or downlink measurements. Similarly, the velocity of a UE may be calculated in either the network or the UE. It is noted that the UE may use e.g. the GPS positioning mechanism, but still demand e.g. auxiliary measurements from the serving network. RAN specific functional entities are specified in TS 36.305 [42] for E‑UTRAN, TS 25.305 [1] for UTRAN and in TS 43.059 [16] for GERAN.\nTable 6.2: Allocation of LCS functional entities to network elements\nUE\nRAN\nGMLC\nSGSN\nMSC/MSC Server\nHLR/HSS\nPPR\nPMD\nClient\nLocation client functions\nLCF\nX\nX\nX\nX\nLCF\nInternal\nX\nClient handling functions\nLCCTF\nX\nLCCF\nX\nLCAF\nX\nLCZTF\nX\nSystem handling functions\nLSCF\nX\nX\nX\nLSBF\nX\nX\nX\nLSOF\nX\nX\nX\nX\nX\nLSBcF\nX\nLSCTF\nX\nLIMS-IWF\nX (Note 1)\nSubscriber handling functions\nLSAF\nX\nX\nX\nX\nLSPF\nX\nX\nX\nX\nX\nLSTF\nX\nPositioning functions\nPRCF\nX\nPCF\nX\nX\nPSMF\nX\nX\nPRRM\nX\nUE\nRAN\nGMLC\nSGSN\nMSC/MSC Server\nHLR/HSS\nPPR\nPMD\nClient\nNOTE 1:\tThe LIMS-IWF may optionally be located within the GMLC. If it is not located within the GMLC, it shall use the Le or Lr reference point to interface to the GMLC.\nNOTE 2:\tThe functional entities shown for the RAN are valid for GSM and UMTS but not EPS.\nTable 6.2a: Allocation of LCS functional entities to EPS elements\nUE\nRAN\nGMLC\nMME\nE-SMLC\nHLR/HSS\nPPR\nPMD\nClient\nLocation client functions\nLCF\nX\nX\nX\nLCF\nInternal\nClient handling functions\nLCCTF\nX\nLCCF\nX\nLCAF\nX\nLCZTF\nX\nSystem handling functions\nLSCF\nX\nLSBF\nX\nX\nLSOF\nX\nX\nX\nX\nX\nLSBcF\nX\nX\nLSCTF\nX\nLIMS-IWF\nX (Note 1)\nSubscriber handling functions\nLSAF\nX\nX\nX\nLSPF\nX\nX\nX\nX\nLSTF\nX\nPositioning functions\nPRCF\nX\nPCF\nX\nX\nPSMF\nX\nX\nPRRM\nX\nUE\nRAN\nGMLC\nMME\nE-SMLC\nHLR/HSS\nPPR\nPMD\nClient\nNOTE 1:\tThe LIMS-IWF may optionally be located within the GMLC. If it is not located within the GMLC, it shall use the Le or Lr reference point to interface to the GMLC.\nNOTE 1:\tThe LIMS-IWF may optionally be located within the GMLC. If it is not located within the GMLC, it shall use the Le or Lr reference point to interface to the GMLC.\nFigure 6.2: Generic LCS Logical Architecture",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1",
        "table_6.2",
        "ts_43.059_table_6.2",
        "figure_6.2",
        "ts_36.305",
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_6.3.1",
      "section_id": "6.3.1",
      "section_title": "Access Network",
      "content": "The Access Network is involved in the handling of various positioning procedures.\nThe LCS specific functionalities of the radio access network elements are specified in TS 36.305 [42] for E-UTRAN, TS 25.305 [1] for UTRAN and TS 43.059 [16] for GERAN.",
      "chunk_type": "general",
      "cross_references": [
        "ts_36.305",
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_6.3.2",
      "section_id": "6.3.2",
      "section_title": "LCS Clients, LCS applications and Requestors",
      "content": "There are two classes of LCS Application - Internal applications and External applications. Internal applications represent entities internal to the GSM/UMTS/EPC that make use of location information for the (improved) operation of the network. Internal LCS client can be identified by LCS client internal ID. LCS client Internal ID distinguishes the following classes: (LCS client broadcasting location related information, O&M LCS client in the HPLMN, O&M LCS client in the VPLMN, LCS client recording anonymous location information, LCS Client supporting a bearer service, teleservice or supplementary service to the target UE). External applications represent entities (such as Commercial or Emergency services) that make use of location information for operations external to the mobile communications network. External LCS client can be identified by LCS client external ID. The LCS Applications interface to the LCS entities through their Location Client functions (LCF). Location requests from the external LCS clients may be originated by external entities (i.e. Requestor). LCS client should authenticate the Requestor Identity but this is outside the scope of this specification.\nLCS client may indicate the type of the Requestor identity in the LCS service request. The type of the Requestor identity can be one of the following:\n-\tLogical name\n-\tMSISDN (TS 23.003 [17])\n-\tE-mail address (RFC 2396 [33])\n-\tURL (RFC 2396 [33])\n-\tSIP URL (RFC 3261 [34])\n-\tIMS public identity (TS 23.228 [35])\nThe LCS Client, LCS applications and Requestors are outside the scope of the present document.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.003",
        "ts_23.228"
      ]
    },
    {
      "chunk_id": "ts_23.271_6.3.3",
      "section_id": "6.3.3",
      "section_title": "Gateway Mobile Location Centre, GMLC",
      "content": "The Gateway Mobile Location Centre (GMLC) contains functionality required to support LCS. In one PLMN, there may be more than one GMLC.\nA GMLC is the first node an external LCS client accesses in a PLMN (i.e. the Le reference point is supported by the GMLC). The GMLC may request routing information from the HLR via the Lh interface or HSS via the SLh/Lh interface. After performing registration authorization, it sends positioning requests to either VMSC, SGSN, MSC Server or MME and receives final location estimates from the corresponding entity via  the Lg, Lgd or SLg interface.\nNOTE:\tSupport of both Lg and Lgd on GMLC is an implementation option. Whether a GMLC supporting both interfaces (Lg and Lgd) uses Lg or Lgd towards an SGSN is based on operator configuration.\nInformation needed for authorisation, location service requests and location information may be communicated between GMLCs, located in the same or different PLMNs, via the Lr interface. The target UE's privacy profile settings shall always be checked in the UE's home PLMN prior to delivering a location estimate. In order to allow location request from a GMLC outside the HPLMN while having privacy check in the HPLMN, the Lr interface is needed.\nThe \"Requesting GMLC\" is the GMLC, which receives the request from LCS client.\nThe \"Visited GMLC\" is the GMLC, which is associated with the serving node of the target mobile.\nThe \"Home GMLC\" is the GMLC residing in the target mobile's home PLMN, which is responsible for the control of privacy checking of the target mobile.\nThe Requesting GMLC can be the Visited GMLC, and either one or both of which can be the Home GMLC at the same time.\n6.3.3A\tLocation Retrieval Function, LRF\nLocation Retrieval Function (LRF) may be collocated with the GMLC or separate and is responsible for retrieving or validating location information, providing routing and/or correlation info of an UE that has initiated an IMS emergency session. The information is provided to the E-CSCF via the Ml interface. For detail, refer to TS 23.167 [36a].",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.167"
      ]
    },
    {
      "chunk_id": "ts_23.271_6.3.4",
      "section_id": "6.3.4",
      "section_title": "LCS support in the UE",
      "content": "The UE may be involved in the various positioning procedures. Specific UE involvement is specified in each of the positioning procedures specified in TS 36.305 [42] in E-UTRAN, TS 25.305 [1] for UTRAN and TS 43.059 [16] for GERAN.\nThe UE interacts with the measurement co-ordination functions to transmit the needed signals for uplink based LCS measurements and to make measurements of downlink signals. The measurements to be made will be determined by the chosen location method.\nThe UE may also contain LCS applications, or access a LCS application through communication with a network accessed by the UE or an application residing in the UE. This application may include the needed measurement and calculation functions to determine the UE's location with or without assistance of the GSM/UMTS/EPS LCS entities.\nIn GSM the positioning methods supported by the UE are signalled by the UE to the core network and radio access network using Classmark3 in CS mode, as specified in TS 24.008 [24].\nIn UMTS the UE capability to support different positioning methods is only communicated within UTRAN, as specified in TS 25.331 [25].\nIn EPS the positioning methods supported by the UE may be signalled by the UE to the core network using LPP by the initial location service invocation as specified in TS 36.305 [42]. Also, in EPS the UE capabilities to support LCS Notification for an MT-LR and LPP for positioning are exchanged at the initial EPS attach procedure. The indication of the UE LPP capability will be forwarded by MME to E-SMLC as specified in TS 29.171 [46].\nThe UE informs the core network about its capability to support privacy invocation request and response using Classmark2 in CS mode and MS Network Capability in PS mode, as specified in TS 24.008 [24].\nThe UE may also, for example, contain an independent location function (e.g. Global Satellite Positioning Service GPS) and thus be able to report its location, independent of the RAN transmissions. The UE with an independent location function may also make use of information broadcast by the RAN that assists the function.\nThe UE may support multiple simultaneous location sessions.",
      "chunk_type": "general",
      "cross_references": [
        "ts_36.305",
        "ts_25.305",
        "ts_43.059",
        "ts_24.008",
        "ts_25.331",
        "ts_29.171"
      ]
    },
    {
      "chunk_id": "ts_23.271_6.3.5",
      "section_id": "6.3.5",
      "section_title": "MSC/VLR",
      "content": "The MSC/VLR contains functionality responsible for UE subscription authorization and managing call-related and non‑call related positioning requests of LCS. The MSC is accessible to the GMLC via the Lg interface. The LCS functions of MSC are related to charging and billing, LCS co-ordination, location request, authorization and operation of the LCS services. If connected to SGSN through the Gs interface, it checks whether the UE is GPRS attached to decide whether to page the UE on the A/Iu or Gs interface.\nThe MSC/VLR may inform HLR/HSS about the UE's LCS Capabilities and may include the IP address of the V-GMLC associated with the MSC/VLR in the MAP UPDATE LOCATION message, during Registration and Inter MSC Update Location procedures.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.3.6",
      "section_id": "6.3.6",
      "section_title": "MSC Server",
      "content": "The MSC Server handles the same functionality as the MSC/VLR including charging and billing, LCS co-ordination, location request, authorization and operation of the LCS services. The MSC Server is accessible to the GMLC via the Lg interface.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.3.7",
      "section_id": "6.3.7",
      "section_title": "SGSN",
      "content": "The SGSN contains functionality responsible for UE subscription authorization and managing positioning requests of LCS. The SGSN is accessible to the GMLC via the Lg (MAP-based) or Lgd (Diameter-based) interface. The LCS functions of SGSN are related to charging and billing, LCS co-ordination, location request, authorization and operation of the LCS services.\nNOTE:\tSupport of both Lg and Lgd on SGSN is an implementation option. Whether an SGSN supporting both (Lg or Lgd) interfaces uses Lg or Lgd towards a GMLC is based on operator configuration.\nThe SGSN may inform HLR/HSS about the UE's LCS Capabilities for GPRS and may include the IP address of the V-GMLC associated with the SGSN in the MAP UPDATE GPRS LOCATION message, during Attach and Inter SGSN Routing Area Update procedures.\nThe SGSN forwards the circuit-switched paging request received from the Gs interface to the BSS/RNC.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.3.8",
      "section_id": "6.3.8",
      "section_title": "Home Location Register, HLR",
      "content": "The HLR contains LCS subscription data and routing information. The HLR is accessible from the GMLC via the Lh interface. For a roaming UE, HLR may be in a different PLMN.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.3.9",
      "section_id": "6.3.9",
      "section_title": "HSS",
      "content": "The HSS contains LCS subscription data and routing information. The HSS is accessible from the GMLC via the Lh/SLh interface. For roaming UEs, HSS may be in a different PLMN.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.3.10",
      "section_id": "6.3.10",
      "section_title": "gsmSCF",
      "content": "The Lc interface supports CAMEL access to LCS and is applicable in CAMEL Phase 3 and later. The procedures and signalling associated with it are defined in TS 23.078 [21] and TS 29.002 [18], respectively.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.078",
        "ts_29.002"
      ]
    },
    {
      "chunk_id": "ts_23.271_6.3.11",
      "section_id": "6.3.11",
      "section_title": "Privacy Profile Register, PPR",
      "content": "Privacy check may be done in the privacy profile register. The HLR or HSS contains the address to the PPR. The PPR is accessible from the H-GMLC via the Lpp interface. PPR may be a standalone network entity or the PPR functionality may be integrated in H-GMLC.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.3.12",
      "section_id": "6.3.12",
      "section_title": "Pseudonym Mediation Device, PMD",
      "content": "The pseudonym mediation device (PMD) functionality maps or decrypts the pseudonym into the corresponding verinym (i.e. IMSI or MSISDN). PMD functionality may be a standalone network entity or the PMD functionality may be integrated in PPR, GMLC or other network entity. If PMD functionality is not part of GMLC it may be accessed using the Lid interface. The detail of PMD functionality is out of scope, and only the interface between GMLC and PMD functionality is specified in this specification.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.3.13",
      "section_id": "6.3.13",
      "section_title": "Mobility Management Entity, MME",
      "content": "The Mobility Management Entity (MME) contains functionality responsible for UE subscription authorization and managing positioning requests of LCS. The MME is accessible to the GMLC via the SLg interface. The LCS functions of MME are related to charging and billing, LCS co-ordination, E-SMLC selection, location request, authorization and operation of the LCS services.\nThe MME may inform HLR/HSS about the UE's LCS Capabilities for EPS and may include the IP address of the V-GMLC associated with the MME in the Update Location Request message, during Attach and Inter MME Tracking Area Update procedures.\nThe MME selects an available E-SMLC to serve the location request for a UE. The selection is based on network topology and should provide load balancing between E-SMLCs. Other criteria for E-SMLC selection may include LCS Client type and requested QoS. When the MME needs to know the country of a UE as described in clause 4.13.4 of TS 23.401 [41], the MME sends an indication included in the location request to E-SMLC.\nWhen assistance data is broadcast by the EPS in ciphered form, the MME receives ciphering keys from the E-SMLC and forwards to suitably subscribed UEs using mobility management procedures.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.401_clause_4.13.4",
        "ts_23.401"
      ]
    },
    {
      "chunk_id": "ts_23.271_6.3.14",
      "section_id": "6.3.14",
      "section_title": "Evolved Serving Mobile Location Centre, E-SMLC",
      "content": "The E-SMLC manages the overall co-ordination and scheduling of resources required for the location of a UE that is attached to E-UTRAN. It also calculates the final location and velocity estimate and estimates the achieved accuracy. The E-SMLC interacts with the UE in order to exchange location information applicable to UE assisted and UE based position methods and interacts with the E-UTRAN in order to exchange location information applicable to network assisted and network based position methods. The E-SMLC may provide broadcast assistance data via E-UTRAN in ciphered or unciphered form and forward any ciphering keys to subscribed UEs via the MME. The E-SMLC maps location estimate to a country or an international area based on request from MME.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.4.1",
      "section_id": "6.4.1",
      "section_title": "Verinyms for the target UE",
      "content": "It shall be possible to address and indicate the target UE using MSISDN and SIP-URI. It may be possible in certain cases to address the target UE using IP address when a static or dynamic IP address (IPv4 or IPv6) has been allocated for the UE.\nIn the mobile terminated location request procedures in the PS domain (as well as in the CS domain), the target UE is identified using either MSISDN or IMSI.\nNOTE:\tIt is recognized that IP-addressing of the target UE is only possible when there is an active PDP context established between the target UE and the external LCS client. Using the established PDP context, the LCS client can request the target UE, as identified with the IP address it currently uses, to initiate a Mobile originated location request. The actual signalling exchange between the LCS Client/server and the target UE or the user of the target UE is outside the scope of this specification. The resulting MO-LR is performed as specified in this document.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.4.2",
      "section_id": "6.4.2",
      "section_title": "Pseudonyms for the target UE",
      "content": "National regulations require support for the anonymity of the target mobile user in some countries. It shall therefore be possible to address and indicate the target UE using a pseudonym. The pseudonym may be the IMSI or MSISDN of the target UE encrypted e.g. using the public key of the home operator. The address of the network element that issued the pseudonym, i.e. the PMD address, shall either be attached to the pseudonym, if required or this address can be deduced from the pseudonym. The H-GMLC address may also either be attached to the pseudonym or be deduced from the pseudonym. It is outside the scope of this specification how the requestor and the LCS client will receive and handle the pseudonym, but some examples are described in the informative Annex E.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.4.3",
      "section_id": "6.4.3",
      "section_title": "Non-dialable callback numbers",
      "content": "In case of a SIM-less emergency call, or in case of a non-registered (U)SIM emergency call, a non-dialable callback number shall be used to identify the target UE. The format and structure of the non-dialable callback number is according to national or regional regulations. The non-dialable callback number in North America shall, according to J-STD-036 [32], be the digits 911 + the last 7 digits of IMEI expressed in decimal numbers.\nNOTE:\tThe use of non-dialable callback numbers in other parts of the world is for further study. The non-dialable callback number should adopt random numbering, if not otherwise unique.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.5",
      "section_id": "6.5",
      "section_title": "Quality of Service Information",
      "content": "LCS Quality of Service information is characterised by 3 key attributes:\n-\tLCS QoS Class\n-\tAccuracy\n-\tResponse Time\nThe use of quality of service to characterise location requests is optional and if not requested the default shall be either network operator determined or client negotiated.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.5.1",
      "section_id": "6.5.1",
      "section_title": "LCS QoS Class",
      "content": "The LCS QoS Class defines the degree of adherence by the Location Service to another quality of service parameter (Accuracy), if requested. The LCS Server shall attempt to satisfy the other quality of service parameter regardless of the use of QoS Class.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.5.1.1",
      "section_id": "6.5.1.1",
      "section_title": "Best Effort Class",
      "content": "This class defines the least stringent requirement on the QoS achieved for a location request. If a location estimate obtained does not fulfil the other QoS requirements, it should still be returned but with an appropriate indication that the requested QoS was not met. If no location estimate is obtained, an appropriate error cause is sent.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_6.5.1.2",
      "section_id": "6.5.1.2",
      "section_title": "Assured Class",
      "content": "This class defines the most stringent requirement on the accuracy achieved for a location request. If a location estimate obtained does not fulfil the other QoS requirements, then it shall be discarded and an appropriate error cause sent.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.1",
      "section_id": "7.1",
      "section_title": "LCS signalling between Access and Core Networks for GERAN and UTRAN access networks",
      "content": "For GERAN and UTRAN access networks, the core network sends location requests to the access network, which then sends the corresponding responses back to the core network.\nCommunication between access and core networks is accomplished through Iu interface in UMTS whereas the A, Gb and Iu interfaces are used for the purpose in GSM (see TS 25.305 [1] and TS 43.059 [16]).",
      "chunk_type": "general",
      "cross_references": [
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_7.1.1",
      "section_id": "7.1.1",
      "section_title": "Core network Location Request",
      "content": "The core network request for a location estimate of a target UE shall contain sufficient information to enable location of the Target UE according to the required QoS using any positioning method supported by the PLMN and, where necessary, UE. For location services the core network may request the geographical co-ordinates and velocity of the Target UE.\nIn Iu mode the core network may also request in which Service Area the Target UE is located. The Service Area information may be used for routing of corresponding Emergency calls, or for CAMEL services.\nIn A/Gb mode this corresponds to the usage of Cell ID in the core network. It should be noted that the Service Area concept is different from the Localized Service Area concept used for SoLSA services.\nWhen the location of a Target UE in Idle Mode is requested, the core network shall determine which RAN entity is associated with the Target UE.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.1.2",
      "section_id": "7.1.2",
      "section_title": "Location Report",
      "content": "The access network reports the location of the Target UE to the core network entities. The location report may contain the following information as defined in the corresponding location request:\n-\tthe geographical co-ordinates of the Target UE;\n-\tthe positioning method used to obtain the location estimate if the access network is either GERAN in the A/Gb mode, GERAN in the Iu mode or UTRAN in the Iu mode.\n-\tthe service area in which the Target UE is located;\n-\tachieved quality level of the location estimate;\n-\tvelocity estimate of the Target UE, if available;\n-\tachieved quality level of the velocity estimate of the Target UE, if available.\n7.1a\tLCS signalling between Access and Core Networks for E-UTRAN access networks\nFor E-UTRAN access networks, the MME sends location requests to the E-SMLC via the SLs interface (see clause 7.8). The E-SMLC then sends core network measurement requests, as described in clause 7.1a.1, to the access network via the MME. The access network sends corresponding network measurement reports, as described in clause 7.1a.2, back to the E-SMLC, again via the MME.\nCommunication between access and core networks is accomplished through S1 interface in E-UTRAN (see TS 36.305 [42].\n7.1a.1\tCore network Measurement Request\nThe core network request for network measurements shall contain sufficient information to enable the desired measurements to be provided by the access network.\nThe core network shall determine which RAN entities are associated with the Target UE.\n7.1a.2\tLocation Measurement Report\nThe access network reports measurements pertaining to the Target UE back to the E-SMLC as defined in the corresponding core network measurement request.",
      "chunk_type": "general",
      "cross_references": [
        "clause_7.8",
        "clause_7.1",
        "ts_36.305"
      ]
    },
    {
      "chunk_id": "ts_23.271_7.2",
      "section_id": "7.2",
      "section_title": "Um, Uu and Uu-LTE Interfaces",
      "content": "The Um, Uu and Uu-LTE interfaces are used to communicate among the LCS entities associated with the BSC, RNC, the UE and the stand-alone (Type A) Location Measurement Units (LMU). The Um, Uu and Uu-LTE interfaces are also used to communicate between the LCS entities in the core network and the UE.\nNOTE:\tThe Type A and Type B LMUs are defined only for GERAN. For LTE, the LMU may be standalone or integrated into an eNodeB, as noted in TS 36.305 [42].\nThe Um/Uu/Uu-LTE interfaces may pass measurement requests and results to and from UE or the stand-alone LMU.\nThe Um/Uu/Uu-LTE interfaces may also pass location requests from internal or external LCS Clients (Applications) at the UE. Note that these requests may require the services of the LCS entities associated with the core network to authenticate clients and subscriber subscriptions to aspects of the LCS.\nThe Um/Uu/Uu-LTE interfaces may also be used for broadcast of information that may be used by the UE or stand-alone LMU for their LCS operations. This may, for example, include timing information about nearby Node-B/BTS transmissions that may assist the UE or LMU in making their measurements. In UTRAN code information may be included.\nThe Um, Uu and Uu-LTE interfaces may also pass messages relating to changes or reporting of the data associated with the Location System Operations Function (LSOF) in the UE or the remote LMU.\nUTRAN Stage 2 specification TS 25.305 [1] specifies LCS signalling over the Uu interface and GERAN Stage 2 specification TS 43.059 [16] specifies LCS signalling over the Um interface correspondingly. E-UTRAN Stage 2 specification TS 36.305 [42] specifies LCS signalling over the Uu-LTE interface.\nMessage segmentation is specified in GERAN LCS Stage 2, TS 43.059 [16].",
      "chunk_type": "general",
      "cross_references": [
        "ts_36.305",
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_7.3",
      "section_id": "7.3",
      "section_title": "MAP Interfaces",
      "content": "The following interfaces are based on MAP in LCS.\n-\tLh interface: interface between GMLC and HSS. This interface is used by the GMLC to request the address of the H-GMLC, and/or the address of the visited MSC or SGSN for a particular target UE whose location has been requested\n-\tLg interface: interface between GMLC MSC and GMLC - SGSN. This interface is used by the GMLC to convey a location request to the MSC or SGSN currently serving a particular target UE whose location was requested. The interface is used by the MSC or SGSN to return location results to the GMLC.\n-\tLc interface: interface between GMLC and gsmSCF, CAMEL. This interface is used to get location information for CAMEL based services.\nThe following MAP services are defined for LCS.\n-\tMAP-SEND-ROUTING-INFO-FOR-LCS Service.\nThis service is used between the GMLC and the HLR/HSS to retrieve the routing information needed for routing a location service request to the serving VMSC , SGSN. The service may be used in GMLC - HSS interface to retrieve routing information in order to route the location service request to the correct VMSC, SGSN and MSC Server.\nIn case the service is used between the R-GMLC and the HSS, the H-GMLC address of the target UE to be located is retrieved. The address of the V-GMLC associated with the serving node and PPR may also be retrieved.\n-\tMAP-PROVIDE-SUBSCRIBER-LOCATION Service.\nThis service is used by a GMLC to request the location and optionally, velocity, of a target UE from the visited MSC, SGSN or MSC Server at any time.\n-\tMAP-SUBSCRIBER-LOCATION-REPORT Service.\nThis service is used by a VMSC, SGSN or MSC Server to provide the location of a target UE to a GMLC when a request for location is either implicitly administered or made at some earlier time.\nThe MAP Subscriber Location Report could also be used to send information about location and, if requested and available, velocity of the Target UE (for MO‑LR) to an external client.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.4",
      "section_id": "7.4",
      "section_title": "Lpp interface",
      "content": "Lpp is the interface between H-GMLC and PPR. If the UE subscribers LCS privacy information is kept in the PPR this interface is used by the H-GMLC to request the PPR to perform a privacy check. The Lpp interface shall conform to the protocol as specified in (reference to be added) and the procedures defined in clause 9 of this specification.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9"
      ]
    },
    {
      "chunk_id": "ts_23.271_7.4.1",
      "section_id": "7.4.1",
      "section_title": "LCS Authorisation Request",
      "content": "Via the LCS Authorisation Request, the H-GMLC can request the PPR to perform the privacy check. There exist two types of LCS Authorisation Request:\n-\tLCS Authorisation Request without location estimate (send by H-GMLC before location request);\n-\tLCS Authorisation Request with location estimate (to check location related privacy settings).\nThe following attributes are identified for LCS Authorisation Request information flow:\n-\tTarget UE identity, (one or both of MSISDN and IMSI), if needed;\n-\tIf PPR contains PMD functionality the LCS Authorisation Request may contain the same information as the LCS Identity request, i.e. the pseudonym of the target UE, if needed.\n-\tIndication on call/session related MT-LR;\n-\tLCS Client identity, i.e. LCS client external identity or internal identity;\n-\tLCS Client type, (i.e. Value added, Emergency, PLMN operator or Lawful interception);\n-\tLCS Client name, if needed (and type of LCS client name if available);\n-\tService type, if needed;\n-\tCodeword, if needed;\n-\tRequestor identity, if needed (and type of Requestor identity if available);\n-\tType of location, i.e. \"current location\", \"current or last known location\" or \"initial location\";\n-\tVelocity of the UE, if needed;\n-\tLCS capability sets of serving nodes, if needed;\n-\tLocation estimate, if needed and available (This is only relevant for LCS Authorisation Request with location estimate);\n-\tType of Deferred Location Request, if needed (i.e. UE available, Change of Area, Motion or Periodic Location);\n-\tGeographic area for change of area event, if needed;\n-\tParameters for Periodic Location event, if needed (i.e. reporting interval, total number of reports, request for MO-LR short circuit).\n-\tParameters for change of area event, if needed (i.e. type of area event, indication of single or multiple reports, minimum interval between reports, whether location estimates are requested, duration, maximum interval between reports, maximum sampling interval);\n-\tParameters for motion event, if needed (i.e. linear distance threshold, indication of single or multiple reports, minimum interval between reports, whether location estimates are requested, duration, maximum interval between reports, maximum sampling interval).",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.4.2",
      "section_id": "7.4.2",
      "section_title": "LCS Authorisation Response",
      "content": "The LCS Authorisation Response is sent by the PPR to the H-GMLC as the result for the LCS Authorisation Request.\nThe following attributes are identified for the LCS Authorisation Response information flow:\n-\tIndicator for location request is to be barred, if needed. If this is set, no other indicators shall be included in the response;\n-\tIndicator for call/session related class of privacy check related actions, if needed;\n-\tpositioning not allowed;\n-\tpositioning allowed without notifying the UE user;\n-\tpositioning allowed with notification to the UE user;\n-\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user or if there is no response to the notification;\n-\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user.\n-\tIndicator for call/session unrelated class of privacy check related actions, if needed;\n-\tpositioning not allowed;\n-\tpositioning allowed without notifying the UE user;\n-\tpositioning allowed with notification to the UE user;\n-\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user or if there is no response to the notification;\n-\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user.\n-\tPseudo external ID, if needed (see Annex C);\n-\tIndicator on additional privacy check with location estimate, if needed;\n-\tIndicator on additional notification/verification by the UE user without positioning (existing location estimate to be returned to the LCS Client if this is successful), if needed;\n-\tSame information as in the LCS Identity Response, in case the PMD is integrated in PPR, if needed;\n-\tIndicator for MO-LR short circuit allowed/not allowed, if needed.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.4.3",
      "section_id": "7.4.3",
      "section_title": "LCS Privacy Profile Update notification",
      "content": "The LCS Privacy Profile Update notification is sent to the H-GMLC from the PPR in order to notify the H-GMLC about the change of UEs privacy profile.\n-\tTarget UE identity, (one or both of MSISDN and IMSI);\n-\tIndication on the changed UEs privacy profile",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.4.4",
      "section_id": "7.4.4",
      "section_title": "LCS Privacy Profile Update notification ack",
      "content": "The LCS Privacy Profile Update notification ack. is sent to the PPR as the result of the LCS Privacy Profile Update Request by H-GMLC.\n-\tAcknowledgement",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.5",
      "section_id": "7.5",
      "section_title": "Lid interface",
      "content": "Lid is the interface between H-GMLC and PMD. If the UE subscribers pseudonym can be mapped or decrypted to the corresponding verinym in the standalone PMD. The Lid interface shall conform to the protocol as specified in (reference to be added) and the procedures defined in clause 9 of this specification.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_9"
      ]
    },
    {
      "chunk_id": "ts_23.271_7.5.1",
      "section_id": "7.5.1",
      "section_title": "LCS Identity Request",
      "content": "Via the LCS Identity Request, the H-GMLC can request the PMD to retrieve the verinym of the subscriber.\nThe following attribute is identified for the LCS Identity Request:\n-\tPseudonym;",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.5.2",
      "section_id": "7.5.2",
      "section_title": "LCS Identity Response",
      "content": "The PMD sends the LCS Identity Response to the H-GMLC as a result of the LCS Identity Request by the H-GMLC.\nThe following attribute is identified for the LCS Identity Response information flow:\n-\tTarget UE identity, (one or both of MSISDN and IMSI);",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.6.1",
      "section_id": "7.6.1",
      "section_title": "Dh Interface",
      "content": "Dh is the interface between LIMS-IWF and SLF. The purpose of this interface is to retrieve the address of the correct HSS serving the user. Dh is an optional interface.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.6.2",
      "section_id": "7.6.2",
      "section_title": "Sh Interface",
      "content": "Sh is the interface between LIMS-IWF and HSS. The purpose of this interface is to retrieve the user's MSISDN.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.6.3",
      "section_id": "7.6.3",
      "section_title": "Ml Interface",
      "content": "Ml is the interface between the E-CSCF and LRF. For details, refer to TS 23.167 [36a].",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.167"
      ]
    },
    {
      "chunk_id": "ts_23.271_7.7",
      "section_id": "7.7",
      "section_title": "SLg Interface",
      "content": "SLg is the interface that is used by the GMLC to convey a location request to the MME currently serving a particular target UE whose location was requested. The interface is also used by the MME to return location results to the GMLC.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_7.8",
      "section_id": "7.8",
      "section_title": "SLs Interface",
      "content": "SLs is the interface between the MME and the E-SMLC. This interface is used to convey location requests from the MME to the E-SMLC and to convey corresponding location reports back from the E-SMLC to the MME.\nIt is also used for tunnelling core network measurement requests from the E-SMLC to the RAN, using RAN specified protocols transparent to the MME as described in TS 36.305 [42].",
      "chunk_type": "general",
      "cross_references": [
        "ts_36.305"
      ]
    },
    {
      "chunk_id": "ts_23.271_7.9",
      "section_id": "7.9",
      "section_title": "SLh Interface",
      "content": "SLh is the Diameter based interface between the HSS and the GMLC as described in TS 29.173 [45].",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.173"
      ]
    },
    {
      "chunk_id": "ts_23.271_7.10",
      "section_id": "7.10",
      "section_title": "SLm Interface",
      "content": "SLm is the interface between the E-SMLC and the LMU. This interface allows the E-SMLC to exchange measurement information with the LMU for the purpose of UTDOA positioning as described in TS 36.305 [42].",
      "chunk_type": "general",
      "cross_references": [
        "ts_36.305"
      ]
    },
    {
      "chunk_id": "ts_23.271_7.11",
      "section_id": "7.11",
      "section_title": "Lgd Interface",
      "content": "Lgd is the interface that is used by the GMLC to convey a location request to the SGSN currently serving a particular target UE whose location was requested. The interface is also used by the SGSN to return location results to the GMLC. This interface is applicable only for an SGSN supporting EPS based interfaces and protocols.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.1.1.1",
      "section_id": "8.1.1.1",
      "section_title": "NULL State",
      "content": "In the NULL state, a particular location request from some LCS client either has not been received yet or has already been completed. After a location request is received from a LCS client, the GMLC remains in the NULL state while the identity of the client and nature of its location request are verified. While the NULL state exists conceptually, it need not be represented explicitly in the GMLC.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.1.1.2",
      "section_id": "8.1.1.2",
      "section_title": "INTERROGATION State",
      "content": "In this state, the GMLC has sent an interrogation to the home HLR/HSS of the UE to be located and is awaiting a response giving one or several of the following addresses: the VMSC, MSC Server, SGSN address, MME address and IMSI for this UE.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.1.1.3",
      "section_id": "8.1.1.3",
      "section_title": "LOCATION State",
      "content": "In this state, the GMLC has sent a location request to the VMSC, MSC Server, SGSN or MME serving the UE to be located and is awaiting a response containing a location estimate. Optionally, location information may also be communicated between GMLCs, located in the same or a different PLMN, via the GMLC to GMLC Lr interface",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.1.2.1",
      "section_id": "8.1.2.1",
      "section_title": "State Transitions",
      "content": "Figure 8.1: State Transitions in the GMLC\nMoving from NULL to INTERROGATION state:\nIf the GMLC does not know any of the following addresses: VMSC, MSC Server, SGSN, MME, V-GMLC address or IMSI when it receives a location service request from some LCS client, it moves from the NULL state to the INTERROGATION state and sends a request to the UE's home HLR/HSS for the VMSC/ MSC Server/ SGSN /MME/ V-GMLC address and IMSI.\nMoving from NULL to LOCATION state:\nIf the GMLC already knows one of the following addresses: VMSC, MSC Server, SGSN, MME or UE IMSI, when it receives a location service request from some LCS client (e.g. from information retained for an earlier location request for the same UE), it moves from the NULL state to the LOCATION state and sends a location request to either the VMSC, MSC Server, SGSN, or MME. Optionally, it may send the location request to another GMLC via the Lr interface.\nNOTE:\tIt is for further study how GMLC selects if it shall send the location request to VMSC, MSC server, SGSN, and/or MME in different cases. This should be specified in the signalling procedures.\nMoving from INTERROGATION to LOCATION state:\nAfter the GMLC, in the INTERROGATION state, receives one or several of the addresses VMSC, MSC Server, SGSN, MME, V-GMLC and IMSI from the home HLR/HSS, it enters the LOCATION state and sends a location request to either the VMSC, MSC Server, SGSN, MME or V-GMLC of the UE being located.\nMoving from LOCATION to NULL state:\nAfter the GMLC receives a location estimate response from the VMSC, MSC Server, SGSN, MME or V_GMLC, it forwards the location estimate to the requesting LCS client and re-enters the NULL state.",
      "chunk_type": "general",
      "cross_references": [
        "figure_8.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_8.1.2.2",
      "section_id": "8.1.2.2",
      "section_title": "INTERROGATION Timer Function",
      "content": "The GMLC runs a timer while in the INTERROGATION state to limit the amount of time waiting for an interrogation response from the HLR/HSS. If the timer expires before an interrogation response is received, the GMLC indicates a location failure to the LCS client and re-enters the NULL state.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.1.2.3",
      "section_id": "8.1.2.3",
      "section_title": "LOCATION Timer Function",
      "content": "The GMLC runs a timer while in the LOCATION state to limit the amount of time waiting for a location estimate response from the VMSC/ MSC Server /SGSN/MME. If the timer expires before a response is received, the GMLC indicates a location failure to the LCS client and re-enters the NULL state.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.2.1.1",
      "section_id": "8.2.1.1",
      "section_title": "LCS IDLE State",
      "content": "In this state, the VMSC/MSC Server location service is inactive for a particular UE. The UE may be known in the VMSC/MSC Server (except for a USIM less or SIM less Emergency call or where the UE information has been cancelled or lost in the VMSC/MSC Server), but there may not be an active Mobility Management to the UE.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.2.1.2",
      "section_id": "8.2.1.2",
      "section_title": "LOCATION State",
      "content": "In this state, the VMSC/MSC Server is awaiting a response from RAN after requesting the location for a particular UE.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.2.2.1",
      "section_id": "8.2.2.1",
      "section_title": "State Transitions",
      "content": "Figure 8.2: State Transitions in the VMSC/MSC Server\nMoving from LCS IDLE to LOCATION state:\nAfter a request has been received to locate a particular UE and the UE subscription options have been verified, a location request is sent to the RAN of the UE to be located: the VMSC/MSC Server then enters the LOCATION state. Before entering this state, the VMSC/MSC Server must have setup a Mobility Management connection to the UE if none was previously active. The mobile is paged and authenticated before positioning.\nMoving from LOCATION to LCS IDLE state:\nAfter the return of a location estimate result from RAN, the VMSC/MSC Server shall re-enter IDLE state.",
      "chunk_type": "general",
      "cross_references": [
        "figure_8.2"
      ]
    },
    {
      "chunk_id": "ts_23.271_8.2.2.2",
      "section_id": "8.2.2.2",
      "section_title": "LOCATION Timer Function",
      "content": "The VMSC/MSC Server runs a timer while in the LOCATION state to limit the amount of time waiting for a location response from the RAN. If the timer expires before such information is received, the VMSC/MSC Server indicates a location failure to the original requesting entity and re-enters IDLE state.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.3.1.1",
      "section_id": "8.3.1.1",
      "section_title": "LCS IDLE State",
      "content": "In this state, the SGSN location service is inactive for a particular UE. The UE is known in the SGSN except in case where the UE data has been cancelled or lost in the SGSN. There is not an active Mobility Management to the UE.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.3.1.2",
      "section_id": "8.3.1.2",
      "section_title": "LOCATION State",
      "content": "In this state, the SGSN is awaiting a response from the RAN after requesting the location for a particular UE. In this state, a Mobility Management connection to the target UE will be active.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.3.2.1",
      "section_id": "8.3.2.1",
      "section_title": "State Transitions",
      "content": "Figure 8.3: State Transitions in the SGSN\nMoving from LCS-IDLE to LOCATION state:\nAfter a request has been received to locate a particular UE and the UE subscription options have been verified to allow this, the SGSN sends a location request to the RAN. The SGSN then enters the LOCATION state. Before entering this state, the SGSN must have setup a Mobility Management connection to the UE if none was previously active. The mobile is paged and authenticated before positioning.\nMoving from LOCATION to LCS IDLE state:\nAfter the return of a location estimate result from RAN, or if the Location Timer described below expires, the SGSN shall re-enter IDLE state.",
      "chunk_type": "general",
      "cross_references": [
        "figure_8.3"
      ]
    },
    {
      "chunk_id": "ts_23.271_8.3.2.2",
      "section_id": "8.3.2.2",
      "section_title": "LOCATION Timer Function",
      "content": "The SGSN runs a timer while in the LOCATION state to limit the amount of time waiting for a location response from the RAN. If the timer expires before such information is received, the SGSN indicates a location failure to the original requesting entity and re-enters IDLE state.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.4",
      "section_id": "8.4",
      "section_title": "Signalling connection for the Iu interface",
      "content": "When using the Iu interface, before SGSN/MSC server can request location information of a target UE from RAN, an Iu signalling connection must have been established between SGSN/MSC server and RAN. The SGSN/MSC server sends a location request message to RAN, which determines the location of the target UE related to this Iu signalling connection and sends a location report to SGSN/MSC server over the same Iu signalling connection. On the Iu interface, only one location request for a geographic location estimate can be ongoing at any time.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.5",
      "section_id": "8.5",
      "section_title": "Signalling connection for the A-interface",
      "content": "When using the A interface, before MSC can request location information of a target UE from RAN, an A interface signalling connection must have been established between MSC and RAN. The MSC sends a location request message to RAN, which determines the location of the target UE related to this A interface signalling connection and sends a location report to MSC over the same A interface signalling connection. On the A interface, only one location request can be ongoing at any time.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.6",
      "section_id": "8.6",
      "section_title": "Gb interface mapping of target UE",
      "content": "The pre-requisite for LCS procedures on the Gb interface is that UE is in \"ready state\". On the Gb interface, only one location request can be ongoing at any time.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.7.1",
      "section_id": "8.7.1",
      "section_title": "MME States",
      "content": "An MME supports at least one location session for any UE at any one time. A location session is invoked by the MME in order to obtain the location of the UE or perform some other location related service such as transferring assistance data to the UE.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.7.1.1",
      "section_id": "8.7.1.1",
      "section_title": "LCS IDLE State",
      "content": "In this state, the MME location service is inactive for a particular UE. The UE is known in the MME and a mobility management connection for the UE may or may not be active.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.7.1.2",
      "section_id": "8.7.1.2",
      "section_title": "LOCATION State",
      "content": "In this state, the MME is awaiting a response from an E-SMLC after requesting a location service for a particular UE. In this state, the UE is known in the MME and a Mobility Management connection to the UE is active.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.7.2.1",
      "section_id": "8.7.2.1",
      "section_title": "State Transitions",
      "content": "Figure 8.4: State Transitions in the MME\nMoving from LCS-IDLE to LOCATION state:\nAfter a request has been received for a particular location service for a particular UE and the UE subscription options have been verified where applicable to allow this, the MME sends a location request to an E-SMLC. The MME then enters the LOCATION state. Before entering this state, the MME must have setup a Mobility Management connection to the UE if none was previously active.\nMoving from LOCATION to LCS IDLE state:\nAfter the return of a location result from the E-SMLC, or if the Location Timer described below expires, the MME shall re-enter IDLE state.",
      "chunk_type": "general",
      "cross_references": [
        "figure_8.4"
      ]
    },
    {
      "chunk_id": "ts_23.271_8.7.2.2",
      "section_id": "8.7.2.2",
      "section_title": "LOCATION Timer Function",
      "content": "The MME runs a timer while in the LOCATION state, whose value may depend on the location service, to limit the amount of time waiting for a location response from the E-SMLC. If the timer expires before such information is received, the MME indicates a location failure to the original requesting entity and re-enters IDLE state.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_8.8",
      "section_id": "8.8",
      "section_title": "Signalling connection for the S1 interface",
      "content": "Before the MME can request location information of a target UE from the E-SMLC, an S1 signalling connection must have been established between the MME and E-UTRAN. The MME sends a location request message to E-SMLC, which determines the location of the target UE related to this S1 signalling connection and sends a location measurement report to the MME.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9",
      "section_id": "9",
      "section_title": "General Network Positioning Procedures",
      "content": "The generic network positioning procedure of providing the location information of an UE subscriber can be partitioned into the following procedures.\nLocation Preparation Procedure\nThis generic procedure is concerned with verifying the privacy restrictions of the UE subscriber, reserving network resources, communicating with the UE to be located and determining the positioning method to be used for locating the UE subscriber based on the requested QoS and the UE and network capabilities.\nPositioning Measurement Establishment Procedure\nThis procedure is concerned with performing measurements by involving the necessary network and/or UE resources. Depending on the positioning method to be used for locating the UE the internals of this procedure can be positioning method dependent. The procedure is completed with the end of the positioning measurements.\nLocation Calculation and Release Procedure\nThis generic procedure is initiated after the measurements are completed and is concerned with calculating the location and optionally, velocity of the UE and releasing all network and/or UE resources involved in the positioning.\nEach of the following procedures defines the support of a single location request (MT‑LR, MO‑LR or NI‑LR) that may be immediate or deferred. Treatment alternatives for a new location request when other concurrent locations requests are already ongoing for the same target UE is not generally defined in these procedures except in certain specific cases. For such general treatment alternatives, refer to clause 4.5.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_4.5"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1",
      "section_id": "9.1",
      "section_title": "Mobile Terminating Location Request",
      "content": "The MT-LR procedures for the location request from the LCS client which does not have the privacy override capability are described in the clause 9.1.1.The MT-LR procedures for the location request from the LCS client which has the privacy override capability (e.g. the request is come from the emergency service provider) are described in the clause 9.1.1A. In this case the H-GMLC is not involved to the location procedures and the privacy check procedures in H-GMLC/PPR are skipped.\nIt is noted that R-GMLC or the UE may handle the periodicity of location requests as requested by the LCS client both in CS and PS domain.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.1",
      "section_id": "9.1.1",
      "section_title": "Common MT-LR procedure in PS and CS domain",
      "content": "Figure 9.1: General Network Positioning for a MT-LR\n1)\tAn external LCS client requests the current location and optionally, velocity of a target UE from a GMLC. The LCS Client may also request a deferred location request, i.e. based on event. The R-GMLC verifies the identity of the LCS client and its subscription to the LCS service requested and derives the MSISDN or IMSI or pseudonym of the target UE to be located and the LCS QoS from either subscription data or data supplied by the LCS client. For a call related location request, the LCS client includes the LCS client's called party number, as dialled by the target mobile user, in the LCS service request. For a session related location request, the LCS client includes the APN-NI of the LCS client, as used by the target UE, in the LCS service request. For a call/session related request the R-GMLC may verify that the called party number or APN-NI is correct for the LCS client in question. The LCS client's dialled number or APN-NI are checked in step 9 for the call/session related class.The LCS request may carry also the Service Identity and the Codeword and the service coverage information. The R-GMLC may verify that the Service Identity received in the LCS request matches one of the service identities allowed for the LCS client. If the service identity does not match one of the service identities for the LCS client, the R-GMLC shall reject the LCS request. Otherwise, the R-GMLC can map the received service identity in a corresponding service type.If the location request is originated by a Requestor, the Requestor Identity may be added to the LCS service request. The LCS client should authenticate the Requestor Identity but this is outside the scope of this specification. The LCS service request may also contain the type of the Requestor identity if the requestor identity was included.\nIf the H-GMLC address is not contained in the pseudonym or cannot deduced from the pseudonym, the R-GMLC shall determine the verinym for the pseudonym. In this case the R-GMLC may access to its associated PMD as described in clause 9.1.1.3.The R-GMLC verifies whether it stores the privacy profile of the target UE. If the R-GMLC stores the UE's privacy profile, (this means the R-GMLC is the H-GMLC of the target UE), then step 2, 3, 4 and 12 are skipped.If location is required for more than one UE, the steps following below may be repeated and in that case the R-GMLC should verify whether the number of Target UEs in the LCS request is equal or less than the Maximum Target UE Number of the LCS client. If the Maximum Target UE Number is exceeded, the R-GMLC should respond to the client with proper error cause. If periodic location is requested, the steps following below may be repeated or the R‑GMLC may forward the periodic location request to the UE, see clause 9.1.12.\n2)\tIf the R-GMLC already knows, (e.g. from a previous location request or an internal lookup table), or is able to determine, (e.g. it is possible to use a DNS lookup mechanism similar to IETF RFC 2916), the network address of H-GMLC of the target UE, or in case the location service request contains the target UE's pseudonym, which includes the target UE's Home-GMLC address, or a pseudonym from which the target UE's Home-GMLC address can be deduced, then this step and step 3 may be skipped.Otherwise, the R-GMLC sends a SEND_ROUTING_INFO_FOR_LCS message to the home HLR/HSS of the target UE to be located with the IMSI or MSISDN of the UE.The details of the alternative methods of retrieving H-GMLC address other than the sending SEND_ROUTING_INFO_FOR_LCS message to the HLR/HSS, (e.g. internal lookup table, DNS lookup mechanism), are not in the scope of this specification.\nEditor's note:\tThe support for number portability with these alternative solutions of retrieving H-GMLC address still needs further study and should be in line with the general solution to support number portability in Rel-6.\n3)\tThe HLR/HSS verifies whether the R-GMLC is authorized to request UE location information. If not, an error response is returned.Otherwise the HLR/HSS returns one or several of the network addresses of the current SGSN and/or VMSC/MSC server and/or current MME, the LCS capabilities of the serving nodes if available , the V-GMLC address associated with the serving nodes, if available and whichever of the IMSI and MSISDN that was not provided in step 2. The HLR/HSS returns the address of the H-GMLC. The HLR/HSS also returns the address of the PPR, if available.\nNOTE 1:\tHLR/HSS may prioritise between the MSC/VLR or SGSN or MME address sent to the GMLC. The prioritisation might be based on information received from SGSN and/or MSC/VLR and/or MME concerning the UE's capabilities for LCS. Other priority criteria are for further study.\n4)\tIf R-GMLC finds out that it is the H-GMLC, the signalling steps 4 and 15 are skipped. If the R-GMLC did not receive the H-GMLC address in step 3 and can not retrieve the H-GMLC address in some other way (e.g. DNS lookup), then steps 4, 5, 6, 7, 8, 10, 11, 12, 14 and 15 are skipped and the R-GMLC directly sends the PSL message to the serving node.Otherwise, the R-GMLC sends the location request to the H-GMLC. If one or several of the network addresses of the current SGSN and/or VMSC/MSC server and/or current MME, the LCS core network signalling capabilities of the serving nodes, IMSI and MSISDN for the target UE and the address of the V-GMLC and the PPR have been retrieved in Step 3, the R-GMLC shall pass the information with the location request to the H-GMLC. The R-GMLC shall also send the service coverage information to the H-GMLC, if the information is available.\n5)\tThe H-GMLC verifies whether the R-GMLC is authorized to request UE location information. If the R-GMLC is not authorized, an error response is returned.If the LCS service request contains the pseudonym of the target UE and the H-GMLC cannot resolve the PMD address from the pseudonym, the H-GMLC itself determines the verinym (MSISDN or IMSI) of the target UE. If the H-GMLC can resolve the address of PMD from the pseudonym, the H-GMLC requests the verinym from its associated PMD, see clause 9.1.1.3. In case H-GMLC knows that the PMD functionality is integrated in PPR, it can include the information from the LCS Identity Request in the LCS authorisation request to the PPR, see clause 9.1.1.1. In this case, if H-GMLC is not able to obtain the verinym of the target UE, the H-GMLC shall cancel the location request.The H-GMLC performs privacy check on the basis of the UE user's privacy profile stored in the H-GMLC and the capabilities of the serving nodes (MSC/VLR and/or SGSN and/or MME), if available. If the privacy profile of the target UE is stored in a PPR and the H-GMLC received the network address of the PPR from R-GMLC or is able to determine the PPR address (e.g. from a previous location request or an internal lookup table), the H-GMLC shall ask the PPR to perform the privacy check as described in the 9.1.1.1. If the privacy profile is stored in a PPR but the network address of the PPR is not available, the H-GMLC shall send SRI for LCS message to HLR/HSS in step 6 in order to get the PPR address and the privacy check in this step shall be performed after step 7. Also if the key of the UE user's privacy profile (i.e. MSISDN or IMSI) is not available, the privacy check in this step shall be performed after step 7. The H-GMLC/PPR verifies LCS barring restrictions in the UE user's privacy profile in the H-GMLC/PPR. In verifying the barring restrictions, barring of the whole location request is assumed if any part of it is barred or any requisite condition is not satisfied. If the location service request is to be barred, GMLC shall terminate the request towards the R-GMLC or the LCS client with the appropriate error code. As a result of the privacy check, the H-GMLC/PPR selects one or two indicators of the privacy check related action and/or a pseudo-external identity in the case of interaction with a pre Rel-6 serving node. (The details of the indicator of the privacy check related action and the pseudo-external identity are described in clause 9.5.4 and Annex C). If the requested type of location is \"current or last known location\" and the requested maximum age of location information is available, the H-GMLC verifies whether it stores the previously obtained location estimate of the target UE. If the H-GMLC stores the location estimate and the location estimate satisfies the requested accuracy and the requested maximum age of location, the H-GMLC checks the result of the privacy check. In case the result of the privacy check for call/session unrelated class is \"Location allowed without notification\" then steps 6, 7, 8, 9 and 10 may be skipped.\n6)\tIf the H-GMLC does not know IMSI for the particular MSISDN (e.g. from a previous location request), and the VMSC/MSC server address, SGSN address or MME address, the H-GMLC shall send a SEND_ROUTING_INFO_FOR_LCS message to the home HLR/HSS of the target UE to be located with the IMSI or MSISDN of this UE. Also if the privacy profile is stored in a PPR but the network address of the PPR was not available in the step 5, the H-GMLC shall send the SRI for LCS message to HLR/HSS. Otherwise, this step and step 7 may be skipped.\n7)\tThe HLR/HSS then returns one or several of the network addresses of the current SGSN and/or VMSC/MSC server and/or current MME, the LCS core network signalling capabilities of the serving nodes , the V-GMLC address associated with the serving nodes, if available, \"Optimized Lgd\" indicator if enabled according to the criteria in clause 5.7 and whichever of the IMSI and MSISDN that was not provided in step (6) for the particular UE. The HLR/HSS may also return the address of the PPR, if available.\nNOTE 2:\tHLR/HSS may prioritise between the MSC/VLR or SGSN or MME address sent to the GMLC. The prioritisation might be based on information received from SGSN and/or MSC/VLR and/or MME concerning the UE's capabilities for LCS. Other priority criteria are for further study.\nNOTE 3:\tIf ISR is active for LTE access, the HSS may return the address of both the current MME and current SGSN.\n8)\tIf step 6 and step 7 were performed, the H-GMLC/PPR may do a new privacy check, or if the privacy profile is stored in a PPR but the network address of the PPR was not available in step 5 and the PPR address is obtained in step 7, the H-GMLC shall ask the PPR to perform the privacy check as described in the 9.1.1.1.If the location request is an immediate location request and the service coverage information was sent from R-GMLC, the H-GMLC checks the country codes of the serving node addresses. If the H-GMLC finds out the current SGSN and/or VMSC/MSC server and/or current MME locates out of the service coverage, the H-GMLC returns an appropriate error message to the R-GMLC or the LCS client.In the cases when the H-GMLC did not receive the address of the V-GMLC, or when the V-GMLC address is the same as the H-GMLC address, or when both PLMN operators agree not to use the Lr interface, the H-GMLC does not send the location request to the V-GMLC and step 10 is skipped. In this case, the H-GMLC sends the location service request message to the serving node.If the H-GMLC received the address of the V-GMLC from the HLR/HSS and the V-GMLC address is different from the H-GMLC address, the H-GMLC may send the location request to the V-GMLC. The location request shall contain one or several of the network addresses of the current SGSN and/or MSC/VLR and/or current MME, and the IMSI and MSISDN of the target UE. The location request may also carry the requested action of the VPLMN as the result of the privacy check in the H-GMLC (i.e. by using the indicator of the privacy check related action as described in clause 9.5.4 or by using the pseudo-external identity as described in Annex C in the case of query to a pre Rel-6 serving node). If the result of privacy check indicates that the notification (and verification) based on current location is needed, the H-GMLC shall send a location request to the V-GMLC indicating \"positioning allowed without notification\" or, for backwards compatibility with a pre Rel-6 serving node, a pseudo external identity representing the same privacy notification and verification action required as for the \"positioning allowed without notification\" procedure as described in Annex C and V-GMLC shall send a Provide Subscriber Location message to the MSC/SGSN/MME indicating \"positioning allowed without notification\" or, for backwards compatibility with a pre Rel-6 serving node, a pseudo external identity representing the same privacy notification and verification action required as for the \"positioning allowed without notification\" procedure as described in Annex C. The V-GMLC first authenticates that the location request is allowed from this GMLC, PLMN or from this country. If not, an error response is returned.\n9)\tIf the GMLC (H-GMLC, R-GMLC or V-GMLC) receives only the MSC/VLR address, the MT LR proceeds as the CS-MT-LR procedure described in clause 9.1.2. If the GMLC receives only the SGSN address, the MT LR proceeds as the PS-MT-LR procedure described in clause 9.1.6. If the GMLC receives only the MME address, the MT LR proceeds as the EPC-MT-LR procedure described in clause 9.1.15. If the GMLC receives several of the following addresses, SGSN, VMSC, MSC Server and/or MME, it has to decide where to send the location request. If the requested MT-LR is known to be associated with a CS call, the CS-MT-LR procedure shall be invoked. If the requested MT-LR is associated with a PS session in UTRAN, the PS-MT-LR procedure shall be invoked. If the requested MT-LR is associated with a PS session in E-UTRAN, the EPC-MT-LR procedure shall be invoked. Otherwise, two or more of CS-MT-LR, PS-MT-LR and EPC-MT-LR are applicable. If the GMLC has determined that PS-MT-LR and/or EPC-MT-LR procedures are to be executed then according to the criteria in clause 5.7 the GMLC shall set the \"Optimized Lgd\" indicator in the Provide Subscriber Location request procedure for either EPC-MT-LR or PS-MT-LR. In this case, GMLC shall only execute either EPC-MT-LR or PS-MT-LR procedure. If LCS Client indicated deferred location request, GMLC shall indicate this together with applicable event type (e.g. UE available) in the requested EPC/PS/CS-MT-LR, see clauses 9.1.8 and 9.1.15.\nNOTE 4:\tThe order in which these procedures are invoked and whether one or both procedures are used may depend on information in the LCS service request, subscription information for the LCS client, possible priority information returned by the HSS or information already stored in the GMLC (e.g. obtained from previous location requests). The order may also depend on operator preference for invoking or not invoking location estimation on a particular access type when CSFB or ISR may be supported.\nNOTE 5:\tIf ISR is active for LTE access, the V-GMLC receives both an SGSN and MME address. The VGMLC which hasn't received activation of Optimized Lgd procedures (see clause 5.7) from HSS and which doesn't support Optimized Lgd procedures (see clause 5.7), may then instigate both PS-MT-LR and EPC-MT-LR procedures. This will lead to separate paging of the UE in its registered TA(s) in association with the MME procedure and in its registered RA(s) in association with the SGSN procedure. The UE would then respond to only one paging request leading to continuation of only one of the MT-LR procedures and a termination of the other. The V-GMLC will discover which is which from the responses it later receives from the MME and SGSN for each MT-LR procedure.\n10)\tThe V-GMLC sends the location service response to the H-GMLC in accordance with the requested LCS QoS Class. If the requested LCS QoS class was Assured, V-GMLC sends the result only if the result has been indicated to fulfil the requested accuracy, otherwise V-GMLC sends a LCS service response with a suitable error cause. If the UE requested LCS QoS class was Best Effort, V-GMLC sends whatever result it received with an appropriate indication if the requested accuracy was not met. The location service response may contain the information about the positioning method used. The V-GMLC may record charging information.\n11)\tIf the privacy check in step 5 indicates that further privacy checks are needed, or on the basis of the privacy profile, the H-GMLC shall perform an additional privacy check or the H-GMLC may ask the PPR to perform the privacy check as described in the 9.1.1.1 in order to decide whether the H-GMLC can forward the location information to the LCS client or send a notification if the result of the privacy check requires the notification and verification based on current location. If the location request from the R-GMLC or the LCS client contained the pseudonym, the H-GMLC shall use the pseudonym of the target UE in the location response to the R-GMLC or the LCS client. One example when this additional privacy check is needed is when the target UE user has defined different privacy settings for different geographical locations.\n12)\tIf the result of privacy checks in step 11 indicates that the notification (and verification) based on current location is needed, the HGMLC shall send a location request to the V-GMLC indicating \"notification only\" or, for backwards compatibility with a pre Rel-6 serving node, a pseudo external identity representing the same privacy notification and verification action required as for the \"notification only\" procedure as described in Annex C. Otherwise this step and steps 13, 14 may be skipped. If the H-GMLC received the address of the V-GMLC from the HLR/HSS and the V-GMLC address is different from the H-GMLC address in step 8, the H-GMLC may send the location request to the V-GMLC. The location request shall contain one or several of the network addresses of the current SGSN and/or MSC/VLR and/or current MME, and the IMSI and MSISDN of the target UE.\nNOTE:\tThe use of pseudo external identities in this step implies that a second positioning attempt is performed.\n13)\tIf the GMLC (H-GMLC, R-GMLC or V-GMLC) received only the MSC/VLR address in step 9, the MT LR proceeds as the CS post positioning notification and verification procedure described in clause 9.1.10 or clause 9.1.2 if pseudo external identity is used. If the GMLC receives only the SGSN address in step 9, the MT LR proceeds as the PS post positioning notification and verification procedure described in clause 9.1.11 or clause 9.1.6 if pseudo external identity is used. If the GMLC receives only the MME address in step 9, the MT LR proceeds as the EPC post positioning notification and verification procedure described in clause 9.1.18. If the GMLC receives several of the following addresses, SGSN, VMSC, MSC Server and/or MME, it has to decide where to send the location request. If the requested MT-LR is known to be associated with a CS call, the CS post positioning notification and verification procedure shall be invoked. If the requested MT-LR is associated with a PS session in UTRAN, the PS post positioning notification and verification procedure shall be invoked. If the requested MT-LR is associated with a PS session in E-UTRAN, the EPC post positioning notification and verification procedure shall be invoked. Otherwise, CS and/or PS and/or EPC post positioning notification and verification procedure are applicable.\n14)\tThe V-GMLC sends the location service response with an indication of the result of notification and verification procedure performed in step 13 to the H-GMLC.\n15)\tThe H-GMLC sends the location service response to the R-GMLC. The H-GMLC may store the location information and its age. The location service response may contain the information about the positioning method used and the indication whether the obtained location estimate satisfies the requested accuracy or not. The H-GMLC may record charging information.\n16)\tR-GMLC sends the location service response to the LCS client. If the location request from the LCS client contained the pseudonym and the R-GMLC resolved the verinym from the pseudonym in the step 1, the R-GMLC shall use the pseudonym of the target UE in the location response to the LCS client. If the LCS client requires it, the R-GMLC may first transform the universal location co-ordinates provided by the SGSN or MSC/MSC server or MME into some local geographic system. The R-GMLC may record charging information both for the LCS client and inter-network revenue charges from the SGSN or MSC/MSC server or MME's network. The location service response from the R-GMLC to the LCS client may contain the information about the positioning method used and the indication whether the obtained location estimate satisfies the requested accuracy or not.\nThe detailed CS-MT-LR, PS-MT-LR and EPC-MT-LR procedures in step 9 of figure 9.1 are described in clauses 9.1.2, 9.1.6 and 9.1.15. The detailed procedure for deferred PS/CS-MT-LR is described in clause 9.1.8.\n9.1.1A\tCommon MT-LR procedure in PS and CS domain for Emergency MT-LR\nThis clause describes how an emergency location request may be handled similarly to a normal location request. This method should be restricted to those countries where there is not a national requirement to provide location for callers who are either roaming or making a SIM-less emergency call, or making a non-registered (U)SIM emergency call. It is also appropriate to use this method to provide location for lawful intercept services where allowed by national regulation.\nFigure 9.1A: Network Positioning for an Emergency MT-LR\n1)\tAn external LCS client which has the privacy override capability, (e.g. Emergency service provider), requests the location of a target UE from a GMLC. The R-GMLC verifies the identity of the LCS client and its subscription to the LCS service requested and derives the MSISDN or IMSI of the target UE to be located and the LCS QoS from either subscription data or data supplied by the LCS client.\n2)\tIf the R-GMLC already knows IMSI for the particular MSISDN, (e.g. from a previous location request) and the VMSC/MSC server address, SGSN address or MME address, this step and step 3 may be skipped. Otherwise, the R-GMLC sends a SEND_ROUTING_INFO_FOR_LCS message to the home HLR/HSS of the target UE to be located with the IMSI or MSISDN of this UE.\n3)\tThe HLR/HSS verifies whether the R-GMLC is authorized to request UE location information. If not, an error response is returned.Otherwise the HLR/HSS returns one or several of the network addresses of the current SGSN and/or VMSC/MSC server and/or current MME and whichever of the IMSI and MSISDN that was not provided in step 2. The HLR/HSS also returns the address of the V-GMLC associated with the serving nodes, if available.\nNOTE 1:\tHLR/HSS may prioritise between the MSC/VLR, SGSN or MME address sent to the GMLC. The prioritisation might be based on information received from SGSN and/or MSC/VLR and/or MME concerning the UE's capabilities for LCS. Other priority criteria are for further study.\nNOTE 2:\tIf ISR is active for LTE access, the HSS may return the address of both the current MME and current SGSN.\n4)\tIn the cases when the R-GMLC did not receive the address of the V-GMLC, or when the V-GMLC address is the same as the R-GMLC address, or when both PLMN operators agree not to use the Lr interface, the R-GMLC does not send the location request to the V-GMLC and the step 6 is skipped. In this case, the R-GMLC sends the location service request message directly to the serving node.If the R-GMLC received the address of the V-GMLC from the HLR/HSS and the V-GMLC address is different from the R-GMLC address, the R-GMLC sends the location request to the V-GMLC. The location request shall contain one or several of the network addresses of the current SGSN and/or MSC/VLR, the IMSI and MSISDN of the target UE and the privacy override indicator. The V-GMLC first authenticates that the location request is allowed from this GMLC, PLMN or from this country. If not, the positioning request is rejected and an error response is returned. Otherwise, it sets the privacy indicator to \"not allowed\" and includes it with the POI in the Provide Subscriber Location message.\n5)\tIf the GMLC receives only the MSC/VLR address, the MT LR proceeds as the CS-MT-LR procedure described in clause 9.1.2. If the GMLC receives only the SGSN address, the MT LR proceeds as the PS-MT-LR procedure described in clause 9.1.6. If the GMLC receives only the MME address, the MT LR proceeds as the EPC-MT-LR procedure described in clause 9.1.15. If the GMLC receives several of the following addresses, SGSN, VMSC, MSC Server and/or MME, it has to decide where to send the location request. In any case the serving node checks for POI applicability.\nNOTE:\tThe order in which these procedures are invoked and whether one or both procedures are used may depend on information in the LCS service request, subscription information for the LCS client, possible priority information returned by the HLR/HSS or information already stored in the GMLC (e.g. obtained from previous location requests).\n6)\tThe V-GMLC sends the location service response to the R-GMLC. The location service response may contain the information about the positioning method used. The V-GMLC may record charging information.\n7)\tR-GMLC sends the location service response to the LCS client. If the LCS client requires it, the R-GMLC may first transform the universal location co-ordinates provided by the SGSN or MSC/MSC server into some local geographic system. The location service response from the GMLC to the LCS client may contain the information about the positioning method used. After receiving (stage 3) acknowledgement from the LCS client, the R-GMLC may record charging information both for the LCS client and inter-network revenue charges from the SGSN or MSC/MSC server's network.\nThe detailed CS-MT-LR, PS-MT-LR and EPC-MT-LR procedures in step 5 of figure 9.1A are described in clauses 9.1.2, 9.1.6 and 9.1.15.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.1.3",
        "clause_9.1.12",
        "clause_9.1.1.1",
        "clause_9.5.4",
        "clause_5.7",
        "clause_9.1.2",
        "clause_9.1.6",
        "clause_9.1.15",
        "clause_9.1.10",
        "clause_9.1.11",
        "clause_9.1.18",
        "clause_9.1.8",
        "figure_9.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.1.1",
      "section_id": "9.1.1.1",
      "section_title": "LCS Authorisation request",
      "content": "If the UE subscribers LCS privacy information is kept in the PPR the GMLC (H-GMLC) shall send a LCS Authorisation request to PPR, see figure 9.1B.\nFigure 9.1B: LCS authorisation in PPR\n1)\tThe GMLC sends the LCS authorisation request to the PPR. The LCS authorisation request carries the type of location information requested (e.g. current location), the LCS client type, the UE subscriber's identity and indication whether the request is call/session related or call/session unrelated. The UE subscriber's identity can be one or both of MSISDN and IMSI. If PMD functionality is integrated in PPR, the LCS authorization request may carry the pseudonym of the target UE, instead of the verinym. In case GMLC received the LCS client's called party number or the APN-NI of the target mobile's session, GMLC shall request both call/session related and call/session unrelated privacy checks in PPR. In case GMLC did not receive the LCS client's called party number or the APN-NI of the target mobile's session, GMLC requests only a call/session unrelated privacy check in PPR. For a value added LCS client, the message shall carry the client's name, the external identity of the LCS client and the requestor identity (if that is both supported and available). Moreover the message may also carry the Service Type and the Codeword. This message shall also carry the LCS capabilities of the SGSN or VMSC/MSC server.\nIn case the additional privacy check was requested to be performed after the positioning procedure the LCS Authorisation Request shall also include the location estimate.\n2)\tIf the LCS authorization request contains the pseudonym of the target UE, the PPR with PMD functionality seeks to determine the verinym of the target UE. PPR performs the privacy check based on the target UE's privacy profile. The result of that privacy check is sent to GMLC in the LCS Authorisation response. If the location request is to be barred, the PPR shall send an indication of this within the LCS Authorisation response and no other indicators. If requested by the GMLC the PPR shall include two privacy check results for the LCS Authorisation response, both call/session related and call/session unrelated privacy check results. The response may also contain information if an additional privacy check is needed when the GMLC has received the location information of the target UE (e.g. if the target UE allows its location information to be given to the LCS client only when it is located in certain areas).\nIf the LCS authorisation request contains the pseudonym of the target UE and the PPR has integrated PMD functionality, the PPR shall return the target UE's IMSI and/or MSISDN corresponding to the pseudonym in the LCS authorisation response.\nIf PPR received information that the visited MSC/SGSN is pre Rel-6 it shall select a pseudo external ID which shall carry the response of the privacy check. For more information on pseudo external Ids, see Annex C.",
      "chunk_type": "requirement",
      "cross_references": [
        "figure_9.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.1.2",
      "section_id": "9.1.1.2",
      "section_title": "LCS Privacy Profile Update",
      "content": "If the UE subscribers privacy information has been changed in the PPR the LCS Privacy Profile Update shall be send to the GMLC (H-GMLC), see figure 9.1C.\nFigure 9.1C: PPR notification to GMLC about LCS privacy profile change\n1)\tIn case subscriber changed his privacy profile information in the PPR the LCS Privacy Profile Update shall be send to the GMLC (H-GMLC). The message shall carry the identity of the UE subscriber.\n2)\tGMLC acknowledges that it received the notification",
      "chunk_type": "requirement",
      "cross_references": [
        "figure_9.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.1.3",
      "section_id": "9.1.1.3",
      "section_title": "LCS identity request",
      "content": "The GMLC may request the verinym of the UE from the PMD, see figure 9.1D.\nFigure 9.1D: LCS identity request\n1)\tThe GMLC sends the pseudonym to its associated PMD and requests the corresponding verinym of the target UE from PMD.\n2)\tThe PMD shall map or decrypt (e.g. using the private key of the operator) the target UE's pseudonym to the corresponding verinym, i.e. IMSI and /or MSISDN, to be included in the Identity Response.",
      "chunk_type": "general",
      "cross_references": [
        "figure_9.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.2",
      "section_id": "9.1.2",
      "section_title": "Circuit Switched Mobile Terminating Location Request (CS-MT-LR)",
      "content": "Figure 9.2 illustrates general network positioning for LCS clients external to the PLMN. In this scenario, it is assumed that the target UE is identified using either an MSISDN or IMSI.\nFigure 9.2: Network Positioning for a CS-MT-LR",
      "chunk_type": "general",
      "cross_references": [
        "figure_9.2"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.2.1",
      "section_id": "9.1.2.1",
      "section_title": "Location Preparation Procedure",
      "content": "1)\tCommon PS and CS MT-LR procedure as described in clause 9.1.1.\n2)\tThe GMLC sends a PROVIDE_ SUBSCRIBER _LOCATION message to the MSC/MSC server indicated by the HLR/HSS. This message carries the type of location information requested (e.g. current location and optionally, velocity), the UE subscriber's IMSI, LCS QoS information (e.g. accuracy, response time) and an indication of whether the LCS client has the override capability. For a call related location request, the message also carries the LCS client's called party number. For a value added LCS client, the message shall carry the client name, the external identity of the LCS client (or the pseudo external identity) and the Requestor Identity (if that is both supported and available). Also the message may carry the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. For a PLMN operator LCS client, the message shall carry the internal identity of the LCS client. Moreover the message may also carry the Service Type. If the result of the privacy check at H-GMLC/PPR indicated that the codeword shall be sent to the UE user, the message may carry also the codeword received from the LCS client. For a PLMN operator LCS client, the message shall carry the internal identity of the LCS client. If the Requestor Identity is provided, the GMLC shall send it as separate information. In addition, in order to display the requestor identity in case of pre rel-5 network elements (i.e. MSC and/or UE), the requestor identity may be also added to the LCS client name by the GMLC. When the Requestor identity is added to the LCS client name the practise described in the Annex D should be followed. The message also shall carry the indicators of privacy related action which is described in clause 9.5.4 , if it is provided by H-GMLC.\n3)\tIf the GMLC is located in another PLMN or another country, the VMSC/MSC server first authenticates that a location request is allowed from this PLMN or from this country. If not, an error response is returned. If the PSL message from the GMLC contains the indicators of privacy related action, the VMSC/MSC server determines a required privacy related action as described in Annex A.3. If the PSL message from the GMLC does not include the indicators of privacy related action, the VMSC/MSC server then verifies LCS barring restrictions in the UE user's subscription profile in the MSC server. In verifying the barring restrictions, barring of the whole location request is assumed if any part of it is barred or any requisite condition is not satisfied. If LCS is to be barred without notifying the target UE and a LCS client accessing a GMLC in the same country does not have the override capability, an error response is returned to the GMLC.Otherwise, if the UE is in idle mode, the Core Network performs paging, authentication and ciphering. The MSC will page a GPRS attached UE either through A/Iu or Gs interface, depending on the presence of the Gs interface (see Note 2). The UE will inform the network about its LCS capabilities, as described in clause 6.3.4. If the UE is instead in dedicated mode, the VMSC/MSC server will already have UE classmark information. In GSM this is supported by controlled early classmark sending.\nNOTE 1:\tIn GSM, if the target UE has an established circuit call other than speech, the location request may be denied and an error response is then returned to the GMLC. If the location request is allowed for a non-speech circuit call, it shall be up to RAN to decide, on the basis of the applicable position methods and requested QoS, whether positioning is possible.\nNOTE 2:\tIn some network mode of operation, a GPRS capable UE may not receive the CS paging. In addition, upon receipt of a CS paging, a GPRS capable UE may immediately answer to the Paging Request or delay the answer, as defined in TS 22.060 [35b] and TS 23.060 [15]. A GPRS UE in class B mode may also suspend its GPRS traffic, sending a GPRS Suspension Request to the network.\n4)\tIf the location request comes from a value added LCS client and the indication of requested privacy related action or the UE subscription profile indicates that the UE must either be notified or notified with privacy verification and the UE supports notification of LCS (according to the UE Capability information), an LCS Location Notification Invoke message is sent to the target UE indicating the type of location request from the LCS Client (e.g. current location or \"current or last known location\") and the identity of the LCS client, the Requestor Identity (if that is both supported and available) and whether privacy verification is required. Also the message may indicate the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. Moreover, the message may carry also the service type and the codeword.Optionally, the VMSC/MSC server may, after sending the LCS Location Notification Invoke message continue in parallel the location process, i.e. continue to step 6 without waiting for a LCS Location Notification Return Result message in step 5.\nNOTE 3:\tIt is for further study, if all available client identities are to be included in the Privacy Notification message to be shown to the end-user.\n5)\tThe target UE notifies the UE user of the location request. If privacy verification was requested, the target UE indicates to the UE user whether the location request will be allowed or not allowed in the absence of a response and waits for the user to grant or withhold permission. The UE then returns an LCS Location Notification Return Result to the VMSC/MSC server indicating, if privacy verification was requested, whether permission is granted or denied. Optionally, the LCS Location Notification Return Result message can be returned some time after step 4, but before step 9. If the UE user does not respond after a predetermined time period, the VMSC/MSC server shall infer a \"no response\" condition. The VMSC/MSC server shall return an error response to the GMLC if privacy verification was requested and either the UE user denies permission or there is no response with the UE subscription profile indicating barring of the location request in the absence of a response.\n6)\tThe MSC/MSC server sends a Location Request message to RAN. This message includes the type of location information requested and requested QoS and, in GSM, the UE's location capabilities.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.1",
        "clause_9.5.4",
        "clause_6.3.4",
        "ts_22.060",
        "ts_23.060"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.2.2",
      "section_id": "9.1.2.2",
      "section_title": "Positioning Measurement Establishment Procedure",
      "content": "7)\tRAN determines the positioning method and instigates the particular message sequence for this method, as specified in UTRAN Stage 2, TS 25.305 [1] and GERAN Stage 2, TS 43.059 [16].",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.2.3",
      "section_id": "9.1.2.3",
      "section_title": "Location Calculation and Release Procedure",
      "content": "8)\tWhen a location estimate best satisfying the requested QoS has been obtained, RAN returns it to the MSC/MSC server in a Location Report message. RAN shall in its response include an indication whether the obtained location estimate satisfies the requested accuracy or not. The information about the positioning method used may be returned with the location estimate. If a location estimate could not be obtained, RAN returns a Location Report message containing a failure cause and no location estimate.\n9)\tThe MSC/MSC server returns the location information, its age and obtained accuracy indication to the GMLC, if the VMSC/MSC server has not initiated the Privacy Verification process in step 4. If step 4 has been performed for privacy verification, the VMSC/MSC server returns the location information only, if it has received a LCS Location Notification Return Result indicating that permission is granted. In these cases, the information about the positioning method used may be sent with the location information. If a LCS Location Notification Return Result message indicating that permission is not granted is received, or there is no response, with the requested privacy action or the UE subscription profile indicating barring of location in the absence of a response, the VMSC/MSC server shall return an error response to the GMLC. If RAN did not return a successful location estimate, but the privacy checks in steps 4 - 5 were successfully executed, the VMSC/MSC server may return the last known location of the target UE if this is known and the LCS client is requesting the current or last known location. The MSC/MSC server may then release the Mobility Management connection to the UE, if the UE was previously idle, and the MSC/MSC server may record charging information.\n10)\tCommon MT-LR procedure in PS and CS domain as described in clause 9.1.1.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.3",
      "section_id": "9.1.3",
      "section_title": "CS-MT-LR without HLR Query",
      "content": "Figure 9.3 illustrates current or last known location requests for an emergency services call, where an emergency services client (i.e., a Public Safety Answering Point) identifies the target UE and the serving GMLC using correlation information that were previously provided to it by the VMSC. In North America, this correlation information is provided by either an NA-ESRK, or an MSISDN and NA-ESRD. In E.U. it is provided through the ISUP/BICC IAM message with location number parameter set to MSC number and the calling party number parameter set to MSISDN. The signalling used to provide the correlation information to the PSAP is out of scope of this TS, but is presumed to occur on the signalling for the call. This allows the requesting V-GMLC to request location from the VMSC without first querying the home HLR of the target UE. This scenario therefore supports location of emergency callers from roamers or SIM-less emergency calls, or non-registered (U)SIM emergency calls, and requires that the initial location, as well as UE and VMSC identifying information had been pushed to the GMLC as per 9.1.5 (or 9.1.5.A for North America). In North America, additional requirements are found in [32].\nFigure 9.3: Positioning for a Emergency Services MT-LR without HLR Query\n1)\tSame as step 1 in figure 9.1 but with the LCS client (PSAP) identifying first the target UE and the serving V-GMLC by previously supplied correlation information for the emergency call.\n2)\tThe GMLC may determine the VMSC from correlation information received from the PSAP, or from stored information for the target UE (e.g. from a prior location estimate delivery from the VMSC/MSC server). In North America, the GMLC determines the VMSC using the NA-ESRK or NA-ESRD - with use of the NA-ESRK taking priority over that of the NA‑ESRD. The MAP_PROVIDE_SUBSCRIBER_LOCATION message sent to the VMSC carries the MSISDN and, if provided, the IMSI and IMEI for the target UE, as well as the required QoS and an indication of a location request from an emergency services client. The VMSC identifies the target UE using the IMSI or MSISDN and, if provided, the IMEI. In case of a SIM-less emergency call, or non-registered (U)SIM emergency call, the IMEI shall be always sent and the MSISDN may be populated with a non-dialable callback number as specified in clause 6.4.3.\n3)\tThe MSC verifies that UE privacy is overridden by the emergency services provider and that positioning is not prevented for other reasons (e.g. unreachable UE, inapplicable call type to the UE). The VMSC then sends a Location Request to the RAN, as for a normal MT-LR.\n4)\tRAN performs positioning as for a normal CS-MT-LR.\n5)\tRAN returns a location estimate to the VMSC as for a normal CS-MT-LR.\n6)\tSame as step 9 for a normal CS-MT-LR.\n7)\tSame as step 10 for a normal CS-MT-LR.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.4.3",
        "figure_9.3",
        "figure_9.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.4",
      "section_id": "9.1.4",
      "section_title": "CS-MT-LR and PS-MT-LR for a previously obtained location estimate",
      "content": "Every time the location estimate of a target UE subscriber is returned by the RAN to the VMSC, MSC Server or SGSN, the corresponding entity may store the location estimate together with a time stamp. The MSC/MSC server may store this information in the subscriber's MSC server record. Also when the location estimate of a target UE subscriber is returned to the H-GMLC, the H-GMLC may store the location estimate together with the age in the subscriber's record.\nThe time stamp is the time at which the location estimate is stored at the corresponding entity i.e. after the RAN returns the location estimate to the VMSC, MSC Server or SGSN. The time stamp indicates the \"age\" of the location estimate.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.4.1",
      "section_id": "9.1.4.1",
      "section_title": "Initial Location",
      "content": "In the context of an originating emergency call the location estimate and the associated time stamp at the commencement of the call set-up is referred to as \"initial location\".",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.4.2",
      "section_id": "9.1.4.2",
      "section_title": "Current Location",
      "content": "After a location attempt has successfully delivered a location estimate and its associated time stamp, the location estimate and time stamp is referred to as the \"current location\" at that point in time.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.4.3",
      "section_id": "9.1.4.3",
      "section_title": "Last known Location",
      "content": "Depending on national regulations, the current location estimate and its associated time stamp may be stored in MSC/VLR, MSC Server, SGSN, or in H-GMLC and until replaced by a later location estimate and a new time stamp is referred to as the \"last known location\". The last known location may be distinct from the initial location - i.e. more recent.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.4.4",
      "section_id": "9.1.4.4",
      "section_title": "Security and Privacy",
      "content": "The collection and/or the release of the last known and initial location estimate of the target UE may not be allowed by national option. The handling of security and privacy of the target UE with regard to returning the last known or initial location estimate of the target UE shall be the same as when the target UE is reachable for positioning. (i.e. the requesting LCS client is authorized and the privacy of the target UE is secured before the VMSC/MSC server check the MSC server status of the target UE (i.e. whether the UE is marked as attached or detached in the MSC server). A similar status check apply for SGSN and MSC Server.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.4.5",
      "section_id": "9.1.4.5",
      "section_title": "Failing to locate the target UE",
      "content": "In case of a \"Detached\" or \"Not Reachable\" target UE, the last known location and a time stamp stored at the VLR, MSC Server or SGSN, may be returned to a LCS client requesting location information if the LCS client specifically requested the current or last known location. This does not apply to a value added LCS client where the target UE subscribes to notification of the location request: if the notification cannot be performed, the VMSC, MSC Server or SGSN shall reject the location request.\nNOTE:\tDue to CAMEL, the MSC/MSC server/VLR may already be storing other location information parameters like location number, service area identity and MSC server number in the subscriber's MSC server record.\nWhen a request for location information is received at the VMSC, MSC Server or SGSN, the request shall indicate whether the \"last known location of the target UE\" should be returned in case of a \"detached\" or \"not reachable\" target UE.\nIf the VLR, MSC Server or SGSN has a valid copy of the subscriber's permanent data and the target UE's privacy settings are such that positioning is allowed, then the following two cases can occur.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.4.5.1",
      "section_id": "9.1.4.5.1",
      "section_title": "Target UE is \"Not Reachable\"",
      "content": "If the target UE is marked as \"attached\" in the VLR, MSC Server or SGSN, the corresponding entity orders paging of the target UE. If paging fails, due to target UE being \"not reachable\" then the corresponding VMSC, MSC Server or SGSN shall check whether the LCS client has requested \"last known location\" in case of \"not reachable\" target UE.\nIf such a request exists and notification to the target UE does not apply for a value added LCS client, the VMSC, MSC Server or SGSN shall include the last known location together with the time stamp available in its response to the request for location information.\nAn indicator of \"last known location\" returned shall be marked at the CDR at VMSC, MSC Server or SGSN correspondingly.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.4.5.2",
      "section_id": "9.1.4.5.2",
      "section_title": "Target UE is \"Detached\"",
      "content": "If the target UE is marked as \"detached\" in the VLR, MSC Server or SGSN, the corresponding entity shall check whether the LCS client has requested \"last known location\" in case of \"detached\" target UE.\nIf such a request exists and notification to the target UE does not apply for a value added LCS client, the VMSC, MSC Server or SGSN includes the \"last known location\" together with the time stamp available in its response to the request for location information.\nAn indicator of \"last known location\" returned shall be marked at the CDR at VMSC, MSC Server or SGSN.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.4.5.3",
      "section_id": "9.1.4.5.3",
      "section_title": "Target UE is Reachable but Positioning Fails",
      "content": "If the target UE is reachable (e.g. paging succeeds), but the VMSC, MSC Server or SGSN is unable to obtain a current location estimate, then the corresponding entity shall check whether the LCS client has requested \"last known location\".\nIf such a request exists and notification to the target UE either does not apply or was successfully executed for a value added LCS client, the VMSC, MSC Server or SGSN includes the \"last known location\" together with the time stamp available in its response to the request for location information. An indicator of \"last known location\" returned shall be marked at the CDR at VMSC.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.4.5.4",
      "section_id": "9.1.4.5.4",
      "section_title": "MSC Server or SGSN Target UE is \"Purged\"",
      "content": "If the target UE is marked as \"Purged\" in HLR/HSS, then an indication \"Absent Subscriber\" is returned to the GMLC.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.5",
      "section_id": "9.1.5",
      "section_title": "Network Induced Location Request (NI-LR)",
      "content": "Figure 9.4 illustrates how the initial position for an emergency service call is determined when the subscriber initiates the emergency call.\nFigure 9.4: Positioning for a NI-LR Emergency Service Call",
      "chunk_type": "general",
      "cross_references": [
        "figure_9.4"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.5.1",
      "section_id": "9.1.5.1",
      "section_title": "Location Preparation Procedure",
      "content": "1)\tAn initially idle UE requests radio connection setup indicating a request for an Emergency Service call to the VMSC/MSC server via RAN.\n2)\tRAN shall convey the CM service request to the core network. (Before having a CM connection there must be a radio connection.) The UE may identify itself using a TMSI, IMSI or IMEI.\n3)\tThe emergency call procedure is applied. The VMSC/MSC server determines based on the serving cell the appropriate emergency services client. The VMSC/MSC server, RAN and UE continue the normal procedure for emergency call origination towards that emergency services client. Depending on local regulatory requirements, the sending of call setup information into the PSTN may be delayed until either the UE's location has been obtained or the location attempt has failed or a PLMN defined timer has expired before location was obtained. If the serving cell serves an area that contains the service domain of multiple emergency services clients, the VMSC/MSC server may delay call setup and invoke location based routing procedures described in clause 9.1.5A. Call setup information sent into the PSTN may include the UE location (if already obtained) plus information that will enable the emergency service provider to request UE location at a later time (e.g. NA-ESRD or NA-ESRK in North America, or the ISUP/BICC IAM message with location number parameter set to MSC number and the calling party parameter set to MSISDN, in E.U.).\n4)\tAt any time after step 2, the VMSC/MSC server may initiate procedures to obtain the UE's location and optionally, velocity. These procedures may run in parallel with the emergency call origination. The VMSC/MSC server sends a Location Request message to RAN associated with the UE's current location area (see step 6 for a MT-LR). This message includes the QoS required for an emergency call.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.5"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.5.2",
      "section_id": "9.1.5.2",
      "section_title": "Positioning Measurement Establishment Procedure",
      "content": "5)\tRAN determines the positioning method and instigates the particular message sequence for this method, as specified in UTRAN Stage 2, TS 25.305 [1] and GERAN Stage 2, TS 43.059 [16].",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.5.3",
      "section_id": "9.1.5.3",
      "section_title": "Location Calculation and Release Procedure",
      "content": "6)\tWhen a location estimate best satisfying the requested QoS has been obtained, RAN returns it to the VMSC/MSC server in a Location Report. As a national option, Cell ID positioning accuracy is allowed. RAN shall in its response include an indication whether the obtained location estimate satisfies the requested accuracy or not. The information of the positioning method used may be returned with the location estimate. If a location estimate could not be obtained, the RAN returns a location response containing a failure cause and no location estimate.\n7)\tDepending on local regulatory requirements, the VMSC/MSC server may send a MAP Subscriber Location report to a GMLC associated with the emergency services provider to which the emergency call has been or will be sent. This message shall carry any location estimate returned in step 6 including the indication received from RAN whether the obtained location estimate satisfies the requested accuracy or not, the age of this estimate and may carry the MSISDN, IMSI and IMEI of the calling UE, the information about the positioning method used and the serving cell identity or SAI of the UE. In case of a SIM-less emergency call, or a non-registered (U)SIM emergency call, the IMEI shall be always sent and the MSISDN may be populated with a non-dialable callback number as specified in clause 6.4.3. In North America, any NA-ESRD and any NA-ESRK that may have been assigned by the VMSC/MSC server shall be included. In the E.U. the VMSC/MSC Server shall provide the identity of the PSAP to which the emergency call was connected. The message shall also indicate the event that triggered the location report. If location failed (i.e. an error result was returned by RAN in step 6), an indication of failure rather than a location estimate may be sent to the GMLC: the indication of failure is conveyed by not including a location estimate in the MAP Subscriber Location Report. The MSC/MSC server may record charging information.\n8)\tThe GMLC acknowledges receipt of the location information. The GMLC shall store the location information for later retrieval by the emergency services LCS client.\n9)\tThe GMLC may optionally forward the information received in step 8 to the emergency services LCS client. The GMLC may also record charging information. The client is expected to obtain the location information by requesting it from the GMLC. The information about the positioning method used may be sent with the location information from the GMLC to the LCS client.\n10)\tAt some later time, the emergency services call is released.\n11)\tThe MSC/MSC server sends another MAP Subscriber Location Report to the GMLC. This message may include the same parameters as before except that there is no position estimate and an indication of emergency call termination is included.\n12)\tThe GMLC acknowledges the MSC/MSC server notification and may then delete all information previously stored for the emergency call per national regulation.\n9.1.5A\tNI-LR using Location Based Routing – applicable to North American Emergency Calls only\nFigure 9.4A illustrates positioning for an emergency service call using location based routing.\nFigure 9.4A: Positioning for a NI-LR Emergency Service Call using Location Based Routing\n9.1.5A.1\tLocation Preparation Procedure\n1)\tAn initially idle UE requests radio connection setup indicating a request for an Emergency Service call to the VMSC/MSC server via RAN.\n2)\tRAN shall convey the CM service request to the core network. (Before having a CM connection there must be a radio connection.) The UE may identify itself using a TMSI, IMSI or IMEI.\n3)\tThe VMSC/MSC server determines that the serving cell serves an area that contains portions of multiple emergency services zones. Therefore, the VMSC/MSC server delays call setup and initiates procedures to obtain the UE's location for routing the emergency call to the emergency services LCS client. The VMSC/MSC server sends a Location Request message to RAN associated with the UE's current location area. This message includes the type of location information requested, the UE's location capabilities and a QoS with low delay and low horizontal accuracy.\n9.1.5A.2\tPositioning Measurement Establishment Procedure\n4)\tRAN determines the positioning method and instigates the particular message sequence for this method, as specified in UTRAN Stage 2, TS 25.305 [1] and GERAN Stage 2, TS 43.059 [16].\n9.1.5A.3\tLocation Calculation and Release Procedure\n5)\tWhen a location estimate best satisfying the requested QoS has been obtained, RAN returns it to the VMSC/MSC server. If a location estimate could not be obtained, the RAN returns a location response containing a failure cause and no location estimate. If a failure is received, the VMSC/MSC server initiates emergency call setup using the normal NI-LR procedures.\n6)\tThe VMSC/MSC server sends a MAP Subscriber Location Report to a GMLC associated with the emergency services provider to which the emergency call will be sent. This message shall carry any location estimate returned in step 5, the age of this estimate and may carry the MSISDN, IMSI, IMEI of the calling UE, the information about the positioning method used and the serving cell identity or SAI of the UE. In case of a SIM-less emergency call, or a non-registered (U)SIM emergency call, the IMEI shall be always sent and the MSISDN shall be populated with a non-dialable callback number as specified in clause 6.4.3. The message shall also indicate the event that triggered the location report. Any NA-ESRD and NA-ESRK that was assigned by the VMSC/MSC server shall be included. The message shall also include an indication that the VMSC/MSC server supports the capability to replace an NA-ESRK or NA-ESRD value with the one assigned by the GMLC. The VMSC/MSC server and GMLC may record charging information.\n7)\tThe GMLC translates the location estimate into a zone identity and assigns either a NA-ESRK or a NA-ESRD, which was requested by the VMSC/MSC server. The GMLC shall include either the NA-ESRK value or the NA-ESRD value in the MAP Subscriber Location Report ack and send it to the VMSC/MSC server. The GMLC stores either the assigned NA-ESRD or the assigned NA- ESRK and any NA-ESRD that was sent by the VMSC/MSC server in step 6.\n9.1.5A.4\tLocation Preparation Procedure\n8)\tThe emergency call procedure is applied. The VMSC/MSC server, RAN and UE continue the normal procedure for emergency call origination towards the appropriate emergency services client. Call setup information sent into the PSTN may include the UE location plus information that will enable the emergency service provider to request UE location at a later time (NA-ESRD or NA-ESRK in North America). The NA-ESRK or NA-ESRD used shall be the one received from the GMLC. If a NA-ESRK or NA-ESRD is not received from the GMLC then the VMSC/MSC server shall employ default routing for the call using a default NA-ESRK, default NA-ESRD or other default number as in clause 9.1.5.1 step 3.\n9) At any time after step 8, the emergency services LCS client may request location information.\n10)\tAt any time after step 6, the GMLC may send a MAP Provide Subscriber Location message to the VMSC/MSC server. This message includes a QoS with higher delay and higher horizontal accuracy required for an emergency call. In case of a SIM-less emergency call, or a non-registered (U)SIM emergency call, the IMEI shall be included in the message.\nIf the GMLC is capable of determining whether the initial location satisfies the higher accuracy requirements for an emergency call, then the GMLC may not need to request for a higher accuracy location.\n11)\tThe VMSC/MSC server sends a Location Request message to RAN. This message includes the type of location information requested, the UE's location capabilities and requested higher accuracy QoS.\n9.1.5A.5\tPositioning Measurement Establishment Procedure\n12)\tsame as step 4.\n9.1.5A.6\tLocation Calculation and Release Procedure\n13)\tsame as step 5.\n14)\tThe VMSC/MSC server returns the location information and its age, the information about the positioning method used and the serving cell identity or SAI of the UE to the GMLC. The GMLC shall replace the previously stored low accuracy location information with the higher accuracy information for later retrieval by the emergency services LCS client. The VMSC/MSC server and GMLC may record charging information.\n15)\tThe GMLC may forward the information received in the previous step to the emergency services LCS client. The client is expected to have requested this information from GMLC before. The information about the positioning method used may be sent with this location information from the GMLC to the LCS client.\n16)\tsame as step 10 for normal NI-LR.\n17) same as step 11 for normal NI-LR.\n18) same as step 12 for normal NI-LR.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.4.3",
        "clause_9.1.5.1",
        "figure_9.4",
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.6",
      "section_id": "9.1.6",
      "section_title": "Packet Switched Mobile Terminating Location Request(PS-MT-LR)",
      "content": "Figure 9.5 illustrates the general network positioning for LCS clients external to the PLMN for packet switched services. In this scenario, it is assumed that the target UE is identified using an MSISDN or IMSI.\nFigure 9.5: General Network Positioning for Packet Switched MT-LR",
      "chunk_type": "general",
      "cross_references": [
        "figure_9.5"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.6.1",
      "section_id": "9.1.6.1",
      "section_title": "Location Preparation Procedure",
      "content": "1)\tCommon PS and CS MT-LR procedure as described in clause 9.1.1.\n2)\tGMLC sends a Provide Subscriber Location message to the SGSN indicated by the HLR/HSS. This message carries the type of location information requested (e.g. current location and optionally, velocity), the UE subscriber's IMSI, LCS QoS information (e.g. accuracy, response time) and an indication of whether the LCS client has the override capability. For a session related location request, the message also carries the APN-NI to which the user has established the session. For a value added LCS client, the message shall carry the client name, the external identity of the LCS client (or the pseudo external identity) and the Requestor Identity (if that is both supported and available), optionally the message may also carry the Service Type. Also the message may carry the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. If the result of the privacy check at H-GMLC/PPR indicated that the codeword shall be sent to the UE user, the message may carry also the codeword received from the LCS client. For a PLMN operator LCS client, the message shall carry the internal identity of the LCS client. If the Requestor Identity is provided, the GMLC shall send it as separate information. In addition, in order to display the requestor identity in case of pre rel-5 network elements (i.e. SGSN and/or UE), the requestor identity may be also added to the LCS client name by the GMLC. When the Requestor identity is added to the LCS client name the practise described in the Annex D should be followed. The message also shall carry the indicators of privacy related action which is described in clause 9.5.4 , if it is provided by H-GMLC. If the GMLC supports delayed location reporting for UEs transiently not reachable (i.e because they are in extended idle mode DRX or PSM), this shall be indicated in this message.\n2a)\tIf the UE for which the request in step 2 is related is transiently not reachable and the GMLC supports delayed location reporting for UEs transiently not reachable as indicated in step 2, the SGSN sends a Provide Subscriber Location ack and a \"UE transiently not reachable\" indication. In this case step 10a and 10b are executed instead of step 10.\n3)\tIf the GMLC is located in another PLMN or another country, the SGSN first authenticates that a location request is allowed from this PLMN or from this country. If not, an error response is returned. If the PSL message from the GMLC includes the indicators of privacy related action, the SGSN determines a required privacy related action as described in Annex A.3. If the PSL message from the GMLC does not include the indicators of privacy related action, the SGSN then verifies LCS barring restrictions in the UE user's subscription profile in the SGSN. In verifying the barring restrictions, barring of the whole location request is assumed if any part of it is barred or any requisite condition is not satisfied. If LCS is to be barred without notifying the target UE and a LCS client accessing a GMLC in the same country does not have the override capability, an error response is returned to the GMLC.Otherwise, if the UE is in idle mode, the SGSN performs paging. The paging procedure is defined in TS 23.060 [15].\n4)\tSecurity functions may be executed. These procedures are defined in TS 23.060 [15].\n5)\tIf the location request comes from a value added LCS client and the indicators of privacy related action or the UE subscription profile indicates that the UE must either be notified or notified with privacy verification and the UE supports notification of LCS, a notification invoke message is sent to the target UE indicating the type of location request from the LCS Client (e.g. current location or \"current or last known location\") and the identity of the LCS client and the Requestor Identity (if that is both supported and available), whether privacy verification is required. Also the message may indicate the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. Moreover, the message may carry also the service type and the codeword. Optionally, the SGSN may after sending the LCS Location Notification Invoke message continue in parallel the location process, i.e. continue to step 7 without waiting for a LCS Location Notification Return Result message in step 6.\n6)\tThe target UE notifies the UE user of the location request and, if privacy verification was requested, waits for the user to grant or withhold permission. The UE then returns a notification result to the SGSN indicating, if privacy verification was requested, whether permission is granted or denied. Optionally, this message can be returned some time after step 5, but before step 10. If the UE user does not respond after a predetermined time period, the SGSN shall infer a \"no response\" condition. The SGSN shall return an error response to the GMLC if privacy verification was requested and either the UE user denies permission or there is no response with the UE subscription profile indicating barring of the location request.\n7)\tThe SGSN sends a Location Request message to the RAN. This message includes the type of location information requested, the requested QoS and any other location information received in paging response.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.1",
        "clause_9.5.4",
        "ts_23.060"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.6.2",
      "section_id": "9.1.6.2",
      "section_title": "Positioning Measurement Establishment Procedure",
      "content": "8)\tIf the requested location information and the location accuracy within the QoS can be satisfied based on parameters received from the SGSN and the parameters obtained by the RAN e.g. cell coverage and timing information (i.e. RTT or TA), the RAN may send a Location Report immediately. Otherwise, the RAN determines the positioning method and instigates the particular message sequence for this method in UTRAN Stage 2 TS 25.305 [1] and in GERAN Stage 2 TS 43.059 [16]. If the position method returns position measurements, the RAN uses them to compute a location estimate. If there has been a failure to obtain position measurements, the RAN may use the current cell information and, if available, RTT or TA value to derive an approximate location estimate. If an already computed location estimate is returned for an UE based position method, the RAN may verify consistency with the current cell and, if available, RTT or TA. If the location estimate so obtained does not satisfy the requested accuracy and sufficient response time still remains, the RAN may instigate a further location attempt using the same or a different position method. If a vertical location co‑ordinate is requested but the RAN can only obtain horizontal co-ordinates, these may be returned.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.6.3",
      "section_id": "9.1.6.3",
      "section_title": "Location Calculation and Release Procedure",
      "content": "9)\tWhen location information best satisfying the requested location type and QoS has been obtained, the RAN returns it to the SGSN in a Location Report message. RAN shall in its response include an indication whether the obtained location estimate satisfies the requested accuracy or not. The information of the positioning method used may be returned with the location information. If a location estimate could not be obtained, the RAN returns a Location Report message containing a failure cause and no location estimate.\n10)\tThis step is executed only if Step 2a was not executed. The SGSN returns the location information, its age and obtained accuracy indication to the GMLC, if the SGSN has not initiated the Privacy Verification process in step 5. If step 5 has been performed for privacy verification, the SGSN returns the location information only, if it has received a LCS Location Notification Return Result indicating that permission is granted. In these cases, the information about the positioning method used may be sent with the location information. If a LCS Location Notification Return Result message indicating that permission is not granted is received, or there is no response, with the requested privacy action or the UE subscription profile indicating barring of location, the SGSN shall return an error response to the GMLC. If the SGSN did not return a successful location estimate, but the privacy checks were successfully executed, the SGSN may return the last known location of the target UE if this is known and the LCS client is requesting the current or last known location. The SGSN may record charging information.\n10a)\tThis step is executed only if Step 2a was executed. The SGSN shall send a Subscriber Location Report to the GMLC, and, if these were obtained in steps 7 to 9, the location information, its age and obtained accuracy indication to the GMLC, if the SGSN has not initiated the Privacy Verification process in step 5. If step 5 has been performed for privacy verification, the SGSN returns the location information only, if it has received a LCS Location Notification Return Result indicating that permission is granted. In these cases, the information about the positioning method used may be sent with the location information. If a LCS Location Notification Return Result message indicating that permission is not granted is received, or there is no response, with the requested privacy action or the UE subscription profile indicating barring of location, the SGSN shall send an error indication to the GMLC. If the SGSN did not return a successful location estimate, but the privacy checks were successfully executed, the SGSN may return the last known location of the target UE if this is known and the LCS client is requesting the current or last known location. The SGSN may record charging information. If SGSN relocation happens before location information can be reported, the old SGSN includes an error cause code indicating that it cannot proceed with the request as a result of UE mobility. The GMLC may reiterate then its request towards the new SGSN.\n10b)\tIf step 10a was executed, the GMLC shall acknowledge receipt of the Subscriber Location Report.\n11)\tCommon MT-LR procedure in PS and CS domain as described in clause 9.1.1.\n9.1.6A\tPS-MT-LR without HLR Query\nFigure 9.5A illustrates current or last known location requests for an emergency services call, where an emergency services client (i.e., a Public Safety Answering Point) identifies the target UE and the serving GMLC using correlation information that was previously provided to it by the IMS Core. The signalling used to provide the correlation information to the PSAP is out of scope of this TS, but is presumed to occur on the signalling for the call. The correlation information may be used by the GMLC to retrieve other information previously provided to it by the IMS Core as per TS 23.167 [36a] and/or SGSN as described in clause 9.1.7. This allows the requesting V‑GMLC to request location from the SGSN without first querying the home HLR of the target UE. This scenario therefore supports location of emergency calls from roamers or SIM-less emergency calls, or non-registered (U)SIM emergency calls, and requires that the initial location, as well as UE and SGSN identifying information had been pushed to the GMLC as per clause 9.1.7 or as per TS 23.167 [36a].\nFigure 9.5A: Positioning for a Emergency Services PS-MT-LR without HLR Query\n1)\tSame as step 1 in figure 9.1 but with the LCS client (PSAP) identifying first the target UE and the serving V‑GMLC by previously supplied correlation information for the emergency call.\n2)\tThe GMLC may determine the SGSN by associating the correlation information received from the PSAP with other information received previously from the SGSN using a PS‑NI‑LR and/or from the IMS core. The Provide Subscriber Location request sent to the SGSN carries, if available, the MSISDN or the IMSI and, if available, the IMEI for the target UE, as well as the required QoS and an indication of a location request from an emergency services client. The SGSN identifies the target UE using the IMSI, MSISDN and/or the IMEI. In case of a SIM-less emergency call, or non-registered (U)SIM emergency call, the IMEI shall be always sent.\n3)\tThe SGSN verifies that UE privacy is overridden by the emergency services provider and that positioning is not prevented for other reasons (e.g. unreachable UE). The SGSN then sends a Location Request to the RAN, as for a normal PS‑MT‑LR.\n4)\tRAN performs positioning as for a normal PS‑MT‑LR.\n5)\tRAN returns a location estimate to the SGSN as for a normal PS‑MT‑LR.\n6)\tThe SGSN returns the location information, its age and obtained accuracy indication to the GMLC. The information about the positioning method used may be sent with the location information. If the RAN did not return a successful location estimate, the SGSN may return the last known location of the target UE if this is known and the LCS client is requesting the current or last known location.\n7)\tThe GMLC sends the location service response to the LCS client (PSAP).\nNOTE:\tThe SGSN determined by the GMLC in step 2 must be the current SGSN for the UE. In the event of handover to a new SGSN, this may require updating of the GMLC using the PS‑NI‑LR procedure in clause 9.1.7. Before any handover has occurred, this may require using the cell ID or SAI for the UE provided by the IMS Core.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.1",
        "clause_9.1.7",
        "ts_23.167_clause_9.1.7",
        "figure_9.5",
        "ts_23.167_figure_9.5",
        "figure_9.1",
        "ts_23.167"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.7",
      "section_id": "9.1.7",
      "section_title": "Packet Switched Network Induced Location Request (PS-NI-LR)",
      "content": "At any time after detecting an emergency situation (i.e. after emergency Attach or Service Request for emergency, PDP context activation towards emergency APN), the SGSN may initiate the Packet Switched Network Induced Location Request (PS‑NI‑LR) procedure. At any time after the handover or relocation of an emergency PDP context from an old to a new SGSN, where the old SGSN indicates that a PS‑NI‑LR is still needed, the new SGSN may initiate a PS‑NI‑LR to the GMLC indicated by the old SGSN. At any time after the handover or relocation of an emergency PDP context from an old to a new SGSN, where the old SGSN indicates that a PS‑NI‑LR is not needed but provides a GMLC address, the new SGSN may initiate a PS‑NI‑LR procedure to transfer its address to the GMLC indicated by the old SGSN in order to support a later PS‑MT‑LR. The procedure is illustrated in figure 9.6.\nFigure 9.6: Network Induced Location Request for the PS Domain\n1)\tThe SGSN sends a Location Request message to the RAN. This message indicates the type of location information requested and requested QoS. If the location of the UE is not required (e.g. the SGSN is only sending its address to the GMLC), the SGSN skips both this step and steps 2 and 3.",
      "chunk_type": "general",
      "cross_references": [
        "figure_9.6"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.7.1",
      "section_id": "9.1.7.1",
      "section_title": "Positioning Measurement Establishment Procedure",
      "content": "2)\tIf the requested location information and the location accuracy within the QoS can be satisfied based on parameters received from the SGSN and the parameters obtained by the RAN e.g. cell coverage and timing information (i.e. RTT or TA), the RAN may send a Location Report immediately. Otherwise, the RAN determines the positioning method and instigates the particular message sequence for this method. If the position method returns position measurements, the RAN uses them to compute a location estimate. If there has been a failure to obtain position measurements, the RAN may use the current cell information and, if available, RTT or TA value to derive an approximate location estimate. If an already computed location estimate is returned for an UE based position method, the RAN may verify consistency with the current cell and, if available, RTT or TA value. If the location estimate so obtained does not satisfy the requested accuracy and sufficient response time still remains, the RAN may instigate a further location attempt using the same or a different position method. If a vertical location co-ordinate is requested but the RAN can only obtain horizontal co-ordinates, these may be returned.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.7.2",
      "section_id": "9.1.7.2",
      "section_title": "Location Calculation and Release Procedure",
      "content": "3)\tWhen a location estimate best satisfying the requested QoS has been obtained, the RAN returns a Location Report to the SGSN with an indication whether the obtained location estimate satisfies the requested accuracy or not. This message carries the location estimate that was obtained. If a location estimate was not successfully obtained, a failure cause is included in the Location Report.\n4)\tThe SGSN may determine the GMLC and emergency services client using the SAI or cell identity, the location estimate if obtained or information received from a previous SGSN in the case of SRNS relocation, RAU or handover. The SGSN shall send a Subscriber Location Report to the GMLC carrying the MSISDN of the UE, the identity of the LCS client, the event causing the message (PS‑NI‑LR), and, if these were obtained in steps 1 to 3, the location estimate and its age and the indication received from RAN whether the obtained location estimate satisfies the requested accuracy or not. The serving cell identity or SAI of the UE may also be sent. The SGSN may include its own address. If the UE was not authenticated, the IMEI shall be included. The SGSN may record charging information.\n5)\tThe GMLC shall acknowledge receipt of the location estimate provided that it serves the identified LCS client and the client is accessible.\n6)\tThe GMLC may transfer the location information to the LCS client either immediately or upon request from the client. The GMLC may store the information received in step 4: e.g. may store the UE identity and the address of the SGSN. The GMLC may record charging information.\nNOTE:\tDetermination of the GMLC in step 4 must ensure a match with any GMLC used by the IMS Core to assist with location retrieval for, and/or routing of, the IMS Emergency call.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.8",
      "section_id": "9.1.8",
      "section_title": "Mobile Terminating Deferred Location Request – UE available event",
      "content": "Figure 9.6a illustrates the procedures for a Deferred Location Request, where the Location Report is returned based on a UE available event.\nFigure 9.6a: General Network Positioning for a Deferred MT-LR with UE available event",
      "chunk_type": "general",
      "cross_references": [
        "figure_9.6"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.8.1",
      "section_id": "9.1.8.1",
      "section_title": "Deferred Location Request Procedure",
      "content": "1)\tThe LCS Service Request shall contain an indication of the requested event i.e. UE available.\n2)\tLCS service request handling between GMLCs as described in clause 9.1.1. The information received by the R-GMLC is transferred to the H-GMLC. The H-GMLC assigns a LDR reference number to this LCS Service request and transfers the information to the V-GMLC, including the LDR reference number and the H-GMLC address.\n3)\tThe V-GMLC sends the UE available event to MSC/SGSN in the Provide Subscriber Location request (deferred) and includes the LDR reference number and the H-GMLC address in the request.\nNOTE:\tIt shall be possible to issue the deferred location requests for the UE available event, even in case there is an ongoing previous MT-LR for the same UE.\n4)\tIf the SGSN/MSC cannot support the deferred location request for the specified event (for temporary or permanent reasons), or if either the security or privacy check related actions fail, then a Provide Subscriber Location return error shall be returned with a suitable cause. If the SGSN/MSC can support the deferred location request for the specified event, a Provide Subscriber Location ack. shall be returned to the V-GMLC without a location estimate. The SGSN/MSC may record charging information for an accepted deferred location request.\n5)\tV-GMLC returns the LCS Service Response to H-GMLC to notify whether the request was successfully accepted or not. The V-GMLC may record charging information for an accepted deferred location request.\n6)\tH-GMLC returns the LCS Service Response to R-GMLC to notify whether the request was successfully accepted or not. When the H-GMLC returns the LCS Service Response to the R-GMLC, the LDR reference number assigned by the H-GMLC shall be included. The H-GMLC may record charging information for an accepted deferred location request.\n7)\tThe R-GMLC then returns the LCS Service Response with LDR reference number to the LCS Client to notify whether the request was successfully accepted or not. The R-GMLC may record charging information for an accepted deferred location request.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.8.2",
      "section_id": "9.1.8.2",
      "section_title": "Location Report Procedure",
      "content": "8)\tImmediately following step 3, the SGSN/MSC shall verify if the requested event is already satisfied (e.g. UE available inferred from a current transaction) or can be invoked immediately (e.g. by paging the UE and receiving a page response). If the requested event is not already satisfied, the SGSN/MSC waits until it has occurred or until some maximum time has expired.\nIn case the SGSN/MSC receives an indication that the UE has moved to another SGSN/MSC, while it is waiting for the requested event to happen, SGSN/MSC shall immediately send a Subscriber Location Report to the V-GMLC. The report shall include the reference number and H-GMLC address that were included in the Provide Subscriber Location request and the information that the MT-LR must be reinitiated against the new SGSN/MSC. It shall also include the address of the new SGSN/MSC, if available. If the V-GMLC is associated with the new MSC/SGSN, it re-issues the location request to the new MSC/SGSN. Otherwise the V-GMLC forwards the responses to the H-GMLC. If the H-GMLC already knows (e.g. from a previous location request or an internal lookup table), or is able to determine, (e.g. it is possible to use a DNS lookup mechanism similar to IETF RFC 2916), the network address of the V-GMLC, it reinitiates the MT-LR to the new SGSN/MSC through the new V-GMLC. Otherwise, the H-GMLC shall then issue a SEND_ROUTING_INFO_FOR_LCS message to get the address of the V-GMLC associated with the new SGSN/MSC and reinitiate the MT-LR with the new SGSN/MSC through the new V-GMLC, see step 12.\n9)\tWhen the requested event is detected, the SGSN/MSC shall proceed with the location request as described in clauses 9.1.2/9.1.6. If an LCS Location Notification Invoke message is sent to the target UE as defined in step 4 of clause 9.1.2.1 and step 5 of clause 9.1.6.1, the type of location request shall indicate current location and the deferred location event type shall be omitted.\nIf either security or privacy check related actions fail, the SGSN/MSC shall send a Subscriber Location Report with the reference number and H-GMLC address that was included in the Provide Subscriber Location with appropriate error cause indicating termination of the deferred location request.\n10)\tWhen location information has been obtained from the RAN, the SGSN/MSC returns the Subscriber Location Report. The report shall include the reference number that was included in the Provide Subscriber Location, the H-GMLC address, an indication that this is a response to a previously sent deferred location request and may also include the indication whether the obtained location estimate satisfies the requested accuracy or not (provided that this indication is obtained from RAN with the location estimate). The SGSN/MSC may record charging information.\nIf the location information could not be obtained, or the SGSN/MSC for some other reason decides to not wait any longer for the requested event to occur (ex. timer expires), the Subscriber Location Report with the reference number and H-GMLC address that was included in the Provide Subscriber Location will be returned with an appropriate error cause indicating termination of the deferred location request.\n11)\tV-GMLC sends the LCS Service Response to the H-GMLC with an indication of the event occurrence and the LDR reference number. The LCS Service Response is sent in accordance with the requested QoS Class, as described in clause 9.1.1 for common MT-LR.\n12)\tIn case the LCS Service Response indicates to H-GMLC that the mobile has moved to another SGSN/MSC, the H-GMLC shall send the deferred MT-LR with UE available event to the V-GMLC (previous or new), which forwards the request to the new SGSN/MSC, as described in step 2 onwards.\n13)\tThe H-GMLC performs the privacy check as described in clause 9.1.1.\n14)\tThe H-GMLC sends the LCS Service Response to R-GMLC. When the H-GMLC returns the LCS Service Response to the R-GMLC, the LDR reference number that was sent to the R-GMLC in step 6 shall be included.\n15)\tThe R-GMLC sends the LCS Service Response with the LDR reference number to the LCS Client.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.2.1",
        "clause_9.1.6.1",
        "clause_9.1.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.8.3",
      "section_id": "9.1.8.3",
      "section_title": "Combined Periodical/Deferred Mobile Terminating Location Request with UE available event",
      "content": "Figure 9.6b illustrates the procedures for a Combined Periodical/Deferred Mobile Terminating Location Request with UE available event, where the response to the LCS client is returned periodically and based on the event. This clause is applicable only to the case, when the R‑GMLC handles the periodicity of the location requests. The case when the UE handles the periodicity of location reporting, as specified in clause 9.1.12, is independent of this clause.\nNOTE:\tIn the description below, it is assumed that the LCS client issues the Periodical/Deferred MT-LR with only the location estimate type of \"current location\".\nFigure 9.6b: General Network Positioning for a Combined Periodical/Deferred MT-LR\n1)\tWhen a R-GMLC receives a LCS Service Request from a LCS client, the R-GMLC verifies the identity of the LCS client as described in clause 9.1.1, then the R-GMLC transfers the periodical request to the H-GMLC.\n2)\tThe H-GMLC starts the periodical timer and assigns a LDR reference number for this periodical request, and initiates the common LCS procedures as described in clause 9.1.1.\n3)\tThe V-GMLC sends a Deferred Location Request to the SGSN/MSC by means of Provide Subscriber Location as described in clauses 9.1.2/9.1.6. In addition, the Deferred Location Request includes the reference number assigned by the H-GMLC and the event that shall trigger the sending of Subscriber Location Report.\n4)\tIf the SGSN/MSC cannot support the deferred location request for the specified event or the LCS client is not allowed to position the requested UE according to subscription information, a Provide Subscriber Location error is returned to the V-GMLC. If the SGSN/MSC can support the deferred location request for the specified event and the privacy checks are satisfied, a Provide Subscriber Location ack shall be returned to the V-GMLC without a location estimate. The SGSN/MSC may record charging information for an accepted deferred location request.\n5)\tThe V-GMLC then returns the LCS Service Response to the LCS Client via H-GMLC and R-GMLC to notify whether the request was successfully accepted or not. The V-GMLC, H-GMLC and R-GMLC may record charging information for an accepted deferred location request. When the H-GMLC returns the LCS Service Response to the LCS Client via R-GMLC, the LDR reference number assigned by the H-GMLC shall be included.\n6)\tWhen the periodical timer expires, if the H-GMLC is still waiting for the event, the H-GMLC shall send a LCS Service Response to the LCS client via R-GMLC, indicating that the location is not available at that moment. The LDR reference number that was sent to the LCS Client in step 5 shall be included in the response.\n7)\tWhen the requested event is detected, the SGSN/MSC will proceed with the location request as described in clauses 9.1.2/9.1.6. If an LCS Location Notification Invoke message is sent to the target UE as defined in step 4 of clause 9.1.2.1 and step 5 of clause 9.1.6.1, the type of location request shall indicate current location and the deferred location event type shall be omitted.\n8)\tWhen location information has been obtained from the RAN, the SGSN/MSC returns the Subscriber Location Report. The report shall include the reference number included in the previously sent Provide Subscriber Location and an indication that this is a response to a previously sent deferred location request. The SGSN/MSC may record charging information.\nIf the location information could not be obtained, or the SGSN/MSC for some other reason decides to not wait any longer for the requested event to occur (ex. timer expires), the Subscriber Location Report with the reference number included in the previously sent Provide Subscriber Location will be returned with an appropriate error cause indicating termination of the deferred location request.\n9)\tThe V-GMLC then returns the LCS Service Response to the LCS Client via H-GMLC and R-GMLC as in clauses 9.1.2/9.1.6. When the H-GMLC returns the LCS Service Response to the LCS Client via R-GMLC, the LDR reference number that was sent to the LCS Client in step 5 shall be included.\n10)\tWhen the timer expires, if the H-GMLC is not waiting for the event, the H-GMLC initiates the common LCS procedures as described in clause 9.1.1. The H-GMLC should use the same LDR reference number assigned in the step 2, should NOT assign a new LDR reference number.\n11)\tSame as step 3.\n12)\tSame as step 4.\n13)\tSame as step 5.\n14)\tIf the requested event is already satisfied, the SGSN/MSC will proceed with the location request as described in clauses 9.1.2/9.1.6. If an LCS Location Notification Invoke message is sent to the target UE as defined in step 4 of clause 9.1.2.1 and step 5 of clause 9.1.6.1, the type of location request shall indicate current location and the deferred location event type shall be omitted.\n15)\tSame as step 8.\n16)\tSame as step 9.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.12",
        "clause_9.1.1",
        "clause_9.1.2.1",
        "clause_9.1.6.1",
        "figure_9.6"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.8.4",
      "section_id": "9.1.8.4",
      "section_title": "Cancellation of a Deferred Location Request – UE available event",
      "content": "Figure 9.6c: Cancellation of a Deferred MT-LR – UE available event procedure\n1)\tThe LCS Client requests the cancellation of a previously requested Deferred Location Request. The LDR reference number that was included in the previous LCS Service Response sent by the GMLC shall be included in the request to indicate which outstanding LDR should be cancelled.\n2)\tThe R-GMLC sends the cancellation request to H-GMLC, including the LDR reference number. The cancellation could be initiated by the R-GMLC itself for some reasons (e.g. the expiry of the validity timer specified by the start time and stop time; or the expiry of an implementation dependent timer specified by the Operator as a default value in the R-GMLC when the stop time is undefined or exceeds the maximum allowed value).\n3)\tThe H-GMLC forwards the LCS Cancel Service Request to V-GMLC with the LDR reference number which is received from the R-GMLC, and the H-GMLC address. The H-GMLC may itself initiate the cancellation procedure, e.g. if an implementation dependent timer in the H-GMLC expired, or when the UE's privacy profile stored in the H-GMLC or in the PPR was changed. For every outstanding Deferred Location Request against that UE, the H-GMLC shall perform or ask the PPR to perform a new privacy check based on the updated privacy profile. If the privacy check passes, i.e. the LCS Client is still allowed to position the target UE, the handling of the outstanding Deferred Location Request should be continued. Otherwise, if the privacy check does not pass, i.e. the Location estimate of the target UE is not allowed to be provided to the LCS Client, the H-GMLC shall initiate a cancellation procedure.\nNOTE:\tThe H-GMLC shall know that the UE subscriber's privacy profile has been changed in the PPR when the LCS Privacy Profile Update has been sent from PPR to H-GMLC as described in clause 9.1.1.2.\n4)\tThe V-GMLC will indicate this cancellation request in the Provide Subscriber Location toward the SGSN/MSC. The Provide Subscriber Location shall include the H-GMLC address, and the reference number specified by LCS Client in the LCS Cancel Service Request.\n5)\tWhen the SGSN/MSC completes the cancellation procedure, it notifies it to the V-GMLC in the Provide Subscriber Location Ack (with no location estimate included).\n6)\tThe V-GMLC sends the LCS Cancel Service Response to H-GMLC.\n7)\tH-GMLC sends the LCS Cancel Service Response to R-GMLC. H-GMLC may send the LCS Cancel Service Response to R-GMLC, even if the R-GMLC/LCS client has not requested the cancellation, see step 3.\n8)\tThe R-GMLC sends the LCS Cancel Service Response to the LCS Client.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.1.2",
        "figure_9.6"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.9",
      "section_id": "9.1.9",
      "section_title": "Deferred Location Request Procedure for the change of area event",
      "content": "Figure 9-6d illustrates the procedures for a Deferred Location Request where the Location Report is returned to the network by the UE following a change of area event. An area event occurs when the UE leaves, enters or is within a target area as defined by geographical area, PLMN identity, country code or geopolitical name of the area. Details of the target area are contained in the LCS Service Request message, see clause 5.5.1.\nThe PLMN operator may choose to use another mechanism (such as SIM Application Toolkit) for the transfer and detection mechanism of the Area Definition and change of area event information to the UE. In this case, the GMLCs handle steps 2 to 7 and 11 to 14 differently from that shown below. An alternative mechanism is detailed in Annex F\nFigure 9.6d: Deferred MT-LR procedure for the Area event\n1)\tThe LCS Service Request contains the change of area type deferred location request information, i.e. details of the target area and the nature of the event, whether the event to be reported is the UE being inside, entering into or leaving the target area. The LCS service request may specify the validity time, i.e. start time and stop time, for the deferred location request and R-GMLC may cancel the deferred location request as described in clause 9.1.9.1. In addition, when validity time of a pending area event request in the target UE expires, the UE shall delete the pending deferred location request. The LCS Service Request shall contain an indication of the minimum interval time between area event reports, if applicable. The LCS service request shall contain the information whether the deferred area event may be reported one time only, or several times. If the change of area event is reported one time only, the Location Service request shall be completed after the first area event has occurred. If the target area is expressed by local coordinate system or geopolitical name, the R-GMLC shall convert the target area to geographical area expressed by a shape defined in TS 23.032 [11]. In addition to the target area definition, the LCS Client may include the country code of the target area in the area event request.\n2)\tLCS service request handling between GMLCs as described in clause 9.1.1. The information received by the R-GMLC is transferred to the H-GMLC. If indication of the requested location estimate is included in the area event request, the H-GMLC should record this indication and any relevant parameters such as QoS. The H-GMLC assigns a LDR reference number to this LCS Service request then transfers the information to the V-GMLC, including the LDR reference number and the H-GMLC address.\nIf the H-GMLC notices that the current visited PLMN does not serve the target area, it may generate a modified deferred LCS service request in order to get notified when the target UE enters a PLMN that serves the target area. The modified target area event is that the target UE enters one of the PLMNs that serve the original target area. Note that the new area event may include multiple PLMNs (identified by PLMN IDs) if there are more than one PLMN that serves the original target area, based on the stored PLMN list and the corresponding estimated coverage. The H-GMLC then generates a new location request with the new defined area event and the same rest of the information in the original request.\nThe new location request is sent to the target UE via the current V-GMLC. The H-GMLC keeps the original area event location service request pending for as long as determined by the validity time of the request. When the UE enters one of the pre-defined PLMNs, it sends an area event location report to H-GMLC. The H-GMLC then sends the original area event location service request to the UE via the new V-GMLC. If the H-GMLC cannot derive a list of PLMNs that may cover the target area, and the current visited network does not cover the target area, the H-GMLC may reject the request.\n3)\tIf the received target area is expressed by a shape defined in TS 23.032 [11], V-GMLC converts the target area into an Area Definition consisting of the corresponding list of cell identities, location areas or routing area. If the V-GMLC is not able to translate the target area into network identities, it shall reject the request and send an LCS service response to H-GMLC with the appropriate error cause.If the received target area is expressed by country code or PLMN identity, the V-GMLC shall use the country code or PLMN identity as the Area Definition.The V-GMLC sends the Area Definition to MSC/SGSN in the Provide Subscriber Location request (deferred) and includes the LDR reference number and the H-GMLC address in the request.The message shall define whether the event to be reported is the UE being inside, entering into or leaving the area. The message shall also include the validity period of the location request, the minimum interval time between area event reports, the information whether the deferred area event may be reported one time only or several times, if applicable.\n4)\tThe MSC/SGSN verifies the UE capabilities with regard to the change of area event. If either the MSC/ SGSN or the UE does not support the deferred location request for the change of area event (for temporary or permanent reasons), a Provide Subscriber Location return error shall be returned with a suitable cause in step 7. If the UE is in idle mode, the core network performs paging, authentication and ciphering. If privacy notification/verification is requested, the MSC/SGSN sends an LCS Location Notification Invoke message to the target UE with a location type indicating activation of a deferred location request, a deferred location event type containing the change of area types requested and an indication as to whether privacy verification is required. LCS Location Notification is further specified in clauses 9.1.2 and 9.1.6. If privacy verification was requested, the UE returns an LCS Location Notification Return Result to the MSC/SGSN indicating whether permission is granted or denied. If a previous deferred location request is ongoing in the UE and the MSC/SGSN proceeds with the current deferred request, the UE may return an LCS Location Notification Return Error response to the MSC/SGSN indicating that the new request cannot be supported.\n5)\tThe MSC/SGSN sends the LCS Area Event Invoke to the UE carrying the Area Definition, other area event information, the LDR reference number and the H-GMLC address. The message shall also define whether the event to be reported is the UE being inside, entering into, leaving the area. The message shall also include the validity period of the location request, the minimum interval time between area event reports and the information whether the deferred area event may be reported one time only, or several times, if applicable.\n6)\tIf the LCS Area Event Invoke is successfully received by the UE and the UE supports the change of area type deferred location request, the UE sends acknowledgement to MSC/SGSN and begins monitoring for the change of area event. The UE shall determine whether it is inside, entering into or leaving the target area by comparing the current serving cell identity, location area, routing area, PLMN identity or country code to the Area Definition received from the MSC/SGSN. In case of soft handover, it is sufficient if one of the cells belongs to the target area. In case the Area Definition consists of a location or routing area, PLMN or country identity the UE shall check for the area event during the normal location or routing area update procedure. The change of area event detection mechanism must not influence on the normal UE cell selection and reselection procedures.If the UE does not support the deferred location request (for temporary or permanent reasons), it shall send the LCS Area Event Invoke ack. with the appropriate error cause. If a previous deferred location request is still ongoing in the UE, the UE may return an LCS Area Event Return Error response to the MSC/SGSN indicating that the new request cannot be supported.\n7)\tIf either the MSC/ SGSN or the UE does not support the deferred location request for the change of area event (for temporary or permanent reasons), a Provide Subscriber Location return error shall be returned to the V-GMLC with a suitable cause. If both of the SGSN/MSC and UE supports the deferred location request for the change of area event, a Provide Subscriber Location ack. shall be returned to the V-GMLC without a location estimate. MSC/SGSN shall include the result of the notification/verification in the response to the V-GMLC, if the notification/verification is needed. The response message shall include the LDR reference number and the H-GMLC address. The change of area event invoke result shall be also included, if necessary. After sending the Provide Subscriber Location ack to the V-GMLC, the deferred location request shall be completed in the MSC/SGSN. The SGSN/MSC may record charging information for an accepted area event request.\n8) to 10)\tV-GMLC returns the LCS Service Response via H-GMLC and R-GMLC to the LCS Client to notify whether the request was successfully accepted or not. When the H-GMLC returns the LCS Service Response to the R-GMLC, the LDR reference number assigned by the H-GMLC shall be included, then the R‑GMLC shall transfer the LDR reference number to the LCS Client in the LCS Service Response. After sending the LCS Service Response to the H-GMLC, the deferred location request shall be completed in the V-GMLC. The V-GMLC or R-GMLC may record charging information for an accepted area event request.\n11)\tUE detects that the requested area event has occurred.\n12)\tBefore sending the LCS Area Event Report the UE shall establish either a CS radio connection or PS signalling connection as specified in clauses 9.2.1 and 9.2.2. The UE sends the LCS Area Event Report to the VMSC/SGSN including the original LDR reference number and the H-GMLC address. The report shall also include the result of the notification/verification procedure, if the notification/verification is needed.\nWhen the MSC/SGSN receives the report and it can handle this report, an acknowledgement as a response should be sent to the UE. If the UE does not receive any response from the MSC/SGSN after sending the report, i.e. the current MSC/SGSN does not support the deferred location request for the area event (for temporary or permanent reasons), the UE may re-send the report more times. If the UE always does not receive the response, the UE shall stop sending the report, then record a corresponding flag to indicate that a report has been sent unsuccessfully. When the UE performs location update and detects the LAI or RA is changed, if the flag has been set, the UE shall send the report to the corresponding MSC/SGSN, and the flag will be cleared upon a success of the sending.If the UE was requested to report the change of area event one time only, the deferred location request shall be completed. In case multiple reports were requested, the UE must not send a repeated LCS Area Event Report more often than the requested minimum interval indicated in the LCS Area Event Invoke.\nEditor's Note: It could be useful to have MSC/SGSN repeat the notification procedure with the target UE after the UE has reported the change of area event, but this is for further study.\n13)\tThe MSC/SGSN sends the subscriber location report to its associated V-GMLC with an indication of the event occurrence, the LDR reference number, the H-GMLC address and may also include the indication whether the obtained location estimate satisfies the requested accuracy or not (provided that this indication is obtained from RAN with the location estimate). V-GMLC sends an acknowledgement to MSC/SGSN in step 13b and the MSC/SGSN may record charging information.\n14)\tThe V-GMLC sends the LCS Service Response to the H-GMLC with an indication of the event occurrence, the LDR reference number and the H-GMLC address. The LCS Service Response is sent in accordance with the requested QoS Class, as described in clause 9.1.1 for common MT-LR. The LDR reference number and the H-GMLC address will be used to identify the source of the original deferred location request in the case that the UE has relocated before the area event occurred. The V-GMLC may record charging information.\n15)\tIn case the UE moves to another PLMN of the PLMN identities list, according to the PLMN identity the UE shall determine whether the Area Definition of the target area is available. If it is not available, the UE shall report that it has roamed into a new PLMN, including the new PLMN identity and the LDR reference number. The H-GMLC shall transfer the original area event request to the V-GMLC of the new PLMN. The procedure should be continued as described in step 2 and onwards where the Area Definition of the new PLMN shall be downloaded to the UE. Otherwise, the UE monitors the area event in the new PLMN, does not inform the H-GMLC that it has entered into a new PLMN.\n16)\tThe H-GMLC performs the privacy check as described in clause 9.1.1.\n17)\tIf the H-GMLC finds the indication of the requested location estimate is stored, the H-GMLC should generate a new immediate LCS Service Request with the QoS specified in the original request. Then the H-GMLC sends the new request as described in clause 9.1.1 to the V-GMLC and waits the result the location request, the subsequent procedures in clause 9.1.1 are continued.\nThe H-GMLC sends the LCS Service Response to R-GMLC with the LDR reference number. If the location estimate of the target UE is requested in the request and the location estimate was successfully obtained, the H-GMLC shall put the obtained location estimate into the LCS Service Response. If the location estimate of the target UE is requested in the request but the location estimate could not be obtained, the H-GMLC sends the LCS Service Response without the location estimate. Unless multiple reports were requested, the deferred location request shall be completed in the H-GMLC after sending the LCS Service Response to the R-GMLC. The H-GMLC may record charging information.\n18)\tThe R-GMLC sends the LCS Service Response to the LCS client. Unless multiple reports were requested, the deferred location request shall be completed in the R-GMLC after sending the LCS Service Response to the LCS client. The R-GMLC may record charging information.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_5.5.1",
        "clause_9.1.9.1",
        "clause_9.1.1",
        "figure_9-6",
        "figure_9.6",
        "ts_23.032"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.9.1",
      "section_id": "9.1.9.1",
      "section_title": "Cancellation of a Deferred Location Request – Change of Area event",
      "content": "Figure 9-7b illustrates the procedure for cancelling the Deferred Location Request for the change of area event.\nFigure 9.7b: Cancellation of a Deferred MT-LR with change of area event procedure\n1)\tThe LCS Client requests the cancellation of a previously requested Deferred Location Request. The LDR reference number that was included in the previous LCS Service Response sent by the GMLC shall be included in the request to indicate which outstanding LDR should be cancelled.\n2)\tThe R-GMLC sends the cancellation request to H-GMLC, including the LDR reference number. R-GMLC may itself initiate the cancellation for some other reason, e.g. the expiry of the validity timer specified by the start time and stop time; or the expiry of an implementation dependent timer specified by the Operator as a default value in the R-GMLC when the stop time is undefined or exceeds the maximum allowed value.\n3)\tThe H-GMLC forwards the LCS Cancel Service Request to V-GMLC with the LDR reference number which is received from the R-GMLC, and the H-GMLC address. The H-GMLC may itself initiate the cancellation procedure, when the UE's privacy profile stored in the H-GMLC or in the PPR was changed. For every outstanding Deferred Location Request against that UE, the H-GMLC shall perform or ask the PPR to perform a new privacy check based on the updated privacy profile. If the privacy check passes, i.e. the LCS Client is still allowed to position the target UE, the handling of the outstanding Deferred Location Request should be continued. Otherwise, if the privacy check does not pass, i.e. the Location estimate of the target UE is not allowed to be provided to the LCS Client, the H-GMLC shall initiate a cancellation procedure.\nNOTE:\tThe H-GMLC shall know that the UE subscriber's privacy profile has been changed in the PPR when the LCS Privacy Profile Update has been sent from PPR to H-GMLC as described in clause 9.1.1.2.\n4)\tThe V-GMLC sends the Provide Subscriber Location request to SGSN/MSC, indicating a cancellation of a deferred location request and including the LDR reference number specified by the LCS Client in the LCS Cancel Service Request and the H-GMLC address received from the H-GMLC.\n5)\tThe SGSN/MSC sends the LCS Area Event Cancellation, including the LDR reference number and the H-GMLC address, request to UE.\n6a)\tThe UE cancels the Area event deferred location request and sends the LCS Area Event cancellation ack., with no area event information included to VMSC/SGSN.\n6b)\tWhile the UE is monitoring for the area event to occur, the UE may cancel or terminate the deferred location request for the change of area on its own behalf by sending the LCS Area Event report with the LDR reference number, an indication of the cancellation and an appropriate error cause.\n7)\tThe SGSN/MSC sends the cancellation acknowledgement to the V-GMLC in the Provide Subscriber Location Ack, with the LDR reference number and the H-GMLC address.\n8)\tThe V-GMLC sends the LCS Cancel Service Response to H-GMLC with the LDR reference number and the H-GMLC address.\n9)\tH-GMLC sends the LCS Cancel Service Response to R-GMLC with the LDR reference number. H-GMLC may send the LCS Cancel Service Response to R-GMLC, even if the R-GMLC/LCS client has not requested the cancellation, see step 3.\n10)\tR-GMLC sends the LCS Cancel Service Response to the LCS Client.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.1.2",
        "figure_9-7",
        "figure_9.7"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.10",
      "section_id": "9.1.10",
      "section_title": "Circuit Switched Post Positioning Notification and Verification Procedure",
      "content": "Figure 9.10 illustrates the post positioning notification and verification procedure.\nFigure 9.10: CS Post Positioning Notification and Verification Procedure\n1)\tCommon PS and CS MT-LR procedure as described in clause 9.1.1.\n2)\tThe GMLC sends a PROVIDE_ SUBSCRIBER _LOCATION message to the MSC/MSC server with an indication of \"notification only\". This message carries the UE subscriber's IMSI. For a call related location request, the message also carries the LCS client's called party number. For a value added LCS client, the message shall carry the client name, the external identity of the LCS client and the Requestor Identity (if that is both supported and available). Also the message may carry the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. For a PLMN operator LCS client, the message shall carry the internal identity of the LCS client. Moreover the message may also carry the Service Type. If the result of the privacy check at H-GMLC/PPR indicated that the codeword shall be sent to the UE user, the message may carry also the codeword received from the LCS client. For a PLMN operator LCS client, the message shall carry the internal identity of the LCS client. If the Requestor Identity is provided, the GMLC shall send it as separate information. In addition, in order to display the requestor identity in case of pre Rel-5 network elements (i.e. MSC and/or UE), the requestor identity may be also added to the LCS client name by the GMLC. When the Requestor identity is added to the LCS client name the practice described in the Annex D should be followed.\n3)\tIf the UE is in idle mode, the Core Network performs paging, authentication and ciphering. The MSC will page a GPRS attached UE either through A/Iu or Gs interface, depending on the presence of the Gs interface.\n4)\tAn LCS Location Notification Invoke message is sent to the target UE indicating a location type of notification and verification only, the identity of the LCS client, the Requestor Identity (if that is both supported and available) and whether privacy verification is required. Also the message may indicate the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. Moreover, the message may carry also the service type and the codeword.4).\n5)\tThe target UE notifies the UE user of the location request. If privacy verification was requested, the target UE indicates to the UE user whether the location report will be allowed or not allowed in the absence of a response and waits for the user to grant or withhold permission. The UE then returns an LCS Location Notification Return Result to the VMSC/MSC server indicating, if privacy verification was requested, whether permission is granted or denied. If the UE user does not respond after a predetermined time period, the VMSC/MSC server shall infer a \"no response\" condition. The VMSC/MSC server shall return an error response to the GMLC if privacy verification was requested and either the UE user denies permission or there is no response with the UE subscription profile indicating barring of the location request in the absence of a response.\n6)\tThe VMSC/MSC server returns the indication of successful notification and verification result, if it has received a LCS Location Notification Return Result indicating that permission is granted. If a LCS Location Notification Return Result message indicating that permission is not granted is received, or there is no response, with the requested privacy action or the UE subscription profile indicating barring of location in the absence of a response, the VMSC/MSC server shall return an error response to the GMLC. The MSC/MSC server may then release the Mobility Management connection to the UE, if the UE was previously idle, and the MSC/MSC server may record charging information.\n7)\tCommon MT-LR procedure in PS and CS domain as described in clause 9.1.1.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.1",
        "figure_9.10"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.11",
      "section_id": "9.1.11",
      "section_title": "Packet Switched Post Positioning Notification and Verification Procedure",
      "content": "Figure 9.11 illustrates the post positioning notification and verification procedure.\nFigure 9.11: PS Post Positioning Notification and Verification Procedure\n1)\tCommon PS and CS MT-LR procedure as described in clause 9.1.1.\n2)\tThe GMLC sends a Provide Subscriber Location message to the SGSN with an indication of \"notification only\". This message carries the UE subscriber's IMSI. For a session related location request, the message also carries the APN-NI to which the user has established the session. For a value added LCS client, the message shall carry the client name, the external identity of the LCS client and the Requestor Identity (if that is both supported and available), optionally the message may also carry the Service Type. Also the message may carry the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. If the result of the privacy check at H-GMLC/PPR indicated that the codeword shall be sent to the UE user, the message may carry also the codeword received from the LCS client. For a PLMN operator LCS client, the message shall carry the internal identity of the LCS client. If the Requestor Identity is provided, the GMLC shall send it as separate information. In addition, in order to display the requestor identity in case of pre Rel-5 network elements (i.e. SGSN and/or UE), the requestor identity may be also added to the LCS client name by the GMLC. When the Requestor identity is added to the LCS client name the practice described in the Annex D should be followed.\n3)\tThe SGSN determines a required privacy related action as described in Annex A.3 based on the indicators of privacy related action in the PSL message from the GMLC. If the UE is in idle mode, the SGSN performs paging. The paging procedure is defined in TS 23.060 [15].\n4)\tSecurity functions may be executed. These procedures are defined in TS 23.060 [15].\n5)\tA notification invoke message is sent to the target UE indicating a location type of notification and verification only, the identity of the LCS client and the Requestor Identity (if that is both supported and available), whether privacy verification is required. Also the message may indicate the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. Moreover, the message may carry also the service type and the codeword.\n6)\tThe target UE notifies the UE user of the location request and, if privacy verification was requested, waits for the user to grant or withhold permission. The UE then returns a notification result to the SGSN indicating, if privacy verification was requested, whether permission is granted or denied. If the UE user does not respond after a predetermined time period, the SGSN shall infer a \"no response\" condition. The SGSN shall return an error response to the GMLC if privacy verification was requested and either the UE user denies permission or there is no response with the UE subscription profile indicating barring of the location request.\n7)\tThe SGSN returns the indication of successful notification and verification result, if it has received a LCS Location Notification Return Result indicating that permission is granted. If a LCS Location Notification Return Result message indicating that permission is not granted is received, or there is no response, with the requested privacy action or the UE subscription profile indicating barring of location, the SGSN shall return an error response to the GMLC.\n8)\tCommon MT-LR procedure in PS and CS domain as described in clause 9.1.1.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.1",
        "figure_9.11",
        "ts_23.060"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.12",
      "section_id": "9.1.12",
      "section_title": "Deferred Location Request Procedure for the Periodic Location Event",
      "content": "This clause describes the procedures for a Deferred Location Request where a Location Report is returned to the network each time the periodic reporting event occurs within the UE.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.1.12.1",
      "section_id": "9.1.12.1",
      "section_title": "Instigation of an MT-LR Request for Periodic Location",
      "content": "Figure 9.12: Deferred MT-LR Initiation Procedure for Periodic Location\n1)\tThe LCS Service Request contains the periodic location request information, such as time interval between successive location reports and total number of reports.\n2)\tLCS service request handling between GMLCs as described in clause 9.1.1. The information received by the R-GMLC is transferred to the H-GMLC. The R-GMLC also indicates whether MO-LR Short Circuit is allowed.The H-GMLC assigns a LDR reference number to this LCS Service Request and may include a list of PLMNs and possibly associated radio access technologies (e.g. GSM, UMTS), either prioritized or non-prioritized, in which subsequent MO-LR TTTP requests must be made by the UE (according to the procedure in clause 9.1.12.2) and an indication for each PLMN (and possibly associated radio access technology) as to whether the PLMN supports periodic location in the RAN. If no list is included by the H-GMLC, subsequent MO-LR TTTP requests are restricted to the current serving PLMN only. The H-GMLC then transfers the information to the V-GMLC, including the LDR reference number, any reporting PLMN list and the H-GMLC address.\nNOTE 1:\tAny preference for using MO-LR Short Circuit needs to consider the list of PLMNs in which subsequent MO-LR TTTP requests will be made (if this was included by the H-GMLC) since this agreement applies to all of these PLMNs.\n3)\tThe V-GMLC conveys the periodic location request to MSC/SGSN in the Provide Subscriber Location request including the LDR reference number, any reporting PLMN list and the H-GMLC address in the request, as well as an indication of whether MO-LR Short Circuit is permitted.\n4)\tThe MSC/SGSN verifies the UE capabilities with regard to the support of location service related call independent supplementary services (e.g. notification for LCS). If either the UE does not support any location service related call independent supplementary service or the MSC/SGSN does not support the deferred location request for the periodic location event (for temporary or permanent reasons), a Provide Subscriber Location return error shall be returned with a suitable cause in step 7.If the UE is in idle mode, the core network performs paging, authentication and ciphering. If privacy notification/verification is requested, the MSC/SGSN sends an LCS Location Notification Invoke message to the target UE with a location type indicating activation of a deferred location request, a deferred location event type indicating periodic location and an indication as to whether privacy verification is required. LCS Location Notification is further specified in clauses 9.1.2 and 9.1.6. If privacy verification was requested, the UE returns an LCS Location Notification Return Result to the MSC/SGSN indicating whether permission is granted or denied. If a previous deferred location request is ongoing in the UE and the MSC/SGSN proceeds with the current deferred request, the UE may return an LCS Location Notification Return Error response to the MSC/SGSN indicating that the new request cannot be supported.\nNOTE 2:\tThere is no UE capability information directly indicating support of a periodic deferred location request. However, if the UE supports at least one location service related call independent supplementary service (such as notification for LCS), the MSC/SGSN can assume support for a periodic deferred location request and attempt to request it in step 5. If the UE does not recognize this request, it may return a Facility Rejected indication in step 6 (as defined in TS 24.008 [24]) to the MSC/SGSN. The return of at least this minimal indication of non-support (as opposed to the UE ignoring the request and sending back nothing) is ensured by support of at least one location service related call independent supplementary service.\n5)\tThe MSC/SGSN sends an LCS Periodic Location Invoke to the UE containing the periodic location related parameters (reporting interval and total number of reports) and other relevant information (QoS, LCS Client External ID, H-GMLC address, LDR reference number, any reporting PLMN list and use of MO-LR Short Circuit).\n6)\tIf the LCS Periodic Location Invoke is successfully received by the UE and the UE supports the periodic location according to the request received in step 5, the UE sends an acknowledgement to MSC/SGSN including the MO-LR Short Circuit indication if received in step 5. If the MO-LR Short Circuit indication is received in step 5 and the UE does not support MO-LR Short Circuit (for temporary or permanent reasons), the UE sends the LCS Periodic Location Invoke Ack without the MO-LR Short Circuit indication indicating to the MSC/SGSN that MO-LR Short Circuit will not be used. If a previous deferred location request is still ongoing in the UE, the UE may return an LCS Periodic Location Return Error response to the MSC/SGSN indicating that the new request cannot be supported.\n7)\tIf either the MSC/SGSN or the UE does not support the periodic location request (for temporary or permanent reasons), a Provide Subscriber Location return error shall be returned to the V-GMLC with a suitable error cause.If both of the MSC/SGSN and UE supports the periodic location request, a Provide Subscriber Location Ack. shall be returned to the V-GMLC. The MSC/SGSN shall include an MO-LR Short Circuit indication in the response to the V-GMLC, if the use of MO-LR Short Circuit was requested and accepted by the UE in step 6.\n8) to 10) The V-GMLC returns the LCS Service Response via H-GMLC and R-GMLC to the LCS Client to notify whether the periodic location request was successfully accepted or not. When the H-GMLC returns the LCS Service Response to the R-GMLC, the LDR reference number assigned by the H-GMLC shall be included, and the R GMLC may transfer the LDR reference number to the LCS Client in the LCS Service Response.\nNOTE 3:\tIf the R-GMLC receives an error response in step 9 indicating that the MT-LR request for periodic location cannot be supported (for temporary or permanent reasons), the R-GMLC may invoke periodic location using the common MT-LR procedure defined in clause 9.1.1.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.1",
        "clause_9.1.12.2",
        "figure_9.12",
        "ts_24.008"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.12.2",
      "section_id": "9.1.12.2",
      "section_title": "Reporting of Periodic Location",
      "content": "Once the periodic location reporting has been successfully instigated using the procedure in figure 9.12 (or 9.8a in case the UE subscriber or an application in the UE is the instigator), the UE is responsible for sending location estimates periodically to the LCS Client using MO-LR TTTP procedure illustrated in figure 9.13 below. This procedure begins immediately or, in the case of MO-LR short circuit, almost immediately after the procedure in figure 9.12 (or 9.8a) and continues until the specified number of reports for this request is attained or the procedure is cancelled by the UE, R‑GMLC or H‑GMLC using the procedure specified in clause 9.1.12.3.\nFigure 9.13: Reporting of Periodic Location\n1) to 2) If the UE is in idle mode, the UE requests a radio connection setup and sends a CM Service Request indicating a request for call independent supplementary service to the VMSC/MSC server via RAN (CS domain). If the UE is in dedicated mode, the UE sends a CM Service Request on the already established radio connection. The VMSC/MSC server instigates authentication and ciphering if the UE was in idle mode or returns a CM Service Accept if the UE was in dedicated mode.\nFor PS domain, in UMTS, if the UE is in idle mode, the UE requests a PS signalling connection and sends a Service Request indicating signalling to the SGSN via RAN. If the UE already has PS signalling connection, the UE does not need to send the Service Request. Security functions may be executed. These procedures are described in TS 23.060 [15]. In GSM this signalling step is not needed.\n3)\tThe UE sends an LCS MO-LR Invoke to the VMSC/MSC Server (CS domain) or to the SGSN (PS domain) for a transfer of the location estimate to a third party LCS client. This message includes the identity of the LCS client and the H-GMLC address received by the UE during execution of the procedure described in clause 9.1.12.1 (or clause 9.2.3).The LCS MO-LR Invoke also includes the LDR Reference Number. The presence of the LDR Reference Number indicates that the transfer and its attributes (e.g. use of MO-LR Short Circuit) have been previously authorized by the R-GMLC, H-GMLC and V-GMLC, using the procedure described in clause 9.1.12.1 (or clause 9.2.3).This message also includes a location estimate if MO-LR Short Circuit was requested and has been acknowledged by the UE. If MO-LR Short Circuit has been acknowledged and the UE was not able to obtain a location estimate, the LCS MO-LR Invoke shall still be sent when the reporting event occurs indicating that no location estimate is available.If MO-LR Short circuit has not been agreed or was not requested, the LCS MO-LR Invoke message does not include any location estimate or error indication, but includes QoS information and optional periodic location information (reporting interval and number of reports), as well as an optional request for location update notification (see steps 13 and 14).\n4) to 6) If MO-LR Short Circuit is not used (i.e. no location estimate or no error indicating unavailability of a location estimate is included in step 3), the MSC/SGSN obtains a location estimate by sending a Location Request to RAN associated with the target UE in step 4. The Location Request includes the LCS QoS. If supported by the serving RAN and included by the UE in step 3, the Location Request can include periodic location information (e.g. reporting interval and number of reports). In step 5, RAN determines the positioning method and instigates the particular message sequence for this method, as specified in UTRAN Stage 2, TS 25.305 [1] and GERAN Stage 2, TS 43.059 [16]. When a location estimate best satisfying the requested QoS has been obtained, RAN returns it to the MSC/SGSN in a Location Report message in step 6.\n7)\tIf a location estimate has been received from the UE in step 3 (i.e. use of MO-LR Short Circuit) or was successfully obtained in step (6), the MSC/SGSN sends a Subscriber Location Report to its associated V-GMLC with an indication of the periodic event occurrence, the LDR reference number, the H-GMLC address and may also include the indication whether the obtained location estimate satisfies the requested accuracy or not (provided that this indication is obtained from RAN or the UE with the location estimate). If no location estimate was obtained in step 3 or 6 (e.g. positioning failure or time out), a report indicating this shall be returned.\n8)\tThe V-GMLC sends an acknowledgement to the MSC/SGSN and the MSC/SGSN may record charging information.\n9)\tThe V-GMLC sends an LCS Service Response to the H-GMLC with an indication of the periodic event occurrence, the LDR reference number and the location estimate if this was successfully obtained. If the location estimate could not be obtained, the V-GMLC sends the LCS Service Response without the location estimate. The LDR reference number will be used by the H-GMLC to identify the source of the original periodic location request. The V-GMLC may record charging information.\n10)\tThe H-GMLC may perform a privacy check as described in clause 9.1.1.\n11)\tThe H-GMLC sends an LCS Service Response to the R-GMLC with an indication of the periodic event occurrence, the LDR reference number and the location estimate if this was successfully obtained. If the location estimate could not be obtained, the H-GMLC sends the LCS Service Response without the location estimate. If this is the final location report, the periodic location request shall be completed in the H-GMLC. The H-GMLC may record charging information.\n12)\tThe location information is passed to the LCS Client. If this is the final location report, the periodic location request shall be completed in the R-GMLC. The R-GMLC may record charging information.\n13) to 14) If periodic reporting in the RAN was instigated in step 4 and location update notification was requested in step 3, an LCS Location Update is sent to the UE to indicate successful transfer of the first location estimate (or possibly transfer of a location failure report) towards the LCS Client. The UE acknowledges this. The UE may employ the LCS Location Update ack. to cancel the procedure (see Note 2).\n15) to 24) If periodic reporting in the RAN was instigated in step 4, RAN obtains a new location estimate in step 15 and transfers this to the MSC/SGSN in step 16 after the reporting interval has transpired. The MSC/SGSN transfers the location estimate to the LCS client in steps 17 to 22. Steps 17 to 22 are as in steps 7 to 12. An LCS Location Update is then sent to the UE in step 23 and acknowledged in step 24 if requested in step 3. Steps 23 and 24 are as in steps 13 and 14. Steps 15-24 are repeated at the periodic location interval (as the RAN provides each new location estimate to the MSC/SGSN) until the number of reports is attained, or until there is a request from the RAN to hand the UE over to a different MSC/SGSN. Following transfer of the final location estimate to the LCS Client, the transfer and acknowledgment of an LCS Location Update in steps 23 and 24, if requested in step 3, could be omitted as an implementation option.\n25)\tThe MSC/SGSN returns an LCS MO-LR Return Result to the UE indicating that the location estimate (or location estimates in case of periodic reporting in RAN was instigated at step 4 has been successfully transferred to the LCS client or not.\n26)\tThe MSC/SGSN may release the CM, MM or GMM and radio connection to the UE, if the UE was previously idle.The UE is responsible for restarting the procedure at step 1 or 3 if the total number of location reports has not yet been reached. In the case of restarting at step 3, the CM, MM/GMM and radio connections would not be released.\nNOTE 1:\tIn case of periodic reporting in the RAN is used, the LCS MO-LR TTTP invoke request sent by the UE in step 3 could include, besides the periodic reporting interval, a number of reports less than or equal to the remaining number of reports for the whole procedure. When a smaller number of reports was requested, the target UE would be responsible for reissuing further MO-LR requests, after periodic reporting from the RAN was completed, until the overall number of reports was attained.\nNOTE 2:\tAfter each location estimate (or possibly location failure report) has been transferred to the LCS client (e.g. after step 12, 22), the MSC/SGSN sends an LCS Location Update Invoke message to the UE indicating that the location estimate (or possibly location failure report) has been successfully transferred if this was requested by the UE in step 3. The UE acknowledges the receipt of the LCS Location Update Invoke message and a cancellation of location could be included if the UE subscriber wishes to cancel the periodic location procedure at that point. In the event that the UE cancels the procedure, the MSC/SGSN shall notify the V-GMLC, H-GMLC, R-GMLC and LCS Client using the procedure in clause 9.1.12.4.\nIf the UE moves out of coverage of the PLMN(s) in which the location reports are allowed or if a conflict with the PLMNs preferred by the UE for other services prevents access to the PLMN(s) for periodic location, the UE terminates the procedure and stops sending LCS MO-LR Invoke. The UE may determine the need for termination if it is unable to instigate an MO-LR TTTP request for some period of time (e.g. some multiple of the required periodic location interval).If any LCS MO-LR Invoke TTTP request is rejected by the current serving PLMN with a cause indicating that the procedure cannot be supported (for temporary or permanent reasons) – e.g. MO-LR Short Circuit was initially agreed, but can no longer be supported or cannot be supported in the new PLMN – and the UE is unable to instigate the procedure in any other PLMN allowed when the procedure was originally started, the UE terminates the procedure and stops sending LCS MO-LR Invoke TTTP requests.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.12.3",
        "clause_9.1.12.1",
        "clause_9.2.3",
        "clause_9.1.1",
        "clause_9.1.12.4",
        "figure_9.12",
        "figure_9.13",
        "ts_23.060",
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.12.3",
      "section_id": "9.1.12.3",
      "section_title": "LCS Client cancellation of a Deferred Location Request – Periodic Location Event",
      "content": "Figure 9.14 illustrates the procedure for cancelling the Deferred Location Request for the periodic location event when cancellation is requested by the LCS Client.\nFigure 9.14: LCS Client cancellation of a Deferred MT-LR for Periodic Location\n1)\tThe LCS Client requests the cancellation of a previously requested Deferred Location Request. The LDR reference number that was included in the previous LCS Service Response sent by the R-GMLC shall be included in the request to indicate which outstanding LDR should be cancelled.\n2)\tThe R-GMLC sends the cancellation request to H-GMLC, including the LDR reference number. The R‑GMLC may itself initiate the cancellation for some other reason, e.g. whenever the R-GMLC infers from the absence of periodic location reports that the service may have been terminated.\n3)\tThe H-GMLC may send a SEND_ROUTING_INFO_FOR_LCS message to the home HLR/HSS of the UE with the IMSI or MSISDN of this UE. This may be needed if the UE may no longer be served by the original V‑PLMN or by the original SGSN or VMSC/MSC server.\n4)\tThe HLR/HSS returns the current SGSN and/or VMSC/MSC server for the UE and the V-GMLC address.\n5)\tThe H-GMLC forwards the LCS Cancel Service Request to V-GMLC with the LDR reference number which is received from the R-GMLC, the H-GMLC address and the SGSN or VMSC/MSC server address (e.g. received from the HLR/HSS). The H-GMLC may itself initiate the cancellation procedure, when the UE's privacy profile stored in the H-GMLC or in the PPR was changed. For every outstanding Deferred Location Request against that UE, the H-GMLC shall perform or ask the PPR to perform a new privacy check based on the updated privacy profile. If the new privacy check passes, i.e. the LCS Client is still allowed to position the target UE, the handling of the outstanding Deferred Location Request should be continued. Otherwise, if the new privacy check does not pass, i.e. the location estimate of the target UE is not allowed to be provided to the LCS Client, the H-GMLC shall initiate a cancellation procedure. If the H-GMLC cannot complete the new privacy check (e.g., because it requires information, such as UE location, not currently available to the H-GMLC), then the H-GMLC may initiate a cancellation procedure according to H-PLMN privacy policy.\nNOTE:\tThe H-GMLC shall know that the UE subscriber's privacy profile has been changed in the PPR when the LCS Privacy Profile Update has been sent from PPR to H-GMLC as described in clause 9.1.1.2.\n6)\tThe V-GMLC sends the Provide Subscriber Location request to MSC/SGSN, indicating a cancellation of a deferred location request and including the LDR reference number specified by the LCS Client in the LCS Cancel Service Request and the H-GMLC address received from the H-GMLC. The V-GMLC shall transfer the location cancellation even when the V-GMLC was not involved in establishing the periodic location request – e.g. if the target UE is now served by another V-PLMN.\n7)\tThe MSC/SGSN sends the LCS Periodic Location Cancellation request, including the LDR reference number and H-GMLC address, to the UE. If the periodic reporting is via the serving RAN as described in step 4 of figure 9.13, the periodic location cancellation request is also sent to RAN.\n8)\tThe UE stops the periodic location reporting and returns the LCS Periodic Location cancellation ack. to the MSC/SGSN. Return of an LCS Periodic Location cancellation ack. shall apply even when the UE has no knowledge of the periodic location procedure being cancelled (e.g. UE was powered off during the procedure).\n9)\tThe MSC/SGSN sends the cancellation acknowledgement to the V-GMLC in the Provide Subscriber Location Ack, with the LDR reference number and the H-GMLC address.\n10)\tThe V-GMLC sends the LCS Cancel Service Response to H-GMLC with the LDR reference number and the H‑GMLC address.\n11)\tH-GMLC sends the LCS Cancel Service Response to R-GMLC with the LDR reference number.\n12)\tR-GMLC sends the LCS Cancel Service Response to the LCS Client.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.1.2",
        "figure_9.14",
        "figure_9.13"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.12.4",
      "section_id": "9.1.12.4",
      "section_title": "UE cancellation of a Deferred Location Request – Periodic Location Event",
      "content": "Figure 9.15 illustrates the procedure for cancelling the Deferred Location Request for the periodic location event when cancellation is requested by the UE. If a network entity (e.g. H-GMLC, V-GMLC, SGSN/MSC) cancels the Deferred Location Request, the procedure in clause 9.1.12.3 for LCS Client cancellation shall be used to cancel towards the UE and the procedure in this clause shall be used to cancel towards the LCS Client.\nFigure 9.15: UE cancellation of a Deferred MT-LR for Periodic Location\n1) to 2) If the UE is in idle mode, the UE requests a radio connection setup and sends a CM Service Request indicating a request for call independent supplementary service to the VMSC/MSC server via RAN (CS domain). If the UE is in dedicated mode, the UE sends a CM Service Request on the already established radio connection. The VMSC/MSC server instigates authentication and ciphering if the UE was in idle mode or returns a CM Service Accept if the UE was in dedicated mode.\nFor PS domain, in UMTS, if the UE is in idle mode, the UE requests a PS signalling connection and sends a Service Request indicating signalling to the SGSN via RAN. If the UE already has PS signalling connection, the UE does not need to send the Service Request. Security functions may be executed. These procedures are described in TS 23.060 [15]. In GSM this signalling step is not needed.\n3)\tThe UE sends an LCS MO-LR Invoke to the VMSC/MSC Server (CS domain) or to the SGSN (PS domain) for cancellation of a transfer of location to a third party LCS client. This message includes the identity of the LCS client, the H-GMLC address, a termination cause (e.g. subscriber terminates the procedure) and the LDR Reference Number. The presence of the LDR Reference Number indicates that the cancellation is for a previously authorized periodic location request.\n4) to 7) The cancellation request shall be transferred in succession from the MSC/SGSN to the V-GMLC, H‑GMLC, R‑GMLC serving the LCS client and finally may be transferred to the LCS client (e.g. if the LCS Client originated the periodic location request or was informed of a periodic location request originated by the UE as in clause 9.2.3).\n8) to 11) The response transferred back to the MSC/SGSN acknowledges the cancellation.\n12)\tThe MSC/SGSN returns the acknowledgment to the UE in a LCS MO-LR Return Result message.\n13)\tThe UE may instigate release of the CM, MM/GMM and radio connections.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.12.3",
        "clause_9.2.3",
        "figure_9.15",
        "ts_23.060"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.13",
      "section_id": "9.1.13",
      "section_title": "IW-MT-LR Procedure",
      "content": "Figure 9.16 describes the IW-MT-LR procedure. This procedure is applicable to the I-WLAN defined in TS 23.234 [52] and it is no longer maintained.\nFigure 9.16: IW-MT-LR in I-WLAN\nNOTE 1:\tEven though figure 9.16 does not specify the specific services with IW-MT-LR, this flow can be applicable for both immediate and triggered services (e.g. periodic or change of area event case).\n1.\tA WLAN UE selects a WLAN AN and establishes the WLAN connection and is authenticated in I-WLAN. The WLAN AN may send the current location of WLAN AN to the WLAN UE. The WLAN AN may send its location to the AAA. The tunnel may be established with between WLAN UE and one of PDGs in PLMN.\n2.\tAn external LCS client sends the LCS request to the GMLC. An external LCS client requests the current location, e.g. immediate location request, from a GMLC. The LCS Client may also request a triggered location request, e.g. periodic or change of area event. The GMLC verifies the identity of the LCS client and its subscription to the LCS service requested and derives the MSISDN or IMSI or pseudonym of the target UE to be located and the LCS QoS from either subscription data or data supplied by the LCS client.\nThe LCS request may carry also the Service Identity and the Codeword. The GMLC may verify that the Service Identity received in the LCS request matches one of the service identities allowed for the LCS client. If the service identity does not match one of the service identities for the LCS client, the GMLC shall reject the LCS request. Otherwise, the GMLC can map the received service identity in a corresponding service type.\nIf the location request is originated by a Requestor, the Requestor Identity may be added to the LCS service request. The LCS client should authenticate the Requestor Identity but this is outside the scope of this specification. The LCS service request may also contain the type of the Requestor identity if the requestor identity was included.\nThe GMLC performs privacy check on the basis of the UE user's privacy profile stored in the GMLC or PPR.\n3.\tSteps 3 and 4 may be skipped if the GMLC already has the address of the AAA server. Steps 3 to 6 may be skipped if the GMLC has alternative access to the UE's IP address (e.g. using dynamic DNS or from a previous interaction with the UE) or is able to instigate step 7 without knowing this address (e.g. using MT-SMS or WAP Push in the case of SUPL). GMLC requests the address of AAA server and WLAN UE capability to the HSS. In this case, the capability information of the WLAN UE refers to capability information of the terminal relevant to positioning such as whether the terminal supports the OMA SUPL (OMA AD SUPL [38], OMA TS ULP [39]) or whether it supports another location procedures.\n4.\tHSS returns the address of AAA server of the target WLAN UE and the capability of the WLAN UE to GMLC.\n5.\tIf the target WLAN UE supports the OMA SUPL, GMLC queries AAA to obtain the address of WLAN UE. GMLC may request the location of WLAN UE.\n6.\tIf its location is available and the quality of position meets the LCS QoS requested by GMLC, then AAA responds with available location information of the WLAN UE to the GMLC. Otherwise, GMLC retrieves the address of WLAN UE from AAA. If there is no tunnel is available between the PDG and the WLAN UE, the AAA will return an indication that UE is not reachable.\n7.\tGMLC initiates positioning procedure. This shall use SUPL procedures based on OMA SUPL (OMA AD SUPL [38], OMA TS ULP [39]). If the tunnel between the WLAN UE and the PDG is available and the GMLC has obtained the UE IP address, GMLC generates an SUPL initiation message, and transmits it to the WLAN UE by using the address of WLAN UE over available IP connection between the WLAN UE and the PDG. If the tunnel between the WLAN UE and the PDG is not available or if the GMLC did not obtain the UE IP address, GMLC sends an SUPL initiation message using the UE IP address if available or by other means (e.g. MT-SMS or WAP Push).\n8.\tThe location information obtained will be transferred to external LCS client.\nNOTE 2:\tThe GMLC may, as an implementation option, cache the results received in step 4 and/or step 6 in order to avoid further queries when a location request is received for the same target UE at a later time and the AAA server address and/or WLAN UE address, respectively, has not changed.",
      "chunk_type": "procedure",
      "cross_references": [
        "figure_9.16",
        "ts_23.234"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.14",
      "section_id": "9.1.14",
      "section_title": "IW-MT-LR Procedure without HLR/HSS or AAA Query",
      "content": "This procedure is applicable to the I-WLAN defined in TS 23.234 [52] and it is no longer maintained.\nFigure 9.17 illustrates current or last known location requests for an emergency services call, where an emergency services client (i.e. a Public Safety Answering Point) requests updated location information for the target UE. In order to support location of emergency call s from UICC-less terminals, TS 23.167 [36a] specifies that the IMS core shall push information identifying the terminal to the PSAP and GMLC during establishment of the emergency call.\nNOTE 1:\tIn some regions, based on regional specifications, the GMLC may use correlation information that was previously provided to it by the IMS Core to identify the target UE.\nThe IMS core also sends the correlation information to the PSAP during the call establishment as described in TS 23.167 [36a]. Using the correlation key the PSAP may request the initial or updated location information from the GMLC. The management of this regional correlation information (e.g. ESQK in North America) and support of the Le interface to the external LCS Client may be handled by a separate functional entity from the GMLC, e.g. a RDF as defined in TS 23.167 [36a].\nFigure 9.17: IW-MT-LR without an HLR/HSS or AAA Query\n1.\tThe WLAN UE selects a WLAN AN and establishes the WLAN connection and may be authenticated in I-WLAN. The tunnel is established between the WLAN UE and a PDG in PLMN.\n2.\tThe WLAN UE establishes an emergency services call as described in TS 23.167 [36a]. The UE determines its own location if possible. The UE may include the identifier of access node (e.g., MAC address of the AP), if available, as location identifier in the session request and possibly other readily available location information, e.g. GPS based coordinates or the street address of the UE or the AP as provided by the user of the UE. If the UE is not able to determine its own location, the UE may, if capable, request the location information from the IP‑CAN or SLP. The case when the UE requests its own location information or enhanced location information from the SLP using OMA-SUPL is described in clause 9.2.5. The IP-CAN may return a representation of the location information to the UE. During this step, the IMS core may push the WLAN UE's identification and the location information  provided by the UE to the LRF (GMLC) along with correlation information, if applicable. The GMLC may record this information but in some regions only for the duration of the call as the case may be. The correlation information may be regionally specific (e.g. as is the case for support of location for an emergency call in the CS domain in clause 9.1.3). The IMS core shall also send the correlation information to the PSAP/ emergency centre during the call establishment as specified in TS 23.167 [36a].\nNOTE 2:\tThe mechanism used by the UE to obtain location information from the I‑WLAN IP‑CAN is out of scope. One method that could be used is the mechanism defined by IEEE 802.11k Task Group for carrying location information (per RFC 3825) from one IEEE 802.11 station/AP to another IEEE 802.11 station/AP.\n3.\tAn external LCS client associated with the emergency centre PSAP sends a location request to the GMLC for the initial location or an updated location for the WLAN UE. The request may include the address and the identification of the WLAN UE and in some regions may include correlation information that enables the GMLC to associate the request with the information stored in step 2.\n4.\tIf initial location was requested the procedure continues from step 5. If updated location was requested the GMLC initiates a positioning procedure where either the UE or GMLC determines the position of the UE. GMLC/SLP shall request the UE to establish a so called user plane connection with the GMLC/SLP and use the OMA SUPL mechanism specified by OMA (OMA AD SUPL [38], OMA TS ULP [39]) to transport location related assistance data and location information between the UE and GMLC/SLP. The UE may send the identifier of the access node (e.g. MAC address of the AP) to the GMLC and GMLC, possibly using an external database, maps this location identifier to the corresponding geographical information, e.g. coordinates or street address. GMLC may return this geographical information to the UE.\nNOTE 3:\tThe location information obtained based on the mapping of an identifier of access node (e.g. MAC address of the AP) to location information stored in a database may not be correct, e.g. the location of the AP might be changed without any updates to the database.\n5.\tGMLC sends the initial location information, if so requested, or the updated location information obtained in step 4 to the external LCS client.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.5",
        "clause_9.1.3",
        "figure_9.17",
        "ts_23.167_figure_9.17",
        "ts_23.234",
        "ts_23.167"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.15",
      "section_id": "9.1.15",
      "section_title": "EPC Mobile Terminating Location Request (EPC-MT-LR)",
      "content": "Figure 9.18 illustrates the general network positioning for LCS clients external to the PLMN for EPC services. In this scenario, it is assumed that the target UE is identified using an MSISDN or IMSI. This procedure is applicable to a request from an LCS client for a current location, current or last known location or a deferred location for the UE availability event.\nFigure 9.18: General Network Positioning for EPC-MT-LR",
      "chunk_type": "general",
      "cross_references": [
        "figure_9.18"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.15.1",
      "section_id": "9.1.15.1",
      "section_title": "Location Preparation Procedure",
      "content": "1)\tFor a request for a current location or a current or last known location the common PS and CS MT-LR procedure is performed as described in clause 9.1.1. For a request for a deferred location for the UE availability event, steps 1 and 2 of the deferred location request procedure are performed as described in clause 9.1.8.1.\n2)\tGMLC sends a Provide Subscriber Location message to the MME indicated in step 1. This message carries the type of location information requested (e.g. current location and optionally, velocity), the UE subscriber's IMSI, LCS QoS information (e.g. accuracy, response time) and an indication of whether the LCS client has the override capability. For a session related location request, the message also carries the APN-NI to which the UE user has established the session. For a value added LCS client, the message shall carry the client name, the external identity of the LCS client and the Requestor Identity (if that is both supported and available), optionally the message may also carry the Service Type. Also the message may carry the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. If the result of the privacy check at H-GMLC/PPR indicated that the codeword shall be sent to the UE user, the message may carry also the codeword received from the LCS client. For a PLMN operator LCS client, the message shall carry the internal identity of the LCS client. If the Requestor Identity is provided, the GMLC shall send it as separate information. The message also shall carry the indicators of privacy related action which is described in clause 9.5.4, if it is provided by H-GMLC. If a deferred location was requested in step 1 for the UE availability event and if the GMLC supports delayed location reporting for UEs transiently not reachable ( i.e. because they are in extended idle mode DRX or PSM), the GMLC shall indicate support of delayed location reporting in this message.\nNOTE 1:\tFor a deferred location request for the UE availability event, the GMLC interworks the procedure in clause 9.1.8 as applicable to the LCS client, R-GMLC, H-GMLC, HSS and V-GMLC with the procedure in this clause as applicable to the GMLC, MME, E-SMLC, RAN and UE. This means, for example, that the LDR reference number assigned by the H-GMLC in step 2 in clause 9.1.8.1 is not transferred by the GMLC to the MME in step 2 but is returned by the GMLC to the H-GMLC in steps 2b and 10.\n2a)\tIf the GMLC indicates support of delayed location reporting in step 2 and the MME supports delayed location reporting for UEs transiently not reachable, the MME sends a Provide Subscriber Location ack message with a \"UE transiently not reachable\" indication. In this case, steps 9a and 9b are executed instead of step 9. If the GMLC indicates support of delayed location reporting in step 2, and the MME does not support delayed location reporting and the UE is transiently not reachable, a Provide Subscriber Location return error shall be returned with a suitable cause.\nNOTE 2:\tFor compatibility with support of deferred location between an LCS client, R-GMLC and H-GMLC as defined in clause 9.1.8, if the GMLC and MME both support delayed location reporting, the MME returns a Provide Subscriber Location ack message in step 2a even if the UE is currently reachable. This will minimize delay in notifying the LCS client that the deferred location request was accepted.\n2b)\tIf step 2a occurs, the GMLC returns an LCS Service Response to the LCS Client by instigating steps 5, 6 and 7 of the procedure in clause 9.1.8.1.\n3)\tIf the GMLC is located in another PLMN or another country, the MME first authenticates that a location request is allowed from this PLMN or from this country. If not, an error response is returned. Secondly the MME checks if the UE is detached or suspended and in either such case an error response is returned. If the PSL message from the GMLC includes the indicators of privacy related action, the MME determines a required privacy related action as described in clause A.3.\nIf the UE is not using Control Plane CIoT EPS Optimisation and if the UE is in ECM-IDLE state and is not in power saving mode and is currently reachable, the MME performs a network triggered service request as defined in TS 23.401 [41] in order to establish a signalling connection with the UE and assign a specific eNodeB. If step 2a was performed and the UE is transiently not reachable, the MME waits until the UE next becomes reachable and then performs a network triggered service request if needed to establish a signalling connection with the UE.\nIf the UE is using Control CIoT EPS Optimisation, procedures for Mobile Terminated Data Transport in Control Plane CIoT EPS optimisation as defined in TS 23.401 [41] are performed by the MME to establish a signalling connection with the UE.\n4)\tIf the location request comes from a value added LCS client and the indicators of privacy related action indicates that the UE must either be notified or notified with privacy verification and the UE supports notification of LCS, a notification invoke message is sent to the target UE indicating the type of location request from the LCS Client (e.g. current location or \"current or last known location\") and the identity of the LCS client and the Requestor Identity (if that is both supported and available), whether privacy verification is required. Also the message may indicate the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. Moreover, the message may carry also the service type and the codeword. Optionally, the MME may after sending the NAS Location Notification Invoke message continue in parallel the location process, i.e. continue to step 6 without waiting for a LCS Location Notification Return Result message in step 5.\n5)\tThe target UE notifies the UE user of the location request and, if privacy verification was requested, waits for the user to grant or withhold permission. The UE then returns a notification result to the MME indicating, if privacy verification was requested, whether permission is granted or denied. Optionally, this message can be returned some time after step 4, but before step 9. If the UE user does not respond after a predetermined time period, the MME shall infer a \"no response\" condition. The MME shall return an error response to the GMLC if privacy verification was requested and either the UE user denies permission or there is no response with the UE privacy profile received from the GMLC indicating barring of the location request.\n6)\tThe MME selects a E-SMLC as described in clause 6.3.13 and sends a Location Request message to the selected E-SMLC. Once an MME has selected an E-SMLC it must continue to use that E-SMLC for the duration of the session. The Location Request includes the type of location information requested, the requested QoS, identity of serving cell, UE location capabilities and, if available, the Service Type. If the UE is in power saving mode, steps 4 and 5 do not apply, the location request specifies current or last known location and the MME has stored the last serving cell for the UE, this step may be performed to obtain the last known location. The location request also indicates RAT type and/or coverage level if applicable. If this step is performed after the MME receives the NAS Location Notification Return Result in step 5, the Location Request message contains the identity of the serving cell obtained from the S1-AP message that carries the NAS Location Notification Return Result.\nNOTE 3:\tIf the UE is in connected mode and step 6 is performed without receiving NAS Location Notification Return Result in step 5, the MME may not have the most current serving cell identity if there was an intra-eNodeB handover.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.1",
        "clause_9.1.8.1",
        "clause_9.5.4",
        "clause_9.1.8",
        "clause_6.3.13",
        "ts_23.401"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.15.2",
      "section_id": "9.1.15.2",
      "section_title": "Positioning Measurement Establishment Procedure",
      "content": "7)\tIf the requested location information and the location accuracy within the QoS can be satisfied based on parameters received from the MME, e.g. cell identity, the E-SMLC may send a Location Response immediately. If the requested location information indicates a last known location, the E-SMLC shall determine a last known location based on the cell identity and send a Location Response immediately. Otherwise, the E-SMLC determines the positioning method and instigates the particular message sequence for this method as described in clause 9.3a. If the position method returns position measurements, the E-SMLC uses them to compute a location estimate. If there has been a failure to obtain position measurements, the E-SMLC may use the current cell identity to derive an approximate location estimate. If an already computed location estimate is returned for an UE based position method, the E-SMLC may verify consistency with the current cell. If the location estimate so obtained does not satisfy the requested accuracy and sufficient response time still remains, the E-SMLC may instigate a further location attempt using the same or a different position method. If a vertical location co ordinate is requested but the E-SMLC can only obtain horizontal co-ordinates, these may be returned.\nNB-IoT UEs may perform measurements for some positioning methods only when in ECM-IDLE state. An E-SMLC that is aware of this (e.g. from an indication sent by the UE) may allow additional response time to the UE (e.g. in the QoS) to obtain the measurements. An MME that is aware of this (e.g. from the UE access type) may also allow additional time for a location session to complete.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.3"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.15.3",
      "section_id": "9.1.15.3",
      "section_title": "Location Calculation and Release Procedure",
      "content": "8)\tWhen location information best satisfying the requested location type and QoS has been obtained, the E-SMLC returns it to the MME in a Location Response message. E-SMLC shall in its response include an indication whether the obtained location estimate satisfies the requested accuracy or not. The information of the positioning method used may be returned with the location information. If a location estimate could not be obtained, the E-SMLC returns a Location Response message containing a failure cause and no location estimate.\n9)\tThis step is executed only if step 2a was not executed. The MME returns the location information, its age and obtained accuracy indication to the GMLC, if the MME has not initiated the Privacy Verification process in step 4. If step 4 has been performed for privacy verification, the MME returns the location information only, if it has received a NAS Location Notification Return Result indicating that permission is granted. In these cases, the information about the positioning method used may be sent with the location information. If a NAS Location Notification Return Result message indicating that permission is not granted is received, or there is no response, with the requested privacy action or the UE subscription profile indicating barring of location, the MME shall return an error response to the GMLC. If the MME did not return a successful location estimate, but the privacy checks were successfully executed, the MME may return the last known location of the target UE if this is known and the LCS client is requesting the current or last known location. The MME may record charging information.\n9a)\tThis step is executed only if step 2a was executed. The MME shall send a Subscriber Location Report to the GMLC, and, if these were obtained in steps 6 to 8, the location information, its age and obtained accuracy indication to the GMLC, if the MME has not initiated the Privacy Verification process in step 4. If step 4 has been performed for privacy verification, the MME sends the location information only, if it has received a NAS Location Notification Return Result indicating that permission is granted. In these cases, the information about the positioning method used may be sent with the location information. If a NAS Location Notification Return Result message indicating that permission is not granted is received, or there is no response, with the requested privacy action or the UE subscription profile indicating barring of location, the MME shall send an error indication to the GMLC. The MME shall include in the Subscriber Location Report any identities for the UE received in step 2. The MME may record charging information. If MME relocation or change of MME happens before location information can be obtained or reported, the old MME includes an error cause code indicating that it cannot proceed with the request and includes the address of the new MME if available. The GMLC may reiterate then its request towards the new MME.\n9b)\tIf step 9a was executed, the GMLC shall acknowledge receipt of the Subscriber Location Report.\n10)\tFor a request for a current location or a current or last known location in step 1, the common MT-LR procedure in PS and CS domain as described in clause 9.1.1 is performed. For a request for a deferred location for the UE availability event in step 1, steps 11, 13, 14 and 15 of the procedure in clause 9.1.8.2 are performed.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.1",
        "clause_9.1.8.2"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.16",
      "section_id": "9.1.16",
      "section_title": "EPC-MT-LR without HLR Query",
      "content": "Figure 9.19 illustrates current or last known location requests for an emergency services call, where an emergency services client (i.e., a Public Safety Answering Point) identifies the target UE and the serving LRF using correlation information that was previously provided to it by the IMS Core. The signalling used to provide the correlation information to the PSAP is defined in TS 23.167 [36a]. The correlation information may be used by the LRF to retrieve other information previously provided to it by the IMS Core as per TS 23.167 [36a] and/or MME as described in clause 9.1.17. This allows the V GMLC associated with the LRF to request location from the MME without first querying the home HLR of the target UE. This scenario therefore supports location of emergency calls from roamers or SIM-less emergency calls, or non-registered (U)SIM emergency calls, and requires that the initial location, as well as UE and MME identifying information had been pushed to the GMLC/LRF as per clause 9.1.17 or as per TS 23.167 [36a].\nFigure 9.19: Positioning for a Emergency Services EPC-MT-LR without HLR Query\n1)\tSame as step 1 in figure 9.1 but with the LCS client (PSAP) identifying first the target UE and the serving LRF by previously supplied correlation information for the emergency call.\n2)\tThe LRF/GMLC may determine the MME by associating the correlation information received from the PSAP with other information received previously from the MME using an EPC NI LR as in clause 9.1.17 and/or from the IMS core as in TS 23.167 [36a]. The Provide Subscriber Location message sent to the MME carries, if available, the MSISDN or the IMSI and, if available, the IMEI for the target UE, as well as the required QoS and an indication of a location request from an emergency services client. The MME identifies the target UE using the IMSI, MSISDN and/or the IMEI. In case of a SIM-less emergency call, or non-registered (U)SIM emergency call, the IMEI shall be always sent.\n3)\tThe MME sends a Location Request to the E-SMLC, as for a normal EPC MT LR.\n4)\tE-SMLC performs positioning as for a normal EPC MT LR.\n5)\tE-SMLC returns a location estimate to the MME as for a normal EPC MT LR.\n6)\tThe MME returns the location information, its age and obtained accuracy indication to the LRF/GMLC. The information about the positioning method used may be sent with the location information. If the E-SMLC did not return a successful location estimate, the MME may return the last known location of the target UE if this is known and the LCS client is requesting the current or last known location.\n7)\tThe LRF sends the location service response to the LCS client (PSAP).\nNOTE:\tThe MME determined by the LRF/GMLC in step 2 must be the current MME for the UE. In the event of handover to a new MME, this may require updating of the GMLC using the EPC NI LR procedure in clause 9.1.17.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.17",
        "ts_23.167_clause_9.1.17",
        "figure_9.19",
        "ts_23.167_figure_9.19",
        "figure_9.1",
        "ts_23.167"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.17.0",
      "section_id": "9.1.17.0",
      "section_title": "General",
      "content": "At any time after detecting an emergency situation (i.e. after emergency Attach, UE requested emergency PDN Connectivity), the MME may initiate the EPC Network Induced Location Request (EPC NI LR) procedure. The procedure can also be used to verify a UE location (country or international area) for NB-IoT, LTE-M and WB EUTRAN satellite access (see TS 23.401 [41]). The procedure is illustrated in figure 9.20.\nFigure 9.20: Network Induced Location Request for EPC\n1)\tA trigger to initiate the EPC-NI-LR procedure happens, e.g. when an emergency attach or emergency PDN connection establishment is detected, or when the MME decides to verify the UE location (country or international area) via LCS service for a UE registering or registered for NB-IoT, LTE-M or WB-EUTRAN satellite access. For the emergency call invocation from the user, the UE performs emergency attach if not attached or requests emergency PDN connection if already normal attached. As part of the Attach procedure, the UE support of LPP indication is provided by the UE to the MME.\n2)\tThe MME selects a E-SMLC as described in clause 6.3.13 and sends a Location Request message to the selected E-SMLC. Once an MME has selected an E-SMLC it must continue to use that E-SMLC for the duration of the session. The Location Request includes the type of location information requested, the requested QoS, identity of serving cell, Coarse Location Information (in the case of satellite access for NB-IoT) and UE capability to support LPP. When MME needs to know the country of the UE, an indication of this is included and in the case of satellite access for NB-IoT, if the MME has received Coarse Location Information from the UE, as described in TS 23.401 [41], the MME provides this information in the Location Request.\nNOTE:\tIf the UE is in connected mode and step 2 was not performed immediately after step 1, the MME may not have the most current serving cell identity if there was an intra-eNodeB handover.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6.3.13",
        "figure_9.20",
        "ts_23.401"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.17.1",
      "section_id": "9.1.17.1",
      "section_title": "Positioning Measurement Establishment Procedure",
      "content": "3)\tIf the requested location information and the location accuracy within the QoS can be satisfied based on parameters received from the MME, e.g. cell identity or Coarse Location Information, the E-SMLC may send a Location Response immediately. In the case of satellite access for NB-IoT and if Coarse Location Information was provided in step 2, the E-SMLC shall send a Location Response immediately. Otherwise, the E-SMLC determines the positioning method and instigates the particular message sequence for this method as described in clause 9.3a. If the position method returns position measurements, the E-SMLC uses them to compute a location estimate. If there has been a failure to obtain position measurements, the E-SMLC may use the current cell identity to derive an approximate location estimate. If an already computed location estimate is returned for an UE based position method, the E-SMLC may verify consistency with the current cell identity. If the location estimate so obtained does not satisfy the requested accuracy and sufficient response time still remains, the E-SMLC may instigate a further location attempt using the same or a different position method. If a vertical location co-ordinate is requested but the E-SMLC can only obtain horizontal co-ordinates, these may be returned. If the MME included an indication of UE country determination at step 2, the E-SMLC maps the location estimate to a country or an international area.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.3"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.17.2",
      "section_id": "9.1.17.2",
      "section_title": "Location Calculation and Release Procedure",
      "content": "4)\tWhen a location estimate best satisfying the requested QoS has been obtained, the E-SMLC returns a Location Response to the MME with an indication whether the obtained location estimate satisfies the requested accuracy or not. This message carries the location estimate that was obtained. If a location estimate was not successfully obtained, a failure cause is included in the Location Response. When UE country determination is indicated at step 2, E-SMLC also returns an indication of the country or international area determined at step 3. If in step 1 the MME decided to verify the UE location (country or international area) via LCS service for a UE registering or registered for NB-IoT, LTE-M or WB-EUTRAN satellite access, the remaining steps are skipped.\n5)\tThe MME may determine the GMLC and emergency services client using the cell identity or the location estimate or according to some fixed association for the MME. The MME shall send a Subscriber Location Report to the GMLC carrying the IMEI and if available the IMSI and MSISDN of the UE, the event causing the message (EMERGENCY_CALL_ORIGINATION), and, if these were obtained in steps 2 to 4, the location estimate and its age and the indication received from E-SMLC whether the obtained location estimate satisfies the requested accuracy or not. The serving cell identity of the UE may also be sent if available. The MME shall include its own address. The MME may record charging information.\n6)\tThe GMLC shall acknowledge receipt of the location estimate provided that the associated LRF serves the emergency services LCS client and the client is accessible. These conditions would normally be fulfilled if the LRF either already has created, or expects to later create, a record for the UE for the emergency services session as described in clause 9.8.4.\n7)\tThe LRF associated with the GMLC treats the received location estimate as described in clause 9.8.4: e.g. may use the location information to assist routing of the emergency session to the PSAP/emergency centre and/or may transfer the location information to the emergency services LCS client immediately or upon request from the client. The LRF/GMLC may store the information received in step 5: e.g. may store the UE identity and the address of the MME. The LRF/GMLC may record charging information.\n8)\tAt some point, MME determines that emergency service is no longer active (e.g. EPS bearer for emergency service is deactivated).\n9)\tThe MME may send a Subscriber Location Report to the GMLC carrying the same UE's information as in step 5 and the event causing the message (EMERGENCY_CALL_RELEASE).\n10)\tThe GMLC shall acknowledge receipt of the location report from MME.\nNOTE:\tDetermination of the GMLC in step 5 must ensure a match with any LRF/GMLC used by the IMS Core to assist with location retrieval for, and/or routing of, the IMS Emergency call as described in clause 9.8.4.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.8.4"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.18",
      "section_id": "9.1.18",
      "section_title": "EPC Post Positioning Notification and Verification Procedure",
      "content": "Figure 9.21 illustrates the post positioning notification and verification procedure.\nFigure 9.21: EPC Post Positioning Notification and Verification Procedure\n1)\tCommon PS and CS MT-LR procedure as described in clause 9.1.1.\n2)\tThe GMLC sends a Provide Subscriber Location message to the MME with an indication of \"notification only\". This message carries the UE subscriber's IMSI. For a session related location request, the message also carries the APN-NI to which the user has established the session. For a value added LCS client, the message shall carry the client name, the external identity of the LCS client and the Requestor Identity (if that is both supported and available), optionally the message may also carry the Service Type. Also the message may carry the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. If the result of the privacy check at H-GMLC/PPR indicated that the codeword shall be sent to the UE user, the message may carry also the codeword received from the LCS client. For a PLMN operator LCS client, the message shall carry the internal identity of the LCS client. If the Requestor Identity is provided, the GMLC shall send it as separate information.\n3)\tThe MME first checks if the UE is detached or suspended. If this is the case, an error response is returned. The MME determines a required privacy related action as described in Annex A.3 based on the indicators of privacy related action in the PSL message from the GMLC.\nIf the UE is not using Control Plane CIoT EPS Optimisation and if the UE is in ECM-IDLE state, the MME performs a network triggered service request as defined in TS 23.401 [41] in order to establish a signalling connection with the UE and assign a specific eNodeB.\nIf the UE is using Control Plane CIoT EPS Optimisation, procedures for Mobile Terminated Data Transport in Control Plane CIoT EPS optimisation as defined in TS 23.401 [41] are performed by the MME to establish a signalling connection with the UE.\n4)\tA notification invoke message is sent to the target UE indicating a location type of notification and verification only, the identity of the LCS client and the Requestor Identity (if that is both supported and available), whether privacy verification is required. Also the message may indicate the type of the LCS client name and also the type of the Requestor identity if the requestor identity was included. Moreover, the message may carry also the service type and the codeword.\n5)\tThe target UE notifies the UE user of the location request and, if privacy verification was requested, waits for the user to grant or withhold permission. The UE then returns a notification result to the MME indicating, if privacy verification was requested, whether permission is granted or denied. If the UE user does not respond after a predetermined time period, the MME shall infer a \"no response\" condition. The MME shall return an error response to the GMLC if privacy verification was requested and either the UE user denies permission or there is no response with the UE subscription profile indicating barring of the location request.\n6)\tThe MME returns the indication of successful notification and verification result, if it has received a NAS Location Notification Return Result indicating that permission is granted. If a LCS Location Notification Return Result message indicating that permission is not granted is received, or there is no response, with the requested privacy action or the UE subscription profile indicating barring of location, the MME shall return an error response to the GMLC.\n7)\tCommon MT-LR procedure in PS and CS domain as described in clause 9.1.1.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.1",
        "figure_9.21",
        "ts_23.401"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.19",
      "section_id": "9.1.19",
      "section_title": "Deferred EPC-MT-LR for Periodic and Triggered Location",
      "content": "The procedures for periodic and triggered location for EPC services support instigation and cancellation of location reporting at periodic intervals or whenever some other trigger event is detected by the UE. The supported trigger events comprise an area event (where a UE enters, leaves or remains within a predefined area) and a motion event. In this version of the specification, only one type of reporting may be included in any request from among periodic, area event and motion event. In the case of the area event, a target area can be defined by a geographical area, PLMN identity, country code or geopolitical name. Details of the target area are contained in the LCS Service Request message, see clause 5.5.1. In the case of the motion event, motion corresponds to movement by the UE exceeding a linear distance threshold from a previous location. The procedure supports UE mobility between different serving MMEs and different serving PLMNs without interruption of event reporting.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.5.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.19.1",
      "section_id": "9.1.19.1",
      "section_title": "Instigation and Reporting of Periodic and Triggered Location",
      "content": "Figure 9.1.19.1-1 illustrates the procedure used to instigate and perform event reporting for a periodic and triggered EPC-MT-LR request from an LCS client.\nFigure 9.1.19.1-1: Deferred EPC-MT-LR procedure for Periodic and Triggered Location\n1)\tThe LCS Service Request provides the type of periodic or triggered location reporting being requested and associated parameters. For periodic location, the LCS Service Request includes the time interval between successive location reports, the total number of reports and may include location QoS. For area event reporting, the LCS Service Request includes details of the target area, whether the event to be reported is the UE being inside, entering into or leaving the target area, the duration of event reporting, the minimum and maximum time intervals between successive event reports, the maximum event sampling interval, whether location estimates shall be included in event reports (and associated location QoS), and whether only one location report is required or more than one. If the target area is expressed by a local coordinate system or a geopolitical name, the R-GMLC shall convert the target area to a geographical area expressed by a shape as defined in TS 23.032 [11]. For motion event reporting, the LCS Service Request includes the threshold linear distance, the duration of event reporting, the minimum and maximum time intervals between successive event reports, the maximum event sampling interval, whether location estimates shall be included in event reports (and associated location QoS), and whether only one location report is required or more than one.\n2)\tLCS service request handling is performed between GMLCs as described in clause 9.1.1. The information received by the R-GMLC is transferred to the H-GMLC. The H-GMLC should record the received information and relevant parameters. The H-GMLC assigns an LDR reference number to the LCS Service request and an optional list of reporting PLMNs (which should include the serving PLMN), then transfers the information to the V-GMLC, including the LDR reference number, the H-GMLC address and any list of reporting PLMNs.\n3)\tIn case area event reporting is requested, if the target area is defined by a shape in TS 23.032 [11], the V-GMLC converts the target area into a corresponding list of cell identities and/or tracking areas. If the V-GMLC cannot convert the entire target area into network identities, it shall reject the request and send an LCS service response to the H-GMLC with the appropriate error cause. The V-GMLC then conveys the location request to the MME in a Provide Subscriber Location request including details of the events to be reported, the LDR reference number, the H-GMLC address and any list of reporting PLMNs.\n4)\tThe MME verifies the UE capabilities with regard to the support of location service related call independent supplementary services (e.g. notification for LCS). If either the UE does not support location service related call independent supplementary services or the MME does not support the deferred location request for periodic and triggered location (for temporary or permanent reasons), a Provide Subscriber Location error response shall be returned with a suitable error cause. Otherwise, the MME returns a Provide Subscriber Location Ack. to confirm that the request has been accepted by the MME.\nNOTE 1:\tThere is no UE capability information directly indicating support of a deferred periodic and triggered location request. However, if the UE supports at least one location service related call independent supplementary service (such as notification for LCS), the MME can assume support for deferred periodic and triggered location. If the UE does not recognize the request in step 9, it may return a Facility Rejected indication in step 10 (as defined in TS 24.008 [24]) to the MME in which case, the MME would terminate the request by instigating steps 19-24 with an appropriate error cause in the Subscriber Location Report sent at step 19.\n5) to 7)\tThe V-GMLC returns the LCS Service Response via the H-GMLC and R-GMLC to the LCS Client to notify whether the periodic and triggered location request was accepted or not. When the H-GMLC returns the LCS Service Response to the R-GMLC, the LDR reference number assigned by the H-GMLC shall be included, and the R-GMLC may transfer the LDR reference number, or another reference number assigned by the R-GMLC, to the LCS Client in the LCS Service Response.\nNOTE 2:\tThe LCS Service Response does not confirm that location reporting was activated in the UE or that the UE will necessarily be able to support the request. However, the response does confirm the capability and intent to support the request on the network side and may be useful to the LCS client when a response from the UE is delayed due to the UE being temporarily unreachable (e.g. if in PSM).\n8)\tIf the UE is currently not reachable (e.g. when in PSM), the MME waits until the UE again becomes reachable. When the UE is reachable, if the UE is in ECM-IDLE state, the MME performs paging, authentication and ciphering. If privacy notification/verification was requested and the UE supports location service related call independent supplementary services, the MME sends an LCS Location Notification Invoke message to the target UE with a location type indicating activation of a deferred location request, a deferred location event type indicating the type of event (i.e. entering into area, leaving from area, being inside area, periodic or motion) and an indication as to whether privacy verification is required. LCS Location Notification is further specified in clause 9.1.15. If privacy verification was requested, the UE returns an LCS Location Notification Return Result to the MME indicating whether permission is granted or denied. If the UE denies permission or does not return a response when a response is required, the MME terminates the request as described for step 11. If the UE changes serving MME before becoming reachable from the MME, the MME returns a Subscriber Location Report to the V-GMLC indicating a change of MME and including the new MME address if available. The V-GMLC may then forward the error to the LCS client via the H-GMLC and R-GMLC or repeat step 3 to transfer the periodic and triggered location request to the new MME if provided. In this case, when step 4 recurs, the V-GMLC does not repeat steps 5-7 as the LCS client was already informed of network acceptance of the request.\n9)\tThe MME sends an LCS Periodic-Triggered Event Invoke to the UE carrying all of the event related information received from the V-GMLC, the LDR reference number, the H-GMLC address, the list of reporting PLMNs if provided and any requested QoS in the case that location estimates are required.\n10)\tIf the UE supports periodic and triggered location according to the request received in step 9 and currently has resources to service the request, the UE sends an acknowledgement to the MME. Otherwise, the UE sends a return error response to the MME with a suitable error cause.\n11)\tIf the UE cannot support the periodic and triggered location request, a Subscriber Location Report shall be returned to the V-GMLC with a suitable error cause and including the LDR reference number and H-GMLC address. Otherwise, if the UE confirms support of the periodic and triggered location request, a Subscriber Location Report shall be returned to the V-GMLC indicating that event reporting was activated in the UE and including the LDR reference number and H-GMLC address. If location estimates are required for subsequent event reports, the MME should obtain the current UE location as in steps 15-17 and include the location estimate in the Subscriber Location Report. The V-GMLC returns an LCS Service Response via the H-GMLC and R-GMLC to the LCS Client to notify whether the periodic and triggered location request was activated in the UE. When the H-GMLC returns the LCS Service Response to the R-GMLC, the LDR reference number assigned by the H-GMLC and H-GMLC address shall be included, and the R GMLC may transfer the LDR reference number to the LCS Client in the LCS Service Response. The V-GMLC, H-GMLC and/or R-GMLC may record charging information for the request. Following step 11, the MME and V-GMLC may release all resources for the request including any state information.\nNOTE 3:\tThe LCS Service Response with an activation indication confirms to the LCS client that event reporting has started in the UE.\n12)\tFor the area event or motion event, the UE monitors the requested event at intervals equal to or less than the maximum event sampling interval. An event trigger is detected by the UE when any of the following occur: (i) a requested area event or motion event has been detected and the minimum reporting time interval has elapsed since the last report (if this is not the first event report); (ii) a requested periodic location event has occurred; or (iii) the maximum reporting time for an area event or motion event has expired. When an event trigger is detected, the UE proceeds to step 13 once the UE can register via E-UTRAN access with a PLMN in the list of reporting PLMNs received at step 9 or with the original serving PLMN if no list of reporting PLMNs was provided or if the UE does not support the list of reporting PLMNs. If the UE cannot register with a permitted PLMN, the UE waits until a permitted PLMN can be accessed in order to report the event, or for the periodic and triggered location request to terminate due to cancellation by the LCS client, cancellation by the UE or expiration of the allowed duration.\nNOTE 4:\tIf the UE uses a different serving PLMN to report occurrence of the area event, the UE still continues to use the target area provided by the original serving PLMN which contains cell IDs and/or TAs for the original serving PLMN.\nNOTE 5:\tThe restriction to use only permitted PLMNs does not affect PLMN selection.\n13)\tIf the UE is not using Control Plane CIOT EPS Optimisation and if the UE is in ECM-IDLE state, the UE performs a UE triggered service request or connection resume as defined in TS 23.401 [41] in order to obtain a signalling connection to a serving MME.\nIf the UE is using Control Plane CIoT EPS Optimisation, procedures for Mobile Originated Data Transport in Control Plane CIoT EPS optimisation as defined in TS 23.401 [41] are performed by the UE to establish a signalling connection with the MME.\nNOTE 6:\tThe MME and V-GMLC for steps 13 to 24 may be different to the MME and V-GMLC for steps 1 to 11.\n14)\tThe UE sends an LCS MO-LR Invoke to the MME indicating an event report for a deferred periodic and triggered location request. The message includes the type of event trigger being reported (e.g. whether a normal event or expiration of the maximum reporting interval), the LDR reference number, H-GMLC address and whether a location estimate is required. When a location estimate is required (e.g. for a periodic location event or for an area event or motion event if requested by the LCS client), the UE shall include any QoS received in step 9 and a location estimate if a location estimate is currently available. The UE shall also indicate whether the periodic and triggered location request is now terminated in the UE (e.g. due to expiration of the reporting duration or because only one event report was requested).\nNOTE 7:\tProvision of a location estimate when requested also applies to the trigger event corresponding to expiration of the maximum reporting interval for an area event or motion event.\n15-17)\tIf the UE indicates that a location estimate is required in step 14, the MME shall instigate location of the UE as described in steps 6-8 of clause 9.1.15 if a location estimate is not provided by the UE in step 14 and may optionally instigate location of the UE if a location estimate is provided by the UE in step 14. In the latter case, the location estimate provided by the UE shall be included in the location request sent to the E-SMLC in step 15.\n18)\tThe MME sends an MO-LR Return Result to the UE confirming that the event report will be sent. If the MME is unable to send the event report (e.g. because this capability is not supported by the MME), an MO-LR return error is returned to the UE. The UE may terminate event reporting after an implementation defined number of MO-LR return errors are received.\n19)\tThe MME selects a V-GMLC in the same network and sends a Subscriber Location Report to the V-GMLC with an indication of the type of event being reported, the LDR reference number, the H-GMLC address, whether the location request is now terminated in the UE, any location estimate provided in step 13 or obtained in steps 14-16 and information on positioning methods used for the location estimate. The MME shall also include the UE IMSI.\n20)\tThe V-GMLC sends an acknowledgement to the MME and the MME may record charging information.\n21)\tThe V-GMLC forwards the information received in step 19 to the H-GMLC. The V-GMLC may record charging information.\n22)\tThe H-GMLC identifies the location request to which the message received in step 21 applies using the LDR reference number and IMSI. The H-GMLC may perform a privacy check as described in clause 9.1.1.\n23)\tThe H-GMLC forwards the information received from the V-GMLC in an LCS Service Response to the R-GMLC. If the UE indicates termination of the location request, the periodic location request shall be completed in the H-GMLC. The H-GMLC may record charging information.\n24)\tThe R-GMLC transfers the event report and any included location estimate to the LCS Client. If the UE indicates termination of the location request, the location request shall be completed in the R-GMLC. The R-GMLC may record charging information.\n25)\tIf the UE did not terminate the location request following step 18, the UE continues to monitor for the requested event as in step 12 and reports each occurrence of the requested event as in steps 13-24 until expiration of the requested duration or until the UE terminates reporting for other reasons.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.1",
        "clause_9.1.15",
        "figure_9.1.19.1-1",
        "ts_23.032",
        "ts_24.008",
        "ts_23.401"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.19.2",
      "section_id": "9.1.19.2",
      "section_title": "LCS Client cancellation of a Deferred Location Request for Periodic and Triggered Location",
      "content": "Figure 9.1.19.2-1 illustrates the procedure for cancelling a Deferred Location Request for periodic and triggered location when cancellation is requested by the LCS Client.\nFigure 9.1.19.2-1: LCS Client cancellation of a Deferred MT-LR for Periodic and Triggered Location\n1)\tThe LCS Client requests the cancellation of a previously requested Deferred Location Request for periodic and triggered location. The LDR (or other) reference number that was included in the previous LCS Service Response sent by the R-GMLC shall be included in the request to indicate which outstanding LDR should be cancelled.\n2)\tThe R-GMLC sends the cancellation request to the H-GMLC, including the LDR reference number. The R GMLC may itself initiate the cancellation, e.g. whenever the R-GMLC infers from the absence of location reports for a long period that the service may have been terminated by the UE.\n3)\tThe H-GMLC may send a SEND_ROUTING_INFO_FOR_LCS message to the home HLR/HSS of the UE with the IMSI or MSISDN of this UE. This may be needed if the UE is no longer served by the original V PLMN or by the original MME.\n4)\tThe HLR/HSS returns the current serving MME for the UE and the V-GMLC address.\n5)\tThe H-GMLC forwards the LCS Cancel Service Request to the V-GMLC with the LDR reference number received from the R-GMLC, the H-GMLC address and the serving MME address (e.g. received from the HLR/HSS). The H-GMLC may itself initiate the cancellation procedure, when the UE's privacy profile stored in the H-GMLC or in the PPR was changed in a manner that no longer allows the LCS Client to receive event and location reports for the UE.\nNOTE:\tThe H-GMLC shall know that the UE subscriber's privacy profile has been changed in the PPR when the LCS Privacy Profile Update has been sent from PPR to H-GMLC as described in clause 9.1.1.2.\n6)\tThe V-GMLC sends the Provide Subscriber Location request to the serving MME, indicating a cancellation of a deferred location request for periodic and triggered location and including the LDR reference number specified by the LCS Client in the LCS Cancel Service Request and the H-GMLC address received from the H-GMLC. The V-GMLC shall transfer the location cancellation even when the V-GMLC was not involved in establishing the location request.\n7)\tIf the UE is currently not reachable (e.g. during an eDRX cycle or when in PSM), the MME waits until the UE becomes reachable. When the UE is reachable, if the UE is in ECM-IDLE state, the MME performs paging, authentication and ciphering.\n8)\tThe MME sends an LCS Periodic Location Cancellation request, including the LDR reference number and H-GMLC address, to the UE.\n9)\tThe UE stops the periodic and triggered event reporting and returns an LCS Periodic Location cancellation ack. to the MME. Return of an LCS Periodic Location cancellation ack. shall apply even when the UE has no knowledge of the location procedure being cancelled (e.g. if the UE was powered off during the procedure).\n10)\tThe MME sends the cancellation acknowledgement to the V-GMLC in a Provide Subscriber Location Ack, with the LDR reference number and the H-GMLC address. If the MME was unable to perform steps 7-8 (e.g. due to a change of MME or PLMN by the UE), the MME returns a Provide Subscriber Location error response with a suitable error cause. The V-GMLC then returns the error to the H-GMLC which may retry the cancellation with a different MME or different PLMN if applicable.\n11)\tThe V-GMLC sends an LCS Cancel Service Response to the H-GMLC with the LDR reference number and the H GMLC address.\n12)\tThe H-GMLC sends an LCS Cancel Service Response to the R-GMLC with the LDR reference number.\n13)\tThe R-GMLC sends an LCS Cancel Service Response to the LCS Client.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.1.2",
        "figure_9.1.19.2-1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.1.19.3",
      "section_id": "9.1.19.3",
      "section_title": "UE cancellation of a Deferred Location Request for Periodic and Triggered Location",
      "content": "Figure 9.1.19.3-1 illustrates the procedure for cancelling the Deferred Location Request for the periodic and triggered location event when cancellation is requested by the UE. If a network entity (e.g. H-GMLC, V-GMLC, MME) cancels the Deferred Location Request, the procedure in clause 9.1.19.2 for LCS Client cancellation shall be used to cancel towards the UE and the procedure in this clause shall be used to cancel towards the LCS Client.\nFigure 9.1.19.3-1: UE cancellation of a Deferred MT-LR for Periodic and Triggered Location\n1)\tThe UE waits until the UE is registered or can register via E-UTRAN access with a PLMN in the list of reporting PLMNs received at step 9 of the procedure in clause 9.1.19.1 or with the original serving PLMN for the procedure in clause 9.1.19.1 if no list of reporting PLMNs was provided or if the UE does not support the list of reporting PLMNs.\nIf the UE is not using Control Plane CIoT EPS Optimisation and if the UE is in ECM-IDLE state, the UE performs a UE triggered service request or connection resume as defined in TS 23.401 [41] in order to obtain a signalling connection to a serving MME.\nIf the UE is using Control Plane CIoT EPS Optimisation, procedures for Mobile Originated Data Transport in Control Plane CIoT EPS optimisation as defined in TS 23.401 [41] are performed by the UE to establish a signalling connection with the MME.\n2)\tThe UE sends an LCS MO-LR Invoke to the serving MME for cancellation of a deferred MR-LR for periodic and triggered location. This message includes the H-GMLC address, a termination cause (e.g. subscriber terminates the procedure) and the LDR Reference Number.\n3)\tThe cancellation request shall be transferred from the MME to a V-GMLC and shall include the H-GMLC address, LDR reference number and IMSI of the UE.\n4) to 6)\tThe cancellation request shall be transferred to the H GMLC, R GMLC serving the LCS client and finally to the LCS client.\n7) to 10)\tThe response transferred back to the MME acknowledges the cancellation.\n11)\tThe MME returns the acknowledgment to the UE in a LCS MO-LR Return Result message.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.19.2",
        "clause_9.1.19.1",
        "figure_9.1.19.3-1",
        "ts_23.401"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.1",
      "section_id": "9.2.1",
      "section_title": "Mobile Originating Location Request, Circuit Switched (CS-MO-LR)",
      "content": "The following procedure shown in figure 9.7 allows an UE to request either its own location and optionally, velocity, location assistance data or broadcast assistance data message ciphering keys from the network. Location assistance data may be used subsequently by the UE to compute its own location throughout an extended interval using a mobile based position method. The ciphering key enables the UE to decipher other location assistance data broadcast periodically by the network. The MO‑LR after location update request may be used to request ciphering keys or GNSS assistance data using the follow-on procedure described in TS 24.008 [24]. The procedure may also be used to enable an UE to request that its own location be sent to an external LCS client.\nFigure 9.7: General Network Positioning for CS-MO-LR",
      "chunk_type": "general",
      "cross_references": [
        "figure_9.7",
        "ts_24.008"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.1.1",
      "section_id": "9.2.1.1",
      "section_title": "Location Preparation Procedure",
      "content": "1)\tIf the UE is in idle mode, the UE requests a radio connection setup and sends a CM service request indicating a request for a call independent supplementary services to the VMSC/MSC server via RAN.\n2)\tRAN shall convey the CM service request to the core network. If the UE is in dedicated mode, the UE sends a CM Service Request on the already established radio connection.\n3)\tThe VMSC/MSC server instigates authentication and ciphering if the UE was in idle mode or returns a Direct Transfer CM Service Accept if the UE was in dedicated mode. The UE will inform the network about its LCS capabilities, as described in clause 6.3.4.\n4)\tThe UE sends a LCS CS-MO-LR Location Services invoke to the VMSC/MSC server. Different types of location services can be requested: location estimate of the UE, location estimate of the UE to be sent to an external LCS client, location assistance data or broadcast assistance data message ciphering keys. If the UE is requesting its own location estimate or that its own location be sent to an external LCS client, this message carries LCS requested QoS information (e.g. accuracy, response time, LCS QoS Class), the requested maximum age of location and the requested type of location (e.g. \"current location\", \"current or last known location\"). If the UE is requesting that its location be sent to an external LCS client, the message shall include the identity of the LCS client and may include the address of the GMLC through which the LCS client should be accessed. In addition, a Service Identity indicates which MO-LR service of the LCS Client is requested by the UE may be included. The message also may include a pseudonym indicator to indicate a pseudonym should be assigned by the network and transferred to the LCS Client as the UE's identity. If the UE is instead requesting location assistance data or ciphering keys, the message specifies the type of assistance data or deciphering keys and the positioning method for which the assistance data or ciphering applies. For an LCS CS-MO-LR Location Services invoke, the VMSC/MSC server shall assign a GMLC address, i.e. V-GMLC address, which is stored in the VMSC/MSC server. If a V-GMLC address is not available, the VMSC/MSC server may reject the location request. The VMSC/MSC server verifies in the UE's subscription profile that the UE has permission to request its own location, request that its location be sent to an external LCS client or request location assistance data or deciphering keys (whichever applies). If the UE is requesting positioning and has an established call, the VMSC/MSC server may reject the request for certain non-speech call types.\n5)\tIn case the requested type of location is \"current or last known location\" and the requested maximum age of location information is sent from UE, the VMSC/MSC server verifies whether it stores the previously obtained location estimate of the target UE. If the VMSC/MSC server stores the location estimate and the location estimate satisfies the requested maximum age of location, this step and steps 6 and 7 may be skipped. Otherwise the VMSC/MSC server sends a Location Request message to RAN associated with the Target UE. The message indicates whether a location estimate or location assistance data is requested and, in GSM, includes the UE's location capabilities. If the UE's location is requested, the message also includes the requested QoS. If location assistance data is requested, the message carries the requested types of location assistance data.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.3.4"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.1.2",
      "section_id": "9.2.1.2",
      "section_title": "Positioning Measurement Establishment Procedure",
      "content": "6)\tIf the UE is requesting its own location, RAN determines the positioning method and instigates the particular message sequence for this method, as specified in UTRAN Stage 2, TS 25.305 [1] and GERAN Stage 2, TS 43.059 [16]. If the UE is instead requesting location assistance data, RAN transfers this data to the UE as described in subsequent clauses in TS 25.305 [1] and TS 43.059 [16] UE.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.1.3",
      "section_id": "9.2.1.3",
      "section_title": "Location Calculation and Release Procedure",
      "content": "7)\tWhen a location estimate best satisfying the requested QoS has been obtained or when the requested location assistance data has been transferred to the UE, RAN returns a Location Report to the VMSC/MSC server with an indication whether the obtained location estimate satisfies the requested accuracy or not. This message carries the location estimate or ciphering keys if this was obtained. If a location estimate or deciphering keys were not successfully obtained or if the requested location assistance data could not be transferred successfully to the UE, a failure cause is included in the Location Report.\n8)\tIf the location estimate was successfully obtained, the VMSC/MSC server shall send a MAP Subscriber Location Report to the V-GMLC assigned in the step 4, carrying the MSISDN/IMSI of the UE, the event causing the location estimate (CS‑MO-LR) and the location estimate, its age, obtained accuracy indication and the LCS QoS Class requested by the target UE. In addition, the MAP Subscriber Location Report may include the pseudonym indicator, the identity of the LCS Client, the GMLC address and the Service Identity specified by the UE, if available.\n9)\tUpon receipt of the MAP Subscriber Location Report, the V-GMLC shall determine whether the UE requests transfer of its location estimate to an external LCS Client. If the identity of the LCS Client is not available, this step and steps 10 to 14 are skipped. Otherwise, the V-GMLC shall send the MO-LR Location Information to the H-GMLC (the V-GMLC may query the HLR/HSS of the UE to obtain the address of the H-GMLC), carrying the MSISDN/IMSI of the UE, the event causing the location estimate (CS‑MO-LR), the location estimate and its age and the identity of the LCS Client. The pseudonym indicator and/or the GMLC address specified by the UE may also be included if available.\n10)\tIf the pseudonym indicator is included in the MO-LR Location Information, the H-GMLC assigns or asks the PMD to assign a pseudonym to the UE. If the identity of the LCS Client and the GMLC address access to the LCS Client are available, the H-GMLC shall send the MO-LR Location Information to the specified GMLC. If the identity of the LCS Client is available but the GMLC address access to the LCS Client is not available, the H-GMLC determines whether the specified LCS Client is accessible. If yes, the H-GMLC shall send the Location Information to the LCS Client, then the H-GMLC itself act as the specified GMLC, this step and step 13 are skipped. If not, according to the LCS Client identity, the H-GMLC shall determine a GMLC that can access the LCS Client, and send the MO-LR Location Information to the GMLC, carrying the MSISDN or the pseudonym of the UE, the identity of the LCS client, the event causing the location estimate (CS‑MO-LR), location estimate and its age.\n11)\tIf the identified LCS Client is not accessible, this step and step 12 are skipped. Otherwise the GMLC transfers the location information to the LCS client, carrying the MSISDN/IMSI or the pseudonym of the UE, the event causing the location estimate (CS-MO‑LR), the Service Identity, if available, and the location estimate and its age, in accordance with the LCS QoS Class requested by the target UE. If the UE requested LCS QoS class was Assured, GMLC sends the result to the LCS client only if the result has been indicated to fulfil the requested accuracy. If the UE requested LCS QoS class was Best Effort, GMLC sends whatever result it received to the LCS client with an appropriate indication if the requested accuracy was not met.\n12)\tIf the LCS Client does not support MO-LR (for temporary or permanent reasons) or can not handle the location estimate of the UE, e.g. the LCS Client does not know the Service Identity, or the UE does not register to the LCS Client, the LCS Client have no corresponding data of the UE, the LCS Client shall return the Location Information ack message to the GMLC or the H-GMLC (in case the LCS Client received Location Information is sent from H-GMLC) with a suitable error cause. Otherwise, the LCS Client handles the location estimate according to the Service Identity, sends the GMLC or the H-GMLC the Location Information ack message signalling that the location estimate of the UE has been handled successfully.\n13)\tIf the identified LCS Client is not accessible, the GMLC sends MO-LR Location Information Acknowledgement to the H-GMLC with an appropriate error cause. Otherwise, the GMLC shall send MO-LR Location Information Acknowledgement to the H-GMLC. The message shall specify whether the location estimate of the UE has been handled successfully by the identified LCS Client, and if not, the corresponding error cause obtained in step 12. The GMLC may record charging information both for the LCS Client and inter-operator revenue charges.\n14)\tIn case the H-GMLC receives the MO-LR Location Information Acknowledgement from the GMLC, it shall forward the MO-LR Location Information Acknowledgement from the GMLC to the V-GMLC, and record charging information both for the UE and inter-working revenue charges.\nIn case the H-GMLC receives the Location Information Acknowledgement from the LCS Client, it shall send MO-LR Location Information Acknowledgement to the V-GMLC. The message shall specify whether the location estimate of the UE has been handled successfully by the identified LCS Client, and if not, the corresponding error cause obtained in step 12. The H-GMLC shall record charging information both for the UE and inter-working revenue charges.\n15)\tIn case the V-GMLC receives the MO-LR Location Information Acknowledgement from the H-GMLC, the V-GMLC shall record charging information both for the UE and inter-working revenue charges and send the MAP Subscriber Location Report Acknowledgement to the VMSC/MSC server, carrying the information specifies whether the location estimate of the UE has been handled successfully by the identified LCS Client, and if not success, the corresponding error cause obtained in step 14.\nIn case the V-GMLC receives the MAP Subscriber Location Report from the VMSC/MSC server and it is not required to send to any LCS Client, the V-GMLC shall record charging information for the UE and response the MAP Subscriber Location Report Acknowledgement to the VMSC/MSC server.\n16)\tThe VMSC/MSC server returns a CS-MO-LR Return Result to the UE carrying any location estimate requested by the UE including the indication received from RAN whether the obtained location estimate satisfies the requested accuracy or not, ciphering keys or an indicator whether a location estimate was successfully transferred to the identified LCS client. If the location estimate was successfully transferred to the identified LCS Client, the CS-MO-LR Return Result message shall specify whether the location estimate of the UE has been handled successfully by the identified LCS Client, and if not, the corresponding error cause obtained in step 15.\n17)\tThe VMSC/MSC server may release the CM, MM and radio connections to the UE, if the UE was previously idle, and the VMSC/MSC server may record charging information.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.2.2",
      "section_id": "9.2.2",
      "section_title": "Mobile Originating Location Request, Packet Switched (PS-MO-LR)",
      "content": "The following procedure shown in figure 9.8 allows an UE to request either its own location and optionally, velocity; location assistance data or broadcast assistance data message ciphering keys from the network. Location assistance data may be used subsequently by the UE to compute its own location throughout an extended interval using a mobile based position method. A ciphering key enables the UE to decipher other location assistance data broadcast periodically by the network. The PS‑MO‑LR may be used to request ciphering keys or GNSS assistance data. The procedure may also be used to enable an UE to request that its own location be sent to an external LCS client.\nFigure 9.8: General Network Positioning for packet switched MO-LR",
      "chunk_type": "general",
      "cross_references": [
        "figure_9.8"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.2.1",
      "section_id": "9.2.2.1",
      "section_title": "Location Preparation Procedure",
      "content": "1)\tIn UMTS, if the UE is in idle mode, the UE requests a PS signalling connection and sends a Service request indicating signalling to the SGSN via the RAN. If the UE already has PS signalling connection, the UE does not need to send Service request. Security functions may be executed. These procedures are described in TS 23.060 [15]. In GSM this signalling step is not needed.\n2)\tThe UE sends a LCS PS-MO-LR Location Services invoke message to the SGSN. Different types of location services can be requested: location estimate of the UE, location estimate of the UE to be sent to an external LCS client, location assistance data or broadcast assistance data message ciphering keys. If the UE is requesting its own location or that its own location be sent to an external LCS client, this message carries LCS requested QoS information (e.g. accuracy, response time, LCS QoS Class), the requested maximum age of location and the requested type of location (e.g. \"current location\", \"current or last known location\"). If the UE is requesting that its location be sent to an external LCS client, the message shall include the identity of the LCS client and may include the address of the GMLC through which the LCS client should be accessed. In addition, a Service Identity indicates which MO-LR service of the LCS Client is requested by the UE may be included. The message also may include a pseudonym indicator to indicate a pseudonym should be assigned by the network and transferred to the LCS Client as the UE's identity. If the UE is instead requesting location assistance data or ciphering keys, the message specifies the type of assistance data or deciphering keys and the positioning method for which the assistance data or ciphering applies. For an LCS PS-MO-LR Location Services invoke, the SGSN shall assign a GMLC address, i.e. V-GMLC address, which is stored in the SGSN. If a V-GMLC address is not available, the SGSN may reject the location request. The SGSN verifies the subscription profile of the UE and decides if the requested service is allowed or not.\n3)\tIn case the requested type of location is \"current or last known location\" and the requested maximum age of location information is sent from UE, the SGSN verifies whether it stores the previously obtained location estimate of the target UE. If the SGSN stores the location estimate and the location estimate satisfies the requested maximum age of location, this step and steps 4 and 5 may be skipped. Otherwise the SGSN sends a Location Request message to the RAN associated with the Target UE's location. The message indicates whether a location estimate or location assistance data is requested. If the UE's location is requested, the message also includes the requested QoS. If location assistance data is requested, the message carries the requested types of location assistance data. The message carries also location parameters received in the Service Invoke message.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_23.060"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.2.2",
      "section_id": "9.2.2.2",
      "section_title": "Positioning Measurement Establishment Procedure",
      "content": "4)\tIf the UE is requesting its own location, the actions described in UTRAN Stage 2, TS 25.305 [1] or GERAN stage 2 TS 43.059 [16] are performed. If the UE is instead requesting location assistance data, the RAN transfers this data to the UE as described in subsequent clauses. The RAN determines the exact location assistance data to transfer according to the type of data specified by the UE, the UE location capabilities and the current cell.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.2.3",
      "section_id": "9.2.2.3",
      "section_title": "Location Calculation and Release Procedure",
      "content": "5)\tWhen a location estimate best satisfying the requested QoS has been obtained or when the requested location assistance data has been transferred to the UE, the RAN returns a Location Report to the SGSN with an indication whether the obtained location estimate satisfies the requested accuracy or not. This message carries the location estimate or ciphering keys if this was obtained. If a location estimate or deciphering keys were not successfully obtained or if the requested location assistance data could not be transferred successfully to the UE, a failure cause is included in the Location Report.\n6)\tIf the location estimate was successfully obtained, the SGSN shall send a Subscriber Location Report to the V-GMLC assigned in the step 2, carrying the MSISDN/IMSI of the UE, the event causing the location estimate (PS-MO‑LR) and the location estimate, its age, obtained accuracy indication and the LCS QoS Class requested by the target UE. In addition, the Subscriber Location Report may include the pseudonym indicator, the identity of the LCS Client, the GMLC address and the Service Identity specified by the UE, if available.\n7)\tUpon receipt of the Subscriber Location Report, the V-GMLC shall determine whether the UE requests transfer of its location estimate to an external LCS Client. If the identity of the LCS Client is not available, this step and steps 8 to 12 are skipped. Otherwise, the V-GMLC shall send the MO-LR Location Information to the H-GMLC (the V-GMLC may query the HLR/HSS of the UE to obtain the address of the H-GMLC), carrying the MSISDN/IMSI of the UE, the event causing the location estimate (PS‑MO-LR), the location estimate and its age, and the identity of the LCS Client. The pseudonym indicator and/or the GMLC address specified by the UE may also be included if available.\n8)\tIf the pseudonym indicator is included in the MO-LR Location Information, the H-GMLC assigns or asks the PMD to assign a pseudonym to the UE. If the identity of the LCS Client and the GMLC address access to the LCS Client are available, the H-GMLC shall send the MO-LR Location Information to the specified GMLC. If the identity of the LCS Client is available but the GMLC address access to the LCS Client is not available, the H-GMLC determines whether the specified LCS Client is accessible. If yes, the H-GMLC shall send the Location Information to the LCS Client, then the H-GMLC itself act as the specified GMLC, this step and step 11 are skipped. If not, according to the LCS Client identity, the H-GMLC shall determine a GMLC that can access the LCS Client, and send the MO-LR Location Information to the GMLC, carrying the MSISDN or the pseudonym of the UE, the identity of the LCS client, the event causing the location estimate (PS‑MO-LR), location estimate and its age.\n9)\tIf the identified LCS Client is not accessible, this step and step 10 are skipped. Otherwise the GMLC transfers the location information to the LCS client, carrying the MSISDN/IMSI or the pseudonym of the UE, the event causing the location estimate (PS-MO‑LR), the Service Identity, if available, and the location estimate and its age, in accordance with the LCS QoS Class requested by the target UE. If the UE requested LCS QoS class was Assured, GMLC sends the result to the LCS client only if the result has been indicated to fulfil the requested accuracy. If the UE requested LCS QoS class was Best Effort, GMLC sends whatever result it received to the LCS client with an appropriate indication if the requested accuracy was not met.\n10)\tIf the LCS Client does not support MO-LR (for temporary or permanent reasons) or can not handle the location estimate of the UE, e.g. the LCS Client does not know the Service Identity, or the UE does not register to the LCS Client, the LCS Client have no corresponding data of the UE, the LCS Client shall return the Location Information ack message to the GMLC or the H-GMLC (in case the LCS Client received Location Information is sent from H-GMLC) with a suitable error cause. Otherwise, the LCS Client handles the location estimate according to the Service Identity, sends the GMLC or the H-GMLC the Location Information ack message signalling that the location estimate of the UE has been handled successfully.\n11)\tIf the identified LCS Client is not accessible, the GMLC sends MO-LR Location Information Acknowledgement to the H-GMLC with an appropriate error cause. Otherwise, the GMLC shall send MO-LR Location Information Acknowledgement to the H-GMLC. The message shall specify whether the location estimate of the UE has been handled successfully by the identified LCS Client, and if not, the corresponding error cause obtained in step 10. The GMLC may record charging information both for the LCS Client and inter-operator revenue charges.\n12)\tIn case the H-GMLC receives the MO-LR Location Information Acknowledgement from the GMLC, it shall forward the MO-LR Location Information Acknowledgement from the GMLC to the V-GMLC, and record charging information both for the UE and inter-working revenue charges.\nIn case the H-GMLC receives the Location Information Acknowledgement from the LCS Client, it shall send MO-LR Location Information Acknowledgement to the V-GMLC. The message shall specify whether the location estimate of the UE has been handled successfully by the identified LCS Client, and if not, the corresponding error cause obtained in step 10. The H-GMLC shall record charging information both for the UE and inter-working revenue charges.\n13)\tIn case the V-GMLC receives the MO-LR Location Information Acknowledgement from the H-GMLC, the V-GMLC shall record charging information both for the UE and inter-working revenue charges and send the Subscriber Location Report Acknowledgement to the SGSN, carrying the information specifies whether the location estimate of the UE has been handled successfully by the identified LCS Client, and if not success, the corresponding error cause obtained in step 12.\nIn case the V-GMLC receives the Subscriber Location Report from the SGSN and it is not required to send to any LCS Client, the V-GMLC shall record charging information for the UE and response the Subscriber Location Report Acknowledgement to the SGSN.\n14)\tThe SGSN returns a Service Response message to the UE carrying any location estimate requested by the UE including the indication received from RAN whether the obtained location estimate satisfies the requested accuracy or not, ciphering keys or an indicator whether a location estimate was successfully transferred to the identified LCS client. If the location estimate was successfully transferred to the identified LCS Client, the Service Response message shall specify whether the location estimate of the UE has been handled successfully by the identified LCS Client, and if not, the corresponding error cause obtained in step 13. The SGSN may record charging information.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.2.3",
      "section_id": "9.2.3",
      "section_title": "MO-LR Request for Periodic Location Transfer to a Third Party",
      "content": "The following procedure shown in figure 9.8a allows a UE to instigate a periodic transfer of location to an external LCS client. The procedure would be executed once after which it would be followed by the procedure described in clause 9.1.12.2.\nFigure 9.8a: Deferred MO-LR Initiation for Periodic Location in CS and PS domain\n1) to 2) If the UE is in idle mode, the UE requests a radio connection setup and sends a CM Service Request indicating a request for call independent supplementary service to the VMSC/MSC server via RAN (CS domain). If the UE is in dedicated mode, the UE sends a CM Service Request on the already established radio connection. The VMSC/MSC server instigates authentication and ciphering if the UE was in idle mode or returns a CM Service Accept if the UE was in dedicated mode.\nFor PS domain, in UMTS, if the UE is in idle mode, the UE requests a PS signalling connection and sends a Service Request indicating signalling to the SGSN via RAN. If the UE already has PS signalling connection, the UE does not need to send the Service Request. Security functions may be executed. These procedures are described in TS 23.060 [15]. In GSM this signalling step is not needed.\n3)\tThe UE sends an LCS MO-LR Invoke for periodic transfer of location to a third party LCS client. The UE shall include the periodic location related parameters (reporting interval and total number of reports). The UE shall also include the identity of the LCS client and may include the address of the GMLC through which the LCS client can be accessed. The UE may include a request for use of MO-LR Short Circuit (e.g. if the UE supports UE based positioning). The absence of an H-GMLC assigned LDR reference number in this case indicates that the request has not yet been authorized.\n4) to 7) The request to initiate periodic location shall be transferred in succession from the MSC/SGSN to the V‑GMLC, H-GMLC, R-GMLC serving the LCS client and finally may be transferred to the LCS client. The periodic location parameters (reporting interval and number of reports) are included as well as any request for use of MO-LR Short Circuit. Any entity (MSC/SGSN, V‑GMLC, H‑GMLC, R‑GMLC and, if notified, LCS Client) is enabled to accept or refuse the request. In addition, if the request was accepted, any entity is free to reject use of MO-LR Short Circuit. If the request is accepted, a LDR reference number is assigned by the H‑GMLC.\n8) to 11) The response transferred back to the MSC/SGSN shall indicate acceptance or rejection and whether MO‑LR short circuit (if requested) has been accepted. The response also includes the LDR reference number assigned by the H-GMLC and the H-GMLC address. The H-GMLC may include in the response a list of PLMNs and possibly associated radio access technologies, either prioritized or non-prioritized, in which subsequent location estimates must be obtained and an indication for each PLMN (and possibly each associated radio access technology) of whether periodic location in the RAN is supported. If no list is included, subsequent locations are restricted to the current serving PLMN only\n12)\tThe MSC/SGSN returns the result of the request to the UE in a LCS MO-LR Return Result message including the LDR reference number, the H-GMLC address any reporting PLMN list and an indication whether MO-LR Short Circuit is allowed (if requested by the UE in step 3.\n13a) The UE may instigate release of the CM, MM/GMM and radio connections – e.g. if the request was rejected or if the MSC/SGSN provided a list of PLMNs that did not include the serving PLMN (or if the serving PLMN was included in a prioritized list with a lower priority). Assuming the request was accepted, the UE may then initiate reporting of the first location estimate using the procedure described in clause 9.1.12.2 and beginning at step 1.\n13b) If the request was accepted and the serving PLMN can be used for subsequent location, the UE may initiate reporting of the first location estimate by sending an MO-LR request indicating transfer of location to the LCS Client using the procedure described in clause 9.1.12.2 and beginning at step 3.\nNOTE:\tIf the UE receives a response in step 12 indicating that the MO-LR request for periodic location transfer to a third party cannot be supported (for temporary or permanent reasons), the UE may periodically invoke the MO-LR procedure for location transfer to a third party defined in clause 9.2.1 for the CS domain (CS-MO-LR) and in clause 9.2.2 for the PS domain (PS-MO-LR).",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.1.12.2",
        "clause_9.2.1",
        "clause_9.2.2",
        "figure_9.8",
        "ts_23.060"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.4",
      "section_id": "9.2.4",
      "section_title": "MO-LR Request for Periodic Self Location",
      "content": "The following procedure shown in figure 9.8b allows an UE to request its own location periodically if the RAN serving the target UE supports periodic location. This procedure is useful if a UE only supports UE-assisted positioning or has no positioning capability.\nFigure 9.8b: MO-LR for Periodic Self Location with Periodic Positioning in the RAN\n1) to 2) If the UE is in idle mode, the UE requests a radio connection setup and sends a CM Service Request indicating a request for call independent supplementary service to the VMSC/MSC server via RAN (CS domain). If the UE is in dedicated mode, the UE sends a CM Service Request on the already established radio connection. The VMSC/MSC server instigates authentication and ciphering if the UE was in idle mode or returns a CM Service Accept if the UE was in dedicated mode.\nFor PS domain, in UMTS, if the UE is in idle mode, the UE requests a PS signalling connection and sends a Service Request indicating signalling to the SGSN via RAN. If the UE already has PS signalling connection, the UE does not need to send the Service Request. Security functions may be executed. These procedures are described in TS 23.060 [15]. In GSM this signalling step is not needed.\n3)\tThe UE sends an MO-LR invoke requesting periodic self location. The request includes the required QoS, the periodic location interval and the total number of reports.\n4)\tThe MSC/SGSN sends a location request to the RAN containing the QoS and periodic location information received in step 3.\n5)\tRAN determines the positioning method and instigates the particular message sequence for this method, as specified in UTRAN Stage 2, TS 25.305 [1] and GERAN Stage 2, TS 43.059 [16].\n6)\tWhen a location estimate best satisfying the requested QoS has been obtained, RAN returns it to the MSC/SGSN.\n7)\tThe MSC/SGSN sends an LCS Location Update invoke to the UE containing the first location estimate.\n8)\tThe UE acknowledges receipt of the first location estimate. If the UE wished to cancel the periodic location procedure at that point, an additional parameter (e.g. flag or cause value) is included in this message.\n9-12) As steps 5-8 for the second location estimate and thereafter repeated at the periodic location interval until the total number of reports is attained.\n13)\tAfter the final location estimate has been transferred in step 12, the MSC/SGSN returns an MO-LR return result to the UE to indicate completion of the periodic location request in step 3. As an implementation option, the final location estimate may be returned in the MO-LR return result in step 13 rather than in an LCS Location Update in step 11.\n14)\tThe MSC/SGSN instigates clearing of the CM, MM/GMM and radio connections.\nNOTE:\tIf the UE receives a response in step 13 indicating that the MO-LR request for periodic self location cannot be supported (for temporary or permanent reasons), the UE may periodically invoke the MO‑LR procedure for self location defined in clause 9.2.1 for the CS domain (CS-MO-LR) and in clause 9.2.2 for the PS domain (PS-MO-LR).",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.2.1",
        "clause_9.2.2",
        "figure_9.8",
        "ts_23.060",
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.5",
      "section_id": "9.2.5",
      "section_title": "WLAN UE Originated Procedure in I-WLAN",
      "content": "This procedure is applicable to a UE connected to I-WLAN defined in TS 23.234 [52] and it is no longer maintained.\nFigure 9.8c describes the MO-LR procedure for LCS for I-WLAN.\nFigure 9.8c: WLAN UE Originated Procedure in I-WLAN\n1.\tThe WLAN UE selects a WLAN AN and establishes the WLAN connection and is authenticated in I-WLAN. The tunnel is established with between WLAN UE and one of PDGs in PLMN.\n2.\tWLAN UE initiates positioning procedure by establishing a so called user plane connection with the GMLC/SLP and shall use the OMA SUPL mechanism specified by OMA (OMA AD SUPL [38], OMA TS ULP [39]) to transport location related assistance data and location information between the UE and GMLC/SLP. The UE may receive assistance data and determine its own location and send its location information to the GMLC/SLP or the UE sends measurement results to the GMLC/SLP. In case GMLC/SLP determines the location of the UE, the GMLC/SLP shall send the location information to the WLAN UE. The UE may also send the identifier of the access node (e.g., MAC address of the AP) to the GMLC and GMLC, possibly using an external database, maps this location identifier to the corresponding geographical information, e.g. coordinates or street address and returns the result to the UE.\n3.\tThe location information obtained is transferred to external LCS client if requested by WLAN UE. The estimated position of a WLAN UE can be stored in the GMLC after WLAN UE originated positioning procedure for future uses subject to the privacy settings of the WLAN UE. If there is an LCS request from an external LCS Client, the stored location information can be delivered to the external LCS client if the stored location information satisfies LCS QoS requested.",
      "chunk_type": "procedure",
      "cross_references": [
        "figure_9.8",
        "ts_23.234"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.6",
      "section_id": "9.2.6",
      "section_title": "Mobile Originating Location Request, EPC (EPC-MO-LR)",
      "content": "The following procedure shown in figure 9.8d allows an UE to request either, its own location and optionally, velocity or location assistance data. Location assistance data may be used subsequently by the UE to compute its own location throughout an extended interval using a mobile based position method. The EPC MO LR may be used to request GNSS assistance data. The procedure may also be used to enable an UE to request that its own location be sent to an external LCS client.\nFigure 9.8d: General Network Positioning for packet switched MO-LR",
      "chunk_type": "general",
      "cross_references": [
        "figure_9.8"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.6.1",
      "section_id": "9.2.6.1",
      "section_title": "Location Preparation Procedure",
      "content": "1)\tIf the UE is not using Control Plane CIoT EPS Optimisation and if the UE is in ECM-IDLE state, the UE performs a UE triggered service request as defined in TS 23.401 [41] in order to establish a signalling connection with the MME and assign a specific eNodeB.\nIf the UE is using Control Plane CIoT EPS Optimisation, procedures for Mobile Originated Data Transport in Control Plane CIoT EPS optimisation as defined in TS 23.401 [41] are performed by the UE to establish a signalling connection with the MME.\n2)\tThe UE sends a NAS PDU containing an MO-LR Request inside an RRC UL Information Transfer message to the eNodeB. The MO-LR Request may optionally include an LPP positioning message. The eNodeB forwards the MO-LR Request (including any embedded LPP message) to the MME inside an S1AP Uplink NAS Transport message. Different types of location services can be requested: location estimate of the UE, location estimate of the UE to be sent to an external LCS client or location assistance data. If the UE is requesting its own location or that its own location be sent to an external LCS client, this message carries LCS requested QoS information (e.g. accuracy, response time, LCS QoS Class), the requested maximum age of location and the requested type of location (e.g. \"current location\", \"current or last known location\"). If the UE is requesting that its location be sent to an external LCS client, the message shall include the identity of the LCS client and may include the address of the GMLC through which the LCS client should be accessed. In addition, a Service Identity indicates which MO-LR service of the LCS Client is requested by the UE may be included. The message also may include a pseudonym indicator to indicate a pseudonym should be assigned by the network and transferred to the LCS Client as the UE's identity. If the UE is instead requesting location assistance data, the embedded LPP message specifies the type of assistance data and the positioning method for which the assistance data applies. For an LCS EPC-MO-LR requesting location transfer to an external LCS Client, the MME shall assign a GMLC address, i.e. V-GMLC address, which is stored in the MME. If a V-GMLC address is not available, the MME may reject the location request. The MME verifies the subscription profile of the UE and decides if the requested service is allowed or not.\n3)\tThe MME selects a E-SMLC as described in clause 6.3.13 and sends a Location Request message to the selected E-SMLC. The Location Request message conveys any embedded LPP message in the MO-LR Request. Once an MME has selected an E-SMLC it must continue to use that E-SMLC for the duration of the session. The Location Request message indicates whether a location estimate or location assistance data is requested. If the UE's location is requested, the message also includes the requested QoS. If location assistance data is requested, the embedded LPP message will convey the requested types of location assistance data. The message carries also other location parameters received in the MO-LR Request message, the current cell identity obtained from S1-AP message that carries the NAS MO-LR Request, and the UE capability to support LPP. The message also indicates RAT type and/or coverage level if applicable.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.3.13",
        "ts_23.401"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.6.2",
      "section_id": "9.2.6.2",
      "section_title": "Positioning Measurement Establishment Procedure",
      "content": "4)\tIf the UE is requesting its own location, the actions described in clause 9.3a are performed. If the UE is instead requesting location assistance data, the E-SMLC transfers this data to the UE as described in clause 9.3a.1. The E-SMLC determines the exact location assistance data to transfer according to the type of data specified by the UE, the UE location capabilities and the current cell.\nNB-IoT UEs may perform measurements for some positioning methods only when in ECM-IDLE state. An E-SMLC that is aware of this (e.g. from an indication sent by the UE) may allow additional response time to the UE (e.g. in the QoS) to obtain the measurements. An MME that is aware of this (e.g. from the UE access type) may also allow additional time for a location session to complete.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.3"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.2.6.3",
      "section_id": "9.2.6.3",
      "section_title": "Location Calculation and Release Procedure",
      "content": "5)\tWhen a location estimate best satisfying the requested QoS has been obtained or when the requested location assistance data has been transferred to the UE, the E-SMLC returns a Location Response to the MME with an indication whether the obtained location estimate satisfies the requested accuracy or not. This message carries the location estimate if this was obtained. If a location estimate was not successfully obtained, or if the requested location assistance data could not be transferred successfully to the UE, a failure cause is included in the Location Response.\n6)\tIf the UE did not request transfer of its location to an external LCS Client in step 2, steps 6 to 13 are skipped. Otherwise, if the location estimate was successfully obtained, the MME shall send a Subscriber Location Report to the V-GMLC assigned in the step 2, carrying the MSISDN/IMSI of the UE, the event causing the location estimate (EPC-MO LR) and the location estimate, its age, obtained accuracy indication and the LCS QoS Class requested by the target UE. In addition, the Subscriber Location Report may include the pseudonym indicator, the identity of the LCS Client, the GMLC address and the Service Identity specified by the UE, if available.\n7)\tThis step is the same as step 7 for a PS-MO-LR in clause 9.2.2.3.\n8)\tThis step is the same as step 8 for a PS-MO-LR in clause 9.2.2.3.\n9)\tThis step is the same as step 9 for a PS-MO-LR in clause 9.2.2.3.\n10)\tThis step is the same as step 10 for a PS-MO-LR in clause 9.2.2.3.\n11)\tThis step is the same as step 11 for a PS-MO-LR in clause 9.2.2.3.\n12)\tThis step is the same as step 12 for a PS-MO-LR in clause 9.2.2.3.\n13)\tIf the V-GMLC receives the MO-LR Location Information Acknowledgement from the H-GMLC, the V-GMLC shall record charging information both for the UE and inter-working revenue charges and send the Subscriber Location Report Acknowledgement to the MME, carrying the information specifies whether the location estimate of the UE has been handled successfully by the identified LCS Client, and if not success, the corresponding error cause obtained in step 12.\nIf the V-GMLC receives the Subscriber Location Report from the MME and it is not required to send to any LCS Client, the V-GMLC shall record charging information for the UE and response the Subscriber Location Report Acknowledgement to the MME.\n14)\tThe MME returns a NAS MO-LR Response message to the UE carrying any location estimate requested by the UE including the indication received from E-SMLC whether the obtained location estimate satisfies the requested accuracy or not, or an indicator whether a location estimate was successfully transferred to the identified LCS client. If the location estimate was successfully transferred to the identified LCS Client, the MO-LR Response message shall specify whether the location estimate of the UE has been handled successfully by the identified LCS Client, and if not, the corresponding error cause obtained in step 13. The MME may record charging information.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.2.3"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.3",
      "section_id": "9.3",
      "section_title": "LCS signalling procedures specified in UTRAN and GERAN Stage 2",
      "content": "The signalling procedures in UTRAN and GERAN are defined in TS 25.305 [1] and TS 43.059 [16] respectively.\n9.3a\tLCS signalling procedures applicable to E-UTRAN\n9.3a.1\tUE Assisted and UE Based Positioning and Assistance Delivery\nThe following procedure depicts a positioning service transaction that is used by the E-SMLC to support UE based positioning, UE assisted positioning and delivery of assistance data. A single location request from the MME may invoke one or more transactions, in which each transaction may perform a single positioning service (e.g. UE assisted positioning, UE capability retrieval). RAN positioning procedures related to E-SMLC and UE communication are specified in TS 36.355 [47].\nFigure 9.8e: UE Assisted and UE Based Positioning and Assistance Delivery Procedure\nPrecondition:\tA Correlation identifier allocated by MME had been passed to the E‑SMLC when the location session (i.e. EPC‑MT‑LR, EPC‑MO‑LR, or ECP‑NI‑LR) was initiated. The Correlation identifier must be assigned such that it can be used to identify the E‑SMLC serving the location session.\n1.\tThe E-SMLC sends a Location Information message to the MME carrying a Downlink Positioning Information and the Correlation identifier which may request location information from the UE, provide assistance data to the UE or query for the UE capabilities.\n2.\tIf the UE is not using Control Plane CIoT EPS Optimisation and if the UE is in ECM-IDLE state (e.g. if the S1 connection was previously released due to data and signalling inactivity), the MME performs a network triggered service request as defined in TS 23.401 [41] in order to establish a signalling connection with the UE.\nIf the UE is using Control Plane CIoT EPS Optimisation, procedures for Mobile Terminated Data Transport in Control Plane CIoT EPS optimisation as defined in TS 23.401 [41] are performed by the MME to establish a signalling connection with the UE.\n3.\tThe MME forwards the Downlink Positioning Information to the serving eNodeB in a NAS Transport message conveyed by the S1-AP Transport Message. The MME includes a Routing identifier, in the NAS transport message, representing the Correlation identifier associated with the location session between the MME and E-SMLC.\n4.\tThe eNodeB forwards the Downlink Positioning Information and Routing identifier to the UE by NAS Transport Message.\n5.\tThe UE stores any assistance data provided in the Downlink Positioning Information and performs any positioning measurements and location computation requested by the Downlink Positioning Information.\nNB-IoT UEs may perform measurements for some positioning methods only when in ECM-IDLE state. In this case, the UE delays performing positioning measurements in step 5 until after the UE enters ECM-IDLE state.\n6.\tIf the UE is not using Control Plane CIoT EPS Optimisation and if the UE is in ECM-IDLE state, the UE instigates a UE triggered service request or, when User Plane CIoT EPS optimization applies, the Connection Resume procedure as defined in TS 23.401 [41] in order to establish a signalling connection with the MME.\nIf the UE is using Control Plane CIoT EPS Optimisation, procedures for Mobile Originated Data Transport in Control Plane CIoT EPS optimisation as defined in TS 23.401 [41] are performed by the UE to establish a signalling connection with the MME.\n7.\tThe UE returns any location information obtained in step 5 or returns any capabilities requested in step 4 to the eNodeB in an Uplink Positioning Information included in the NAS Transport message. The Uplink Positioning Information may alternatively carry a request for further assistance data. The UE shall also include the Routing identifier in the NAS Transport Message received in step 4.\n8.\tThe eNodeB forwards the Uplink Positioning Information and Routing identifier to the MME in a NAS Transport message.\n9.\tThe MME forwards the Uplink Positioning Information and the Correlation identifier to the E-SMLC, based on the received Routing identifier, in a Positioning Response. Steps 6 to 9 may be repeated if the UE needs to send multiple messages to respond to the request received in Step 4. Steps 1 to 9 may be repeated to send new assistance data, and to request further location information and further UE capabilities.\nNOTE:\tThe DL Positioning Information messages can be asynchronous. Once the E-SMLC sends at least one DL Positioning Information message towards the UE (steps 1-4), the UE can then send zero or more UL Positioning Information messages towards the E-SMLC (steps 6-9). The UE includes the same Routing identifier in each subsequent message.\n9.3a.2\tNetwork Assisted and Network Based Positioning Procedure\nThe following procedure is used by the E-SMLC to support network assisted and network based positioning. RAN positioning procedures related to E-SMLC and eNodeB communication are specified in TS 36.455 [48].\nFigure 9.8f: Network Assisted and Network Based Positioning Procedure\nPrecondition:\tA Correlation identifier allocated by the MME had been passed to the E‑SMLC when the location session (i.e. EPC‑MT‑LR, EPC‑MO‑LR, or EPC‑NI‑LR) was initiated.\n1.\tThe E-SMLC sends a Location Information message to the MME carrying Network Positioning Information and Correlation identifier which may request location information for the UE from the E-UTRAN.\n2.\tIf the UE is not using Control Plane CIoT EPS Optimisation Data Transport in Control Plane CIoT EPS Optimisation and if the UE is in ECM-IDLE state (e.g. if the S1 connection was previously released due to data and signalling inactivity), the MME performs a network triggered service request as defined in TS 23.401 [41] in order to establish a signalling connection with the UE.\nIf the UE is using Control Plane CIoT EPS Optimisation, procedures for Mobile Terminated Data Transport in Control Plane CIoT EPS optimisation as defined in TS 23.401 [41] are performed by the MME to establish a signalling connection with the UE.\n3.\tThe MME sends a Network Positioning Information message conveyed in a S1-AP Transport Message to the serving eNodeB for the UE. The MME includes a Routing identifier in the S1-AP Transport Message, representing the E-SMLC associated with the location session.\n4.\tThe eNodeB obtains any location information for the UE requested in step 3.\n5.\tThe eNodeB returns a Network Positioning Information message to the MME, conveyed in a S1-AP Transport Message, containing the location information obtained in step 4. The eNodeB shall also include the Routing identifier in the S1-AP Transport Message received in step 3.\n6.\tThe MME returns the Network Positioning Information received in step 5 to the E-SMLC based on the received Routing identifier. Steps 1 to 6 may be repeated to request further location information and further E-UTRAN capabilities.\nNOTE:\tThe Network Positioning Information messages can be asynchronous. Once the E-SMLC sends at least one Network Positioning Information message towards the eNodeB (steps 1-3), the eNodeB can then send zero or more Network Positioning Information messages towards the E-SMLC (steps 5-6). The eNodeB includes the same Routing identifier in each subsequent message.\n9.3a.3\tObtaining Non-UE Associated Network Assistance Data\nThe following procedure is used by the E-SMLC to support network assisted and network based positioning. This procedure is not associated with a UE location session. It is used in a MME LCS stateless manner to obtain network assistance data from an eNodeB. RAN positioning procedures related to E-SMLC and eNodeB communication are specified in TS 36.455 [48].\nFigure 9.8g: Obtaining Network Assisted Data\n1.\tThe E-SMLC sends a Location Information message to the MME carrying a Network Positioning Information which may request eNodeB position related information from the E-UTRAN. The target eNodeB identity and E-SMLC identity are included for MME routing purposes.\n2.\tThe MME sends a Network Positioning Information message to the eNodeB, conveyed in a S1-AP Transport Message. The MME includes a Routing identifier that represents the E-SMLC identity in a S1-AP Transport Message. This Routing identifier is not dynamically retained at the MME (i.e., the MME remains LCS stateless).\n3.\tThe eNodeB obtains position information related to the eNodeB.\n4.\tThe eNodeB returns a Network Positioning Information message to the MME, conveyed in a S1-AP Transport Message containing the location information obtained in step 3. The eNodeB also includes the Routing identifier in a S1-AP Transport Message received in step 2.\n5.\tThe MME returns the Network Positioning Information received in step 4 to the E-SMLC. The MME determines the E SMLC from the Routing identifier received in step 4. Steps 4 and 5 may be repeated, using the same Routing identifier if the eNB has multiple messages to respond to the request in Step 2. Steps 1 to 5 may be repeated to request further location information and further E-UTRAN capabilities.\nNOTE:\tThe Network Positioning Information messages can be asynchronous. Once the E-SMLC sends at least one Network Positioning Information message towards the eNodeB (steps 1-2), the eNodeB can then send zero or more Network Positioning Information messages towards the E-SMLC (steps 4-5).\n9.3a.4\tBroadcasting Network Assistance Data\nThe following procedure is used by the E-SMLC to support broadcasting of network assistance data to target UEs. This procedure is not associated with a UE location session. It is used in a MME LCS stateless manner to send network assistance data to an eNodeB for broadcasting by the eNodeB to target UEs. RAN positioning procedures related to E-SMLC and eNodeB communication are specified in TS 36.455 [48].\nFigure 9.8h: Broadcasting Network Assistance Data\n1.\tThe E-SMLC sends a Location Information message to the MME carrying a Network Assistance Data message. The Network Assistance Data message includes assistance data which may be optionally ciphered. The target eNodeB identity and E-SMLC identity are included for MME routing purposes.\n2.\tThe MME sends the Network Assistance Data message to the eNodeB, conveyed in a S1-AP Transport Message. The MME includes a Routing identifier that represents the E-SMLC identity in a S1-AP Transport Message. This Routing identifier is not dynamically retained at the MME (i.e., the MME remains LCS stateless).\n3.\tThe eNodeB broadcasts the assistance data contained in the Network Assistance Data message.\n4.\tThe eNodeB may return a Network Assistance Data Feedback message to the MME, conveyed in a S1-AP Transport Message. The eNodeB also includes the Routing identifier in a S1-AP Transport Message received in step 2.\n5.\tThe MME returns the Network Assistance Data Feedback message received in step 4 to the E-SMLC. The MME determines the E SMLC from the Routing identifier received in step 4.\n9.3a.5\tDelivery of Ciphering Keys to UEs for Broadcast Assistance Data\nThe following procedure depicts a procedure that is used by the E-SMLC and the MME to distribute ciphering keys to UEs to enable UEs to decipher broadcast assistance data that was ciphered by the E-SMLC. This procedure is not associated with a UE location session. The procedure makes use of the Attach and Tracking Area Update (TAU) procedures defined in TS 23.401 [41].\nFigure 9.8i: Delivery of Ciphering Keys to UEs for Broadcast Assistance Data\n1.\tThe E-SMLC sends a Ciphering Key Data message to the MME carrying one or more ciphering keys used to cipher network assistance data that is broadcast to UEs according to the procedure in clause 9.3a.4. For each ciphering key, the E-SMLC includes a ciphering key value, a ciphering key identifier, a validity period, a set of applicable tracking areas and a set of applicable types of broadcast assistance data.\n2.\tThe MME stores the ciphering keys including the validity periods, applicable tracking areas and the types of applicable broadcast assistance data.\n3.\tA UE sends an Attach Request or a TAU Request to the eNodeB. The Attach Request or TAU Request may be sent as part of normal mobility management, A TAU request may also be sent specifically to request and obtain ciphering keys. The UE includes in the Attach Request or TAU Request an indication that ciphering keys are requested. Other details of the Attach Request and TAU Request are as defined in TS 23.401 [41].\nNOTE 1:\tA UE should request new ciphering keys using a TAU Request caused by expiration of the periodic TAU timer if the remaining validity period for one or more ciphering keys received earlier by the UE is less than the TAU timer value. This can help avoid all UEs initiating a TAU procedure at the same time to obtain new ciphering keys when a validity period for a ciphering key is about to expire. A UE should also request new ciphering keys for a TAU Request caused by entering a new tracking area if previous ciphering keys are not applicable to the new tracking area.\n4.\tThe eNodeB forwards the Attach Request or TAU Request to the serving MME.\n5.\tThe serving MME returns an Attach Accept or TAU Accept to the eNodeB as defined in TS 23.401 [41]. The MME includes in the Attach Accept or TAU Accept one or more ciphering keys applicable to the current tracking area for the UE. The MME also includes for each ciphering key the ciphering key value, the ciphering key identifier, the validity period, the set of applicable tracking areas and the set of applicable types of broadcast assistance data.\nNOTE 2:\tThe MME does not need to keep a record of ciphering keys delivered to a UE and may instead send all ciphering keys stored at step 2 that are applicable to the current tracking area, for which the UE has a subscription and whose validity period had not yet expired.\n6.\tThe eNodeB forwards the Attach Accept or TAU Accept to the UE. The UE may start to use each ciphering key to decipher network assistance data that is broadcast according to the procedure in clause 9.3a.4 once the validity period for the ciphering key has started and if the UE is currently in an applicable tracking area. The UE shall cease using a ciphering key when entering a tracking area not applicable to the ciphering key. The UE shall cease using and shall delete a ciphering key when the validity period for the ciphering key has expired.\nNOTE 3:\tA UE that receives no ciphering keys in response to a request for ciphering keys may assume that the UE does not have a subscription to receive ciphering keys in the serving PLMN.\n7.\tThe MME deletes all information for a ciphering key when the validity period has expired.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.3",
        "ts_36.355_figure_9.8",
        "ts_36.455_figure_9.8",
        "ts_23.401_figure_9.8",
        "ts_25.305",
        "ts_43.059",
        "ts_36.355",
        "ts_23.401",
        "ts_36.455"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.4",
      "section_id": "9.4",
      "section_title": "Exception Procedures",
      "content": "The procedures in this clause apply to all variants of an MT-LR, NI-LR and MO-LR where a Location Request message has been sent either to RAN, for a UE with GERAN or UTRAN access, or to an E-SMLC, for a UE with E-UTRAN access, in order to request some location service (e.g. provision of a location estimate for a target UE or transfer of assistance data to a target UE).",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.4.1",
      "section_id": "9.4.1",
      "section_title": "Procedures in the VMSC /MSC server",
      "content": "After the VMSC /MSC server has requested a location service for a particular UE from RAN, certain events may occur that may temporarily or permanently interfere with the location service attempt. For each such event notified to the VMSC /MSC server, the VMSC /MSC server shall employ one of the following error recovery actions.\nRestart the Location Service\nThis action shall be employed for any event that temporarily impedes a location service attempt and cannot be delayed until the location service attempt is complete. When such an event is notified to the VMSC /MSC server, it shall immediately cancel the location service attempt and the associated signalling dialogue with RAN, if this still exists by sending a \"stop reporting\" message to RAN. The \"stop reporting\" message shall contain the reason for the location procedure cancellation in A/Gb mode or the indication about the type of location request to cancel (e.g. direct) in Iu mode.\nAfter aborting the location request dialogue with RAN, the VMSC /MSC server may queue the location service request until the event causing the restart has terminated (if not already terminated). The VMSC /MSC server may optionally wait for an additional time period (e.g. if the queuing delay is minimal) to ensure that any resources allocated in and by RAN have time to be released. The VMSC /MSC server may then send another location service request to RAN associated with the target UE.\nAbort the Location Service\nThis action shall be employed for any event that permanently impedes a location service attempt, such as loss of the dedicated signalling channel to the target UE. When such an event is notified to the VMSC /MSC server, it shall cancel the current location service attempt and the associated signalling dialogue with RAN, if still existing, by sending a \"stop reporting\" message to RAN. The \"stop reporting\" message shall contain the reason for the location procedure cancellation in A/Gb mode or the indication about the type of location request to cancel (e.g. direct) in Iu mode. The VMSC /MSC server shall then return an error response to the client or network entity from which the location request was originally received. The VMSC /MSC server shall also release all resources specifically allocated for the location attempt.\nThe following table indicates the appropriate error recovery procedure for certain events. For events not listed in the table, the VMSC /MSC server need take no action.\nTable 9.1: LCS Error Recovery Procedures in the VMSC /MSC server for certain Events\nEvent\nVMSC /MSC server Error Recovery\nRelease of radio channel to the UE\nAbort\nAny error response from RAN except for SRNC relocation or inter-MSC handover\nAbort\nIn Iu mode inter RNC hard handover, SRNC relocation and inter- MSC or MSC server handover\nAbort on Iu level\nRestart after process is completed\nIn A/Gb mode inter-MSC Handover and inter-BSC handover\nRestart after handover is completed\nInterSystem handover\nRestart after handover is completed\nIf RAN is in an overload condition, it may reject a location request by indicating congestion. The VMSC /MSC server may reduce the frequency of future location service requests until rejection due to overload has ceased.",
      "chunk_type": "procedure",
      "cross_references": [
        "table_9.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.4.3",
      "section_id": "9.4.3",
      "section_title": "Procedures in the SGSN",
      "content": "After the SGSN has requested a location service for a particular UE from RAN, certain events may occur that may temporarily or permanently interfere with the location service attempt. For each such event notified to the SGSN, the SGSN shall employ one of the following error recovery actions.\nRestart the Location Service\nThis action shall be employed for any event that temporarily impedes a location service attempt and cannot be delayed until the location service attempt is complete. When such an event is notified to the SGSN, it shall immediately cancel the location service attempt and the associated signalling dialogue with RAN, if this still exists by sending a \"stop reporting\" (Iu mode) or \"location abort\" (A/Gb mode) message to RAN. The \"stop reporting\"/\"location abort\" message shall contain the reason for the location procedure cancellation.\nAfter aborting the location request dialogue with RAN, the SGSN may queue the location service request until the event causing the restart has terminated (if not already terminated). The SGSN may optionally wait for an additional time period (e.g. if the queuing delay is minimal) to ensure that any resources allocated in and by RAN have time to be released. The SGSN may then send another location service request to RAN associated with the target UE.\nAbort the Location Service\nThis action shall be employed for any event that permanently impedes a location service attempt, such as loss of the radio channel to the target UE. When such an event is notified to the SGSN, it shall cancel the current location service attempt and the associated signalling dialogue with RAN, if still existing, by sending a \"stop reporting\"/\"location abort\" message to RAN. The \"stop reporting\"/\"location abort\" message shall contain the reason for the location procedure cancellation. The SGSN shall then return an error response to the client or network entity from which the location request was originally received. The SGSN shall also release all resources specifically allocated for the location attempt.\nThe following table indicates the appropriate error recovery procedure for certain events. For events not listed in the table, the SGSN need take no action.\nTable 9.2: LCS Error Recovery Procedures in the SGSN for certain Events\nEvent\nSGSN Error Recovery\nRelease of radio channel to the UE\nAbort\nAny error response from RAN causing unavailable signalling connections\nAbort\nInter RNC hard handover, Inter SRNC relocation (Iu mode only)\nAbort on Iu level\nRestart after process is completed\nSuspend of GPRS services (A/Gb mode only)(During CS connection for class B UE)\nAbort\nIntra SGSN Routing Area Update (A/Gb mode only)\nRestart\nInter SGSN Routing Area Update, inter SGSN relocation\nAbort (Note: GMLC may restart)\nStandalone P-TMSI Reallocation (A/Gb mode only)\nRestart\n9.4.3a\tProcedures in the MME\nAfter the MME has requested a location service for a particular UE from an E-SMLC, certain events may occur that may temporarily or permanently interfere with the location service attempt. For each such event notified to the MME, the MME shall employ one of the following error recovery actions.\nAbort the Location Service:\nThis action shall be employed for any event that permanently impedes a location service attempt, such as loss of the radio channel to the target UE or handover to a different MME. When such an event is notified to the MME, it shall cancel the current location service attempt and the associated signalling dialogue with the E-SMLC by sending a \"location abort\" message to the E-SMLC. The \"location abort\" message shall contain the reason for the location procedure cancellation. The MME shall then return an error response to the client or network entity (e.g. GMLC) from which the location request was originally received. The MME shall also release all resources specifically allocated for the location attempt.\nThe following table indicates the appropriate error recovery procedure for certain events. For events not listed in the table, the MME need take no action.\nTable 9..4.3a: LCS Error Recovery Procedures in the MME for certain Events\nEvent\nMME Error Recovery\nUE Detach\nAbort\nInter MME Tracking Area Update\nAbort\nE-UTRAN to UTRAN Routing Area Update\nAbort\nInter MME and inter RAT handover\nAbort\nRRC or S1 connection release not due to User Inactivity (NOTE)\nAbort\nNOTE:\tThe MME can determine the reason for an S1 connection release requested by the eNodeB from the Cause IE included in the UE Context Release Request message - see TS 36.413 [49].\nRelease S1 Connection and Preserve the Location Service\nThis action shall be employed when the MME receives a UE Context Release Request from the serving eNodeB where the cause IE indicates user inactivity. The MME shall release the S1 connection but shall preserve and retain associated context information for the location service.",
      "chunk_type": "procedure",
      "cross_references": [
        "table_9.2",
        "table_9",
        "ts_36.413"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.4.5.1",
      "section_id": "9.4.5.1",
      "section_title": "VMSC /MSC server procedure for Inter-VMSC /MSC server Handover",
      "content": "When a location estimate is required for a target UE with an established call in a state of inter-VMSC /MSC server handover, the serving location area ID shall be used by the visited MSC /MSC server to identify the correct RAN to serve the location request. All location request related messages shall be sent via MAP/E interface piggy-backed in MAP_FORWARD_ACCESS_SIGNALLING and MAP PROCESS_ACCESS_SIGNALLING between the visited and serving MSCs /MSC servers.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.4.5.2",
      "section_id": "9.4.5.2",
      "section_title": "Handling of an ongoing handover while a request for positioning arrives",
      "content": "If during an ongoing handover procedure a request for location information arrives, the request shall be suspended until the handover is completed. On completion of the handover, the location preparation procedure shall continue.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.4.5.3",
      "section_id": "9.4.5.3",
      "section_title": "Handover handling in Iu mode",
      "content": "In case of hard handovers in Iu mode, e.g. inter RNC hard handover, or Serving RNC relocation, and inter- MSC, MSC Server or SGSN handovers, the ongoing positioning process is aborted on Iu level. In soft handovers where the Serving RNS and Iu are relocated, any ongoing positioning process is also aborted on Iu level. The MSC, MSC Server or SGSN shall restart the Iu aborted location requests with the new Serving RNC. The new SGSN, however, shall not restart the location request after inter SGSN Routing Area Update or inter SGSN relocation. During intra and inter RNC soft and softer handovers the existing RRC connection can normally be used without any need to abort the on-going positioning process on Iu level.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.4.5.4.1",
      "section_id": "9.4.5.4.1",
      "section_title": "Common Requirements",
      "content": "Handover of the PS bearer for an established or not yet established IMS emergency call may occur within the PS domain (i.e. intra E-UTRAN, intra UTRAN, E-UTRAN to UTRAN, UTRAN to E-UTRAN, E-UTRAN to HRPD, WLAN to E-UTRAN, or E-UTRAN to WLAN) as defined in TS 23.401 [41], TS 23.402 [44] and TS 23.060 [15]. Handover of an already established IMS emergency call may also occur from the PS domain to the CS domain using SRVCC as defined in TS 23.216 [43] or DRVCC as defined in TS 23.237 [53]. When such an event occurs in a context where location support for the emergency call is required on the source side, continuity of location support may be required on the target side. In this case, the location solution employed on the source and target access sides may stay the same or may change. In addition, some reconfiguration of the associated location server or servers (e.g. GMLC, LRF, E-SLP) may be needed whether or not the solution changes. Table 9.2a summarizes the support of all possible handover scenarios. Note that in all cases, the LRF that was originally assigned to the IMS emergency call as described in clause 9.8.4 must be retained after handover in order to avoid any impact to the emergency centre/PSAP. However, other location server changes (e.g. addition or removal of a GMLC) may occur following handover as summarized in Table 9.2a.\nTable 9.2a: Location Reconfiguration Requirements for handover of an Emergency PS Bearer or IMS Emergency Call to support Location Continuity (Note 1)\nNOTE:\tThe source side can choose to send an update even with no active location.\nSource Access\nSide(s)\nTarget Access\nSide(s)\nSource Location Solution\nTarget Location Solution\nReconfiguration Requirements\nE-UTRAN,\nUTRAN PS\nE-UTRAN,\nUTRAN PS\nTS 23.271\nTS 23.271\nEither (a) Source side SGSN or MME transfers the target side SGSN or MME identity to the source side GMLC\nOr (b) Target side SGSN or MME transfers its own identity to the target side GMLC (Note 2)\nSource or target side GMLC updates the LRF\nLRF replaces the source side GMLC with the target side GMLC if the GMLCs are different\nE-UTRAN,\nUTRAN PS\nE-UTRAN,\nUTRAN PS\nTS 23.271\nOMA AD SUPL [38], OMA TS ULP [39]\n(Note 3)\nSource side SGSN or MME transfers the target side SGSN or MME identity to the source side GMLC (Note 2)\nSource side GMLC updates the LRF\nLRF replaces the source side GMLC with a target side E-SLP\nLRF transfers the UE identity or address (e.g. IP address) to the target side E-SLP when the UE location is next needed.\nE-UTRAN,\nUTRAN PS\nE-UTRAN,\nUTRAN PS\nOMA AD SUPL [38], OMA TS ULP [39]\nTS 23.271 (Note 3)\nTarget side SGSN or MME transfers its own identity to the target side GMLC (Note 2)\nTarget side GMLC updates the LRF\nLRF replaces the source side SUPL E-SLP with the target side GMLC\nE-UTRAN,\nUTRAN PS,\nWLAN\nE-UTRAN,\nUTRAN PS,\nWLAN\nOMA AD SUPL [38], OMA TS ULP [39]\nOMA AD SUPL [38], OMA TS ULP [39]\nNone identified\nE-UTRAN\nHRPD\nTS 23.271\nOMA AD SUPL [38], OMA TS ULP [39]\nSource side MME transfers an HRPD indication and an HRPD identity if known (e.g. cell ID) to the source side GMLC (Note 2)\nSource side GMLC updates the LRF\nLRF replaces the source side GMLC with a target side E-SLP\nLRF transfers the UE identity or address (e.g. IP address) to the target side E-SLP when the UE location is next needed.\nE-UTRAN,\nUTRAN PS\nUTRAN CS\nGERAN CS\nTS 23.271\nTS 23.271\nEither (a) Source side SGSN or MME transfers the target side SRVCC MSC identity to the source side GMLC\nOr (b) Target side SRVCC MSC transfers its own identity to the target side GMLC (Note 2)\nSource or target side GMLC updates the LRF\nLRF replaces the source side GMLC with the target side GMLC if the GMLCs are different\nE-UTRAN,\nUTRAN PS\nUTRAN CS\nGERAN CS\nOMA AD SUPL [38], OMA TS ULP [39]\nTS 23.271\nTarget side SRVCC MSC transfers its own identity to the target side GMLC (Note 2)\nTarget side GMLC updates the LRF\nLRF replaces the source side SUPL E-SLP with the target side GMLC\nE-UTRAN\n1xRTT\nTS 23.271\nJ-STD-036B [32]\n(Note 4)\nEither (a) Source side MME transfers the 1xRTT Reference Cell ID to the source side GMLC\nOr (b) A target side update occurs (Note 2, Note 4)\nSource side GMLC or Target side updates the LRF (Note 4)\nLRF replaces the source side GMLC with location support on the target side (Note 4)\nE-UTRAN\n1xRTT\nOMA AD SUPL [38], OMA TS ULP [39]\nJ-STD-036B [32]\n(Note 4)\nThe target side updates the LRF (Note 4)\nThe LRF replaces the source side E-SLP with location support on the target side (Note 4)\nE-UTRAN\nWLAN\nTS 23.271\nOMA AD SUPL [38], OMA TS ULP [39]\nor\nUPLI/NPLI TS 23.167 [36a]\nSource side MME transfers an indication of handover to a non-3GPP access to the source side GMLC (Note 2)\nSource side GMLC updates the LRF\nLRF removes use of the GMLC\nIf SUPL is used on the target side, the LRF assigns a target side E-SLP and transfers the UE identity or address (e.g. IP address) to the E-SLP when the UE location is next needed.\nWLAN\nE-UTRAN\nOMA AD SUPL [38], OMA TS ULP [39]\nor\nUPLI/NPLI TS 23.167 [36a]\nTS 23.271\nTarget side MME transfers its own identity to the target side GMLC (Note 2)\nTarget side GMLC updates the LRF\nLRF uses the target side GMLC and removes the source side SUPL E-SLP if previously used.\nWLAN\nUTRAN CS\nGERAN CS\nOMA AD SUPL [38], OMA TS ULP [39]\nor\nUPLI/NPLI TS 23.167 [36a]\nTS 23.271\nTarget side MSC server transfers its own identity to the target side GMLC (Note 5)\nTarget side GMLC updates the LRF\nLRF uses the target side GMLC and removes the source side SUPL E-SLP if previously used.\nNOTE 1:\tIt is assumed that all handovers are intra-operator and that a single LRF is used by an operator for all IMS emergency calls. Use of more than one LRF is FFS.\nNOTE 2:\tA source side update should be configured if the control plane location is used on the source side but will not be used on the target side. A target side update should be configured if the control plane location will be used on the target side but was not used on the source side. An update on either the source or target side but not both should be configured when the control plane location solution is or may be used on both sides. No update is needed when a user plane location solution is used on both sides. The knowledge of the location solution can also be configured - e.g. and may depend on the access type, the location capabilities of the UE and whether a UE is roaming or not..\nNOTE 3:\tit is allowed to change location solution for an intra E-UTRAN or intra UTRAN PS handover as well as for inter-RAT PS handover although this is expected to be an unlikely scenario for handover within the same operator's networks.\nNOTE 4:\tactions on the target 1xRTT side are outside the scope of this TS.\nNOTE 5:\tThe target side MSC server needs to be aware of E-STN-DR association with an emergency call.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.8.4",
        "table_9.2",
        "ts_23.401",
        "ts_23.402",
        "ts_23.060",
        "ts_23.216",
        "ts_23.237",
        "ts_23.271",
        "ts_23.167"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.4.5.4.2",
      "section_id": "9.4.5.4.2",
      "section_title": "Location Continuity for Handover between 3GPP and 3GPP2 Access Types",
      "content": "Details concerning the interactions between the LRF, GMLCs, E-SLPs and any 1xRTT location servers to support the reconfiguration requirements in Table 9.2a are outside the scope of this TS. Support of location continuity by other entities is defined below in association with Figure 9.8h.\nFigure 9.8h: Support of Location Continuity for Handover of an IMS Emergency Call\n1.\tFollowing the request for an emergency call, the UE establishes an emergency PDN connection for E-UTRAN access as defined in TS 23.401 [41] or an emergency PDP context for UTRAN PS access as defined in TS 23.060 [15]. The UE may then establish an IMS emergency call as defined in TS 23.167 [36a] during which an LRF is assigned and a source location server (e.g. GMLC) may be chosen as described in clause 9.8.4\n2.\tAt some later time, the serving MME or SGSN (hereafter referred to as the source SGSN or MME) may receive a request from an associated GMLC (hereafter referred to as the source GMLC) for the location of the UE if the location solution defined in this TS is used on the source access side.\n3.\tIf step 2 occurs or if support for an NI-LR is required, the source SGSN or MME starts a location session with the serving RNC or an E-SMLC, in each case respectively, to obtain the location of the UE.\n4.\tA request is later sent to the source SGSN or MME from the serving eNodeB (for E-UTRAN access) or serving RNC (for UTRAN access) for a handover to a particular target eNodeB (for handover to E-UTRAN) or target RNC (for handover to UTRAN PS) or target MSC server (for handover to UTRAN CS or GERAN CS) or target cell associated with a particular 1xRTT MSC (for handover to 1xRTT) or HRPD target cell (for handover to HRPD).\n5.\tFor handover to E-UTRAN, UTRAN PS, UTRAN CS or GERAN CS, the source MME or SGSN sends a Handover Request message to the target MME, SGSN, MSC server or MSC server (hereafter referred to as the target serving node) in each case respectively as defined in TS 23.401 [41], TS 23.060 [15] or TS 23.216 [43]. For handover from E-UTRAN to 1xRTT, the source MME initiates a handover to a target 1xRTT IWS using single radio voice call continuity procedures as described in TS 23.216 [43]. For handover from E-UTRAN to HRPD, this step does not occur.\n6.\tThe rest of the handover preparation and execution procedure is completed as defined in TS 23.401 [41], TS 23.402 [44], TS 23.060 [15] or TS 23.216 [43].\n7.\tThe location session started in step 3 may terminate normally before step 6 is complete. If not, the source SGSN or MME shall abort the session once step 6 is complete. This may lead to provision of a location estimate for the UE to the source SGSN or MME.\n8a.\tIf the location solution defined in this TS is used on the source side and step 2 occurred, the source SGSN or MME returns a Provide Subscriber Location response to the source GMLC carrying any location estimate obtained previously for the UE. Depending on configuration information in the source SGSN or MME (e.g. which may be related to the source and target serving node identities, the location capabilities of the UE and whether the UE is roaming or not), the Provide Subscriber Location response may, except for handover to HRPD, convey the identity of the target serving node. In the case of handover to 1xRTT, the Provide Subscriber Location response may convey the Reference Cell ID.\n8b.\tIf the location solution defined in this TS is used on the source side but steps 2 and 8a do not occur, the source SGSN or MME may depending on configuration information in the source SGSN or MME (e.g. as in step 8a) send a Subscriber Location Report to the source GMLC carrying the UE identity (IMSI, MSISDN and/or IMEI), an event type indicating handover and, except for handover to HRPD, the identity of the target serving node. In the case of handover to 1xRTT, the Subscriber Location Report may convey the Reference Cell ID.\n9.\tThe source GMLC acknowledges the message in step 8b if this occurs.\n10.\tSteps 10 and 11 only apply when the target side supports a 3GPP access type (e.g. do not apply to 1xRTT or HRPD). Depending on configuration information in the target serving node (e.g. which may be related to the source and target serving node identities, the location capabilities of the UE and whether the UE is roaming or not), the target serving node may after handover in step 6 is complete send a Subscriber Location Report to a GMLC on the target side if the location solution defined in this TS will be used on the target side. The Subscriber Location Report carries the UE identity (IMSI, MSISDN and/or IMEI), an event type indicating handover and the identity of the target serving node. If the target serving node is an MSC, it will send the UE identity as received from source MME/SGSN in Handover Request message in step 5. If the MSC does not receive MSISDN from source MME/SGSN, MSISDN may be populated with a non-dialable callback number as specified in clause 6.4.3. However, no location estimate is included. The target serving node may determine the address of the target GMLC from configuration information.\n11.\tThe target GMLC acknowledges the message in step 10.\n12.\tReconfiguration of the LRF and the source and target location servers may occur as summarized in Table 9.2a which may involve removal of a source GMLC or E-SLP, assignment of a new target GMLC or E-SLP and/or updating of information in the LRF and in the source/target location server(s). The details of this step are outside the scope of this TS.\n13.\tIf the LRF needs a location estimate for the UE after handover has occurred, it may instigate an MT-LR request via either the target GMLC if the location solution defined in this TS will be used on the target side or a target E‑SLP if the location solution defined in OMA SUPL [38], [39] will be used. This will involve a repetition of step 2 on the target side if the location solution defined in this TS is used. Steps 2 to 12 may also be repeated on the target side to support a further handover if the previous handover was to either E-UTRAN or UTRAN PS.\nIf target serving node is MME and it determines that emergency service is no longer active, the MME may send a Subscriber Location Report to the GMLC with the event (EMERGENCY_CALL_RELEASE) causing the message, see step 8-10 of figure 9-20.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.8.4",
        "clause_6.4.3",
        "table_9.2",
        "figure_9.8",
        "figure_9-20",
        "ts_23.401",
        "ts_23.060",
        "ts_23.167",
        "ts_23.216",
        "ts_23.402"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.4.5.4.3",
      "section_id": "9.4.5.4.3",
      "section_title": "Location Continuity for E-UTRAN Handover to WLAN",
      "content": "Support of location continuity for E-UTRAN handover to WLAN is defined below in association with Figure 9.8i.\nFigure 9.8i: Location Continuity for Handover of an IMS Emergency Call from E-UTRAN to WLAN\n1.\tFollowing the request for an emergency call, the UE establishes an emergency PDN connection for E-UTRAN access as defined in TS 23.401 [41]. The UE may then establish an IMS emergency call as defined in TS 23.167 [36a] during which an LRF is assigned and a source location server (e.g. a GMLC) may be chosen as described in clause 9.8.4.\n2.\tAt some later time, the serving MME (hereafter referred to as the source MME) may receive a request from an associated GMLC (hereafter referred to as the source GMLC) for the location of the UE if the location solution defined in this TS is used on the source access side.\n3.\tIf step 2 occurs or if support for an NI-LR is required, the source MME starts a location session with the serving E-SMLC to obtain the location of the UE.\n4.\tA handover of the UE to WLAN access occurs as defined in TS 23.402 [44]. The source MME is informed of the handover to a non-3GPP access through the PDN GW Initiated PDN Disconnection at the end of the handover procedure (see TS 23.401 [41] and TS 23.402 [44]).\n5.\tThe location session started in step 3 may terminate normally before step 4 is complete. If not, the source MME shall abort the session once step 4 is complete. This may lead to provision of a location estimate for the UE to the source MME.\n6a.\tIf the location solution defined in this TS is used on the source side and step 2 occurred, the source MME returns a Provide Subscriber Location response to the source GMLC carrying any location estimate obtained previously for the UE and including an indication of handover to a non-3GPP access.\n6b.\tIf the location solution defined in this TS is used on the source side but steps 2 and 6a do not occur, the source MME shall send a Subscriber Location Report to the source GMLC carrying the UE identity (IMSI, MSISDN and/or IMEI), an event type indicating handover and an indication of handover to a non-3GPP access.\n7.\tThe source GMLC acknowledges the message in step 6b if this occurs.\n8.\tReconfiguration of the LRF and the source and target location servers may occur as summarized in Table 9.2a which may involve removal of a source GMLC, assignment of a new target E-SLP and/or updating of information in the LRF and in the source/target location server(s). The details of this step are outside the scope of this TS.\n9.\tIf the LRF needs a location estimate for the UE after handover has occurred, it may either instigate an MT-LR request via a target E SLP if the location solution defined in OMA SUPL [38], [39] will be used on the target side or instigate a location request for a UPLI or NPLI as defined in TS 23.167 [36a].",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.8.4",
        "table_9.2",
        "figure_9.8",
        "ts_23.401",
        "ts_23.167",
        "ts_23.402"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.4.5.4.4",
      "section_id": "9.4.5.4.4",
      "section_title": "Location Continuity for WLAN Handover to E-UTRAN, UTRAN or GERAN",
      "content": "Support of location continuity for WLAN handover to E-UTRAN, UTRAN or GERAN is defined below in association with Figure 9.8j.\nFigure 9.8j: Location Continuity for Handover of an IMS Emergency Call from WLAN to E-UTRAN, UTRAN or GERAN\n1.\tFollowing the request for an emergency call, the UE establishes an emergency PDN connection for WLAN access as defined in TS 23.402 [44]. The UE may then establish an IMS emergency call as defined in TS 23.167 [36a] during which an LRF is assigned and a source location server (e.g. an E-SLP) may be chosen as described in clause 9.8.4.\n2.\tA handover of the UE to either E-UTRAN access or UTRAN/GERAN CS access occurs as defined in TS 23.402 [44] or TS 23.237 [53], respectively. For handover to E-UTRAN, the target MME is informed of the handover through the UE Attach Request indicating \"handover for emergency services\" at the start of the handover procedure as defined in TS 23.402 [44]. For handover to GERAN or UTRAN CS access, the target MSC server is informed of the handover through receipt of a normal CS call setup request from the UE using an E-STN-DR assigned by the serving network as defined in TS 23.237 [53].\n3.\tAfter the handover in step 2 is complete, the target MME or MSC server shall send a Subscriber Location Report to a GMLC on the target side if the location solution defined in this TS will be used on the target side. The Subscriber Location Report carries the UE identity (IMSI, MSISDN and/or IMEI), an event type indicating handover and the identity of the target serving node. The target serving node may determine the address of the target GMLC from configuration information.\n4.\tThe target GMLC acknowledges the message in step 3.\n5.\tReconfiguration of the LRF and the source and target location servers may occur as summarized in Table 9.2a which may involve removal of a source E-SLP, assignment of a new target GMLC and/or updating of information in the LRF and in the source/target location server(s). The details of this step are outside the scope of this TS.\n6.\tIf the LRF needs a location estimate for the UE after handover has occurred, it may instigate an MT-LR request via the target GMLC if the location solution defined in this TS will be used on the target side.\nIf the location solution defined in this TS will be used on the target side and the target MME or MSC server determines that emergency service is no longer active, the MME or MSC server may send a Subscriber Location Report to the GMLC with the event (EMERGENCY_CALL_RELEASE) causing the message, see steps 8-10 of Figure 9.20 in the case of a target MME or steps 11-12 of Figure 9.4 in the case of a target MSC server.",
      "chunk_type": "general",
      "cross_references": [
        "clause_9.8.4",
        "table_9.2",
        "figure_9.8",
        "figure_9.20",
        "figure_9.4",
        "ts_23.402",
        "ts_23.167",
        "ts_23.237"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.5.1",
      "section_id": "9.5.1",
      "section_title": "Privacy Override Indicator (POI)",
      "content": "The POI is used to determine whether the privacy settings of the subscriber to be positioned shall be overridden by the request for location services. The POI is applicable only to Emergency service and Lawful intercept service. The assignment of a POI value with an \"override\" or \"not override\" value in the LCS client profile is done during the LCS client provisioning. The type of LCS client requesting location information (i.e. emergency, law-enforcement etc.) shall determine the value of the POI assigned to the LCS client profile.\nPOI is not sent to the MME.\nThere are two distinct cases regarding the handling of the privacy override indicator.\nProcedure A: If the subscriber to be positioned is in the same country as the GMLC or if the subscriber to be positioned is in a different country than the GMLC and an appropriate bilateral agreement exists between operators, then the POI shall override the subscriber's privacy options, as allowed by regulatory requirements.\nProcedure B: Otherwise the POI shall not override the subscriber's privacy options.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.2",
      "section_id": "9.5.2",
      "section_title": "Privacy Procedures",
      "content": "The privacy profile of the UE subscriber (SLPP) may for GSM and UMTS be stored in HLR/HSS and/or in H-GMLC/PPR. The privacy profile of the UE subscriber (SLPP) shall for EPS be stored in H-GMLC/PPR. If the privacy profile data are stored in SLPP of H-GMLC/PPR, then the pseudo external identities, if required, shall be contained in the SLPP of the HLR/HSS. Also if the privacy profile data are stored in H-GMLC/PPR, H-GMLC/PPR sends the indicators of privacy related action or the pseudo external identities to the serving nodes in order to inform the results of the privacy check procedures in H-GMLC/PPR.\nThe SLPP stored in the HLR/HSS shall be downloaded to the VMSC, MSC Server and SGSN together with the rest of his subscription information in the existing operation INSERT_SUBSCRIBER_DATA. It will be deleted with the existing operation DELETE_SUBSCRIBER_DATA.\nIn case of an Emergency Services location request, based on the location of the VMSC/MSC Server/SGSN and the R-GMLC, the V -GMLC evaluates whether to accept or ignore the received POI, according to the definition in clause 9.1.5. If privacy override is not allowed, then the V-GMLC rejects the request.\nIn case the privacy override i s allowed, the POI is transferred from the GMLC to the VMSC/MSC Server/SGSN in the location request. Based on the location of the GMLC the VMSC/MSC Server/SGSN evaluates whether to accept or ignore the received POI according to the definition in clause 9.5.1.\nIf the POI is accepted the location requested is unconditionally performed. Otherwise the VMSC/MSC Server/SGSN evaluates the privacy options in the UE subscriber's subscription profile (assuming this is held in the VLR/MSC Server/SGSN) or evaluates the received privacy related action indicators. If the corresponding register does not contain the UE subscription profile, LCS will rely on the existing GSM recovery mechanisms to obtain the profile.\nIf local regulatory requirements mandate it, any MT-LR for an emergency services LCS client and any NI-LR for an emergency services call origination shall be allowed by the VMSC/MSC Server/SGSN/MME.\nIf the location request is allowed by the privacy options the location request is performed. Otherwise, if the location request is barred by the privacy options, the location request is refused an error response is returned to the LCS client with a cause code indicating that the request was rejected by the subscriber.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.1.5",
        "clause_9.5.1"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.5.3",
      "section_id": "9.5.3",
      "section_title": "UE Privacy Options",
      "content": "The UE privacy options in the SLPP apply to an CS-MT-LR/PS-MT-LR or NI-LR/PS-NI-LR and either indicate that no CS-MT-LR/PS-MT-LR or NI-LR/PS-NI-LR is allowed for the UE (except as may be overridden by the POI or local regulatory requirements) or define the particular classes of LCS client for which an CS-MT-LR/PS-MT-LR or NI‑LR/PS-NI-LR for location are allowed, with the following classes being possible:\n[Editor's note: An e-mail comment pointed out that there are different cases still to be covered in the description of the classes: 1. the LCS Client identity is included in SLPP or 2. the LCS Client identity is NOT included in SLPP. Also some GMLC restriction conditions need to be mentioned.]\na)\tUniversal Class - allow positioning by all LCS clients;\nb)\tCall/Session related Class\nc)\tCall/Session-unrelated Class\nd)\tPLMN operator Class\nMoreover the SLPP may contain the service types allowed by the subscriber. All UE privacy options of above four classes are commonly used for both CS and PS domain.The privacy classes are selected according to the rules described in the ANNEX A. If more than one privacy class are subscribed in the UE's SLPP, the looser privacy setting shall be selected. ANNEX A applies also in case service types privacy checking are subscribed together with one or more other privacy classes.\nNOTE 1:\tIf a privacy option setting in a domain is updated, the same modification will be applied to the other domain.\nNOTE 2:\tThe options for each privacy class and the service type are described in the subsequent clauses independently from the options of the other privacy classes. The combination of the privacy class and service type options are described in the rules of Annex A",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.3.1",
      "section_id": "9.5.3.1",
      "section_title": "Universal class",
      "content": "When the user of the UE subscribes to the \"Universal Class\" the CS-MT-LR/PS-MT-LR or NI-LR/PS-NI-LR positioning is allowed by all LCS clients.\nIf the UE subscribes to the universal class, any CS-MT-LR or NI-LR shall be allowed by the VMSC/MSC Server and any PS-MT-LR or PS-NI-LR shall be allowed by the SGSN.\nIf the UE subscribes to the universal class and H-GMLC/PPR knows that the serving node supports the indicator of privacy check related action, H-GMLC/PPR sends the indicators for call/session unrelated class, which indicates \"Location allowed without notification\". If the UE subscribes to the universal class and H-GMLC/PPR knows that the serving node does not support the indicator of privacy check related action, H-GMLC/PPR may sends the appropriate pseudo external identity as described in Annex C.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.3.2",
      "section_id": "9.5.3.2",
      "section_title": "Call/Session related class",
      "content": "When the user of the UE subscribes to the \"Call/Session related Class\" the CS-MT-LR/PS-MT-LR/EPC-MT-LR or NI-LR/PS-NI-LR positioning is allowed in the following cases:\nAllow positioning by specific identified value added LCS client or groups of value added LCS Client to which the UE originated a call in CS domain or a value added LCS client with which the UE has a session via an active PDP context in PS domain indicated by a specific APN-NI. For each identified LCS client or group of LCS Clients, one of the following subscription options shall apply:\n*\tlocation request allowed only from GMLCs identified in the SLPP;\n*\tlocation request allowed only from a GMLC in the home country;\n*\tlocation request allowed from any GMLC (default case).\nFor each identified value added LCS client or group of LCS Clients in the privacy exception list, one of the following subscription options shall apply:\n*\tpositioning allowed without notifying the UE user (default case);\n*\tpositioning allowed with notification to the UE user;\n*\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user or if there is no response to the notification;\n*\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user.\nFor all value added LCS clients sending a call related CS-MT-LR/PS-MT-LR/EPC-MT-LR that are not identified in the privacy exception list, one of the following subscription option shall apply:\n*\tpositioning not allowed;\n*\tpositioning allowed without notifying the UE user (default case);\n*\tpositioning allowed with notification to the UE user;\n*\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user or if there is no response to the notification;\n*\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user.\nNOTE 2:\tThe usage of Call/Session related Class in the IM subsystem is FFS.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.3.2.1",
      "section_id": "9.5.3.2.1",
      "section_title": "Call/session-related class in the CS-domain",
      "content": "If the UE subscribes to the call/session-related class, an CS-MT-LR may be allowed if both of following conditions are met:\n-\tThe UE previously originated a call in CS domain that is still established and the called party number dialled by the UE matches the called party number received from the GMLC.\n-\tThe identity of the LCS client or LCS client group supplied by the GMLC matches the identity of any LCS Client or LCS Client group contained in the UE's SLPP and any other GMLC restrictions associated with this LCS Client identity in the SLPP are also met\nIf these conditions are satisfied, the CS-MT-LR shall be allowed if the UE user subscribes to either location without notification or location with notification. If the UE user subscribes to location with notification and privacy verification, the CS-MT-LR shall be allowed following notification to the UE if the UE user either returns a response indicating that location is allowed or returns no response but subscribes to allowing location in the absence of a response. In all other cases, the CS-MT-LR shall be restricted.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.3.2.2",
      "section_id": "9.5.3.2.2",
      "section_title": "Call/session-related class in the PS-domain",
      "content": "If the UE subscribes to the call/session-related class, a PS-MT-LR/EPC-MT-LR may be allowed if all of the following conditions are met:\n-\tThe UE previously originated a PDP/EPS Bearer-context towards the network where the external client is located and that this context is still established.\n-\tThe APN-NI negotiated between the UE and SGSN/MME matches the APN-NI received from the GMLC.\n-\tThe identity of the LCS client or LCS client group supplied by the GMLC matches the identity of any LCS Client or LCS Client group contained in the UE's SLPP and any other GMLC restrictions associated with this LCS Client identity in the SLPP are also met.\nIf these conditions are satisfied, the PS-MT-LR/EPC-MT-LR shall be allowed if the UE user subscribes to either location without notification or location with notification. If the UE user subscribes to location with notification and privacy verification, the PS-MT-LR/EPC-MT-LR shall be allowed following notification to the UE if the UE user either returns a response indicating that location is allowed or returns no response but subscribes to allowing location in the absence of a response. In all other cases, the PS-MT-LR/EPC-MT-LR shall be restricted.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.3.2.3",
      "section_id": "9.5.3.2.3",
      "section_title": "Call/session-related class when LCS client not in SLPP",
      "content": "If the UE subscribes to the call/session related class, a CS-MT-LR, PS-MT-LR or EPC-MT-LR from an LCS client that is NOT contained in the SLPP of the target UE shall be allowed or restricted according to the following conditions:\n-\tFor any non-matched LCS client, the CS-MT-LR, PS-MT-LR or EPC-MT-LR shall be allowed, if the UE user subscribes to either location without notification or location with notification.\nIf the UE user subscribes to location with notification and privacy verification, the CS-MT-LR, PS-MT-LR or EPC-MT-LR shall be allowed following notification to the UE if the UE user either returns a response indicating that location is allowed or returns no response but subscribes to location in the absence of a response. In all other cases, the CS-MT-LR, PS-MT-LR or EPC-MT-LR shall be restricted.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.3.3",
      "section_id": "9.5.3.3",
      "section_title": "Call/Session-unrelated class",
      "content": "When the user of the UE subscribes to the \"Call/Session unrelated Class\" the CS-MT-LR/PS-MT-LR/EPC-MT-LR or NI-LR/PS-NI-LR positioning is allowed in the following cases:\nAllow positioning by specific identified value added LCS Clients or groups of value added LCS Client with the following restrictions allowed for each identified value added LCS Client or group of value added LCS Clients:\n*\tlocation request allowed only from GMLCs identified in the SLPP;\n*\tlocation request allowed only from a GMLC in the home country;\n*\tlocation request allowed from any GMLC (default case).\nFor each identified value added LCS client in the privacy exception list, one of the following subscription options shall apply:\n*\tpositioning allowed without notifying the UE user (default case);\n*\tpositioning allowed with notification to the UE user;\n*\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user or if there is no response to the notification;\n*\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user.\nFor all value added LCS clients sending a non-call/session related CS-MT-LR/PS-MT-LR/EPC-MT-LR that are not identified in the privacy exception list, one of the following subscription option shall apply:\n*\tpositioning not allowed (default case);\n*\tpositioning allowed with notification to the UE user;\n*\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user or if there is no response to the notification;\n*\tpositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.3.3.1",
      "section_id": "9.5.3.3.1",
      "section_title": "Call/session-unrelated class when LCS client identities match",
      "content": "If the UE subscribes to the call/session-unrelated class, an CS-MT-LR/PS-MT-LR/EPC-MT-LR may be allowed by the MSC/MSC server, SGSN or MME if the identity of the LCS client or LCS client group supplied by the GMLC matches the identity of any LCS Client or LCS Client group contained in the UE's SLPP and any other GMLC restrictions associated with this LCS Client identity in the SLPP are also met.\nIf the LCS client is correctly matched in this way and any GMLC restrictions are satisfied, the CS-MT-LR/PS-MT-LR/EPC-MT-LR shall be allowed if the UE user subscribes to either location without notification or location with notification. If the UE user subscribes to location with notification and privacy verification, the CS-MT-LR/PS-MT-LR/EPC-MT-LR shall be allowed following notification to the UE if the UE user either returns a response indicating that location is allowed or returns no response but subscribes to location in the absence of a response. In all other cases, the CS-MT-LR/PS-MT-LR/EPC-MT-LR shall be restricted.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.3.3.2",
      "section_id": "9.5.3.3.2",
      "section_title": "Call/session-unrelated class when LCS client identities do not match",
      "content": "If the UE subscribes to the call/session-unrelated class, an CS-MT-LR/PS-MT-LR/EPC-MT-LR from an LCS client that is not contained in the UE's SLPP shall be allowed or restricted according to the following conditions. For any non-matched LCS client, the CS-MT-LR/PS-MT-LR/EPC-MT-LR shall be allowed if the UE user subscribes to location with notification. If the UE user subscribes to location with notification and privacy verification, the CS-MT-LR/PS-MT-LR/EPC-MT-LR shall be allowed following notification to the UE if the UE user either returns a response indicating that location is allowed or returns no response but subscribes to location in the absence of a response. In all other cases, the CS-MT-LR/PS-MT-LR/EPC-MT-LR shall be restricted.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.3.4",
      "section_id": "9.5.3.4",
      "section_title": "PLMN operator class",
      "content": "When the user of the UE subscribes to the \" PLMN operator Class\" the CS-MT-LR/PS-MT-LR or NI-LR/PS-NI-LR positioning is allowed in the following cases:\nAllow positioning by specific types of client within or associated with the VPLMN, with the following types of client identified:\n*\tclients providing a location related broadcast service;\n*\tO&M client in the HPLMN (when the UE is currently being served by the HPLMN);\n*\tO&M client in the VPLMN;\n*\tclients recording anonymous location information without any UE identifier;\n*\tclients enhancing or supporting any supplementary service, IN service, bearer service or teleservice subscribed to by the target UE subscriber.\nIf the UE subscribes to the PLMN class, an NI-LR/PS-NI-LR or CS-MT-LR/PS-MT-LR shall be allowed if the client within the VPLMN, for an NI-LR/PS-NI-LR, or the client identified by the GMLC, for an CS-MT-LR/PS-MT-LR, either matches a generic type of client contained in the UE's SLPP or is otherwise authorized by local regulatory requirements to locate the UE. If H-GMLC/PPR knows that the serving node supports LCS capability set 4 or later, then H-GMLC/PPR will send the indicators for call/session unrelated class, which indicates 'location allowed without notification'. If H-GMLC/PPR is notified that the serving node does not support the LCS capability set 4 or later, then it will not send any indicator.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.3.5",
      "section_id": "9.5.3.5",
      "section_title": "Service type checking",
      "content": "If the SLPP contains service types, a CS-MT-LR/PS-MT-LR may be allowed if the service type supplied by the LCS client matches the identity of any service type contained in the UE's SLPP and any other GMLC restrictions associated with this service type in the SLPP are also met.\nIf the service type is correctly matched in this way and any GMLC restrictions are satisfied, the CS-MT-LR/PS-MT-LR shall be allowed if the UE user subscribes to either location without notification or location with notification. If the UE user subscribes to location with notification and privacy verification, the CS-MT-LR/PS-MT-LR shall be allowed following notification to the UE if the UE user either returns a response indicating that location is allowed or returns no response but subscribes to location in the absence of a response. In all other cases, the CS-MT-LR/PS-MT-LR shall be restricted.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.3.6",
      "section_id": "9.5.3.6",
      "section_title": "Matching of LCS client identities",
      "content": "In evaluating privacy where any address \"A\" associated with the LCS client (e.g. LCS client ID or GMLC address) needs to be compared with a corresponding address \"B\" in the target UE's SLPP, a match shall be determined if a match is found for each of the following components of each address:\na)\tnumbering plan;\nb)\tnature of address indicator;\nc)\tcorresponding address digits for all digits in \"B\" (the digits or initial digits in \"A\" must match all the digits in \"B\", but \"A\" may contain additional digits beyond those in \"B\").\nAll addresses shall be transferred to the MSC/VLR, MSC server or SGSN in international format, except for the called party number received from the GMLC during a Call-Related CS MT-LR when the LCS client was reached via IN or abbreviated number routing (e.g. toll-free number or emergency call routing). In these cases it is up to the GMLC to use the valid national specific number of the visited country.\nIn evaluating privacy where an APN-NI associated with the LCS client notified by the GMLC needs to be compared with a corresponding APN-NI that is used to set up the associated PDP context, a match shall be determined if a match is found for each component of APN-NI.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.5.4",
      "section_id": "9.5.4",
      "section_title": "Indicator of privacy check related action",
      "content": "When the client type indicates value added service and the serving node supports LCS capability set 4 or later, H-GMLC/PPR shall select indicators for privacy check related action and the indicators shall be included in the Provide_Subscriber_Location request towards the serving node. The indication is sent to the serving node directly from the H-GMLC or via V-GMLC. There shall be an indicator for the call/session unrelated. For GSM and UMTS there shall be an optional indicator for the call/session related and it shall be sent only if call/session related identity, i.e. the number dialled by UE or APN-NI, is sent to the serving node. For EPS, there shall be an optional indicator for the session related and it shall be sent only if session related identity, i.e. APN-NI, is sent to the serving node.\nThe possible values of the indicator of privacy check related action for call/session unrelated case shall be:\n-\tLocation allowed without notification\n-\tLocation allowed with notification\n-\tLocation with notification and privacy verification; location allowed if no response\n-\tLocation with notification and privacy verification; location restricted if no response\n-\tLocation not allowed (only applicable when the indicator for call/session related case is sent, or the POI is included in the provide subscriber location request)\nThe possible values of the indicator of privacy check related action for call/session related case shall be:\n-\tLocation allowed without notification\n-\tLocation allowed with notification\n-\tLocation with notification and privacy verification; location allowed if no response\n-\tLocation with notification and privacy verification; location restricted if no response\nIf both indicators are sent but indicating different actions and the call/session related criteria met in the serving node then an action according to the indicator with the looser action according to the definition in Annex A shall be chosen as shown in Annex A.3.\nIf the UE subscribes service types, then the result of the service type checking may be included in any of the privacy check indicators, as it is described in annex A.3.\nIf the UE subscribes either to PLMN class or to the universal class, H-GMLC/PPR sends the indicator for call/session unrelated class with the value of \"Location allowed without notification\".",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.6",
      "section_id": "9.6",
      "section_title": "Mobile Originating Location",
      "content": "An UE may subscribe to any of the following classes of mobile originating location:\na)\tBasic Self Location;\nb)\tAutonomous Self Location;\nc)\tTransfer to Third Party.\nAn MO-LR shall be allowed by the serving node (VMSC/MSC Server/SGSN/MME) if the type of request is supported by the appropriate subscription according to the following table.\nTable 9.3: Required UE Subscription Options for MO-LR Requests\nType of MO-LR Request\nRequired UE Subscription\nUE requests own location\nBasic Self Location\nUE requests location assistance data\nAutonomous Self Location\nUE requests transfer of own location to another LCS Client\nTransfer to Third Party",
      "chunk_type": "requirement",
      "cross_references": [
        "table_9.3"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.7.1",
      "section_id": "9.7.1",
      "section_title": "Location request for a mobile in idle-mode",
      "content": "When a request for location information is received at the serving node the LCS-layer shall order paging of the UE subscriber. In case of first unsuccessful paging, normal paging procedures should apply. After successful paging the LCS-layer shall invoke the location preparation procedure.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.7.2",
      "section_id": "9.7.2",
      "section_title": "Location request for a mobile in dedicated-mode",
      "content": "When a request for location information is received at the serving node, if the UE is already busy on CM level, the LCS-layer shall attempt to establish a parallel transaction to the existing one. If successful, the LCS-layer shall invoke the location preparation procedure.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.8.1",
      "section_id": "9.8.1",
      "section_title": "Standard Location Request using a SIP-URI",
      "content": "An external LCS Client shall use the same interface to the LCS Server regardless of the target UE's identity.\nIf a location request from an external LCS client uses a SIP-URI as the target UE's identity, the requesting GMLC shall invoke a LIMS-IWF (Location IMS Interworking Function) to route the request to the user's home network. This routing mechanism may use standard technologies like pre-configuration of destination addresses or DNS lookups to determine the address of a LIMS-IWF in the home network of the user. The interface between two LIMS-IWF in different networks shall be Lr.\nIf the LIMS-IWF in the home network is not co-located with the home GMLC, it shall use the same interface towards the home GMLC as the requesting GMLC, i.e. the Lr interface. The LIMS-IWF in the home network has to determine the HSS serving the user. This may be done e.g. by a Dh SLF query or the HSS address is known to the LIMS-IWF through configuration. The LIMS-IWF retrieves the MSISDN from the HSS through Sh Pull and use MAP Send Routing Info for LCS to get the home GMLC IP address from the HLR/HSS. Afterwards the LIMS-IWF in the home network can forward the LCS service request (including the target UE's MSISDN) on the Lr interface to the home GMLC.\nThe following figure shows the principle call flow when a GMLC receives a location request where the target UE's identity is an IMS Public User Identity (SIP-URI).\nFigure 9.9: MT-LR procedure for IMS Public User Identities\n1.\tAn external LCS Client requests the current location of a target UE from a R-GMLC using the Public User Identity (SIP-URI) associated with the target UE.\n2.\tThe R-GMLC selects a LIMS-IWF in the requesting network. The LIMS-IWF address may be pre-configured or DNS is used for this purpose. The R-GMLC forwards the LCS service request to the requested LIMS-IWF via Lr interface.\n3.\tThe LIMS-IWF in the requesting network determines the LISM-IWF address in the home network. This may be done by using a pre-configured address or by DNS. The requesting LIMS-IWF forwards the LCS service request to the home LIMS-IWF via Lr interface.\n4.\tThe home LIMS-IWF queries the SLF via Dh interface to get the HSS address (using the Dh interface to retrieve the HSS address is an option).\n5.\tThe home LIMS-IWF retrieves the HSS address from the SLF via Dh SLF Response.\n6.\tThe home LIMS-IWF queries the HSS via Sh PULL (including the SIP-URI) to get the user's MSISDN.\n7.\tThe home LIMS-IWF retrieves the user's MSISDN from the HSS via Sh PULL Response.\n8.\tThe LIMS-IWF uses MAP Send Routing Info for LCS to get the H-GMLC address from the HLR/HSS.\n9.\tThe LIMS-IWF retrieves the H-GMLC address from the HLR/HSS.\n10.\tThe LCS service request is forwarded to the H-GMLC through Lr interface.\n11.\tThe H-GMLC performs the privacy check.\n12.\tThe H-GMLC queries the HLR/HSS using MAP Send Routing Info for LCS to get the V-GMLC address.\n13.\tThe H-GMLC retrieves the V-GMLC address from the HLR/HSS.\n14.\tThe H-GMLC forwards the LCS service request to the V-GMLC.\n15.\tThe standard MT-LR procedure is performed.\n16.\tThe LCS service response is send from the V-GMLC to the H-GMLC.\n17.\tThe H-GMLC performs the privacy check.\n18.\tThe LCS service response is send from the H-GMLC to home LIMS-IWF.\n19.\tThe LCS service response is send from the home LIMS-IWF to the requesting LIMS-IWF.\n20.\tThe LCS service response is send from the requesting LIMS-IWF to the R-GMLC.\n21.\tThe LCS service response is send from the R-GMLC to the external LCS Client.",
      "chunk_type": "requirement",
      "cross_references": [
        "figure_9.9"
      ]
    },
    {
      "chunk_id": "ts_23.271_9.8.2",
      "section_id": "9.8.2",
      "section_title": "Standard Location Request using a TEL-URL",
      "content": "IF a location request from an external LCS client uses a TEL-URL as the target UE's identity, the requesting GMLC shall convert the TEL-URL into a MSISDN, use this MSISDN in the location request as the target UE's address and continue with the MT-LR procedure for the PS domain.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.8.3",
      "section_id": "9.8.3",
      "section_title": "Mobile Originated Location Requests in the IMS",
      "content": "Mobile Originated Location Requests will not specifically require IMS interworking and therefore are not covered within this specification.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_9.8.4",
      "section_id": "9.8.4",
      "section_title": "IMS Emergency Location Procedure",
      "content": "A common procedure to support location and PSAP/Emergency Centre selection for any type of access network is shown in TS 23.167 [36a] \"Retrieving Location information for Emergency Session\". The procedure may be used dependent on the access type and the requirements of the applicable regulatory authority.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_23.167"
      ]
    },
    {
      "chunk_id": "ts_23.271_10",
      "section_id": "10",
      "section_title": "Information storage",
      "content": "This clause describes information storage structures that are mandatory (M), conditional (C) or optional (O) for LCS, and the recovery and restoration procedures needed to maintain service if inconsistencies in databases occur and for lost or invalid database information. Information storage in RAN network elements is specified in UTRAN Stage 2 (TS 25.305 [1]) and GERAN Stage 2 (TS 43.059 [16]) specifications.",
      "chunk_type": "general",
      "cross_references": [
        "ts_25.305",
        "ts_43.059"
      ]
    },
    {
      "chunk_id": "ts_23.271_10.1",
      "section_id": "10.1",
      "section_title": "HLR and HSS",
      "content": "The HLR/HSS holds LCS data for both UE subscribers and LMUs. If the privacy profile data for UE subscribers are stored in H-GMLC/PPR, HLR/HSS needs to store the corresponding pseudo-external identities and MO-LR related subscription data shown in Table 10.4 and 10.5. The pseudo-external identities are stored in the privacy exception list shown in Table 10.2. The details of the pseudo-external identity are described in Annex C.",
      "chunk_type": "general",
      "cross_references": [
        "table_10.4",
        "table_10.2"
      ]
    },
    {
      "chunk_id": "ts_23.271_10.1.1",
      "section_id": "10.1.1",
      "section_title": "LCS Data in the HLR/HSS for an UE Subscriber",
      "content": "The IMSI is the primary key for LCS UE subscription data in the HLR/HSS. This subscription data may be stored in a Multiple Subscriber Profile (MSP), with the HLR/HSS able to hold a number of MSPs per IMSI.\nFor GSM and UMTS, the LCS UE subscription data includes a privacy exception list containing the privacy classes for which location of the target UE is permitted. Each privacy class is treated as a distinct supplementary service with its own supplementary service code. The following logical states are applicable to each privacy class (refer to TS 23.011 [22] for an explanation of the notation).\nTable 10.1: Logical States for each LCS Privacy Class\nProvisioning State\nRegistration State\nActivation State\nHLR Induction State\n(Not Provisioned,\nNot Applicable,\nNot Active,\nNot Induced)\n(Provisioned,\nNot Applicable,\nActive and Operative,\nNot Induced)\nFor each LCS privacy class, the HLR/HSS shall store the logical state of the class on a per-subscriber (or per subscriber MSP) basis. In addition, the permanent data indicated below shall be stored on a per subscriber (or per subscriber MSP) basis when the logical provisioning state of the associated LCS privacy class is \"provisioned\". For the meaning of each LCS privacy class, refer to clause 9 and to TS 22.071 [4].Moreover a list of allowed service types may be stored. The meaning of service types is defined in TS 22.071 [4].\nTable 10.2: LCS data stored in the HLR privacy exception list for an UE Subscriber(or UE Subscriber MSP)\nLCS Privacy Class\nStatus\nAdditional HLR Data when Class is provisioned\nUniversal Class\n-\nNo additional data\nCall/session Related Class\nM\nO\nC\nO\nC\nIndication of one of the following mutually exclusive options for any LCS client not in the external LCS client list:\n-\tLocation not allowed\n-\tLocation allowed without notification (default case)\n-\tLocation allowed with notification\n-\tLocation with notification and privacy verification; location allowed if no response\n-\tLocation with notification and privacy verification; location restricted if no response\nExternal LCS client list: a list of zero or more LCS clients, with the following data stored for each LCS client in the list:\n-\tInternational E.164 address identifying a single LCS client or a single group of LCS clients that are permitted to locate this target UE\n-\tRestriction on the GMLC. If no value is stored for this data, there is no restriction on GMLC and any GMLC is allowed to request location information for the UE. Possible values are:\n-\tIdentified GMLCs only\n-\tAny GMLC in the home country\n-\tIndication of one of the following mutually exclusive options:\n-\tLocation allowed without notification (default case)\n-\tLocation allowed with notification\n-\tLocation with notification and privacy verification; location allowed if no response\n-\tLocation with notification and privacy verification; location restricted if no response\nCall/session Unrelated Class\nM\nO\nC\nO\nC\nIndication of one of the following mutually exclusive options for any LCS client not in the external LCS client list:\n-\tLocation not allowed (default case)\n-\tLocation allowed with notification\n-\tLocation with notification and privacy verification; location allowed if no response\n-\tLocation with notification and privacy verification; location restricted if no response\nExternal LCS client list: a list of zero or more LCS clients, with the following data stored for each LCS client in the list:\n-\tInternational E.164 address identifying a single LCS client or a single group of LCS clients that are permitted to locate this target UE\n-\tRestriction on the GMLC. If no value is stored for this data there is no restriction on GMLC and any GMLC is allowed to request location information for the UE. Possible values are:\n-\tIdentified GMLCs only\n-\tAny GMLC in the home country\n-\tIndication of one of the following mutually exclusive options:\n-\tLocation allowed without notification (default case)\n-\tLocation allowed with notification\n-\tLocation with notification and privacy verification; location allowed if no response\n-\tLocation with notification and privacy verification; location restricted if no response\nPLMN Operator Class\nO\nLCS client list: a list of one or more generic classes of LCS client that are allowed to locate the particular UE. The following classes are distinguished:\n-\tLCS client broadcasting location related information\n-\tO&M LCS client in the HPLMN\n-\tO&M LCS client in the VPLMN\n-\tLCS client recording anonymous location information\n-\tLCS Client supporting a bearer service, teleservice or supplementary service to the target UE\nTable 10.3: LCS Service types stored in the HLR/HSS per UE subscriber\nService type indication\nStatus\nAdditional HLR data when the indication is stored\nService Types\nO\nO\nC\nService types list: a list of one or more service types for which the LCS client is allowed to locate the particular UE. The possible service types are defined in TS 22.071 [4]. The following data may be present for each service type in the list:\n-\tRestriction on the GMLC. If no value is stored for this data, there is no restriction on GMLC and any GMLC is allowed to request location information for the UE. Possible values are:\n-\tIdentified GMLCs only\n-\tAny GMLC in the home country\n-\tIndication of one of the following mutually exclusive options:\n-\tLocation allowed without notification (default case)\n-\tLocation allowed with notification\n-\tLocation with notification and privacy verification; location allowed if no response\n-\tLocation with notification and privacy verification; location restricted if no response\nIn case that UE's privacy profile is stored and is checked in the GMLC (H-GMLC) or in the PPR, pseudo-external identities may be set in the external LCS client list of the HLR privacy exception list shown in Table 10.2. The pseudo-external identity is not the identity of real external LCS client but the identity which is used for notifying SGSN/MSC of the location request class (call/session related or non-call/session related) and the required type of indication for each class. Operator allocates E.164 addresses for the pseudo-external identities.\nFourteen pseudo-external identities are needed to be defined. The pseudo-external identities are summarized in the Table C.1. The pseudo-external identities are registered in SLPP of each UE in advance.\nLCS UE subscription data may include a mobile originating list containing the LCS mobile originating classes that an UE is permitted to request. Each LCS mobile originating class is treated as a distinct supplementary service with its own supplementary service code. The following logical states are applicable to each mobile originating class (refer to TS 23.011 [22] for an explanation of the notation).\nTable 10.4: Logical States for each Mobile Originating LCS Class\nProvisioning State\nRegistration State\nActivation State\nHLR Induction State\n(Not Provisioned,\nNot Applicable,\nNot Active,\nNot Induced)\n(Provisioned,\nNot Applicable,\nActive and Operative,\nNot Induced)\nFor each LCS Mobile Originating class, the HLR/HSS shall store the logical state of the class on a per-subscriber (or per subscriber MSP) basis. In this version of LCS, there is no additional permanent data in the HLR. The table below shows the defined mobile originating classes. For the meaning of each LCS mobile originating class, refer to clause 8 and to TS 22.071 [4].\nTable 10.5: Data stored in the HLR for the LCS Mobile Originating List for an UE(or UE Subscriber MSP)\nLCS Mobile Originating Class\nStatus\nAdditional HLR Data when Class is provisioned\nBasic Self Location\n-\nNo additional data\nAutonomous Self Location\n-\nNo additional data\nTransfer to Third Party\n-\nNo additional data\nIn addition to the privacy exception list, the following other data items may be stored in the UE subscription profile in the HLR to support LCS.\nTable 10.6a: Temporary LCS data in the HLR\nOther Data in the HLR\nStatus\nDescription\nGMLC List\nO\nList of one or more E.164 addresses of the GMLCs from which a location request for an MT-LR is allowed, The addresses are only relevant to an LCS client that is restricted (in the UE privacy exception list) to making call/session related or call/session unrelated location requests.\nTo support broadcast of assistance data for E-UTRAN access where assistance data is ciphered, the following data items may be stored in the HSS for a UE subscriber.\nTable 10.6b: Data stored in the HSS to support broadcast of ciphered assistance data for E-UTRAN access\nData in the HSS\nStatus\nDescription\nList of Assistance Data Types\nO\nA list of one or more types of location assistance data for which ciphering keys should be provided to the UE if requested by the UE when the assistance data is broadcast using ciphering.",
      "chunk_type": "general",
      "cross_references": [
        "ts_22.071_clause_9",
        "ts_22.071_clause_8",
        "table_10.1",
        "ts_22.071_table_10.2",
        "table_10.3",
        "table_10.2",
        "table_10.4",
        "ts_22.071_table_10.5",
        "table_10.6",
        "ts_23.011",
        "ts_22.071"
      ]
    },
    {
      "chunk_id": "ts_23.271_10.2",
      "section_id": "10.2",
      "section_title": "VLR/SGSN",
      "content": "The VLR/SGSN contains the same LCS permanent data for each registered UE subscriber, as does the HLR/HSS. This data is downloaded to the VLR/SGSN as part of the location update procedure between the VLR/SGSN and HLR/HSS for an UE subscriber.\n10.2a\tMME\nThe MME contains the same LCS permanent data for each registered UE subscriber, as does the HSS. This data is downloaded to the MME as part of the Attach and Tracking Area Update procedures between the MME and HSS for a UE subscriber.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_10.3.1",
      "section_id": "10.3.1",
      "section_title": "LCS Data in the GMLC for a LCS Client",
      "content": "The GMLC holds data for a set of external LCS clients that may make call related or non-call related MT-LR requests to this GMLC. The permanent data administered for each LCS client is as follows.\nTable10.7: GMLC Permanent Data for a LCS Client\nLCS Client data in GMLC\nStatus\nDescription\nLCS Client Type\nM\nIdentifies the type LCS client from among the following:\n-\tEmergency Services\n-\tValue Added Services\n-\tPLMN Operator Services\n-\tLawful Intercept Services\nExternal identity\nO\nA list of one or more identifiers used to identify an external LCS client. The identity may be used when making an MT-LR and/or MO-LR. The format of the identity is an international E.164 address [35a]. Each external identity shall be associated with a logical client name.\nAuthentication data\nM\nData employed to authenticate the identity of an LCS client – details are outside the scope of the present document\nCall/session related identity\nO\nA list of one or more international E.164 addresses [35a], which are used to make calls by mobile subscribers, or APN-NIs (see NOTE) to identify the client for a call related MT-LR\nIn case the LCS client was reached via IN or abbreviated number routing (e.g. toll free number or emergency call routing), the E.164 number(s) stored in the GMLC shall be the number(s) that the UE has to dial to reach the LCS Client. In these cases the E.164 number is not to be in international format. The country in which the national specific number(s) is (are) applicable is (are) also stored (or implied) in this case.\nEach call related identity may be associated with a specific external identity. Each call/session-related identity shall be associated with a logical client name.\nInternal identity\nO\nIdentifies the type PLMN operator services and the following classes are distinguished:\n-\tLCS client broadcasting location related information\n-\tO&M LCS client in the HPLMN\n-\tO&M LCS client in the VPLMN\n-\tLCS client recording anonymous location information\n-\tLCS Client supporting a bearer service, teleservice or supplementary service to the target UE\nThis identity is applicable only to PLMN Operator Services.\nClient name\nO\nAn address string which is associated with LCS client's external identity (i.e., E.164 address). See note 2.\nClient name type\nO\nIndication what is the type of the LCS client name. The type of the LCS client name can be one of the following:\n-\tLogical name\n-\tMSISDN\n-\tE-mail address (RFC 2396 [33])\n-\tURL (RFC 2396 [33])\n-\tSIP URL (RFC 3261 [34])\n-\tIMS public identity (TS 23.228 [35])\nOverride capability\nO\nIndication of whether the LCS client possesses the override capability (not applicable to a value added and PLMN operator service)\nAuthorized UE List\nO\nA list of MSISDNs or groups of MSISDN for which the LCS client may issue a non-call related MT-LR. Separate lists of MSISDNs and groups of MSISDN may be associated with each distinct external or non-call related client identity.\nPriority\nM\nThe priority of the LCS client – to be treated as either the default priority when priority is not negotiated between the LCS server and client or the highest allowed priority when priority is negotiated\nQoS parameters\nM\nThe default QoS requirements for the LCS client, comprising:\n-\tAccuracy\n-\tResponse time\n-\tLCS QoS Class\nSeparate default QoS parameters may be maintained for each distinct LCS client identity (external, non-call related, call related)\nService Coverage\nO\nA list of E.164 country codes for geographic areas [35a] where the LCS client offers its location services.\nAllowed LCS Request Types\nM\nIndicates which of the following are allowed:\n-\tNon-call related CS-MT-LR/PS-MT-LR/EPC-MT-LR\n-\tCall/session related CS-MT-LR/PS-MT-LR/EPC-MT-LR\n-\tSpecification or negotiation of priority\n-\tSpecification or negotiation of QoS parameters\n-\tSpecification or negotiation of Service Coverage parameter\n-\tRequest of current location\n-\tRequest of current or last known location\nLocal Co-ordinate System\nO\nDefinition of the co-ordinate system(s) in which a location estimate shall be provided – details are outside the scope of the present document\nAccess Barring List(s)\nO\nList(s) of MSISDNs or groups of MSISDN for which a location request is barred\nService Identities\nO\nList of service identities allowed for the LCS client.\nMaximum Target UE Number\nO\nThe maximum number of the Target UEs in one LCS request. For a specific LCS Client, this parameter may have different values for different service identities.\nNOTE 1:\tThe LCS Client is identified with E.164 number or APN-NI. APN-NI is specified in TS 23.003 [17].\nNOTE 2:\tThe LCS Client name should not contain two equal signs, because those characters are used to separate LCS client name from Requestor ID when GMLC includes them into the same field.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.228",
        "ts_23.003"
      ]
    },
    {
      "chunk_id": "ts_23.271_10.3.2",
      "section_id": "10.3.2",
      "section_title": "LCS Data in the GMLC/PPR for a UE Subscriber",
      "content": "The GMLC (H-GMLC) or PPR may store LCS UE subscription data. This clause describes Rel-5 based privacy profile data stored in GMLC/PPR. If the home network operator uses Rel-5 compatible privacy profile data, the profiles shown in this clause may be stored in GMLC/PPR. If the home network operator supports Rel‑6 or later compatible privacy profile data, the profiles stored in the GMLC/PPR may be related to different geographic areas, i.e. subscribers may have different privacy profiles depending on subscribers' locations.\nThe IMSI or MSISDN is the primary key for LCS UE subscription data in the GMLC/PPR. This subscription data may be stored in a Multiple Subscriber Profile (MSP), with the GMLC/PPR able to hold a number of MSPs per IMSI.\nLCS UE subscription data includes a privacy exception list containing the privacy classes for which location of the target UE is permitted. Each privacy class is treated as a distinct supplementary service with its own supplementary service code. The following logical states are applicable to each privacy class (refer to TS 23.011 [22] for an explanation of the notation).\nTable 10.9: Logical States for each LCS Privacy Class\nProvisioning State\nRegistration State\nActivation State\nHLR Induction State\n(Not Provisioned,\nNot Applicable,\nNot Active,\nNot Induced)\n(Provisioned,\nNot Applicable,\nActive and Operative,\nNot Induced)\nFor each LCS privacy class, the GMLC/PPR shall store the logical state of the class on a per-subscriber (or per subscriber MSP) basis. In addition, the permanent data indicated in Table 10.10 may be stored on a per subscriber (or per subscriber MSP) basis when the logical provisioning state of the associated LCS privacy class is \"provisioned\". For the meaning of each LCS privacy class, refer to clause 9 and to TS 22.071 [4].Moreover a list of allowed service types may be stored. The meaning of service types is defined in TS 22.071 [4]. The numbers assigned to service types are defined in Annex G.\nTable 10.10: LCS data stored in the GMLC/PPR privacy exception list for an UE Subscriber(or UE Subscriber MSP)\nService Types\nO\nService types list: a list of one or more service types for which the LCS client is allowed to locate the particular UE. The possible service types are defined in TS 22.071 [4] and the assigned numbers are shown in Annex G. The following data may be present for each service type in the list:\nO\n-\tRestriction on the GMLC. If no value is stored for this data, there is no restriction on GMLC and any GMLC is allowed to request location information for the UE. Possible values are:\n-\tIdentified GMLCs only\n-\tAny GMLC in the home country\nC\n-\tIndication of one of the following mutually exclusive options:\n-\tLocation allowed without notification (default case)\n-\tLocation allowed with notification\n-\tLocation with notification and privacy verification; location allowed if no response\n-\tLocation with notification and privacy verification; location restricted if no response\nTable 10.11: LCS Service types stored in the GMLC per UE subscriber\nService type indication\nStatus\nAdditional HLR data when the indication is stored\nService Types\nO\nIndication of one of the following mutually exclusive options for any service type not in the service type list:\n-\tLocation not allowed (default case)\n-\tLocation allowed with notification\n-\tLocation with notification and privacy verification; location allowed if no response\n-\tLocation with notification and privacy verification; location restricted if no response\nService types list: a list of one or more service types for which the LCS client is allowed to locate the particular UE. The possible service types are defined in TS 22.071 [4] and the assigned numbers are shown in Annex G.\n-\tRestriction on the GMLC. If no value is stored for this data, there is no restriction on GMLC and any GMLC is allowed to request location information for the UE. Possible values are:\n-\tIdentified GMLCs only\n-\tAny GMLC in the home country\n-\tIndication of one of the following mutually exclusive options:\n-\tLocation allowed without notification (default case)\n-\tLocation allowed with notification\n-\tLocation with notification and privacy verification; location allowed if no response\nLocation with notification and privacy verification; location restricted if no response\nIn case that UE's privacy profile is stored and is checked in the GMLC (H-GMLC) or in the PPR, the GMLC/PPR shall store the same pseudo-external identity table with HLR, which is shown in Annex C.\nGMLC (H-GMLC) or PPR may store codeword handling information and a list of codewords given by the UE subscriber in order not to get the location request rejected.\nTable 10.12a: Codeword handling information stored in the GMLC\nOther Data in the GMLC\nStatus\nDescription\nCodeword handling information\nO\nIndication of one of the following mutually exclusive options for codeword:\n-\tcodeword shall be checked in network.\n-\tcodeword shall be sent to UE\nTable 10.12b: LCS data stored in the GMLC for a UE Subscriber\nLCS Privacy profile\nStatus\nAdditional GMLC data when profile is provisioned\nCodeword\nO\nA list of codeword.\nThe GMLC (H-GMLC) or the PPR may store additional privacy information in order protect UE users privacy. The details of the additional privacy check are defined by each network operator and are outside the scope of this specification.",
      "chunk_type": "general",
      "cross_references": [
        "ts_22.071_clause_9",
        "table_10.9",
        "table_10.10",
        "table_10.11",
        "table_10.12",
        "ts_23.011",
        "ts_22.071"
      ]
    },
    {
      "chunk_id": "ts_23.271_10.4",
      "section_id": "10.4",
      "section_title": "Recovery and Restoration Procedures",
      "content": "The LCS recovery and restoration procedures allow temporary data to be recovered or reinitialized following loss or corruption of data, such that normal LCS service is rapidly restored and inconsistency between the data held by different LCS network elements is removed. For a full description, refer to TS 23.007 [23].",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_23.007"
      ]
    },
    {
      "chunk_id": "ts_23.271_10.5",
      "section_id": "10.5",
      "section_title": "Interworking between network nodes in different releases",
      "content": "This clause describes possible scenarios for interworking between network nodes in different releases. It is noted that LCS is only supported in A-mode and Iu-mode in the CS domain in Rel-99. LCS is supported in A-mode and Iu-mode in UTRAN CS and PS domains, but not in Gb-mode, in Rel-4. LCS is supported in A/Gb mode and Iu mode in CS and PS domains for UTRAN and GERAN in Rel-5, Rel-6, Rel-7 and Rel-8. LCS is supported in A/Gb mode and Iu mode in CS and PS domains for UTRAN and GERAN and in the PS domain for E‑UTRAN in Rel-9 onwards.\nThe concept of LCS capability set is introduced in Rel-4, so it does not appear in the specifications for R98 and R99 LCS.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_10.5.1",
      "section_id": "10.5.1",
      "section_title": "LCS capability set",
      "content": "The following LCS capabilities are identified in the current version of this specification. The HLR/HSS is notified the LCS capability of the serving node by an indication, which indicates all the LCS the serving node supports, from the serving node during location update procedure.\n-\tLCS capability set 1:\tR98 and R99 LCS (pre-Rel'4 LCS)\n-\tLCS capability set 2:\tRel'4 LCS\n-\tLCS capability set 3:\tRel'5 LCS\n-\tLCS capability set 4:\tRel'6 LCS\n-\tLCS capability set 5:\tRel'7 or later LCS\nNOTE 1:\tthe concept of LCS capability set is introduced in Rel4 so that R98 and R99 serving nodes do not notify HLR/HSS this parameter. Therefore, even if this parameter is absent the serving node may support at most LCS capability set 1.\nNOTE 2:\tFor E-UTRAN access, LCS capability sets 1 through 4 are not applicable. An MME that does not signal an LCS capability to the HSS shall be assumed to provide no LCS support.\nThe serving node, which notified the HLR/HSS that it supports LCS capability set 2, shall be able to handle the extended LCS Client list and LCS Client List for call-related class from the HLR/HSS.\nThe serving node, which notified the HLR/HSS that it supports LCS capability set 3, shall support the following capabilities:\n-\tcapability to perform the service type privacy check.\n-\tcapability to send the codeword to target UE for notification/verification.\n-\tcapability to send the requestor ID to target UE for notification/verification.\nThe serving node, which notified the HLR/HSS that it supports LCS capability set 4, shall support the following capability:\n-\tcapability to perform the privacy related action (i.e. checking the on-going call/session and/or notification/verification procedures) which is requested by H-GMLC.\nThe serving node, which notified the HLR/HSS that it supports LCS capability set 5, shall support the following capability:\n-\tcapability to perform the privacy related action (i.e. checking the on-going call/session and/or notification/verification procedures) for notification based on current location which is requested by H-GMLC.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_10.5.2",
      "section_id": "10.5.2",
      "section_title": "Interworking between pre Rel-4 serving node and Rel-4 or later HLR/HSS",
      "content": "The serving node that supports only pre-Rel'4 LCS cannot handle the extended privacy control for call-related/call-unrelated class of the Rel'4 and later LCS. That is, the serving node cannot provide the extended call-related/call-unrelated class service to the user who subscribes to the Rel'4 LCS. Therefore HLR does not send the LCS subscriber data on call-related/call-unrelated class for users who subscribe to the call-related class of Rel'4 LCS to the serving node that supports only pre-Rel'4 LCS.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_10.5.3",
      "section_id": "10.5.3",
      "section_title": "Interworking between pre Rel-5 serving node and Rel-5 or later HLR/HSS",
      "content": "If the HLR/HSS is notified that the LCS capability set 3 is not supported by the serving node, it may decide not to send the LCS subscriber data to the serving node, in order to protect user privacy.\nIn addition, if the HLR/HSS is notified that the serving node does not support the LCS capability set 2, the procedures described in 10.5.2 also shall be applied.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_10.5.4",
      "section_id": "10.5.4",
      "section_title": "Interworking between pre Rel-6 network nodes and Rel-6 or later HLR/HSS",
      "content": "In addition to the procedures in this clause, if the HLR/HSS is notified that the serving node does not support the LCS capability set 2 and/or set 3, the procedures described in 10.5.3 shall be also taken into consideration.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_10.5.4.1",
      "section_id": "10.5.4.1",
      "section_title": "Rel-6 or later HLR/HSS with pre Rel-6 serving node",
      "content": "The Rel-6 or later HLR/HSS notifies the H-GMLC about the all LCS capability set supported by the serving node.\nIn accordance with the notified LCS capability of the serving node and the privacy profile of the target UE, the H-GMLC decides whether the location estimation process can be continued or not.\nIn order to request the privacy related action (i.e. checking the on-going call/session and/or notification/verification procedures) to the pre Rel-6 serving node, H-GMLC may send the Provide Subscriber Location request message to the serving node with the pseudo-external identity. The detail of the pseudo-external identity is described in Annex C.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_10.6",
      "section_id": "10.6",
      "section_title": "LIMS-IWF",
      "content": "As the LIMS-IWF is a simple interworking function that provides routing of LCS service requests and responses based on the target UE's SIP-URI and mapping of SIP-URI to MSISDN it must not store user or LCS Client specific data during or after a location request procedure.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_11.1",
      "section_id": "11.1",
      "section_title": "Charging",
      "content": "Charging Information collected by the PLMN serving the LCS Client.\nThe following charging information shall be collected by the PLMN serving the LCS Client:\n-\ttype and identity of the LCS Client;\n-\tidentity of the target UE;\n-\tresults (e.g. success/failure, method used if known, response time, accuracy) - to be repeated for each instance of positioning for a deferred location request;\n-\tidentity of the visited PLMN;\n-\tLCS request type (i.e. LDR or LIR);\n-\trequested Quality of Service information;\n-\tstate;\n-\ttype of event (applicable to LDR requests only);\n-\ttime stamp;\n-\ttype of co-ordinate system used.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.271_11.2",
      "section_id": "11.2",
      "section_title": "Charging Information Collected by the Visited PLMN",
      "content": "The following charging information shall be collected by the visited PLMN:\n-\tdate and time;\n-\ttype and identity of the LCS Client (if known);\n-\tidentity of the target UE;\n-\tlocation of the target UE (e.g., MSC, MSC Server, SGSN, MME, tracking area ID, location area ID, cell ID, location co-ordinates);\n-\twhich location services were requested;\n-\trequested Quality of Service information;\n-\tresults (e.g. success/failure, positioning method used, response time, accuracy) - to be repeated for each instance of positioning for a batch location request;\n-\tidentity of the GMLC or PLMN serving the LCS Client;\n-\tstate;\n-\ttype of event (applicable to LDR requests only).\nAnnex A (normative):Privacy Class selection rule in serving node\nA.1\tInterrelation among privacy settings\nThere are five privacy settings and the interrelation among each privacy setting in terms of privacy strictness is shown as follows:\nTable A.1: Privacy settings\nloose\nPositioning allowed without notifying the UE user\n↑\nPositioning allowed with notification to the UE user\nPositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user or if there is no response to the notification\n↓\nPositioning requires notification and verification by the UE user; positioning is allowed only if granted by the UE user\nstrict\nPositioning not allowed\nA.2\tPrivacy class selection rule for pre Rel-6 mechanism\nIn pre Rel-6 network, the users privacy profile (SLPP) is stored HLR/HSS and is downloaded to the serving MSC/SGSN. If more than one privacy class are subscribed or in case Service Types and at least one privacy class are subscribed, privacy class for an MT-LR is selected by the serving MSC/SGSN according to the flow diagram shown in Fig. A-1.\nAn MT-LR may be applied to more than one privacy class or to Service Types and one or more privacy classes. In this case, looser privacy setting shall be selected. The privacy settings to be compared are the results of the privacy checks for each applicable class and Service Type.\nNote 1:\tThe client type indicates PLMN Operator service, and the client is within or associated with the VPLMN.\nNote 2:\tThe client type indicates value added service; the UE originated call/session to the requesting LCS client is established and the address associated to the LCS client used by the UE in call/session set up matches with that contained in the location request.\nNote 3:\tThe client type indicates value added service.\nNote 4:\tThe looser privacy setting shall be selected.\nFigure A.1: Privacy Class selection flow diagram\nIf the user subscribes Service Types, once that the privacy class has been selected according to figure A.1, the resulting privacy setting shall be compared with the result of Service Type privacy checking, and the looser condition shall be applied to the MT-LR, provided that the LCS client was authorized by the UE user to get location information.\nA.3\tPrivacy related action selection rule for Rel-6 and later\nIn Rel-6 and later, the privacy checking function is moved from MSC/SGSN to H-GMLC/PPR of the target UE. This is also applied to EPS location request, i.e. privacy checking is done at H-GMLC/PPR of the target UE. H-GMLC/PPR selects one or two indicators of privacy check related action and sends the indicators to serving MSC/SGSN/MME as shown in the clause 9.5.4. If the user subscribes Service Types, the resulting privacy setting shall be compared with the result of Service Type privacy checking, and the looser condition shall be selected. The Service Type check result may be included in any of the two privacy indicators, provided that the MT-LR is allowed for the relative privacy class.\nIf the serving MSC/SGSN/MME receives the indicators from H-GMLC, the serving node selects the privacy related action according to the flow diagram shown in Fig. A-2.\nFigure A.2: Privacy related action selection flow diagram of the serving node\nNOTE 1:\tThe UE originated call/session to the requesting LCS client is established and the address associated to the LCS client used by the UE in call/session set up matches with that contained in the location request.\nNOTE 2:\tA prior change makes this check unnecessary; since the call unrelated indicator is mandatory therefore the result is always \"YES\".\nAnnex B (normative):Presence of LCS client ID Components in MT-LR\nThe LCS client identity is composed of one or more than one of the following components: LCS client type, external identity, internal identity, call/session related identity, APN-NI, client name and Requestor Identity. For Value added LCS client type it may contain also Client name and Requestor ID type indicator. The LCS client type shall always be present and for each LCS client type the presence of the other components are defined as follows:\nComponent\nLCS Client type\nExternal identity\nInternal identity\nCall/session related identity\nClient name\nRequestor Identity\nEmergency\nO\nN.A.\nN.A.\nN.A.\nN.A.\nValue added\nM\nN.A.\nO [Note]\nM\nO\nPLMN operator\nN.A.\nM\nN.A.\nN.A.\nN.A.\nLawful Intercept\nN.A.\nN.A.\nN.A.\nN.A.\nN.A.\nNOTE:\tThis component shall be present if the MT-LR is associated to either CS call or PS session. If the MT-LR is associated with the CS call, the number dialled by UE is used. Otherwise if the MT-LR is associated with the PS session, the APN-NI is used.\nAnnex C (Informative):Pseudo external ID\nIn case that UE's privacy profile is stored and is checked in the GMLC (H-GMLC) or in the PPR, a pseudo-external identity may be selected as a result of the privacy check in GMLC/PPR.\nThe pseudo-external identities may be set in the external LCS client list of the HLR privacy exception list shown in Table 10.2. The pseudo-external identity is not the identity of real external LCS client but the identity which is used for notifying SGSN/MSC of the location request class (call/session related or non-related) and the required type of indication for each class. Operator allocates E.164 addresses for the pseudo-external identities. The pseudo-external identities are used for interworking with pre Rel-6 serving nodes.\nFourteen pseudo-external identities shall be defined. The pseudo-external identities are summarized in the Table C.1.\nTable C.1: Pseudo-external identities\nPseudo-external identity\nPrivacy setting for Call/Session related class\nPrivacy setting for Call/Session unrelated class\nPseudo-external identity 1\nN.A.\nLocation allowed without notification\nPseudo-external identity 2\nN.A.\nLocation allowed with notification\nPseudo-external identity 3\nN.A.\nLocation with notification and privacy verification; location allowed if no response\nPseudo-external identity 4\nN.A.\nLocation with notification and privacy verification; location restricted if no response\nPseudo-external identity 5\nLocation with notification and privacy verification; location restricted if no response\nLocation not allowed\nPseudo-external identity 6\nIndicator 6\nLocation with notification and privacy verification; location\nLocation not allowed\nPseudo-external identity 7\nallowed if no response\nLocation with notification and privacy verification; location restricted if no response\nPseudo-external identity 8\nLocation allowed with notification\nLocation not allowed\nPseudo-external identity 9\nLocation with notification and privacy verification; location restricted if no response\nPseudo-external identity 10\nLocation with notification and privacy verification; location allowed if no response\nPseudo-external identity 11\nLocation allowed without notification\nLocation not allowed\nPseudo-external identity 12\nLocation with notification and privacy verification; location restricted if no response\nPseudo-external identity 13\nLocation with notification and privacy verification; location allowed if no response\nPseudo-external identity 14\nLocation allowed with notification\nNOTE:\tThere are five privacy settings shown in Annex A.1 for each class (call/session unrelated class and call/session related class), so there are twenty-five possible combinations of the privacy settings. However, as shown in Annex A.2, even if the call/session related class criteria is met, the privacy setting for call/session unrelated class is selected when the privacy setting for the call/session unrelated class is looser than the privacy setting for the call/session related class. Therefore the twenty-five combinations can be reduced to the above fourteen combinations.\nIf the UE subscribes to the universal or PLMN class, H-GMLC/PPR sends the pseudo external identity 1 to the serving nodes.\nUsage of the pseudo-external identities are as follows:\n-\tThe pseudo-external identities are registered in SLPP of the HLR/HSS.\n-\tThe SLPP is sent to the serving nodes, during the Insert Subscriber Data procedures.\n-\tAfter the privacy check in the H-GMLC/PPR, the H-GMLC/PPR selects an appropriate pseudo-external identity according to the required privacy related actions (i.e. checking the on-going call/session and/or notification/verification procedures) in the serving node.\n-\tH-GMLC sends Provide Subscriber Location message to the serving node, which includes the pseudo-external identity instead of the real external client identity. The real external client identity may be included in the additional information element and is sent to serving node. The pseudo-external identity is sent to the serving node directly from H-GMLC or via V-GMLC.\nTable C.2 and C.3 shows how the pseudo-external identities are set in the SLPP in HLR/HSS.\nTable C.2: Example of SLPP in HLR/HSS for Call/Session unrelated Class\nPseudo-external identity\nPrivacy Setting\nPseudo-external identity 1\nLocation allowed without notification\nPseudo-external identity 2\nLocation allowed with notification\nPseudo-external identity 3\nLocation with notification and privacy verification; location allowed if no response\nPseudo-external identity 4\nLocation with notification and privacy verification; location restricted if no response\nPseudo-external identity 5\nLocation not allowed\nPseudo-external identity 6\nLocation not allowed\nPseudo-external identity 7\nLocation with notification and privacy verification; location restricted if no response\nPseudo-external identity 8\nLocation not allowed\nPseudo-external identity 9\nLocation with notification and privacy verification; location restricted if no response\nPseudo-external identity 10\nLocation with notification and privacy verification; location allowed if no response\nPseudo-external identity 11\nLocation not allowed\nPseudo-external identity 12\nLocation with notification and privacy verification; location restricted if no response\nPseudo-external identity 13\nLocation with notification and privacy verification; location allowed if no response\nPseudo-external identity 14\nLocation allowed with notification\nTable C.3: Example of SLPP in HLR/HSS for Call/Session related Class\nPseudo-external identity\nPrivacy Setting\nPseudo-external identity 5\nLocation with notification and privacy verification; location restricted if no response\nPseudo-external identity 6\nLocation with notification and privacy verification; location allowed if no response\nPseudo-external identity 7\nLocation with notification and privacy verification; location allowed if no response\nPseudo-external identity 8\nLocation allowed with notification\nPseudo-external identity 9\nLocation allowed with notification\nPseudo-external identity 10\nLocation allowed with notification\nPseudo-external identity 11\nLocation allowed without notification\nPseudo-external identity 12\nLocation allowed without notification\nPseudo-external identity 13\nLocation allowed without notification\nPseudo-external identity 14\nLocation allowed without notification\nThe selection of pseudo-external identity is based on the result of the privacy check in the H-GMLC/PPR. Table C.4 shows the relation between privacy check result and the pseudo-external identities.\nTable C.4: Pseudo-external identity selection at H-GMLC/PPR\nPrivacy related actions as a result of privacy check\nPseudo-external identity\nLocation request is allowed without notification, regardless of on-going call/session.\nPseudo-external identity 1\nLocation request is allowed with notification, regardless of on-going call/session,\nPseudo-external identity 2\nLocation request is allowed with notification and privacy verification, regardless of on-going call/session. Location request is allowed even if there is no response from UE.\nPseudo-external identity 3\nLocation request is allowed with notification and privacy verification, regardless of on-going call/session. Location request is restricted if there is no response from UE.\nPseudo-external identity 4\nIf there is call/session with the client, location request is allowed with notification and privacy verification. Location request is restricted if there is no response from UE.\nIf there is no call/session with the client, location request is restricted.\nPseudo-external identity 5\nIf there is call/session with the client, location request is allowed with notification and privacy verification. Location request is allowed even if there is no response from UE.\nIf there is no call/session with the client, location request is restricted.\nPseudo-external identity 6\nIf there is call/session with the client, location request is allowed with notification and privacy verification. Location request is allowed even if there is no response from UE.\nIf there is no call/session with the client, location request is allowed with notification and privacy verification. Location request is restricted if no response.\nPseudo-external identity 7\nIf there is call/session with the client, location request is allowed with notification.\nIf there is no call/session with the client, location request is restricted.\nPseudo-external identity 8\nIf there is call/session with the client, location request is allowed with notification.\nIf there is no call/session with the client, location request is with notification and privacy verification. Location request is restricted if no response.\nPseudo-external identity 9\nIf there is call/session with the client, location request is allowed with notification.\nIf there is no call/session with the client, location request is allowed even if there is no response from UE.\nPseudo-external identity 10\nIf there is call/session with the client, location request is allowed without notification.\nIf there is no call/session with the client, location request is restricted.\nPseudo-external identity 11\nIf there is call/session with the client, location request is allowed without notification.\nIf there is no call/session with the client, location request is with notification and privacy verification. Location request is restricted if no response.\nPseudo-external identity 12\nIf there is call/session with the client, location request is allowed without notification.\nIf there is no call/session with the client, location request is allowed even if there is no response from UE.\nPseudo-external identity 13\nIf there is call/session with the client, location request is allowed without notification.\nIf there is no call/session with the client, location request is allowed with notification.\nPseudo-external identity 14\nAnnex D (normative):including Requestor identity to LCS client name\nIn case the MSC/SGSN or the UE is pre Rel-5 then there is no possibility to send the Requestor identity to the UE in a new separate parameter. To obtain this backward compatibility the GMLC can add the Requestor identity to LCS client name.\nIn order to offer best possible service for the end user the UE should be able to differentiate LCS client name and Requestor ID when they are included in to a same parameter. Also it is important that the LCS client name and the Requestor ID are separated with a consistent manner. Therefore there is a need to define a rule how the GMLC should separate LCS client name and Requestor identity. In the box below is described the practice how the LCS client name and Requestor identity should be separated.\nLCS clientName==RequestorIdentity\nLCS client name and Requestor identity are separated with two equal signs.\nNOTE:\tIt is possible that the Requestor identity does not fit into the LCS client name field. In that case as many characters as possible from the beginning is added to the LCS client name field.\nAnnex E (Informative):Handling of pseudonyms in location services\nThere is a requirement in place on anonymity for both the requestor and the target in the LCS Stage 1, TS 22.071, and there are or will be regulatory requirements to support anonymity in location services in some countries. It is seen as a basic service requirement that the user should be able to request anonymity at will.\nThere are various methods available for providing anonymity-support for LCS. One model has been described by the GSM Association in the LS in TD S2-021104 to 3GPP. In short, GSMA's model introduces the following logical architecture.\nFigure E.1: GSMA logical model to support anonymity\nIn this PUSH model the pseudonym of the target UE is always generated for certain LCS clients on behalf of the terminal's subscriber without a specific request.\nThe PUSH model describes the case when the target UE requests its own location using e.g. SMS or WAP. SMS and WAP functions currently have problems in supporting anonymity, because the SMS/WAP gateways forward the originating MSISDN to the receiver. This weakness may be resolved in practise e.g. such that the SMS or WAP Gateway requests pseudonyms from a common device (PMD), as shown in Figure E.1. In this process the gateway requests a pseudonym from PMD in signalling step 2 and in signalling step 3 the gateway uses the pseudonym in the service request that it sends to the LCS client. The gateway includes the requesting terminal's verinym, i.e. the MSISDN, in the service response it sends to the terminal in step 9. In this way the LCS client only knows the pseudonym of the terminal and not the verinym. This solution is not LCS specific, since the SMS/WAP gateway inserts pseudonyms in all SMS/WAP messages, which the gateway forwards to the receivers (LCS clients) defined by the operator in advance.\nThe Liberty Alliance Project has standardized methods that can be used to ensure the anonymity of the target UE in location services using pseudonyms as shown by the example in Figure E.2 below. The specifications of the Liberty Alliance project are publicly available at http://www.projectliberty.org/.\nFigure E.2: Logical model to support anonymity\nIn this PULL model the LCS client requests the pseudonym from the Gateway before accepting the service request from the terminal. The proxy/gateway is a so-called Liberty Enabled Client/Proxy, which also may support standard WAP proxy/gateway functions as described in the appropriate WAP Forum specifications.\n1.\tThe terminal (UE) sends a standard Wireless Transport Protocol (WTP) –request to the Proxy/Gateway.\n2.\tThe proxy/gateway converts the service request into an HTTP-request with a dynamic IP address. This HTTP-request does not contain the MSISDN of the terminal, so it is totally anonymous to the LCS-client.\n3.\tThe LCS-client needs to get an assertion, i.e. a pseudonym, before it can accept to provide location services to the terminal, so it sends a HTTP-response to the Proxy/Gateway, which includes a request for a pseudonym.\n4.\tThe proxy/gateway maps the LCS client's HTTP-response to the HTTP-request it sent in step 2 and thus the proxy/gateway also knows to which terminal the LCS client's HTTP-response is related. The proxy/gateway intercepts and interprets the HTTP-response and finds the pseudonym request. It forwards the pseudonym request to PMD and attaches the terminal's MSISDN to allow the PMD to provide a pseudonym related to this MSISDN. In case PMD needs to contact the target UE user for some reason, e.g. to ask for consent to deliver the pseudonym to this specific LCS-client, this interaction is fully supported in the Liberty Enabled Client/Proxy specification.\n5.\tThe proxy/gateway sends an HTTP-request containing the pseudonym to the LCS-client.\n6.\tThe LCS-client sends a location service request to GMLC using the pseudonym of the target terminal.\n7.\tThe PMD may include the MSISDN in the pseudonym by encrypting it in such a way that GMLC is able to determine the MSISDN itself and in such a case step 7 is not needed. In case GMLC cannot find out the verinym of the terminal itself, it requests from PMD the MSISDN that corresponds to the pseudonym it received from the LCS-client.\n8.\tGMLC provides location information to the LCS-client using the pseudonym of the target terminal.\n9.\tThe LCS-client sends an HTTP-response to the proxy/gateway containing the requested location specific service content.\n10.\tThe proxy/gateway maps the response to the outstanding request sent in step 1 and delivers the result to the correct terminal using MSISDN.\nNote that the mechanism described above is a generalized solution to the problem of transporting something from party 1 (PMD) to party 3 (GMLC) so that intermediate party 2 (LCS-client) cannot find out the real content transferred between party 1 and party 3 (verinym in this case). Also note that since the proxy/gateway does not push any pseudonym in step 2, it is not required to understand the destination application and what information it may need. Step 3 allows any application to request a pseudonym or any information it may need, thus making this a generalized solution, which may be used for many types of applications, not only LCS.\nIt is to be noted that the Liberty release 1.1 specification has been carefully studied by the EU article 29 committee and found to be in accordance with the current EU privacy requirements. It is stressed, however, that it is the responsibility of someone implementing or deploying a system in accordance with the Liberty Alliance specifications to comply with EU directives and requirements on privacy.\nFor roaming cases clause 9.1.1 in this specification describes the cases where the pseudonym contains the address(es) of the target UE's Home-GMLC so that the Requesting-GMLC can forward the location request to H-GMLC, which may determine the corresponding verinym itself or request the verinym from its associated PMD.\nAnnex F (Informative):Mechanism for performing Change of Area Event Detection\nNote: the classification (i.e. normative or informative) of this Annex is FFS.\nAs described in clause 9.1.9 that there may be alternative mechanisms to transfer the deferred MT-LR with Area Event request to the UE. This annex illustrates one mechanism. In this mechanism a Short Message Service (SMS) is used to transfer, to the UE/(U)SIM, the Area event detection request via an (U)SIM Application Toolkit application.\nF.1\t(U)SIM Application Toolkit (USAT) Based Solution\nIn this (U)SAT based solution, the area event detection mechanism relies on the proactive control of the UE by the (U)SIM using the (U)SAT commands controlled by a specific Change of Area Deferred Location application. Figure F.1 illustrates one possible method for downloading a change of area event application to the UE, but does not detail the operation of the application. The details of the application is outside the scope of this specification. Further information about the possible (U)SAT commands, can be found from TS 31.111 [37].\nThe following procedure (shown in Figure F.1) replaces Figure 9.6d in clause 9.1.9.\nFigure F.1: (U)SAT Application Download and Change of Area Event Detection Procedure\n1)\tThis step is the same as step 1 in clause 9.1.9.\n2)\tThis step is similar to step 2 in clause 9.1.9, except the LCS Service Request does not reach the V-GMLC. Also the H-GMLC may request a translation of geographic shape to network identities from a GMLC in the network serving the target UE.\n3)\tInformation about the event, the (U)SAT application, that shall trigger the sending of the Location Report shall be sent to the UE/(U)SIM. If privacy action (notification and/or verification) was requested as a result of the privacy check, the H-GMLC shall also include the required action to the UE/(U)SIM. If notification/verification is required, the request shall indicate the identity of the LCS client, the Requestor Identity (if available), and the reference number. The mechanism by which the trigger detection is performed via (U)SAT application may be operator dependent. However, the (U)SAT Application shall contain the following information: reference number, H-GMLC address, validity period of request, and the area definition (of the target area).\n4)\tIf privacy verification was requested, the UE/(U)SIM indicates to its user whether the location request will be allowed or not allowed in the absence of a response and waits for the user to grant or deny permission. If privacy verification was requested and the user grants permission, the USAT Application shall be installed and the UE/(U)SIM then returns an acknowledgement to the H-GMLC indicating permission is granted and (U)SAT application is successfully installed. If the UE user does not respond after a predetermined time period (and the request is not allowed in the absence of a response) or denies permission, the UE/(U)SIM shall infer a \"no response\" condition, the USAT Application is not installed, an appropriate error response is returned to the GMLC/LCS Client and the remaining steps are skipped. Otherwise the UE/(U)SIM notifies the UE user of the location request (if required by the privacy action) and shall install the (U)SAT application and acknowledge successful installation to the H-GMLC, including an indication of \"no response\" but request is allowed if necessary. If at any point the (U)SAT application fails to install, due to lack of support or otherwise, the UE/(U)SIM shall inform the H-GMLC using an appropriate error cause.\n5)\tThe H-GMLC returns a LCS Service Response via R-GMLC to the LCS Client to notify whether the request was successfully accepted/installed or not, without a location estimate. When the R-GMLC returns the LCS Service Response to the LCS Client, the LDR reference number assigned by the R-GMLC shall be included.\n6)\tThe UE/(U)SIM detects the desired change of area event.\n7)\tThe UE/(U)SIM reports the change of area event.\n8)\tThe H-GMLC may perform another privacy check as described in clause 9.1.1.\n9)\tThe H-GMLC then returns a LCS Service Response to the LCS Client via the R-GMLC, if applicable, as in clause 9.1.1. When the R-GMLC returns the LCS Service Response to the LCS Client, the LDR reference number that was sent to the LCS Client in step 5 shall be included. If the GMLC for some other reason decides to not wait any longer for the requested event to occur (e.g. timer expires), an LCS Service Response shall be returned with an appropriate error cause indicating termination of the deferred location request.\nH-GMLC may be the origination point of the SMS-DELIVER and the USAT Application messages.\nAnnex G (normative):Defined Service Types and numbering\nThe defined Service Types and assigned numbers shall be as defined in TS 29.002 [18], clause 17.7.8.\nAnnex H (informative):Change history\nChange history\nDate\nMeeting\nTDoc\nCR\nRev\nCat\nSubject/Comment\nNew version\n2012-09\n-\n-\n-\n-\n-\nUpdate to Rel-11 version (MCC)\n11.0.0\n2012-12\nSP-58\nSP-120711\n0395\n2\nA\nContinuation of LCS Session in EPS after S1 Connection Release\n11.1.0\n2012-12\nSP-58\nSP-120726\n0396\n3\nB\nAddition of UTDOA technology and SLm interface in LTE\n11.1.0\n2013-03\nSP-59\nSP-130079\n0399\n-\nA\nUse of non-dialable callback number at SR-VCC handover of emergency call.\n11.2.0\n2013-12\nSP-62\nSP-130535\n0400\n4\nB\nIntroduction of Diameter interface between SGSN and GMLC (Lgd)\n12.0.0\n2014-06\nSP-64\nSP-140255\n0403\n2\nA\nCorrection on location reporting in emergency 1xSRVCC\n12.1.0\n2015-09\nSP-69\nSP-150503\n0409\n1\nB\nSupport of retrieval of Location Information for support of IMS ES for WLAN interworking based on TR 23.771 phase 1 conclusion\n13.0.0\n2015-09\nSP-69\nSP-150501\n0410\n1\nB\nMT Location procedures when a UE is in Idle eDRX mode\n13.0.0\n2016-12\nSP-74\nSP-160825\n0417\n1\nF\nEPC-NI-LI procedure with release indication\n14.0.0\n2016-12\nSP-74\nSP-160822\n0418\n2\nB\nDeferred location for the UE availability event with EPC Access\n14.0.0\n2016-12\nSP-74\nSP-160822\n0419\n2\nB\nIndication of UE Access Type for NB-IoT\n14.0.0\n2016-12\nSP-74\nSP-160822\n0421\n-\nB\nSupport of Last Known Location for a UE in power saving mode\n14.0.0\n2016-12\nSP-74\nSP-160822\n0422\n2\nB\nAddition of Periodic and Triggered Location for EPC Access\n14.0.0\n2016-12\nSP-74\nSP-160822\n0423\n2\nB\nSupport of UE positioning measurements in Idle State\n14.0.0\n2017-03\nSP-75\nSP-170050\n0424\n2\nF\nLocation reporting using Control Plane CIOT EPS Optimisation\n14.1.0\n2017-03\nSP-75\nSP-170053\n0425\n1\nF\nLocation Continuity for Emergency Call Handover between E-UTRAN and WLAN\n14.1.0\n2017-06\nSP-76\nSP-170369\n0427\n-\nF\nSupport of UE positioning measurements in Idle State\n14.2.0\n2017-12\nSP-78\nSP-170911\n0429\n1\nA\nPositioning methods alignment\n14.3.0\n2018-03\nSP-79\nSP-180085\n0430\n1\nF\nRemoval of hanging Editor's Note on support for deferred location\n14.4.0\n2018-06\nSP-80\nSP-180496\n0432\n3\nB\nAddition of Broadcast of Assistance Data for E-UTRAN\n15.0.0\n2018-06\nSP-80\nSP-180475\n0433\n-\nF\nLCS in 5GC\n15.0.0\n2018-09\nSP-81\nSP-180729\n0434\n-\nF\nCleanup of Broadcast of Assistance Data for E-UTRAN\n15.1.0\n2019-12\nSP-86\nSP-191067\n0435\n-\nF\nCorrections to LCS Assistance Data Broadcast procedure\n15.2.0\n2020-07\nSP-88E\n-\n-\n-\n-\nUpdate to Rel-16 version (MCC)\n16.0.0\n2021-12\nSP-94E\nSP-211284\n0436\n3\nB\nLCS enhancement for IoT NTN in EPS\n17.0.0\n2024-03\nSP-103\nSP-240115\n0438\n3\nF\nSupport for UE location verification when location is provided by MME\n18.0.0",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_9.5.4",
        "clause_9.1.1",
        "clause_9.1.9",
        "ts_29.002_clause_17.7.8",
        "table_10.2",
        "figure_9.6",
        "ts_22.071",
        "ts_31.111",
        "ts_29.002",
        "ts_23.771"
      ]
    }
  ]
}
{
  "metadata": {
    "specification_id": "ts_29.582",
    "version": "18.0.0",
    "title": "3GPP TS 29.582",
    "file_path": "/content/drive/MyDrive/RAG_thesis/data/29_series/29582-i00/29582-i00.docx"
  },
  "export_info": {
    "export_date": "2025-07-26T08:47:54.590590",
    "total_chunks": 127
  },
  "chunks": [
    {
      "chunk_id": "ts_29.582_1",
      "section_id": "1",
      "section_title": "Scope",
      "content": "The present document specifies the protocols needed to support a Mission Critical Data (MCData) system interworking with a Land Mobile Radio (LMR) system based on the IWF-2 interface between an MCData server and an Interworking Function (IWF) as described in 3GPP TS 23.283 [80].",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.283"
      ]
    },
    {
      "chunk_id": "ts_29.582_2",
      "section_id": "2",
      "section_title": "References",
      "content": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non‑specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[4]\t3GPP TS 24.229: \"IP multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".\n[5]\t3GPP TS 23.379: \"Functional architecture and information flows to support mission critical communication services; Stage 2\".\n[6]\tIETF RFC 3841 (August 2004): \"Caller Preferences for the Session Initiation Protocol (SIP)\".\n[7]\tIETF RFC 4028 (April 2005): \"Session Timers in the Session Initiation Protocol (SIP)\".\n[9]\tIETF RFC 6050 (November 2010): \"A Session Initiation Protocol (SIP) Extension for the Identification of Services\".\n[16]\tIETF RFC 3711: \"The Secure Real-time Protocol (SRTP)\".\n[19]\tIETF RFC 6135 (February 2011): \"An Alternative Connection Model for the Message Session Relay Protocol (MSRP) \".\n[20]\tIETF RFC 5366 (October 2008): \"Conference Establishment Using Request-Contained Lists in the Session Initiation Protocol (SIP)\".\n[24]\tIETF RFC 3261 (June 2002): \"SIP: Session Initiation Protocol\".\n[26]\tIETF RFC 6665 (July 2012): \"SIP-Specific Event Notification\".\n[31]\t3GPP TS 24.481: \"Mission Critical Services (MCS) group management Protocol specification\".\n[33]\tIETF RFC 3428 (December 2002): \"Session Initiation Protocol (SIP) Extension for Instant Messaging\".\n[37]\tIETF RFC 3903 (October 2004): \"Session Initiation Protocol (SIP) Extension for Event State Publication\".\n[45]\t3GPP TS 24.483: \"Mission Critical Services (MCS) Management Object (MO)\".\n[46]\tIETF RFC 3986: \"Uniform Resource Identifier (URI): Generic Syntax\".\n[47]\tIETF RFC 4567 (July 2006): \"Key Management Extensions for Session Description Protocol (SDP) and Real Time Streaming Protocol (RTSP)\".\n[49]\t3GPP TS 24.482: \"Mission Critical Services (MCS) identity management Protocol specification.\n[50]\t3GPP TS 24.484: \"Mission Critical Services (MCS) configuration management Protocol specification\".\n[51]\tIETF RFC 3856 (August 2004): \"A Presence Event Package for the Session Initiation Protocol (SIP)\".\n[67]\tIETF RFC 4122 (July 2005): \"A Universally Unique IDentifier (UUID) URN Namespace\".\n[78]\t3GPP TS 33.180: \"Security of the mission critical service\".\n[80]\t3GPP TS 23.283: \"Mission Critical Communication Interworking with Land Mobile Radio Systems; Stage 2\".\n[81]\t3GPP TS 24.379: \"Mission Critical Push To Talk (MCPTT) call control; protocol specification;\".\n[82]\t3GPP TS 24.282: \" Mission Critical Data (MCData) signalling control; Protocol specification;\"\n[85]\t3GPP TS 24.582: \"Mission Critical Data (MCData) media plane control; Protocol specification\".\n[86]\tIETF RFC 1738 (December 1994): \"Uniform Resource Locators (URL)\".\n[87]\t3GPP TS 29.379: \"Mission Critical Push To Talk (MCPTT) call control interworking with LMR systems; Protocol specification\".\n[89]\tIETF RFC 4826 (May 2007): \"Extensible Markup Language (XML) Formats for Representing Resource Lists\".\n[90]\t3GPP TR 24.883: \"Mission Critical Systems Connection to LMR\".\n[91]\tIETF RFC 4975 (September 2007): \"The Message Session Relay Protocol (MSRP)\".\n[92]\tIETF RFC 6714 (August 2012): \"Connection Establishment for Media Anchoring (CEMA) for the Message Session Relay Protocol (MSRP)\".\n[93]\tIETF RFC 3840 (August 2004): \"Indicating User Agent Capabilities in the Session Initiation Protocol (SIP)\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905",
        "ts_24.229",
        "ts_23.379",
        "ts_24.481",
        "ts_24.483",
        "ts_24.482",
        "ts_24.484",
        "ts_33.180",
        "ts_23.283",
        "ts_24.379",
        "ts_24.282",
        "ts_24.582",
        "ts_29.379",
        "ts_24.883"
      ]
    },
    {
      "chunk_id": "ts_29.582_3.1",
      "section_id": "3.1",
      "section_title": "Terms",
      "content": "For the purposes of the present document, the terms given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.379 [5] apply:\nGroup call\nMCPTT call\nMission critical push to talk\nPrivate call\nSIP core\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 23.283 [28] apply:\nInterworking Function (IWF)\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 29.379 [26] apply:\nIWF performing the controlling role\nIWF performing the non-controlling\nIWF performing the participating role\nFor the purposes of the present document, the following terms and definitions given in 3GPP TS 33.180 [18] apply:\nGroup Master Key (GMK)\nGroup Master Key Identifier (GMK-ID)\nPrivate Call Key (PCK)\nPrivate Call Key Identifier (PCK-ID)\nSignalling Protection Key (SPK)\nSignalling Protection Key Identifier (SPK-ID)\nFor the purposes of the present document, the following terms and definitions given in IETF RFC 3711 [16] apply:\nSRTP master key (SRTP-MK)\nSRTP master key identifier (SRTP-MKI)\nSRTP master salt (SRTP-MS)",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905",
        "ts_23.379",
        "ts_23.283",
        "ts_29.379",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.582_3.2",
      "section_id": "3.2",
      "section_title": "Abbreviations",
      "content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\nGMK\tGroup Management Key\nGMK-ID\tGroup Master Key Identifier\nGMS\tGroup Management Server\nGUK-ID\tGroup User Key Identifier\nIP\tInternet Protocol\nMCData\tMission Critical Data\nPCK\tPrivate Call Key\nPCK-ID\tPrivate Call Key Identifier\nRFC\tRequest For Comment\nRTCP\tRTP Control Protocol\nRTP\tReal-time Transport Protocol\nSPK\tSignalling Protection Key\nSPK-ID\tSignalling Protection Key Identifier\nSRTCP\tSecure RTCP\nSRTP\tSecure RTP\nSRTP-MK\tSRTP master key\nSRTP-MKI\tSRTP master key identifier\nSRTP-MS\tSRTP master salt\nSSRC\tSynchronization SouRCe\nUE\tUser Equipment",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905"
      ]
    },
    {
      "chunk_id": "ts_29.582_4.1",
      "section_id": "4.1",
      "section_title": "MCData overview",
      "content": "The MCData service supports communication between a pair of users (i.e. one-to-one communication) and several users (i.e. group communication), where each user has the ability to share data using Short Data Service (SDS).\nThe present document provides the signalling control protocol enhancements to support the MCData architectural procedures for MCData SDS interworking between on‑network Mission Critical users and users homed in the IWF, as specified in 3GPP TS 23.283[80].\nThe present document makes use of the existing IMS procedures specified in 3GPP TS 24.229 [4].\nThe procedures in this document allow an on‑network MCData user to:\n-\tsend a standalone SDS using signalling control plane to a user homed in the IWF or to a group including at least one user homed in the IWF; and\n-\tsend a standalone SDS using media plane to a user homed in the IWF or to a group including at least one user homed in the IWF.\nThe procedures in this document allow a user homed in the IWF to:\n-\tsend a standalone SDS using signalling control plane to an on‑network MCData user or to a group of on‑network MCData users; and\n-\tsend a standalone SDS using media plane to an on‑network MCData user or to a group of on‑network MCData users.\nThe present document does not support the interworking of SDS sessions with users homed in the IWF.\nThe MCData procedures provided by the present document refer to:\n-\tthe media plane procedures defined in 3GPP TS 24.582 [85];\n-\tthe group management procedures defined in 3GPP TS 24.481 [31];\n-\tthe identity management procedures defined in 3GPP TS 24.482 [49]; and\n-\tthe security procedures defined in 3GPP TS 33.180 [78].\nThe following procedures are provided within this document:\n-\tcommon procedures are specified in clause 6;\n-\tprocedures for registration in the IM CN subsystem and service authorisation are specified in clause 7;\n-\tprocedures for affiliation are specified in clause 8;\n-\tprocedures for SDS are specified in clause 9;\n-\tprocedures for transmission and reception control are specified in clause 11;\n-\tprocedures for dispositions and notifications are specified in clause 12;\n-\tprocedures for communication release are specified in clause 13; and\n-\tprocedures for enhanced status are specified in clause 14.\nThe IWF acts on behalf of all users homed in the IWF. There are no client procedures specified in the present document and specific client handling within the LMR system is out of scope.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_6",
        "clause_7",
        "clause_8",
        "clause_9",
        "clause_11",
        "clause_12",
        "clause_13",
        "clause_14",
        "ts_23.283",
        "ts_24.229",
        "ts_24.582",
        "ts_24.481",
        "ts_24.482",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.582_4.2.1",
      "section_id": "4.2.1",
      "section_title": "Public Service identities",
      "content": "In order to support MCData interworking with LMR, the following URI and address assignments are assumed:\n1)\tthe IWF performing the participating role is configured to be reachable using a public service identity.\n2)\tthe IWF performing the controlling role is configured to be reachable using a public service identity.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_4.2.2",
      "section_id": "4.2.2",
      "section_title": "MCData session identity",
      "content": "There is no MSRP session used at the IWF to support the short data service (SDS).",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_4.2.3",
      "section_id": "4.2.3",
      "section_title": "MCData client ID",
      "content": "The MCData client ID is described in 3GPP TS 24.282 [82] clause 4.8.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.282_clause_4.8",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_4.3",
      "section_id": "4.3",
      "section_title": "Emergency alerts",
      "content": "Support for Emergency alerts in the MCData plane is described in clause 18.",
      "chunk_type": "general",
      "cross_references": [
        "clause_18"
      ]
    },
    {
      "chunk_id": "ts_29.582_4.4",
      "section_id": "4.4",
      "section_title": "MCData protocol",
      "content": "Clause 15 describes the TLV based message formats used in MCData communications.\nAnnex I of 3GPP TS 24.379 [81] describes the standard format of the messages and the encoding rules for each type of information element.",
      "chunk_type": "general",
      "cross_references": [
        "clause_15",
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.582_4.5",
      "section_id": "4.5",
      "section_title": "Protection of sensitive XML application data",
      "content": "In certain deployments, for example, in the case that the MCData operator uses the underlying SIP core infrastructure from the carrier operator, the MCData operator can prevent certain sensitive application data from being exposed to the SIP layer. The following data are classified as sensitive application data:\n-\tMCData ID;\n-\tMCData group ID;\n-\talert indicator;\n-\taccess token (containing the MCData ID); and\n-\tMCData client ID.\nThe above data is transported as XML content in SIP messages, in XML elements or XML attributes.\nNOTE:\tSIP layer protection terminates at the IWF.\nData is transported in attributes in the following circumstances in the procedures in the present document:\n-\tan MCData ID, an MCData Group ID, and an MCData client ID in an XML document published in SIP PUBLISH request for affiliation according to IETF RFC 3856 [51];\n-\tan MCData ID or an MCData Group ID in XML document notified in a SIP NOTIFY request for affiliation according to IETF RFC 3856 [51]; and\n-\tan MCData ID in application/resource-lists+xml document included in a SIP MESSAGE or SIP INVITE request for one-to-one SDS, according to IETF RFC 5366 [20];\n3GPP TS 33.180 [78] describes a method to provide confidentiality protection of sensitive application data in elements by using XML encryption (i.e. xmlenc) and in attributes by using an attribute confidentiality protection scheme described in 3GPP TS 24.282 [82] clause 6.6.2.3. Integrity protection can also be provided by using XML signatures (i.e. xmlsig).\nProtection of the data relies on a shared XML protection key (XPK) used to encrypt and sign data:\n-\tbetween MCData servers and an IWF, the XPK is a signalling protection key (SPK).\nThe SPK (XPK) and a key-id SPK-ID (XPK-ID) are directly provisioned in the MCData server and IWF.\nConfiguration in the MCData client, IWF and MCData server is used to determine whether one or both of confidentiality protection and integrity protection are required.\n3GPP TS 24.282 [82] clause 4.6 provides examples of confidentiality and integrity protection applied to application data.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.282_clause_6.6.2.3",
        "ts_24.282_clause_4.6",
        "ts_33.180",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_4.6",
      "section_id": "4.6",
      "section_title": "Protection of TLV signalling and media content",
      "content": "The protection of TLV signalling and media content is based on 3GPP MCData security solution as defined in 3GPP TS 33.180 [78].\nFor different security requirements of different information elements of a MCData message, the information elements of MCData messages are bifurcated in the following components:\n-\tMCData Data signalling payload: information elements necessary for identification and management of the MCData messages e.g. conversation identifiers, session identifiers, transaction identifiers, disposition requests, etc. This payload is confidentiality and integrity protected between the MCData server and the IWF.\n-\tMCData Data payload: the actual user payload for MCData user or application consumption. This payload is confidentiality and integrity protected between the MCData client and the IWF.\nAn SDS message can be sent over the signalling plane or the media plane. When an SDS message is sent using the signalling plane, the body included in the SIP MESSAGE request, which carries the MCData Data signalling payload, is protected separately between each pair of entities if protection is applied. On the other hand, the body included in the SIP MESSAGE request which carries the MCData data payload is protected between the MCData client and the IWF. The procedures for the protection of the SDS messages over the signalling plane are specified in clause 6.6. Protection of SDS messages over the media control plane is specified in 3GPP TS 24.582 [85].\nNOTE:\tThe method by which SDS messages are protected between the IWF and the user homed in the IWF is outside the scope of the present document.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.6",
        "ts_33.180",
        "ts_24.582"
      ]
    },
    {
      "chunk_id": "ts_29.582_4.7.1",
      "section_id": "4.7.1",
      "section_title": "General",
      "content": "An IWF can include a free text string in a SIP response to a SIP request. When the IWF includes a free text string in a response to a SIP MESSAGE or SIP INVITE request the free text string is included in a Warning header field as specified in IETF RFC 3261 [24]. The IWF includes the Warning code set to 399 (miscellaneous warning) and includes the host name set to the host name of the IWF.\nEXAMPLE: Warning: 399 example.domain.com \"200 user not authorised to transmit data\"",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_4.7.2",
      "section_id": "4.7.2",
      "section_title": "Warning texts",
      "content": "Warning texts specified in table 4.7.2-1 for interworking are used, in conjunction with existing warning texts as specified in 3GPP TS 24.282 [82].\nTable 4.7.2-1: Warning texts for interworking defined for the Warning header field\nCode\nExplanatory text\nDescription\n300\nLMR system does not support requested application\nAn application has been requested that is not supported in the LMR system.\n301\nLMR system does not support disposition notification for requested application\nA disposition notification has been requested for an application for which the LMR system does not support disposition notifications.",
      "chunk_type": "general",
      "cross_references": [
        "table_4.7.2-1",
        "ts_24.282_table_4.7.2-1",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_5.1",
      "section_id": "5.1",
      "section_title": "Introduction",
      "content": "This clause describes the functional roles for an IWF to support the MCData service.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_5.2.1",
      "section_id": "5.2.1",
      "section_title": "General",
      "content": "When referring to the procedures in the present document for the IWF acting as a participating MCData server for the user homed in the IWF, the term, \"IWF performing the participating role\" is used.\nWhen referring to the procedures in the present document for the IWF acting as a controlling MCData server for the user homed in the IWF, the term \"IWF performing the controlling role\" is used.\nAn IWF can perform the controlling role for short data service as defined in the present document.\nAn IWF can perform the participating role for short data service as defined in the present document.\nAn IWF in the participating role can serve an originating user homed in the IWF.\nAn IWF in the participating role can serve a terminating user homed in the IWF.\nTo be compliant with the procedures in the present document, an IWF shall:\n-\tsupport the MCData server procedures defined in 3GPP TS 23.283 [80];\n-\timplement the role of an AS performing 3rd party call control acting as a routing B2BUA as defined in 3GPP TS 24.229 [4];\n-\tgenerate SDP offer and SDP answer in accordance with 3GPP TS 24.229 [4] and 3GPP TS 24.282 [82] clause 9.2.3 and 3GPP TS 24.282 [82] clause 9.2.4 for short data service;\n-\tfor registration and service authorisation, implement the procedures specified in 3GPP TS 24.282 [82] clause 7.3;\n-\tfor affiliation, implement the procedures specified in clause 9.2.2;\n-\tfor short data service (SDS) functionality implement the MCData server procedures specified in:\na)\tclause 9.2; and\nb)\tclause 6 of 3GPP TS 24.582 [85];\n-\tfor transmission and reception control functionality implement the MCData server procedures specified in clause 11;\n-\tfor disposition notification functionality implement the MCData server procedures specified in clause 12.2; and\n-\tfor communication release functionality implement the MCData server procedures specified in clause 13.2.\nTo be compliant with the procedures for confidentiality protection of XML elements in the present document, the IWF shall implement the procedures specified in clause 6.5.2.\nTo be compliant with the procedures for integrity protection of XML MIME bodies in the present document, the IWF shall implement the procedures specified in clause 6.5.3.\n5.2.1A\tSIP failure case\nWhen initiating a SIP failure response to any received SIP request, depending on operator policy, the IWF may insert a SIP Response-Source header field in accordance with the procedures in clause 5.7.1.0 of 3GPP TS 24.229 [4], where the \"role\" header field parameter is set to \"pf-mcdata-server\" or \"cf-mcdata-server\" depending on the current role endorsed by the MCData server.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.229_clause_9.2.3",
        "ts_24.282_clause_9.2.4",
        "ts_24.282_clause_7.3",
        "clause_9.2.2",
        "clause_9.2",
        "ts_24.582_clause_6",
        "clause_11",
        "clause_12.2",
        "clause_13.2",
        "clause_6.5.2",
        "clause_6.5.3",
        "ts_24.229_clause_5.7.1.0",
        "ts_23.283",
        "ts_24.229",
        "ts_24.282",
        "ts_24.582"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.1",
      "section_id": "6.1",
      "section_title": "Introduction",
      "content": "This clause describes the IWF procedures for MCData.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_6.2.2.1",
      "section_id": "6.2.2.1",
      "section_title": "IWF generating an SDS Message",
      "content": "In order to generate an SDS message, the IWF performing the participating role:\n1)\tshall generate an SDS SIGNALLING PAYLOAD message as specified in clause 15.1.2;\n2)\tshall generate a DATA PAYLOAD message as specified in clause 15.1.4;\n3)\tshall include in the SIP request, the SDS SIGNALLING PAYLOAD message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in 3GPP TS 24.282 [82] clause E.1; and\n4)\tshall include in the SIP request, the DATA PAYLOAD message in an application/vnd.3gpp.mcdata-payload MIME body as specified in 3GPP TS 24.282 [82] clause E.2.\nWhen generating an SDS SIGNALLING PAYLOAD message as specified in clause 15.1.2, the IWF performing the participating role:\n1)\tshall set the Date and time IE to the current time as specified in 3GPP TS 24.282 [82] clause 15.2.8;\n2)\tif the SDS message starts a new conversation, shall set the Conversation ID IE to a newly generated Conversation ID value as specified in clause 15.2.9;\n3)\tif the SDS message continues an existing unfinished conversation, shall, if available, set the Conversation ID IE to the Conversation ID value of the existing conversation as specified in clause 15.2.9, or shall set the Conversation ID IE to the Conversation ID value \"UNKNOWN CONVERSATION\" as specified in clause 15.2.9;\n4)\tshall set the Message ID IE to a newly generated Message ID value as specified in clause 15.2.10;\n5)\tif the SDS message is in reply to a previously received SDS message shall include the InReplyTo message ID IE with the Message ID value:\ni)\tset to the Message ID value in the previously received SDS message;\nii)\tset to the Message ID value \"LMR MESSAGE ID\"as specified in clause 15.2.10, with the value of octet 16 of the LMR MESSAGE ID set to the value of octet 16 of the Message ID in the previously received SDS message; and\niii)\tset to the Message ID value \"UNKNOWN ORIGINATING MESSAGE ID\" as specified in clause 15.2.10;\n6)\tif the SDS message is for user consumption, shall not include an Application ID IE as specified in 3GPP TS 24.282 [82] clause 15.2.7 and shall not include an Extended application ID IE as specified in 3GPP TS 24.282 [82] clause 15.2.24;\n7)\tif the SDS message is intended for an application on the terminating MCData client, shall include:\na)\tan Application ID IE with a Application ID value representing the intended application as specified in 3GPP TS 24.282 [82] clause 15.2.7; or\nb)\tan Extended application ID IE with an Extended application ID value representing the intended application as specified in 3GPP TS 24.282 [82] clause 15.2.24;\nNOTE:\tThe value chosen for the Application ID value is decided by the mission critical organisation.\n8)\tif only a delivery disposition notification is required shall include a SDS disposition request type IE set to \"DELIVERY\" as specified in 3GPP TS 24.282 [82] clause 15.2.3;\n9)\tif only a read disposition notification is required shall include a SDS disposition request type IE set to \"READ\" as specified in 3GPP TS 24.282 [82] clause 15.2.3; and\n10)\tif both a delivery and read disposition notification is required shall include a SDS disposition request type IE set to \"DELIVERY AND READ\" as specified in 3GPP TS 24.282 [82] clause 15.2.3.\nWhen generating a DATA PAYLOAD message for SDS as specified in clause 15.1.4, the IWF performing the participating role:\n1)\tshall set the Number of payloads IE to the number of Payload IEs that need to be encoded, as specified in clause 15.2.12;\n2)\tif end-to-end security is required for a one-to-one communication, shall include the Security parameters and Payload IE with security parameters as described in 3GPP TS 33.180 [78]. Otherwise, if end-to-end security is not required for a one-to-one communication, shall include the Payload IE as specified in clause 15.1.4; and\n3)\tfor each Payload IE included:\na)\tif the payload is text, shall set the Payload content type as \"TEXT\" as specified in 3GPP TS 24.282 [82] clause 15.2.13;\nb)\tif the payload is binary data, shall set the Payload content type as \"BINARY\" as specified in 3GPP TS 24.282 [82] clause 15.2.13;\nc)\tif the payload is hyperlinks, shall set the Payload content type as \"HYPERLINKS\" as specified in 3GPP TS 24.282 [82] clause 15.2.13;\nd)\tif the payload is location, shall set the Payload content type as \"LOCATION\" as specified in 3GPP TS 24.282 [82] clause 15.2.13;\ne)\tif payload is enhanced status for a group, shall set the Payload content type as \"ENHANCED STATUS\" as specified in 3GPP TS 24.282 [82] clause 15.2.13;\nf)\tif payload is a native LMR message, shall set the Payload content type as \"LMR MESSAGE\" as specified in clause 15.2.13; and\ng)\tshall include the data to be sent in the Payload data.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_15.1.2",
        "clause_15.1.4",
        "ts_24.282_clause_15.2.8",
        "clause_15.2.9",
        "clause_15.2.10",
        "ts_24.282_clause_15.2.7",
        "ts_24.282_clause_15.2.24",
        "ts_24.282_clause_15.2.3",
        "clause_15.2.12",
        "ts_24.282_clause_15.2.13",
        "clause_15.2.13",
        "ts_24.282",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.2.3.1",
      "section_id": "6.2.3.1",
      "section_title": "Generating an SDS Notification",
      "content": "In order to generate an SDS notification, the IWF performing the participating role:\n1)\tshall generate an SDS NOTIFICATION message as specified in clause 15.1.5; and\n2)\tshall include in the SIP request, the SDS NOTIFICATION message in an application/vnd.3gpp.mcdata-signalling MIME body as specified in 3GPP TS 24.282 [82] clause E.1.\nWhen generating an SDS NOTIFICATION message as specified in clause 15.1.5, the IWF performing the participating role:\n1)\tif sending a delivered notification, shall set the SDS disposition notification type IE as \"DELIVERED\" as specified in 3GPP TS 24.282 [82] clause 15.2.5;\n2)\tif sending a read notification, shall set the SDS disposition notification type IE as \"READ\" as specified in clause 3GPP TS 24.282 [82] 15.2.5;\n3)\tif sending a delivered and read notification, shall set the SDS disposition notification type IE as \"DELIVERED AND READ\" as specified in 3GPP TS 24.282 [82] clause 15.2.5;\n4)\tif the SDS message could not be delivered, shall set the SDS disposition notification type IE as \"UNDELIVERED\" as specified in 3GPP TS 24.282 [82] clause 15.2.5;\n5)\tif SDS disposition notification was prevented by the LMR system, shall set the SDS disposition notification type IE as \"DISPOSITION PREVENTED BY SYSTEM\" as specified in 3GPP TS 24.282 [82] clause 15.2.5;\n6)\tshall set the Date and time IE to the current time to as specified in 3GPP TS 24.282 [82] clause 15.2.8;\n7)\tshall set the Conversation ID to the value of the Conversation ID that was received in the SDS message as specified in clause 15.2.9;\n8)\tshall set the Message ID to the value of the Message ID that was received in the SDS message as specified in clause 15.2.10;\n9)\tif the SDS message was destined for the user, shall not include an Application ID IE (as specified in 3GPP TS 24.282 [82] clause 15.2.7) and shall not include an Extended application ID IE (as specified in 3GPP TS 24.282 [82] clause 15.2.24); and\n10)\tif the SDS message was destined for an application, shall include:\na)\tan Application ID IE set to the value of the Application ID that was included in the SDS message as specified in 3GPP TS 24.282 [82] clause 15.2.3; or\nb)\tan Extended application ID IE set to the value of the Extended application ID that was included in the SDS message as specified in 3GPP TS 24.282 [82] clause 15.2.24.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_15.1.5",
        "ts_24.282_clause_15.2.5",
        "ts_24.282_clause_3",
        "ts_24.282_clause_15.2.8",
        "clause_15.2.9",
        "clause_15.2.10",
        "ts_24.282_clause_15.2.7",
        "ts_24.282_clause_15.2.24",
        "ts_24.282_clause_15.2.3",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.2.4.1",
      "section_id": "6.2.4.1",
      "section_title": "Generating a SIP MESSAGE request towards the controlling MCData function",
      "content": "This clause is referenced from other procedures.\nIn a SIP MESSAGE request, the IWF performing the participating role:\n1)\twhen sending SDS messages or SDS disposition notifications:\na)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [6];\nb)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [6]; and\nc)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [4]), in a P-Preferred-Service header field according to IETF RFC 6050 [9] in the SIP MESSAGE request;\n2)\tmay include a P-Preferred-Identity header field in the SIP MESSAGE request containing a public user identity as specified in 3GPP TS 24.229 [4]; and\n3)\tshall set the Request-URI to the public service identity of the controlling MCData function.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.3.0",
      "section_id": "6.3.0",
      "section_title": "Introduction",
      "content": "The IWF performs the MCData server role when exchanging SDS messages with MCData servers within the MC system. The IWF does not communicate directly with MCData clients. The IWF does not support the FD service. Clause 6.3 describes the IWF operating as a controlling and participating MCData server.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.3"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.3.1.1",
      "section_id": "6.3.1.1",
      "section_title": "SIP MESSAGE request",
      "content": "The IWF shall perform the role of an MCData server in distinguishing between the following SIP MESSAGE requests for originations and terminations from 3GPP TS 24.282 [82] clause 6.3.1.1 as described below:\n-\tSIP MESSAGE request routed to the IWF performing the terminating participating MCData role with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field. Such requests are known as \"SIP MESSAGE request for standalone SDS for terminating participating MCData function\";\n-\tSIP MESSAGE request routed to IWF performing the MCData server role with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field, and with an application/vnd.3gpp.mcdata-signalling MIME body containing an SDS NOTIFICATION message Such requests are known as \"SIP MESSAGE request for SDS disposition notification for MCData server\";\n-\tSIP MESSAGE request routed to the IWF performing the controlling MCData role with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field. Such requests are known as \"SIP MESSAGE request for standalone SDS for controlling MCData function\"; and\n-\tSIP MESSAGE requests routed to the IWF performing the terminating participating role as a result of initial filter criteria with the Request-URI set to the public service identity of the IWF performing the participating role and containing a Content-Type header field set to \"application/vnd.3gpp.mcdata-info+xml\" and includes an XML body containing a <mcdatainfo> root element with a <mcdata-Params> element containing an <anyExt> element with the <request-type> element set to a value of \"Interworking Security Data message\". Such requests are known as \"SIP MESSAGE request for Interworking Security Data message for participating function\".\nIf a SIP MESSAGE request is received at the IWF that is not in accordance with the SIP MESSAGE requests listed above, then the IWF shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.282_clause_6.3.1.1",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.3.1.2",
      "section_id": "6.3.1.2",
      "section_title": "SIP INVITE request",
      "content": "The IWF shall perform the role of an MCData server in distinguishing between the following SIP INVITE requests for originations and terminations from 3GPP TS 24.282 [82] clause 6.3.1.2 as described below:\n-\tSIP INVITE request routed to the IWF performing the terminating participating MCData role with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds\" or \"group-sds\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for standalone SDS over media plane for terminating participating MCData function\";\n-\tSIP INVITE request routed to the IWF performing the controlling MCData role with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds\" or \"group-sds\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for controlling MCData function for standalone SDS over media plane\";\n-\tSIP INVITE request routed to the IWF performing the terminating participating MCData role with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds-session\" or \"group-sds-session\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for SDS session for terminating participating MCData function\"; and\n-\tSIP INVITE request routed to the IWF performing the controlling MCData role with an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", and an ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in a P-Asserted-Service header field and a <request-type> element set to \"one-to-one-sds-session\" or \"group-sds-session\" contained in an application/vnd.3gpp.mcdata-info+xml MIME body. Such requests are known as \"SIP INVITE request for controlling MCData function for SDS session\".",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.282_clause_6.3.1.2",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.3.2.1",
      "section_id": "6.3.2.1",
      "section_title": "Generating a SIP MESSAGE request towards the terminating MCData client",
      "content": "This clause is referenced from other procedures. Refer to 3GPP TS 24.282 [82] clause 6.3.2.1.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.282_clause_6.3.2.1",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.3.3",
      "section_id": "6.3.3",
      "section_title": "Groups homed in the IWF",
      "content": "How information about groups homed in the IWF is stored and retrieved by the IWF is out of scope of the present document. The procedures to perform these actions are supported by the IWF but are not defined.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_6.3.5",
      "section_id": "6.3.5",
      "section_title": "Affiliation check",
      "content": "The IWF shall determine that the MCData user, with MCData ID, is affiliated to the MCData group, with MCData Group ID, at the MCData client, with MCData client ID, if the elements, as described in clause 8.3.3.2, exist with their expected values, as below:\n1)\tan MCData group information entry with MCData group ID same as the MCData group ID under consideration;\n2)\tin the MCData group information entry found in 1, an MCData user information entry with the MCData ID same as the MCData ID under consideration;\n3)\tin the MCData user information entry found in 2, an MCData client information entry with MCData Client ID same as the MCData client ID under consideration; and\n4)\tin the MCData user information entry found in 2, an expiration time, which has not expired.\nNOTE:\tHow the IWF determines which users homed in the IWF are affiliated to the MCData group is out of scope of the present document.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_8.3.3.2"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.4",
      "section_id": "6.4",
      "section_title": "Handling of MIME bodies in a SIP message",
      "content": "The IWF shall support MIME bodies in SIP requests and SIP responses according to 3GPP TS 24.282 [82] clause 6.4.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.282_clause_6.4",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.5.1.1",
      "section_id": "6.5.1.1",
      "section_title": "Applicability and exclusions",
      "content": "The procedures in clause 6.5 apply in general to all procedures described in clause 9, clause 12 and clause 13 with the exception that the confidentiality and integrity protection procedures for the registration and service authorisation procedures are described in clause 7.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.5",
        "clause_9",
        "clause_12",
        "clause_13",
        "clause_7"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.5.1.2",
      "section_id": "6.5.1.2",
      "section_title": "Performing XML content encryption",
      "content": "Whenever the IWF includes XML elements or attributes pertaining to the data specified in clause 4.6 in SIP requests or SIP responses, the IWF shall perform the procedures in clause 6.5.2.3.2, with the exception that when the IWF receives a SIP request with XML elements or attributes in an MIME body that need to be copied from the incoming SIP request to an outgoing SIP request without modification, the IWF shall perform the procedures specified in clause 6.5.2.5.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_4.6",
        "clause_6.5.2.3.2",
        "clause_6.5.2.5"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.5.1.3",
      "section_id": "6.5.1.3",
      "section_title": "Performing integrity protection on an XML body",
      "content": "The IWF shall perform the procedures in clause 6.5.3.3.2 just prior to sending a SIP request or SIP response.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.5.3.3.2"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.5.2.2",
      "section_id": "6.5.2.2",
      "section_title": "Keys used in confidentiality protection procedures",
      "content": "Confidentiality protection uses an XPK to encrypt the data which is an SPK as specified in clause 4.5. In the case of an IWF as a server sending or receiving to another server this key will be an SPK. An SPK-ID is used to key the SPK. It is assumed that before the procedures in this clause are called, the SPK/SPK-ID are available on the sender and recipient of the encrypted content as described in 3GPP TS 24.282 [82] clause 4.6.\nThe procedures in clause 6.5.2.3 and 3GPP TS 24.282 [82] clause 6.5.2.4 are used with an XPK equal to the SPK and a XPK-ID equal to the SPK-ID when the IWF sends confidentiality protected content to an MCData server.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_4.5",
        "ts_24.282_clause_4.6",
        "ts_24.282_clause_6.5.2.3",
        "ts_24.282_clause_6.5.2.4",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.5.2.3.2",
      "section_id": "6.5.2.3.2",
      "section_title": "IWF performing the role of an MCData server",
      "content": "If the IWF performing the role of an MCData server determines locally that it needs to confidentially protect content to an MCData server, then sending confidentially protected content between MCData servers is enabled.\nWhen sending confidentiality protected content, the IWF:\n1)\tshall use the appropriate keying information specified in clause 6.5.2.2;\n2)\tshall perform the procedures in 3GPP TS 24.282 [82] clause 6.5.2.3.3 to confidentiality protect XML elements containing the content described in clause 4.5; and\n3)\tshall perform the procedures in 3GPP TS 24.282 [82] clause 6.5.2.3.4 to confidentiality protect URIs in XML attributes for URIs described in clause 4.5.\nIf the IWF determines locally that it does not need to confidentiality protect content sent to an MCData server, then sending confidentiality protected content between MCData servers is disabled, and the content is included in XML elements and attributes without encryption.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.5.2.2",
        "ts_24.282_clause_6.5.2.3.3",
        "clause_4.5",
        "ts_24.282_clause_6.5.2.3.4",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.5.2.5",
      "section_id": "6.5.2.5",
      "section_title": "IWF copying received XML content",
      "content": "The following procedure is executed when an IWF receives a SIP request containing XML MIME bodies, where the content needs to be copied from the incoming SIP request to the outgoing SIP request.\nThe IWF:\n1)\tshall copy the XML elements from the XML MIME body of the incoming SIP request that do not contain a <EncryptedData> XML element, to the same XML body in the outgoing SIP request;\n2)\tfor each encrypted XML element in the XML MIME body of the incoming SIP request as determined by 3GPP TS 24.282 [82] clause 6.5.2.4.1:\na)\tshall use the keying information described in clause 6.5.2.2 to decrypt the content within the XML element by following the procedures specified in 3GPP TS 24.282 [82] clause 6.5.2.4.2, and shall continue with the steps below if the encrypted XML element was successfully decrypted;\nb)\tif confidentiality protection is enabled as specified in clause 6.5.2.3.2, then for each decrypted XML element:\ni)\tshall re-encrypt the content within the XML element using the keying information described in clause 6.5.2.2 and by following the procedures specified in 3GPP TS 24.282 [82] clause 6.5.2.3.3; and\nii)\tshall include the re-encrypted content into the same XML MIME body of the outgoing SIP request; and\nc)\tif confidentiality protection is disabled as specified in clause 6.5.2.3.2, shall include the decrypted content in the same XML MIME body of the outgoing SIP request; and\n3)\tfor each encrypted XML URI attribute in the XML MIME body of the incoming SIP request as determined by 3GPP TS 24.282 [82] clause 6.5.2.4.1:\na)\tshall use the keying information described in clause 6.5.2.2 to decrypt the URI value of the XML attribute by following the procedures specified in 3GPP TS 24.282 [82] clause 6.5.2.4.3, and shall continue with the steps below if the encrypted XML attribute value was successfully decrypted;\nb)\tif confidentiality protection is enabled as specified in clause 6.5.2.3.2, then for each decrypted XML element:\ni)\tshall re-encrypt the URI value of the XML attribute using the keying information described in clause 6.5.2.2 and by following the procedures specified in 3GPP TS 24.282 [82] clause 6.5.2.3.4; and\nii)\tshall include the re-encrypted attribute value into the same XML MIME body of the outgoing SIP request; and\nc)\tif confidentiality protection is disabled as specified in clause 6.5.2.3.2, shall include the decrypted value in the same XML MIME body of the outgoing SIP request.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.282_clause_6.5.2.4.1",
        "clause_6.5.2.2",
        "ts_24.282_clause_6.5.2.4.2",
        "clause_6.5.2.3.2",
        "ts_24.282_clause_6.5.2.3.3",
        "ts_24.282_clause_6.5.2.4.3",
        "ts_24.282_clause_6.5.2.3.4",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.5.3.2",
      "section_id": "6.5.3.2",
      "section_title": "Keys used in integrity protection procedures",
      "content": "Integrity protection uses an XPK to sign the data which is an SPK as specified in clause 4.5. In the case of an IWF as a server sending or receiving to another server this key will be an SPK. An SPK-ID is used to key the SPK. It is assumed that before the procedures in clause 6.5.3.3 and 3GPP TS 24.282 [82] clauses 6.5.3.3.1, 6.5.3.3.3 and 6.5.3.4 are called, the SPK/SPK-ID are available on the sender and recipient of the integrity protected content, as described in clause 4.5.\nThe procedure in clause 6.5.3.3 and 3GPP TS 24.282 [82] clause 6.5.3.4 shall be used with a XPK equal to the SPK and a XPK-ID equal to the SPK-ID when the IWF sends integrity protected content to an MCData server",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_4.5",
        "ts_24.282_clause_6.5.3.3",
        "ts_24.282_clause_6.5.3.4",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.5.3.3.2",
      "section_id": "6.5.3.3.2",
      "section_title": "Integrity protection at the IWF",
      "content": "The IWF determines locally whether sending integrity protected content from the IWF to an MCData server is enabled.\nWhen sending integrity protected content, the IWF shall use the appropriate keying information specified in clause 6.5.3.2 and shall perform the procedures in 3GPP TS 24.282 [82] clause 6.5.3.3.3 to integrity protect XML MIME bodies.\nNOTE:\tEach XML MIME body is integrity protected separately.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.5.3.2",
        "ts_24.282_clause_6.5.3.3.3",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.6.1",
      "section_id": "6.6.1",
      "section_title": "General",
      "content": "Signalling plane provides confidentiality and integrity protection for the MCData data signalling and MCData data messages sent over the signalling plane. Signalling plane security also provides the authentication of MCData data messages.\nThe signalling plane security is based on 3GPP MCData security solution including key management and end-to-end protection as defined in 3GPP TS 33.180 [78].\nVarious keys and associated key identifiers protect the MCData data signalling and MCData data messages carried on the signalling plane.\nThe MCData signalling messages sent and received by an IWF are on-network communications and do not include FD.\nThe MCData data signalling messages may be:\n1.\tSDS SIGNALLING PAYLOAD;\n2.\tSDS NOTIFICATION; or\n3.\tCOMMUNICATION RELEASE.\nThe MCData data messages may be:\n1.\tDATA PAYLOAD.\nIn an on-network MCData communication for an MCData group, if protection of MCData data messages is negotiated, the GMK and the GMK-ID of the MCData group protect the MCData data messages sent and received by the IWF acting on behalf of users homed in the IWF.\nIn an on-network one-to-one MCData communications, if protection of MCData data messages is negotiated, the PCK and the PCK-ID protect the MCData data messages sent and received by the IWF acting on behalf of MCData clients homed in the IWF. The IWF acts as termination point for protection of one-to-one MCData data messages that are sent and received by the IWF acting on behalf of MCData clients homed in the IWF.\nThe protection of MCData communications between the user homed in the IWF and the IWF acting on behalf of the user homed in the IWF is outside the scope of the present document.\nIf protection of MCData data signalling messages between the IWF and another MCData function acting in a participating or controlling role is configured, the SPK and the SPK-ID protect the MCData data signalling messages sent and received between the IWF and that MCData function.\nThe GMK and the GMK-ID are distributed to the IWF acting on behalf of users homed in the IWF using the group document subscription and notification procedure specified in 3GPP TS 24.481 [31].\nThe PCK and the PCK-ID are generated by the IWF initiating the standalone SDS using signalling control plane.\nThe SPK and the SPK-ID are configured in the IWF if it is acting as the participating MCData function or if it is acting as the controlling MCData function.\nThe key material for creating and verifying the authentication signature (SSK, PVT and KPAK) is provisioned to the MCData clients by the KMS as specified in 3GPP TS 33.180 [78].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_33.180",
        "ts_24.481"
      ]
    },
    {
      "chunk_id": "ts_29.582_6.6.2",
      "section_id": "6.6.2",
      "section_title": "Derivation of master keys for media and media control",
      "content": "On-network MCData services employing the media plane are not supported by the IWF.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_6.6.3.1",
      "section_id": "6.6.3.1",
      "section_title": "General",
      "content": "The MCData messages may be encrypted and integrity protected between the IWF and the MCData system. When encryption is applied the media shall be encrypted as specified in 3GPP TS 33.180 [78].\nBoth unprotected MCData messages and MCData messages that are encypted and/or integrity protected can also be end-to-end encrypted for interworking between an MCData client and the IWF.\nNOTE:\tLMR end to end encryption is independent of 3GPP encryption and is out of scope of the present document.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.582_7.1",
      "section_id": "7.1",
      "section_title": "Server procedures",
      "content": "How users homed in the IWF are registered and service authorized is out of scope of the present document.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_8.1",
      "section_id": "8.1",
      "section_title": "General",
      "content": "Clause 8.2 describes the procedures for explicit affiliation by a user homed in the IWF.\nClause 8.3 contains the IWF procedures for handling explicit affiliation by:\n-\tan MCData client to a group homed in the IWF; and\n-\tan IWF on behalf of a user homed in the IWF towards an MCData server owning an MCData group.\nClause 8.3 contains the IWF procedures for handling implicit affiliation by:\n-\tan MCData client to a group homed in the IWF; and\n-\tan IWF on behalf of a user homed in the IWF towards an MCData server owning an MCData group.\nThe procedures for implicit affiliation in this clause are triggered at the IWF performing the participating role in the following circumstances:\n-\twhen generating a SIP MESSAGE request on behalf of a user homed in the IWF to initiate an MCData emergency alert targeted to an MCData group and the user homed in the IWF is not already affiliated to that MCData group.\nThe procedures for implicit affiliation in this clause are triggered at the IWF performing the controlling role in the following circumstances:\n-\ton receipt of a SIP MESSAGE request from the participating MCData function when the MCData user initiates an MCData emergency alert targeted to an MCData group and the MCData client is not already affiliated to the MCData group.\nClause 8.4 describes the coding used for explicit affiliation.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_8.2",
        "clause_8.3",
        "clause_8.4"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.2",
      "section_id": "8.2",
      "section_title": "IWF performing the participating role procedures",
      "content": "The IWF acts on behalf of all users homed in the IWF. There are no client procedures specified in the present document and specific client handling within the LMR system is out of scope.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_8.3.1",
      "section_id": "8.3.1",
      "section_title": "General",
      "content": "The procedures performed by the IWF in the role of the MCData server consist of:\n-\tprocedures of the IWF performing the participating role; and\n-\tprocedures of the IWF performing the controlling role.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_8.3.2.1",
      "section_id": "8.3.2.1",
      "section_title": "General",
      "content": "The procedures of the IWF serving users homed in the IWF provide:\n-\tsending affiliation status change towards the MCData server owning an MCData group in clause 8.3.2.6;\n-\taffiliation status retrieval from the MCData server owning an MCData group in clause 8.3.2.7;\n-\tauthorizing affiliation status change request in negotiated mode sent to a user homed in the IWF in clause 8.3.2.8;\n-\taffiliation status determination in clause 8.3.2.11;\n-\taffiliation status change by implicit affiliation in clause 8.3.2.12;\n-\timplicit affiliation status change completion in clause 8.3.2.13;\n-\timplicit affiliation status change cancellation in clause 8.3.2.14; and\n-\tautomatic affiliation to configured groups in clause 8.3.2.15.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_8.3.2.6",
        "clause_8.3.2.7",
        "clause_8.3.2.8",
        "clause_8.3.2.11",
        "clause_8.3.2.12",
        "clause_8.3.2.13",
        "clause_8.3.2.14",
        "clause_8.3.2.15"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.2.2",
      "section_id": "8.3.2.2",
      "section_title": "Stored information",
      "content": "The IWF maintains information equivalent to that defined in 3GPP TS 24.282 [82] clause 8.3.2.2.\nNOTE:\tThe virtual data structure referenced in this clause is for information only. Implementors may choose other means to track affiliation status for users homed in the IWF. References to the elements of this virtual data structure are made in other clauses with the understanding that implementors choosing not to use this virtual data structure will take other appropriate actions.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.282_clause_8.3.2.2",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.2.3",
      "section_id": "8.3.2.3",
      "section_title": "Receiving affiliation status change from a user homed in the IWF procedure",
      "content": "Any notification of the IWF by users homed in the IWF of changes in their affiliation status is out of scope of 3GPP.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_8.3.2.4",
      "section_id": "8.3.2.4",
      "section_title": "Receiving subscription to affiliation status procedure",
      "content": "Any notification of users homed in the IWF of their affiliation status is out of scope of 3GPP.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_8.3.2.5",
      "section_id": "8.3.2.5",
      "section_title": "Sending notification of change of affiliation status procedure",
      "content": "Any notification of users homed in the IWF of their affiliation status is out of scope of 3GPP.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_8.3.2.6",
      "section_id": "8.3.2.6",
      "section_title": "Sending affiliation status change towards MCData server owning MCData group procedure",
      "content": "NOTE 1:\tUsage of one SIP PUBLISH request to carry information about change of affiliation state of several users homed in the IWF served by the same IWF is not supported in this version of the specification.\nIn order:\n-\tto send an affiliation request of a served MCData ID to a handled MCData group ID;\n-\tto send an de-affiliation request of a served MCData ID from a handled MCData group ID; or\n-\tto send an affiliation request of a served MCData ID to a handled MCData group ID due to near expiration of the previously published information;\nthe IWF performing the participating role shall generate a SIP PUBLISH request according to 3GPP TS 24.229 [4], IETF RFC 3903 [37] and IETF RFC 3856 [51]. In the SIP PUBLISH request, the IWF performing the participating role:\n1)\tshall set the Request-URI to the public service identity of the controlling MCData function associated with the handled MCData group ID;\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the MCData server:\na)\tshall include the <mcdata-request-uri> element set to the handled MCData group ID; and\nb)\tshall include the <mcdata-calling-user-id> element set to the served MCData ID;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [4]), in a P-Asserted-Service header field according to IETF RFC 6050 [9];\n4)\tif sending an affiliation request, shall set the Expires header field according to IETF RFC 3903 [37], to 4294967295;\nNOTE 2:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [24].\n5)\tif sending a de-affiliation request, shall set the Expires header field according to IETF RFC 3903 [37] to zero;\n6)\tshall include a P-Asserted-Identity header field set to the public service identity of the IWF performing the role of the MCData server according to 3GPP TS 24.229 [4];\n7)\tshall set the current p-id to a globally unique value;\n8)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nb)\tthe MCData ID of the MCData user information entry is equal to the served MCData ID;\nas the served MCData user information entry;\n9)\tfor each MCData group information entry such that:\na)\tthe MCData group information entry has the \"affiliating\" affiliation status, the MCData group ID set to the handled MCData group ID, the expiration time has not expired yet and the affiliating p-id is not set;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry; and\nc)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry;\nshall set the affiliating p-id of the MCData group information entry to the current p-id; and\n10)\tshall include an application/pidf+xml MIME body indicating per-group affiliation information constructed according to TS 24.282 [82] clause 8.4.1. The IWF performing the role of the MCData server shall indicate all served MCData client IDs, such that:\na)\tthe affiliation status is set to \"affiliating\" or \"affiliated\", and the expiration time has not expired yet in an MCData group information entry with the MCData group ID set to the handled MCData group;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry;\nc)\tthe MCData client information entry has the MCData client ID set to the served MCData client ID; and\nd)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry.\nThe IWF performing the participating role shall set the <p-id> child element of the <presence> root element to the current p-id.\nThe IWF performing the participating role shall not include the \"expires\" attribute in the <affiliation> element.\nThe IWF performing the participating role shall send the SIP PUBLISH request according to 3GPP TS 24.229 [4].\nIf timer F expires for the SIP PUBLISH request sent for a (de)affiliation request of served MCData ID to the MCData group ID or upon receiving a SIP 3xx, 4xx, 5xx or 6xx response to the SIP PUBLISH request, the IWF performing the participating role:\n1)\tshall remove each MCData group ID entry such that:\na)\tthe MCData group information entry has the MCData group ID set to the handled MCData group ID;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry; and\nc)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_8.3.2.2",
        "ts_24.282_clause_8.4.1",
        "ts_24.229",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.2.7",
      "section_id": "8.3.2.7",
      "section_title": "Affiliation status retrieval from IWF performing the role of the MCData server owning MCData group procedure",
      "content": "NOTE 1:\tUsage of one SIP SUBSCRIBE request to subscribe for notification about change of affiliation state of several MCData users served by the same IWF performing the role of the MCData server is not supported in this version of the specification.\nIn order to discover whether a served user homed in the IWF was successfully affiliated to a handled MCData group in the MCData server owning the handled MCData group, the IWF performing the role of the MCData server shall generate an initial SIP SUBSCRIBE request according to 3GPP TS 24.229 [4], IETF RFC 3856 [51], and IETF RFC 6665 [26].\nIn the SIP SUBSCRIBE request, the IWF performing the role of the MCData server:\n1)\tshall set the Request-URI to the public service identity of the controlling MCData function associated with the handled MCData group ID;\n2)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body. In the application/vnd.3gpp.mcdata-info+xml MIME body, the IWF performing the role of the MCData server:\na)\tshall include the <mcdata-request-uri> element set to the handled MCData group ID; and\nb)\tshall include the <mcdata-calling-user-id> element set to the served MCData ID;\n3)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [4]), in a P-Asserted-Service header field according to IETF RFC 6050 [9];\n4)\tif the IWF performing the role of the MCData server wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [26], to 4294967295;\nNOTE 2:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [24].\n5)\tif the IWF performing the role of the MCData server wants to fetch the current state only, shall set the Expires header field according to IETF RFC 6665 [26], to zero;\n6)\tshall include an Accept header field containing the application/pidf+xml MIME type; and\n7)\tshall include an application/simple-filter+xml MIME body indicating per-user restrictions of presence event package notification information according to 3GPP TS 24.282 [82] clause 8.4.2, indicating the served MCData ID.\nIn order to re-subscribe or de-subscribe, the IWF performing the role of MCData server shall generate an in-dialog SIP SUBSCRIBE request according to 3GPP TS 24.229 [4], IETF RFC 3856 [51], and IETF RFC 6665 [26]. In the SIP SUBSCRIBE request, the IWF performing the role of the MCData server:\n1)\tif the IWF performing the role of the MCData server wants to receive the current status and later notification, shall set the Expires header field according to IETF RFC 6665 [26], to 4294967295;\nNOTE 3:\t4294967295, which is equal to 232-1, is the highest value defined for Expires header field in IETF RFC 3261 [24].\n2)\tif the IWF performing the role of the MCData server wants to de-subscribe, shall set the Expires header field according to IETF RFC 6665 [26], to zero; and\n3)\tshall include an Accept header field containing the application/pidf+xml MIME type.\nUpon receiving a SIP NOTIFY request according to 3GPP TS 24.229 [4], IETF RFC 3856 [51], and IETF RFC 6665 [26], if SIP NOTIFY request contains an application/pidf+xml MIME body indicating per-group affiliation information constructed according to 3GPP TS24.282 [82], clause 8.4.1, then the IWF performing the role of the MCData server:\n1)\tfor each served MCData ID and served MCData client ID such that the application/pidf+xml MIME body of SIP NOTIFY request contains:\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the served MCData ID;\nc)\tan <affiliation> child element of the <status> element of the <tuple> element;\nd)\tthe \"client\" attribute of the <affiliation> element indicating the served MCData client ID; and\nd)\tthe \"expires\" attribute of the <affiliation> element indicating expiration of affiliation;\nperform the following:\na)\tif an MCData group information entry exists such that:\ni)\tthe MCData group information entry has the \"affiliating\" affiliation status, the MCData group ID set to the handled MCData group ID, and the expiration time has not expired yet;\nii)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry with the MCData client ID set to the served MCData client ID;\niii)\tthe MCData client information entry is in the list of the MCData client information entries of a served MCData user information entry with the MCData ID set to the served MCData ID; and\niv)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nshall set the affiliation status of the MCData group information entry to \"affiliated\"; and\nshall set the next publishing time of the MCData group information entry to the current time and half of the time between the current time and the expiration of affiliation; and\n2) for each MCData group information entry such that:\na)\tthe MCData group information entry has the \"affiliated\" affiliation status or the \"deaffiliating\" affiliation status, the MCData group ID set to the handled MCData group ID, and the expiration time has not expired yet;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry with the MCData client ID set to a served MCData client ID;\nc)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry with the MCData ID set to a served MCData ID; and\nd)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nfor which the application/pidf+xml MIME body of SIP NOTIFY request does not contain:\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the served MCData ID;\nc)\tan <affiliation> child element of the <status> child element of the <tuple> element; and\nd)\tthe \"client\" attribute of the <affiliation> element indicating the served MCData client ID.\nperform the following:\na)\tshall set the affiliation status of the MCData group information entry to \"deaffiliated\"; and\nb)\tshall set the expiration time of the MCData group information entry to the current time; and\n3)\tif a <p-id> element is included in the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request, then for each MCData group information entry such that:\na)\tthe MCData group information entry has the \"affiliating\" affiliation status, the MCData group ID set to the handled MCData group ID, the expiration time has not expired yet and with the affiliating p-id set to the value of the <p-id> element;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry with the MCData client ID set to a served MCData client ID;\nc)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry with the MCData ID set to a served MCData ID; and\nd)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2; and\nfor which the application/pidf+xml MIME body of SIP NOTIFY request does not contain:\na)\ta <tuple> element of the root <presence> element;\nb)\tthe \"id\" attribute of the <tuple> element indicating the served MCData ID;\nc)\tan <affiliation> child element of the <status> child element of the <tuple> element; and\nd)\tthe \"client\" attribute of the <affiliation> element indicating the served MCData client ID;\nperform the following:\na)\tshall set the affiliation status of the MCData group information entry to \"deaffiliated\"; and\nb)\tshall set the expiration time of the MCData group information entry to the current time.",
      "chunk_type": "procedure",
      "cross_references": [
        "ts_24.282_clause_8.4.2",
        "clause_8.4.1",
        "clause_8.3.2.2",
        "ts_24.229",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.2.8",
      "section_id": "8.3.2.8",
      "section_title": "Procedure for authorising affiliation status change request in negotiated mode sent to a user homed in the IWF",
      "content": "Authorising affiliation status change request in negotiated mode sent to a user homed in the IWF is not supported in the present document.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_8.3.2.9",
      "section_id": "8.3.2.9",
      "section_title": "Forwarding affiliation status change towards an MCData user procedure",
      "content": "The procedure for forwarding affiliation status change towards an MCData user is not supported in the present specification.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_8.3.2.10",
      "section_id": "8.3.2.10",
      "section_title": "Forwarding subscription to affiliation status towards an MCData user procedure",
      "content": "The procedure for forwarding a subscription to affiliation status towards an MCData user is not supported in the present specification.",
      "chunk_type": "procedure",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_8.3.2.11",
      "section_id": "8.3.2.11",
      "section_title": "Affiliation status determination",
      "content": "This clause is referenced from other procedures.\nIf the IWF performing the participating role needs to determine the affiliation status of an user homed in the IWF to an MCData group, the IWF performing the participating role:\n1)\tshall find the user information entry in the list of MCData user information entries described in clause 8.3.2.2 such that the MCData ID of the MCData user information entry is equal to the MCData ID associated with the user homed in the IWF;\na)\tif the applicable MCData user information entry cannot be found, then the IWF performing the participating role shall determine that the user homed in the IWF is not affiliated to the MCData group and skip the rest of the steps;\n2)\tshall find the MCData client information entry in the list of MCData client information entries of MCData user information entry found in step 1) in which the MCData client ID matches the MCData client ID associated with the user homed in the IWF;\na)\tif the applicable MCData client information entry cannot be found, then the IWF performing the participating role shall determine that the user homed in the IWF is not affiliated to the MCData group and skip the rest of the steps; and\n3)\tshall find the MCData group information entry in the list of MCData group information entries of MCData client information entry found in step 2 such that the MCData group identity matches the value of the identity of the targeted MCData group;\na)\tif the applicable MCData group information entry was found in step 3) and the affiliation status of the MCData group information entry is \"affiliating\" or \"affiliated\", shall determine that the user homed in the IWF is affiliated to the targeted MCData group and skip the rest of the steps;\nb)\tif the applicable MCData group information entry was found in step 3) and the affiliation status of the MCData group information entry is \"deaffiliating\" or \"deaffiliated\", shall determine that the user homed in the IWF is not affiliated to the targeted MCData group and skip the rest of the steps; or\nc)\tif the applicable MCData group information entry was not found in step 3), shall determine that the user homed in the IWF is not affiliated to the targeted MCData group.",
      "chunk_type": "general",
      "cross_references": [
        "clause_8.3.2.2"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.2.12",
      "section_id": "8.3.2.12",
      "section_title": "Affiliation status change by implicit affiliation",
      "content": "This clause is referenced from other procedures.\nUpon determining that implicit affiliation of a user homed in the IWF is required to an MCData group, the IWF performing the participating role:\n1)\tshall determine the MCData client ID of the user homed in the IWF;\n2)\tshall determine the MCData group ID to which the user homed in the IWF is to be affiliated;\n3)\tshall determine the MCData ID associated with the user homed in the IWF;\n4)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of MCData user information entries described in clause 8.3.2.2;\nb)\tthe MCData ID of the MCData user information entry is equal to the MCData ID determined in step 3;\nas the served MCData user information entry;\n5)\tshall consider an MCData client information entry such that:\na)\tthe MCData client information entry is in the list of MCData client information entries of the served MCData user information entry; and\nb)\tthe MCData client ID of the MCData client information entry is equal to the served MCData client ID;\nas the served MCData client information entry;\n6)\tshall consider a copy of the list of the MCData group information entries of the served MCData client information entry as the served list of the MCData group information entries;\n7)\tshall construct the candidate list of the MCData group information entries as follows:\na)\tfor each MCData group ID which has an MCData group information entry in the served list of the MCData group information entries shall copy the MCData group information entry into a new MCData group information entry of the candidate list of the MCData group information entries; and\nb)\tif the determined MCData group ID does not have an MCData group information entry in the served list of the MCData group information entries or has an MCData group information entry in the served list of the MCData group information entries, such that the expiration time of the MCData group information entry has already expired:\ni)\tshall add a new MCData group information entry in the candidate list of the MCData group information list for the determined MCData group ID;\nii)\tshall set the affiliation status of the new MCData group information entry to the \"affiliating\" state; and\niii)\tshall set the expiration time of the new MCData group information entry to the current time increased with the candidate expiration interval;\n8)\tdetermine the candidate number of MCData group IDs as the number of different MCData group IDs which have an MCData group information entry:\na)\tin the candidate list of the MCData group information entries; or\nb)\tin the list of the MCData group information entries of an MCData client information entry such that:\ni)\tthe MCData client information entry is in the list of the MCData client information entries of the served MCData user information entry; and\nii)\tthe MCData client ID of the MCData client information entry is not equal to the served MCData client ID;\nwith the affiliation status set to the \"affiliating\" state or the \"affiliated\" state and with the expiration time which has not expired yet; and\n9)\tif the candidate number of MCData group IDs is bigger than a maximum limit associated by the IWF to the user homed in the IWF, shall, based on MCData service provider policy, reduce the candidate MCData group IDs to that maximum value;\n10)\tif the determined MCData group ID cannot be added to the the candidate list of the MCData group information entries due to exceeding the maximum limit associated with the user homed in the IWF, shall discard the candidate list of the MCData group information entries and skip the remaining steps of the current procedure; and\n11)\tshall replace the list of the MCData group information entries stored in the served MCData client information entry with the candidate list of the MCData group information entries.",
      "chunk_type": "general",
      "cross_references": [
        "clause_8.3.2.2"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.2.13",
      "section_id": "8.3.2.13",
      "section_title": "Implicit affiliation status change completion",
      "content": "This clause is referenced from other procedures.\nIf the IWF performing the participating role has received a SIP 2xx response from the controlling MCData function to a SIP request that had triggered performing the procedures of clause 8.3.2.12, the IWF performing the participating role:\n1)\tshall set the affiliation status of the MCData group information entry added to the candidate list of the MCData group information entries by the procedures of clause 8.3.2.12 to \"affiliated\".",
      "chunk_type": "general",
      "cross_references": [
        "clause_8.3.2.12"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.2.14",
      "section_id": "8.3.2.14",
      "section_title": "Implicit affiliation status change cancellation",
      "content": "This clause is referenced from other procedures.\nIf the IWF performing the participating role receives a SIP 4xx, 5xx or 6xx response from the controlling MCData function for an implicit affiliation status change operation, the IWF performing the participating role:\n1)\tshall remove the MCData group ID entry added by the procedures of clause 8.3.2.12 such that:\na)\tthe MCData group information entry has the MCData group ID set to the MCData group ID of the MCData group associated with the received SIP 4xx, 5xx, or 6xx response;\nb)\tthe MCData group information entry is in the list of the MCData group information entries of an MCData client information entry containing the MCData client ID determined in the execution of the procedure in clause 8.3.2.12; and\nc)\tthe MCData client information entry is in the list of the MCData client information entries of the MCData user information entry containing the MCData ID associated with the user homed in the IWF.",
      "chunk_type": "general",
      "cross_references": [
        "clause_8.3.2.12"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.2.15",
      "section_id": "8.3.2.15",
      "section_title": "Automatic affiliation to configured groups procedure",
      "content": "This clause is referenced from other procedures.\nWhen the IWF performing the participating role determines that automatic affiliation of a user homed in the IWF to configured groups is needed, the IWF shall perform the procedures specified in clause 8.3.2.6 for the served MCData ID and each configured MCData group ID.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_8.3.2.6"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.3.1",
      "section_id": "8.3.3.1",
      "section_title": "General",
      "content": "The procedures of the IWF performing the controlling role consist of:\n-\treceiving group affiliation status change procedure;\n-\treceiving subscription to affiliation status procedure;\n-\tsending notification of change of affiliation status procedure;\n-\timplicit affiliation eligibility check procedure; and\n-\taffiliation status change by implicit affiliation procedure.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_8.3.3.2",
      "section_id": "8.3.3.2",
      "section_title": "Stored information",
      "content": "The IWF maintains information equivalent to that defined in 3GPP TS 24.282 [82], clause 8.3.3.2.\nNOTE:\tThe virtual data structure referenced in this clause is for information only. Implementors can choose other means to track affiliation status for users homed in the IWF. References to the elements of this virtual data structure are made in other clauses with the understanding that implementors choosing not to use this virtual data structure will take other appropriate actions.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.282_clause_8.3.3.2",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.3.3",
      "section_id": "8.3.3.3",
      "section_title": "Receiving group affiliation status change procedure",
      "content": "Upon receiving a SIP PUBLISH request such that:\n1)\tRequest-URI of the SIP PUBLISH request contains the public service identity of the IWF performing the controlling role associated with the served MCData group;\n2)\tthe SIP PUBLISH request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing the <mcdata-request-uri> element and the <mcdata-calling-user-identity> element;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [4]), in a P-Asserted-Service header field according to IETF RFC 6050 [9];\n4)\tthe Event header field of the SIP PUBLISH request contains the \"presence\" event type; and\n5)\tSIP PUBLISH request contains an application/pidf+xml MIME body indicating per-group affiliation information constructed according to clause 8.4.1;\nthen the IWF performing the controlling role:\n1)\tshall identify the served MCData group ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP PUBLISH request;\n2)\tshall identify the handled MCData ID in the <mcdata-calling-user-identity> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP PUBLISH request;\n3)\tif the Expires header field of the SIP PUBLISH request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP PUBLISH request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n4)\tif an MCData group for the served MCData group ID is not available to the IWF performing the controlling role, shall reject the SIP PUBLISH request with SIP 403 (Forbidden) response to the SIP PUBLISH request according to 3GPP TS 24.229 [4], IETF RFC 3903 [37] and IETF RFC 3856 [51] and skip the rest of the steps;\n5)\tif the handled MCData ID is not a member of the MCData group identified by the served MCData group ID, shall reject the SIP PUBLISH request with SIP 403 (Forbidden) response to the SIP PUBLISH request according to 3GPP TS 24.229 [4], IETF RFC 3903 [37] and IETF RFC 3856 [51] and skip the rest of the steps;\n6)\tshall respond with SIP 200 (OK) response to the SIP PUBLISH request according to 3GPP TS 24.229 [4], IETF RFC 3903 [37]. In the SIP 200 (OK) response, the IWF performing the controlling role:\na)\tshall set the Expires header field according to IETF RFC 3903 [37], to the selected expiration time;\n7)\tif the \"entity\" attribute of the <presence> element of the application/pidf+xml MIME body of the SIP PUBLISH request is different than the served MCData group ID, shall not continue with the rest of the steps;\n8)\tif the handled MCData ID is different from the MCData ID in the \"id\" attribute of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request, shall not continue with the rest of the steps;\n9)\tshall consider an MCData group information entry such that:\na)\tthe MCData group information entry is in the list of MCData group information entries described in clause 8.3.3.2; and\nb)\tthe MCData group ID of the MCData group information entry is equal to the served MCData group ID;\nas the served MCData group information entry;\n10)\tif the selected expiration time is zero:\na)\tshall remove the MCData user information entry such that:\ni)\tthe MCData user information entry is in the list of the MCData user information entries of the served MCData group information entry; and\nii)\tthe MCData user information entry has the MCData ID set to the served MCData ID;\n11)\tif the selected expiration time is not zero:\na)\tshall consider an MCData user information entry such that:\ni)\tthe MCData user information entry is in the list of the MCData user information entries of the served MCData group information entry; and\nii)\tthe MCData ID of the MCData user information entry is equal to the handled MCData ID;\nas the served MCData user information entry;\nb)\tif the MCData user information entry does not exist:\ni)\tshall insert an MCData user information entry with the MCData ID set to the handled MCData ID into the list of the MCData user information entries of the served MCData group information entry; and\nii)\tshall consider the inserted MCData user information entry as the served MCData user information entry; and\nc)\tshall set the following information in the served MCData user information entry:\ni)\tset the MCData client ID list according to the \"client\" attributes of the <affiliation> elements of the <status> element of the <tuple> element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request; and\nii)\tset the expiration time according to the selected expiration time;\n12)\tshall identify the handled p-id in the <p-id> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP PUBLISH request; and\n13)\tshall perform the procedures specified in clause 8.3.3.5 for the served MCData group ID.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_8.4.1",
        "clause_8.3.3.2",
        "clause_8.3.3.5",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.3.4",
      "section_id": "8.3.3.4",
      "section_title": "Receiving subscription to affiliation status procedure",
      "content": "NOTE:\tUsage of one SIP SUBSCRIBE request to subscribe for notification about change of affiliation state of several MCData users served by the same MCData server is not supported in this version of the specification.\nUpon receiving a SIP SUBSCRIBE request such that:\n1)\tRequest-URI of the SIP SUBSCRIBE request contains the public service identity of the IWF performing the controlling role associated with the served MCData group;\n2)\tthe SIP SUBSCRIBE request contains an application/vnd.3gpp.mcdata-info+xml MIME body containing the<mcdata-request-uri> element and the <mcdata-calling-user-identity> element;\n3)\tthe ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [4]), in a P-Asserted-Service header field according to IETF RFC 6050 [9];\n4)\tthe Event header field of the SIP SUBSCRIBE request contains the \"presence\" event type; and\n5) the SIP SUBSCRIBE request contains an application/simple-filter+xml MIME body indicating per-user restrictions of presence event package notification information according to clause 8.4.2 indicating the same MCData ID as in the <mcdata-calling-user-identity> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\nthen the IWF performing the controlling role:\n1)\tshall identify the served MCData group ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n2)\tshall identify the handled MCData ID in the <mcdata-calling-user-identity> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP SUBSCRIBE request;\n3)\tif the Expires header field of the SIP SUBSCRIBE request is not included or has nonzero value lower than 4294967295, shall send a SIP 423 (Interval Too Brief) response to the SIP SUBSCRIBE request, where the SIP 423 (Interval Too Brief) response contains a Min-Expires header field set to 4294967295, and shall not continue with the rest of the steps;\n4)\tif an MCData group for the served MCData group ID is not available to the IWF performing the controlling role, shall reject the SIP SUBSCRIBE request with SIP 403 (Forbidden) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [4], IETF RFC 3903 [37] and IETF RFC 3856 [51] and skip the rest of the steps;\n5)\tif the handled MCData ID is not a member of the MCData group identified by the served MCData group ID, shall reject the SIP SUBSCRIBE request with SIP 403 (Forbidden) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [4], IETF RFC 3903 [37] and IETF RFC 3856 [51] and skip the rest of the steps; and\n6)\tshall generate a SIP 200 (OK) response to the SIP SUBSCRIBE request according to 3GPP TS 24.229 [4], IETF RFC 6665 [26].\nFor the duration of the subscription, the IWF shall notify subscriber about changes of the information of the served MCData ID, as described in clause 8.3.3.5.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_8.4.2",
        "clause_8.3.3.5",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.3.5",
      "section_id": "8.3.3.5",
      "section_title": "Sending notification of change of affiliation status procedure",
      "content": "In order to notify the subscriber identified by the handled MCData ID about changes of the affiliation status of the served MCData group ID, the IWF:\n1)\tshall consider an MCData group information entry such that:\na)\tthe MCData group information entry is in the list of MCData group information entries described in clause 8.3.3.2; and\nb)\tthe MCData group ID of the MCData group information entry is equal to the served MCData group ID;\n2)\tshall consider an MCData user information entry such:\na)\tthe MCData user information entry is in the list of the MCData user information entries of the served MCData group information entry; and\nb)\tthe MCData ID of the MCData user information entry is equal to the handled MCData ID;\nas the served MCData user information entry;\n3)\tshall generate an application/pidf+xml MIME body indicating per-group affiliation information according to clause 8.4.1 and the served list of the served MCData user information entry of the MCData group information entry with following clarifications:\na)\tthe IWF shall include the \"expires\" attribute in the <affiliation> element; and\nb)\tif this procedure is invoked by procedure in clause 8.3.3.3 where the handled p-id was identified, the IWF shall set the <p-id> child element of the <presence> root element of the application/pidf+xml MIME body of the SIP NOTIFY request to the handled p-id value; and\n4)\tsend a SIP NOTIFY request according to 3GPP TS 24.229 [4], and IETF RFC 6665 [26] for the subscription created in clause 8.3.3.4. In the SIP NOTIFY request, the IWF shall include the generated application/pidf+xml MIME body indicating per-group affiliation information.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_8.3.3.2",
        "clause_8.4.1",
        "clause_8.3.3.3",
        "clause_8.3.3.4",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.3.6",
      "section_id": "8.3.3.6",
      "section_title": "Implicit affiliation eligibility check procedure",
      "content": "This clause is referenced from other procedures.\nUpon receiving a SIP request for an MCData group that the MCData user is not currently affiliated to and that requires the IWF performing the controlling role to check on the eligibility of the MCData user to be implicitly affiliated to the MCData group, the IWF performing the controlling role:\n1)\tshall identify the served MCData group ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP request;\n2)\tshall identify the handled MCData ID in the <mcdata-calling-user-identity> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP request;\n3)\tif an MCData group for the served MCData group ID is not available to the IWF performing the controlling role, shall consider the MCData user to be ineligible for implicit affiliation and skip the rest of the steps;\n4)\tif the handled MCData ID is not a member of the MCData group identified by the served MCData group ID, shall consider the MCData user to be ineligible for implicit affiliation and skip the rest of the steps;\n5)\tif there is no MCData group information entry in the list of MCData group information entries described in clause 8.3.3.2 with an MCData group identity matching the served MCData group ID, then shall consider the MCData user to be ineligible for implicit affiliation and skip the rest of the steps; or\n6)\tshall consider the MCData user to be eligible for implicit affiliation.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_8.3.3.2"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.3.3.7",
      "section_id": "8.3.3.7",
      "section_title": "Affiliation status change by implicit affiliation procedure",
      "content": "This clause is referenced from other procedures.\nUpon receiving a SIP request for an MCData group that the MCData user is not currently affiliated to and that requires the IWF performing the controlling role to perform an implicit affiliation to, the IWF performing the controlling role:\n1)\tshall identify the served MCData group ID in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP request;\n2)\tshall identify the handled MCData ID in the <mcdata-calling-user-identity> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP request;\n3)\tshall consider an MCData group information entry such that:\na)\tthe MCData group information entry is in the list of MCData group information entries described in clause 8.3.3.2; and\nb)\tthe MCData group ID of the MCData group information entry is equal to the served MCData group ID;\nas the served MCData group information entry;\n4)\tshall consider an MCData user information entry such that:\na)\tthe MCData user information entry is in the list of the MCData user information entries of the served MCData group information entry; and\nb)\tthe MCData ID of the MCData user information entry is equal to the handled MCData ID;\nas the served MCData user information entry;\nc)\tif the MCData user information entry does not exist:\ni)\tshall insert an MCData user information entry with the MCData ID set to the handled MCData ID into the list of the MCData user information entries of the served MCData group information entry; and\nii)\tshall consider the inserted MCData user information entry as the served MCData user information entry; and\nd)\tshall make the following modifications in the served MCData user information entry:\ni)\tadd the MCData client ID derived from the received SIP request to the MCData client ID list if not already present; and\nii)\tset the expiration time as determined by local policy; and\n5)\tshall perform the procedures specified in clause 8.3.3.5 for the served MCData group ID.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_8.3.3.2",
        "clause_8.3.3.5"
      ]
    },
    {
      "chunk_id": "ts_29.582_8.4",
      "section_id": "8.4",
      "section_title": "Coding",
      "content": "The IWF shall support the coding specified in 3GPP TS 24.282 [82] clause 8.4.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.282_clause_8.4",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.1",
      "section_id": "9.1",
      "section_title": "General",
      "content": "The group administrator can disable the SDS service on a MCData group by setting the <mcdata-allow-short-data-service> element under the <list-service> element, in the group document as defined in 3GPP TS 24.481 [31], to \"false\".\nIf the <mcdata-allow-short-data-service> element under the <list-service> element, in the group document, is set to \"false\" for an MCData group:\n-\tan IWF shall not send an SDS to the said MCData group; and\n-\tan IWF performing the terminating MCData controlling role shall reject a request to send SDS to the said MCData group.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.481"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.1",
      "section_id": "9.2.1",
      "section_title": "General",
      "content": "On-network SDS employing the media plane is not supported by the IWF in the present document.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_9.2.2.1",
      "section_id": "9.2.2.1",
      "section_title": "General",
      "content": "The procedures in the subsequent clauses of clause 9.2.2 are used by the IWF to send or receive:\n-\ta one-to-one standalone SDS message using the signalling control plane; or\n-\ta group standalone SDS message using the signalling control plane.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_9.2.2"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.2.2.1",
      "section_id": "9.2.2.2.1",
      "section_title": "Originating procedures",
      "content": "The IWF shall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [4] and IETF RFC 3428 [33] with the clarifications given below.\nThe IWF:\n1)\tif a one-to-one standalone SDS message is to be sent, shall insert in the SIP MESSAGE request:\na)\tan application/resource-lists+xml MIME body with the MCData ID of the target MCData user, according to rules and procedures of IETF RFC 4826 [89];\nb)\tan application/vnd.3gpp.mcdata-info+xml MIME body with a <request-type> element set to a value of \"one-to-one-sds\"; and\nc)\tif end-to-end security is required and the security context does not exist or if the existing security context has expired, an application/mikey MIME body with the MIKEY-SAKKE I_MESSAGE as specified in 3GPP TS 33.180 [78]. The IWF:\ni)\tif necessary, shall determine keying material from the key management server;\nNOTE:\tHow the IWF obtains the keying material is out of scope of the present document.\nii)\tshall use the keying material to generate a PCK as described in 3GPP TS 33.180 [78];\niii)\tshall use the PCK to generate a PCK-ID with the four most significant bits set to \"0001\" to indicate that the purpose of the PCK is to protect one-to-one communications and with the remaining twenty eight bits being randomly generated as described in 3GPP TS 33.180 [78];\niv)\tshall encrypt the PCK to a UID associated to the MCData client using the MCData ID of the invited user and a time related parameter as described in 3GPP TS 33.180 [78];\nv)\tshall generate a MIKEY-SAKKE I_MESSAGE using the encapsulated PCK and PCK-ID as specified in 3GPP TS 33.180 [78];\nvi)\tshall add the MCData ID associated with the originating user homed in the IWF to the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [78];\nvii)\tshall sign the MIKEY-SAKKE I_MESSAGE using the originating signing key determined by the IWF performing the role of an MCData server provided in the keying material together with a time related parameter; and\nviii)\tshall include the MIKEY-SAKKE I_MESSAGE in an application/mikey MIME body as specified in 3GPP TS 33.180 [78];\n2)\tif a group standalone SDS message is to be sent:\na)\tshall insert in the SIP MESSAGE request an application/vnd.3gpp.mcdata-info+xml MIME body with:\ni)\tthe <request-type> element set to a value of \"group-sds\";\nii)\tthe <mcdata-request-uri> element set to the MCData group identity; and\niii)\tthe <mcdata-client-id> element set to the MCData client ID associated with the originating user homed in the IWF; and\n3)\tshall generate a standalone SDS message as specified in clause 6.2.2.1.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_6.2.2.1",
        "ts_24.229",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.2.2.2",
      "section_id": "9.2.2.2.2",
      "section_title": "Terminating procedures",
      "content": "Upon receipt of an SDS intended for a user homed in the IWF, the IWF processes the message according to the procedures in clause 9.2.2.3.2.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.2.3.2"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.2.3.1",
      "section_id": "9.2.2.3.1",
      "section_title": "Originating participating MCData function procedures",
      "content": "If the IWF acting in a participating MCData role determines that it needs to send an SDS message:\n1)\tshall determine the MCData ID of the originating user;\n2)\tshall determine the public service identity of the controlling MCData function associated with the requested SDS message:\na)\tif the SDS message to be sent is a group SDS message the public service identity is that of the controlling MCData function associated with the MCData group identity of the destination group; or\nb)\tif the SDS message to be sent is a one-to-one SDS message the public service identity is that of the controlling MCData function hosting the one-to-one standalone SDS service for the calling user;\nNOTE 1:\tHow the IWF determines the public service identity of the controlling MCData function is out of scope of the present document.\n3)\tif unable to identify the controlling MCData function for standalone SDS shall complete any further actions to notify the user homed in the IWF, and shall not continue with any of the remaining steps;\n4)\tshall ensure that the payload size of the message is not larger than a configured value compatible with the MCData service;\nNOTE 2:\tThe term \"payload size\" refers to the \"Length of Payload contents\" of the payload IE of the DATA PAYLOAD message transported in the SIP MESSAGE request, minus 1 (to account for the added \"Payload content type\" field).\nNOTE 3:\tThe configured value for maximum payload size should not be larger than the value contained in the <max-payload-size-sds-cplane-bytes> element in the MCData service configuration document as specified in 3GPP TS 24.484 [50]. How the IWF determines the value to configure is out of scope of the present document.\n5)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [4] and IETF RFC 3428 [33];\n6)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCData function as determined by step 2) in this clause;\n7)\tshall include MIME bodies in to the outgoing SIP MESSAGE request according to clause 9.2.2.2.1;\n8)\tshall include the MCData ID of the originating user in the <mcdata-calling-user-identity> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP MESSAGE request;\n9)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [4]), into the P-Asserted-Service header field of the outgoing SIP MESSAGE request;\n10)\tshall set the P-Asserted-Identity in the outgoing SIP MESSAGE request to the public service identity of the IWF; and\n11)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [4].\nUpon receipt of a SIP response in response to the SIP MESSAGE request in step 11) the IWF completes any further actions needed to handle the response – e.g. notify the user homed in the IWF.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.2.2.1",
        "ts_24.484",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.2.3.2",
      "section_id": "9.2.2.3.2",
      "section_title": "IWF performing the terminating participating MCData role procedures",
      "content": "Upon receipt of a \"SIP MESSAGE request for standalone SDS for terminating participating MCData function\", the IWF performing the participating role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The IWF may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [24] and skip the rest of the steps;\n2)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request to identify the user homed in the IWF;\n3)\tif the user homed in the IWF does not exist, then the participating IWF may reject the SIP MESSAGE request with a SIP 404 (Not Found) response, and shall skip the remaining steps;\n4)\tif the SIP MESSAGE request contains an application/mikey MIME body containing a MIKEY-SAKKE I_MESSAGE and decryption of the content of the MIME body is to occur at the IWF, then the IWF:\na)\tshall extract the MCData ID of the originating MCData user from the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [78];\nb)\tshall convert the MCData ID to a UID as described in 3GPP TS 33.180 [78];\nc)\tshall use the UID to validate the signature of the MIKEY-SAKKE I_MESSAGE as described in 3GPP TS 33.180 [78];\nd)\tif authentication verification of the MIKEY-SAKKE I_MESSAGE fails, shall reject the SIP MESSAGE request with a SIP 606 (Not Acceptable) response, and include warning text set to \"136 authentication of the MIKEY-SAKKE I_MESSAGE failed\" in a Warning header field as specified in clause 4.7 and not continue with rest of the steps in this clause; and\ne)\tif the signature of the MIKEY-SAKKE I_MESSAGE was successfully validated:\ni)\tshall extract and decrypt the encapsulated PCK using the terminating user's (KMS provisioned) UID key as described in 3GPP TS 33.180 [78]; and\nii)\tshall extract the PCK-ID, from the payload as specified in 3GPP TS 33.180 [78]; and\nNOTE:\tAny trans-encryption between the IWF and the user homed in the IWF is out of scope of the present document.\n5)\ttakes any further steps necessary to handle the message – e.g. notify the user homed in the IWF.\nIf the IWF determines that a SIP 200 (OK) response shall be sent on behalf of a user homed in the IWF in response to the SIP message request, the IWF shall send a SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [4].\nIf the IWF determines that a SIP 4xx, 5xx or 6xx response shall be sent on behalf of a user homed in the IWF in response to the SIP message request, the IWF shall send said SIP 4xx, 5xx or 6xx response to the controlling MCData function according to 3GPP TS 24.229 [4]:\n1)\tshall determine which Warning header field(s) to place in the SIP response; and\n2)\tshall send the SIP response to the controlling MCData function according to 3GPP TS 24.229 [4].",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_4.7",
        "ts_33.180",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.2.4.1",
      "section_id": "9.2.2.4.1",
      "section_title": "Originating controlling IWF procedures",
      "content": "This clause describes the procedures for sending a SIP MESSAGE from the IWF performing the controlling role and is initiated by the IWF performing the role of a controlling MCData function as a result of an action in clause 9.2.2.4.2 or upon the determination by the IWF performing the controlling role that a SIP MESSAGE is to be sent on behalf of a user homed in the IWF.\nThe controlling MCData function:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [4] and IETF RFC 3428 [33];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [6] in the outgoing SIP MESSAGE request;\n3)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [6] in the outgoing SIP MESSAGE request;\n4)\tif the SIP MESSAGE is to be sent as the result of receiving a SIP MESSAGE originated by an MCData client, shall copy the following MIME bodies in the received SIP MESSAGE request into the outgoing SIP MESSAGE request by following the guidelines in clause 6.4; otherwise, if the SIP MESSAGE is to be sent on behalf of a user homed in the IWF, shall create the following MIME bodies in the outgoing SIP MESSAGE request by following the guidelines in clause 306.4 and the procedures in clause 9.2.2.2.1:\na)\tapplication/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tapplication/vnd.3gpp.mcdata-signalling MIME body; and\nc)\tapplication/vnd.3gpp.mcdata-payload MIME body\n5)\tin the application/vnd.3gpp.mcdata-info+xml MIME body:\na)\tshall set the <mcdata-request-uri> element set to the MCData ID of the terminating user; and\nb)\tif the SIP MESSAGE is to be sent as the result of receiving a SIP MESSAGE originated by an MCData client, then if the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request was set to a value of \"group-sds\", or if the SIP MESSAGE is to be sent on behalf of a user homed in the IWF and the IWF performing the controlling role determines that the outgoing SIP MESSAGE is associated with a group,\ni)\tshall set the <mcdata-calling-group-id> element to the group identity;\n6)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated to the MCData user to be invited;\n7)\tshall insert its own public service identity into the P-Asserted-Identity header field of the outgoing SIP MESSAGE request;\n8)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\n9)\tshall send the SIP MESSAGE request according to according to rules and procedures of 3GPP TS 24.229 [4].",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.2.4.2",
        "clause_6.4",
        "clause_306.4",
        "clause_9.2.2.2.1",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.2.4.2",
      "section_id": "9.2.2.4.2",
      "section_title": "Terminating controlling MCData function procedures",
      "content": "Upon receipt of a \"SIP MESSAGE request for standalone SDS for controlling MCData function\", the IWF performing the controlling role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The IWF performing the controlling role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [24]. Otherwise, continue with the rest of the steps;\n2)\tif the SIP MESSAGE does not contain:\na)\tan application/vnd.3gpp.mcdata-info+xml MIME body;\nb)\tan application/vnd.3gpp.mcdata-signalling MIME body; and\nc)\tan application/vnd.3gpp.mcdata-payload MIME body;\nshall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"199 expected MIME bodies not in the request\" in a Warning header field as specified in clause 4.7, and shall not continue with the rest of the steps in this clause;\n3)\tshall decode the contents of the application/vnd.3gpp.mcdata-signalling MIME body contained in the SIP MESSAGE;\n4)\tif the application/vnd.3gpp.mcdata-signalling MIME body contains a SDS SIGNALLING PAYLOAD message with a SDS disposition request type IE, shall store the value of the Conversation ID IE and the value of the Message ID IE in the SDS SIGNALLING PAYLOAD message;\nNOTE:\tThe IWF performing the controlling role uses the Conversation ID and Message ID for correlation with disposition notifications.\n5)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request is set to a value of \"one-to-one-sds\" and:\na)\tthe conditions in clause 11.1 indicate that the MCData user is not allowed to send SDS communications due to message size as determined by step 3) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"218 user not authorised for one-to-one SDS communications due to message size\" in a Warning header field as specified in clause 4.7, and shall not continue with the rest of the steps in this clause; and\nb)\tthe SIP MESSAGE request:\ni)\tdoes not contain an application/resource-lists MIME body or contains an application/resource-lists MIME body with more than one <entry> element, shall return a SIP 403 (Forbidden) response with the warning text set to \"204 unable to determine targeted user for one-to-one SDS\" in a Warning header field as specified in clause 4.7, and skip the rest of the steps below; and\nii)\tcontains an application/resource-lists MIME body with exactly one <entry> element, shall send a SIP MESSAGE request to the MCData user identified in the <entry> element of the MIME body, as specified in clause 9.2.2.4.1, or if the MCData user identified in the <entry> element of the MIME body indicates a user homed in the IWF, the processes used by IWF performing the controlling role to handle the incoming SIP MESSAGE request are out of scope;\n6)\tif the <request-type> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request is set to a value of \"group-sds\":\na)\tshall retrieve the group document associated with the group identity in the SIP MESSAGE request by following the procedures in clause 6.3.3, and shall continue with the remaining steps if the procedures in clause 6.3.3 were successful;\nb)\tif the <on-network-disabled> element is present in the group document, shall send a SIP 403 (Forbidden) response with the warning text set to \"115 group is disabled\" in a Warning header field as specified in clause 4.7 and shall not continue with the rest of the steps;\nc)\tif the <entry> element of the <list> element of the <list-service> element in the group document does not contain an <mcdata-mcdata-id> element with a \"uri\" attribute matching the MCData ID of the originating user contained in the <mcdata-calling-user-identity> element of the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP MESSAGE request, shall send a SIP 403 (Forbidden) response with the warning text set to \"116 user is not part of the MCData group\" in a Warning header field as specified in clause 4.7 and shall not continue with the rest of the steps;\nd)\tif the <list-service> element contains a <mcdata-allow-short-data-service> element in the group document set to a value of \"false\", shall send a SIP 403 (Forbidden) response with the warning text set to \"206 short data service not allowed for this group\" in a Warning header field as specified in clause 4.7 and shall not continue with the rest of the steps;\ne)\tif the <supported-services> element is not present in the group document or is present and contains a <service> element containing an \"enabler\" attribute which is not set to the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\", shall send a SIP 488 (Not Acceptable) response with the warning text set to \"207 SDS services not supported for this group\" in a Warning header field as specified in clause 4.7 and shall not continue with the rest of the steps;\nf)\tif the group SDS procedures in clause 11.1 indicate that the user identified by the MCData ID:\ni)\tis not allowed to send group MCData communications on this group identity as determined by step 2) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response, with warning text set to \"201 user not authorised to transmit data on this group identity\" in a Warning header field as specified in clause 4.7, and shall not continue with the rest of the steps in this clause;\nii)\tis not allowed to send group MCData communications on this group identity due to exceeding the maximum amount of data that can be sent in a single request as determined by step 8) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"208 user not authorised for MCData communications on this group identity due to exceeding the maximum amount of data that can be sent in a single request\" in a Warning header field as specified in clause 4.7, and shall not continue with the rest of the steps in this clause; and\niii)\tis not allowed to send SDS communications on this group identity due to message size as determined by step 5) of clause 11.1, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request, with warning text set to \"217 user not authorised for SDS communications on this group identity due to message size\" in a Warning header field as specified in clause 4.7, and shall not continue with the rest of the steps in this clause;\ng)\tthe originating user identified by the MCData ID is not affiliated to the group identity contained in the SIP MESSAGE request, as specified in clause 6.3.5, shall return a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.7, and skip the rest of the steps below;\nh)\tshall determine targeted group members for MCData communications by following the procedures in clause 6.3.3;\ni)\tif the procedures in clause 6.3.3 result in no affiliated members found in the selected MCData group, shall return a SIP 403 (Forbidden) response with the warning text set to \"198 no users are affiliated to this group\" in a Warning header field as specified in clause 4.7, and skip the rest of the steps below; and\nj)\tshall send SIP MESSAGE requests to the targeted MCData group members identified in step h) above by following the procedure in clause 9.2.2.4.1;\n7)\tshall generate a SIP 202 (Accepted) response in response to the \"SIP MESSAGE request for standalone SDS for controlling MCData function\"; and\n8)\tshall send the SIP 202 (Accepted) response towards the originating participating MCData function according to 3GPP TS 24.229 [4].",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_4.7",
        "clause_11.1",
        "clause_9.2.2.4.1",
        "clause_6.3.3",
        "clause_6.3.5",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.3.1",
      "section_id": "9.2.3.1",
      "section_title": "General",
      "content": "The procedures in the clauses of the parent clause are used by the IWF to send or receive:\n-\ta one-to-one standalone SDS message using the media control plane; or\n-\ta group standalone SDS message using the media control plane.\nThe procedures in the clauses of the parent clause are applicable to establish an on-demand standalone SDS using media plane.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_9.2.3.2.1",
      "section_id": "9.2.3.2.1",
      "section_title": "SDP offer generation",
      "content": "When composing an SDP offer according to 3GPP TS 24.229 [4], IETF RFC 4975 [90], IETF RFC 6135 [19] and IETF RFC 6714 [91] the IWF:\n1)\tshall include an \"m=message\" media-level section for the MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\", or \"TCP/TLS/MSRP\" for TLS;\nc)\ta format list field set to \"*\";\nd)\tan \"a=sendonly\" attribute;\ne)\tan \"a=path\" attribute containing its own MSRP URI;\nf)\tset the content type as \"a=accept-types:application/vnd.3gpp.mcdata-signalling application/vnd.3gpp.mcdata-payload\"; and\ng)\tset the a=setup attribute as \"actpass\"; and\n2)\tif end-to-end security is required for a one-to-one communication and the security context does not exist or if the existing security context has expired, shall include the MIKEY-SAKKE I_MESSAGE in an \"a=key-mgmt\" attribute as a \"mikey\" attribute value in the SDP offer as specified in IETF RFC 4567 [47].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.3.2.2",
      "section_id": "9.2.3.2.2",
      "section_title": "SDP answer generation",
      "content": "When the IWF receives an initial SDP offer for an MCData standalone SDS, the IWF shall process the SDP offer and shall compose an SDP answer according to 3GPP TS 24.229 [4] and IETF RFC 4975 [90].\nWhen composing an SDP answer, the IWF:\n1)\tshall include an \"m=message\" media-level section for the accepted MCData media stream consisting of:\na)\tthe port number;\nb)\ta protocol field value of \"TCP/MSRP\", or \"TCP/TLS/MSRP\" for TLS according to the received SDP offer;\nc)\ta format list field set to \"*\";\nd)\tan \"a=recvonly\" attribute;\ne)\tan \"a=path\" attribute containing its own MSRP URI;\nf)\tset the content type as a=accept-types: application/vnd.3gpp.mcdata-signalling application/vnd.3gpp.mcdata-payload; and\ng)\tset the a=setup attribute according to IETF RFC 6135 [19].",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.3.2.3",
      "section_id": "9.2.3.2.3",
      "section_title": "Originating procedures",
      "content": "The IWF shall generate a SIP INVITE request in accordance with 3GPP TS 24.229 [4] with the clarifications given below.\nThe IWF:\n1)\tshall include the g.3gpp.mcdata.sds media feature tag and the g.3gpp.icsi-ref media feature tag with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" in the Contact header field of the SIP INVITE request according to IETF RFC 3840 [93];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [6];\n3)\tshall include an Accept-Contact header field with the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [6];\n4)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" (coded as specified in 3GPP TS 24.229 [4]), in a P-Asserted-Service header field according to IETF RFC 6050 [9] in the SIP INVITE request;\n5)\tshall include the \"timer\" option tag in the Supported header field;\n6)\tshould include the Session-Expires header field according to IETF RFC 4028 [7]. It is recommended that the \"refresher\" header field parameter is omitted. If included, the \"refresher\" header field parameter shall be set to \"uac\";\n7)\tif a one-to-one standalone SDS message is to be sent:\na)\tshall insert in the SIP INVITE request a MIME resource-lists body with the MCData ID of the invited MCData user, according to rules and procedures of IETF RFC 5366 [20];\nb)\tshall contain an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"one-to-one-sds\"; and\nc)\tif an end-to-end security context needs to be established and the security context does not exist or if the existing security context has expired, then:\ni)\tif necessary, shall instruct the key management client to request keying material from the key management server;\nNOTE:\tHow the IWF obtains the keying material is out of scope of the present document.\nii)\tshall use the keying material to generate a PCK as described in 3GPP TS 33.180 [78];\niii)\tshall use the PCK to generate a PCK-ID with the four most significant bits set to \"0001\" to indicate that the purpose of the PCK is to protect one-to-one communications and with the remaining twenty eight bits being randomly generated as described in 3GPP TS 33.180 [78];\niv)\tshall encrypt the PCK to a UID associated to the MCData client using the MCData ID of the invited user and a time related parameter as described in 3GPP TS 33.180 [78];\nv)\tshall generate a MIKEY-SAKKE I_MESSAGE using the encapsulated PCK and PCK-ID as specified in 3GPP TS 33.180 [78];\nvi)\tshall add the MCData ID associated with the originating user homed in the IWF to the initiator field (IDRi) of the I_MESSAGE as described in 3GPP TS 33.180 [78]; and\nvii)\tshall sign the MIKEY-SAKKE I_MESSAGE using the originating signing key determined by the IWF performing the role of an MCData server provided in the keying material together with a time related parameter, and add this to the MIKEY-SAKKE payload, as described in 3GPP TS 33.180 [78];\n8)\tif a group standalone SDS message is to be sent:\na)\tshall contain in an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with:\ni)\tthe <request-type> element set to a value of \"group-sds\";\nii)\tthe <mcdata-request-uri> element set to the MCData group identity; and\niii)\tthe <mcdata-client-id> element set to the MCData client ID associated with the originating user homed in the IWF; and\n9)\tshall include an SDP offer according to 3GPP TS 24.229 [4] with the clarifications given in clause 9.2.3.2.1.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.3.2.1",
        "ts_24.229",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.3.2.4",
      "section_id": "9.2.3.2.4",
      "section_title": "Terminating procedures",
      "content": "Upon receipt of an SDS intended for a user homed in the IWF shall\n1\t, the IWF process the message according to the procedures in clause 9.2.3.3.4; and\n2\tcomplete any further actions to notify the user homed in the IWF.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.3.3.4"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.3.3.1",
      "section_id": "9.2.3.3.1",
      "section_title": "SDP offer generation",
      "content": "The SDP offer generated by the IWF performing the participating MCData role shall be composed according to clause 9.2.3.2.1 and:\n1)\tshall contain only one SDP media-level section for SDS message.\nWhen composing the SDP offer according to 3GPP TS 24.229 [4], the IWF:\n1)\tshall use the IP address and port number of the IWF for the offered media stream; and\nNOTE:\tRequirements can exist for the IWF to be always included in the path of the offered media stream, for example: for the support of features such as MBMS, lawful interception and recording. Other examples can exist.\n2)\tshall place its MSRP URI in the \"a=path\" attribute in the SDP offer.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_9.2.3.2.1",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.3.3.2",
      "section_id": "9.2.3.3.2",
      "section_title": "SDP answer generation",
      "content": "When composing the SDP answer according to 3GPP TS 24.229 [4] and clause 9.2.3.2.2, the IWF:\n1)\tshall use the IP address and port number of the IWF performing the participating MCData role for the accepted media stream in the received SDP offer, if required; and\nNOTE:\tRequirements can exist for the IWF to be always included in the path of the offered media stream, for example: for the support of features such as MBMS, lawful interception and recording. Other examples can exist.\n2)\tshall place its MSRP URI in the \"a=path\" attribute in the SDP answer.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.229_clause_9.2.3.2.2",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.3.3.3",
      "section_id": "9.2.3.3.3",
      "section_title": "Originating participating MCData function procedures",
      "content": "If the IWF acting in a participating MCData role determines that it needs to send an SDS message over media plane then the IWF:\n1)\tshall determine the MCData ID of the calling user;\n2)\tshall determine the public service identity of the controlling MCData function associated with the requested SDS message:\na)\tif the SDS message to be sent is a group SDS message the public service identity is that of the controlling MCData function associated with the MCData group identity of the destination group; or\nb)\tif the SDS message to be sent is a one-to-one SDS message the public service identity is that of the controlling MCData function hosting the one-to-one standalone SDS over media plane service for the calling user;\nNOTE:\tHow the IWF determines the public service identity of the controlling MCData function is out of scope of the present document.\n3)\tif unable to identify the controlling MCData function for standalone SDS over media plane, it can complete any further actions to notify the user homed in the IWF, and shall not continue with any of the remaining steps;\n4)\tshall generate a SIP INVITE request in accordance with the procedures in clause 9.2.3.2.3:\n5)\tshall set the Request-URI of the outgoing SIP INVITE request to the public service identity of the controlling MCData function as determined by step 2) in this clause;\n6)\tshall include the MCData ID of the originating user in the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP INVITE request;\n7)\tshall set the P-Asserted-Identity in the outgoing SIP INVITE request to the public service identity of the IWF;\n8)\tshall include in the SIP INVITE request an SDP offer as specified in clause 9.2.3.3.1;\n9)\tshall send the SIP INVITE request as specified to 3GPP TS 24.229 [4]; and\n10)\tshall interact with the media plane as specified in 3GPP TS 24.582 [85] clause 6.2.1.4.\nUpon receipt of a SIP response in response to the SIP INVITE above the IWF completes any further actions needed to handle the response.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.3.2.3",
        "clause_9.2.3.3.1",
        "ts_24.582_clause_6.2.1.4",
        "ts_24.229",
        "ts_24.582"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.3.3.4",
      "section_id": "9.2.3.3.4",
      "section_title": "Terminating participating MCData function procedures",
      "content": "Upon receipt of a \"SIP INVITE request for standalone SDS over media plane for terminating participating MCData function\", the IWF acting in the participating MCData role:\n1)\tif unable to process the request, may reject the SIP INVITE request with a SIP 500 (Server Internal Error) response. The IWF may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [24] and skip the rest of the steps;\n2)\tshall check the presence of the isfocus media feature tag in the URI of the Contact header field and if it is not present then the IWF shall reject the request with a SIP 403 (Forbidden) response with the warning text set to \"104 isfocus not assigned\" in a Warning header field as specified in clause 4.4, and shall not continue with the rest of the steps;\n3)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request to identify the user homed in the IWF;\n4)\tif the user homed in the IWF does not exist, then the participating IWFshall reject the SIP INVITE request with a SIP 404 (Not Found) response, and shall not continue with the rest of the steps; and\n5)\tif the IWF supports restriction of incoming communications to the user homed in the IWF equivalent to the <IncomingOne-to-OneCommunicationList> element existing in the MCData user profile document for the user homed in the IWF with one or more <One-to-One-CommunicationListEntry> elements (see the MCData user profile document in 3GPP TS 24.484 [50]) and:\ni)\tif the IWF determines that the <mcdata-calling-user-id> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP INVITE request does not match with any MCData ID permitted to make incoming MCData communications to the user homed in the IWF; and\nii)\tif the IWF determines that the user homed in the IWF is not allowed to receive one-to-one communication from an arbitrary MCData user;\nthen:\ni)\tshall reject the SIP INVITE request with a SIP 403 (Forbidden) response including warning text set to \"230 one-to-one MCData communication not authorised from this originating user\" in a Warning header field as specified in clause 4.9 and shall not continue with the rest of the steps;\nNOTE:\tHow the IWF determines relevant contents of the MCData user profile document is out of scope of the present document.\nIf the IWF acting in the participating role determines that a SIP 200 (OK) response shall be generated on behalf of the user homed in the IWF in response to the SIP INVITE request then the IWF :\n1)\tshall generate a SIP 200 (OK) response as specified in 3GPP TS 24.229 [4];\n2)\tshall include in the SIP 200 (OK) response an SDP answer according to 3GPP TS 24.229 [4] with the clarification given in clause 9.2.3.3.2;\n3)\tshall include the option tag \"timer\" in a Require header field;\n4)\tshall include the Session-Expires header field according to rules and procedures of IETF RFC 4028 [7], \"UAS Behavior\". If no \"refresher\" parameter was included in the SIP INVITE request, the \"refresher\" parameter in the Session-Expires header field shall be set to \"uas\";\n5)\tshall include the following in the Contact header field:\na)\tthe g.3gpp.mcdata.sds media feature tag;\nb)\tthe g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\"; and\nc)\tan MCData session identity mapped to the MCData session identity provided in the Contact header field of the received SIP INVITE request from the controlling MCData function;\n6)\tshall create the application/vnd.3gpp.mcdata-info+xml MIME body to the outgoing SIP 200 (OK) response.\n7)\tshall include a P-Asserted-Identity header field set to the public service identity of the IWF performing the participating role;\n8)\tshall start the SIP Session timer according to rules and procedures of IETF RFC 4028 [7];\n9)\tshall interact with the media plane as specified in 3GPP TS 24.582 [85] clause 6.2.1.5; and\n10)\tshall send the SIP 200 (OK) response to the controlling MCData function according to 3GPP TS 24.229 [4].\nIf the IWF acting in the participating role determines that a SIP 4xx, 5xx or 6xx response to the above SIP INVITE request shall be sent then the IWF acting in a participating MCData role:\n1)\tshall generate a SIP response according to 3GPP TS 24.229 [4];\n2)\tshall include Warning header field(s) as appropriate; and\n3)\tshall forward the SIP response to the controlling MCData function according to 3GPP TS 24.229 [4].",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_4.4",
        "clause_4.9",
        "clause_9.2.3.3.2",
        "ts_24.582_clause_6.2.1.5",
        "ts_24.484",
        "ts_24.229",
        "ts_24.582"
      ]
    },
    {
      "chunk_id": "ts_29.582_9.2.4",
      "section_id": "9.2.4",
      "section_title": "SDS session",
      "content": "The IWF does not support an SDS session in the present document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_9.3",
      "section_id": "9.3",
      "section_title": "Off-network SDS",
      "content": "Off-network SDS is not applicable to interworking.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_10",
      "section_id": "10",
      "section_title": "File Distribution (FD)",
      "content": "File distribution is not supported by the IWF in the present document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_11.1",
      "section_id": "11.1",
      "section_title": "General",
      "content": "How the IWF determines authorisation of a user homed in the IWF to initiate MCData communications is out of scope.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_11.2",
      "section_id": "11.2",
      "section_title": "Auto-receive for File Distribution",
      "content": "File distribution is not supported by the IWF in the present document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_11.3",
      "section_id": "11.3",
      "section_title": "Accessing list of deferred data group communications",
      "content": "Accessing list of deferred data group communication is associated with file distribution which is not supported by the IWF in the present document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_12.1",
      "section_id": "12.1",
      "section_title": "General",
      "content": "The procedures in clause 12 describe:\n-\tthe on-network procedures for generating out-of-band dispositions for on-network SDS.\nThe IWF acting on behalf of a participant homed in the IWF can send a disposition notification as a direct result of receiving an MCData message (e.g. delivery notification) or can send a disposition notification at a later time (e.g. read notification). In certain circumstances the delivery and read notification can be delivered in one notification message.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_12"
      ]
    },
    {
      "chunk_id": "ts_29.582_12.2.1.1",
      "section_id": "12.2.1.1",
      "section_title": "Participating IWF procedures",
      "content": "If the IWF performing the MCData participating role decides to send a disposition notification\nthe IWF shall follow the procedures of clause 12.2.1.2.\nUpon receipt of a SIP 202 (Accepted) response in response to the SIP MESSAGE request, the IWF:\n1)\tcan perform internal actions to process the response.\nUpon receipt of a SIP 200 (OK) response in response to the SIP MESSAGE request, the IWF:\n1)\tcan perform internal actions to process the response.\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the SIP MESSAGE request, the IWF:\n1)\tcan perform internal actions to process the response.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_12.2.1.2"
      ]
    },
    {
      "chunk_id": "ts_29.582_12.2.1.2",
      "section_id": "12.2.1.2",
      "section_title": "Sending a disposition notification message",
      "content": "The IWF performing the participating role may follow the procedures in this clause to:\n-\tindicate to an MCData client that an SDS message was delivered, read or delivered and read when the originating client requested a delivery, read or delivery and read report;\n-\tindicate to the participating MCData function serving the MCData user that an SDS message was undelivered; or\n-\tindicate to the participating MCData function serving the MCData user that disposition notification has been prevented for an SDS message intended for users homed in the LMR system.\nBefore sending a disposition notification the IWF performing the participating role needs to determine:\n-\tthe group identity related to an SDS message request received as part of a group communication. The IWF performing the participating role determines the group identity from the contents of the <mcdata-calling-group-id> element contained in the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SDS message request; and\n-\tthe MCData user targeted for the disposition notification. The IWF performing the participating role determines the targetted MCData user from the contents of the <mcdata-calling-user-id> element contained in the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SDS message request.\nThe IWF performing the participating role generates a SIP MESSAGE request in accordance with 3GPP TS 24.229 [4] and IETF RFC 3428 [33] with the clarifications given below.\nThe IWF performing the participating role:\n1)\tshall build the SIP MESSAGE request as specified in clause 6.2.4.1;\n2)\tshall follow the rules specified in clause 6.4 for the handling of MIME bodies in a SIP message when processing the remaining steps in this clause;\n3)\tshall insert in the SIP MESSAGE request an application/resource-lists+xml MIME body containing the MCData ID of the targeted MCData user, according to rules and procedures of IETF RFC 5366 [20];\n4)\tif sending a disposition notification in response to an MCData group data request, shall include an <mcdata-calling-group-id> element set to the MCData group identity in the application/vnd.3gpp.mcdata-info+xml MIME body;\n5)\tif sending an SDS notification, shall generate an SDS NOTIFICATION message and include it in the SIP MESSAGE request as specified in clause 6.2.3.1; and\n6)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [4].",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2.4.1",
        "clause_6.4",
        "clause_6.2.3.1",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_12.2.1.3",
      "section_id": "12.2.1.3",
      "section_title": "Participating IWF receives disposition notification from a controlling MCData function",
      "content": "Upon receipt of a:\n-\t\"SIP MESSAGE request for SDS disposition notification for terminating MCData client \";\nThe IWF:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The IWF may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [4] and skip the rest of the steps;\n2)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request to identify the user homed in the IWF;\n3)\tif the identity of the user homed in the IWF does not exist, then the participating IWF shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response. Otherwise, continue with the rest of the steps; and\n4)\tcan perform internal actions to process the message.\nIf the IWF determines that a SIP 2xx response shall be sent on behalf of a user homed in the IWF in response to the SIP MESSAGE requests, the IWF shall send a SIP 2xx response to the controlling MCData function.\nIf the IWF determines that a SIP 4xx, 5xx or 6xx response shall be sent on behalf of a user homed in the IWF in response to the SIP MESSAGE request, the IWF shall send the response to the controlling MCData function.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_12.2.2",
      "section_id": "12.2.2",
      "section_title": "IWF performing the MCData controlling role",
      "content": "When triggered by:\n-\treceipt of a \"SIP MESSAGE request for SDS disposition notification for MCData server\"; or\n-\tthe IWF determining that it shall send an SDS disposition notification\nthe IWF performing the MCData controlling role:\n1) if the IWF has received the SIP MESSAGE;\na)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The IWF may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [24]. Otherwise, continue with the rest of the steps;\nb)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if an Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\";\nc)\tif the incoming SIP MESSAGE request does not contain an application/resource-lists MIME body or contains an application/resource-lists MIME body with more than one <entry> element, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"145 unable to determine called party\" in a Warning header field as specified in clause 4.7, and shall not continue with the rest of the steps;\nd)\tshall attempt to correlate the disposition notification to the original SDS request using the values contained in the Conversation ID and Message ID of the SDS NOTIFICATION message contained in the application/vnd.3gpp.mcdata-signalling MIME body of the SIP MESSAGE; and\ne)\tif unable to correlate the disposition notification as determined by step d), shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response including warning text set to \"216 unable to correlate the disposition notification\" in a Warning header field as specified in clause 4.7, and shall not continue with the rest of the steps;\n2)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [4] and IETF RFC 3428 [33];\n3)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [6] in the outgoing SIP MESSAGE request;\n4)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [6] in the outgoing SIP MESSAGE request;\n5)\tshall set the Request-URI to the public service identity of the terminating participating MCData function associated with the MCData user to be invited ;\nNOTE 1:\tHow the IWF finds the public service identity of the terminating MCData participating function is out of the scope of the present document.\n6)\tshall include a P-Asserted-Service header field with the value \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\";\n7)\tshall copy the MCData ID of the MCData user listed in the MIME resources body of the incoming SIP MESSAGE request, or the MCData ID of the participant homed in the IWF, into the <mcdata-request-uri> element in the application/vnd.3gpp.mcdata-info+xml MIME body of the outgoing SIP MESSAGE request;\n8)\tif an incoming SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with an <mcdata-calling-group-id> element:\na)\tshall retrieve the group document for the MCData group id contained in the <mcdata-calling-group-id> element from the group management server, if not already cached, and identify the group members;\nNOTE 2:\tHow the IWF obtains the group document is out scope of the present document.\nb)\tshall verify that the MCData ID contained in the <mcdata-calling-user-identity> element matches to a group member. If there is no match, the IWF shall reject the SIP request with a SIP 403 (Forbidden) response including warning text set to \"116 user is not part of the MCData group\" in a Warning header field as specified in clause 4.7, and shall not continue with the rest of the steps;\nc)\tif MCData disposition notifications need to be aggregated and an aggregated disposition notification has not yet been sent:\ni)\tif timer TDC1 (disposition aggregation timer) is not running, shall start timer TDC1 (disposition aggregation timer) with the timer value as specified in 3GPP TS 24.282 [82] clause F.2.2;\nii)\tshall copy the application/vnd.3gpp.mcdata-signalling MIME body in the received SIP MESSAGE request to the outgoing SIP MESSAGE request;\nNOTE 3:\tIf the aggregated MCData disposition notifications do not fit into one SIP MESSAGE request, then the IWF needs to generate a new SIP MESSAGE request for the remaining disposition notifications.\niii)\ton expiry of timer TDC1 (disposition aggregation timer) shall continue with step 9; and\niv)\tif all MCData disposition notifications have been received from all group members shall continue with step 9; and\nd)\tif MCData disposition notifications do not need to be aggregated, shall copy the application/vnd.3gpp.mcdata-signalling MIME body in the received SIP MESSAGE request to the outgoing SIP MESSAGE request and shall continue with step 9;\n9)\tif an incoming SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body without an <mcdata-calling-group-id> element shall copy the application/vnd.3gpp.mcdata-signalling MIME body in the received SIP MESSAGE request to the outgoing SIP MESSAGE request;\n10)\twhen notifying other users:\na)\tshall send the SIP MESSAGE request to those users homed in the MCData system according to rules and procedures of 3GPP TS 24.229 [4]; and\n11)\twhen acknowledging the triggering event:\na)shall generate a SIP 202 (Accepted) response in response to any\n-\t\"SIP MESSAGE request for SDS disposition notification for MCData server\".",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_4.7",
        "ts_24.229",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_13",
      "section_id": "13",
      "section_title": "Communication Release",
      "content": "The IWF shall handle communication release with the MCData system by behaving as a peer MCData server towards the MCData system as specified in 3GPP TS 24.282 [82] clauses 13.2.2.2.3, 13.2.2.2.4, 13.2.3 and 13.2.4.\nCommunication release in the LMR system is out of scope of 3GPP.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_14.2.2.1",
      "section_id": "14.2.2.1",
      "section_title": "Originating participating MCData function procedures",
      "content": "If the IWF performing the participating MCData role determines that an Enhanced Status message needs to be sent on behalf of a participant homed in the IWF then it:\n1)\tshall use the \"id\" attribute of the selected operation value from <mcdata-enhanced-status-operational-values> element under <list-service> element as defined in 3GPP TS 24.481 [31], to generate a group standalone SDS message using the procedures described in clause 9.2.2.3.1.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.2.3.1",
        "ts_24.481"
      ]
    },
    {
      "chunk_id": "ts_29.582_14.2.2.2",
      "section_id": "14.2.2.2",
      "section_title": "Terminating participating MCData function procedures",
      "content": "Upon receipt of a \"SIP MESSAGE request for standalone SDS for terminating participating MCData function\", the IWF performing the participating MCData role should follow the procedure described in clause 9.2.2.3.2.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.2.3.2"
      ]
    },
    {
      "chunk_id": "ts_29.582_14.2.3.1",
      "section_id": "14.2.3.1",
      "section_title": "Originating controlling MCData function procedures",
      "content": "If the IWF performing the controlling MCData role determines that an Enhanced Status message needs to be sent on behalf of a participant homed in the IWF then it follows the procedure described in clause 9.2.2.4.1.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.2.4.1"
      ]
    },
    {
      "chunk_id": "ts_29.582_14.2.3.2",
      "section_id": "14.2.3.2",
      "section_title": "Terminating controlling MCData function procedures",
      "content": "Upon receipt of a \"SIP MESSAGE request for standalone SDS for controlling MCData function\", the IWF performing the controlling MCData role should follow the procedure described in clause 9.2.2.4.2.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_9.2.2.4.2"
      ]
    },
    {
      "chunk_id": "ts_29.582_15.1.1",
      "section_id": "15.1.1",
      "section_title": "General",
      "content": "The following clauses describe the MCData message functional definitions and contents. Each message consists of a series of information elements. The standard format of an MCData message and the encoding rules for each type of information element follow that defined for the MCPTT Off-Network Protocol (MONP) as documented in annex I of 3GPP TS 24.379 [81].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.379"
      ]
    },
    {
      "chunk_id": "ts_29.582_15.1.2.1",
      "section_id": "15.1.2.1",
      "section_title": "Message definition",
      "content": "This message is sent by the MCData client towards a participant homed in the IWF via the network and from the IWF towards MCData clients when sending an SDS data payload. This message provides the signalling content related to the SDS data payload. For the contents of the message see Table 15.1.2.1-1.\nMessage type:\tSDS SIGNALLING PAYLOAD\nDirection:\t\tMCData server to IWF and IWF to MCData server\nTable 15.1.2.1-1: SDS SIGNALLING PAYLOAD message content\nIEI\nInformation Element\nType/Reference\nPresence\nFormat\nLength\nSDS signalling payload message identity\nMessage type15.2.2\nM\nV\n1\nDate and time\nDate and time3GPP TS 24.282 [82] clause 15.2.8\nM\nV\n5\nConversation ID\nConversation ID\n3GPP TS 24.282 [82] clause 15.2.9\nM\nV\n16\nMessage ID\nMessage ID15.2.10\nM\nV\n16\n21\nInReplyTo message ID\nInReplyTo message ID3GPP TS 24.282 [82] clause 15.2.11\nO\nTV\n17\n22\nApplication ID\nApplication ID\n3GPP TS 24.282 [82] clause 15.2.7\nO\nTV\n2\n8-\nSDS disposition request type\nSDS disposition request type3GPP TS 24.282 [82] clause 15.2.3\nO\nTV\n1\n7D\nExtended application ID\nExtended application ID3GPP TS 24.282 [82] clause 15.2.24\nO\nTLV-E\n3-x",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.282_clause_15.2.8",
        "ts_24.282_clause_15.2.9",
        "ts_24.282_clause_15.2.11",
        "ts_24.282_clause_15.2.7",
        "ts_24.282_clause_15.2.3",
        "ts_24.282_clause_15.2.24",
        "table_15.1.2.1-1",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_15.1.3",
      "section_id": "15.1.3",
      "section_title": "FD SIGNALLING PAYLOAD message",
      "content": "The IWF does not support the FD SIGNALLING PAYLOAD message.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_15.1.4.1",
      "section_id": "15.1.4.1",
      "section_title": "Message definition",
      "content": "This message is sent by the MCData client towards a participant homed in the IWF via the network and from the IWF towards MCData clients when sending an SDS data payload. This message provides the data to be delivered to the user or application. For the contents of the message see Table 15.1.4.1-1.\nMessage type:\tDATA PAYLOAD\nDirection:\t\tMCData server to IWF and IWF to MCData server\nTable 15.1.4.1-1: DATA PAYLOAD message content\nIEI\nInformation Element\nType/Reference\nPresence\nFormat\nLength\nData payload message identity\nMessage type15.2.2\nM\nV\n1\nNumber of payloads\nNumber of payloads3GPP TS 24.282 [82] clause 15.2.12\nM\nV\n1\n7A\nSecurity parameters and Payload\nMCData Protected Payload message\n3GPP TS 33.180 [78]\nO\nTLV-E\n32-x\n78\nPayload\nPayload\n15.2.13\nO\nTLV-E\n3-x\nNOTE 1:\tThe Number of payloads IE dictates the number of Payload IEs that are included in the message by the sender. Multiple Payload IEs can be part of Security parameters and Payload IE if end-to-end security is required.\nNOTE 2:\tIf end-to-end security is required for a one-to-one communication, Security parameters and Payload IE is included. Otherwise, if end-to-end security is not required for a one-to-one communication, Payload IE is included. For group communication, Payload IE is included.\nNOTE 3:\tFormatting of payloads as part of the Security parameters and Payload IE is specified in clause 15.2.13.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.282_clause_15.2.12",
        "clause_15.2.13",
        "table_15.1.4.1-1",
        "ts_24.282",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.582_15.1.5.1",
      "section_id": "15.1.5.1",
      "section_title": "Message definition",
      "content": "This message is sent by the MCData client towards a participant homed in the IWF via the network and from the IWF towards MCData clients to share SDS disposition information. For the contents of the message see Table 15.1.5.1-1.\nMessage type:\tSDS NOTIFICATION\nDirection:\t\tMCData server to IWF and IWF to MCData server\nTable 15.1.5.1-1: SDS NOTIFICATION message content\nIEI\nInformation Element\nType/Reference\nPresence\nFormat\nLength\nSDS notification message identity\nMessage type15.2.2\nM\nV\n1\nSDS disposition notification type\nSDS disposition notification type3GPP TS 24.282 [82] clause 15.2.5\nM\nV\n1\nDate and time\nDate and time3GPP TS 24.282 [82] clause 15.2.8\nM\nV\n5\nConversation ID\nConversation ID\n3GPP TS 24.282 [82] clause 15.2.9\nM\nV\n16\nMessage ID\nMessage ID15.2.10\nM\nV\n16\n22\nApplication ID\nApplication ID\n3GPP TS 24.282 [82] clause 15.2.7\nO\nTV\n2\n7D\nExtended application ID\nExtended application ID3GPP TS 24.282 [82] clause 15.2.24\nO\nTLV-E\n3-x",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.282_clause_15.2.5",
        "ts_24.282_clause_15.2.8",
        "ts_24.282_clause_15.2.9",
        "ts_24.282_clause_15.2.7",
        "ts_24.282_clause_15.2.24",
        "table_15.1.5.1-1",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_15.1.6",
      "section_id": "15.1.6",
      "section_title": "FD NOTIFICATION message",
      "content": "The IWF does not support the FD NOTIFICATION message.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_15.1.7",
      "section_id": "15.1.7",
      "section_title": "SDS OFF-NETWORK MESSAGE",
      "content": "The IWF does not support the SDS OFF-NETWORK MESSAGE.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_15.1.8",
      "section_id": "15.1.8",
      "section_title": "SDS OFF-NETWORK NOTIFICATION message",
      "content": "The IWF does not support the SDS OFF-NETWORK NOTIFICATION message.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_15.1.9",
      "section_id": "15.1.9",
      "section_title": "FD NETWORK NOTIFICATION message",
      "content": "The IWF does not support the FD NETWORK NOTIFICATION message.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_15.1.10.1",
      "section_id": "15.1.10.1",
      "section_title": "Message definition",
      "content": "In this clause the term \"MCData server\" can apply to an MCData server or an IWF performing the role of an MCData server.\nThis message is sent by the MCData server to an MCData client or a participant homed in the IWF to indicate about an intention to release the MCData communication. This message is also sent by the MCData client or the IWF to the MCData server to request extension for the MCData communication. The MCData server responds back to the request using this message. For the contents of the message see Table 15.1.10.1-1.\nMessage type:\tCOMMUNICATION RELEASE\nDirection:\t\tMCData server to the IWF and IWF to MCData server\nTable 15.1.10.1-1: COMMUNICATION RELEASE message content\nIEI\nInformation Element\nType/Reference\nPresence\nFormat\nLength\nComm Release message identity\nMessage type15.2.2\nM\nV\n1\nComm Release Information type\nComm Release Information type3GPP TS 24.282 [82] clause 15.2.20\nM\nV\n1\nB-\nData query type\nData query type3GPP TS 24.282 [82] clause 15.2.19\nO\nTV\n1\nC-\nExtension response type\nExtension response type\n3GPP TS 24.282 [82] clause 15.2.21\nO\nTV\n1",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.282_clause_15.2.20",
        "ts_24.282_clause_15.2.19",
        "ts_24.282_clause_15.2.21",
        "table_15.1.10.1-1",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_15.1.11",
      "section_id": "15.1.11",
      "section_title": "DEFERRED DATA REQUEST message",
      "content": "The IWF does not support the DEFERRED DATA REQUEST message.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_15.1.12",
      "section_id": "15.1.12",
      "section_title": "DEFERRED DATA RESPONSE message",
      "content": "The IWF does not support the DEFERRED DATA RESPONSE message.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_15.1.13",
      "section_id": "15.1.13",
      "section_title": "FD HTTP TERMINATION",
      "content": "The IWF does not support the FD HTTP TERMINATION message.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_15.2.1",
      "section_id": "15.2.1",
      "section_title": "General",
      "content": "The message format and bit ordering used within the present document are as defined in clause 15.2.1 of 3GPP TS 24.282 [82].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.282_clause_15.2.1",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_15.2.2",
      "section_id": "15.2.2",
      "section_title": "Message type",
      "content": "The purpose of the Message type information element is to identify the type of the message.\nThe IWF shall support the following Message types as defined in clause 15.2.2 of 3GPP TS 24.282 [82]:\n-\tSDS SIGNALING PAYLOAD;\n-\tDATA PAYLOAD;\n-\tSDS NOTIFICATION;\n-\tCOMMUNICATION RELEASE.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_24.282_clause_15.2.2",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_15.2.9",
      "section_id": "15.2.9",
      "section_title": "Conversation ID",
      "content": "The Conversation ID information element uniquely identifies the conversation.\nThe Conversation ID information element is coded as shown in Figure 15.2.9-1 and Table 15.2.9-1.\nThe Conversation ID information element is a type 3 information element with a length of 16 octets.\n8\n7\n6\n5\n4\n3\n2\n1\nConversation ID value\noctet 1\n…\noctet 16\nFigure 15.2.9-1: Conversation ID value\nTable 15.2.9-1: Conversation ID value\nConversation identifier value (octet 1 to 16)\nThe Conversation ID contains a number uniquely identifying the conversation. The value is a universally unique identifier as specified in IETF RFC 4122 [67] with the exception of the following designated value shown in Table 15.2.9-2, denoted \"UNKNOWN CONVERSATION\".\nTable 15.2.9-2: Conversation ID value \"UNKNOWN CONVERSATION\"\n8\n7\n6\n5\n4\n3\n2\n1\n0\n0\n0\n0\n0\n0\n0\n0\noctet 1\n…\noctet 16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0",
      "chunk_type": "general",
      "cross_references": [
        "table_15.2.9-1",
        "table_15.2.9-2",
        "figure_15.2.9-1"
      ]
    },
    {
      "chunk_id": "ts_29.582_15.2.10",
      "section_id": "15.2.10",
      "section_title": "Message ID",
      "content": "The Message ID information element uniquely identifies a message within a conversation.\nThe Message ID information element is coded as shown in Figure 15.2.10-1 and Table 15.2.10-1.\nThe Message ID information element is a type 3 information element with a length of 16 octets.\n8\n7\n6\n5\n4\n3\n2\n1\nMessage ID value\noctet 1\n…\noctet 16\nFigure 15.2.10-1: Message ID value\nTable 15.2.10-1: Message ID value\nMessage ID value (octet 1 to 16)\nThe Message ID contains a number uniquely identifying a message. The value is a universally unique identifier as specified in IETF RFC 4122 [67] with the exception of the designated value \"UNKNOWN ORIGINATING MESSAGE ID\" and \"LMR MESSAGE ID\" shown in Tables 15.2.10-2 and 15.2.10‑3, where 'x' represents a variable value.\nTable 15.2.10-2: Message ID value \"UNKNOWN ORIGINATING MESSAGE ID\"\n8\n7\n6\n5\n4\n3\n2\n1\n0\n0\n0\n0\n0\n0\n0\n0\noctet 1\n…\noctet 16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nTable 15.2.10-3: Message ID value \"LMR MESSAGE ID\"\n8\n7\n6\n5\n4\n3\n2\n1\n1\n1\n1\n1\n1\n1\n1\n1\noctet 1\n…\noctet 15\noctet 16\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\nx\nx\nx\nx\nx\nx\nx\nx",
      "chunk_type": "general",
      "cross_references": [
        "table_15.2.10-1",
        "table_15.2.10-2",
        "table_15.2.10-3",
        "figure_15.2.10-1"
      ]
    },
    {
      "chunk_id": "ts_29.582_15.2.13",
      "section_id": "15.2.13",
      "section_title": "Payload",
      "content": "The Payload information element contains the payload intended for the recipient user or application;\nThe Payload information element is coded as shown in Figure 15.2.13-1, Table 15.2.13-1, Table 15.2.13-2, Table 15.2.13-3 and Table 15.2.13-4.\nThe Payload information element is a type 6 information element.\n8\n7\n6\n5\n4\n3\n2\n1\nPayload IEI\noctet 1\nLength of Payload contents\noctet 2\noctet 3\noctet 4\nPayload contents\noctet n\nFigure 15.2.13-1: Payload information element\nTable 15.2.13-1: Payload contents\n8\n7\n6\n5\n4\n3\n2\n1\nPayload content type\noctet 4\noctet 5\nPayload data\noctet n\nTable 15.2.13-2: Payload content type\nBits\n8\n7\n6\n5\n4\n3\n2\n1\n0\n0\n0\n0\n0\n1\n1\n1\nLMR MESSAGE (NOTE)\nAll other values and types are as defined in 3GPP TS 24.282 [82] clause 15.2.13.\nNOTE:\tThe LMR MESSAGE format identifies the payload content as a native LMR format message for transport between LMR aware endpoints as per 3GPP TS 23.283 [80]\nTable 15.2.13-3: Payload data\nPayload data is included in octet 5 to octet n; Max value of 65535 octets.\nPayload data contains the payload destined for the user or application.\nA file URL is encoded as specified in IETF RFC 1738 [86].\nThe length of location information payload content is 6 bytes. First 3 bytes contain the latitude information and next 3 bytes contain the longitude information.\nIf the Payload content type is \"LMR MESSAGE\" then the first octet of the payload data is encoded as specified in Table 15.2.13-4.\nTable 15.2.13-4: First octet of Payload data for LMR MESSAGE Payload content type\nBits\n8\n7\n6\n5\n4\n3\n2\n1\n0\n0\n0\n0\n0\n0\n0\n1\nP25\n0\n0\n0\n0\n0\n0\n1\n0\nTETRA\nAll other values are reserved.",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.282_clause_15.2.13",
        "table_15.2.13-1",
        "table_15.2.13-2",
        "table_15.2.13-3",
        "table_15.2.13-4",
        "ts_23.283_table_15.2.13-3",
        "figure_15.2.13-1",
        "ts_24.282",
        "ts_23.283"
      ]
    },
    {
      "chunk_id": "ts_29.582_16",
      "section_id": "16",
      "section_title": "Media plane",
      "content": "No media plane procedures are specified in the present document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_17.1.1",
      "section_id": "17.1.1",
      "section_title": "IWF originates Interworking Security Data message",
      "content": "Upon deciding to send an Interworking Security Data message, the IWF:\n1)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [4] and IETF RFC 3428 [33];\n2)\tshall include an Accept-Contact header field containing the g.3gpp.mcdata.sds media feature tag along with the \"require\" and \"explicit\" header field parameters according to IETF RFC 3841 [6];\n3)\tshall include an Accept-Contact header field with the media feature tag g.3gpp.icsi-ref with the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" along with parameters \"require\" and \"explicit\" according to IETF RFC 3841 [6];\n4)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-request-uri> element set to the value of the MCData ID of the targeted MCData user; and\n5)\tshall include the ICSI value \"urn:urn-7:3gpp-service.ims.icsi.mcdata\" (coded as specified in 3GPP TS 24.229 [4]), in a P-Asserted-Service-Id header field according to IETF RFC 6050 [9];\n6)\tshall set the Request-URI to the address of the terminating participating function associated with the MC service ID of the targeted MC service user;\n7)\tshall include a P-Asserted-Identity header field set to the public service identity of the IWF;\n8)\tshall include an application/vnd.3gpp.interworking-data MIME body with the Interworking Security Data message payload as defined in clause 17.2.1;\n9)\tif a security context between the MCData client and the IWF needs to be established and the security context does not exist or if the existing security context has expired, procedures in clause 11.2.2 in 3GPP TS 33.180 [78] shall be followed; and\n10)\tsend the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [4].",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_17.2.1",
        "ts_33.180_clause_11.2.2",
        "ts_24.229",
        "ts_33.180"
      ]
    },
    {
      "chunk_id": "ts_29.582_17.1.2",
      "section_id": "17.1.2",
      "section_title": "IWF receives Interworking Security Data message",
      "content": "Upon receiving a \"SIP MESSAGE request for Interworking Security Data message for participating function\", the actions performed by the IWF are out of scope of the present document. The received message, described in clause 17.2, contains an opaque payload, the contents of which are out out of scope of the present document.",
      "chunk_type": "general",
      "cross_references": [
        "clause_17.2"
      ]
    },
    {
      "chunk_id": "ts_29.582_17.2.1",
      "section_id": "17.2.1",
      "section_title": "Message definition",
      "content": "This clause specifies the payload to be used when sending an Interworking Security Data message between the IWF and MCData clients. The Interworking Security Data (InterSD) message is defined as a MONP message.\nMessage type:\tInterSD-MESSAGE\nDirection:\t\tIWF to MCData client, MCData client to IWF\nTable 17.2.1-1: Interworking Security Data message content\nIEI\nInformation Element\nType/Reference\nPresence\nFormat\nLength\nSDS signalling payload message identity\nMessage type3GPP TS 24.282 [82]\nM\nV\n1\nExternal network type\n17.2.2\nM\nV\n1\n7D\nURI of LMR key management functional entity\nURI encoded as specified in IETF RFC 3986 [46]\nO\nTLV-E\n3-x\n78\nPayload\n3GPP TS 24.282 [82], clause 15.2.13 with Payload content type set to 'BINARY'\nO\nTLV-E\n3-x",
      "chunk_type": "definition",
      "cross_references": [
        "ts_24.282_clause_15.2.13",
        "table_17.2.1-1",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_17.2.2",
      "section_id": "17.2.2",
      "section_title": "External network type",
      "content": "The purpose of the external network type information element is to identify the type of the network represented by the IWF.\nThe value part of the external network type information element is coded as shown in Table 17.2.2-1.\nThe external network type information element is a type 3 information element with a length of 1 octet.\nTable 17.2.2-1: External network type\nBits\n8\n7\n6\n5\n4\n3\n2\n1\n0\n0\n0\n0\n0\n0\n0\n1\nP25\n0\n0\n0\n0\n0\n0\n1\n0\nTETRA\nAll other values are reserved.",
      "chunk_type": "general",
      "cross_references": [
        "table_17.2.2-1"
      ]
    },
    {
      "chunk_id": "ts_29.582_18.1.1",
      "section_id": "18.1.1",
      "section_title": "IWF to send SIP MESSAGE request for emergency notification",
      "content": "When the IWF performing originating participating role needs to send a SIP MESSAGE request for emergency notification, the IWF:\n1)\tvoid;\n2)\tvoid\n3)\tif the MCData ID for which the SIP MESSAGE is sent is not affiliated with the MCData group as determined by clause 8.3.2.11 shall perform the actions specified in clause 8.3.2.12 for implicit affiliation;\n4)\tif the actions for implicit affiliation specified in step 3) above were performed but not successful, shall skip the rest of the steps.\n5)\tshall determine the public service identity of the controlling MCData function associated with the group identity in the received request for emergency notification;\n6)\tshall generate a SIP MESSAGE request in accordance with 3GPP TS 24.229 [4] and IETF RFC 3428 [33];\n7)\tshall set the Request-URI of the outgoing SIP MESSAGE request to the public service identity of the controlling MCData function associated with the MCData group;\n8)\tshall include an application/vnd.3gpp.mcdata-info+xml MIME body as specified in 3GPP TS 24.282 [82], clause D.1 in the outgoing SIP MESSAGE request based on information received from the originating LMR user and its network entities;\n9)\tshall set the <mcdata-calling-user-id> element of the <mcdatainfo> element containing the <mcdata-Params> element to the MCData ID of the user homed in the IWF;\n10)\tif location information is available in the received request for emergency notification, include an application/vnd.3gpp.mcdata-location-info+xml MIME body as specified in 3GPP TS 24.282 [82], clause D.4 in the outgoing SIP MESSAGE request;\n11)\tshall set the P-Asserted-Identity in the outgoing SIP MESSAGE request to the public service identity of the IWF; and\n12)\tshall send the SIP MESSAGE request as specified in 3GPP TS 24.229 [4].\nUpon receipt of a SIP 2xx response to the SIP MESSAGE request:\n1)\tif the procedures of clause 8.3.2.12 for implicit affiliation were performed in the present clause, shall complete the implicit affiliation by performing the procedures of clause 8.3.2.13.\nUpon receipt of a SIP 4xx, 5xx or 6xx response to the sent SIP MESSAGE request and if the implicit affiliation procedures of clause 8.3.2.12 were invoked in the present clause, the IWF shall perform the procedures of clause 8.3.2.14.",
      "chunk_type": "general",
      "cross_references": [
        "clause_8.3.2.11",
        "clause_8.3.2.12",
        "clause_8.3.2.13",
        "clause_8.3.2.14",
        "ts_24.229",
        "ts_24.282"
      ]
    },
    {
      "chunk_id": "ts_29.582_18.1.2",
      "section_id": "18.1.2",
      "section_title": "Receipt of a SIP MESSAGE request for emergency notification for terminating LMR user",
      "content": "In the procedures in this clause:\n1)\temergency indication in an incoming SIP MESSAGE request refers to the <emergency-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body; and\n2)\talert indication in an incoming SIP MESSAGE request refers to the <alert-ind> element of the application/vnd.3gpp.mcdata-info+xml MIME body.\nUpon receipt of a \"SIP MESSAGE request for emergency notification for terminating participating MCData function\", the IWF performing the participating role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The IWF performing the participating role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [24] and skip the rest of the steps;\nNOTE 1:\tif the SIP MESSAGE request contains an emergency indication set to a value of \"true\" or an alert indication set to a value of \"true\", the IWF can by means beyond the scope of this specification choose to accept the request.\n2)\tshall use the MCData ID present in the <mcdata-request-uri> element of the application/vnd.3gpp.mcdata-info+xml MIME body of the incoming SIP MESSAGE request to determine the terminating target; and\n3)\tif the terminating target is not served by the IWF the IWF shall reject the SIP MESSAGE request with a SIP 404 (Not Found) response.\nNOTE 2:\tLMR specific signalling is outside the scope of this specification.\nThe IWF shall generate s SIP 2xx response and follow the procedures specified in 3GPP TS 24.229 [4].",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_18.1.3",
      "section_id": "18.1.3",
      "section_title": "Receipt of a SIP MESSAGE request indicating successful delivery of emergency notification",
      "content": "Upon receipt of an indication for successful delivery of an emergency notification, internal actions performed by the IWF performing the terminating participating role are out of scope of the present document.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.582_18.2.1",
      "section_id": "18.2.1",
      "section_title": "Handling of a SIP MESSAGE request for emergency notification",
      "content": "Upon receipt of a \"SIP MESSAGE request for emergency notification for controlling MCData function\", the IWF performing the controlling role:\n1)\tif unable to process the request due to a lack of resources or a risk of congestion exists, may reject the SIP MESSAGE request with a SIP 500 (Server Internal Error) response. The IWF performing the controlling role may include a Retry-After header field to the SIP 500 (Server Internal Error) response as specified in IETF RFC 3261 [24]. Otherwise, continue with the rest of the steps;\nNOTE:\tIf the SIP MESSAGE request contains an alert indication set to a value of \"true\", the IWF performing the controlling role can, according to local policy, choose to accept the request.\n2)\tshall reject the SIP request with a SIP 403 (Forbidden) response and not process the remaining steps if an Accept-Contact header field does not include the g.3gpp.icsi-ref media feature tag containing the value of \"urn:urn-7:3gpp-service.ims.icsi.mcdata\", \"urn:urn-7:3gpp-service.ims.icsi.mcdata.sds\" or \"urn:urn-7:3gpp-service.ims.icsi.mcdata.fd\";\n3)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <alert-ind> element set to a value of \"false\", shall perform the procedures specified in clause X.2.2 and skip the rest of the steps; and\n4)\tif the received SIP MESSAGE request contains an application/vnd.3gpp.mcdata-info+xml MIME body with the <alert-ind> element set to a value of \"true\":\na)\tif the received SIP MESSAGE request is an unauthorised request for an MCData emergency alert as specified in 3GPP TS 24.282 [82] clause 6.3.7.2.1 shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request as specified in 3GPP TS 24.229 [4] with the following clarifications:\ni)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcdata-info+xml MIME body as specified in 3GPP TS 24.282 [82], clause D.1 of 3GPP TS 24.282 [82] with the <mcdatainfo> element containing the <mcdata-Params> element with the <alert-ind> element set to a value of \"false\"; and\nii)\tshall send the SIP 403 (Forbidden) response as specified in 3GPP TS 24.229 [4] and skip the rest of the steps; and\nb)\tif the received SIP MESSAGE request is an authorised request for an MCData emergency alert as specified in 3GPP TS 24.282 [82] clause 6.3.7.2.1:\ni)\tif the sending MCData user identified by the <mcdata-calling-user-id> element included in the application/vnd.3gpp.mcdata-info+xml MIME body is not affiliated with the MCData group identified by the <mcdata-request-uri> element of the MIME body as determined by the procedures of clause 6.3.5:\nI)\tshall check if the MCData user is eligible to be implicitly affiliated with the MCData group as determined by clause 8.3.3.6;\nII)\tif the MCData user is determined not to be eligible to be implicitly affiliated to the MCData group shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response with the warning text set to \"120 user is not affiliated to this group\" in a Warning header field as specified in clause 4.7 and skip the rest of the steps below; or\nIII)\tif the procedures of clause 8.3.3.6 determined the MCData user to be eligible to be implicitly affiliated to the MCData group shall, perform the implicit affiliation as specified in clause 8.3.3.7;\nii)\tfor each of the other affiliated members of the group:\nA)\tgenerate an outgoing SIP MESSAGE request notification of the MCData user's emergency alert indication as specified in 3GPP TS 24.282 [82], clause 6.3.7.1.2, with the IWF acting as the controlling MCData function, with the clarifications of clause 6.3.7.1.3;\nB)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-calling-user-id> element set to the value of the <mcdata-calling-user-id> element in the received SIP MESSAGE request; and\nC)\tsend the SIP MESSAGE request according to according to rules and procedures of 3GPP TS 24.229 [4];\niii)\tshall generate a SIP 200 (OK) response to the received SIP MESSAGE request as specified in 3GPP TS 24.229 [4] with the following clarifications:\nA)\tshall cache the information that the MCData user has initiated an MCData emergency alert;\niv)\tshall send the SIP 200 (OK) response to the received SIP MESSAGE according to rules and procedures of 3GPP TS 24.229 [4].\nv)\tshall generate a SIP MESSAGE request as described in 3GPP TS 24.282 [82], clause 6.3.7.1.5, with the IWF acting as the controlling MCData function, to indicate successful receipt of an emergency alert, and shall include in the application/vnd.3gpp.mcdata-info+xml MIME body:\nA)\tthe <alert-ind> element set to a value of \"true\";\nB)\tthe <alert-ind-rcvd> element set to a value of true; and\nC)\tthe <mcdata-client-id> element with the MCData client ID that was included in the incoming SIP MESSAGE request; and\nvi)\tshall send the SIP MESSAGE request according to according to rules and procedures of 3GPP TS 24.229 [4].\nUpon receipt of SIP 2xx responses to the outgoing SIP MESSAGE requests, the IWF performing the controlling role shall follow the procedures specified in 3GPP TS 24.229 [4].",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.282_clause_6.3.7.2.1",
        "clause_6.3.5",
        "clause_8.3.3.6",
        "clause_4.7",
        "clause_8.3.3.7",
        "ts_24.282_clause_6.3.7.1.2",
        "clause_6.3.7.1.3",
        "ts_24.282_clause_6.3.7.1.5",
        "ts_24.282",
        "ts_24.229"
      ]
    },
    {
      "chunk_id": "ts_29.582_18.2.2",
      "section_id": "18.2.2",
      "section_title": "Handling of a SIP MESSAGE request for emergency alert cancellation",
      "content": "Upon receipt of a \"SIP MESSAGE request for emergency notification for controlling MCData function\" containing an application/vnd.3gpp.mcdata-info+xml MIME body with the <alert-ind> element set to a value of \"false\", the IWF performing the controlling role:\n1)\tif the received SIP MESSAGE request is an unauthorised request for an MCData emergency alert cancellation as specified in 3GPP TS 24.282 [82] clause 6.3.7.2.2\na)\tand if the received SIP MESSAGE request does not contain an <emergency-ind> element or is an unauthorised request for an MCData emergency call cancellation as specified in 3GPP TS 24.282 [82] clause 6.3.7.2.3, shall reject the SIP MESSAGE request with a SIP 403 (Forbidden) response to the SIP MESSAGE request as specified in 3GPP TS 24.229 [4] with the following clarifications:\ni)\tshall include in the SIP 403 (Forbidden) response an application/vnd.3gpp.mcdata-info+xml MIME body as specified in 3GPP TS 24.282 [82] clause D.1 with the <mcdatainfo> element containing the <mcdata-Params> element with the <alert-ind> element set to a value of \"true\";\nii)\tif the received SIP MESSAGE request contains an <emergency-ind> element of the <mcdatainfo> element set to a value of \"false\" and if the in-progress emergency state of the group is set to a value of \"true\" and this is an unauthorised request for an MCData emergency communication cancellation as determined in step i) above, shall include an <emergency-ind> element set to a value of \"true\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the SIP 403 (Forbidden) response; and\niii)\tshall send the SIP 403 (Forbidden) response according to rules and procedures of 3GPP TS 24.229 [4] and skip the rest of the steps; and\nb)\tand if the received SIP MESSAGE request contains an <emergency-ind> element and is an authorised request for an MCData emergency call cancellation as specified in 3GPP TS 24.282 [82] clause 6.3.7.2.3 and the in-progress emergency state of the MCData group is set to a value of \"true\":\ni)\tshall set the in-progress emergency state of the group to a value of \"false\";\nii)\tshall clear the cache of the MCData ID of the MCData user that triggered the setting of the in-progress emergency state of the MCData group to \"true\";\niii)\tshall generate SIP re-INVITE request to the other affiliated and joined members of the MCData group as specified in 3GPP TS 24.282 [82] clause 6.3.7.1.1. The IWF performing the controlling role:\nA)\tfor each affiliated and joined member shall send the SIP re-INVITE request towards the MCData client as specified in 3GPP TS 24.229 [4]; and\niv)\tfor each of the affiliated but not joined members of the group:\nA)\tgenerate a SIP MESSAGE request notification of the cancellation of the MCData user's emergency call as specified in 3GPP TS 24.282 [82], clause 6.3.7.1.2 with the IWF acting as the controlling MCData function;\nB)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-calling-user-id> element set to the value of the <mcdata-calling-user-id> element in the received SIP MESSAGE request;\nC)\tshall include an <emergency-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request; and\nD)\tsend the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [4];\nv)\tshall generate a SIP 200 (OK) response to the received SIP MESSAGE request as specified in 3GPP TS 24.229 [4];\nvi)\tshall send the SIP 200 (OK) response to the received SIP MESSAGE as specified in 3GPP TS 24.229 [4] and skip the rest of the steps;\nvii)\tshall generate a SIP MESSAGE request as described in 3GPP TS 24.282 [82], clause 6.3.7.1.5 with the IWF acting as the controlling MCData function to indicate successful receipt of the request for emergency alert cancellation\nviii)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body of the SIP MESSAGE request:\nA)\tthe <alert-ind> element set to a value of \"true\";\nB)\tthe <alert-ind-rcvd> element set to a value of true;\nC)\tthe <emergency-ind> element set to a value of \"false\"; and\nD)\tthe <mcdata-client-id> element with the MCData client ID that was included in the incoming SIP MESSAGE request; and\nix)\tshall send the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [4]; and\n2)\tif the received SIP MESSAGE request is an authorised request for an MCData emergency alert cancellation as specified in 3GPP TS 24.282 [82] clause 6.3.7.2.2:\na)\tif the received SIP MESSAGE request contains an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, shall clear the cache of the MCDataID of the MCData user identified by the <originated-by> element as having an outstanding MCData emergency alert;\nb)\tif the received SIP MESSAGE request does not contain an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, clear the cache of the MCData ID of the sender of the SIP MESSAGE request as having an outstanding MCData emergency alert;\nc)\tif the received SIP MESSAGE request does not contain an <emergency-ind> element or is an unauthorised request for an MCData emergency communication cancellation as specified in 3GPP TS 24.282 [82] clause 6.3.7.2.3, for each of the affiliated but not joined members of the group:\ni)\tshall generate a SIP MESSAGE \"SIP MESSAGE request for emergency notification for terminating participating MCData function\" to cancel the MCData user's emergency alert as specified in 3GPP TS 24.282 [82], clause 6.3.7.1.2 with the IWF acting as the controlling MCData function;\nii)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-calling-user-id> element set to the value of the <mcdata-calling-user-id> element in the received SIP MESSAGE request;\niii)\tif the received SIP MESSAGE request contains an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, shall copy the contents of the received <originated-by> element to an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request;\niv)\tshall include an <alert-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request; and\nv)\tsend the SIP MESSAGE request as specified in 3GPP TS 24.229 [4];\nd)\tif the received SIP MESSAGE request contains an <emergency-ind> element and is an authorised request for an MCData emergency communication cancellation as specified in 3GPP TS 24.282 [82], clause 6.3.7.2.3 and the in-progress emergency state of the MCData group is set to a value of \"true\":\ni)\tshall set the in-progress emergency state of the group to a value of \"false\";\nii)\tcache the information that the MCData user has cancelled the outstanding in-progress emergency state of the group;\niii)\tshall generate SIP re-INVITES requests to the other affiliated and joined members of the MCData group as specified in 3GPP TS 24.282 [82], clause 6.3.7.1.1 with theIWF acting as the MCData controlling function:\nA)\tfor each affiliated and joined member shall send the SIP re-INVITE request towards the MCData client as specified in 3GPP TS 24.229 [4]; and\niv)\tfor each of the affiliated but not joined members of the group shall:\nA)\tgenerate a SIP MESSAGE request notification of the cancellation of the MCData user's emergency call as specified in 3GPP TS 24.282 [82], clause 6.3.7.1.2 with the IWF acting as the controlling MCData function;\nB)\tinclude in the application/vnd.3gpp.mcdata-info+xml MIME body with the <mcdatainfo> element containing the <mcdata-Params> element with the <mcdata-calling-user-id> element set to the value of the <mcdata-calling-user-id> element in the received SIP MESSAGE request;\nC)\tif the received SIP MESSAGE request contains an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body, copy the contents of the received <originated-by> element to an <originated-by> element in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request;\nD)\tinclude in the application/vnd.3gpp.mcdata-info+xml MIME body an <alert-ind> element set to a value of \"false\";\nE)\tshall include an <emergency-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request; and\nF)\tsend the SIP MESSAGE request according to rules and procedures of 3GPP TS 24.229 [5];\ne)\tshall generate a SIP 200 (OK) response to the received SIP MESSAGE request as specified in 3GPP TS 24.229 [4];\nf)\tshall send the SIP 200 (OK) response to the received SIP MESSAGE as specified in 3GPP TS 24.229 [4].\ng)\tshall generate a SIP MESSAGE request as described in 3GPP TS 24.282 [82], clause 6.3.7.1.5 with the IWF acting as the controlling MCData function to indicate successful receipt of the request for emergency alert cancellation;\nh)\tshall include in the application/vnd.3gpp.mcdata-info+xml MIME body, the <alert-ind> element set to a value of \"false\" and the <alert-ind-rcvd> set to \"true\";\ni)\tshall populate the <mcdata-client-id> element with the MCData client ID that was included in the incoming SIP MESSAGE request;\nj)\tif the received SIP MESSAGE request contains an <emergency-ind> element of the <mcdatainfo> element set to a value of \"false\"; and\ni)\tif this is an authorised request for an MCData emergency communication cancellation as specified in 3GPP TS 24.282 [82], clause 6.3.7.2.3, shall include an <emergency-ind> element set to a value of \"false\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request; and\nii)\totherwise, if this is an unauthorised request for an MCData emergency communication cancellation as specified in 3GPP TS 24.282 [82], clause 6.3.7.2.3, and the in-progress emergency state of the group is set to a value of \"true\", shall include an <emergency-ind> element set to a value of \"true\" in the application/vnd.3gpp.mcdata-info+xml MIME body in the outgoing SIP MESSAGE request; and\nk)\tshall send the SIP MESSAGE request according to the rules and procedures of 3GPP TS 24.229 [4].\nUpon receipt of SIP 2xx responses to the outgoing SIP MESSAGE requests, the IWF performing the controlling role shall follow the procedures specified in 3GPP TS 24.229 [4].\nAnnex A (informative):Signalling flows\nAnnex B (normative):Timers\nAnnex C (normative):Counters\nAnnex D (normative):XML schemas\nD.1\tXML schema for transporting MCData identities and general services information\nD.1.1\tGeneral\nThis clause defines XML schema and MIME type for transporting MCData identities and general services information. The XML schema elements and behaviour defined in this clause extend those in 3GPP TS 24.282 [82] or other 3GPP technical specifications as noted.\nD.1.2\tXML schema\nThis schema is as described in 3GPP TS 24.282 [82] Annex D.1.2.\nD.1.3\tSemantic\nThe semantic is as described in 3GPP TS 24.282 [82] Annex D.1.3 with the following modifications:\nIf the <mcdatainfo> contains the <mcdata-Params> element then:\n1)\tthe <request-type> can be included with:\na)\ta value of \"one-to-one-sds\" to indicate that the MCData client wants to initiate a one-to-one SDS request;\nb)\ta value of \"group-sds\" to indicate the MCData client wants to initiate a group SDS request;\nc)\ta value of \"notify\" when the controlling MCData function needs to send a notification to the MCData client.\n2)\tthe <anyExt> element of the <mcdata-Params> element can be included with the following element in addition to those specified in 3GPP TS 24.282 [82] Annex D.1.3:\na)\ta <request-type> of type \"xs:string\": set to value of \"Interworking Security Data message\" when requesting an Interworking Security Data message.\nAnnex E (informative):Change history\nChange history\nDate\nMeeting\nTDoc\nCR\nRev\nCat\nSubject/Comment\nNew version\n2019-05\nInitial version\n0.0.1\n2019-10\nImplementation of the following P-CR from CT1#120: C1‑196237, C1‑196247, C1‑196250, C1‑196251, C1‑196252, C1‑196253, C1‑196633, C1‑196636, C1‑196637, C1‑196638, C1‑196639, C1‑196643, C1‑196644, C1‑196645, C1‑196647, C1‑196648, C1‑196670, C1‑196673, C1‑196676, C1‑196820, C1‑196821, C1‑196822, C1‑196824, C1‑196825, C1‑196826, C1‑196828, C1‑196830, C1‑196831, C1‑196868, C1‑196869, C1‑196871\n0.1.0\n2019-11\nImplementation of the following P-CR from CT1#121: C1‑198514\n0.2.0\n2019-12\nCT-86\nCP-193158\nPresentation for information at TSG CT\n1.0.0\n2019-12\nCT#86\nCP-193291\nA title updated\n1.0.1\n2020-03\nImplementation of the following pCRs from CT1#122e:\nC1-200369, C1-200370, C1-200371,C1-200912, C1-200913, C1-200946, C1-200948\n1.1.0\n2020-03\nCT-87e\nCP-200175\nPresentation for approval at TSG CT\n2.0.0\n2020-03\nCT-87e\nVersion 16.0.0 created after approval\n16.0.0\n2020-06\nCT-88e\nCP-201120\n0001\n1\nD\n16.1.0\n2020-09\nCT-89e\nCP-202161\n0002\n1\nF\nIntroduction of text for Scope clause\n16.2.0\n2020-09\nCT-89e\nCP-202180\n0003\nB\nAddition of clause 9.2.3.1 (Standalone SDS over media plane / general)\n17.0.0\n2020-09\nCT-89e\nCP-202180\n0004\n1\nB\nAddition of clauses 9.2.3.2.1, 9.2.3.2.2 (SDP Offer/Answer)\n17.0.0\n2020-09\nCT-89e\nCP-202180\n0005\n1\nB\nAddition of clauses 9.2.3.2.3 (Originating procedures)\n17.0.0\n2020-12\nCT-90e\nCP-203195\n0007\n1\nA\n17.1.0\n2020-12\nCT-90e\nCP-203198\n0010\n1\nB\nSDP\n17.1.0\n2020-12\nCT-90e\nCP-203260\n0011\n3\nB\n17.1.0\n2021-03\nCT-91e\nCP-210128\n0013\n1\nB\n17.2.0\n2022-03\nCT-95e\nCP-220230\n0015\n2\nA\nCorrection to Disposition Notification handling when LMR system temporarily disables Disposition Notification\n17.3.0\n2022-03\nCT-95e\nCP-220276\n0017\n1\nC\nCorrection of text table values for Payload Content Type\n17.3.0\n2022-03\nCT-95e\nCP-220276\n0018\n-\nB\nIntroduction of SDS interworking over the media plane\n17.3.0\n2023-03\nCT-99\nCP-230240\n0019\n2\nB\nIntroduction of Emergency Alert for MCData plane interworking\n17.4.0\n2023-06\nCT-100\nCP-231254\n0021\n1\nA\nWarning codes & warning text to handle interworking application mismatch\n17.5.0\n2024-04\n-\n-\n-\n-\n-\nUpdate to Rel-18 version (MCC)\n18.0.0",
      "chunk_type": "general",
      "cross_references": [
        "ts_24.282_clause_6.3.7.2.2",
        "ts_24.282_clause_6.3.7.2.3",
        "ts_24.282_clause_6.3.7.1.1",
        "ts_24.282_clause_6.3.7.1.2",
        "ts_24.282_clause_6.3.7.1.5",
        "clause_16.2.0",
        "clause_9.2.3.1",
        "ts_24.282",
        "ts_24.229"
      ]
    }
  ]
}
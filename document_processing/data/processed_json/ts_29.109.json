{
  "metadata": {
    "specification_id": "ts_29.109",
    "version": "18.0.0",
    "title": "3GPP TS 29.109",
    "file_path": "/content/drive/MyDrive/RAG_thesis/data/29_series/29109-i00/29109-i00.docx"
  },
  "export_info": {
    "export_date": "2025-07-26T09:13:35.856803",
    "total_chunks": 49
  },
  "chunks": [
    {
      "chunk_id": "ts_29.109_1",
      "section_id": "1",
      "section_title": "Scope",
      "content": "The present stage 3 specification defines the Diameter based implementation for bootstrapping Zh interface (BSF-HSS) and Dz interface (BSF-SLF) for HSS resolution for the BSF, the MAP based implementation for bootstrapping Zh' interface (BSF-HLR) and GAA Application Zn interface (BSF-NAF) in Generic Authentication Architecture (GAA). This specification also defines the Web Services based implementation for GAA Application Zn reference point (BSF-NAF). The definition contains procedures, message contents and coding. The procedures for bootstrapping and usage of bootstrapped security association are defined in 3GPP TS 33.220 [5].\nThe present document also specifies the Diameter and Web Services based implementation for the GAA Application Push Function Zpn reference point (BSF-NAF). The procedures for bootstrapping are defined in 3GPP TS 33.223 [23].\nThis specification is a part of the Generic Authentication Architecture (GAA) specification series.\nThe diameter based implementation for the Zh interface is based on re-usage of Cx interface Multimedia-Auth-Request/Answer messages originally between CSCF and HSS. These messages are defined in 3GPP TS 29.229 [3]. The 3GPP IMS mobility management uses the same definitions between CSCF and HSS. The present document defines how the defined messages are used with the bootstrapping and GAA application procedures (e.g. subscriber certificates) and the application logic that is needed in GAA network elements (BSF, HSS, and NAF).\nFigure 1.1 depicts the relationships of these specifications to the other specifications for the Diameter based implementations.\nFigure 1.1:  Relationships to other specifications\nFigure 1.2 provides an informal overall quick introduction to the whole signalling procedures in GAA system. The important identifiers are marked bold and optional data items are italicised. The Ub and Ua interfaces, not defined in this TS, are simplified.\nNOTE:\tThe Zh' interface (BSF-HLR) is not represented in this figure.\nFigure 1.2: The whole signalling procedure in GAA system\nFigure 1.3 provides an informal overall quick introduction to the whole signalling procedures in GAA Push Function. The important identifiers are marked bold and optional data items are italicised. The Ua and Upa interfaces, not defined in this TS, are simplified.\nFigure 1.3: Signalling procedure in GAA Bootstrapping Push Function",
      "chunk_type": "general",
      "cross_references": [
        "figure_1.1",
        "figure_1.2",
        "figure_1.3",
        "ts_33.220",
        "ts_33.223",
        "ts_29.229"
      ]
    },
    {
      "chunk_id": "ts_29.109_2",
      "section_id": "2",
      "section_title": "References",
      "content": "The following documents contain provisions that, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non‑specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies.  In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\tVoid.\n[2]\t3GPP TS 29.228: \"IP Multimedia (IM) Subsystem Cx and Dx Interfaces; Signalling flows and message contents\".\n[3]\t3GPP TS 29.229: \"Cx and Dx interfaces based on the Diameter protocol\".\n[4]\t3GPP TR 33.919 \"Generic Authentication Architecture (GAA); System Description\".\n[5]\t3GPP TS 33.220 \"Generic Authentication Architecture (GAA); Generic Bootstrapping Architecture\".\n[6]\t3GPP TS 33.221 \"Generic Authentication Architecture (GAA); Support for Subscriber Certificates\".\n[7]\t3GPP TS 24.109: \"Bootstrapping interface (Ub) and Network application function interface (Ua);Protocol details\".\n[8]\t3GPP TS 29.230: \"Diameter applications; 3GPP specific codes and identifiers\"\n[9]\tIETF RFC 3589: \"Diameter Command Codes for Third Generation Partnership Project (3GPP)\".\n[10]\t3GPP TS 23.008: \"Organisation of subscriber data\"\n[11]\t3GPP TS 33.222: \"Generic Authentication Architecture (GAA); Access to network application functions using secure hypertext transfer protocol (HTTPS)\".\n[12]\t3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\"\n[13]\tW3C: \"Web Services Activity\", http://www.w3.org/2002/ws/.\n[14]\tW3C: \"Web Services Description Language (WSDL) Version 2.0 Part 0: Primer\", http://www.w3.org/TR/2005/WD-wsdl20-primer-20050803/.\n[15]\t3GPP TR 33.980: \"Liberty Alliance and 3GPP Security Interworking; Interworking of Liberty Alliance ID-FF, ID-WSF and Generic Authentication Architecture\".\n[16]\tLiberty Alliance Project: \"Liberty ID-FF Authentication Context Specification\".\n[17]\t3GPP TS 33.110: \"Key establishment between a Universal Integrated Circuit Card (UICC) and a terminal\"\n[18]\t3GPP TS 33.259: \"Key establishment between a UICC Hosting Device and a Remote Device\"\n[19]\t3GPP TS 29.002: \"Mobile Application Part (MAP) Specification\"\n[20]\t3GPP TS 33.102: \"3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; 3G Security; Security architecture\".\n[21]\t3GPP TS 23.003: \"Numbering, addressing and identification\".\n[22]\tOASIS Standard: \"Authentication Context for the OASIS Security Assertion Markup Language (SAML) V2.0 OASIS Standard, 15 March 2005, saml-authn-context-2.0-os\".\n[23]\t3GPP TS 33.223 \"Generic Authentication Architecture (GAA); Generic Bootstrapping Architecture (GBA) Push Function\".\n[24]\t3GPP TS 33.402: \"3GPP System Architecture Evolution (SAE); Security aspects of non-3GPP accesses\".\n[25]\tVoid\n[26]\t3GPP TS 26.237: \"IP Multimedia Subsystem (IMS) based Packet Switched Streaming (PSS) Multimedia Broadcast/Multicast Services (MBMS); User Service; Protocols\".\n[27]\tVoid\n[28]\tVoid\n[29]\t3GPP TR 33.924: \"Identity Management and 3GPP Security Interworking; Identity Management and Generic Authentication Architecture (GAA) Interworking\".\n[30]\t3GPP TS 33.224: \"Generic Authentication Architecture (GAA); Generic Push Layer\".\n[31]\t\t3GPP TS 33.203: \"Access security for IP-based services\".\n[32]\t3GPP TS 29.329: \" Sh Interface based on the Diameter protocol; Protocol details\".\n[33]\tIETF RFC 6733: \"Diameter Base Protocol\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.228",
        "ts_29.229",
        "ts_33.919",
        "ts_33.220",
        "ts_33.221",
        "ts_24.109",
        "ts_29.230",
        "ts_23.008",
        "ts_33.222",
        "ts_23.228",
        "ts_33.980",
        "ts_33.110",
        "ts_33.259",
        "ts_29.002",
        "ts_33.102",
        "ts_23.003",
        "ts_33.223",
        "ts_33.402",
        "ts_26.237",
        "ts_33.924",
        "ts_33.224",
        "ts_33.203",
        "ts_29.329"
      ]
    },
    {
      "chunk_id": "ts_29.109_3.1",
      "section_id": "3.1",
      "section_title": "Definitions",
      "content": "For the purposes of the present document, the terms and definitions given in 3GPP TS 23.008 [10], 3GPP TR 33.919 [4], 3GPP TS 33.220 [5] apply with following additions.\nBootstrapping information (Bootstrapped data) in a BSF consists of a bootstrapping transaction identifier (B-TID), a key material (Ks), the key lifetime (expiry time), the boostrapinfo creation time, the IMPI and the GUSS (if received from HSS) with BSF control information. Each bootstrapping procedure creates a bootstrapped data entity with B-TID as retrieval key..\nGAA application is an application that uses the security association created by GBA Bootstrapping procedure.\nGAA service is an operator specific end user service that uses the security association created by GAA Bootstrapping procedure. GAA services are identified by GAA Service Identifiers. A GAA service is implemented using some standardised or propriatary GAA application defined by GAA application type.\nNAF specific Bootstrapping information transferred from a BSF to a NAF contains NAF and its service specific parts from bootstrapped data and needed key information derived from the bootstrapped data.\nService/Application. The term service is used here in its common meaning. A service is something that a MNO offers to subscribers. GAA Services are identified by GAA Service Identifier (GSID). In stage 2 documents ([4], [5], [6] and [11]) the term application is used in the same meaning i.e. MNOs offer applications to subscribers. There is a reason to avoid the usage of the term application here. The application is an already reserved term in Diameter. In Diameter applications are identified by Application Identifiers.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_23.008",
        "ts_33.919",
        "ts_33.220"
      ]
    },
    {
      "chunk_id": "ts_29.109_3.2",
      "section_id": "3.2",
      "section_title": "Symbols",
      "content": "For the purposes of the present document, the terms and definitions given in 3GPP TS 23.008 [10].",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.008"
      ]
    },
    {
      "chunk_id": "ts_29.109_3.3",
      "section_id": "3.3",
      "section_title": "Abbreviations",
      "content": "For the purposes of the present document, the following abbreviations apply:\nAK\tAnonymity Key\nAKA\tAuthentication and Key Agreement\nAUTN\tAuthentication token\nAV\tAuthentication Vector.  3GPP AV=[RAND,AUTN,XRES,CK,IK].\nAVP\tAttribute-Value-Pair in Diameter messages.\nBIA\tBootstrappingInfo-Answer message\nBIR\tBootstrappingInfo-Request message\nBS\tBootStrapping Procedure\nBSF\tBootstrapping server functionality BSF is hosted in a network element under the control of an MNO.\nB-TID\tBootstrapping Transaction Identifier\nCA\tCertificate Authority\nCK\tConfidential Key\nFQDN\tFull Qualified Domain Name in URI (e.g. http://FQDN:80)\nGAA\tGeneric Authentication Architecture\nGBA\tGeneric Bootstrapping Architecture\nGPI\tGBA Push Information\nGSID\tGAA Service Identifier\nGUSS\tGBA User Security Settings\nHSS\tHome Subscriber System\nIK\tIntegrity Key\nIMPI\tIP Multimedia Private Identity\nIMPU\tIP Multimedia Public Identity\nKs\tKey Material\nKs_ext_NAF\tMEbased key for a specific NAF\nKs_int_NAF\tUICC based key for a specific NAF\nME\tMobile Equipment\nMNO\t\tMobile network operator\nNAF\tOperator-controlled network application function functionality. NAF is hosted in a network element under the control of an MNO.\nP-TID\tPush Temporary Identifier\nRAND\tRandom challenge in authentication\nREQ\tIn Diameter header indicates that the message is a Request.\nSCTP\tStream Control Transmission Protocol\nSLF\tSubscription Location Function\nSSC\tSubscriber Certificate Procedure\nUa\tUE-NAF interface for GAA applications\nUb\tUE-BSF interface for bootstrapping\nUE\t\tUser Equipment\nUSS\tUser Security Settings (a part of GUSS)\nXRES\tExpected response in authentication\nZh\tBSF-HSS interface for bootstrapping procedure\nZh'\tBSF-HLR interface for bootstrapping procedure\nZn\tBSF-NAF interface for GAA applications\nZpn\tBSF-NAF interface for GBA push.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_4.1",
      "section_id": "4.1",
      "section_title": "Generic bootstrapping network architecture",
      "content": "The network architecture of the Diameter based implementation for Bootstrapping procedure is presented in Figure 4.1-1. The interface Ub (bootstrapping) is defined in 3GPP TS 24.109 [7] and the interface Zh in this specification.\nFigure 4.1-1: Network architecture of bootstrapping procedure\nThe generic boostrapping network architecture for Bootstrapping Push procedures is presented in Figure 4.1-2. The interface Zpn is also defined in this specification.\nFigure 4.1-2: Network architecture of bootstrapping push procedure\nThe protocol stack of the Zh interface in Bootstrapping procedure is presented in Figure 4.2. The Diameter Base protocol is defined in IETF RFC 6733 [33] and the Diameter application in 3GPP TS 29.229 [3]. The requirements for Zh interface are defined in 3GPP TS 33.220 [5] and 3GPP TS 33.223 [23].\nFigure 4.2: Protocol stack of Zh interface\nThe MAP based Bootstrapping Zh' interface is defined in the section 4.3.",
      "chunk_type": "general",
      "cross_references": [
        "clause_4.3",
        "figure_4.1-1",
        "figure_4.1-2",
        "figure_4.2",
        "ts_33.220_figure_4.2",
        "ts_24.109",
        "ts_29.229",
        "ts_33.220",
        "ts_33.223"
      ]
    },
    {
      "chunk_id": "ts_29.109_4.2",
      "section_id": "4.2",
      "section_title": "Protocol Zh between BSF and HSS",
      "content": "The requirements for Zh interface are defined in 3GPP TS 33.220 [5] and 3GPP TS 33.223 [23].\nThe Bootstrapping Zh interface performs the retrieval of an authentication vector and possibly GBA User Security Settings from the HSS.\nThe overall Bootstrapping procedure is depicted in Figure 4.3. The basic procedure is:\nA) A UE starts the bootstrapping procedure by protocol Ub with a BSF giving the IMPI of the user (see 3GPP TS 24.109 [7]).\nB) The BSF starts protocol Zh with user’s HSS\n-\tThe BSF requests user’s authentication vector and GBA User Security Settings (GUSS) corresponding to the IMPI. If the authentication scheme is to use SIP Digest credentials, the BSF shall indicate this in the request.\n-\tThe HSS supplies to the BSF the requested authentication vector and GUSS (if applicable, cf. 3GPP TS 33.220 [5]). The HSS supplies the requested authentication vector relating to SIP Digest only if explicitely indicated in the request.\nNOTE 1:\tIf there is more than one HSS deployed within the network, the BSF may have to contact the SLF using the Dz interface prior to sending the request for information to the HSS (see section 6.4).\nC) The BSF continues the protocol Ub with the UE (see 3GPP TS 24.109 [7]).\nFigure 4.3: The GBA bootstrapping procedure\nThe overall Bootstrapping Push procedure is depicted in Figure 4.4. The Push procedure shall not apply with an authentication scheme using SIP Digest credentials. The Push procedure is:\nA) A NAF sends a bootstrapping push request to the BSF via Zpn interface including the IMPI or IMPU of the user (see section 5).\nB) The BSF starts protocol Zh with user’s HSS\n-\tThe BSF requests user’s authentication vector and GBA User Security Settings (GUSS) corresponding to the IMPI or IMPU.\n-\tThe HSS supplies to the BSF the requested authentication vector and GUSS (if any).\nNOTE 2:\tIf there is more than one HSS deployed within the network, the BSF may have to contact the SLF using the Dz interface prior to sending the request for information to the HSS (see section 6.4).\nC) The BSF continues the protocol Zpn with the NAF (see section 5).\nD) The NAF starts protocol Upa with the UE, as specified in 3GPP TS 24.109 [7].\nFigure 4.4: The GBA bootstrapping Push procedure\nThe steps of the bootstrapping procedure over Zh reference point in Figure 4.3 and Figure 4.4 are:\nStep 1\nThe BSF shall send the following Bootstrapping-Request to the HSS in the format of Multimedia-Auth-Request (MAR) message. The content of the message is given below in the same format as in 3GPP TS 29.229 [3]. The curly brackets indicate mandatory AVPs. The square brackets indicate optional AVPs. The \"address of\" refers to the Fully Qualified Host Name (FQDN).\n<Multimedia-Auth-Request> ::=<Diameter Header: 303, REQ, PXY, 16777221 >< Session-Id >{ Vendor-Specific-Application-Id }{ Auth-Session-State }\t; NO_STATE_MAINTAINED{ Origin-Host }\t; Address of BSF{ Origin-Realm }\t; Realm of BSF{ Destination-Realm }\t; Realm of HSS[ Destination-Host ]\t; Address of the HSS[ User-Name ]\t; IMPI from UE\n[ Public-Identity ]\t; IMPU from UE\n[ SIP-Auth-Data-Item ]\t; Authentication Scheme,\nSynchronization Failure\n[ GUSS-Timestamp ]\t; Timestamp of GUSS in BSF*[ AVP ]*[ Proxy-Info ]*[ Route-Record ]\nThe content of mandatory Vendor-Specific-Application-ID according IETF RFC 6733 [33] is:\n<Vendor-Specific-Application-Id>::=<AVP header: 260>1*  [Vendor-Id]\t; 3GPP is 104150*1 {Auth-Application-Id}\t; 167772210*1 {Acct-Application-Id}\t; Omitted\nWhen determining the value of Destination-Host AVP the BSF can use redirector function (SLF) to resolve the address of the HSS if needed (see 3GPP TS 29.229 [3]). The BSF shall set the Auth-Session-State AVP to NO_STATE_MAINTAINED to inform that the HSS does not need to maintain any status information for this session according 3GPP TS 29.229 [3].\nThe User-name is the IMS Private User Identity (IMPI) as defined in 3GPP TS 29.228 [2]. In bootstrapping push procedures, either the Public-Identity AVP or the User-Name AVP shall be present in the request, depending on the user identity provided by the NAF. For all other bootstrapping procedures, only the User-Name AVP shall be present. If the identity received from the NAF is an MSISDN, the BSF shall include this MSISDN in the form of a tel URI in the Public-Identity AVP (see 3GPP TS 29.229 [2]).\nIf the BSF supports the GUSS timestamp mechanism and has local copy of the GUSS, which has a timestamp, the BSF may include the GUSS-Timestamp AVP. In this case the GUSS-Timestamp AVP shall contain the timestamp from subscriber's GUSS. Otherwise the GUSS-Timestamp AVP shall not be present.\nThe SIP-Auth-Data-Item AVP, when present, shall indicate the authentication scheme chosen, i.e SIP Digest when applicable. By default, when the SIP-Auth-Data-Item AVP is not present, the authentication scheme is Digest-AKAv1-MD5. The SIP-Auth-Data-Item AVP should not be present to indicate the authentication scheme is Digest-AKAv1-MD5.\nNOTE 3:\tA pre-Rel-11 HSS only received SIP-Auth-Data-Item AVP in Zh MAR in case of synchronization failure for IMS-AKA. Apart from that, when SIP-Auth-Data-Item AVP was not present, it implied that the authentication scheme was Digest-AKAv1-MD5. Therefore, if SIP-Auth-Data-Item AVP is not present, it means that the authentication scheme is Digest-AKAv1-MD5, like before Rel-11. Moreover, in order to avoid interoperability problems between a pre-Rel-11 HSS and a Rel-11 (or later) BSF, the BSF should not include the SIP-Auth-Data-Item AVP to indicate the authentication scheme is Digest-AKAv1-MD5.\nIf the Authentication Request is triggered by a synchronization failure (see 3GPP TS 24.109 [7]), the BSF shall include the SIP-Auth-Data-Item AVP within the MAR message according to 3GPP TS 29.228 [2].\nStep 2\nWhen the HSS receives the MAR message, the HSS shall derive the user Authentication Vector (AV) information according the IMPI and, if present, the authentication scheme and populates it into SIP-Auth-Data-Item AVP as defined for IMS-AKA or SIP Digest authentication schemes in 3GPP TS 29.229 [3]. Only one AV shall be provided.\nIf the Public User Identity is received, the HSS shall resolve to the corresponding IMPI/IMSI associated to such IMPU/ MSISDN before deriving the AV information. If Public to Private identity resolution is not possible i.e. due to the IMPU is shared with multiple IMPIs, the HSS shall set the Experimental-Result-Code to DIAMETER_ERROR_OPERATION_NOT_ALLOWED (see 3GPP TS 29.329 [32]).\nIf the request indicates that there is a synchronization failure, the HSS shall process AUTS as described in 3GPP TS 33.203 [31] and return the requested authentication information. The Result-Code shall be set to DIAMETER_SUCCESS.\nIf GUSS exists for the IMPI, the HSS shall do one of the following:\n1)\tIf the HSS supports the GUSS timestamp mechanism and received the GUSS-Timestamp AVP in MAR message then it shall compare the timestamp of the GUSS in the HSS with the received timestamp.\n-\tIf timestamps are equal, then it shall populate the GBA-UserSecSettings AVP with static string \"GUSS TIMESTAMP EQUAL\".\n-\tIf the GUSS-Timestamp AVP was not received, or timestamps are not equal, then it shall populate the GBA-UserSecSettings AVP with the GUSS.\n2.\tIf the HSS does not support GUSS timestamp mechanism, it shall populate the GBA-UserSecSettings AVP with the GUSS.\nThe MAR/MAA sequence in the Zh interface must not change possible status information of the possible simultaneously ongoing IMS MM application sessions in the HSS.\nIf the User-Name (IMPI) or Public-Identity (IMPU) from the BSF is totally unknown to the HSS, the error situation 5401 is raised.\nExceptions to the cases specified here shall be treated by HSS as error situations. The Result-Code shall be set to DIAMETER_UNABLE_TO_COMPLY and no authentication or GUSS information shall be returned.\nStep 3\nThe HSS shall send the following Bootstrapping-Answer message in the format of Multimedia-Auth-Answer (MAA) message back to the BSF.\n< Multimedia-Auth-Answer> ::= < Diameter Header: 303, PXY, 16777221 >< Session-Id >{ Vendor-Specific-Application-Id }[ Result-Code ][ Experimental-Result]{ Auth-Session-State }\t; NO_STATE_MAINTAINED{ Origin-Host }\t; Address of HSS{ Origin-Realm }\t; Realm of HSS[ User-Name ]\t; IMPI\n[ Public-Identity ]\t; IMPU[ SIP-Auth-Data-Item ]\t[ GBA-UserSecSettings ]\t; GUSS\t*[ AVP ]*[ Proxy-Info ]*[ Route-Record ]\nThe HSS shall set the mandatory Auth-Session-State AVP to NO_STATE_MAINTAINED because the HSS does not maintain any state information about this session and the BSF does not need to send any session termination request 3GPP TS 29.229 [3].\nIf the Public-Identity was present in the request, both Public-Identity and User-Name AVPs shall be present in the response. Otherwise, the User-name AVP (IMPI) may be sent back for checking.\nThe required authentication vector data  is sent in the SIP-Auth-Data-Items AVP as defined for IMS-AKA or SIP Digest authentication schemes according to 3GPP TS 29.228 [2]. The security settings of user’s all GAA applications are sent in GBA-UserSecSettings AVP.\nIf the 2G GBA option (see 3GPP TS 33.220, Annex I [5]) is applied for the user the SIP-Auth-Data-Item AVP shall be filled as follows: The SIP-Authentication-Scheme AVP is set to \"Digest-AKAv1-MD5-2G-GBA\" to indicate a 2G GBA vector for GBA. The SIP-Authenticate AVP contains only RAND. The SIP-Authorization AVP contains RES. The Confidentiality-Key AVP contains Kc. The Integrity-Key AVP shall not be present. If a 2G Authentication Vector is requested for the user but the 2G GBA option is not supported by the HSS, the HSS shall set the Experimental-Result-Code to DIAMETER_AUTHENTICATION_SCHEME_NOT_SUPPORTED (see 3GPP TS 29.228 [2]).\nStep 4\nWhen the BSF receives the MAA message, the BSF shall check the value of the SIP-Authentication-Scheme AVP. If the BSF does not support the authentication-scheme the BSF shall stop processing the message and should indicate an error via the O&M subsystem.\nThe BSF generates the needed key material (Ks) as described in 3GPP TS 33.220 [5] and stores temporarily the tuple <IMPI,Ks,GBA-UserSecSettings> for further use in GAA applications. The rest of the bootstrapping procedure in Ub interface will later add also the Bootstrapping Transaction Identifier (B-TID) to that tuple as key and the key lifetime (expiry time).\nIf the BSF sent the GUSS-Timestamp AVP in step 1, and if the GBA-UserSecSettings AVP contains a static string \"GUSS TIMESTAMP EQUAL\", then the local copy of the GUSS in the BSF shall be preserved. If the GBA-UserSecSettings AVP was not present in the MAA message, the local copy of the GUSS shall be deleted. If the GBA-UserSecSettings AVP contains a new GUSS, the local copy of the GUSS shall be deleted, and the new GUSS shall be stored in the BSF.\nIn GBA Bootstrapping Push procedures, the BSF generates the requested NAF-key(s) according to provided NAF_Id and the GBA Push Information (GPI). The BSF completes the rest of the bootstrapping push procedure sending its response to the NAF over Zpn interface, and deleting the Ks used as defined in section 5.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.4",
        "clause_5",
        "figure_4.3",
        "ts_24.109_figure_4.3",
        "figure_4.4",
        "ts_24.109_figure_4.4",
        "ts_33.220",
        "ts_33.223",
        "ts_24.109",
        "ts_29.229",
        "ts_29.228",
        "ts_29.329",
        "ts_33.203"
      ]
    },
    {
      "chunk_id": "ts_29.109_4.3",
      "section_id": "4.3",
      "section_title": "Protocol Zh' between BSF and HLR",
      "content": "The requirements for Zh' reference point are the same with the one for the Zh reference point defined in 3GPP TS 33.220 [5], except that the GBA User Security Settings (GUSS) are not supported.\nThe Bootstrapping Zh' interface performs the retrieval of an authentication vector. The basic procedure is:\nA) A UE starts the bootstrapping procedure by protocol Ub with a BSF giving the IMPI of the user (see 3GPP TS 24.109 [7]). In bootstrapping push procedures a NAF initiates a GBA Push Information Request by protocol Zpn with the BSF giving the user identity (see section 5). The BSF derives the IMSI from the IMPI. In bootstrapping push procedures when only the Public Identity of the user is made available to the BSF, the BSF shall perform public to private identity resolution as defined in section 4.3.1.\nB) The BSF starts protocol Zh' with user’s HLR\n-\tThe BSF requests user’s authentication vector corresponding to the IMSI.\n-\tThe HLR supplies to the BSF the requested authentication vector.\nC) The BSF continues the protocol Ub with the UE (see 3GPP TS 24.109 [7]).\nThe BSF shall use the following Bootstrapping-Request to the HLR in the format of a MAP_SEND_AUTHENTICATION_INFO.  The content of the request, result and error messages is given below in the same format as in 3GPP TS 29.002 [19]. The parameter usage is as follows:\nIMSI\nSee 3GPP TS 29.002 [19] section 7.6.2 for the use of this parameter.\nNumber of requested vectors\nThe BSF shall only request one authentication vector at a time.\nRequesting node type\nBSF\nRe-synchronisation Info\nFor definition and use of this parameter see 3GPP TS 33.102 [20].\nSegmentation prohibited indicator\nThis parameter is not applicable and should not be sent by the BSF.\nImmediate response preferred indicator\nThis parameter indicates that one of the requested authentication vectors is requested for immediate use in the BSF.\nRequesting PLMN ID\nThe PLMN-ID of the requesting node. See 3GPP TS 23.003 [21].\nAuthenticationSetList\nOne authentication vector is transferred from the HLR to the BSF, if the outcome of the service was successful.\nUser error\nOne of the following error causes defined in 3GPP TS 29.002 [19] shall be sent by the user in case of unsuccessful outcome of the service, depending on the respective failure reason:\n-\tunknown subscriber;\n-\tunexpected data value;\n-\tsystem failure;\n-\tdata missing.\nProvider error\nSee 3GPP TS 29.002 [19] for the use of this parameter.\nWhen the BSF receives the response of the MAP_SEND_AUTHENTICATION_INFO service, then it shall generate the needed key material (Ks) from confidential key (CK) and integrity key (IK) as described in 3GPP TS 33.220 [5], respecively from Kc as decribed in 3GPP TS 33.220 [5] and stores temporarily the tuple <IMPI,Ks> for further use in GAA/GBA applications. The rest of the bootstrapping procedure in Ub interface will later add also the Bootstrapping Transaction  Identifier (B-TID) to that tuple as key and the key lifetime (expiry time).",
      "chunk_type": "general",
      "cross_references": [
        "clause_5",
        "clause_4.3.1",
        "ts_29.002_clause_7.6.2",
        "ts_33.220",
        "ts_24.109",
        "ts_29.002",
        "ts_33.102",
        "ts_23.003"
      ]
    },
    {
      "chunk_id": "ts_29.109_4.3.1",
      "section_id": "4.3.1",
      "section_title": "Public to Private Identity Resolution over Zh between BSF and HLR",
      "content": "When the UE identity used by the NAF in a GPI Request towards the BSF is an MSISDN, the BSF shall resolve the corresponding private user identity (IMSI) for the user.\nWhen Zh interface between BSF and HLR is used, the BSF shall resolve the private user identity with the HLR in the format of a MAP_SEND_IMSI or a MAP_SEND_ROUTING_INFO_FOR_SM.\nThe content of the request, result and error messages is given below in the same format as in 3GPP TS 29.002 [19]. The parameter usage when the MAP_SEND_IMSI operation is used is as follows:\nMSISDN\nSee 3GPP TS 29.002 [19] section 7.6.2 for the use of this parameter.\nIMSI\nSee 3GPP TS 29.002 [19] section 7.6.2 for the use of this parameter. The presence of this parameter is mandatory in a successful case.\nUser error\nOnly one of the following values is applicable:\n-\tUnknown subscriber;\n-\tUnexpected data value;\n-\tData missing.\nThe parameter usage when the MAP_SEND_ROUTING_INFO_FOR_SM operation is used is as follows:\nMSISDN\nSee 3GPP TS 29.002 [19] section 7.6.2 for the use of this parameter.\nSM-RP-PRI\nBSF shall set this parameter to indicate that delivery of the short message shall NOT be attempted when a service centre address is already contained in the Message Waiting Data file.\nService Centre Address\nBSF shall include the BSF address within this parameter.\nSM-RP-MTI\nSM-RP-SMEA\nGPRS Support Indicator\nBSF shall not use these parameters in the public to private identity resolution request.\nSM-Delivery Not Intended\nBSF shall set this parameter to indicate that delivery of a short message is not intended and that only IMSI is requested.\nIMSI\nSee 3GPP TS 29.002 [19] section 7.6.2 for the use of this parameter. The presence of this parameter is mandatory in a successful case.\nNetwork Node Number\nLMSI\nGPRS Node Indicator\nAdditional Number\nBSF ignores these parameters if present in the public to private identity resolution response.\nUser error\nOne of the following error causes defined in 3GPP TS 29.002 [19] shall be sent by the user in case of unsuccessful outcome of the service, depending on the respective failure reason:\n-\tUnknown subscriber;\n-\tCall Barred;\n-\tTeleservice Not Provisioned;\n-\tAbsent Subscriber_SM;\n-\tFacility Not Supported;\n-\tSystem failure;\n-\tUnexpected Data Value;\n-\tData missing.\nProvider error\nSee 3GPP TS 29.002 [19] for the use of this parameter.\nWhen the HLR is able to resolve the private identity of the user, the BSF continues with the boostrapping procedures over Zh and requests a user’s authentication vector corresponding to the IMSI as defined above. Otherwise the BSF provides the corresponding error to the NAF over Zpn as defined in section 5.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_29.002_clause_7.6.2",
        "clause_5",
        "ts_29.002"
      ]
    },
    {
      "chunk_id": "ts_29.109_5.1",
      "section_id": "5.1",
      "section_title": "Applications’ network architecture",
      "content": "The network architecture of the GAA applications procedure using Zn is presented in Figure 5.1-1. The 3GPP GAA applications are listed in annex B. Different GAA applications may implement the Ua interface in different way. The Zn interface is defined in this specification.\nFigure 5.1-1: Network architecture of GAA application using Zn\nThe network architecture of GBA push procedure using Zpn is presented in Figure 5.1-2. The Zpn interface is also defined in this specification.\nFigure 5.1-2: Network architecture of GBA push procedure using Zpn\nTwo options are specified for the protocol stack to be used on the Zn and Zpn interface:\nThe protocol stack of the DIAMETER based Zn interface,\nthe protocol stack of the Web Services based Zn interface.\nThe BSF shall support both options whereas the NAF shall support one or both of these options.\nThe protocol stack of the Diameter based implementation of the Zn interface for GAA applications and Zpn interface for GBA push procedure is presented in Figure 5.2-1. The Zn interface is specified in clause 5.2. The Zpn interface is specified in clause 5.4. The Diameter base protocol is defined in IETF RFC 6733 [33] and the Diameter application in 3GPP TS 29.229 [3]. The requirements for Zn interface are defined in 3GPP TS 33.220 [5]. The requirements for Zpn interface are defined in 3GPP TS 33.223 [23].\nFigure 5.2-1: Protocol stack of Diameter based Zn and Zpn interfaces\nThe protocol stack of the Web Services based Zn interface for GAA applications and Zpn interface for GBA push procedure is presented in Figure 5.2-2. The Zn interface is specified in clause 5.3. The Zpn interface is specified in clause 5.5.\nFigure 5.2-2: Protocol stack of Web Services based Zn interface",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.2",
        "clause_5.4",
        "clause_5.3",
        "clause_5.5",
        "figure_5.1-1",
        "figure_5.1-2",
        "figure_5.2-1",
        "ts_33.223_figure_5.2-1",
        "figure_5.2-2",
        "ts_29.229",
        "ts_33.220",
        "ts_33.223"
      ]
    },
    {
      "chunk_id": "ts_29.109_5.2",
      "section_id": "5.2",
      "section_title": "Protocol Zn between NAF and BSF based on Diameter",
      "content": "The requirements for Zn interface are defined in 3GPP TS 33.220 [5].\nThe protocol Zn retrieves the key material and possibly user security settings data by NAF from BSF.  After UE is authenticated with the BSF, every time the UE wants to interact with an NAF the following steps are executed as depicted in Figure 5.3. The basic procedure is:\nA) The UE starts protocol Ua (see 3GPP TS 33.220 [5])\n-\tIn general, the UE and the NAF will not yet share the key(s) required to protect protocol Ua. If they already do, there is no need for the NAF to invoke protocol Zn.\n-\tIt is assumed that UE supplies sufficient information to NAF, i.e. the Bootstrapping Transaction Identifier (B-TID), to allow the NAF to retrieve specific key material (e.g. Ks_NAF in the case of GBA_ME, and Ks_ext_NAF or Ks_int_NAF or both in the case of GBA_U) from BSF.\n-\tThe UE derives the keys required to protect protocol Ua from the key material.\nB) The NAF starts protocol Zn with BSF\n-\tThe NAF requests NAF specific key material corresponding to the information supplied by the UE to the NAF (i.e. the bootstrapping transaction identifier) in the start of protocol Ua.\n-\tThe BSF generates and supplies to the NAF the requested NAF specific key material, the expiry time, the bootstrapinfo creation time, and the appropriate User Security Settings defined for received application identifiers.\nC) The NAF continues protocol Ua with the UE (see 3GPP TS 33.221  [6])\nOnce the run of protocol Ua is completed the purpose of bootstrapping is fulfilled as it enabled UE and NAF to run protocol Ua in a secure way.\nThe common GAA application procedure is presented in Figure 5.3.\nFigure 5.3: The Diameter based GAA application procedure\nThe steps of the GAA application procedure in Figure 5.3 are:\nStep 1\nThe NAF shall send a Bootstrapping-Info-Request message (BIR) to the BSF.  The content of the message is given here in the same format as in 3GPP TS 29.229 [3]. The curly brackets indicate mandatory AVPs. The square brackets indicate optional AVP. The address refers to the Fully Qualified Host Name (FQDN).\n< Bootstrapping-Info-Request> ::=<Diameter Header: 310, REQ, PXY, 16777220 >< Session-Id >{ Vendor-Specific-Application-Id }[ Auth-Session-State ]\t; NO_STATE_MAINTAINED{ Origin-Host }\t; Address of NAF{ Origin-Realm }\t; Realm of NAF{ Destination-Realm }\t; Realm of BSF[ Destination-Host ]\t; Address of the BSF * [ GAA-Service-Identifier ]\t; Service identifiers{ Transaction-Identifier }\t; B-TID{ NAF-Id }\t; NAF_ID[ GBA_U-Awareness-Indicator ]\t; GBA_U awareness of the NAF*[ AVP ]*[ Proxy-Info ]*[ Route-Record ]\nThe content of Vendor-Specific-Application-ID according IETF RFC 6733 [33] is:\n<Vendor-Specific-Application-Id>::=<AVP header: 260>1*  [Vendor-Id]\t; 3GPP is 104150*1 {Auth-Application-Id}\t; 167772200*1 {Acct-Application-Id}\t; Omitted\nThe NAF should set the Auth-Session-State AVP to NO_STATE_MAINTAINED to inform that the BSF does not need to maintain any session state information for this session according 3GPP TS 29.229 [3].\nThe Destination-Realm AVP is set to subscriber’s BSF. The address of the BSF is extracted from the B-TID.\nNOTE:\tIn the case where the subscriber has contacted a NAF that is in a visited network, the NAF contacts the subscriber's home BSF through a Diameter based Proxy (Zn-Proxy) that is located in the same network as the NAF. The local BSF and the Zn-Proxy may be co-located. See 3GPP TS 33.220 [6].\nThe NAF indicates the GAA services for which the information is retrieved by GAA-Service-Identifier AVPs. The Bootstrapping Transaction Identifier defines the earlier bootstrapping procedure execution.\nStep 2\nIn the successful case the BSF has a tuple <B-TID,IMPI,Ks, Key lifetime, Bootstrapinfo creation time, GBA-UserSecSettings> identified by Bootstrapping Transaction Identifier (B-TID). When the BSF receives the request it checks the existence and validity of the tuple for given B-TID. If checking fails the BSF sends an Answer  message with Experimental-Result set to indicate the error type 5403. If the tuple for B-TID exists, but is expired, error type 5403 is also send to indicate needs for renewal of the boostrapping procedure. In successful case the Result-Code is set to 2xxx as defined in IETF RFC 6733 [33].\nThe BSF derives the key material for the ME (i.e., Ks_NAF in the case of GBA_ME, and Ks_ext_NAF in the case of GBA_U) and possibly the key material for the UICC (i.e., Ks_int_NAF in the case of GBA_U)  according to the B-TID and packs them into ME-Key-Material AVP and possible UICC-Key-Material AVP. The ME-Key-Material contains Ks_(ext)_NAF and the UICC-key-Material contains the Ks_int_NAF key. The BSF select correct user’s Security Settings according the request’s GAA-Service-Identifier AVP to GBA-UserSecSettings AVP. If NAF grouping is used by the operator and there are one or more USSs corresponding to the requested GSID, then also the nafGroup attribute of USS is checked. If the NAF has sent a GAA-Service-Identifier that does not have corresponding user’s security settings, and the BSF is locally configured to reject those requests from the NAF, then the error 5402 is raised. If the NAF has sent a GAA-Service-Identifier that have corresponding user's security settings, but the BSF is locally configured to reject those from that NAF, then the error 5402 is raised too.\nThe NAF may be addressed from the UE with different FQDNs. The BSF shall check if this NAF-Id is allowed to be used for the NAF. If the NAF identified by its Origin-Host AVP is configured in the BSF not to be authorized to use the given NAF-Id, the BSF may raise the error situation 5402. The BSF may also be configured so that a certain NAF is not authorized to use a certain GAA-Service-Identifier. This situation may be also indicated by error code 5402.\nExceptions to the cases specified here shall be treated by BSF as error situations. The Result-Code shall be set to DIAMETER_UNABLE_TO_COMPLY.\nStep 3\nAfter that the BSF shall send a Bootstrapping-Info-Answer message (BIA) back to the NAF.\n< Boostrapping-Info-Answer> ::= < Diameter Header: 310, PXY, 16777220 >< Session-Id >{ Vendor-Specific-Application-Id }[ Result-Code ]\t[ Experimental-Result][ Auth-Session-State ]\t; NO_STATE_MAINTAINED{ Origin-Host }\t; Address of BSF{ Origin-Realm }\t; Realm of BSF[ User-Name ]\t; IMPI[ ME-Key-Material ]\t; Required[ UICC-Key-Material ]\t; Conditional[ Key-ExpiryTime ]\t; Time of expiry[ BootstrapInfoCreationTime ]\t; Bootstrapinfo creation time[ GBA-UserSecSettings ]\t; Selected USSs[ GBA-Type ]\t; GBA type used in bootstrapping*[ AVP ]*[ Proxy-Info ]*[ Route-Record ]\nThe BSF shall set the Auth-Session-State AVP to NO_STATE_MAINTAINED because the BSF does not maintain any session state information about this session and the NAF does not need to send any session termination request 3GPP TS 29.229 [3].\nThe BSF may or may not send  the User-name AVP (IMPI) according its configuration.\nThe mandatory common key material with the ME (Ks_NAF or Ks_ext_NAF) is sent in the ME-Key-Material AVP. The common key material with the UICC (Ks_int_NAF) is optionally sent in the UICC-Key-Material AVP only if the \"uiccType\" tag in bsfInfo from the HSS is set to \"GBA_U\".\nThe Key-ExpiryTime AVP contains the expiry time of the Bootstrapping information in the BSF according its configuration. The expiry time is represented according the Diameter Time data format in seconds that have passed since 0h on January 1, 1900 UTC . If a special key lifetime value is given in the \"lifeTime\" tag inside the bsfInfo from the HSS in bootstraping procedure, it is used instead of the BSF default configuration value when the expiry time is calculated.\nThe BootstrapInfoCreationTime AVP contains the bootstrapinfo creation time, i.e., creation time of the Bootstrapping information in the BSF. The bootstrapinfo creation time is represented in seconds that have passed since January 1, 1900 00:00:00.000 UTC.\nThe BSF selects the appropriate User Security Settings (if any) to the GBA-UserSecSettings AVP from stored GAA-UserSecSettings in Bootstrapping information according the GBA-Service-Identifier AVPs in the request message.\nThe BSF shall indicate the type of used authentication in the bootstrapping procedure to the NAF in GBA-Type, if other than 3G GBA type has been performed.\nWhen the NAF receives the BIA message, the NAF shall check the value of the GBA-Type AVP if it is included in the message. If the NAF does not support the GBA-Type the NAF shall stop processing the message and should indicate an error via the O&M subsystem. The further procedure in the NAF when the BIA is received is described in 3GPP TS 33.220 [5], 3GPP TS 33.222 [11] and optionally in GAA service type specific TSs.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.3",
        "ts_33.220",
        "ts_33.221",
        "ts_29.229",
        "ts_33.222"
      ]
    },
    {
      "chunk_id": "ts_29.109_5.3",
      "section_id": "5.3",
      "section_title": "Protocol Zn between NAF and BSF based on Web Services",
      "content": "The procedures in the NAF and in the BSF related Web Services [13] based Zn interface are the same as specified in clause 5.2, but instead of Diameter messages a Web Services procedures shall be used to communicate over Zn interface. Annex D specifies the GBA Service for Web Services, i.e., it contains the Web Services Definition Language (WSDL) [14] specification for GBA Service. Below are the attributes that are defined for GBA Service request, response, and fault cases.\nFigure 5.4: The Web Services based GAA application procedure\nThe possible attribute value definitions and restrictions for the request, response, and fault messages are the same as in clause 6 unless explicitly specified in this clause. The steps of the GAA application procedure in Figure 5.4 are:\nStep 1\nThe NAF shall send a \"requestBootstrappingInfoRequest\" message to the BSF.  The WSDL schema of this message is included in Annex D.\nFollowing elements are included into this message:\n-\t\"btid\"\nThis is B-TID and defines the earlier bootstrapping procedure execution. Description in subclause 6.3.1.2 applies.\n-\t\"nafid\"\nThis is the NAF-Id. Description in subclause 6.3.1.3 applies.\n-\t\"gsid\"\nThis element contains the GAA Services Identifiers. Description in subclause 6.3.1.4 applies while the GAA Service Type Codes for 3GPP standardized services are defined in Annex B.\n-\t\"gbaUAware\"\nThis element is optionally included. It indicates whether NAF is GBA_U aware, and is capable of using and handling the \"uiccKeyMaterial\". The default value for \"gbaUAware\" is false. Description and values defined for the corresponding Diameter AVP in subclause 6.3.1.8 apply.\nThe NAF may use one or more \"extension\" elements to include additional data to the request, but the BSF may ignore the additional data.\nThis SOAP message shall be sent to BSF, then the URI of the message shall contain the BSF address extracted from \"btid\".In the case where the subscriber has contacted a NAF that is in a visited network, the NAF contacts the subscriber's home BSF through a GBA-Proxy that is located in the same network as the NAF. The local BSF and the GBA-Proxy may be co-located. See 3GPP TS 33.220 [6].\nStep 2\nThe procedures for step 2 are the same as in step 2 in clause 5.2.\nIf any of the error situations described in step 2 in clause 5.2 arises, the BSF shall respond with a \"requestBootstrappingInfoFault\" message, as defined in Annex D. The \"errorCode\" element shall contain the corresponding Diameter error code (see clause 6.2.2). If the \"errorText\" is included, it shall contain a human-readable description of the error.\nStep 3\nAfter that, \"requestBootstrappingInfoResponse\" message is sent back to the NAF. The WSDL schema of this message is included in Annex D.\nFollowing elements are included into this message:\n-\t\"impi\"\nThis element is optionally included according to BSF configuration. Description for User-Name AVP from 3GPP TS 29.229 [3] applies.\n-\t\"meKeyMaterial\"\nIt includes the mandatory common key material with the ME (Ks_NAF or Ks_ext_NAF). Description in subclause 6.3.1.6 applies.\n-\t\"uiccKeyMaterial\"\nThis element is the common key material with the UICC (Ks_int_NAF). It is optionally sent only if the \"uiccType\" tag in \"bsfInfo\" (received by BSF from the HSS over Zh) is set to \"GBA_U\". Description in subclause 6.3.1.7 applies.\n-\t\"keyExpiryTime\"\nIt contains the expiry time of the Bootstrapping information in the BSF according its configuration. If a special key lifetime value is given in the \"lifeTime\" tag inside the \"bsfInfo\" (received by BSF from the HSS over Zh) in bootstraping procedure, it shall be used instead of the BSF default configuration value when the expiry time is calculated. Description in subclause 6.3.1.5 applies.\n-\t\"bootstrappingInfoCreationTime\"\nThis element contains the bootstrapinfo creation time, i.e., creation time of the Bootstrapping information in the BSF. Description in subclause 6.3.1.9 applies.\n-\t\"gbaType\"\nThis element indicates the type of used authentication in the bootstrapping procedure to the NAF in \"gbaType\" element. It shall be included if other than 3G GBA type has been performed. Description and values defined for the corresponding Diameter AVP in subclause 6.3.1.11 apply.\n-\t\"ussList\"\nThis element is optionally included. The BSF shall select the appropriate User Security Settings (if any) into the \"ussList\" element from stored GAA-UserSecSettings in Bootstrapping information according \"gsid\" elements in the request message. The \"ussList\" element contains a standalone XML document whose root element shall be \"ussList\" element as specified in Annex A and which contains the User Security Settings selected by the BSF. Description in subclause 6.3.1.1 applies.\nThe BSF may use one or more \"extension\" elements to include additional data to the request, but the NAF may ignore the additional data.\nWhen the NAF receives the \"requestBootstrappingInfoResponse\" message, the NAF shall check the value of the \"gbaType\" element if it is included in the message. If the NAF does not support the GBA type the NAF shall stop processing the message and should indicate an error via the O&M subsystem. The further procedure in the NAF when the requestBootstrappingInfoResponse message is received is described in 3GPP TS 33.220 [5], 3GPP TS 33.222 [11] and optionally in GAA service type specific TSs.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_5.2",
        "clause_6",
        "clause_6.3.1.2",
        "clause_6.3.1.3",
        "clause_6.3.1.4",
        "clause_6.3.1.8",
        "clause_6.2.2",
        "clause_6.3.1.6",
        "clause_6.3.1.7",
        "clause_6.3.1.5",
        "clause_6.3.1.9",
        "clause_6.3.1.11",
        "clause_6.3.1.1",
        "figure_5.4",
        "ts_33.220",
        "ts_29.229",
        "ts_33.222"
      ]
    },
    {
      "chunk_id": "ts_29.109_5.4",
      "section_id": "5.4",
      "section_title": "Protocol Zpn between NAF and BSF based on Diameter",
      "content": "The requirements for Zpn interface are defined in 3GPP TS 33.223 [23].\nThe protocol Zpn retrieves the GPI, key material and possibly user security settings data by NAF from BSF.  When the NAF wants to send data to the UE, but the NAF has no valid NAF-key available, the following steps are executed as depicted in Figure 5.4. The basic procedure is:\nIn general, the UE and the NAF will not yet share the key(s) required to protect protocol Ua. If they already do, there is no need for the NAF to invoke protocol Zpn.\nIt is assumed that the NAF has sufficient information available, i.e. user identity and the address of BSF.\nA) The NAF starts protocol Zpn with BSF\n-\tThe NAF requests GBA-Push-Info (GPI), NAF specific key material corresponding to the user identity.\n-\tThe BSF fetches AVs from the HSS, generates and supplies to the NAF the requested GPI, NAF specific key material, the expiry time, the bootstrapinfo creation time, and the appropriate User Security Settings defined for received application identifiers.\nB) The NAF sends GPI over protocol Upa to the UE (see 3GPP TS 33.223 [23])\nOnce the run of protocol Upa is completed the purpose of bootstrapping is fulfilled and it will enable the UE and NAF to run protocol Ua in a secure way.\nThe  GBA push procedure over Zpn is presented in Figure 5.4.\nFigure 5.4-1: The Diameter based GBA push procedure over Zpn\nThe steps of the GBA push procedure in Figure 5.4-1 are:\n- Step 1\nThe NAF shall send a GBA-Push-Info-Request message to the BSF.  The content of the message is given here in the same format as in 3GPP TS 29.229 [3]. The curly brackets indicate mandatory AVPs. The square brackets indicate optional AVP. The address refers to the Fully Qualified Domain Name (FQDN).\n< GBA-Push-Info-Request> ::=<Diameter Header: xxx, REQ, PXY, xxxxxxxx >< Session-Id >{ Vendor-Specific-Application-Id }{ Origin-Host }\t; Address of NAF{ Origin-Realm }\t; Realm of NAF{ Destination-Realm }\t; Realm of BSF[ Destination-Host ]\t; Address of the BSF { UE-Id }\t; User identity{ UE-Id-Type }\t; Public or private identity{ UICC-App-Label }\t; UICC application label* [ GAA-Service-Identifier ]\t; Service identifiers{ NAF-SA-Identifier }\t; P-TID{ NAF-Id }\t; NAF_ID{ UICC-ME }\t; Use of GBA_ME or GBA_U{ Requested-Key-Lifetime }\t; Requested NAF-Key lifetime{ Private-Identity-Request }\t; Request private identity[ GBA_U-Awareness-Indicator ]\t; GBA_U awareness of the NAF[ Security-Feature-Request ]\t; Sec. feature request*[ AVP ]*[ Proxy-Info ]*[ Route-Record ]\nThe content of Vendor-Specific-Application-ID according IETF RFC 6733 [33] is:\n<Vendor-Specific-Application-Id>::=<AVP header: 260>1*  [Vendor-Id]\t; 3GPP is 104150*1 {Auth-Application-Id}\t; xxxxxxxx0*1 {Acct-Application-Id}\t; Omitted\nThe Destination-Realm AVP and Destination-Host AVP are set to subscriber’s BSF.\nNOTE:\tIn the case the NAF is in a visited network, the NAF contacts the subscriber's home BSF through a Diameter based Proxy (Zn-Proxy) that is located in the same network as the NAF. In this case the Destination-Host shall not be included.The local BSF and the Zn-Proxy may be co-located. See 3GPP TS 33.220 [6].\nThe NAF indicates the GAA services for which the information is retrieved by GAA-Service-Identifier AVPs.\nWith UE-Id and UE-Id-Type AVPs the NAF indicates the user identity and its type, i.e. private or public. The NAF uses UICC-ME and UICC-App-Label AVPs to identity which UICC application is to be used and if GBA-ME or GBA_U should be used. Private-Identity-Request indicates if he NAF requests the BSF to send the private user identity. Requested-Key-Lifetime AVP indicates the requested key lifetime for the NAF keys. NAF-SA-Identifier (P-TID) is sent to the BSF so that BSF can include it to the encrypted GPI. See 3GPP TS 33.223 [23]).\nThe NAF may request information on the availability of security features using the Security-Features-Resquest AVP. The AVP may contain a semicolumn-separated list of security features that are available ordered by preference.\n- Step 2\nWhen the BSF receives the GPI request it checks that the requested key lifetime  in the GPI request is less than the allowed max value in the system. If checking fails the BSF sends an Answer  message with Experimental-Result set to indicate the error type 5402. In successful case the Result-Code is set to 2xxx as defined in IETF RFC 6733 [33].\nThe BSF includes the received user identity (public of private) to the Zh protocol request.\nIf GBA_U was requested by the NAF, the BSF queries its database to find out if the private user identity is registered and if a valid Ks already exists. If a valid Ks exists, the BSF shall invalidate this Ks\nThe BSF derives the key material for the ME (i.e., Ks_NAF in the case of GBA_ME, and Ks_ext_NAF in the case of GBA_U) and possibly the key material for the UICC (i.e., Ks_int_NAF in the case of GBA_U)  according to the NAF-ID and packs them into ME-Key-Material AVP and possible UICC-Key-Material AVP. The ME-Key-Material contains Ks_(ext)_NAF and the UICC-key-Material contains the Ks_int_NAF key. The BSF select correct user’s Security Settings according the request’s GAA-Service-Identifier AVP to GBA-UserSecSettings AVP. If NAF grouping is used by the operator and there are one or more USSs corresponding to the requested GSID, then also the nafGroup attribute of USS is checked. If the NAF has sent a GAA-Service-Identifier that does not have corresponding user’s security settings, and the BSF is locally configured to reject those requests from the NAF, then the error 5402 is raised. If the NAF has sent a GAA-Service-Identifier that have corresponding user's security settings, but the BSF is locally configured to reject those from that NAF, then the error 5402 is raised too.\nThe BSF generates the GPI according to TS 33.223 [23].\nThe BSF shall check if this NAF-Id is allowed to be used for the NAF. If the NAF identified by its Origin-Host AVP is configured in the BSF not to be authorized to use the given NAF-Id, the BSF may raise the error situation 5402. The BSF may also be configured so that a certain NAF is not authorized to use a certain GAA-Service-Identifier. This situation may be also indicated by error code 5402.\n- Step 3\nAfter that the BSF shall send a GBA-Push-Info-Answer message back to the NAF. The BSF deletes the used Ks according to 3GPP TS 33.223 [23].\n< GBA-Push-Info-Answer> ::= < Diameter Header: xxx, PXY, xxxxxxxx >< Session-Id >{ Vendor-Specific-Application-Id }[ Result-Code ]\t[ Experimental-Result]{ Origin-Host }\t; Address of BSF{ Origin-Realm }\t; Realm of BSF[ User-Name ]\t; IMPI[ ME-Key-Material ]\t; Required[ UICC-Key-Material ]\t; Conditional[ Key-ExpiryTime ]\t; Time of expiry[ BootstrapInfoCreationTime ]\t; Bootstrapinfo creation time[ GBA-UserSecSettings ]\t; Selected USSs[ GBA-Type ]\t; GBA type used in bootstrapping[ GBA-Push-Info ]\t; GBA Push Info[ Security-Feature-Response ]\t; Sec. feature response*[ AVP ]*[ Proxy-Info ]*[ Route-Record ]\nThe BSF may or may not send the User-name AVP (IMPI) It is only returned if requested and public user identity was used in the GBA-Push-Info-Request message according its configuration.\nThe mandatory common key material with the ME (Ks_NAF or Ks_ext_NAF) is sent in the ME-Key-Material AVP. The common key material with the UICC (Ks_int_NAF) is optionally sent in the UICC-Key-Material AVP only if the \"uiccType\" tag in bsfInfo from the HSS is set to \"GBA_U\".\nThe Key-ExpiryTime AVP contains the expiry time of the Bootstrapping information in the BSF according its configuration. The expiry time is represented according the Diameter Time data format in seconds that have passed since 0h on January 1, 1900 UTC . If a special key lifetime value is given in the \"lifeTime\" tag inside the bsfInfo from the HSS in bootstraping procedure, it is used instead of the BSF default configuration value when the expiry time is calculated.\nThe BootstrapInfoCreationTime AVP contains the bootstrapinfo creation time, i.e., creation time of the Bootstrapping information in the BSF. The bootstrapinfo creation time is represented in seconds that have passed since January 1, 1900 00:00:00.000 UTC.\nThe BSF selects the appropriate User Security Settings (if any) to the GBA-UserSecSettings AVP from stored GAA-UserSecSettings in Bootstrapping information according the GBA-Service-Identifier AVPs in the request message.\nThe BSF shall indicate the type of used authentication in the bootstrapping procedure to the NAF in GBA-Type, if other than 3G GBA type has been performed.\nThe GBA-Push-Info AVP includes the GPI. The contents of GPI are defined in 3GPP TS 33.223 [23].\nIf the BSF supports the usage of securityFeature and the NAF has requested the securityFeatures from the BSF in the request, the BSF shall extract securityFeatures element from the bsfInfo element in subscriber's GUSS and add those security features to the Security-Features-Response AVP in the response which are common in the received securityFeatures request from the NAF and in the extracted information from the bsfInfo element. The common security features are added to the Security-Features-Response AVP in the order as they appear in the bsfInfo element. If securityFeatures element is not defined in the GUSS,or there is no common securityFeature, the BSF shall include an empty string to the Security-Features-Response AVP in the response.\nWhen the NAF receives the GBA-Push-Info-Answer message, the NAF shall check the value of the GBA-Type AVP if it is included in the message. If the NAF does not support the GBA-Type the NAF shall stop processing the message and should indicate an error via the O&M subsystem. The further procedure in the NAF when the GBA-Push-Info-Answer message is received is described in 3GPP TS 33.223 [23], 3GPP TS 24.109 [7].",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.4",
        "figure_5.4-1",
        "ts_33.223",
        "ts_29.229",
        "ts_33.220",
        "ts_24.109"
      ]
    },
    {
      "chunk_id": "ts_29.109_5.5",
      "section_id": "5.5",
      "section_title": "Protocol Zpn between NAF and BSF based on Web Services",
      "content": "The procedures in the NAF and in the BSF related Web Services [13] based Zpn interface are the same as specified in clause 5.4, but instead of Diameter messages a Web Services procedures shall be used to communicate over Zpn interface. AnnexG specifies the GBA Service for Web Services, i.e., it contains the Web Services Definition Language (WSDL) [14] specification for GBA Service. Below are the attributes that are defined for GBA Service request, response, and fault cases.\nFigure 5.5: The Web Services based GAA application procedure\nThe possible attribute value definitions and restrictions for the request, response, and fault messages are the same as in clause 6 unless explicitly specified in this clause. The steps of the GAA application procedure in Figure 5.4 are:\nStep 1\nThe NAF shall send a \"requestGbaPushInfoRequest message\" to the BSF.  The WSDL schema of this message is included in Annex G.\nFollowing elements are included into this message:\n-\t\"ptid\"\nThis is P-TID and it is given to the BSF so that it can be included in the encrypted \"gbaPushInfo\" element in the response. Description in subclause 6.3.1.19 applies.\n-\t\"nafid\"\nThis is the NAF-Id. Description in subclause 6.3.1.3 applies.\n-\t\"gsid\"\nThis element contains the GAA Services Identifiers. Description in subclause 6.3.1.4 applies while the GAA Service Type Codes for 3GPP standardized services are defined in Annex B.\n-\t\"gbaUAware\"\nThis element is optionally included. It indicates whether NAF is GBA_U aware, and is capable of using and handling the \"uiccKeyMaterial\". The default value for \"gbaUAware\" is false. Description and values defined for the corresponding Diameter AVP in subclause 6.3.1.8 apply.\n-\t\"userId\"\nThis element indicates the user identity. Description in subclause 6.3.1.12 applies.\n-\t\"userIdType\"\nThis element indicates the user identity type, i.e. private or public. Description and values defined for the corresponding Diameter AVP in subclause 6.3.1.13 apply.\n-\t\"uiccAppLabel\"\nThis element includes the UICC application identity to be used. Description in subclause 6.3.1.14 applies.\n-\t\"uiccOrMe\"\nThis element indicates the BSF whether GBA_ME or GBA_U is to be used for GBA push. Description and values defined for the corresponding Diameter AVP in subclause 6.3.1.15 apply.\n-\t\"requestedLifeTime\"\nThis element indicates the requested key lifetime for the NAF keys. Description in subclause 6.3.1.16 applies.\n-\t\"privateIdRequest\"\n-\tIf this element is present it indicates that the NAF requests the BSF to send the private user identity of the user. Description and values defined for the corresponding Diameter AVP in subclause 6.3.1.17 apply.\"securityFeaturesRequest\"\nIf this element is present it indicates that the NAF requests information on the availability of security features. The element may contain a semicolumn-separated list of security features that are available ordered by preference. Description in subclause 6.3.1.20 applies while the values are defined in Annex A.\nThe NAF may use one or more \"extension\" elements to include additional data to the request, but the BSF may ignore the additional data.\nThis SOAP message shall be sent to BSF, then the URI of the message shall contain the BSF address.\nIn the case the NAF is in a visited network, the NAF contacts the subscriber's home BSF through a GBA-Proxy that is located in the same network as the NAF. The local BSF and the GBA-Proxy may be co-located. See 3GPP TS 33.220 [6].\nStep 2\nThe procedures for step 2 are the same as in step 2 in clause 5.4.\nIf any of the error situations described in step 2 in clause 5.4 arises, the BSF shall respond with a requestGbaPushInfoFault message, as defined in Annex G. The \"errorCode\" element shall contain the corresponding Diameter error code (see clause 6.2.2). If the \"errorText\" is included, it shall contain a human-readable description of the error.\nStep 3\nAfter that, the \"requestGbaPushInfoResponse\" message is sent back to the NAF. The WSDL schema of this message is included in Annex G.\nFollowing elements are included into this message:\n-\t\"impi\"\nThis element is optionally included according to BSF configuration. It is only returned if requested and public user identity was used in \"requestGbaPushInfoRequest\" message.  Description for User-Name AVP from 3GPP TS 29.229 [3] applies.\n-\t\"meKeyMaterial\"\nIt includes the mandatory common key material with the ME (Ks_NAF or Ks_ext_NAF). Description in subclause 6.3.1.6 applies.\n-\t\"uiccKeyMaterial\"\nThis element is the common key material with the UICC (Ks_int_NAF). It is optionally sent only if the \"uiccType\" tag in \"bsfInfo\" (received by BSF from the HSS over Zh) is set to \"GBA_U\". Description in subclause 6.3.1.7 applies.\n-\t\"keyExpiryTime\"\nIt contains the expiry time of the Bootstrapping information in the BSF according its configuration. If a special key lifetime value is given in the \"lifeTime\" tag inside the \"bsfInfo\" (received by BSF from the HSS over Zh) in bootstraping procedure, it shall be used instead of the BSF default configuration value when the expiry time is calculated. Description in subclause 6.3.1.5 applies.\n-\t\"bootstrappingInfoCreationTime\"\nThis element contains the bootstrapinfo creation time, i.e., creation time of the Bootstrapping information in the BSF. Description in subclause 6.3.1.9 applies.\n-\t\"gbaType\"\nThis element indicates the type of used authentication in the bootstrapping procedure to the NAF in \"gbaType\" element. It shall be included if other than 3G GBA type has been performed. Description and values defined for the corresponding Diameter AVP in subclause 6.3.1.11 apply.\n-\t\"ussList\"\nThis element is optionally included. The BSF shall select the appropriate User Security Settings (if any) into the \"ussList\" element from stored GAA-UserSecSettings in Bootstrapping information according \"gsid\" elements in the request message. The \"ussList\" element contains a standalone XML document whose root element shall be \"ussList\" element as specified in Annex A and which contains the User Security Settings selected by the BSF. Description in subclause 6.3.1.1 applies.\n-\t\"gbaPushInfo\"\nThis element includes the GPI. Description in subclause 6.3.1.18 applies.\n-\t\"securityFeaturesResponse\"\nIf the BSF supports the usage of securityFeature and the NAF has requested the securityFeatures from the BSF in the request, the BSF shall extract securityFeatures element from the \"bsfInfo\" element in subscriber's GUSS and add those security features to the securityFeaturesResponse element in the response which are common in the received \"securityFeaturesRequest\" from the NAF and the extracted information from the \"bsfInfo\" element. The common security features are added to the \"SecurityFeaturesResponse\" element in the order as they appear in the \"bsfInfo\" element. If \"securityFeatures\" element is not defined in the GUSS or there is no common \"securityFeature\", the BSF shall add empty string to the \"securityFeaturesResponse\" element in the response. Description in subclause 6.3.1.21 applies while the values are defined in Annex A.\nThe BSF may use one or more \"extension\" elements to include additional data to the request, but the NAF may ignore the additional data.\nWhen the NAF receives the \"requestGbaPushInfoResponse\" message, the NAF shall check the value of the \"gbaType\" element if it is included in the message. If the NAF does not support the GBA type the NAF shall stop processing the message and should indicate an error via the O&M subsystem. The further procedure in the NAF when the \"requestGbaPushInfoResponse\" message is received is described in 3GPP TS 33.220 [5], 3GPP TS 33.222 [11] and optionally in GAA service type specific TSs.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_5.4",
        "clause_6",
        "clause_6.3.1.19",
        "clause_6.3.1.3",
        "clause_6.3.1.4",
        "clause_6.3.1.8",
        "clause_6.3.1.12",
        "clause_6.3.1.13",
        "clause_6.3.1.14",
        "clause_6.3.1.15",
        "clause_6.3.1.16",
        "clause_6.3.1.17",
        "clause_6.3.1.20",
        "clause_6.2.2",
        "clause_6.3.1.6",
        "clause_6.3.1.7",
        "clause_6.3.1.5",
        "clause_6.3.1.9",
        "clause_6.3.1.11",
        "clause_6.3.1.1",
        "clause_6.3.1.18",
        "clause_6.3.1.21",
        "figure_5.5",
        "figure_5.4",
        "ts_33.220",
        "ts_29.229",
        "ts_33.222"
      ]
    },
    {
      "chunk_id": "ts_29.109_6.0",
      "section_id": "6.0",
      "section_title": "Introduction",
      "content": "The Zh, Zn and Zpn interface protocols are defined as IETF vendor specific Diameter applications, where the vendor is 3GPP. The vendor identifier assigned by IANA to 3GPP (http://www.iana.org/assignments/enterprise-numbers) is 10415.\nThe Diameter application identifier assigned to the Zh interface application is 16777221 (allocated by IANA).\nThe Diameter application identifiers assigned to the Zn and Zpn interface application are 16777220 and 16777268 respectively (allocated by IANA).",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.1",
      "section_id": "6.1",
      "section_title": "Command-Code values",
      "content": "The Zn and Zpn interfaces assign new Command-Codes 310 and 312.\nThe messages in Zh interface use the same Command-Code value 303 as Multimedia-Auth-Request/Answer messages defined in 3GPP TS 29.229 [3] for Cx interface.\nAs the Diameter commands used over Zh, Zn and Zpn have been defined based on the former specification of the Diameter base protocol, the Vendor-Specific-Application-Id AVP is still listed as a required AVP (an AVP indicated as {AVP}) in the command code format specifications defined in this specification to avoid backward compatibility issues, even if the use of this AVP has been deprecated in the new specification of the Diameter base protocol (IETF RFC 6733 [33]).",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.229"
      ]
    },
    {
      "chunk_id": "ts_29.109_6.2",
      "section_id": "6.2",
      "section_title": "Result-Code AVP values",
      "content": "This section defines new result code values that must be supported by all Diameter implementations that conform to this specification. When one of the result codes defined here is included in a response, it shall be inside an Experimental-Result AVP and Result-Code AVP shall be absent.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.2.1",
      "section_id": "6.2.1",
      "section_title": "Success",
      "content": "Errors that fall within the Success category are used to inform a peer that a request has been successfully completed.\nThe success category result codes defined in 3GPP TS 29.229 [3] for Cx interface are useless and therefore not required in Zh, Zn and Zpn interfaces.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.229"
      ]
    },
    {
      "chunk_id": "ts_29.109_6.2.2",
      "section_id": "6.2.2",
      "section_title": "Permanent failures",
      "content": "Errors that fall within the Permanent Failures category are used to inform the peer that the request failed, and should not be attempted again.\nThe Permanent failure category result codes defined in 3GPP TS 29.229 [3] for Cx interface are useless and therefore not required in Zh , Zn and Zpn interfaces.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.229"
      ]
    },
    {
      "chunk_id": "ts_29.109_6.2.2.1",
      "section_id": "6.2.2.1",
      "section_title": "DIAMETER_ERROR_IDENTITY_UNKNOWN (5401)",
      "content": "A message was received by the HSS for an IMPI or IMPU that is unknown.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.2.2.2",
      "section_id": "6.2.2.2",
      "section_title": "DIAMETER_ERROR_NOT_AUTHORIZED (5402)",
      "content": "A message was received by the BSF which the BSF can not authorize. In this case the NAF should indicate to the UE that the service is not allowed. In case of GBA push, the NAF should not contact the UE.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.2.2.3",
      "section_id": "6.2.2.3",
      "section_title": "DIAMETER_ERROR_TRANSACTION_IDENTIFIER_INVALID (5403)",
      "content": "A message was received by the BSF for an invalid (e.g. unknown or expired) Bootstrapping Transaction Identifier (B-TID). In this case the NAF should request the UE to bootstrap again.",
      "chunk_type": "parameter",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3",
      "section_id": "6.3",
      "section_title": "AVPs",
      "content": "The AVPs defined in 3GPP TS 29.229 [3] for 3GPP IMS Cx interface Multimedia-Auth-Request/Answer messages are used as they are.\nThe following table describes the additional new Diameter AVPs defined for the Zh, Zn and Zpn interface protocol, their AVP Code values, types, possible flag values and whether or not the AVP may be encrypted. The Vendor-Id header of all AVPs defined in this specification shall be set to 3GPP (10415).\nTable 6.1: New Diameter Multimedia Application AVPs\nAVP Flag rules\nAttribute Name\nAVP Code\nSection defined\nValue Type\nMust\nMay\nShould not\nMust not\nMay Encr.\nGBA-UserSecSettings\n400\n6.3.1.1\nOctedString\nM, V\nNo\nTransaction-Identifier\n401\n6.3.1.2\nOctetString\nM, V\nNo\nNAF-Id\n402\n6.3.1.3\nOctetString\nM, V\nNo\nGAA-Service-Identifier\n403\n6.3.1.4\nOctedString\nM, V\nNo\nKey-ExpiryTime\n404\n6.3.1.5\nTime\nM, V\nNo\nME-Key-Material\n405\n6.3.1.6\nOctedString\nM, V\nNo\nUICC-Key-Material\n406\n6.3.1.7\nOctedString\nM, V\nNo\nGBA_U-Awareness-Indicator\n407\n6.3.1.8\nEnumerated\nM, V\nNo\nBootstrapInfoCreationTime\n408\n6.3.1.9\nTime\nM, V\nNo\nGUSS-Timestamp\n409\n6.3.1.10\nTime\nV\nM\nNo\nGBA-Type\n410\n6.3.1.11\nEnumerated\nM, V\nNo\nUE-Id\n411\n6.3.1.12\nOctetString\nM, V\nNo\nUE-Id-Type\n412\n6.3.1.13\nEnumerated\nM, V\nNo\nUICC-App-Label\n413\n6.3.1.14\nOctetString\nM, V\nNo\nUICC-ME\n414\n6.3.1.15\nEnumerated\nM, V\nNo\nRequested-Key-Lifetime\n415\n6.3.1.16\nTime\nM, V\nNo\nPrivate-Identity-Request\n416\n6.3.1.17\nEnumerated\nM, V\nNo\nGBA-Push-Info\n417\n6.3.1.18\nOctedString\nM, V\nNo\nNAF-SA-Identifier\n418\n6.3.1.19\nOctedString\nM, V\nNo\nSecurity-Feature-Request\n419\n6.3.1.20\nOctetString\nM,V\nNo\nSecurity-Feature-Response\n420\n6.3.1.21\nOctetString\nM,V\nNo\nNOTE 1:\tThe AVP header bit denoted as ‘M’, indicates whether support of the AVP is required. The AVP header bit denoted as ‘V’, indicates whether the optional Vendor-ID field is present in the AVP header.",
      "chunk_type": "general",
      "cross_references": [
        "table_6.1",
        "ts_29.229"
      ]
    },
    {
      "chunk_id": "ts_29.109_6.3.1.1",
      "section_id": "6.3.1.1",
      "section_title": "GBA-UserSecSettings AVP",
      "content": "The GBA-UserSecSettings AVP (AVP code 400) is of type OctetString. If transmitted on the Zh interface it contains GBA user security settings (GUSS). If transmitted on the Zn interface it contains the relevant USSs only. The content of GBA-UserSecSettings AVP is a XML document whose root element shall be the \"guss\" element for Zh interface and the \"ussList\" element for the Zn interface. The XML schema is defined in annex A.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.2",
      "section_id": "6.3.1.2",
      "section_title": "Transaction-Identifier AVP",
      "content": "The Transaction-Identifier AVP (AVP code 401) is of type OctetString. This AVP contains the Bootstrapping Transaction Identifier (B-TID).",
      "chunk_type": "parameter",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.3",
      "section_id": "6.3.1.3",
      "section_title": "NAF-Id",
      "content": "The NAF-Id AVP (AVP code 402) is of type OctetString. This AVP contains the full qualified domain name (FQDN) of the NAF that the UE uses concatenated with the Ua security protocol identifier as specified in 3GPP TS 33.220 [5]. The FQDN of the NAF that is part of the NAF_Id may be a different domain name that with which the BSF knows the NAF.",
      "chunk_type": "general",
      "cross_references": [
        "ts_33.220"
      ]
    },
    {
      "chunk_id": "ts_29.109_6.3.1.4",
      "section_id": "6.3.1.4",
      "section_title": "GAA-Service-Identifier AVP",
      "content": "The GAA-Service-identifier AVP (AVP code 403) is of type OctedString. This AVP informs a BSF about the support of a GAA-service by the NAF. According this AVP the BSF can select the right service’s user security settings.\nFor 3GPP standardized services (e.g., PKI portal), the GAA-Service-Identifier (GSID) shall be in the range 0 to 999999, and the currently standardized values for GSID shall be the GAA Service Type Code of the particular service. The GAA Service Type Codes for 3GPP standardized services are defined in Annex B.\nNOTE:\tIn the future, standardized GSID values that are different than the GAA Service Type Code may be  standardised (e.g. to differentiate between the services \"MBMS streaming\" and \"MBMS download\") and then several different GSID can exist within one GAA Service Type Code.\nExamples:\tThe GSID is \"1\" for all PKI-portals, and \"4\" for all MBMS services.",
      "chunk_type": "parameter",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.5",
      "section_id": "6.3.1.5",
      "section_title": "Key-ExpiryTime AVP",
      "content": "The Key-ExpiryTime AVP (AVP code 404) is of type Time. This AVP informs the NAF about the expiry time of the key.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.6",
      "section_id": "6.3.1.6",
      "section_title": "ME-Key-Material AVP",
      "content": "The required ME-Key-Material AVP (AVP code 405) is of type OctetString. The NAF is sharing this key material (Ks_NAF in the case of GBA_ME or Ks_ext_NAF in the case of GBA_U) with the Mobile Equipment (ME).",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.7",
      "section_id": "6.3.1.7",
      "section_title": "UICC-Key-Material AVP",
      "content": "The condition UICC-Key-Material AVP (AVP code 406) is of type OctetString. The NAF may share this key material (Ks_int_NAF in the case of GBA_U) with a security element (e.g. USIM, ISIM, etc..) in the UICC. Only some GAA applications use this conditional AVP.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.8",
      "section_id": "6.3.1.8",
      "section_title": "GBA_U-Awareness-Indicator",
      "content": "The conditional GBA_U-Awareness-Indicator AVP (AVP code 407) is of type Enumerated. The following values are defined.\nNO (0)\tThe sending node is not GBA_U aware\nYES(1)\tThe sending node is GBA_U aware\nThe default value is 0 i.e. absence of this AVP indicates that the sending node is not GBA_U aware.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.9",
      "section_id": "6.3.1.9",
      "section_title": "BootstrapInfoCreationTime AVP",
      "content": "The BootstrapInfoCreationTime AVP (AVP code 408) is of type Time. This AVP informs the NAF about the bootstrapinfo cration time of the key.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.10",
      "section_id": "6.3.1.10",
      "section_title": "GUSS-Timestamp AVP",
      "content": "The GUSS-Timestamp AVP (AVP code 409) is of type Time. If transmitted this AVP informs the HSS about the timestamp of the GUSS stored in the BSF.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.11",
      "section_id": "6.3.1.11",
      "section_title": "GBA-Type",
      "content": "The GBA-Type AVP (AVP code 410) is of type Enumerated. The AVP informs the NAF about the authentication type that was used during bootstrapping procedure.\nThe following values are defined:\n-\t3G GBA (0)\t\tThe 3G GBA has been performed as defined in TS 33.220 [5].\n-\t2G GBA (1)\t\tThe 2G GBA has been performed as defined in TS 33.220 [5] , Annex I.\n-\tGBA Digest (2)\tThe GBA Digest has been performed as defined in TS 33.220 [5], Annex M.\nThe default value is 0 i.e. the absence of this AVP indicates 3G GBA. The value 2 is not applicable for Zpn.",
      "chunk_type": "general",
      "cross_references": [
        "ts_33.220"
      ]
    },
    {
      "chunk_id": "ts_29.109_6.3.1.12",
      "section_id": "6.3.1.12",
      "section_title": "UE-Id",
      "content": "The UE-Id AVP (AVP code 411) is of type OctedString. The AVP informs the BSF the identity of the user.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.13",
      "section_id": "6.3.1.13",
      "section_title": "UE-Id-Type",
      "content": "The UE-Id-Type AVP (AVP code 412) is of type Enumerated. The AVP informs the BSF the type of the identity of the user.\nThe following values are defined:\n-\t(0)\tPrivate user identity.\n-\t(1)\tPublic user identity.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.14",
      "section_id": "6.3.1.14",
      "section_title": "UICC-App-Label",
      "content": "The UICC-App-Label AVP (AVP code 413) is of type OctedString. The AVP informs the BSF the UICC application to be used for GBA push.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.15",
      "section_id": "6.3.1.15",
      "section_title": "UICC-ME",
      "content": "The UICC-ME AVP (AVP code 414) is of type Enumerated. The AVP informs the BSF the whether GBA_ME or GBA_U is to be used for GBA push.\nThe following values are defined:\n-\tGBA_ME (0)\tGBA_ME shall be run.\n-\tGBA_U (1)\t\tGBA_U shall be run.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.16",
      "section_id": "6.3.1.16",
      "section_title": "Requested-Key-Lifetime",
      "content": "The Requested-Key-Lifetime AVP (AVP code 415) is of type Time. The AVP informs the BSF about the requested lifetime for the NAF keys.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.17",
      "section_id": "6.3.1.17",
      "section_title": "Private-Identity-Request",
      "content": "The Private-Identity-Request AVP (AVP code 416) is of type Enumerated. The AVP informs the BSF if the NAF requests the private identity of the user.\nThe following values are defined:\n-\tPrivate identity requested (0)\t.\n-\tPrivate identity not requested (1)",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.18",
      "section_id": "6.3.1.18",
      "section_title": "GBA-Push-Info",
      "content": "The GBA-Push-Info AVP (AVP code 417) is of type OctetString. The AVP includes the GBA-Push-Info as defined in 3GPP TS 33.223 [23].",
      "chunk_type": "general",
      "cross_references": [
        "ts_33.223"
      ]
    },
    {
      "chunk_id": "ts_29.109_6.3.1.19",
      "section_id": "6.3.1.19",
      "section_title": "NAF-SA-Identifier",
      "content": "The NAF-SA-Identifier AVP (AVP code 418) is of type OctetString. The AVP contains the NAF-SA-Identifier (P-TID). See 3GPP TS 33.223 [23].",
      "chunk_type": "parameter",
      "cross_references": [
        "ts_33.223"
      ]
    },
    {
      "chunk_id": "ts_29.109_6.3.1.20",
      "section_id": "6.3.1.20",
      "section_title": "Security-Feature-Request",
      "content": "The Security-Feature-Request AVP (AVP code 419) is of type OctetString. The AVP contains one or several of the security features requested by the NAF. The values are defined in Annex A.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.3.1.21",
      "section_id": "6.3.1.21",
      "section_title": "Security-Feature-Response",
      "content": "The Security-Feature-Request AVP (AVP code 420) is of type OctetString. The AVP contains one or several of the security features identified by the HSS. This information is conveyed to the BSF using the \"securityFeatures\" element in the \"bsfElement\" of GUSS (cf. Annex A), and the securityFeatures received in the request. The values are defined in Annex A.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_29.109_6.4",
      "section_id": "6.4",
      "section_title": "User identity to HSS resolution",
      "content": "The User identity to HSS resolution mechanism enables the BSF to find the identity of the HSS that holds the subscriber data for a given subscriber when multiple and separately addressable HSSs have been deployed by the network operator. The resolution mechanism is not required in networks that utilise a single HSS or when a BSF is configured to use pre-defined HSS.\nThe resolution mechanism is equivalent to the mechanism defined for the Cx/Dx interface described in 3GPP TS 23.228 [12] and shall use a Subscription Locator Function (SLF) or a Diameter Proxy Agent.\nThe BSF accesses the SLF via the Dz interface. The Dz interface shall be always used in conjunction with the Zh interface. The Dz interface is based on Diameter base protocol as specified in IETF RFC 6733 [33]. The SLF functionality shall use the routing mechanism provided by an enhanced Diameter redirect agent, which is able to extract the Subscriber identity from the received requests.\nThe SLF or the Diameter Proxy Agent shall be able to determine the HSS identity.\nTo get the HSS identity the BSF shall send the Zh request normally destined to the HSS to a pre-configured Diameter identity.\n-\tIf this Zh request is received by an SLF (acting as a Diameter redirect agent), the SLF shall determines the HSS identity and shall send to the BSF a notification of redirection towards the HSS identity, in response to the Zh request. Multiple HSS identities may be included in the response, as specified in IETF RFC 6733 [33]. In such a case, the BSF shall send the Zh Request to the first HSS identity in the ordered list received in the Zh Response from the SLF. If the BSF does not receive a successful response to the Zh Request, the BSF shall send a Zh Request to the next HSS identity in the ordered list. This procedure shall be repeated until a successful response from an HSS is received.\n-\tIf this Zh request is received by the Diameter Proxy Agent, the Diameter Proxy Agent shall determine the HSS identity and shall forward the Zh request directly to the HSS. The BSF shall determine the HSS identity from the response to the Zh request received from the HSS.\nAfter the user identity to HSS resolution, the BSF may store the HSS identity and, if stored, shall use it in further Zh requests associated to the same Subscriber.\nIn networks where the use of the user identity to HSS resolution mechanism is required and the BSF is not configured to use predefined HSS, each BSF shall be configured with the address/name of the SLF or the Diameter Proxy Agent implementing this resolution mechanism.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.228"
      ]
    },
    {
      "chunk_id": "ts_29.109_7",
      "section_id": "7",
      "section_title": "Use of namespaces",
      "content": "This clause contains the namespaces that have either been created in this 3GPP specification, or in 3GPP specification 3GPP TS 29.229 [3] or the values assigned to existing namespaces managed by IANA.",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.229"
      ]
    },
    {
      "chunk_id": "ts_29.109_7.1",
      "section_id": "7.1",
      "section_title": "AVP codes",
      "content": "This specification reserves the 3GPP vendor specific values 10415:400-499 and assigns values 10415:400-418  for the GAA from the 3GPP AVP Code namespace for 3GPP Diameter applications ([8]). The 3GPP vendor specific AVP code space is managed by 3GPP CT4. See section 6 for the assignment of the namespace in this specification.\nBesides the Diameter base protocol AVPs specified in IETF RFC 6733 [33], this specification reuses the following AVPs from 3GPP TS 29.229 [3]:Authentication-Session-State, User-Name, Public-User-Identity and SIP-Auth-Data-Item.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6",
        "ts_29.229"
      ]
    },
    {
      "chunk_id": "ts_29.109_7.2",
      "section_id": "7.2",
      "section_title": "Experimental-Result-Code AVP values",
      "content": "This specification reserves Experimental-Result-Code AVP values 10415:2401-2409 and 10415:5401-5409. See section 6.2.",
      "chunk_type": "general",
      "cross_references": [
        "clause_6.2"
      ]
    },
    {
      "chunk_id": "ts_29.109_7.3",
      "section_id": "7.3",
      "section_title": "Command Code values",
      "content": "Only Command-Codes 310 and 303 from 3GPP TS 29.229 [3] is used in this specification.\nThis specification reuses only the Command-Code value, not the content of the original specification. The AVPs, that are defined required in TS 29.229 [3], but are not needed in Zh, Zn or Zpn interfaces, are removed and are therefore not required in Zh, Zn or Zpn interface messages. All new AVPs for GAA are defined optional although they may be mandatory in GAA viewpoint.\nThis specification does not assign new command codes to the 3GPP TS 29.229 [3].\nAnnex A (normative):GBA-UserSecSettings XML definition\nThis annex contains the XML schema definition for an XML document carrying the GBA User Security Settings inside GBA-UserSecSettings AVP in Zh,Zn and Zpn interface.\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema targetNamespace=\"urn:3gpp:gba:GBAGUSSSchema-R9:2010-02\"\nxmlns:tns=\"urn:3gpp:gba:GBAGUSSSchema-R9:2010-02\"\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\nelementFormDefault=\"qualified\"\nattributeFormDefault=\"unqualified\">\n<!-- This import brings in the XML language attribute xml:lang-->\n<xs:import namespace=\"http://www.w3.org/XML/1998/namespace\"\nschemaLocation=\"http://www.w3.org/2001/xml.xsd\"/>\n<!-- Root element to be used in Zh reference point-->\n<xs:element name=\"guss\" type=\"tns:gussType\"/>\n<!-- Root element to be used in Zn reference point-->\n<xs:element name=\"ussList\" type=\"tns:ussListType\"/>\n<xs:complexType name=\"ExtensionType\">\n<xs:sequence>\n<xs:any processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n<xs:complexType name=\"GUSSExtensionType\">\n<xs:sequence>\n<xs:element name=\"timestamp\" type=\"xs:dateTime\" minOccurs=\"0\"/>\n<xs:element name=\"Extension\" type=\"tns:ExtensionType\" minOccurs=\"0\"/>\n</xs:sequence>\n</xs:complexType>\n<xs:complexType name=\"USSExtensionType\">\n<xs:sequence>\n<xs:element name=\"keyChoice\" type=\"xs:string\" minOccurs=\"0\" />\n<xs:element name=\"Extension\" type=\"tns:ExtensionType\" minOccurs=\"0\"/>\n</xs:sequence>\n</xs:complexType>\n<!-- The whole user’s GBA specific data set  -->\n<xs:complexType name=\"gussType\">\n<xs:sequence>\n<xs:element name=\"bsfInfo\" type=\"tns:bsfInfoType\" minOccurs=\"0\"/>\n<xs:element name=\"ussList\" type=\"tns:ussListType\"/>\n<xs:element name=\"Extension\" type=\"tns:GUSSExtensionType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"id\" type=\"xs:string\"/>\n</xs:complexType>\n<!-- BSF specific information element -->\n<xs:complexType name=\"bsfInfoType\">\n<xs:sequence>\n<xs:element name=\"uiccType\"  type=\"xs:string\"  minOccurs=\"0\" />\n<xs:element name=\"lifeTime\"  type=\"xs:integer\" minOccurs=\"0\" />\n<xs:element name=\"securityFeatures\"  type=\"xs:string\" minOccurs=\"0\" />\n<xs:element name=\"Extension\" type=\"tns:ExtensionType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n<!--List of all users individual User Security Settings -->\n<xs:complexType name=\"ussListType\">\n<xs:sequence minOccurs=\"0\" maxOccurs=\"unbounded\">\n<xs:element name=\"uss\" type=\"tns:ussType\"/>\n<xs:element name=\"Extension\" type=\"tns:ExtensionType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n<!-- User Security Setting data -->\n<xs:complexType name=\"ussType\">\n<xs:sequence>\n<xs:element name=\"uids\" type=\"tns:uidsType\"/>\n<xs:element name=\"flags\" type=\"tns:flagsType\"/>\n<xs:element name=\"Extension\" type=\"tns:USSExtensionType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"id\"   use=\"required\" type=\"xs:string\"/>    <xs:attribute name=\"type\" use=\"required\" type=\"xs:int\"/>\n<xs:attribute name=\"nafGroup\" use=\"optional\" type=\"xs:string\"/>\n</xs:complexType>\n<!-- User Public Identities for authentication -->\n<xs:complexType name=\"uidsType\">\n<xs:sequence minOccurs=\"1\" maxOccurs=\"unbounded\">\n<xs:element name=\"uid\"  type=\"xs:string\"/>\n<xs:element name=\"Extension\" type=\"tns:ExtensionType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n<!-- GAA Application type specific Authorization flag codes -->\n<xs:complexType name=\"flagsType\">\n<xs:sequence minOccurs=\"0\" maxOccurs=\"unbounded\">\n<xs:element name=\"flag\"  type=\"xs:int\"/>\n<xs:element name=\"Extension\" type=\"tns:ExtensionType\" minOccurs=\"0\"/>\n<xs:any namespace=\"##other\" processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:complexType>\n</xs:schema>\nNOTE 1:\tThe <xs:any> elements within the complex types ExtensionType allow for compatible standard extensions in future releases. The <xs:any namespace=##other\"> elements within the other complex types allow for compatible private extensions.\nThe values are:\n-\tThe value of the attribute \"id\" in the element \"guss\" is the same as user’s IM Private Identity (IMPI) used in User-Name AVP.\n-\tThe value of the element \"timestamp\" in the element \"guss\" is the same type as GUSS-Timstamp used in GUSS-Timestamp AVP and indicates the timestamp of the GUSS. Timestamp value shall be expressed in UTC form, indicated by a time zone designator \"Z\" immediately following the time portion of the value.\n-\tThe value of the attribute \"id\" in the element \"uss\" is the same as service identifier (GSID) used in GAA-Service-Identifier AVP.\nNOTE 2: \tIn the case with currently standardized 3GPP applications (c. f. Annex B), the service identifier (GSID) is the same as the GAA Service Type Code i.e. the \"id\" and the \"type\" attribute would have the same value. For example, in the interoperator GAA where the requesting BM-SC (i.e. NAF) is different operator network than the answering BSF, the BM-SC (NAF) can request particular user's MBMS USS by using \"4\" for the GSID in  the \"id\" attribute in the USS. If the BSF operator wishes to have different MBMS USSs for different BM-SCs (NAFs), it can use the nafGroup attribute to separate NAFs to specific groups, and each group would get a particular USSs: <uss id=\"4\" type=\"4\" nafGroup=\"A\"> would be given to NAFs in group A, and <uss id=\"4\" type=\"4\" nafGroup=\"B\"> would be given to NAFs in group B when they request it. NAF groups are operator specific, i.e., operator decides which USS is given to which NAF.\"\n-\tThe value of the element \"uiccType\" in the element \"bsfInfo\" is:GBA to indicate the basic case, orGBA_U to indicate that generation of Ks_int_NAF is also required in the BSF. The default value is GBA.\n-\tThe value of the element \"lifeTime\" in the element \"bsfInfo\" indicates a user specific key lifetime (duration in seconds). If the lifeTime element is missing the default value in the BSF is used.\n-\tThe value of the optional element \"securityFeatures\" in the element \"bsfInfo\" indicates a user specific security feature list that the UE supports. If the securityFeature element is missing then the security features are not defined. If there is a list of several values, they are separated by \";\". Defined values are:\n-\t\"GPL_U\": The UICC supports Generic Push Layer on the UICC as specified in 3GPP TS 33.224 [30].\n-\tThe value of attribute \"type\" in the element \"uss\" is GAA service type code defined in annex B.\n-\tThe value of attribute \"nafGroup\" in the element \"uss\" is an operator internal group designator for a NAF group the USS is valid for. If this attribute is missing then only the attribute \"id\" is used for selection of this element.\n-\tValues of the element \"uid\" are user’s public authentication identities from the HSS.\n-\tValues of element \"flag\" are user’s authorization flag codes from the HSS for GAA service type indicated in the type attribute in the parent uss element. If an authorization flag exist the NAF have permission to give the corresponding service, otherwise not\n-\tThe value of the element \"keyChoice\" in the \"Extension\" element inside the \"uss\" element is \"ME-based-key\", i.e., Ks_ NAF or Ks_ext_NAF shall be used, or \"UICC-based-key\", i.e., Ks_int_NAF shall be used or \"ME-UICC-based-keys\", i.e., Ks_ext_NAF or Ks_int_NAF can be used. The value of this element indicates to the NAF, which key shall be used. If the keyChoice element is missing, then as a default the \"ME-based-key\" shall be used by the NAF unless a prior agreement exists that mandates to use \"UICC-based-key\" or \"ME-UICC-based-keys\".\nIn the following illustrative examples the values are italised and underlined.  The content of one User Security Setting tag is boxed.\n<guss id=\"358500004836551@ims.mnc050.mcc358.3gppnetwork.org\">\n<bsfInfo>\n<lifeTime>86400</lifeTime>\n</bsfInfo>\n<ussList>\n<uss id=\"1\" type=\"1\" nafGroup=\"A\">\n<uids>\n<uid>tel:358504836551</uid>\n<uid>lauri.laitinen@example.com</uid>\n…\n</uids>\n<flags>\n<flag>1</flag>\n…\n</flags>\n<Extension>\n<keyChoice>ME-based-key</keyChoice>\n</Extension>\n</uss>\n…\n</ussList>\n</guss>\nThe above GAA User Security Settings example for user \"358500004836551@ ims.mnc050.mcc358.3gppnetwork.org\" defines that for PKI-Portal (GAA service type code is 1) services are allowed for user identities \"tel:358504836551\" and \"lauri.laitinen@example.com\" and authentication is allowed (flag 1 exists) but non-repudiation is not allowed (flag 2 is missing) to NAFs that provide the GAA service identified by \"1\" GAA Service Identifier. This particular USS for PKI-Portal is intended to be used only with a NAF group that is labeled as \"A\" (NAF groupings and NAFs that belong to these groups are specified by the MNO). Additionally, the key choice for the PKI-Portal should use only ME based key (as key keyChoice is set to \"ME-based-key\"). The BSF shall not generate UICC-Ks, because uiccType is missing. A special key lifetime defines that the duration after which the key expires is 86400 seconds.\n<![CDATA[<?xml version='1.0'?>\n<ussList>\n<uss id=\"1\" type=\"1\">\n<uids>\n<uid>tel:358504836551</uid>\n<uid>lauri.laitinen@example.com</uid>\n</uids>\n<flags>\n<flag>1</flag>\n</flags>\n<Extension>\n<keyChoice>ME-based-key</keyChoice>\n</Extension>\n</uss>\n</ussList>\n]]>\nThe above is an example how the value of \"GAA-UserSecSettings\" in Diameter based Zn reference point and \"ussList\" in Web Services based Zn reference point is populated.\nNOTE 3:\tThe BSF has removed the \"nafGroup\" attribute from \"uss\" element. Also, the XML document has been surrounded by \"<![CDATA[\" and \"]]>\" tags, so that the XML parser handling the outer message (i.e., in Web Services case) will not parse the ussList. The ussList will be parsed by the application itself handling the incoming message.\nBelow is an example illustrating the usage of the flag for service authorization. The content of one User Security Setting tag is boxed.\n<guss id=\"358501234567@ims.mnc050.mcc358.3gppnetwork.org\">\n<bsfInfo>\n<lifeTime>86400</lifeTime>\n</bsfInfo>\n<ussList>\n<uss id=\"8\" type=\"8\" nafGroup=\"A\">\n<uids>\n<uid>tel:358501234567</uid>\n<uid>pekka.mustermann@example.com</uid>\n…\n</uids>\n<flags>\n<flag>1</flag>\n…\n</flags>\n<Extension>\n<keyChoice>ME-based-key</keyChoice>\n…\n</Extension>\n</uss>\n…\n</ussList>\n</guss>\nThe above GAA User Security Settings example for user \"358501234567@ ims.mnc050.mcc358.3gppnetwork.org\" defines that for ANDSF (GAA service type code is 8) services are allowed for user identities \"tel:358501234567\" and \"pekka.mustermann@example.com\" and authentication is allowed (flag 1 exists) i.e. the user is authorized to use the ANDSF service according to the policy stored in the ANDSF server.  If the flag contains a 0 or is missing, the stated user identities would not be authorized to use the GAA service identified by \"8\" GAA Service Identifier. Additionally, the key choice for the ANDSF should use only ME based key (as key keyChoice is set to \"ME-based-key\").\nAnalogously, the authorization flag is used for OpenID GBA Interworking (GAA Service Type Code 11) the authentication is allowed (flag 1 exists) i.e. the user is authorized to use the OpenID-GBA Interworking service. If the flag contains a 0 or is missing, the stated user identities would not be authorized to use the GAA service identified by \"11\" GAA Service Identifier. Additionally, the key choice for the OpenID/GBA Interworking should use only ME based key if the keyChoice extension is set to \"ME-based-key\".\nAnnex B (normative):  GAA Service Type Codes\nThe GAA Service Type Code values are used in GAA to indicate interpretation, coding and usage of GAA service type specific data.\nFor examples each GAA service type may have their own set of authorization flags. Meaning and coding of these flags are defined in Annex C. There may also be proprietary GAA service types with their own definitions in the future.\nCode values 0 – 999999 are reserved for standardized GAA service types.\nThe following values are defined for standardized GAA service types with 3GPP specification:\n0\tUnspecific service 1\tPKI-Portal 2\tAuthentication Proxy3\tPresence 4\tMBMS5\tLiberty Alliance Project (see [15])\n6\tUICC - Terminal Key Establishment (see [17])\n7 \tTerminal – Remote Device Key Establishment (see [18])\n8\tANDSF (see [24])\n9.\tGBA Push (see [25])\n10\tIMS based PSS MBMS (see [26])\n11\tOpenID GBA Interworking (see [29])\n12\tGeneric Push Layer (see [30])\nDefault value is 0. An unspecific service may or may not have user security settings containing or not a list of public identities. An unspecific service cannot have specified authorization flags or other service type specific data.\nAnnex C (normative):  GAA Authorization flag codes\nFor GAA services which have a defined set of special authorization flag codes the following rule holds: The service specified by the GAA authorization flag codes is allowed for a user only if user’s user security setting contains that flag.\nThe following standardised GAA service types that are listed in previous annex B have the following special authorization flag codes:\nPKI-Portal (1)\n1\tAuthentication allowed\n2\tNon-repudiation allowed\nANDSF (8)\n0\tNot authorized\n1\tAuthorized according to policy stored in ANDSF server\nOpenID Interworking (13)\n0\tNot authorized\n1\tAuthorized\nAnnex D (normative): Web Services Definition for Zn interface\nThis annex contains the Web Services Defination Language (WSDL) [14] for Zn interface:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsdl:definitions name=\"GBAService\"\ntargetNamespace=\"urn:3gpp:gba:GBAService:2010-02\"\nxmlns:typens=\"urn:3gpp:gba:GBAService:2010-02\"\nxmlns:wsdl=\"http://schemas.xmlsoap.org/wsdl/\"\nxmlns:soap=\"http://schemas.xmlsoap.org/wsdl/soap/\"\nxmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\">\n<wsdl:types>\n<xsd:schema targetNamespace=\"urn:3gpp:gba:GBAService:2010-02\">\n<!-- Extension element definition -->\n<xsd:complexType name=\"tExtension\">\n<xsd:sequence>\n<xsd:any processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xsd:sequence>\n</xsd:complexType>\n<!-- Request Bootstrapping info request parameter definitions -->\n<xsd:element name=\"requestBootstrappingInfoRequest\">\n<xsd:complexType>\n<xsd:sequence>\n<xsd:element name=\"btid\" type=\"xsd:string\"/>\n<xsd:element name=\"nafid\" type=\"xsd:base64Binary\"/>\n<xsd:element name=\"gsid\" type=\"xsd:string\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xsd:element name=\"gbaUAware\" type=\"xsd:boolean\" minOccurs=\"0\"/>\n<xsd:element name=\"extension\" type=\"typens:tExtension\" minOccurs=\"0\"/>\n</xsd:sequence>\n</xsd:complexType>\n</xsd:element>\n<!-- Request Bootstrapping info responset parameter definitions -->\n<xsd:element name=\"requestBootstrappingInfoResponse\">\n<xsd:complexType>\n<xsd:sequence>\n<xsd:element name=\"impi\" type=\"xsd:string\" minOccurs=\"0\"/>\n<xsd:element name=\"meKeyMaterial\" type=\"xsd:base64Binary\"/>\n<xsd:element name=\"uiccKeyMaterial\" type=\"xsd:base64Binary\" minOccurs=\"0\"/>\n<xsd:element name=\"keyExpiryTime\" type=\"xsd:dateTime\"/>\n<xsd:element name=\"bootstrappingInfoCreationTime\" type=\"xsd:dateTime\"/>\n<xsd:element name=\"gbaType\" type=\"xsd:string\" minOccurs=\"0\"/>\n<xsd:element name=\"ussList\" type=\"xsd:string\" minOccurs=\"0\"/>\n<xsd:element name=\"extension\" type=\"typens:tExtension\" minOccurs=\"0\"/>\n</xsd:sequence>\n</xsd:complexType>\n</xsd:element>\n<!-- Request Bootstrapping info fault parameter definitions -->\n<xsd:element name=\"requestBootstrappingInfoFault\">\n<xsd:complexType>\n<xsd:sequence>\n<xsd:element name=\"errorCode\" type=\"xsd:integer\"/>\n<xsd:element name=\"errorText\" type=\"xsd:string\" minOccurs=\"0\"/>\n</xsd:sequence>\n</xsd:complexType>\n</xsd:element>\n</xsd:schema>\n</wsdl:types>\n<wsdl:message name=\"requestBootstrappingInfoRequestMessage\">\n<wsdl:part name=\"body\" element=\"typens:requestBootstrappingInfoRequest\"/>\n</wsdl:message>\n<wsdl:message name=\"requestBootstrappingInfoResponseMessage\">\n<wsdl:part name=\"body\" element=\"typens:requestBootstrappingInfoResponse\"/>\n</wsdl:message>\n<wsdl:message name=\"requestBootstrappingInfoFaultMessage\">\n<wsdl:part name=\"body\" element=\"typens:requestBootstrappingInfoFault\"/>\n</wsdl:message>\n<wsdl:portType name=\"GBAServicePortType\">\n<wsdl:operation name=\"requestBootstrappingInfo\">\n<wsdl:input message=\"typens:requestBootstrappingInfoRequestMessage\"/>\n<wsdl:output message=\"typens:requestBootstrappingInfoResponseMessage\"/>\n<wsdl:fault name=\"FaultName\" message=\"typens:requestBootstrappingInfoFaultMessage\"/>\n</wsdl:operation>\n</wsdl:portType>\n<wsdl:binding name=\"GBAServiceBinding\" type=\"typens:GBAServicePortType\">\n<soap:binding style=\"document\" transport=\"http://schemas.xmlsoap.org/soap/http\"/>\n<wsdl:operation name=\"requestBootstrappingInfo\">\n<soap:operation soapAction=\"urn:3gpp:gba:GBAServiceAction:2007-05\"/>\n<wsdl:input>\n<soap:body use=\"literal\"/>\n</wsdl:input>\n<wsdl:output>\n<soap:body use=\"literal\"/>\n</wsdl:output>\n<wsdl:fault name=\"FaultName\">\n<soap:fault name=\"FaultName\" use=\"literal\"/>\n</wsdl:fault>\n</wsdl:operation>\n</wsdl:binding>\n<wsdl:service name=\"GBAService\">\n<wsdl:port name=\"GBAServicePort\" binding=\"typens:GBAServiceBinding\">\n<!-- add SOAP address location URI below -->\n<soap:address location=\"http://add.here.uri.to/GBAService\"/>\n</wsdl:port>\n</wsdl:service>\n</wsdl:definitions>\nAnnex E (informative):Liberty authentication context definitions for GBA\nE.1\tIntroduction\nThis clause describes the GBA Authentication Context definition that the Liberty Identity Provider uses to describe GBA parameters to Liberty Service Provider. The Liberty 3GPP Security Interworking is further discussed in 3GPP TR 33.980 [15].\nE.2\tGBA Authentication context statement data model\nA particular Liberty authentication context statement will capture the characteristics of the process, procedures, and mechanisms by which the authentication authority verified the subject before issuing an identity, protects the secrets on which subsequent authentications are based, and the mechanisms used for this authentication. These characteristics are categorized in the Liberty ID-FF Authentication Context Specification [16] as follows:\n-\tIdentification - Characteristics that describe the processes and mechanism the authentication authority uses to initially create an association between a subject and the identity (or name) by which the subject will be known.\n-\tTechnical Protection - Characteristics that describe how the \"secret\" (the knowledge or possession of which allows the subject to authenticate to the authentication authority) is kept secure.\n-\tOperational Protection - Characteristics that describe procedural security controls employed by the authentication authority (for example, security audits, records archival).\n-\tAuthentication Method - Characteristics that define the mechanisms by which the subject of the issued assertion authenticates to the authentication authority (for example, a password versus a smartcard).\n-\tGoverning Agreements - Characteristics that describe the legal framework (e.g. liability constraints and contractual obligations) underlying the authentication event and/or its associated technical authentication infrastructure.\nCompared to Liberty Authentication Context [16], the GBA Authentication Context statement data model adds a description to to which GBA mechanism was used during bootstrapping with the BSF, and how the corresponding shared secret was used with the Identity Provider (IdP) that functions as a NAF.\nThe authentication contexts classes specific to mobile terminals specified by Liberty Alliance are called\n-\tMobileOneFactorUnregistered,\n-\tMobileTwoFactorUnregistered,\n-\tMobileOneFactorContract, and\n-\tMobileTwoFactorContract classes.\nThe GBA authentication context uses some of the elements in these classes and introduces a new element called \"GBAMechanism\", which can be used to describe GBA specific parameters of the authentication. The elements used in the GBA Authentication Context schemas are:\n-\tGBAMechanismType: describes the GBA bootstrapping mechanism (identifies the method used over Ub reference point);\n-\tAuthenticatorTransportProtocolType: describes the authentication mechanism that was used authenticate the UE towards the Liberty Identity Provider (identifies the method used over Ua reference point);\n-\tKeyActivationType: describes the mechanism to achieve two factor authentication (valid in *TwoFactor* authentication schemas).\nE.3\tGBA authentication context statement schema\nThis section lists the complete GBA Authentication Context XML schema. It is based on Liberty Authentication Context XML Schema to which the addition is the additional description of how GBA procedures have been conducted, i.e., GBAMechanism element.\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema targetNamespace=\"urn:3gpp:gba:ac:2006-10\"\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:ac=\"urn:liberty:ac:2004-12\"\nxmlns=\"urn:3gpp:gba:ac:2006-10\">\n<!-- imports Liberty Authentication Context definitions -->\n<xs: import namespace=\"urn:liberty:ac:2004-12\"\nschemaLocation=\"liberty-authentication-context-v2.0.xsd\"/>\n<xs:annotation>\n<xs:documentation>\nThis authentication context has been defined for the\n3GPP and 3GPP2 Generic Bootstrapping Architecture. It\ndefines new GBAMechanismType and its values, but reuses\nthe Liberty authentication context schema for other\nvalues. The GBA authentication context is based on the\nMobileOneFactor* and MobileTwoFactor* authentication\ncontexts with the exception that only shared secret\nbased authentication methods (i.e., symmetric) are used,\nand private key (i.e., asymmetric) methods are not\nused when authenticating the UE due to the nature of GBA.\n</xs:documentation>\n</xs:annotation>\n<!-- new type definitions for different GBA procedures -->\n<xs:element name=\"LegacyGBA\">\n<xs:annotation>\n<xs:documentation>\nLegacy GBA where existing old authentication\nframeworks are used for bootstrapping such\n2G GBA in 3GPP, and CDMA 1x and CDMA 1xEvDo\nin 3GPP2.\n</xs:documentation>\n</xs:annotation>\n</xs:element>\n<xs:element name=\"GBAMobileMobile\">\n<xs:annotation>\n<xs:documentation>\nGBA using AKA as specified in 3GPP and 3GPP2.\nThe shared secret is derived in the mobile and\nused in the mobile.\n</xs:documentation>\n</xs:annotation>\n</xs:element>\n<xs:element name=\"GBAUICCMobile\">\n<xs:annotation>\n<xs:documentation>\nGBA_U using AKA as specified in 3GPP and 3GPP2.\nThe shared secret is derived in the UICC and used\nin the mobile.\n</xs:documentation>\n</xs:annotation>\n</xs:element>\n<xs:element name=\"GBAUICCUICC\">\n<xs:annotation>\n<xs:documentation>\nGBA_U using AKA as specified in 3GPP and 3GPP2.\nThe shared secret is derived in the UICC and used\nin the UICC.\n</xs:documentation>\n</xs:annotation>\n</xs:element>\n<xs:element name=\"GBAMechanism\" type=\"GBAMechanismType\">\n<xs:annotation>\n<xs:documentation>\nGBA mechanism used in the bootstrapping procedure.\n</xs:documentation>\n</xs:annotation>\n</xs:element>\n<xs:complexType name=\"GBAMechanismType\">\n<xs:choice>\n<xs:element ref=\"LegacyGBA\"/>\n<xs:element ref=\"GBAMobileMobile\"/>\n<xs:element ref=\"GBAUICCMobile\"/>\n<xs:element ref=\"GBAUICCUICC\"/>\n</xs:choice>\n</xs:complexType>\n</xs:schema>\nE.4\tGBA authentication context classes\nE.4.1\tGBAOneFactorUnregistered\nThis class reflects that there were no mobile customer registration procedures and an authentication of the UE is done without requiring explict end-user interaction.\nE.4.1.1\tAssociated 3GPP URI\nhttp://www.3gpp.org/schemas/authctx/classes/GBAOneFactorUnregistered\nE.4.1.2\tClass schema\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema targetNamespace=\"urn:3gpp:gba:ac:2006-10\"\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:ac=\"urn:liberty:ac:2004-12\"\nxmlns=\"urn:3gpp:gba:ac:2006-10\"\nfinalDefault=\"extension\"\nversion=\"1.0\">\n<!-- Imports Liberty authentication context schema definitions -->\n<xs:import namespace=\"urn:liberty:ac:2004-12\"\nschemaLocation=\"liberty-authentication-context-v2.0.xsd\"/>\n<!-- includes 3GPP GBA Authentication Context generic definitions -->\n<xs:include schemaLocation=\"3gpp-gba-authentication-context-v1.0.xsd\"/>\n<!-- GBAOneFactorUnregistered -->\n<xs:complexType name=\"GBAOneFactorUnregisteredGBAMechanismType\">\n<xs:complexContent>\n<xs:restriction base=\"GBAMechanismType\">\n<xs:choice>\n<xs:element ref=\"LegacyGBA\"/>\n<xs:element ref=\"GBAMobileMobile\"/>\n<xs:element ref=\"GBAUICCMobile\"/>\n<xs:element ref=\"GBAUICCUICC\"/>\n</xs:choice>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n<!-- states which protocol was used between UE and NAF/IdP to authenticate the UE -->\n<xs:complexType name=\"GBAOneFactorUnregisteredAuthenticatorTransportProtocolType\">\n<xs:complexContent>\n<xs:restriction base=\"ac:AuthenticatorTransportProtocolType\">\n<xs:choice>\n<xs:element ref=\"ac:HTTP\"/> <!-- HTTP Digest over SSL/TLS -->\n<xs:element ref=\"ac:SSL\"/>  <!-- PSK TLS -->\n</xs:choice>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n</xs:schema>\nE.4.2\tGBATwoFactorUnregistered\nThis class reflects that there were no mobile customer registration procedures and a two-factor based authentication of the UE is done requiring an explicit end-user interaction during authentication procedure (e.g., a PIN needs to be typed).\nE.4.2.1\tAssociated 3GPP URI\nhttp://www.3gpp.org/schemas/authctx/classes/GBATwoFactorUnregistered\nE.4.2.2\tClass schema\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema targetNamespace=\"urn:3gpp:gba:ac:2006-10\"\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:ac=\"urn:liberty:ac:2004-12\"\nxmlns=\"urn:3gpp:gba:ac:2006-10\"\nfinalDefault=\"extension\"\nversion=\"1.0\">\n<!-- Imports Liberty authentication context schema definitions -->\n<xs:import namespace=\"urn:liberty:ac:2004-12\"\nschemaLocation=\"liberty-authentication-context-v2.0.xsd\"/>\n<!-- includes 3GPP GBA Authentication Context generic definitions -->\n<xs:include schemaLocation=\"3gpp-gba-authentication-context-v1.0.xsd\"/>\n<!-- GBATwoFactorUnregistered -->\n<xs:complexType name=\"GBATwoFactorUnregisteredGBAMechanismType\">\n<xs:complexContent>\n<xs:restriction base=\"GBAMechanismType\">\n<xs:choice>\n<xs:element ref=\"LegacyGBA\"/>\n<xs:element ref=\"GBAMobileMobile\"/>\n<xs:element ref=\"GBAUICCMobile\"/>\n<xs:element ref=\"GBAUICCUICC\"/>\n</xs:choice>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n<!-- states which protocol was used between UE and NAF/IdP to authenticate the UE -->\n<xs:complexType name=\"GBATwoFactorUnregisteredAuthenticatorTransportProtocolType\">\n<xs:complexContent>\n<xs:restriction base=\"ac:AuthenticatorTransportProtocolType\">\n<xs:choice>\n<xs:element ref=\"ac:HTTP\"/> <!-- HTTP Digest over SSL/TLS -->\n<xs:element ref=\"ac:SSL\"/>  <!-- PSK TLS -->\n</xs:choice>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n<xs:complexType name=\"GBATwoFactorUnregisteredKeyActivationType\">\n<xs:complexContent>\n<xs:restriction base=\"ac:KeyActivationType\">\n<xs:choice>\n<xs:element ref=\"ac:ActivationPin\"/>\n<xs:element ref=\"ac:Extension\" maxOccurs=\"unbounded\"/>\n</xs:choice>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n</xs:schema>\nE.4.3\tGBAOneFactorContract\nThis class reflects that mobile customer registration procedures have taken place and an authentication of the UE is done without requiring explicit end-user interaction.\nE.4.3.1\tAssociated 3GPP URI\nhttp://www.3gpp.org/schemas/authctx/classes/GBAOneFactorContract\nE.4.3.2\tClass schema\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema targetNamespace=\"urn:3gpp:gba:ac:2006-10\"\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:ac=\"urn:liberty:ac:2004-12\"\nxmlns=\"urn:3gpp:gba:ac:2006-10\"\nfinalDefault=\"extension\"\nversion=\"1.0\">\n<!-- Imports Liberty authentication context schema definitions -->\n<xs:import namespace=\"urn:liberty:ac:2004-12\"\nschemaLocation=\"liberty-authentication-context-v2.0.xsd\"/>\n<!-- includes 3GPP GBA Authentication Context generic definitions -->\n<xs:include schemaLocation=\"3gpp-gba-authentication-context-v1.0.xsd\"/>\n<!-- GBAOneFactorContract -->\n<xs:complexType name=\"GBAOneFactorContractGBAMechanismType\">\n<xs:complexContent>\n<xs:restriction base=\"GBAMechanismType\">\n<xs:choice>\n<xs:element ref=\"LegacyGBA\"/>\n<xs:element ref=\"GBAMobileMobile\"/>\n<xs:element ref=\"GBAUICCMobile\"/>\n<xs:element ref=\"GBAUICCUICC\"/>\n</xs:choice>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n<!-- states which protocol was used between UE and NAF/IdP to authenticate the UE -->\n<xs:complexType name=\"GBAOneFactorContractAuthenticatorTransportProtocolType\">\n<xs:complexContent>\n<xs:restriction base=\"ac:AuthenticatorTransportProtocolType\">\n<xs:choice>\n<xs:element ref=\"ac:HTTP\"/> <!-- HTTP Digest over SSL/TLS -->\n<xs:element ref=\"ac:SSL\"/>  <!-- PSK TLS -->\n</xs:choice>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n<xs:complexType name=\"GBAOneFactorContractIdentificationType\">\n<xs:complexContent>\n<xs:restriction base=\"ac:IdentificationType\">\n<xs:sequence>\n<xs:element ref=\"ac:PhysicalVerification\"/>\n<xs:element ref=\"ac:WrittenConsent\"/>\n<xs:element ref=\"ac:Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n</xs:schema>\nE.4.4\tGBATwoFactorContract\nThis class reflects that mobile customer registration procedures have taken place and a two-factor based authentication of the UE is done requiring an explicit end-user interaction during authentication procedure (e.g., a PIN needs to be typed).\nE.4.4.1\tAssociated 3GPP URI\nhttp://www.3gpp.org/schemas/authctx/classes/GBATwoFactorContact\nE.4.4.2\tClass schema\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema targetNamespace=\"urn:3gpp:gba:ac:2006-10\"\nxmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:ac=\"urn:liberty:ac:2004-12\"\nxmlns=\"urn:3gpp:gba:ac:2006-10\"\nfinalDefault=\"extension\"\nversion=\"1.0\">\n<!-- Imports Liberty authentication context schema definitions -->\n<xs:import namespace=\"urn:liberty:ac:2004-12\"\nschemaLocation=\"liberty-authentication-context-v2.0.xsd\"/>\n<!-- includes 3GPP GBA Authentication Context generic definitions -->\n<xs:include schemaLocation=\"3gpp-gba-authentication-context-v1.0.xsd\"/>\n<!-- GBATwoFactorContract -->\n<xs:complexType name=\"GBATwoFactorContractGBAMechanismType\">\n<xs:complexContent>\n<xs:restriction base=\"GBAMechanismType\">\n<xs:choice>\n<xs:element ref=\"LegacyGBA\"/>\n<xs:element ref=\"GBAMobileMobile\"/>\n<xs:element ref=\"GBAUICCMobile\"/>\n<xs:element ref=\"GBAUICCUICC\"/>\n</xs:choice>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n<!-- states which protocol was used between UE and NAF/IdP to authenticate the UE -->\n<xs:complexType name=\"GBATwoFactorContractAuthenticatorTransportProtocolType\">\n<xs:complexContent>\n<xs:restriction base=\"ac:AuthenticatorTransportProtocolType\">\n<xs:choice>\n<xs:element ref=\"ac:HTTP\"/> <!-- HTTP Digest over SSL/TLS -->\n<xs:element ref=\"ac:SSL\"/>  <!-- PSK TLS -->\n</xs:choice>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n<xs:complexType name=\"GBATwoFactorContractKeyActivationType\">\n<xs:complexContent>\n<xs:restriction base=\"ac:KeyActivationType\">\n<xs:choice>\n<xs:element ref=\"ac:ActivationPin\"/>\n<xs:element ref=\"ac:Extension\" maxOccurs=\"unbounded\"/>\n</xs:choice>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n<xs:complexType name=\"GBATwoFactorContractIdentificationType\">\n<xs:complexContent>\n<xs:restriction base=\"ac:IdentificationType\">\n<xs:sequence>\n<xs:element ref=\"ac:PhysicalVerification\"/>\n<xs:element ref=\"ac:WrittenConsent\"/>\n<xs:element ref=\"ac:Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n</xs:complexType>\n</xs:schema>\nAnnex F (informative):SAML authentication context definitions for GBA\nF.1\tIntroduction\nThis clause describes the GBA Authentication Context definition that an Identity Provider (IdP) uses to describe GBA parameters to a Service Provider (SP). SAML authentication contexts are further discussed in the SAML Authentication Context specification [19].\nF.2\tGBA authentication context declaration data model\nSimilarly to Liberty (cf. Annex E), a SAML authentication context declaration captures characteristics of the processes, procedures, and mechanisms by which the authentication authority verified the subject before issuing an identity, protects the secrets on which subsequent authentications are based, and the mechanisms used for this authentication (identification, technical protection, operational protection, authentication method and governing agreements) OASIS Standard [22].\nCompared to the SAML authentication context declaration data model OASIS Standard [22], the GBA authentication context declaration data model extends the SAML model by adding a description of which GBA mechanism was used during bootstrapping with the BSF, and at the same time restricts the SAML model in a number of respects specific to GBA (only shared secret as authenticator type, only HTTP or SSL as authenticator transport protocol, secret key activation by PIN, only mobile device or smartcard as key storage medium).\nThe authentication contexts classes specific to mobile terminals specified by SAML are:\n-\tMobileOneFactorUnregistered,\n-\tMobileTwoFactorUnregistered,\n-\tMobileOneFactorContract, and\n-\tMobileTwoFactorContract.\nThe GBA authentication context classes introduced herein correspond to the above ones and are:\n-\tGBAOneFactorUnregistered,\n-\tGBATwoFactorUnregistered,\n-\tGBAOneFactorContract, and\n-\tGBATwoFactorContract.\nThe GBA authentication context classes are derived from the corresponding SAML authentication context classes by means of the following patterns:\n-\tThe GBA mechanism (corresponding to ME-based GBA, UICC-based GBA, 2G GBA, etc.) is added to the authentication method type for all the four classes.\n-\tA set of GBA-specific restrictions (only shared secret as authenticator type, only HTTP or SSL as authenticator transport protocol, only mobile device or smartcard as key storage medium) is applied to all the four classes.\n-\tFor the “OneFactor” classes (GBAOneFactorUnregistered and GBAOneFactorContract), there is no more difference (compared to the corresponding SAML class) in addition to the two changes described above.\n-\tFor the “TwoFactor” classes (GBATwoFactorUnregistered and GBATwoFactorContract), the key activation by means of PIN is mandatory in secret key protection.\nGiven the above patterns, the rest of this annex is expected to be understood without further detailed explanations.\nF.3\tGBA authentication context declaration types\nThis section lists the type definitions common to all the four GBA authentication context declaration classes. It adds the GBA mechanism elements (and the necessary type definitions) to the SAML types.\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">\n<xs:annotation>\n<xs:documentation>\nThese types are intended to be used in the definition of\nthe authentication context classes in 3GPP and 3GPP2 Generic\nBootstrapping Architecture (GBA). The new authentication\ncontext classes are defined separately.\n</xs:documentation>\n</xs:annotation>\n<!-- SAML authentication context types -->\n<xs:include schemaLocation=\"http://docs.oasis-open.org/security/saml/v2.0/saml-schema-authn-context-types-2.0.xsd\"/>\n<!-- new type definitions for different GBA procedures -->\n<xs:complexType name=\"GBAMechanismTypeType\">\n<xs:annotation>\n<xs:documentation>\nGBA mechanism used in the bootstrapping procedure.\n</xs:documentation>\n</xs:annotation>\n</xs:complexType>\n<xs:element name=\"LegacyGBA\" type=\"GBAMechanismTypeType\">\n<xs:annotation>\n<xs:documentation>\nLegacy GBA where existing old authentication\nframeworks are used for bootstrapping such\n2G GBA in 3GPP, and CDMA 1x and CDMA 1xEvDo\nin 3GPP2.\n</xs:documentation>\n</xs:annotation>\n</xs:element>\n<xs:element name=\"GBAMobileMobile\" type=\"GBAMechanismTypeType\">\n<xs:annotation>\n<xs:documentation>\nGBA using AKA as specified in 3GPP and 3GPP2.\nThe shared secret is derived in the mobile and\nused in the mobile.\n</xs:documentation>\n</xs:annotation>\n</xs:element>\n<xs:element name=\"GBAUICCMobile\" type=\"GBAMechanismTypeType\">\n<xs:annotation>\n<xs:documentation>\nGBA_U using AKA as specified in 3GPP and 3GPP2.\nThe shared secret is derived in the UICC and used\nin the mobile.\n</xs:documentation>\n</xs:annotation>\n</xs:element>\n<xs:element name=\"GBAUICCUICC\" type=\"GBAMechanismTypeType\">\n<xs:annotation>\n<xs:documentation>\nGBA_U using AKA as specified in 3GPP and 3GPP2.\nThe shared secret is derived in the UICC and used\nin the UICC.\n</xs:documentation>\n</xs:annotation>\n</xs:element>\n<xs:complexType name=\"GBAMechanismType\">\n<xs:choice>\n<xs:element ref=\"LegacyGBA\"/>\n<xs:element ref=\"GBAMobileMobile\"/>\n<xs:element ref=\"GBAUICCMobile\"/>\n<xs:element ref=\"GBAUICCUICC\"/>\n</xs:choice>\n</xs:complexType>\n<!-- new element for GBA authentication context classes -->\n<xs:element name=\"GBAMechanism\" type=\"GBAMechanismType\"/>\n</xs:schema>\nF.4\tGBA authentication context declaration classes\nF.4.1\tGBAOneFactorUnregistered\nThis class reflects that there were no mobile customer registration procedures and an authentication of the UE is done without requiring explict end-user interaction.\nF.4.1.1\tAssociated 3GPP URI\nurn:3gpp:gba:ac:saml:2007-08:classes:GBAOneFactorUnregistered\nF.4.1.2\tClass schema\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema\nxmlns:xs=http://www.w3.org/2001/XMLSchema\nxmlns=\"urn:3gpp:gba:ac:saml:2007-08:classes:GBAOneFactorUnregistered\"\ntargetNamespace=\"urn:3gpp:gba:ac:saml:2007-08:classes:GBAOneFactorUnregistered\"\nfinalDefault=\"extension\"\nversion=\"1.0\">\n<xs:redefine schemaLocation=\"3gpp-gba-saml-authn-context-types-1.0.xsd\">\n<xs:annotation>\n<xs:documentation>\nThe GBA authentication context class comparable to\nthe SAML MobileOneFactorUnregistered class.\nId: 3gpp-gba-saml-authn-context-gbaonefactor-unreg-1.0.xsd\n</xs:documentation>\n</xs:annotation>\n<xs:complexType name=\"AuthnContextDeclarationBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthnContextDeclarationBaseType\">\n<xs:sequence>\n<xs:element ref=\"Identification\" minOccurs=\"0\"/>\n<xs:element ref=\"TechnicalProtection\" minOccurs=\"0\"/>\n<xs:element ref=\"OperationalProtection\" minOccurs=\"0\"/>\n<xs:element ref=\"AuthnMethod\"/>\n<xs:element ref=\"GoverningAgreements\" minOccurs=\"0\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"ID\" type=\"xs:ID\" use=\"optional\"/>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"AuthnMethodBaseType\">\n<xs:complexContent>\n<xs:extension base=\"AuthnMethodBaseType\">\n<xs:sequence>\n<xs:element ref=\"GBAMechanism\" minOccurs=\"0\"/>\n</xs:sequence>\n</xs:extension>\n</xs:complexContent>\n<!-- difference compared to SAML: GBAMechanism -->\n</xs:complexType>\n<xs:complexType name=\"AuthenticatorBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthenticatorBaseType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"SharedSecretChallengeResponse\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only shared secret -->\n</xs:complexType>\n<xs:complexType name=\"AuthenticatorTransportProtocolType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthenticatorTransportProtocolType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"HTTP\"/>\n<xs:element ref=\"SSL\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only HTTP (Digest) or SSL (PSK TLS) -->\n</xs:complexType>\n<xs:complexType name=\"OperationalProtectionType\">\n<xs:complexContent>\n<xs:restriction base=\"OperationalProtectionType\">\n<xs:sequence>\n<xs:element ref=\"SecurityAudit\"/>\n<xs:element ref=\"DeactivationCallCenter\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"TechnicalProtectionBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"TechnicalProtectionBaseType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"SecretKeyProtection\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only secret key (no private key) -->\n</xs:complexType>\n<!-- no PrivateKeyProtectionType -->\n<xs:complexType name=\"SecretKeyProtectionType\">\n<xs:complexContent>\n<xs:restriction base=\"SecretKeyProtectionType\">\n<xs:sequence>\n<xs:element ref=\"KeyStorage\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"KeyStorageType\">\n<xs:complexContent>\n<xs:restriction base=\"KeyStorageType\">\n<xs:attribute name=\"medium\" use=\"required\">\n<xs:simpleType>\n<xs:restriction base=\"mediumType\">\n<xs:enumeration value=\"MobileDevice\"/>\n<xs:enumeration value=\"smartcard\"/>\n<!-- MobileDevice: GBA_ME Ks_NAF, GBA_U Ks_ext_NAF -->\n<!-- smartcard: GBA_U Ks_int_NAF -->\n</xs:restriction>\n</xs:simpleType>\n</xs:attribute>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only mobile dev, smartcard -->\n</xs:complexType>\n<xs:complexType name=\"SecurityAuditType\">\n<xs:complexContent>\n<xs:restriction base=\"SecurityAuditType\">\n<xs:sequence>\n<xs:element ref=\"SwitchAudit\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"IdentificationType\">\n<xs:complexContent>\n<xs:restriction base=\"IdentificationType\">\n<xs:sequence>\n<xs:element ref=\"GoverningAgreements\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"nym\">\n<xs:simpleType>\n<xs:restriction base=\"nymType\">\n<xs:enumeration value=\"anonymity\"/>\n<xs:enumeration value=\"pseudonymity\"/>\n</xs:restriction>\n</xs:simpleType>\n</xs:attribute>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n</xs:redefine>\n</xs:schema>\nF.4.2\tGBATwoFactorUnregistered\nThis class reflects that there were no mobile customer registration procedures and a two-factor based authentication of the UE is done requiring an explicit end-user interaction during authentication procedure (e.g., a PIN needs to be typed).\nF.4.2.1\tAssociated 3GPP URI\nurn:3gpp:gba:ac:saml:2007-08:classes:GBATwoFactorUnregistered\nF.4.2.2\tClass schema\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema\nxmlns:xs=http://www.w3.org/2001/XMLSchema\nxmlns=\"urn:3gpp:gba:ac:saml:2007-08:classes:GBATwoFactorUnregistered\"\ntargetNamespace=\"urn:3gpp:gba:ac:saml:2007-08:classes:GBATwoFactorUnregistered\"\nfinalDefault=\"extension\"\nversion=\"1.0\">\n<xs:redefine schemaLocation=\"3gpp-gba-saml-authn-context-types-1.0.xsd\">\n<xs:annotation>\n<xs:documentation>\nThe GBA authentication context class comparable to\nthe SAML MobileTwoFactorUnregistered class.\nId: 3gpp-gba-saml-authn-context-gbatwofactor-unreg-1.0.xsd\n</xs:documentation>\n</xs:annotation>\n<xs:complexType name=\"AuthnContextDeclarationBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthnContextDeclarationBaseType\">\n<xs:sequence>\n<xs:element ref=\"Identification\" minOccurs=\"0\"/>\n<xs:element ref=\"TechnicalProtection\" minOccurs=\"0\"/>\n<xs:element ref=\"OperationalProtection\" minOccurs=\"0\"/>\n<xs:element ref=\"AuthnMethod\"/>\n<xs:element ref=\"GoverningAgreements\" minOccurs=\"0\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"ID\" type=\"xs:ID\" use=\"optional\"/>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"AuthnMethodBaseType\">\n<xs:complexContent>\n<xs:extension base=\"AuthnMethodBaseType\">\n<xs:sequence>\n<xs:element ref=\"GBAMechanism\" minOccurs=\"0\"/>\n</xs:sequence>\n</xs:extension>\n</xs:complexContent>\n<!-- difference compared to SAML: GBAMechanism -->\n</xs:complexType>\n<xs:complexType name=\"AuthenticatorBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthenticatorBaseType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"SharedSecretChallengeResponse\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only shared secret -->\n</xs:complexType>\n<xs:complexType name=\"AuthenticatorTransportProtocolType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthenticatorTransportProtocolType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"HTTP\"/>\n<xs:element ref=\"SSL\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only HTTP (Digest) or SSL (PSK TLS) -->\n</xs:complexType>\n<xs:complexType name=\"OperationalProtectionType\">\n<xs:complexContent>\n<xs:restriction base=\"OperationalProtectionType\">\n<xs:sequence>\n<xs:element ref=\"SecurityAudit\"/>\n<xs:element ref=\"DeactivationCallCenter\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"TechnicalProtectionBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"TechnicalProtectionBaseType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"SecretKeyProtection\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only secret key (no private key) -->\n</xs:complexType>\n<!-- no PrivateKeyProtectionType -->\n<xs:complexType name=\"SecretKeyProtectionType\">\n<xs:complexContent>\n<xs:restriction base=\"SecretKeyProtectionType\">\n<xs:sequence>\n<xs:element ref=\"KeyActivation\"/>\n<xs:element ref=\"KeyStorage\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: storage, activation mandatory -->\n</xs:complexType>\n<xs:complexType name=\"KeyActivationType\">\n<xs:complexContent>\n<xs:restriction base=\"KeyActivationType\">\n<xs:sequence>\n<xs:element ref=\"ActivationPin\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- not explicitely redefined by corresponding class in SAML -->\n</xs:complexType>\n<xs:complexType name=\"KeyStorageType\">\n<xs:complexContent>\n<xs:restriction base=\"KeyStorageType\">\n<xs:attribute name=\"medium\" use=\"required\">\n<xs:simpleType>\n<xs:restriction base=\"mediumType\">\n<xs:enumeration value=\"MobileDevice\"/>\n<xs:enumeration value=\"smartcard\"/>\n<!-- MobileDevice: GBA_ME Ks_NAF, GBA_U Ks_ext_NAF -->\n<!-- smartcard: GBA_U Ks_int_NAF -->\n</xs:restriction>\n</xs:simpleType>\n</xs:attribute>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only mobile dev, smartcard -->\n</xs:complexType>\n<xs:complexType name=\"SecurityAuditType\">\n<xs:complexContent>\n<xs:restriction base=\"SecurityAuditType\">\n<xs:sequence>\n<xs:element ref=\"SwitchAudit\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"IdentificationType\">\n<xs:complexContent>\n<xs:restriction base=\"IdentificationType\">\n<xs:sequence>\n<xs:element ref=\"GoverningAgreements\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"nym\">\n<xs:simpleType>\n<xs:restriction base=\"nymType\">\n<xs:enumeration value=\"anonymity\"/>\n<xs:enumeration value=\"pseudonymity\"/>\n</xs:restriction>\n</xs:simpleType>\n</xs:attribute>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n</xs:redefine>\n</xs:schema>\nF.4.3\tGBAOneFactorContract\nThis class reflects that mobile customer registration procedures have taken place and an authentication of the UE is done without requiring explicit end-user interaction.\nF.4.3.1\tAssociated 3GPP URI\nurn:3gpp:gba:ac:saml:2007-08:classes:GBAOneFactorContract\nF.4.3.2\tClass schema\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema\nxmlns:xs=http://www.w3.org/2001/XMLSchema\nxmlns=\"urn:3gpp:gba:ac:saml:2007-08:classes:GBAOneFactorContract\"\ntargetNamespace=\"urn:3gpp:gba:ac:saml:2007-08:classes:GBAOneFactorContract\"\nfinalDefault=\"extension\"\nversion=\"1.0\">\n<xs:redefine schemaLocation=\"3gpp-gba-saml-authn-context-types-1.0.xsd\">\n<xs:annotation>\n<xs:documentation>\nThe GBA authentication context class comparable to\nthe SAML MobileOneFactorContract class.\nId: 3gpp-gba-saml-authn-context-gbaonefactor-reg-1.0.xsd\n</xs:documentation>\n</xs:annotation>\n<xs:complexType name=\"AuthnContextDeclarationBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthnContextDeclarationBaseType\">\n<xs:sequence>\n<xs:element ref=\"Identification\" minOccurs=\"0\"/>\n<xs:element ref=\"TechnicalProtection\" minOccurs=\"0\"/>\n<xs:element ref=\"OperationalProtection\" minOccurs=\"0\"/>\n<xs:element ref=\"AuthnMethod\"/>\n<xs:element ref=\"GoverningAgreements\" minOccurs=\"0\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"ID\" type=\"xs:ID\" use=\"optional\"/>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"AuthnMethodBaseType\">\n<xs:complexContent>\n<xs:extension base=\"AuthnMethodBaseType\">\n<xs:sequence>\n<xs:element ref=\"GBAMechanism\" minOccurs=\"0\"/>\n</xs:sequence>\n</xs:extension>\n</xs:complexContent>\n<!-- difference compared to SAML: GBAMechanism -->\n</xs:complexType>\n<xs:complexType name=\"AuthenticatorBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthenticatorBaseType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"SharedSecretChallengeResponse\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only shared secret -->\n</xs:complexType>\n<xs:complexType name=\"AuthenticatorTransportProtocolType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthenticatorTransportProtocolType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"HTTP\"/>\n<xs:element ref=\"SSL\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only HTTP (Digest) or SSL (PSK TLS) -->\n</xs:complexType>\n<xs:complexType name=\"OperationalProtectionType\">\n<xs:complexContent>\n<xs:restriction base=\"OperationalProtectionType\">\n<xs:sequence>\n<xs:element ref=\"SecurityAudit\"/>\n<xs:element ref=\"DeactivationCallCenter\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"TechnicalProtectionBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"TechnicalProtectionBaseType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"SecretKeyProtection\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only secret key (no private key) -->\n</xs:complexType>\n<!-- no PrivateKeyProtectionType -->\n<xs:complexType name=\"SecretKeyProtectionType\">\n<xs:complexContent>\n<xs:restriction base=\"SecretKeyProtectionType\">\n<xs:sequence>\n<xs:element ref=\"KeyStorage\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"KeyStorageType\">\n<xs:complexContent>\n<xs:restriction base=\"KeyStorageType\">\n<xs:attribute name=\"medium\" use=\"required\">\n<xs:simpleType>\n<xs:restriction base=\"mediumType\">\n<xs:enumeration value=\"MobileDevice\"/>\n<xs:enumeration value=\"smartcard\"/>\n<!-- MobileDevice: GBA_ME Ks_NAF, GBA_U Ks_ext_NAF -->\n<!-- smartcard: GBA_U Ks_int_NAF -->\n</xs:restriction>\n</xs:simpleType>\n</xs:attribute>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only mobile dev, smartcard -->\n</xs:complexType>\n<xs:complexType name=\"SecurityAuditType\">\n<xs:complexContent>\n<xs:restriction base=\"SecurityAuditType\">\n<xs:sequence>\n<xs:element ref=\"SwitchAudit\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"IdentificationType\">\n<xs:complexContent>\n<xs:restriction base=\"IdentificationType\">\n<xs:sequence>\n<xs:element ref=\"GoverningAgreements\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"nym\">\n<xs:simpleType>\n<xs:restriction base=\"nymType\">\n<xs:enumeration value=\"anonymity\"/>\n<xs:enumeration value=\"verinymity\"/>\n<xs:enumeration value=\"pseudonymity\"/>\n</xs:restriction>\n</xs:simpleType>\n</xs:attribute>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n</xs:redefine>\n</xs:schema>\nF.4.4\tGBATwoFactorContract\nThis class reflects that mobile customer registration procedures have taken place and a two-factor based authentication of the UE is done requiring an explicit end-user interaction during authentication procedure (e.g., a PIN needs to be typed).\nF.4.4.1\tAssociated 3GPP URI\nurn:3gpp:gba:ac:saml:2007-08:classes:GBATwoFactorContract\nF.4.4.2\tClass schema\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema\nxmlns:xs=http://www.w3.org/2001/XMLSchema\nxmlns=\"urn:3gpp:gba:ac:saml:2007-08:classes:GBATwoFactorContract\"\ntargetNamespace=\"urn:3gpp:gba:ac:saml:2007-08:classes:GBATwoFactorContract\"\nfinalDefault=\"extension\"\nversion=\"1.0\">\n<xs:redefine schemaLocation=\"3gpp-gba-saml-authn-context-types-1.0.xsd\">\n<xs:annotation>\n<xs:documentation>\nThe GBA authentication context class comparable to\nthe SAML MobileTwoFactorContract class.\nId: 3gpp-gba-saml-authn-context-mobiletwofactor-reg-1.0.xsd\n</xs:documentation>\n</xs:annotation>\n<xs:complexType name=\"AuthnContextDeclarationBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthnContextDeclarationBaseType\">\n<xs:sequence>\n<xs:element ref=\"Identification\" minOccurs=\"0\"/>\n<xs:element ref=\"TechnicalProtection\" minOccurs=\"0\"/>\n<xs:element ref=\"OperationalProtection\" minOccurs=\"0\"/>\n<xs:element ref=\"AuthnMethod\"/>\n<xs:element ref=\"GoverningAgreements\" minOccurs=\"0\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"ID\" type=\"xs:ID\" use=\"optional\"/>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"AuthnMethodBaseType\">\n<xs:complexContent>\n<xs:extension base=\"AuthnMethodBaseType\">\n<xs:sequence>\n<xs:element ref=\"GBAMechanism\" minOccurs=\"0\"/>\n</xs:sequence>\n</xs:extension>\n</xs:complexContent>\n<!-- difference compared to SAML: GBAMechanism -->\n</xs:complexType>\n<xs:complexType name=\"AuthenticatorBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthenticatorBaseType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"SharedSecretChallengeResponse\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only shared secret -->\n</xs:complexType>\n<xs:complexType name=\"AuthenticatorTransportProtocolType\">\n<xs:complexContent>\n<xs:restriction base=\"AuthenticatorTransportProtocolType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"HTTP\"/>\n<xs:element ref=\"SSL\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only HTTP (Digest) or SSL (PSK TLS) -->\n</xs:complexType>\n<xs:complexType name=\"OperationalProtectionType\">\n<xs:complexContent>\n<xs:restriction base=\"OperationalProtectionType\">\n<xs:sequence>\n<xs:element ref=\"SecurityAudit\"/>\n<xs:element ref=\"DeactivationCallCenter\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"TechnicalProtectionBaseType\">\n<xs:complexContent>\n<xs:restriction base=\"TechnicalProtectionBaseType\">\n<xs:sequence>\n<xs:choice>\n<xs:element ref=\"SecretKeyProtection\"/>\n</xs:choice>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only secret key (no private key) -->\n</xs:complexType>\n<!-- no PrivateKeyProtectionType -->\n<xs:complexType name=\"SecretKeyProtectionType\">\n<xs:complexContent>\n<xs:restriction base=\"SecretKeyProtectionType\">\n<xs:sequence>\n<xs:element ref=\"KeyActivation\"/>\n<xs:element ref=\"KeyStorage\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: storage, activation mandatory -->\n</xs:complexType>\n<xs:complexType name=\"KeyActivationType\">\n<xs:complexContent>\n<xs:restriction base=\"KeyActivationType\">\n<xs:sequence>\n<xs:element ref=\"ActivationPin\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- not explicitely redefined by corresponding class in SAML -->\n</xs:complexType>\n<xs:complexType name=\"KeyStorageType\">\n<xs:complexContent>\n<xs:restriction base=\"KeyStorageType\">\n<xs:attribute name=\"medium\" use=\"required\">\n<xs:simpleType>\n<xs:restriction base=\"mediumType\">\n<xs:enumeration value=\"MobileDevice\"/>\n<xs:enumeration value=\"smartcard\"/>\n<!-- MobileDevice: GBA_ME Ks_NAF, GBA_U Ks_ext_NAF -->\n<!-- smartcard: GBA_U Ks_int_NAF -->\n</xs:restriction>\n</xs:simpleType>\n</xs:attribute>\n</xs:restriction>\n</xs:complexContent>\n<!-- difference compared to SAML: only mobile dev, smartcard -->\n</xs:complexType>\n<xs:complexType name=\"SecurityAuditType\">\n<xs:complexContent>\n<xs:restriction base=\"SecurityAuditType\">\n<xs:sequence>\n<xs:element ref=\"SwitchAudit\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n<xs:complexType name=\"IdentificationType\">\n<xs:complexContent>\n<xs:restriction base=\"IdentificationType\">\n<xs:sequence>\n<xs:element ref=\"GoverningAgreements\"/>\n<xs:element ref=\"Extension\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xs:sequence>\n<xs:attribute name=\"nym\">\n<xs:simpleType>\n<xs:restriction base=\"nymType\">\n<xs:enumeration value=\"anonymity\"/>\n<xs:enumeration value=\"verinymity\"/>\n<xs:enumeration value=\"pseudonymity\"/>\n</xs:restriction>\n</xs:simpleType>\n</xs:attribute>\n</xs:restriction>\n</xs:complexContent>\n<!-- no difference compared to SAML -->\n</xs:complexType>\n</xs:redefine>\n</xs:schema>\nAnnex G (normative): Web Services Definition for Zpn interface\nThis annex contains the Web Services Definition Language (WSDL) [14] for Zpn interface:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsdl:definitions name=\"GBAService\"\ntargetNamespace=\"urn:3gpp:gba:GBAService:2007-05\"\nxmlns:typens=\"urn:3gpp:gba:GBAService:2007-05\"\nxmlns:wsdl=\"http://schemas.xmlsoap.org/wsdl/\"\nxmlns:soap=\"http://schemas.xmlsoap.org/wsdl/soap/\"\nxmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\">\n<wsdl:types>\n<xsd:schema targetNamespace=\"urn:3gpp:gba:GBAService:2007-05\">\n<!-- Extension element definition -->\n<xsd:complexType name=\"tExtension\">\n<xsd:sequence>\n<xsd:any processContents=\"lax\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n</xsd:sequence>\n</xsd:complexType>\n<!-- Request Bootstrapping info request parameter definitions -->\n<xsd:element name=\"requestGbaPushInfoRequest\">\n<xsd:complexType>\n<xsd:sequence>\n<xsd:element name=\"ptid\" type=\"xsd:string\"/>\n<xsd:element name=\"nafid\" type=\"xsd:base64Binary\"/>\n<xsd:element name=\"gsid\" type=\"xsd:string\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n<xsd:element name=\"gbaUAware\" type=\"xsd:boolean\" minOccurs=\"0\"/>\n<xsd:element name=\"userId\" type=\"xsd:string\"/>\n<xsd:element name=\"userIdType\" type=\"xsd:boolean\"/>\n<xsd:element name=\"uiccAppLabel\" type=\"xsd:string\"/>\n<xsd:element name=\"uiccOrMe\" type=\"xsd:boolean\"/>\n<xsd:element name=\"requestedLifeTime\" type=\"xsd:dateTime\"/>\n<xsd:element name=\"privateIdRequest\" type=\"xsd:boolean\" minOccurs=\"0\"/>\n<xsd:element name=\"securityFeaturesRequest\" type=\"xsd:string\" minOccurs=\"0\"/>\n<xsd:element name=\"extension\" type=\"typens:tExtension\" minOccurs=\"0\"/>\n</xsd:sequence>\n</xsd:complexType>\n</xsd:element>\n<!-- Request Bootstrapping info response parameter definitions -->\n<xsd:element name=\"requestGbaPushInfoResponse\">\n<xsd:complexType>\n<xsd:sequence>\n<xsd:element name=\"impi\" type=\"xsd:string\" minOccurs=\"0\"/>\n<xsd:element name=\"meKeyMaterial\" type=\"xsd:base64Binary\"/>\n<xsd:element name=\"uiccKeyMaterial\" type=\"xsd:base64Binary\" minOccurs=\"0\"/>\n<xsd:element name=\"keyExpiryTime\" type=\"xsd:dateTime\"/>\n<xsd:element name=\"bootstrappingInfoCreationTime\" type=\"xsd:dateTime\"/>\n<xsd:element name=\"gbaType\" type=\"xsd:string\" minOccurs=\"0\"/>\n<xsd:element name=\"ussList\" type=\"xsd:string\" minOccurs=\"0\"/>\n<xsd:element name=\"gbaPushInfo\" type=\"xsd:string\" minOccurs=\"0\"/>\n<xsd:element name=\"securityFeaturesResponse\" type=\"xsd:string\" minOccurs=\"0\"/>\n<xsd:element name=\"extension\" type=\"typens:tExtension\" minOccurs=\"0\"/>\n</xsd:sequence>\n</xsd:complexType>\n</xsd:element>\n<!-- Request Bootstrapping info fault parameter definitions -->\n<xsd:element name=\"requestGbaPushInfoFault\">\n<xsd:complexType>\n<xsd:sequence>\n<xsd:element name=\"errorCode\" type=\"xsd:integer\"/>\n<xsd:element name=\"errorText\" type=\"xsd:string\" minOccurs=\"0\"/>\n</xsd:sequence>\n</xsd:complexType>\n</xsd:element>\n</xsd:schema>\n</wsdl:types>\n<wsdl:message name=\"requestGbaPushInfoRequestMessage\">\n<wsdl:part name=\"body\" element=\"typens:requestGbaPushInfoRequest\"/>\n</wsdl:message>\n<wsdl:message name=\"requestGbaPushInfoResponseMessage\">\n<wsdl:part name=\"body\" element=\"typens:requestGbaPushInfoResponse\"/>\n</wsdl:message>\n<wsdl:message name=\"requestGbaPushInfoFaultMessage\">\n<wsdl:part name=\"body\" element=\"typens:requestGbaPushInfoFault\"/>\n</wsdl:message>\n<wsdl:portType name=\"GBAServicePortType\">\n<wsdl:operation name=\"requestGbaPushInfo\">\n<wsdl:input message=\"typens:requestGbaPushInfoRequestMessage\"/>\n<wsdl:output message=\"typens:requestGbaPushInfoResponseMessage\"/>\n<wsdl:fault name=\"FaultName\" message=\"typens:requestGbaPushInfoFaultMessage\"/>\n</wsdl:operation>\n</wsdl:portType>\n<wsdl:binding name=\"GBAServiceBinding\" type=\"typens:GBAServicePortType\">\n<soap:binding style=\"document\" transport=\"http://schemas.xmlsoap.org/soap/http\"/>\n<wsdl:operation name=\"requestGbaPushInfo\">\n<soap:operation soapAction=\"urn:3gpp:gba:GBAServiceAction:2007-05\"/>\n<wsdl:input>\n<soap:body use=\"literal\"/>\n</wsdl:input>\n<wsdl:output>\n<soap:body use=\"literal\"/>\n</wsdl:output>\n<wsdl:fault name=\"FaultName\">\n<soap:fault name=\"FaultName\" use=\"literal\"/>\n</wsdl:fault>\n</wsdl:operation>\n</wsdl:binding>\n<wsdl:service name=\"GBAService\">\n<wsdl:port name=\"GBAServicePort\" binding=\"typens:GBAServiceBinding\">\n<!-- add SOAP address location URI below -->\n<soap:address location=\"http://add.here.uri.to/GBAService\"/>\n</wsdl:port>\n</wsdl:service>\n</wsdl:definitions>\nAnnex H (informative):Change history\nDate\nTSG #\nTSG Doc.\nCR\nRev\nCat\nSubject/Comment\nNew\n2004-09\nCN#25\nNP-040410\nVersion 2.0.0 approved in CN#25\n6.0.0\n2004-12\nCN#26\nNP-040580\n001\nAuthorization Flag Code Annex\n6.1.0\n2004-12\n002\nFinalization of GAA Service Identifier\n2004-12\n003\n1\nBSF control information (bsfInfo)  tag to GUSS\n2004-12\n005\nStructure to GAA Service Indentifier\n2004-12\n006\n1\nFinalisation of terminology\n2004-12\n008\n1\nCommand code 310 Zn messages\n2004-12\n009\nIntroduction of NAF groups\n2005-01\nFix Word problem\n6.1.1\n2005-03\nCN#27\nNP-050041\n010\nGAA Error Codes\n6.2.0\n011\nOnly one AV from HSS to BSF\n012\nClarification of LifeTime/ExpiryTime terminology\n013\n1\nApplication identifiers to Z-interfaces\n014\n1\nModification of key lifetime material\n2005-06\nCT#28\nCP-050090\n0015\nXML extensibility\n6.3.0\n0016\n1\nRemove BSF from visited network\n2005-09\nCT#29\nCP-050300\n0017\n1\nCorrection for GBA with multiple HSS’s\n6.4.0\n0021\nKey naming alignment with TS 33.220\n2005-09\nCT#29\nCP-050317\n0019\n1\nKey indication in USS\n7.0.0\n0020\n2\nAddition of GUSS timestamp to Zh reference point\n2005-12\nCT#30\nCP-050613\n0019\n1\nXML syntax correction\n7.1.0\nCP-050624\n0022\n1\n2G GBA implementation to Zh and Zn\n2006-03\nCT#31\nCP-060071\n0025\n1\nCorrection of NAF_ID\n7.2.0\n0026\n1\nHTTP based Zn interface\n0027\n1\nLiberty authentication context for GAA\n2006-06\nCT#32\nCP-060318\n0028\n1\nOptionality of the HTTP based Zn interface for NAF\n7.3.0\n0029\n1\nReplacement of \"GAA-Application-Type-Code\" with \"GAA Service Type Code\"\n2006-09\nCT#33\nCP-060415\n0030\n1\nInconsistent description about the proxy between BSF and visted NAF\n7.4.0\n0031\nOnly one instance of SIP-Auth-Data-Item sent in MAA\n2006-12\nCT#34\nCP-060567\n0032\n1\nZh MAR/MAA Diameter Application identifier\n7.5.0\n0033\nDefinition of GAA Service Type Code for Liberty Alliance Interworking\n0034\nCorrections to GAA authentication context schema\n0035\nWSDL definition enhancements for Zn interface\n2007-06\nCT#36\nCP-070320\n0037\n1\nAddition of Service Type For Rel-7\n7.6.0\nCP-070320\n0038\n1\nBug fixes on Zn WSDL definition\nCP-070317\n0040\nGUSS schema fix\n2007-09\nCT#37\nCP-070528\n0036\n4\nHLR support for BSF\n7.7.0\n0041\n1\nAddition of SAML authentication context declaration classes\n2007-12\nCT#38\nCP-070741\n0042\n1\nGUSS and USS handling corrections\n7.8.0\n2008-03\nCT#39\nCP-080013\n0045\nGBA-UserSecSettings XML fix\n7.9.0\n2008-06\nCT#40\nCP-080275\n0047\n2\nKey choice correction\n7.10.0\n2008-12\nCT#42\nUpgraded unchanged from Rel-7\n8.0.0\n2008-03\nCT#43\nCP-090033\n0048\nIntroduction of GBA Push within TS 29.109 – Scope, References and Definitions\n8.1.0\n0049\n2\nIntroduction of GBA Push within TS 29.109 – Zpn Interface\n0050\n1\nIntroduction of GBA Push within TS 29.109 – Impacts on Zh Interface\n0051\n3\nUser identity to HSS Resolution mechanism using a Diameter Proxy\n0055\n1\nRenaming of the reference point between BSF and HLR\n2009-06\nCT#44\nCP-090486\n0056\n2\nANDSF Service Authorization\n8.2.0\n2009-09\nCT#45\nCP-090554\n0057\n1\nAdditional GBA Service Codes\n8.3.0\n0059\n2\nMSISDN support in GBA\n2009-09\nCT#45\nCP-090555\n0058\n1\nGBA Service Type Codes and Authorziation Flag\n9.0.0\n2009-12\nCT#46\nCP-091031\n0068\n2\n2G GBA Option not supported in HSS\n9.1.0\nCP-091031\n0069\n2\nSynchronization Failure Recovery over Zh\nCP-091031\n0070\n2\nZh and Zn Unable to Comply\nCP-090782\n0071\n1\nZh identity unknown\nCP-090782\n0072\n2\nOnly User-Name or Public-Identity AVP shall be present in a MAR request\n2010-03\nCT#47\nCP-100036\n0073\n2\nGPL_U support in TS 29.109\n9.2.0\n0074\nCorrection to WSDL schema of Zn/Zpn reference point\n2011-03\n-\n-\n-\n-\nUpdate to Rel-10 version (MCC)\n10.0.0\n2012-03\nCT#55\nCP-120043\n0077\n2\nSIP Digest over Zh\n11.0.0\n2012-06\nCT#56\nCP-120225\n0078\n1\nGBA_Digest over Zn\n11.1.0\n2012-12\nCT#58\nCP-120712\n0083\n-\nIntroduction of GBA Push within TS 29.109 – Zpn Interface\n11.2.0\nCP-120752\n0079\n1\nUSS example\n2013-01\nAnnex numbering corrected\n11.2.1\n2013-03\nCT#59\nCP-130011\n0084\n1\nError codes in Zn and Zpn\n11.3.0\n2013-12\nCT#62\nCP-130601\n0092\n1\nLack of element definitions and wrong references for Zn and Zpn based on Web Services\n11.4.0\n2014-03\nCT#63\nCP-140015\n0096\n1\nuserIdType and uiccOrMe in requestGbaPushInfoRequest message\n11.5.0\n2014-09\n-\n-\n-\n-\nUpdate to Rel-12 version (MCC)\n12.0.0\n2015-03\nCT#67\nCP-150017\n0098\n1\nAuthentication scheme Digest-AKAv1-MD5 in MAR\n12.1.0\n2015-06\nCT#68\nCP-150244\n0099\n2\nAuth-Session-State in BIR/BIA\n12.2.0\n2015-12\n-\n-\n-\n-\nUpdate to Rel-13 version (MCC)\n13.0.0\n2017-03\nCT#75\nCP-170048\n0106\n1\nUpdate of reference for the Diameter base protocol\n14.0.0\n2017-06\nCT#76\nCP-171041\n0107\n1\nClarification of Zh Multimedia-Authentication-Request command\n15.0.0\n2020-07\nCT#88e\n-\n-\n-\nUpdate to Rel-16 version (MCC)\n16.0.0\n2022-03\nCT#95e\n-\n-\n-\nUpdate to Rel-17 version (MCC)\n17.0.0\n2024-03\n-\n-\n-\n-\nUpdate to Rel-18 version (MCC)\n18.0.0",
      "chunk_type": "general",
      "cross_references": [
        "ts_29.229",
        "ts_33.224",
        "ts_33.980",
        "ts_33.220",
        "ts_29.109"
      ]
    }
  ]
}
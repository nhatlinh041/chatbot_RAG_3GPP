{
  "metadata": {
    "specification_id": "ts_23.632",
    "version": "18.6.0",
    "title": "3GPP TS 23.632",
    "file_path": "/content/drive/MyDrive/RAG_thesis/data/23_series/23632-i60/23632-i60.docx"
  },
  "export_info": {
    "export_date": "2025-07-26T09:24:51.061197",
    "total_chunks": 72
  },
  "chunks": [
    {
      "chunk_id": "ts_23.632_1",
      "section_id": "1",
      "section_title": "Scope",
      "content": "The present document defines the Stage 2 architecture, procedures, flows and Network Function Services for User Data Interworking, Coexistence and Migration within the 5G System.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_2",
      "section_id": "2",
      "section_title": "References",
      "content": "The following documents contain provisions which, through reference in this text, constitute provisions of the present document.\n-\tReferences are either specific (identified by date of publication, edition number, version number, etc.) or non‑specific.\n-\tFor a specific reference, subsequent revisions do not apply.\n-\tFor a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document.\n[1]\t3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".\n[2]\t3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".\n[3]\t3GPP TS 23.002: \"Network Architecture\".\n[4]\t3GPP TS 23.380: \"IMS Restoration Procedures\".\n[5]\t3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".\n[6]\t3GPP TS 33.501: \"Security Architecture and Procedures for 5G System\".\n[7]\t3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".\n[8]\t3GPP TS 33.401: \"3GPP System Architecture Evolution (SAE); Security architecture\".\n[9]\t3GPP TS 33.402: \"3GPP System Architecture Evolution (SAE); Security aspects of non-3GPP accesses\".\n[10]\t3GPP TS 33.203: \"3G security; Access security for IP-based services\".\n[11]\t3GPP TS 33.220: \"3G security; Generic Authentication Architecture (GAA); Generic Bootstrapping Architecture (GBA)\".\n[12]\t3GPP TS 24.080: \"Mobile radio interface layer 3 supplementary services specification - Formats and coding\".\n[13]\t3GPP TS 23.237: \"IP Multimedia Subsystem (IMS) Service Continuity\".\n[14]\t3GPP TS 23.008: \"Organization of subscriber data\".\n[15]\t3GPP TS 29.328: \"IP Multimedia (IM) Subsystem Sh interface; Signalling flows and message contents\".\n[16]\t3GPP TS 23.682: \"Architecture enhancements to facilitate communications with packet data networks and applications; Stage 2\".\n[17]\t3GPP TS 23.040: \"Technical realization of the Short Message Service (SMS)\".\n[18]\t3GPP TS 23.204: \"Support of Short Message Service (SMS) over generic 3GPP Internet Protocol (IP) access; Stage 2\".",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905",
        "ts_23.501",
        "ts_23.002",
        "ts_23.380",
        "ts_23.502",
        "ts_33.501",
        "ts_23.228",
        "ts_33.401",
        "ts_33.402",
        "ts_33.203",
        "ts_33.220",
        "ts_24.080",
        "ts_23.237",
        "ts_23.008",
        "ts_29.328",
        "ts_23.682",
        "ts_23.040",
        "ts_23.204"
      ]
    },
    {
      "chunk_id": "ts_23.632_3.1",
      "section_id": "3.1",
      "section_title": "Terms",
      "content": "For the purposes of the present document, the terms given in 3GPP TR 21.905 [1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [1].",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905"
      ]
    },
    {
      "chunk_id": "ts_23.632_3.2",
      "section_id": "3.2",
      "section_title": "Symbols",
      "content": "Void",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_3.3",
      "section_id": "3.3",
      "section_title": "Abbreviations",
      "content": "For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [1].\n5GS UDR\t5G Unified Data Repository\nEPS UDR\tEPS User Data Repository",
      "chunk_type": "general",
      "cross_references": [
        "ts_21.905"
      ]
    },
    {
      "chunk_id": "ts_23.632_4.1",
      "section_id": "4.1",
      "section_title": "Architecture for direct UDM-HSS interworking",
      "content": "Figure 4.1-1 shows the reference architecture for direct UDM-HSS interworking.\nFigure 4.1-1: Architecture for Direct UDM-HSS interworking\nNon-SBA interfaces between the HSS and non-SBA network nodes include interfaces to / from the SMS-GMSC/IWMSC and SMS Router. In the Architecture for direct UDM-HSS interworking , as a deployment option, these Non-SBA interfaces may either be supported by the HSS or by the UDM.\nFigure 4.1-2 shows the reference architecture for direct UDM-HSS interworking using the reference point representation.\nFigure 4.1-2: Architecture for Direct UDM-HSS interworking in reference point representation\nThe 5GS-UDR (Unified Data Repository) and EPS-UDR (User Data Repository) may be collocated, forming a common repository.\nNOTE:\tThe HSS is only using the NU2 reference point for the purpose of interworking with 5GS, i.e. NU2 is not a replacement of the Ud interface.",
      "chunk_type": "general",
      "cross_references": [
        "figure_4.1-1",
        "figure_4.1-2"
      ]
    },
    {
      "chunk_id": "ts_23.632_4.2",
      "section_id": "4.2",
      "section_title": "Reference points for direct UDM-HSS interworking",
      "content": "The following reference points are realized by service-based interfaces:\nNU1:\tReference point between the HSS and the UDM.\nNU2:\tReference point between the HSS and the 5GS-UDR.\nFor a list of other SBA reference points supported in 5GC see 3GPP TS 23.501 [2].\nFor a list of IMS reference points, including SBA IMS reference points, see 3GPP TS 23.228 [7].\nFor a list of Non-SBA reference points and Network Nodes interfacing the HSS see 3GPP TS 23.002 [3].\nThe HSS makes use of the Ud reference point to interact with the EPS-UDR. The UDM makes use of the N35 reference point to interact with the 5GS-UDR.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.501",
        "ts_23.228",
        "ts_23.002"
      ]
    },
    {
      "chunk_id": "ts_23.632_4.3",
      "section_id": "4.3",
      "section_title": "Service based interfaces for direct UDM-HSS interworking",
      "content": "Nudm:\tService-based interface exhibited by UDM.\nNhss:\tService-based interface exhibited by HSS.\nThe HSS shall make use of Nudm services as described in clause 6.2 and may make use of Nudr services as described in clause 6.3.\nThe UDM shall make use of Nhss services and Nudr services as described in clauses 6.1 and 6.3.",
      "chunk_type": "requirement",
      "cross_references": [
        "clause_6.2",
        "clause_6.3"
      ]
    },
    {
      "chunk_id": "ts_23.632_4.4",
      "section_id": "4.4",
      "section_title": "Subscription Identifiers",
      "content": "As defined in 3GPP TS 23.501 [2], for interworking with the EPC, the SUPI allocated to the 3GPP UE shall always be based on an IMSI to enable the UE to present an IMSI to the EPC.\nThe subscription identifier used over NU1 reference point in Nhss services shall be an IMSI. The UDM extracts the IMSI from the user's SUPI.\nThe subscription identifier used over NU1 reference point in Nudm services shall be a SUPI based on an IMSI. The HSS creates a SUPI from the user's IMSI or the IMSI associated to the user's public identifier in the EPS or IMS domain (e.g. user's MSISDN or IMPU).",
      "chunk_type": "parameter",
      "cross_references": [
        "ts_23.501"
      ]
    },
    {
      "chunk_id": "ts_23.632_4.5",
      "section_id": "4.5",
      "section_title": "HSS Discovery and Selection",
      "content": "This clause defines the procedures for HSS discovery and selection by the UDM. The procedures for HSS discovery and selection by SBI capable IMS entities is defined in 3GPP TS 23.228 [7].\nThe UDM performs HSS discovery to discover an HSS that manages the user subscriptions in EPC.\nThe UDM shall utilize the NRF to discover the HSS instance(s) unless the information about HSS instances is available by other means, e.g. locally configured on the UDM. The HSS selection function in UDM selects an HSS instance based on the available HSS instances (obtained from the NRF or locally configured).\nWhen the NRF is used for HSS discovery, the HSS registers in the NRF using the Nnrf_NFManagement_NFRegister Request message as defined in 3GPP TS 23.502 [5].\nDifferent HSS instances managing different sets of IMSI/MSISDN ranges may be deployed in a given PLMN. In this case, the HSS instances register in NRF using either different ranges of IMSI/MSISDN and/or HSS Group IDs.\nNOTE 1:\tIn deployments where simple IMSI/MSISDN ranges are not suitable to describe the IMSI/MSISDN sets served by HSS instances, it is expected the HSS instances only register HSS Group IDs.\nWhen NRF is used for HSS discovery, the UDM sends a Nnrf_NFDiscovery_Request to NRF as defined in 3GPP TS 23.502 [5] to discover HSS instances within a given PLMN. The UDM may store all returned HSS instances and their NF profiles for subsequent use, including, if applicable, supported IMSI/MSISDN ranges, and/or HSS Group IDs.\nThe UDM may use Nnrf_NFStatusSubscribe/Unsubscribe service operations with NRF as defined in 3GPP TS 23.502 [5] to receive Nnrf_NFStatusNotify service operation for updates to the NF profiles of HSS instances registered in NRF.\nThe UDM always selects an HSS within its own PLMN. The HSS selection should consider one of the following factors when available to the UDM entity:\n1.\tHSS Group ID of the UE's IMSI.\n2.\tIMSI; the UDM selects an HSS instance based on the IMSI range the UE's IMSI belongs to or based on the results of a discovery procedure with NRF using the UE's IMSI as input for HSS discovery.\nNOTE 2:\tIn this release of the specification there is not identified need for the UDM to be able to select the HSS based on IMS identifiers (IMPI, IMPU) neither based on MSISDN or External Group ID.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.228",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_4.6",
      "section_id": "4.6",
      "section_title": "UDM Discovery and Selection",
      "content": "The HSS performs UDM discovery and selection as described in 3GPP TS 23.501 [2].",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.501"
      ]
    },
    {
      "chunk_id": "ts_23.632_4.7",
      "section_id": "4.7",
      "section_title": "Subscription Profiles",
      "content": "In the context of Mobility, IMS and SMS use cases, the HSS initiates interworking with the UDM only for UEs which have a 5G subscription that is known to be active in 5GC.\nNOTE:\tThe HSS may be aware that a 5G subscription for the UE exists based on the Core Network Type restrictions defined for the UE (i.e. If restriction for Core Network Type indicates that the UE can access to 5GC, it implies that the UE has 5G subscription data).Additionally, the HSS may be aware that a UE for which 5G subscription data exist is not active in 5GC e.g. when the HSS has not yet received an Nhss_UECM_ SNDeregistration request from the UDM for that UE (see clause 5.3.3 step 3).",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.3.3"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.1",
      "section_id": "5.1",
      "section_title": "General",
      "content": "Procedures involving communication between HSS and UDM comprise Authentication, Mobilty, IMS interworking, and SMS support.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_5.2.1",
      "section_id": "5.2.1",
      "section_title": "General",
      "content": "A subscriber's authentication subscription data, including the subscriber's long-term key(s) and sequence number, shall be stored in a single repository so that a single sequence number can be maintained for the subscriber.\nThe subscriber's long-term key(s) shall not be transferred over the NU1 reference point between HSS and UDM. Also it is not expected that the UDM has direct standardized access to the EPS-UDR. Therefore, the following options exist for subscribers with both 5G and EPS subscription:\n1) Authentication subscription data are stored in the EPS-UDR and all authentication vectors are calculated in the HSS. Subscription data stored in the 5GS-UDR or locally configured in the UDM indicate that the UDM needs to consume the Nhss_UEAuthentication_Get service operation to retrieve a 5G vector from the HSS. See clause 5.2.2 for details.\n2) Authentication subscription data are stored in the 5GS-UDR and all authentication vectors are calculated in the UDM. Subscription data stored in the EPS-UDR or locally configured in the HSS indicate that the HSS needs to consume the Nudm_UEAuthentication_GetHssAv service operation to retrieve an EPS vector from the UDM. See clause 5.2.3 for details.\n3) Authentication subscription data are stored in the 5GS-UDR, 5G vectors are calculated in the UDM and EPS vectors are calculated in the HSS. Subscription data stored in the EPS-UDR or locally configured in the HSS indicate that the HSS needs to consume the Nudr_DM_Query service operation to retrieve authentication subscription data from the 5GS-UDR. See clause 5.2.4 for details.\nThe following clauses specify the system procedures for these different alternatives.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_5.2.2",
        "clause_5.2.3",
        "clause_5.2.4"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.2.2",
      "section_id": "5.2.2",
      "section_title": "Vector Generation in HSS",
      "content": "This clause specifies the procedures for authentication vector request when the subscriber's authentication subscription data is stored at the EPS-UDR. In this case, the UDM requests the generation of the Authentication Vector for 5GS to the HSS.\nNOTE:\tThe HSS acts as ARPF rather than as AuC and it is required to generate authentication vectors as defined in 3GPP TS 33.501 [6].\nWhen the UDM receives an authentication information Request from the AUSF it shall check (by means of an 5GS-UDR query or local configuration in the UDM) whether the subscribed authentication method is 5G_AKA or EAP_AKA_PRIME and if so whether 5G authentication vector generation for the identified subscriber shall be done in the HSS. If so, the UDM shall make use of the Nhss_UEAuthentication_Get service operation to retrieve a 5G authentication vector from the HSS.\nFigure 5.2.2-1 shows the scenario where the authentication vector request for a 5G subscriber who also has an EPS subscription is received by the UDM.\nFigure 5.2.2-1: Authentication for 5G subscriber with authentication vector generation in HSS\n1.\tThe UDM receives an Authentication Vector request, containing the identity of the user (SUPI or SUCI). If SUCI is received, the UDM performs SUCI to SUPI de-concealment. For details of the Nudm_UEAuthentication Service see 3GPP TS 23.502 [5] and 3GPP TS 33.501 [6].\n2.\tIf the 5GS-UDR is used, the UDM queries the 5GS-UDR using the SUPI to retrieve Authentication Subscription Information. In this scenario the Authentication Subscription Information contains a subscribed authentication method of 5G_AKA or EAP_AKA_PRIME and an indicator indicating that authentication vector generation shall be performed in the HSS. Optionally, the indication that the authentication vector generation shall be performed in the HSS could be locally configured at the UDM/ARPF.\n3.\tThe UDM uses the Nhss_UEAuthentication_Get service operation to retrieve an authentication vector from the HSS. The request contains the IMSI the authentication method and serving network name.\n4.\tThe HSS reads authentication subscription data from the EPS-UDR. This step is omitted if all relevant authentication subscription data are stored locally in the HSS.\n5.\tThe HSS (AuC/ARPF) calculates the requested authentication vector taking into account the serving network name and authentication method received in step 3 and the authentication subscription information retrieved from the EPS-UDR.\n6.\tThe calculated authentication vector is sent to the UDM.\n7.\tThe HSS updates the EPS-UDR with the new sequence number. This step is omitted if the sequence number is stored locally in the HSS.\n8.\tThe UDM forwards the authentication vector to the AUSF.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.2.2-1",
        "ts_33.501",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.2.3",
      "section_id": "5.2.3",
      "section_title": "Vector Generation in UDM/ARPF",
      "content": "This clause specifies the procedures for authentication vector request when the subscriber's authentication subscription data is stored at the 5GS-UDR. In this case, the HSS requests the generation of the Authentication Vector for EPS and/or IMS to the UDM.\nNOTE:\tThe UDM acts as AuC rather than as ARPF and it is required to generate authentication vectors as defined in 3GPP TS 33.401 [8], 3GPP TS 33.402 [9], 3GPP TS 33.203 [10] and 3GPP TS 33.220 [11].\nWhen the HSS receives an authentication vector request from a serving node (e.g. MME, SGSN, VLR, S-CSCF, BSF) it shall check (by means of an EPC-UDR query) whether authentication vector generation for the identified subscriber shall be done in the UDM. If so, the HSS shall make use of the Nudm_UEAuthentication GetHssAv service operation to retrieve authentication vectors from the UDM.\nFigure 4.2.3-1 shows the scenario where an authentication vector request for a subscriber is received by the HSS and subscription data stored in the EPS-UDR indicate that for the subscriber authentication vector generation is to be performed in the UDM.\nFigure 5.2.3-1: Authentication for a subscriber with authentication vector generation in UDM\n1.\tThe HSS receives an Authentication Vector request, containing the identity of the user (IMSI, or Public User Identity and/or Private User Identity).\n2.\tThe HSS queries the EPS-UDR using the identity of the user to retrieve Authentication Subscription Information. In this scenario the Authentication Subscription Information contains an indicator indicating that authentication vector generation shall be performed in the UDM.\n3.\tThe HSS uses the Nudm_UEAuthentication_GetHssAv service operation to retrieve an authentication vector from the UDM. The request contains the identity of the user, the type of the requested vector (E-UTRAN/UTRAN or GERAN/ IMS-AKA and when available the visited PLMN-ID.\n4.\tThe UDM reads authentication subscription data from the 5GS-UDR.\n5.\tThe UDM (ARPF) calculates the requested authentication vectors taking into account the information received in step 3 and the authentication subscription information retrieved from the 5GS-UDR.\n6.\tThe calculated authentication vectors are sent to the HSS.\n7.\tThe UDM updates the 5GS-UDR with the new sequence number.\n8.\tThe HSS forwards the authentication vectors to the serving node.",
      "chunk_type": "general",
      "cross_references": [
        "figure_4.2.3-1",
        "figure_5.2.3-1",
        "ts_33.401",
        "ts_33.402",
        "ts_33.203",
        "ts_33.220"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.2.4",
      "section_id": "5.2.4",
      "section_title": "HSS using the Nudr SBI",
      "content": "When the HSS receives an S6a-AIR from the MME, it may check (by means of an EPC-UDR query) whether the subscriber has an 5G subscription. If so, the HSS can use of the Nudr_DM_Query Get service operation to retrieve the authentication subscription data from the 5GS UDR and generate the authentication vector.\nFigure 5.2.4-1 shows the scenario where the authentication vector request for a 5G subscriber who also has an EPS subscription is received by the UDM.\nFigure 5.2.4-1: Authentication for 5G subscriber with EPS subscription\n1.\tThe HSS receives an Authentication Vector request containing the identity of the user (IMSI).\n2.\tThe HSS queries the EPC-UDR using the IMSI to retrieve Authentication Subscription Information. Since the subscriber is a 5G subscriber the response indicates that the subscriber's authentication information is stored in the 5GS UDR.\nNOTE:\tLocal configuration in the HSS may indicate that authentication subscription data for all subscribers can be obtained from the 5G UDR and thus this step may be omitted.\n3.\tThe HSS uses the Nudr_DM_Query Get service operation to retrieve the authentication subscription data from the 5GS UDR. The request contains the IMSI formatted as a SUPI.\n4.\tThe HSS (AuC) calculates the requested authentication vector taking into account the serving network name and authentication method received in step 1 and the authentication subscription information retrieved from the 5GS-UDR in step 3.\n5.\tThe calculated authentication vector is returned to the MME.\n6.\tThe HSS updates the 5GS-UDR with the new sequence number.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.2.4-1"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.3.1",
      "section_id": "5.3.1",
      "section_title": "General",
      "content": "As defined in 3GPP TS 23.501 [2], when interworking procedures with N26 are used, the UE operates in single-registration mode. For the 3GPP access, either the AMF or the MME is registered in the HSS+UDM. This implies that:\n-\tThe registration of an MME in HSS for a UE that is capable to access the 5GC, triggers the cancellation of the AMF address for 3GPP access registered in the UDM, if any.\n-\tThe registration of an AMF in UDM for a UE that is capable to access the EPC, triggers the cancellation of the MME address registered in the HSS, if any.\nInterworking procedures without N26 do not require that the HSS+UDM cancels the location of the old serving node in the old access domain. However, the UDM may request from the HSS the cancelation of the SGSN.\nAdditionally, upon mobility from GERAN/UTRAN to 5GS, the previously registered SGSN needs to be cancelled from HSS/HLR, otherwise the incoming session can fail.\nAdditionally, IP address preservation for PDU sessions that support interworking is provided to UEs during inter-system mobility procedures by storing and fetching the PGW-C+SMF FQDN for S5/S8 interface per APN/DNN via the HSS+UDM.",
      "chunk_type": "definition",
      "cross_references": [
        "ts_23.501"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.3.2",
      "section_id": "5.3.2",
      "section_title": "Mobility from 5GC to EPC",
      "content": "Figure 5.3.2-1 shows the interaction between the HSS and UDM in an interworking scenario when the UE attaches to the EPC.\nFigure 5.3.2-1: Mobility from 5GC to EPC\n1.\tThe HSS receives an S6a ULR request containing the IMSI of the subscriber.\nThe HSS stores the new MME address. If the EPC UDR is used, the HSS updates the EPS-UDR with the new MME address and reads the subscription information related to the IMSI from the EPS-UDR.\nThe UE's subscription may include restriction for Core Network Type (5GC). If restriction for Core Network Type indicates that the UE can access to 5GC, it implies that the UE has 5G subscription data.\n2.\tThe HSS responds to the MME with an S6a-ULA.\nNOTE:\tFor the need of HSS to retrieve and subscribe UE context in SMF data and the Intersystem continuity context data from UDM see clause 5.3.4.\n3.\tIf the dual registration 5GS indicator is not set in the S6a ULR request and the subscription information related to the IMSI does not indicate that 5GC is restricted, then the HSS uses the Nudm_UECM_AMFDeregistration service operation to request the UDM to cancel the registration of the user in 5GC for 3GPP access, if any. The HSS includes the user's IMSI received in step 1 as the user's SUPI in this request.\nIf the S6a ULR request includes the initial attach indicator set, the HSS indicates to the UDM that the deregistration reason is due to \"Initial Registration\". When the initial attach indicator is not set, the HSS indicates to the UDM that the deregistration reason is due to 5GS to EPS mobility.\nNOTE:\tIf the dual registration 5GS indicator is set in the S6a ULR request, the HSS is not required to request the UDM to cancel the location of the UE in AMF if any.\n4.\tThe UDM responds to the HSS.\nThe UDM checks if the user is registered in 5GC over 3GPP access. The UDM may use the 5GS-UDR to retrieve the address of the AMF for 3GPP access registered in UDM for that user, if any. If the user is registered at an AMF for 3GPP access, step 5 is executed.\n5.\tIf there is an AMF address for 3GPP access found for the user, the UDM cancels the user registration in 5GC by sending a Nudm_UECM_DeregistrationNotification to the AMF.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.3.4",
        "figure_5.3.2-1"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.3.3",
      "section_id": "5.3.3",
      "section_title": "Mobility from EPC to 5GC",
      "content": "Figure 5.3.3-1 shows the interaction between the UDM and the HSS in an interworking scenario when the UE attaches to the 5GC.\nFigure 5.3.3-1: Mobility from EPC to 5GC\n1.\tThe UDM receives a Nudm_UECM_Registration request for 3GPP access containing the SUPI of the subscriber. In this case the SUPI shall be based on an IMSI.\nThe UDM stores the new AMF address for 3GPP access. If the 5GS UDR is used, the UDM updates the 5GS-UDR with the new AMF address for 3GPP access and reads the subscription information related to the SUPI from the 5GS-UDR.\nThe UE's subscription may include restriction for Core Network Type (EPC). If restriction for Core Network Type indicates that the UE can access to EPC, it implies that the UE has EPC subscription data and that the UE may also be able to access via GERAN/UTRAN.\n2.\tThe UDM responds to the AMF with a Nudm_UECM_Registration Response.\n3.\tIf the dual registration and the initial registration flags are not set in the Nudm_UECM_Registration request and the subscription information related to the SUPI does not indicate that EPC is restricted, then the UDM uses the Nhss_UECM_SNDeregistration service operation indicating that the deregistration reason is due to EPS to 5GS mobility to request the HSS to cancel the MME/SGSN registration of the user in EPC, if any. The UDM includes the IMSI based on SUPI received in step 1 as the user's IMSI in this request.\nIf the dual registration flags is set in the Nudm_UECM_Registration request and the subscription information related to the SUPI does not indicate that EPC is restricted, then the UDM uses the Nhss_UECM_SNDeregistration service operation indicating that the deregistration reason is due to Initial and Dual Registration to request the HSS to cancel the SGSN registration of the user in EPC, if any. The UDM includes the IMSI based on SUPI received in step 1 as the user's IMSI in this request.\nIf the dual registration flag is not set and the initial registration flag is set in the Nudm_UECM_Registration request and the subscription information related to the SUPI does not indicate that EPC is restricted, then the UDM uses the Nhss_UECM_SNDeregistration service operation indicating that the deregistration reason is due to Initial and Single Registration to request the HSS to cancel the MME/SGSN registrations of the user in EPC, if any. The UDM includes the IMSI based on SUPI received in step 1 as the user's IMSI in this request.\nIf the EPS to 5GS mobility without N26 interworking indication (i.e. eps5GsMobilityWoN26 IE) is set in the Nudm_UECM_Registration request and the subscription information related to the SUPI does not indicate that EPC is restricted, then the UDM uses the Nhss_UECM_SNDeregistration service operation indicating that the deregistration reason is due to EPS to 5GS mobility without N26 Interworking (i.e. that the UE is in EMM-REGISTERED state, EPS to 5GS mobility is triggered, the UE works in single registration mode and N26 interworking is not supported) to request the HSS to only cancel the SGSN registration of the user in EPC, if any, but not to cancel the MME registration. The UDM includes the IMSI based on SUPI received in step 1 as the user's IMSI in this request.\n4.\tThe HSS responds to the UDM.\nThe HSS checks if the user is registered in EPC. The HSS may use the EPS-UDR to retrieve the address of the MME or SGSN registered in the HSS for that user, if any. If the user is registered at an MME or SGSN, step 5 is executed.\n5.\tIf there is an MME address found for the user and the deregistration reason in the Nhss_UECM_SNDeregistration service operation indicated \"Initial and Single Registration\" or \"EPS to 5GS mobility\", the HSS cancels the attachment of the IMSI in the MME by sending a CLR via the S6a interface setting the cancellation type to MME Update Procedure, and if a VLR number was found in the HSS for the user, the HSS also cancels attachment of the IMSI in this MSC/VLR by sending the MAP Cancel Location (IMSI) to the MSC/VLR via the D interface.\nIf there is an SGSN address found for the user and the deregistration reason in the Nhss_UECM_SNDeregistration service operation indicated \"Initial and Single Registration\", the HSS cancels the attachment of the IMSI in the SGSN by sending a CLR via the S6d interface or by sending the MAP Cancel Loc via the Gr interface setting the cancellation type to SGSN Update Procedure. When deregistration reason indicated \"Initial and Dual Registration\" or \"EPS to 5GS Mobility\", the HSS cancels the attachment of the IMSI in the SGSN by sending a CLR via the S6d interface setting the cancellation type to SGSN Update Procedure.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.3.3-1"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.3.4",
      "section_id": "5.3.4",
      "section_title": "Support for PDU session continuity during intersystem mobility procedures",
      "content": "When the UE is connected to 5GS or 5GC-N3IWF, the PGW-C+SMF may store in UDM the PGW-C+SMF FQDN for S5/S8/S2b interface, within the UE context in SMF data, when the PWG-C+SMF registers in UDM. The AMF serving 3GPP access may also notify the UDM to store the association between DNN and PGW-C+SMF FQDN which supports EPS interworking as Intersystem continuity context.\nDuring mobility from 5GC to EPC or EPC/ePDG, or mobility from 5GC-N3IWF to EPC, or mobility from EPC/ePDG to EPC, the HSS uses the Nudm_SDM_Get service operation to retrieve the PGW-C+SMF FQDN for S5/S8/S2b interface from UDM, and subscribes to be notified using Nudm_SDM_Subscribe when the Intersystem continuity context data or the UE context in SMF data are modified. The HSS retrieves both the UE context in SMF data and the Intersystem continuity context data from UDM. The HSS checks the Intersystem continuity context first. If no PGW-C+SMF FQDN associated with the APN exists in Intersystem continuity context, the HSS selects one of the PGW-C+SMF FQDN for the APN from the UE context in SMF data based on operator's policy.\nDuring UE registration for the scenario when ePDG is connected to SMF+PGW-C and S6b in not used, the HSS subscribes to be notified from the UDM using Nudm_SDM_Subscribe when the UE context in SMF data is modified as new PDU sessions established in the ePDG are not updated in the HSS via the SWx interface.\nFigure 5.3.4-1 shows the interaction between the HSS and the UDM in an interworking scenario when the UE attaches to the EPC or EPC/ePDG.\nFigure 5.3.4-1: PDU session continuity during mobility from 5GC to EPC\n0.\tWhile the UE is connected to the 5GC, the AMF and/or SMF may store in UDM the association between DNN and PGW-C+SMF FQDN which supports EPS interworking.\nIf the 5GS UDR is used, the UDM updates the 5GS-UDR with the DNN and PGW-C+SMF FQDN association.\n1.\tThe HSS receives an S6a ULR or SWx SAR request containing the IMSI of the subscriber.\nThe S6a ULR may contain the \"PDN Context Sync Up With UDM not requested\" ULR-flag, which is set to 1 by the MME when the MME has received the UE context without dual registration from AMF over N26 interface.\nThe HSS reads the subscription information related to the IMSI. If the EPC-UDR is used, the HSS retrieves the subscription information from the EPS-UDR. The UE's subscription may include subscribed APNs that support interworking with 5GS.\n2.\tIf the subscription information related to the IMSI includes subscribed APNs that support interworking with 5GS and the ULR-flag \"PDN Context Sync Up With UDM not requested\" was not set in S6a-ULR, then the HSS uses the Nudm_SDM_Get service operation to fetch the UE context in SMF data and the Intersystem continuity context data for the user in AMF data, if any. The HSS includes the user's IMSI received in step 1 as the user's SUPI in this request. Otherwise steps 2 to 5 are skipped.\n3.\tThe UDM responds to the HSS.\nThe HSS checks the Intersystem continuity context first. If no PGW-C+SMF FQDN associated with an DNN exists in Intersystem continuity context, the HSS selects one of the PGW-C+SMF FQDN for the APN from the UE context in SMF data based on operator's policy.\n4-5.The HSS subscribes to be notified using Nudm_SDM_Subscribe service operation when the Intersystem continuity context data or the UE context in SMF data are modified.\n6.\tThe HSS responds to the MME with an S6a-ULA response or to the AAA with an SWx-SAA response including the PGW-C+SMF FQDN associated with subscribed APNs that support interworking with 5GS, if any. This step may happen at any time after step 3, not necessarily after steps 4-5.\nIf an S6a ULR is received, the HSS performs steps 3 and 4 of clause 5.3.2.\nFigure 5.3.4-2 shows the interaction between the HSS and the UDM when the HSS receives notification from the UDM when the data requested is modified.\nFigure 5.3.4-2: Notification of PGW-C+SMF FQDN from UDM to HSS\n0.\tThe AMF and/or SMF may add or remove or update the association between DNN and PGW-C+SMF FQDN stored in the UDM.\nIf the 5GS UDR is used, the UDM updates the 5GS-UDR with the DNN and PGW-C+SMF FQDN association.\n1.\tIf the UDM finds the UE context in SMF data or the Intersystem continuity context is changed, and the active subscription from the HSS exists for the UE to be notified on the change of the UE context in SMF data or the Intersystem continuity context, then the UDM uses the Nudm_SDM_Notification service operation to notify the HSS. Notifications may be limited to cases of PGW ID (FQDN and/or IP) being changed. As part of this notification the UDM informs the HSS whether the SMF indicated that the access to 5GC was via an ePDG.\n2.\tThe HSS responds to the UDM.\nThe HSS checks the change of the association between APN and PGW-C+SMF FQDN. If multiple PGW-C+SMF FQDN exists in the UE context in SMF data, the HSS selects one of the PGW-C+SMF FQDN for the APN based on operator's policy.\n3.\tThe HSS may further trigger PDN GW Identify Notification procedure, as defined in clause 12.1.4 and clause 12.1.5 in TS 23.402.\nFigure 5.3.4-3 shows the interaction between the HSS and the UDM when the HSS unsubscribes from the UDM to be notified when the data requested is modified.\nFigure 5.3.4-3: Unsubscribe of PGW-C+SMF FQDN Notification from HSS to UDM\n0.\tThe HSS checks the conditions to unsubscribe the notification of the UE context in SMF data or the Intersystem continuity context from the UDM, when the UE's 3GPP access or Non-3GPP access registration in EPC is not valid. For example, when the MME performs purge UE procedure, or the AAA performs UE deregistration towards the HSS, or the registration of the user in EPC is cancelled due to mobility from EPC to 5GC.\n1.\tThe HSS unsubscribes to be notified using Nudm_SDM_Unsubscribe service operation towards the UDM.\n2.\tThe UDM responds to the HSS.\nWhen the UE is connected to EPC, the MME stores in HSS the PGW-C+SMF FQDN for S5/S8 interface via S6a reference point. When the UE is connected to EPC via an ePDG, and the S6b reference point is deployed between the PGW-C+SMF and AAA, the AAA stores in HSS the PGW-C+SMF FQDN for S5/S8 interface via SWx reference point.\nNOTE:\tWhen S6b is not deployed between the PGW-C+SMF and AAA, the registration and de-registration of the PDN GW address is performed in the UDM using the N10 interface instead. In this case, for interworking between EPC/ePDG and 5GS the UDM is not required to contact the HSS to fetch the PDN GW address.\nDuring mobility from EPC or EPC/ePDG to 5GC, or mobility from EPC to 5GC-N3IWF, the UDM uses the Nhss_SDM_Get service operation to retrieve the PGW-C+SMF FQDN for S5/S8 interface from HSS and subscribes to be notified using Nhss_SDM_Subscribe when the data requested is modified.\nFigure 5.3.4-4 shows the interaction between the HSS and the UDM in an interworking scenario when the UE moves from EPC or EPC/ePDG to 5GC.\nFigure 5.3.4-4: PDU session continuity during mobility from EPC/ePDG to 5GC\n0.\tWhile the UE is connected to the EPC or EPC/ePDG, the MME or the AAA informs the HSS of the PGW-C+SMF address and associated APN.\n1.\tUE moves to 5G coverage, the AMF registers with the UDM using Nudm_UECM_Registration for 3GPP access.\nThe UDM performs steps 3 and 4 in clause 5.3.3.\n2.\tThe AMF retrieves the Access and Mobility Subscription data, SMF Selection Subscription data and UE context in SMF data using Nudm_SDM_Get.\n3.\tIf the subscription information related to the SUPI includes subscribed DNNs that support interworking with EPS, then the UDM uses the Nhss_SDM_Get service operation to fetch the PGW-C+SMF information.  The UDM includes the user's IMSI derived from SUPI.\n4.\tThe HSS responds to the UDM.\n5.\tThe UDM includes the PGW-C+SMF address associated with subscribed DNNs that support interworking with EPS, if any, as UE context in SMF data in Nudm_SDM_Get_Response.\n6.\tAfter a successful response is received, the AMF subscribes to be notified when the data requested is modified using Nudm_SDM_Subscribe service operation.\n7.\tIf the UE context in SMF data is subscribed to be notified and the subscription information related to the SUPI includes subscribed DNNs that support interworking with EPS, the UDM subscribes towards the HSS (if not already subscribed, for the same UE) to be notified when the PGW-C+SMF information is modified using Nhss_SDM_Subscribe service operation.\n8.\tThe HSS responds to the UDM.\n9.\tThe UDM responds to the AMF.\nFigure 5.3.4-5 shows the interaction between the HSS and the UDM when the UDM receives notification from the HSS when the data requested is modified.\nFigure 5.3.4-5: Notification of PGW-C+SMF FQDN from HSS to UDM\n0.\tThe MME or the AAA may add or update the association between APN and PGW-C+SMF FQDN stored in the HSS.\n1.\tIf the HSS finds the association between APN and PGW-C+SMF FQDN is changed, and the active subscription from the UDM exists for the UE to be notified on the change of the data requested, then the HSS uses the Nhss_SDM_Notification service operation to notify the UDM.\n2.\tThe UDM responds to the HSS.\n3 - 4.\tIf the UDM finds the association between DNN and PGW-C+SMF FQDN is changed, and the active subscription from the AMF exists for the UE to be notified on the change of the UE context in SMF data, then the UDM notifies the AMF using the Nudm_SDM_Notification service operation.\nFigure 5.3.4-6 shows the interaction between the HSS and the UDM when the UDM unsubscribes from the HSS to be notified when the data requested is modified.\nFigure 5.3.4-6: Unsubscribe of PGW-C+SMF FQDN Notification from UDM to HSS\n1 - 2.\tThe AMF unsubscribes to be notified using Nudm_SDM_Unsubscribe service operation.\nNOTE:\tIf the AMF's subscription was created with implicit unsubscribe indication, step 3 is triggered by deregistration of the AMF.\n3.\tIf the UE context in SMF data is unsubscribed, and no other AMF has subscribed to the same data (UE context in SMF) for the same UE, the UDM unsubscribes towards the HSS to be notified when the PGW-C+SMF information is modified using Nhss_SDM_Unsubscribe service operation.\n4.\tThe HSS responds to the UDM.",
      "chunk_type": "procedure",
      "cross_references": [
        "clause_5.3.2",
        "ts_23.402_clause_12.1.4",
        "ts_23.402_clause_12.1.5",
        "clause_5.3.3",
        "figure_5.3.4-1",
        "figure_5.3.4-2",
        "ts_23.402_figure_5.3.4-3",
        "figure_5.3.4-3",
        "figure_5.3.4-4",
        "figure_5.3.4-5",
        "figure_5.3.4-6",
        "ts_23.402"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.4.0",
      "section_id": "5.4.0",
      "section_title": "General",
      "content": "The following clauses assume that the HSS (and EPS-UDR) supports IMS procedures and EPS procedures. However, in EPS-less deployments where the HSS supports only IMS procedures, the EPS-UDR may store only IMS profile information and IMPI-IMSI associations, but no EPS-Profile information. In such deployments the HSS can retrieve the user's IMSI associated to the given IMPI from the EPS-UDR and can skip the steps involving EPC procedures.",
      "chunk_type": "definition",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_5.4.1",
      "section_id": "5.4.1",
      "section_title": "T-ADS",
      "content": "Figure 5.4.1-1 shows the scenario where the HSS receives a T-ADS request from the AS  for a subscriber who has a 5GC subscription.\nFigure 5.4.1-1: T-ADS request for 5G subscriber\n1.\tThe HSS receives a T-ADS request from the AS. The request includes the user's IMPU or MSISDN and optionally the user's IMPI.\nNOTE:\tAn SBA capable IMS-AS makes use of Nhss_ImsSDM service to interact with the HSS for this operation as defined in 3GPP TS 23.228 [7]. Otherwise the IMS-AS makes use of Diameter Sh-UDR/UDA command.\n2.\tIf the EPS-UDR is used, the HSS reads subscription data from the EPS-UDR. The HSS, retrieves the user's IMSI associated with the user's identifiers received in step 1. The subscription data may contain an indication that the user has a 5GC subscription.\n3.\tThe HSS performs T-ADS info retrieval in the EPC. This may include contacting the MME and/or SGSN.\n4.\tIf the HSS detects in step 2 that the user has a 5GC subscription and unless the user is known not to be registered in 5GC (e.g. in case the user is registered in EPC and the HPLMN is working in single registration mode with N26), the HSS uses the Nudm_MT_ProvideDomainSelection service operation to retrieve T-ADS information from the UDM. The HSS includes the user's IMSI associated with the user's identifiers received in step 1 as the SUPI in this request.\n5.\tThe UDM reads data from the 5GS-UDR to see whether the registered AMF(s) support IMS voice over PS.\n6-7.\tIf support/non-support of IMS voice is not homogeneous for the User in the AMF for 3GPP access, the UDM retrieves domain selection information from the AMF.\n8.\tThe UDM provides the 5G domain selection info to the HSS.\n9.\tThe HSS combines the 5G domain selection info with the EPS domain selection info from step 3 and sends the result to the AS.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.4.1-1",
        "ts_23.228"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.4.2",
      "section_id": "5.4.2",
      "section_title": "P-CSCF Restoration",
      "content": "Figure 5.4.2-1 shows the scenario where the HSS receives a P-CSCF restoration indication from the S-CSCF for a subscriber who has a 5GC subscription.\nFigure 5.4.2-1: P-CSCF Restoration for 5G subscriber\n1.\tThe HSS receives a P-CSCF Restoration indication from the S-CSCF. The request includes the user's IMPU and IMPI.\nNOTE:\tAn SBA capable S-CSCF makes use of Nhss_ImsUECM service to interact with the HSS for this operation as defined in 3GPP TS 23.228 [7]. Otherwise the S-CSCF makes use of Diameter Cx-SAR/SAA command.\n2.\tIf the EPS-UDR is used, the HSS reads subscription data from the EPS-UDR. The HSS, retrieves the user's IMSI associated with the user's identifiers received in step 1. The subscription data may contain an indication that the user has a 5GC subscription.\n3-4.\tThe HSS acknowledges receipt of the request and performs P-CSCF restoration in the EPC. For details see 3GPP TS 23.380 [4] clause 5.4.2.1.\n5.\tIf the HSS detects in step 2 that the user has a 5GC subscription and unless the user is known not to be registered in 5GC (e.g. in case the user is registered in EPC and the HPLMN is working in single registration mode with N26), the HSS uses the Nudm_UECM_P-CscfRestorationTrigger service operation to trigger P-CSCF restoration in 5GC. See also 3GPP TS 23.380 [4] clause 5.8.4. The HSS includes the user's IMSI associated with the user's identifiers received in step 1 as the SUPI in this request\n6.\tThe UDM reads data from the 5GS-UDR to see which NFs have subscribed to P-CSCF Restoration Notifications (implicitly during registration).\n7.\tThe UDM acknowledges receipt of Nudm_UECM_PCscfRestorationTrigger to the HSS.\n8-9.\tThe UDM sends a notification to one of the subscribed NFs (either the AMF or the SMF).",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.380_clause_5.4.2.1",
        "ts_23.380_clause_5.8.4",
        "figure_5.4.2-1",
        "ts_23.228",
        "ts_23.380"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.4.3",
      "section_id": "5.4.3",
      "section_title": "Network Provided Location Information Request",
      "content": "Figure 5.4.3-1 shows the scenario where the HSS receives a Location Information retrieval request from the IMS-AS for a subscriber who has a 5GC subscription.\nFigure 5.4.3-1: Location Information retrieval request for 5G subscriber\n1.\tThe HSS receives a Location Information retrieval request (requested nodes includes AMF) from the IMS-AS.\nNOTE:\tAn SBA capable IMS-AS makes use of Nhss_ImsSDM service to interact with the HSS for this operation as defined in 3GPP TS 23.228 [7]. Otherwise the IMS-AS makes use of Diameter Sh-UDR/UDA command.\n2.\tThe HSS reads subscription data from the EPS-UDR.\n3.\tThe HSS performs Location Information Retrieval from other nodes if so requested. This may include contacting the MME and/or SGSN.\n4.\tIf the HSS detects in step 2 that the user has a 5GC subscription and unless the user is known not to be registered in 5GC, the HSS uses the Nudm_MT_ProvideLocationInfo service operation to retrieve 5GS Location Information. The service request includes indicators for Current Location, Serving Node Indication, Local Time Zone Indication, and RAT-Type requested as has been received in step 1.\n5.\tThe UDM reads data from the 5GS-UDR to get the AMF and SMSF for 3GPP Access Registration Information. If the Serving Node Indication was received in step 4, steps 6-7 shall be skipped.\n6-7.\tThe UDM retrieves location information from the AMF (for 3GPP access) by means of the Namf_Location_ProvideLocationInfo service operation .\n8.\tThe UDM provides the 5GS location information info to the HSS.\n9.\tThe HSS provides the requested location information to the IMS-AS.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.4.3-1",
        "ts_23.228"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.4.4",
      "section_id": "5.4.4",
      "section_title": "User State Retrieval",
      "content": "Figure 5.4.4-1 shows the scenario where the HSS receives a PS User State retrieval request from the IMS-AS for a subscriber who has a 5GC subscription.\nFigure 5.4.4-1: PS User State retrieval request for 5G subscriber\n1.\tThe HSS receives a PS User State retrieval request (requested nodes includes AMF) from the IMS-AS.\nNOTE 1:\tAn SBA capable IMS-AS makes use of Nhss_ImsSDM service to interact with the HSS for this operation as defined in 3GPP TS 23.228 [7]. Otherwise the IMS-AS makes use of Diameter Sh-UDR/UDA command.\n2.\tThe HSS reads subscription data from the EPS-UDR.\n3.\tThe HSS performs PS User State Retrieval from other nodes if so requested. This may include contacting the MME and/or SGSN.\n4.\tIf the request includes AMF as requested node and if the HSS detects in step 2 that the user has a 5GC subscription and unless the user is known not to be registered in 5GC, the HSS uses the Nudm_MT_ProvideUserState service operation to retrieve the 5GS User State. Otherwise, continue with step 9.\n5.\tThe UDM reads data from the 5GS-UDR to get the AMF for 3GPP Access Registration Information.\n6-7.\tThe UDM retrieves the user state from the AMF (for 3GPP access) by means of the Namf_EventExposure Subscribe service operation (one time immediate report requested).\n8.\tThe UDM provides the 5GS PS User State to the HSS.\n9.\tThe HSS provides the requested user state to the IMS-AS.\nNOTE 2:\tIf the IMS-AS supports 5G SBI it may make use of the Nhss-ims service instead of Sh.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.4.4-1",
        "ts_23.228"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.4.5",
      "section_id": "5.4.5",
      "section_title": "UE Reachability",
      "content": "Figure 5.4.5-1 shows the scenario where the HSS receives a Subscription to notification request for UE-reachability from the IMS-AS  for a subscriber who has a 5GC subscription.\nFigure 5.4.5-1: Subscription to UE reachability for 5G subscriber\n1.\tThe HSS receives a Subscribe request for UE reachability for IP from the IMS-AS.\nNOTE:\tAn SBA capable IMS-AS makes use of Nhss_ImsSDM service to interact with the HSS for this operation as defined in 3GPP TS 23.228 [7]. Otherwise the IMS-AS makes use of Diameter Sh-SNR/SNA command.\n2.\tThe HSS reads subscription data from the EPS-UDR.\n3.\tThe HSS sets the UE Reachability flags for EPC and if the UE is registered in EPC contacts the registered MME and SGSN to get notified when the UE becomes reachable.\n4.\tIf the HSS detects in step 2 that the user has a 5GC subscription, the HSS uses the Nudm_EventExposure_Subscribe service operation (one time immediate report requested) to get notified when the UDM detects UE reachability for SMS over IP. Otherwise, continue with step 10.\n5.\tThe UDM sets the URRP-AMF flag in the 5GS-UDR and reads data from the 5GS-UDR to get the AMF for 3GPP Access Registration Information and the AMF for non-3GPP Access Registration Information if any.\n6-7.\t[Conditional] If an AMF is registered in UDM for the target UE and the UDM has not already subscribed in AMF due to a previous subscription from a different NF, the UDM subscribes to UE reachability notifications at the registered AMFs by means of the Namf_EventExposure_Subscribe service operation (see 3GPP TS 23.502 [5]).\n8.\tThe UDM updates the 5GS-UDR with the EE-Subscription for the HSS.\n9.\tThe UDM acknowledges the EE Subscription to the HSS.\n10.\tThe HSS acknowledges the Sh subscription to the IMS-AS.\n11.\tThe HSS updates the EPS-UDR with the Sh subscription for the IMS-AS.\nFigure 5.4.5-2 shows the scenario where the UDM detects UE reachability for SMS over IP and notifies the HSS that has previously subscribed.\nFigure 5.4.5-2: UE reachability notification for 5G subscriber\n1.\tThe UDM receives a Notification or Registration from the AMF.\n2.\tThe UDM reads subscription data from the 5GS-UDR.\n3.\tThe UDM acknowledges step 1 towards the AMF. If an old AMF is registered in the UDM, the UDM sends a Nudm_UECM_DeregistrationNotification service operation to the old AMF.\n4.\tThe UDM notifies the HSS (and any other NF that has subscribed) about the reachability of the UE.\n5.\tThe HSS reads data from the EPS-UDR to see whether an IMS-AS has subscribed do reachability notification.\n6.\tThe HSS acknowledges step 4.\n7.\tThe UDM updates the 5GS-UDR to delete the EE-Subscription(s).\n8.\tThe HSS notifies the IMS-AS about UE reachability for IP.\nNOTE:\tAn SBA capable IMS-AS receives the notification from HSS using the Nhss_ImsSDM service as defined in 3GPP TS 23.228 [7]. Otherwise the IMS-AS receives the notification via a Diameter Sh-PNR/PNA command.\n9.\tThe IMS-AS acknowledges step 8.\n10.\tThe HSS updates the EPS-UDR to delete the IMS-AS's subscription.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.4.5-1",
        "figure_5.4.5-2",
        "ts_23.228",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.4.6",
      "section_id": "5.4.6",
      "section_title": "IMEI Retrieval",
      "content": "A pre-requisite for the retrieval of the IMEI when requested by an IMS-AS is that the IMEI for a given UE stored in HSS and UDM is always synchronized. This is, when the HSS detects that the IMEI for a UE changes (e.g. during an Update Location in EPS), the HSS informs the UDM about the IMEI change which stores the new IMEI accordingly. Similarly, when UDM detects that the IMEI changes, the UDM informs the HSS about the IMEI change which stores the new IMEI accordingly.\nThis allows that the retrieval of the IMEI for a given UE requested by an IMS-AS from HSS via Sh can be executed locally by HSS without the need of additional interworking between the HSS and the UDM\nFigure 5.4.6-1 shows the scenario where the HSS receives an IMEI retrieval request from the IMS-AS for a subscriber who has a 5GC subscription.\nFigure 5.4.6-1: IMEI retrieval request for 5G subscriber\nSteps 1 to 4 are executed when the HSS detects a change in the IMEI for a given UE (IMSI).\n1.\tThe HSS receives a request from the MME including an IMEI for the UE (e.g. Update Location Request or Notify Request).\n2.\tThe HSS detects that the IMEI received in the request is different from the previously stored in the EPS-UDR. The HSS stores the new IMEI in the EPS-UDR.\n3.\tThe HSS informs the UDM about the new PEI (IMEI) using the Nudm_UECM_Update service operation.\n4.\tThe UDM stores the new PEI for the UE.\nSteps 5 to 8 are executed when the UDM detects a change in the PEI for a given UE (SUPI).\n5.\tThe UDM receives a request from the AMF including a PEI for the UE (e.g. Nudm_UECM_Registration/Update).\n6.\tThe UDM detects that the PEI received in the request is different from the previously stored in the 5GS-UDR. The UDM stores the new IMEI in the 5GS-UDR.\n7.\tThe UDM informs the HSS about the new IMEI using the Nhss_UECM_Update service operation.\n8.\tThe HSS stores the new IMEI for the UE.\nSteps 9 to 11 are executed when the HSS receives an IMEI retrieval request from the IMS-AS for a subscriber who has a 5GC subscription.\n9.\tThe HSS receives a request from IMS-AS to retrieve the IMEI for a UE.\n10.\tThe HSS reads the IMEI stored in the EPS-UDR.\n11.\tThe HSS replies to the IMS-AS with the users IMEI. Since the IMEI for the UE has been sinchronized between HSS and UDM at every IMEI/PEI change event as in steps 1 to 4 or 5 to 8, the HSS can reply to the IMS-AS without any additional interworking with the UDM.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.4.6-1"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.4.7",
      "section_id": "5.4.7",
      "section_title": "SRVCC: IMS AS obtaining SRVCC data",
      "content": "Figure 5.4.7-1 shows the scenario where the HSS communicates with the IMS-AS in support of (5G) SRVCC for a subscriber who has a 5GC subscription. An operator shall be able to control whether the interaction between HSS and UDM is performed based on local policy.\nFigure 5.4.7-1: IMS AS obtaining data related to (5G) SRVCC and updating STN-SR\n1.\tAs described in 3GPP TS 23.237 [13], the IMS-AS sends Sh-Pull message to the UDM/HSS in order to know the SRVCC capability indicated by the UE in the EPS, and to retrieve the STN-SR stored in the UDM/HSS.\n2.\tThe HSS reads STN-SR and UE SRVCC Capability data from the EPS-UDR. The HSS reads the C‑MSISDN bound to the IMS Private User Identity.\n3.\tThe HSS, based on operator policy, may query UDM to retrieve SRVCC parameters. The HSS uses the Nudm_MT_Provide5GSRVCCInfo service operation to retrieve the STN-SR and the UE SRVCC Capability indicated by the UE in the 5GS (see 3GPP TS 23.008 [14]).\n4.\tThe UDM reads the STN-SR and this UE SRVCC Capability data from the 5GS-UDR.\n5.\tThe UDM provides the C-MSISDN, STN-SR and UE SRVCC Capability data to the HSS.\n6.\tThe HSS provides a single C‑MSISDN, a single STN-SR and UE SRVCC Capability data to the IMS-AS, as follows:\n-\tif the C‑MSISDN from the HSS and the C‑MSISDN from the UDM are empty, the HSS indicates an empty C‑MSISDN to the SCC AS. The HSS indicates a non-empty C‑MSISDN, otherwise;\n-\tif the STN-SR from the HSS or the STN-SR from the UDM is empty, it indicates the user is not subscribed to (5G) SRVCC. If the HSS and the UDM indicate the user is not subscribed to (5G) SRVCC, the HSS indicates an empty STN-SR to the SCC AS. The HSS indicates a non-empty STN-SR, otherwise.",
      "chunk_type": "requirement",
      "cross_references": [
        "figure_5.4.7-1",
        "ts_23.237",
        "ts_23.008"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.4.8",
      "section_id": "5.4.8",
      "section_title": "SRVCC: IMS AS obtaining SRVCC data – HSS using Nudr",
      "content": "When the HSS receives an S6a-AIR from the MME, it may check (by means of an EPC-UDR query) whether the subscriber has a 5G subscription. If so, the HSS can use of the Nudr_DM_Query Get service operation to retrieve the 5G SRVCC subscription data from the 5GS UDR.\nFigure 5.4.8-1 shows the scenario where the HSS communicates with the IMS-AS in support of (5G) SRVCC for a subscriber who has a 5GC subscription. An operator shall be able to control whether the interaction between HSS and 5GS-UDR is performed based on local policy.\nFigure 5.4.8-1: IMS AS obtaining data related to (5G) SRVCC – HSS using the Nudr\n1.\tAs described in 3GPP TS 23.237 [13], the IMS-AS sends Sh-Pull message to the UDM/HSS in order to know the SRVCC capability indicated by the UE in the EPS, and to retrieve the STN-SR stored in the UDM/HSS.\n2.\tThe HSS reads STN-SR and this UE SRVCC Capability data from the EPS-UDR. The HSS reads the C‑MSISDN bound to the IMS Private User Identity.\n3.\tThe HSS, based on operator policy, may query 5G-UDR to retrieve SRVCC parameters. The HSS uses the Nudr_DM_Query service operation to retrieve the STN-SR and the UE SRVCC Capability indicated by the UE in the 5GS (see 3GPP TS 23.008 [14]) from the 5GS-UDR.\n4.\tThe HSS provides a single C‑MSISDN, a single STN-SR and UE SRVCC Capability data to the IMS-AS, as follows:\n-\tif the C‑MSISDN from the HSS and the C‑MSISDN from the UDM are empty, the HSS indicates an empty C‑MSISDN to the SCC AS. The HSS indicates a non-empty C‑MSISDN, otherwise;\n-\tif the STN-SR from the HSS or the STN-SR from the UDM is empty, it indicates the user is not subscribed to (5G) SRVCC. If the HSS and the UDM indicate the user is not subscribed to (5G) SRVCC, the HSS indicates an empty STN-SR to the SCC AS. The HSS indicates a non-empty STN-SR, otherwise.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.4.8-1",
        "ts_23.237",
        "ts_23.008"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.4.9",
      "section_id": "5.4.9",
      "section_title": "SRVCC: IMS AS updating STN-SR",
      "content": "Figure 5.4.9-1 shows the scenario where the IMS-AS updates the STN-SR at the HSS. An operator shall be able to control whether the interaction between HSS and UDM is performed based on local policy.\nFigure 5.4.9-1: Updating STN-SR\n1.\tAs described in 3GPP TS 23.237 [13], the IMS-AS can use Sh-Update to provide the STN-SR received from the ATCF to the UDM/HSS in order to replace the STN-SR at the UDM/HSS.\n2.\tWhile this updated STN-SR is a transient value and subject to the user being subscribed to SRVCC, the HSS can update the STN-SR at the EPS-UDR. If the user is subscribed to SRVCC, the HSS updates the STN-SR at the EPS-UDR and at the MME/SGSN (not shown).\n3.\tThe HSS, based on operator policy, may update UDM: the HSS updates the STN-SR at the UDM.\n4.\tWhile this updated STN-SR is a transient value, the UDM can update the STN-SR at the 5GS-UDR using Nudr_DM_Update. The UDM updates the STN-SR at the AMF using Nudm_SDM_Notification service operation (not shown).\n5.\tThe UDM responds to the request to update the STN-SR.\n6.\tThe HSS responds by sending Sh-Update Response message to the IMS AS.",
      "chunk_type": "requirement",
      "cross_references": [
        "figure_5.4.9-1",
        "ts_23.237"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.5.1",
      "section_id": "5.5.1",
      "section_title": "General",
      "content": "Potential MT-SMS target nodes in the EPS are the MME/MSC and the SGSN registered at the HSS, while in 5GS MT-SMS target nodes are the 3GPP-SMSF and the Non3GPP-SMSF registered at the UDM. For the role of SMS-Router and IP-SM-GW see 3GPP TS 23.040 [12].",
      "chunk_type": "definition",
      "cross_references": [
        "ts_23.040"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.5.2",
      "section_id": "5.5.2",
      "section_title": "MT-SMS Routing Information Retrieval",
      "content": "Figure 5.5.2-1 shows the interaction when the SMS-GMSC retrieves routing information from the HSS for MT-SMS delivery.\nFigure 5.5.2-1: SMS Routing Info Retrieval\n1. The HSS receives a request for routing information from the SMS-GMSC via MAP or S6c.\n2. The HSS queries the EPS-UDR via Ud to read the registered MME/MSC, the registered SGSN, and the UE-not-reachable flags for SMS in MME/MSC, SGSN and UDM.\n3. If the UE-not-reachable flag for SMS in UDM is not set and unless the user is known not to be registered in 5GC, the HSS retrieves the registered SMSF addresses for 3GPP and non-3GPP accesses (if any) from the UDM.\nNOTE:\tThis interaction is achieved in the current release by means of the Nudm_UECM_SendRoutingInfoForSM service operation; however, for backwards-compatibility reasons, HSS can also use the Nudm_UECM_Get service operation, as defined in pre-Rel17 versions of this specification.\n4-5. The UDM retrieves the requested information from the 5GS-UDR.\n6. The UDM forwards the retrieved addresses to the HSS if any. If the UE is not reachable for MT-SMS in 5GS for any access type (e.g. there is no SMSF registered for the UE or SMSF registration exists but UE is known not to be reachable in 5GS based on URRP flag), the UDM provides a negative response (Absent Subscriber SM) to the HSS.\nIf SMS over NAS is not allowed for the user in 5GS based on subscription data, e.g. SMS teleservice is not provisioned or SMS is barred, the UDM indicates in the response to the HSS the corresponding error condition.\n7. The HSS returns the relevant MT-SMS target node addresses registered in HSS and/or UDM to the SMS-GMSC and the procedure is terminated.\nOtherwise, if there is no MT-SMS target node address registered in HSS nor in UDM, a negative response (Absent Subscriber SM) is sent to the SMS-GMSC and the procedure continues with steps 8 to 11.\n8. The HSS includes the SMSC address to the Message Waiting Data (MWD) stored in the EPS-UDR and informs the SMSC as defined in TS 23.040 [12]. The relevant UE-not-reachable flags are set in the EPS-UDR.\nIf SMS is not allowed for the user in 5GS according to subscription data as indicated in step 6, steps 9 to 11 are not executed so that the HSS does not subscribe to notifications about reachability for SMS in the UDM, and the procedure is terminated.\n9. The HSS subscribes in UDM to be notified when the UE becomes reachable for SMS (i.e. when the UE gets in radio contact with the AMF while an SMSF actually is registered, or when an SMSF gets registered) by using the Nudm_EE_Subscribe service operation (SUPI, UE Reachability for SMS event) as defined in 3GPP TS 23.502 [5].\n10. The UDM stores the EE-subscription (Reachability for SMS) in the 5G-UDR.\n11. The UDM acknowledges the subscription to the HSS.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.5.2-1",
        "ts_23.040",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.5.3",
      "section_id": "5.5.3",
      "section_title": "MT-SMS Delivery Failure",
      "content": "Figure 5.5.3-1 shows the interaction when the SMS-GMSC sends Report-SM-Delivery-Status to the HSS.\nFigure 5.5.3-1: MT-SMS Delivery Failure\n1. The HSS receives a Report-SM-Delivery-Status from the SMS-GMSC indicating the MT-SMS target nodes at which MT-SMS delivery was unsuccessful.\n2-3. The HSS reads and updates the Message Waiting Data stored in the EPS-UDR.\n4. The HSS acknowledges the receipt of the delivery status to the SMS-GMSC.\n5. If the UE-not-reachable flag for UDM is set to true, the HSS subscribes to notification on UE-Reachability for SMS at the UDM, using the Nudm_EE_Subscribe service operation as defined in 3GPP TS 23.502 [5], unless such subscription already exists.\n6-7. The UDM checks that the UE is registered in an AMF and SMSF for 3GPP and non-3GPP accesses. The UDM then queries the 5GS-UDR to see whether the UE-Reachability event has already been subscribed at the registered AMF(s) (i.e. whether URRP-AMF flag is set).\n8-9. If not already subscribed, the UDM subscribes to UE-Reachability notification at the AMF(s) using the Namf_EE service.\nNOTE:\tAs defined in 3GPP TS 23.502 [5], the UDM can trigger UE Reachability Notification Request procedure with two different AMFs for a UE which is connected to 5G Core Network over 3GPP access and non-3GPP access simultaneously.\n10-11. The UDM stores the received EE-Subscription in the 5GS-UDR and if steps 8-9 were performed, the UDM sets the relevant URRP-AMF flags in the 5GS-UDR.\n12. The UDM acknowledges the subscription to the HSS.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.5.3-1",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.5.4",
      "section_id": "5.5.4",
      "section_title": "SMS Alerting",
      "content": "Figure 5.5.4-1 shows the interaction when the UE becomes available.\nFigure 5.5.4-1: SMS Alerting\n1. The UDM receives a Notification from the AMF or an SMSF Registration.\n2-3. The UDM queries the 5GS-UDR to see whether any NF (e.g. the HSS) has subscribed to notifications on UE-reachability for SMS events and/or \"UE memory available for SMS\".\n4. The UDM acknowledges the message received in step 1.\n5. If the HSS has subscribed to UE reachability for SMS notification and/or \"UE memory available for SMS\", the UDM notifies the HSS as described in 3GPP TS 23.502 [5].\n6-7. The UDM updates (clears) the relevant reachability flag. And, if the HSS has been notified in step 5, the UDM also deletes the (one-time) EE-subscriptions of UE reachability for SMS in the 5GS-UDR.\nSteps 8 to 11 are skipped if the HSS has not been notified in step 5.\n8. The HSS reads Message Waiting Data from the EPS-UDR.\n9-10. If the notification of \"UE memory available for SMS\" is received from the UDM, the HSS sends Alert-SC to all SMS-GMSCs stored in the MWD.\n11. The HSS clears the relevant UE-not-reachable flags and the MCEF flag from the EPS-UDR and removes the SMS-GMSCs from the MWD stored in the EPS-UDR if the notification of \"UE memory available\" is received.\n12. The HSS acknowledges receipt of the Notification to the UDM.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.5.4-1",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.5.5",
      "section_id": "5.5.5",
      "section_title": "MT-SMS Routing Information Retrieval Over Nudr",
      "content": "Figure 5.5.5-1 shows the interaction when the SMS-GMSC retrieves routing information from the HSS for MT-SMS delivery when the HSS uses the Nudr SBI.\nFigure 5.5.5-1: SMS Routing Info Retrieval over Nudr\n1. The HSS receives a request for routing information from the SMS-GMSC via MAP or S6c.\n2. The HSS queries the EPS-UDR via Ud to read the registered MME/MSC, the registered SGSN and the UE-not-reachable flags for MME/MSC, SGSN and UDM.\n3-4. If the UE-not-reachable flag for UDM is not set and unless the user is known not to be registered in 5GC, the HSS retrieves the registered SMSF addresses for 3GPP and non-3GPP accesses (if any) from the 5GS-UDR.\n5. The HSS returns the relevant MT-SMS target node addresses registered in HSS and/or UDM to the SMS-GMSC and the procedure is terminated.\nOtherwise, if there is no MT-SMS target node address registered in HSS nor in UDM, a negative response (Absent Subscriber SM) is sent to the SMS-GMSC and the procedure continues with steps 8 to 11 in figure 5.5.2-1.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.5.5-1",
        "figure_5.5.2-1"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.5.6.1",
      "section_id": "5.5.6.1",
      "section_title": "General",
      "content": "In deployment scenarios where 2G/3G/4G accesses are available, SMS over IP is supported as described in 3GPP TS 23.204 [18], and the interactions between HSS and UDM are those defined in clauses 5.5.2, 5.5.3 and 5.5.4.\nFor MT-SMS delivery over 5G NAS in deployment scenarios where support for SMS over IP is also required but 2G/3G/4G accesses are not supported, the MAP-C and/or Diameter S6c refence points with the SMS-GMSC and the MAP-J and/or Diameter S6c reference points with the IP-SM-GW are exposed by the UDM. The UDM and the HSS (IMS) need to interact for the registration of the IP-SM-GW address as defined in clause 5.5.6.2. Clauses 5.5.6.3 and 5.5.6.4 define the interworking between the UDM and the HSS (IMS) during delivery failure and alert procedures.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_5.5.6.2",
        "ts_23.204"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.5.6.2",
      "section_id": "5.5.6.2",
      "section_title": "IP-SM-GW registration and SMS routing information retrieval in 5GC only deployments",
      "content": "Figure 5.5.6.2-1 shows the interaction for the registration of the IP-SM-GW address in the UDM and subsequent SMS routing information retrieval.\nFigure 5.5.6.2-1: IP-SM-GW registration in UDM and SMS routing info retrieval in 5GC only deployments\n1.\tThe IP-SM-GW registers its address in HSS (IMS) via Sh as defined in 3GPP TS 23.204 [18]. If the EPS-UDR is used, the HSS (IMS) stores the IP-SM-GW address in the EPS-UDR.\n2.\tThe HSS forwards the IP-SM-GW registration to the UDM using a Nudm_UECM_IPSMGWRegistration request. The request includes the address of the IP-SM-GW to be registered in the UDM. If the 5GS-UDR is used, the UDM stores the IP-SM-GW address in the 5GS-UDR.\n3.\tThe UDM confirms the IP-SM-GW registration with a successful Nudm_UECM_IPSMGWRegistration response. After successful registration of the IP-SM-GW address, the UDM checks whether message waiting data are stored and alerts all SCs using procedures described in 3GPP TS 23.204 [18].\n4.\tThe UDM receives a request for routing information from the SMS-GMSC via MAP or Diameter. If the 5GS-UDR is used, the UDM queries the 5GS-UDR to read the registered SMSF and/or IP-SM-GW, if any. Routing information is provided to SMS-GMSC from IP-SM-GW or UDM.\nThe options shown are based on the options for MT SMS procedure described in clause 6.4 of 3GPP TS 23.204 [18], considering a 5GC only deployment where UDM is present and HLR/HSS serving 2G/3G/4G accesses is not deployed. Steps 4a-4c correspond to 3a-3c; step 4d corresponds to 3d; and steps 4e-4f correspond to 3e-3f, respectively, as shown in figure 6.4 of 3GPP TS 23.204 [18].\nFigure 5.5.6.2-2 shows the interaction for the deregistration of the IP-SM-GW address in the UDM.\nFigure 5.5.6.2-2: IP-SM-GW deregistration in UDM and SMS routing info retrieval in 5GC only deployments\n1.\tThe IP-SM-GW deregisters its address in HSS (IMS) via Sh as defined in 3GPP TS 23.204 [18]. If the EPS-UDR is used, the HSS (IMS) removes the IP-SM-GW address from the EPS-UDR.\n2.\tThe HSS forwards the IP-SM-GW deregistration request to the UDM using a Nudm_UECM_IPSMGWDeregistration request. If the 5GS-UDR is used, the UDM removes the IP-SM-GW address from the 5GS-UDR.\n3.\tThe UDM confirms the IP-SM-GW deregistration with a successful Nudm_UECM_IPSMGWDeregistration response.\n4 - 5.\tIf the UDM receives a request for routing information from the SMS-GMSC via MAP or Diameter, the UDM checks if there is an IP-SM-GW address registered for the UE. If the 5GS-UDR is used, the UDM queries the 5GS-UDR to read the registered SMSF and/or IP-SM-GW, if any. If an IP-SM-GW address is not present, the UDM follows the MT SMS procedures defined in clause 4.13.3 of 3GPP TS 23.502 [5] and 3GPP TS 23.040 [17].",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.204_clause_6.4",
        "ts_23.502_clause_4.13.3",
        "figure_5.5.6.2-1",
        "ts_23.204_figure_6.4",
        "ts_23.204_figure_5.5.6.2-2",
        "figure_5.5.6.2-2",
        "ts_23.204",
        "ts_23.502",
        "ts_23.040"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.5.6.3",
      "section_id": "5.5.6.3",
      "section_title": "MT SMS delivery failure in 5GC only deployments",
      "content": "Figure 5.5.6.3-1 shows the interactions for the unsuccessful MT SMS delivery case in a 5GC only deployment requiring SMSoIP.\nFigure 5.5.6.3-1: MT SMS delivery failure in 5GC only deployments supporting SMSoIP\n1 - 7.\tThe message delivery fails after the IP‑SM‑GW has tried all selectable domains, and the IP-SM-GW forwards the received unsuccessful Delivery report to the SMS‑GMSC, as described in steps 1-16 in clause 6.5a of 3GPP TS 23.204 [18].\n8.\tThe IP-SM-GW sends a Report SM Delivery Status message to the UDM with accurate results from different domains. If the 5GS-UDR is used, the UDM records the corresponding MWD in the 5GS-UDR.\n9.\tThe IP-SM-GW subscribes to the HSS (IMS) for a one-time notification of the UE being reachable again.\n10.\tThe HSS (IMS) records the subscription and subscribes to notification on UE Reachability for SMS over IP event at the UDM, using the Nudm_EE_Subscribe service operation.\n11 - 12.\tThe UDM checks whether UE Reachability has already been subscribed at the registered AMF(s) (i.e. whether URRP-AMF flag is set), querying 5GS-UDR if applicable. If not already subscribed, the UDM subscribes to UE Reachability notification at the AMF(s) using the Namf_EE service.\nIf 5GS-UDR is used, the UDM stores the received EE-Subscription from HSS (IMS) in the 5GS-UDR, and if subscription to AMF is performed in this step, the UDM sets the relevant URRP-AMF flag in the 5GS-UDR.\n13.\tThe UDM acknowledges the subscription of the HSS (IMS).\n14.\tThe SMS-GMSC sends a Report SM Delivery Status message to the UDM. The UDM shall ignore the information provided in this report.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.204_clause_6.5",
        "figure_5.5.6.3-1",
        "ts_23.204"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.5.6.4",
      "section_id": "5.5.6.4",
      "section_title": "Alert Service Centre in 5GC only deployments",
      "content": "Figure 5.5.6.4-1 shows the interactions when the UE becomes available in a 5GC only deployment requiring SMSoIP.\nFigure 5.5.6.4-1: Alert Service Centre procedure in 5GC only deployments supporting SMSoIP\nThe steps described below are based on the procedure described in clause 6.5b of 3GPP TS 23.204 [18], considering a 5GC only deployment.\n1.\tMT SMS procedure is unsuccessful as described in clause 5.5.6.3.\n2.\tAt any time after the unsuccessful SM termination procedure, the UE may become available due to registration in IMS (step 2a). After the IMS registration is finished, the procedure continues as described in step 3.\nAt any time after the unsuccessful SM termination procedure, the UDM can receive a notification from AMF indicating that the UE is reachable again or an AMF registration (step 2b). The UDM checks whether any NF (e.g. the HSS) has subscribed to notification on UE Reachability for SMS over IP events, querying 5GS-UDR if applicable. If the HSS has subscribed to such notification, the UDM notifies the HSS (step 2c). As the IP-SM-GW has subscribed to the event of UE being reachable again as described in clause 5.5.6.3, the HSS shall notify the IP-SM-GW (step 2d). If the UE is already registered in IMS, the IP-SM-GW shall then send a Ready for SM message to the UDM (step 2e) and the procedure continues as described in step 3. Otherwise, the IP-SM-GW discards the notification message.\n3.\tThe UDM checks the user's MWD. If MWD is not null, the UDM sends an Alert Service Centre message to the SMS‑IWMSC.\n4.\tThe SMS‑IWMSC forwards the Alert Service Centre procedure to the SMS‑SC.\n5.\tUpon receipt of the Alert Service Centre message, the SMS‑SC re-attempts to send the stored Short Message.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.204_clause_6.5",
        "clause_5.5.6.3",
        "figure_5.5.6.4-1",
        "ts_23.204"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.6.1",
      "section_id": "5.6.1",
      "section_title": "General",
      "content": "As specified in 3GPP TS 23.501 [2] and 3GPP TS 23.502 [5], a combined SCEF+NEF can configure monitoring events applicable to both EPC and 5GC using only 5GC procedures towards UDM. In this case, the SCEF+NEF indicates that the monitoring event is also applicable to EPC together with the SCEF identity, i.e. the event must be reported both by 5GC and EPC.\nIf the HSS and UDM are deployed as separate network entities as defined in this specification, UDM uses HSS services to configure the monitoring event in EPC. For events requiring reporting from MME towards SCEF or HSS, the UDM requests the configuration of the monitoring event in the EPC to the HSS as defined in clause 5.6.2.\nCommon exposure scenarios are applicable for users having both EPC and 5GC subscription.\nThe status of specific monitoring events that are detected locally at the HSS and UDM (e.g. IMEI/PEI change, roaming status change) is kept synchronized between UDM and HSS as defined in clause 5.6.3 avoiding the need to configure those events in UDM and HSS.",
      "chunk_type": "definition",
      "cross_references": [
        "clause_5.6.2",
        "clause_5.6.3",
        "ts_23.501",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.6.2",
      "section_id": "5.6.2",
      "section_title": "Configuration of Monitoring Events in MME",
      "content": "Figure 5.6.2-1 shows the scenario where the UDM receives a request from a combined SCEF+NEF to configure a monitoring event that needs to be reported by EPC (e.g. location change).\nFigure 5.6.2-1: Configuration of Monitoring Events in MME\n1.\tThe UDM receives a request from a combined SCEF+NEF to configure a monitoring event for a UE or for a group of UEs. The request indicates that the subscription applies also to EPC and the monitoring event is to be reported by the MME (e.g. location change). The request includes the notification addresses of both the NEF and the SCEF.\n2.\tThe UDM configures the monitoring event for the UE or for the group of UEs in 5GC. If the 5GS UDR is used, the UDM stores the configuration of the monitoring event for the UE in the 5GS-UDR. The UDM contacts the corresponding NF within the 5GC (e.g. AMF, SMF) as required by the monitoring event.\n3.\tUnless the subscription information related to the UE or to the group of UEs indicates that the UE or the group of UEs has no EPC subscription data, then the UDM requests the HSS to configure the monitoring event for the UE or for the group of UEs in EPC using a Nhss_EventExposure_Subscribe operation. In addition to the UDM notification address, the UDM provides the SCEF notification address (i.e. SCEF Id).\n4.\tThe HSS configures the monitoring event for the UE or for the group of UEs in EPC using the procedures defined in 3GPP TS 23.682 [16].\n5.\tThe HSS replies to the UDM with the result of the subscription request.\nIf immediate reporting was required and the current event status is available at HSS (or received from MME in step 4) and if both the UDM and the HSS support to include event reports in the subscription response, the HSS also includes the current event status in the subscription response to UDM and step 6a is skipped.\nIf immediate reporting was required but the current event status is not available at HSS (and not received from MME in step 4), the HSS includes a flag in the subscription response indicating that immediate event report is not available.\n6.\tThe UDM replies to the combined SCEF+NEF including confirmation that the subscription was also successful in EPC domain.\n6a.\t(Conditional) If immediate reporting was required and the current event status is available at HSS (or received from MME in step 4) but the UDM and/or the HSS cannot support to include event reports in the subscription response, the HSS sends a notification including the current event status for immediate reporting, to the UDM using the Nhss_EE_Notify service operation. The UDM then notifies NEF using the Nudm_EE_Notify service operation.\n7.\tAt a later stage, the monitoring event is detected for the UE or for the group of UEs in the EPC domain. The event may be detected at the MME (e.g. location change) or at the HSS (e.g. UE reachability for SMS).\n8.\tThe monitoring event is reported to the SCEF+NEF. The MME notifies the event as defined in 3GPP TS 23.682 [16] by using the SCEF notification address provided by the HSS in step 4, if applicable. If the monitoring event is detected at the HSS or reported by the MME to the HSS, the HSS notifies the monitoring event to UDM using the Nhss_EE_Notify service operation. The UDM then notifies NEF using the Nudm_EE_Notify service operation.\nNOTE:\tThe notification of monitoring events from HSS (e.g. reachability for SMS) using SBA interfaces supersedes the option of HSS using diameter S6t. Only the events reported by MME will keep diameter T6a interface towards SCEF.",
      "chunk_type": "general",
      "cross_references": [
        "figure_5.6.2-1",
        "ts_23.682"
      ]
    },
    {
      "chunk_id": "ts_23.632_5.6.3",
      "section_id": "5.6.3",
      "section_title": "Synchronization of Status of Monitoring Event between HSS and UDM",
      "content": "The status of some specific monitoring events that are detected locally at the HSS and UDM (e.g. IMEI(SV)/PEI change, roaming status change) is kept synchronized between UDM and HSS as defined in this clause. This is, when the HSS detects e.g. that the IMEI(SV) for a UE changes (e.g. during an Update Location in EPS), the HSS informs the UDM about the IMEI(SV) change which stores the new IMEI(SV)/PEI accordingly and when UDM detects e.g. that the IMEI(SV)/PEI for a UE changes (e.g. during an AMF registration procedure in 5GC), the UDM informs HSS about the IMEI(SV)/PEI change as described in section 5.4.6.\nHSS and UDM can store the last IMEI(SV)/PEI and Roaming Status even when the UE is not currently located/registered in EPS or 5GC access respectively. If the UE has never registered in 5GC and last PEI is not stored, UDM shall notify HSS about the new PEI received and retrieve the last IMEI stored in HSS to notify the change of PEI/IMEI event when applicable.\nNOTE:\tThe synchronization of the status of these monitoring events shall be enabled bled in both HSS and UDM based on local policieswhenever common exposure is supported or last known IMEI is required in HSS/UDM.\nThis allows that the subscriptions to these specific monitoring events are applied in both domains when the PEI type is IMEI(SV). The UDM is capable of notifying these events taking place in EPS to the combined SCEF+NEF using SBI procedures.\nFigure 5.6.3-1 shows the scenario where the UDM receives a request from a combined SCEF+NEF to subscribe to a monitoring event in 5GC and EPC that is reported by the UDM.\nFigure 5.6.3-1: Synchronization of Status of Monitoring Events between HSS and UDM\n1.\tThe UDM receives a request from a combined SCEF+NEF to configure a monitoring event for a UE. The request indicates that the subscription applies also to EPC (e.g. IMEI(SV)/PEI change) and UDM is expected to report the event.\n2.\tThe UDM stores in the 5GS-UDR the monitoring event together with the notification address (e.g., the NEF notification address) of the combined SCEF+NEF.\n3.\tThe UDM replies to the combined SCEF+NEF including a confirmation that the configuration of the event was also successful in EPC domain.\nNOTE:\tA UDM that supports interworking with EPC relies on the HSS to synchronize the status of these monitoring events in the EPC domain with the UDM (i.e. the UDM does not need to subscribe to the monitoring event towards the HSS) for UEs that have subscription data in EPC and 5GC.\n4.\tAt a later stage, the HSS detects the event (e.g. IMEI(SV) change) for the UE in the EPC domain (e.g. during an Update Location Request procedure).\n5.\tThe HSS synchronizes with the UDM about the event using the Nudm_UECM_Update service operation.\n6.\tThe UDM stores the information received from HSS (e.g. a new PEI for the UE) in the 5GS-UDR and checks if a related subscription to the related monitoring event exists.\n7.\tThe UDM notifies the NEF accordingly.\n8.\tAlternatively, the monitoring event may be detected by the UDM.\n9. The UDM notifies the NEF accordingly.\n10. The UDM synchronizes with the HSS about the event using the Nhss_UECM_Update service operation.\n11.\tThe HSS stores the status of the monitoring event received from the UDM in the EPS-UDR.",
      "chunk_type": "general",
      "cross_references": [
        "clause_5.4.6",
        "figure_5.6.3-1"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.1.1",
      "section_id": "6.1.1",
      "section_title": "General",
      "content": "The following table illustrates the HSS Services.\nTable 6.1.1-1: NF services provided by HSS\nNF service\nService Operations\nOperation Semantics\nExample Consumer(s)\nUE Authentication\nGet\nRequest/Response\nUDM\nUECM\nSNDeregistration\nRequest/Response\nUDM\nUpdate\nRequest/Response\nUDM\nSDM\nGet\nRequest/Response\nUDM\nSubscribe\nSubscribe/Notify\nUDM\nUnsubscribe\nNotify\nEE\nSubscribe\nSubscribe/Notify\nUDM\nUnsubscribe\nNotify",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.1.1-1"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.1.2.1",
      "section_id": "6.1.2.1",
      "section_title": "Nhss_UEAuthentication_Get service operation",
      "content": "Service operation name: Nhss_UEAuthentication_Get\nDescription: Requester NF gets the authentication vector from HSS. For AKA based authentication, this operation can be also used to recover from synchronization failure situations.\nInputs, Required: IMSI, authentication method, serving network name.\nInputs, Optional: Synchronization Failure indication and related information (i.e. RAND/AUTS).\nOutputs, Required: Authentication vector.\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.1.3.1",
      "section_id": "6.1.3.1",
      "section_title": "Nhss_UECM_SNDeregistration service operation",
      "content": "Service operation name: Nhss_UECM_SNDeregistration.\nDescription: The NF consumer requests the HSS to initiate cancel location to the Serving Node registered in HSS serving the UE in EPS and/or PS, if any.\nInputs, Required: IMSI, deregistration reason.\nInputs, Optional: None.\nOutputs, Required: Result Indication.\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.1.3.2",
      "section_id": "6.1.3.2",
      "section_title": "Nhss_UECM_Update service operation",
      "content": "Service operation name: Nhss_UECM_Update.\nDescription: The NF consumer informs the HSS about an update in the UE Context (e.g. a change in the IMEI).\nInputs, Required: IMSI.\nInputs, Optional: IMEI(SV), serving PLMN.\nOutputs, Required: Result Indication.\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.1.4.1",
      "section_id": "6.1.4.1",
      "section_title": "Nhss_SDM_Get service operation",
      "content": "Service operation name: Nhss_SDM_Get\nDescription: The consumer NF gets the subscriber data indicated by the requested data type from HSS. In this release, only the PGW-C+SMF FQDN for S5/S8/S2b interface information is supported as requested data type.\nInputs, Required: IMSI, requested data.\nInputs, Optional: None.\nOutputs, Required: The consumer NF gets the requested subscription data\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.1.4.2",
      "section_id": "6.1.4.2",
      "section_title": "Nhss_SDM_Notification service operation",
      "content": "Service or service operation name: Nhss_SDM_Notification\nDescription: The HSS notifies NF consumer of the updates of the subscriber data indicated by the \"subscription data Type\" input. In this release, only the PGW-C+SMF FQDN for S5/S8/S2b interface information is supported as subscription data type.\nInputs, Required: IMSI, Subscription data type(s).\nInputs, Optional: None.\nOutputs, Required: Result Indication.\nThe HSS invokes this service operation under the following cases:\n-\tWhen the PGW-C+SMF FQDN for S5/S8/S2b interface information is updated at the HSS, the updated information is notified to the NF consumer that has subscribed for the specific subscription data type to be notified.\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.1.4.3",
      "section_id": "6.1.4.3",
      "section_title": "Nhss_SDM_Subscribe service operation",
      "content": "Service operation name: Nhss_SDM_Subscribe\nDescription: The NF consumer subscribes for updates to the subscriber data indicated by the 'subscription data type' input. The HSS shall check the requested consumer is authorized to subscribe to requested updates. In this release, only the PGW-C+SMF FQDN for S5/S8/S2b interface information is supported as subscription data type.\nInputs, Required: IMSI, Subscription data type(s).\nInputs, Optional: None.\nOutputs, Required: None.\nOutputs, Optional: None.",
      "chunk_type": "requirement",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.1.4.4",
      "section_id": "6.1.4.4",
      "section_title": "Nhss_SDM_Unsubscribe service operation",
      "content": "Service operation name: Nhss_SDM_Unsubscribe\nDescription: The NF consumer unsubscribes from updates to the subscriber data indicated by the 'subscription data type' input. In this release, only the PGW-C+SMF FQDN for S5/S8 interface information is supported as subscription data type.\nInputs, Required: IMSI, Subscription data type(s).\nInputs, Optional: None.\nOutputs, Required: None.\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.1.5.1",
      "section_id": "6.1.5.1",
      "section_title": "Nhss_EE_Subscribe service operation",
      "content": "Service operation name: Nhss_EE_Subscribe.\nDescription: The NF consumer request the HSS to subscribe to notifications for monitoring events as described in 3GPP TS 23.682 [16] (e.g. location change).\nInputs, Required: IMSI, monitoring event type(s), notification address.\nInputs, Optional: -\nOutputs, Required: Result Indication, Subscription ID.\nOutputs, Optional: Current State Not Available Indication.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.682"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.1.5.2",
      "section_id": "6.1.5.2",
      "section_title": "Nhss_EE_Unsubscribe service operation",
      "content": "Service operation name: Nhss_EE_Unsubscribe.\nDescription: The NF consumer request the HSS to delete the subscription of a monitoring event.\nInputs, Required: Subscription ID.\nInputs, Optional: -\nOutputs, Required: Operation execution result indication.\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.1.5.3",
      "section_id": "6.1.5.3",
      "section_title": "Nhss_EE_Notify service operation",
      "content": "Service operation name: Nhss_EE_Notify.\nDescription: The HSS reports the monitoring event to the consumer that has previously subscribed.\nInputs, Required: Event ID, Notification Correlation Information, time stamp.\nInputs, Optional: Event specific parameters list.\nOutputs, Required: None.\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.2.1",
      "section_id": "6.2.1",
      "section_title": "General",
      "content": "The following table illustrates the UDM Services.\nTable 6.2.1-1: NF services provided by UDM\nNF service\nService Operations\nOperation Semantics\nExample Consumer(s)\nUECM\nP-CscfRestorationTrigger\nRequest/Response\nHSS\nGet\nRequest/Response\nHSS\nAMFDeregistration\nRequest/Response\nHSS\nUpdate\nRequest/Response\nHSS\nMT\nProvideDomainSelectionInfo\nRequest/Response\nHSS\nProvideUserState\nRequest/Response\nHSS\nProvideLocationInfo\nRequest/Response\nHSS\nProvide5GSRVCCInfo\nRequest/Response\nHSS\nEventExposure\nSubscribe\nSubscribe/Notify\nHSS\nNotify\nUEAU\nGetHssAv\nRequest/Response\nHSS\nSDM\nGet\nRequest/Response\nHSS\nSubscribe\nSubscribe/Notify\nHSS\nUnsubscribe\nNotify\nPP\nUpdate\nRequest/Response\nHSS",
      "chunk_type": "definition",
      "cross_references": [
        "table_6.2.1-1"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.2.2.1",
      "section_id": "6.2.2.1",
      "section_title": "Nudm_UECM_P-CscfRestorationTrigger service operation",
      "content": "Service operation name: Nudm_UECM_P-CscfRestorationTrigger\nDescription: Requester NF (HSS) triggers the UDM to notify all NFs (AMF, SMF) that have previously subscribed to receive notifications for P-CSCF restoration.\nInputs, Required: SUPI.\nInputs, Optional: None.\nOutputs, Required: None.\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.2.2.2",
      "section_id": "6.2.2.2",
      "section_title": "Nudm_UECM_Get service operation",
      "content": "See 3GPP TS 23.502 [5] clause 5.2.3.2.4.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.502_clause_5.2.3.2.4",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.2.2.3",
      "section_id": "6.2.2.3",
      "section_title": "Nudm_UECM_AMFDeregistration service operation",
      "content": "Service operation name: Nudm_UECM_AMFDeregistration.\nDescription: The NF consumer requests the UDM to initiate deregistration of the AMF serving the UE, if any.\nInputs, Required: SUPI, deregistration reason.\nInputs, Optional: None.\nOutputs, Required: Result Indication.\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.2.2.4",
      "section_id": "6.2.2.4",
      "section_title": "Nudm_UECM_Update service operation",
      "content": "See 3GPP TS 23.502 [5] clause 5.2.3.2.5.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.502_clause_5.2.3.2.5",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.2.3.1",
      "section_id": "6.2.3.1",
      "section_title": "Nudm_MT_ProvideDomainSelectionInfo Service",
      "content": "Service operation name: Nudm_MT_ProvideDomainSelectionInfo\nDescription: Provides the UE information for terminating domain selection of IMS voice in 5G to the consumer NF (HSS).\nInputs, Required: SUPI.\nInputs, Optional: None.\nOutputs, Required: Success/Failure indication.\nOutputs, Optional: Indication of supporting IMS voice over PS Session or not, Time stamp of the last radio contact with the UE, Current RAT type.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.2.3.2",
      "section_id": "6.2.3.2",
      "section_title": "Nudm_MT_ProvideUserState service operation",
      "content": "Service operation name: Nudm_MT_ProvideUserState\nDescription: Provides the UE's 5GS PS User State to the consumer NF (HSS).\nInputs, Required: SUPI.\nInputs, Optional: None.\nOutputs, Required: Success/Failure indication.\nOutputs, Optional: 5GS User State.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.2.3.3",
      "section_id": "6.2.3.3",
      "section_title": "Nudm_MT_ProvideLocationInfo service operation",
      "content": "Service operation name: Nudm_MT_ProvideLocationInfo\nDescription: Provides the UE's 5GS location information to the consumer NF (HSS).\nInputs, Required: SUPI, Current Location Indicator, Serving Node Indication, Local Time Zone Indication, and RAT-Type requested Indicator.\nInputs, Optional: None.\nOutputs, Required: Success/Failure indication.\nOutputs, Optional: 5GS location information.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.2.3.4",
      "section_id": "6.2.3.4",
      "section_title": "Nudm_MT_Provide5GSRVCCInfo Operation",
      "content": "Service operation name: Nudm_MT_ProvideSRVCCInfo\nDescription: Provides the UE PS to CS SRVCC capability for the UE to the consumer NF (HSS).\nInputs, Required: SUPI.\nInputs, Optional: None.\nOutputs, Required: Success/Failure indication.\nOutputs, Optional: Indication of the UE supporting SRVCC capability or not, If the 5GS supports 5G-SRVCC, an STN-SR and a C-MSIDSN.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.2.4.1",
      "section_id": "6.2.4.1",
      "section_title": "Nudm_EventExposure_Subscribe service operation",
      "content": "See 3GPP TS 23.502 [5] clause 5.2.3.5.2.\nWhen used by the HSS in MT-SMS delivery failure scenarios (see clause 4.6.3) the subscribe request shall be a one-time subscription for UE-reachability for SMS and shall indicate whether it is applicable to 3GPP access, Non3GPP access or both.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_23.502_clause_5.2.3.5.2",
        "clause_4.6.3",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.2.4.2",
      "section_id": "6.2.4.2",
      "section_title": "Nudm_EventExposure_Notify service operation",
      "content": "See 3GPP TS 23.502 [5] clause 5.2.3.5.4.\nWhen used by the HSS in SMS Alerting scenarios (see clause 4.6.4) the notify request shall indicate whether it is applicable to 3GPP access or Non3GPP access.",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_23.502_clause_5.2.3.5.4",
        "clause_4.6.4",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.2.5.1",
      "section_id": "6.2.5.1",
      "section_title": "Nudm_UEAuthentication_GetHssAv service operation",
      "content": "Service operation name: Nudm_UEAuthentication_GetHssAv\nDescription: Requester NF gets the authentication vector from UDM. For AKA based authentication, this operation can be also used to recover from synchronization failure situations.\nInputs, Required: SUPI, authentication method (e.g. EAP-AKA', EPS-AKA, IMS-AKA, GBA-AKA), serving network name.\nInputs, Optional: Synchronization Failure indication and related information (i.e. RAND/AUTS).\nOutputs, Required: Authentication vector.\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.2.6.1",
      "section_id": "6.2.6.1",
      "section_title": "Nudm_SDM_Get service operation",
      "content": "See 3GPP TS 23.502 [5] clause 5.2.3.3.2.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.502_clause_5.2.3.3.2",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.2.6.2",
      "section_id": "6.2.6.2",
      "section_title": "Nudm_SDM_Subscribe service operation",
      "content": "See 3GPP TS 23.502 [5] clause 5.2.3.3.4.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.502_clause_5.2.3.3.4",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.2.6.3",
      "section_id": "6.2.6.3",
      "section_title": "Nudm_SDM_Unsubscribe service operation",
      "content": "See 3GPP TS 23.502 [5] clause 5.2.3.3.5.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.502_clause_5.2.3.3.5",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.2.6.4",
      "section_id": "6.2.6.4",
      "section_title": "Nudm_SDM_Notify service operation",
      "content": "See 3GPP TS 23.502 [5] clause 5.2.3.3.3.",
      "chunk_type": "general",
      "cross_references": [
        "ts_23.502_clause_5.2.3.3.3",
        "ts_23.502"
      ]
    },
    {
      "chunk_id": "ts_23.632_6.2.7.1",
      "section_id": "6.2.7.1",
      "section_title": "Nudm_PP_Update service operation",
      "content": "Service operation name: Update\nDescription: Removes, provides or modifies the STN-SR, CMSISDN, if the 5GS support 5G-SRVCC.\nInputs, Required: None.\nInputs, Optional: SUPI, STN-SR, CMSISDN.\nOutputs, Required: Success/Failure indication.\nOutputs, Optional: None.",
      "chunk_type": "general",
      "cross_references": []
    },
    {
      "chunk_id": "ts_23.632_6.3",
      "section_id": "6.3",
      "section_title": "UDR Services",
      "content": "The UDM and optionally the HSS shall make use of the Nudr_DataRepository Query service operations specified in 3GPP TS 23.502 [5] to retrieve Authentication Subscription Data. If the subscribed authentication method is 5G_AKA or EAP_AKA_PRIME, the AuthenticationSubscriptionData shall include an indicator indicating whether for the identified subscriber authentication vector generation is to be performed by the HSS.\nAnnex A (informative):Change history\nChange history\nDate\nMeeting\nTDoc\nCR\nRev\nCat\nSubject/Comment\nNew version\n2019-04\nCT4#90\nC4-191319\nSkeleton\n0.1.0\n2019-04\nCT4#90\nC4-191320\nScope\n0.2.0\n2019-04\nCT4#90\nC4-191321\nReference Architecture\n0.2.0\n2019-05\nCT4#91\nC4-192135\nRemoval of Editor's Note\n0.3.0\n2019-05\nCT4#91\nC4-192402\nP-CSCF Restoration\n0.3.0\n2019-05\nCT4#91\nC4-192403\nT-ADS\n0.3.0\n2019-05\nCT4#91\nC4-192405\nSMS\n0.3.0\n2019-05\nCT4#91\nC4-192462\nAuthentication\n0.3.0\n2019-05\nCT4#91\nC4-192098\nAuthentication – HSS using Nudr\n0.3.0\n2019-09\nCT4#93\nC4-193134\nSystem Architecture\n0.4.0\n2019-09\nCT4#93\nC4-193137\nIMS procedures\n0.4.0\n2019-09\nCT4#93\nC4-193829\nMobility procedures\n0.4.0\n2019-09\nCT4#93\nC4-193556\nAuthentication vector generation in UDM\n0.4.0\n2019-09\nCT4#93\nC4-193297\nMT-SMS Routing Information Retrieval Over Nudr\n0.4.0\n2019-09\nCT4#93\nC4-193617\nLocation Info Retrieval\n0.4.0\n2019-09\nCT4#93\nC4-193618\nUE reachability\n0.4.0\n2019-09\nCT4#93\nC4-193619\nUser State Info Retrieval\n0.4.0\n2019-10\nCT4#94\nC4-194347\nProvideLocationInformation\n0.5.0\n2019-10\nCT4#94\nC4-194348\nDocument cleanup\n0.5.0\n2019-10\nCT4#94\nC4-194350\nIMS Use Cases Correction\n0.5.0\n2019-10\nCT4#94\nC4-194252\nN26 Editor's Note Removal\n0.5.0\n2019-11\nCT4#95\nC4-195416\nHSS to 5GS-UDR reference point\n0.6.0\n2019-11\nCT4#95\nC4-195020\nP-CSCF restoration\n0.6.0\n2019-11\nCT4#95\nC4-195420\nClarification on Mobility, IMS and SMS\n0.6.0\n2019-11\nCT4#95\nC4-195137\nP-CSCF Restoration Procedure\n0.6.0\n2019-11\nCT4#95\nC4-195138\nNudm_UEAuthentication service operations\n0.6.0\n2019-11\nCT4#95\nC4-195428\nNudm_SDM Service\n0.6.0\n2019-11\nCT4#95\nC4-195429\nSMS Procedures\n0.6.0\n2019-12\nCT#86\nCP-193066\nTS presented for information and approval\n1.0.0\n2019-12\nCT#86\nCP-193296\nA title corrected\n1.0.1\n2019-12\nCT#86\nTS was approved\n16.0.0\n2020-03\nCT#87e\nCP-200227\n0008\n2\nF\nReference Points\n16.1.0\n2020-03\nCT#87e\nCP-200019\n0001\n1\nF\nHSS can be consumer of Nudr\n16.1.0\n2020-03\nCT#87e\nCP-200019\n0002\n1\nF\nUserState retrieval\n16.1.0\n2020-03\nCT#87e\nCP-200019\n0004\n2\nB\nPGW-C+SMF Information Notification Procedure\n16.1.0\n2020-03\nCT#87e\nCP-200019\n0011\n-\nB\nIMEI Retrieval\n16.1.0\n2020-03\nCT#87e\nCP-200022\n0006\n4\nB\nIntroduce 5G SRVCC support\n16.1.0\n2020-06\nCT#88e\nCP-201033\n0003\n2\nF\nSMS\n16.2.0\n2020-06\nCT#88e\nCP-201033\n0013\n-\nF\nAuthentication Options\n16.2.0\n2020-06\nCT#88e\nCP-201033\n0014\n2\nB\nCommon Network Exposure\n16.2.0\n2020-06\nCT#88e\nCP-201033\n0015\n6\nF\nUDM and HSS not Aware of N26\n16.2.0\n2020-06\nCT#88e\nCP-201033\n0016\n-\nF\nAssociation between APN and PGW-C+SMF FQDN in HSS\n16.2.0\n2020-06\nCT#88e\nCP-201033\n0018\n1\nF\nSMS Interfaces\n16.2.0\n2020-06\nCT#88e\nCP-201033\n0019\n-\nB\nSupport of SMSoIP\n16.2.0\n2020-06\nCT#88e\nCP-201036\n0017\n-\nF\nRemove Editor's Note regarding multiple SRVCC capabilities per system\n16.2.0\n2020-09\nCT#89e\nCP-202111\n0022\n-\nF\nRemoval Of Editor's Notes\n16.3.0\n2020-09\nCT#89e\nCP-202111\n0023\n-\nF\nMissing error conditions in SMSF registration information retrieval\n16.3.0\n2020-12\nCT#90e\nCP-203049\n0024\n-\nF\nInconsistency between in text and in figure clean up\n16.4.0\n2020-12\nCT#90e\nCP-203049\n0025\n-\nF\nSN Deregistration\n16.4.0\n2020-12\nCT#90e\nCP-203049\n0026\n-\nF\nUE Reachability for IP\n16.4.0\n2021-03\nCT#91e\nCP-210042\n0027\n-\nF\nRemoval of SMSF registration notification flag\n16.5.0\n2021-03\nCT#91e\nCP-210042\n0028\n-\nF\nP-CSCF Restoration\n16.5.0\n2021-03\nCT#91e\nCP-210042\n0029\n1\nF\nCancellation Type sent to MME/SGSN when UE registers in 5G\n16.5.0\n2021-03\nCT#91e\nCP-210053\n0031\n-\nF\nCancellation Type for mobility from EPC to 5GC\n16.5.0\n2021-06\nCT#92e\nCP-211053\n0032\n1\nF\nSubscription to Changes of SMF Context Data\n17.0.0\n2022-03\nCT#95e\nCP-220091\n0034\n1\nF\nPDU session continuity\n17.1.0\n2022-06\nCT#96\nCP-221063\n0038\n1\nF\nSend-Routing-Info-for-SM for retrieval of SMSF Registrations\n17.2.0\n2022-09\nCT#97e\nCP-222057\n0039\n1\nF\nIMEI Update synchronization\n17.3.0\n2022-12\nCT#98e\nCP-223032\n0040\n1\nF\nImplicit unsubscribe\n18.0.0\n2023-03\nCT#99\nCP-230052\n0041\n1\nF\nClarification on MT-SMS Delivery Failure\n18.1.0\n2023-06\nCT#100\nCP-231027\n0042\n1\nF\nUE Memory Available\n18.2.0\n2023-09\nCT#101\nCP-232058\n0043\n-\nF\nImmediate Reporting Handling\n18.3.0\n2023-12\nCT#102\nCP-233056\n0044\n-\nF\nGroup event based common network exposure\n18.4.0\n2024-06\nCT#104\nCP-241050\n0045\n-\nF\nInterworking with IMS clarification\n18.5.0\n2024-06\nCT#104\nCP-241050\n0046\n1\nF\nUE context data synchronization\n18.5.0\n2024-12\nCT#106\nCP-243022\n0049\nF\nNot Cancelling MME registration upon EPS to 5GS mobility\n18.6.0",
      "chunk_type": "requirement",
      "cross_references": [
        "ts_23.502",
        "ts_16.1"
      ]
    }
  ]
}